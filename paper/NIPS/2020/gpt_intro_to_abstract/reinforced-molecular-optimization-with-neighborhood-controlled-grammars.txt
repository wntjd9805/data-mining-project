Traditional drug discovery methods are time-consuming and inefficient due to the vast chemical structure space. To address this issue, recent research has focused on using deep learning techniques for molecular optimization. However, existing methods struggle with generating valid molecular structures and efficiently exploring the chemical structure space. This paper proposes MNCE-RL, a framework that combines molecular neighborhood-controlled embedding grammars and a graph convolutional network (GCN) to overcome these challenges. The proposed grammar ensures chemical validity, and the RL agent can effectively explore the chemical structure space. The contributions of this work include a novel grammar and algorithm for inferring production rules, an improved GCN architecture for better policy decision-making, and experimental results that demonstrate the superiority of MNCE-RL in molecular optimization.