This paper introduces the problem of retrieval-based localization and the limitations of current approaches in large-scale environments. It discusses the use of structure-based methods and retrieval-based approaches for vision-based localization. The paper then explores recent developments in learning image features for localization and the challenges of dividing images into discrete categories. To address these challenges, the paper proposes a novel technique of using soft positive/negative assignments for contrastive learning in localization. The contributions of the paper include a formal theoretical framework, a novel loss function, and superior performance compared to state-of-the-art methods demonstrated on four large-scale datasets.