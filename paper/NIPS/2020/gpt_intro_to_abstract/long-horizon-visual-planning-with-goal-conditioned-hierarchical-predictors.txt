This paper introduces a framework for goal-conditioned prediction and planning in intelligent agents. The framework utilizes powerful predictive models to enable agents to predict and plan in complex environments directly from visual sensory observations. The authors propose a planning agent that considers trajectories with the goal in mind, which reduces prediction complexity and search space for finding the optimal route. To address challenges with long time horizons and optimization problems, a hierarchical prediction model is proposed, which breaks tasks into constituent steps and enables efficient long-horizon planning. The authors also propose a probabilistic formulation of dynamic time warping to flexibly place intermediate predictions. The contributions of this work include scalable goal-conditioned prediction and planning, hierarchical prediction and planning, and modeling temporal variation in subtask structure. Evaluation on a visual navigation task demonstrates the scalability and effectiveness of the proposed method.