Abstract
Modeling complex spatial and temporal correlations in the correlated time series data is indispensable for understanding the trafﬁc dynamics and predicting the future status of an evolving trafﬁc system. Recent works focus on designing com-plicated graph neural network architectures to capture shared patterns with the help of pre-deﬁned graphs. In this paper, we argue that learning node-speciﬁc patterns is essential for trafﬁc forecasting while the pre-deﬁned graph is avoidable. To this end, we propose two adaptive modules for enhancing Graph Convolutional
Network (GCN) with new capabilities: 1) a Node Adaptive Parameter Learning (NAPL) module to capture node-speciﬁc patterns; 2) a Data Adaptive Graph Gen-eration (DAGG) module to infer the inter-dependencies among different trafﬁc series automatically. We further propose an Adaptive Graph Convolutional Recur-rent Network (AGCRN) to capture ﬁne-grained spatial and temporal correlations in trafﬁc series automatically based on the two modules and recurrent networks.
Our experiments 1 on two real-world trafﬁc datasets show AGCRN outperforms state-of-the-art by a signiﬁcant margin without pre-deﬁned graphs about spatial connections. 1

Introduction
The fast urbanization introduces growing populations in cities and presents signiﬁcant mobility and sustainability challenges. Among those challenges, Intelligent Transportation Systems (ITS) has become an active research area [1], given its potential to promote system efﬁciency and decision-making. As an essential step towards the ITS, trafﬁc forecasting aims at predicting the future status (e.g., trafﬁc ﬂow and speed, and passenger demand) of urban trafﬁc systems. It plays a vital role in trafﬁc scheduling and management and has attracted tremendous attention from the machine learning research community in recent years [2, 3, 4, 5, 6].
Trafﬁc forecasting is challenging due to the complex intra-dependencies (i.e., temporal correlations within one trafﬁc series) and inter-dependencies (i.e., spatial correlations among multitudinous corre-lated trafﬁc series) [3] generated from different sources, e.g., different loop detectors/intersections for trafﬁc ﬂow & trafﬁc speed prediction, and various stations/regions for passenger demand pre-diction. Traditional methods simply deploy time series models, e.g., Auto-Regressive Integrated
Moving Average (ARIMA) and Vector Auto-Regression (VAR), for trafﬁc forecasting. They cannot capture the nonlinear correlations nor intricate spatial-temporal patterns among large scale trafﬁc 1Code available at: https://github.com/LeiBAI/AGCRN 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
data. Recently, researchers shift to deep-learning-based methods and focus on designing new neural network architectures to capture prominent spatial-temporal patterns shared by all trafﬁc series. They typically model temporal dependencies with recurrent neural networks [7, 8, 9, 10] (e.g., Long-Short
Term Memory and Gated Recurrent Unit) or temporal convolution modules [3, 4]. Regarding spatial correlations, they commonly use GCN-based methods [2, 4, 3, 6, 11, 5, 12] to model unstructured trafﬁc series and their inter-dependencies.
While recent deep-learning-based methods achieve promising results, they are biased to the prominent and shared patterns among all trafﬁc series—the shared parameter space makes cur-rent methods inferior in capturing ﬁne-grained data-source speciﬁc patterns accurately.
In fact, trafﬁc series exhibit diversiﬁed patterns (as shown in Fig. 1), they may appear similar, dis-similar, and even contradictory owning to the distinct attributes across a variety of data sources
[7, 13]. Moreover, existing GCN-based methods require pre-deﬁning an inter-connection graph by similarity or distance measures [14] to cap-ture the spatial correlations. That further re-quires substantial domain knowledge and is sen-sitive to the graph quality. The graphs generated in this manner are normally intuitive, incomplete, and not directly speciﬁc to the prediction tasks; they may contain biases and not adaptable to domains without appropriate knowledge.
Figure 1: Examples of trafﬁc ﬂow with diverse patterns. The trafﬁc ﬂow of road 3 is steady in the day time. As a contrast, the trafﬁc ﬂows of road 1, 2 and 4 have obvious evening peak, morning peak, and both peaks, respectively.
Instead of designing more complicated network architectures, we propose two concise yet effective mechanisms by revising the basic building block of current methods (i.e., GCN) to solve the above problems separately. Speciﬁcally, we propose to enhance GCN with two adaptive modules for trafﬁc forecasting tasks: 1) a Node Adaptive Parameter Learning (NAPL) module to learn node-speciﬁc patterns for each trafﬁc series—NAPL factorizes the parameters in traditional GCN and generates node-speciﬁc parameters from a weights pool and bias pool shared by all nodes according to the node embedding; 2) a Data Adaptive Graph Generation (DAGG) module to infer the node embedding (attributes) from data and to generate the graph during training. NAPL and DAGG are independent and can be adapted to existing GCN-based trafﬁc forecasting models both separately and jointly. All the parameters in the modules can be easily learned in an end-to-end manner. Furthermore, we combine
NAPL and DAGG with recurrent networks and propose a uniﬁed trafﬁc forecasting model - Adaptive
Graph Convolutional Recurrent Network (AGCRN). AGCRN can capture ﬁne-grained node-speciﬁc spatial and temporal correlations in the trafﬁc series and unify the nodes embeddings in the revised
GCNs with the embedding in DAGG. As such, training AGCRN can result in a meaningful node representation vector for each trafﬁc series source (e.g., roads for trafﬁc speed/ﬂow, stations/regions for passenger demand). The learned node representation contains valuable information about the road/region and can be potentially applied to other tasks [15].
We evaluate AGCRN on two real-world datasets for the multi-step trafﬁc prediction task and com-pare it with several representative trafﬁc forecasting models. The experimental results show that
AGCRN outperforms state-of-the-art with a signiﬁcant margin. We also conduct ablation studies and demonstrate the effectiveness of both NAPL and DAGG. 2