Abstract
The novel nature of SARS-CoV-2 calls for the development of efﬁcient de novo drug design approaches. In this study, we propose an end-to-end framework, named
CogMol (Controlled Generation of Molecules), for designing new drug-like small molecules targeting novel viral proteins with high afﬁnity and off-target selectiv-ity. CogMol combines adaptive pre-training of a molecular SMILES Variational
Autoencoder (VAE) and an efﬁcient multi-attribute controlled sampling scheme that uses guidance from attribute predictors trained on latent features. To generate novel and optimal drug-like molecules for unseen viral targets, CogMol leverages a protein-molecule binding afﬁnity predictor that is trained using SMILES VAE embeddings and protein sequence embeddings learned unsupervised from a large corpus. We applied the CogMol framework to three SARS-CoV-2 target proteins: main protease, receptor-binding domain of the spike protein, and non-structural protein 9 replicase. The generated candidates are novel at both the molecular and chemical scaffold levels when compared to the training data. CogMol also includes in silico screening for assessing toxicity of parent molecules and their metabolites with a multi-task toxicity classiﬁer, synthetic feasibility with a chemi-cal retrosynthesis predictor, and target structure binding with docking simulations.
Docking reveals favorable binding of generated molecules to the target protein structure, where 87–95% of high afﬁnity molecules showed docking free energy
< -6 kcal/mol. When compared to approved drugs, the majority of designed compounds show low predicted parent molecule and metabolite toxicity and high predicted synthetic feasibility. In summary, CogMol can handle multi-constraint design of synthesizable, low-toxic, drug-like molecules with high target speci-ﬁcity and selectivity, even to novel protein target sequences, and does not need target-dependent ﬁne-tuning of the framework or target structure information. 1

Introduction
Generating novel drug molecules is a daunting task that aims to create new molecules (or optimize known molecules) with multiple desirable properties that often compete and tightly interact with each other. For example, optimal drug molecules should have binding afﬁnity to the target protein of interest (target speciﬁcity), low binding afﬁnity to other targets (off-target selectivity), be easy to synthesize, and also exhibit high drug likeliness (QED). This makes drug discovery a costly (2-3 billion USD) and time-consuming process (more than a decade) with a low success rate (< 10%) [1].
†Equal Contribution 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Figure 1: Workﬂow of the drug candidate generation and screening pipeline
Traditional in silico molecule design and screening rely on rational design methods that need physics-based simulations, heuristic search algorithms, and considerable domain knowledge. However, optimizing over the discrete, unstructured and sparse molecular space remains an intrinsically difﬁcult challenge. Therefore, there is much interest in developing automated machine learning techniques to efﬁciently discover sizeable numbers of plausible, diverse and novel candidate molecules in the vast (1023-1060) space of molecules [2]. Bayesian optimization, Reinforcement Learning, and gradient-based optimization methods have been proposed for automating drug molecule design with desired properties (e.g., high drug-likeliness, synthetic accessibility, or solubility) [3–5]. These methods either optimize directly on the high-dimensional input space or on the low dimensional representation learned using a latent variable model such as a probabilistic autoencoder.
One crucial aspect of designing drug candidates is to account for the right context, e.g., protein, gene, metabolic or disease pathway information. For example, in target protein-speciﬁc drug design, the goal is to generate molecules with high binding afﬁnity to a speciﬁc target protein. This requires
ﬁne-tuning a generative model on a small library of ligands to enable target-speciﬁc sampling. For novel or unrelated proteins, such as the SARS-CoV-2 viral proteins involved in the recent COVID-19 pandemic, binding afﬁnity data is unavailable. At the same time, these novel target proteins are not related to the proteins in existing binding afﬁnity databases. Thus, handling novel targets in the current generative frameworks becomes non-trivial.
Designing drug candidates for novel targets gets even more challenging, as the drug designed for the novel target can bind to other undesired targets. Small molecule drugs have been shown to bind on average to a minimum of 6-11 distinct targets in addition to their intended target [6]. This molecular
“promiscuity” of drugs causes unintended therapeutic effects or multiple drug–target interactions leading to off-target toxicities and decreased effectiveness [7, 8]. Accounting for this important aspect of off-target selectivity becomes non-trivial if the generative model is trained only on a small ligand library optimized for a single target or only on good binder molecules for a limited set of targets. 2 CogMol - Molecule Generation Pipeline
To address the challenges stated above, we propose an alternative method named Controlled
Generation of Molecules (CogMol) for designing small molecule drugs in a context, i.e. target protein in this study, -dependent manner. CogMol accounts for both target speciﬁcity and selectivity, even for novel or low-coverage target sequences. As depicted in Figure 1, CogMol includes the following components: 1. A Variational Autoencoder (VAE), ﬁrst trained unsupervised and then jointly with a set of attribute regressors (QED and Synthetic Accessibility, SA), that learns a disentangled latent space of the molecules using the SMILES representation. 2. A protein-molecule binding afﬁnity regressor trained on the VAE latent features of molecules and protein sequence embeddings trained on a large unlabeled corpus, which is used for estimating target speciﬁcity and off-target selectivity. 3. An efﬁcient sampling scheme to generate molecules with desired attributes from the model of the
VAE latent space, using guidance from a set of attribute (afﬁnity, selectivity, QED) predictors.
Instead of training the binding afﬁnity regressor on the sequence embeddings of a few thousand target proteins reported in the binding afﬁnity database, CogMol uses pre-trained protein sequence embeddings, [9] learned on an unlabeled corpus of 24M Uniprot protein sequences from UniRef50 database, to train the afﬁnity predictor. Since these pre-trained protein embeddings are capable of better capturing sequence, structural, and functional relationships [9, 10], using them in CogMol allows targeted generation of molecules even for new/unseen targets and does not require model retraining for every individual target. Finally, CogMol proposes an efﬁcient way of modeling off-2
target selectivity and using this as a control for targeted generation, leveraging the same trained protein-ligand binding afﬁnity predictor.
CogMol is also empowered with an in silico screening protocol for generated molecules, which involves: (i) toxicity prediction on several in vitro and clinical endpoints for parent molecules and their predicted metabolites using a multi-task deep learning-based classiﬁer, (ii) synthetic feasibility prediction using a chemical retrosynthesis predictor; and (iii) blind docking simulations to estimate binding of the generated molecules to the target protein structure. We hope that accounting for multiple important properties that play a role in the efﬁcacy or viability of a drug such as target afﬁnity, off-target selectivity, toxicity of parent molecules and their metabolites, and synthetic practicality, within an AI framework will help the in silico drug design process to be faster and less costly, leading to shorter discovery pipelines with high success rate.
CogMol for COVID-19 Antiviral Molecule Design. Given the urgency with the ongoing COVID-19 pandemic, we apply CogMol to generate candidate molecules that bind to three relevant target proteins of the novel SARS-CoV-2 virus, namely NSP9 Replicase (NSP9), Main Protease (Mpro), and the Receptor-Binding Domain (RBD) of the SARS-CoV-2 S protein, with high afﬁnity. Note, these targets are not present in the binding afﬁnity database, and both NSP9 and RBD are more novel than Mpro (See Supp. Mat. A). We also used CogMol to generate molecules for human Histone deacetylase 1 (HDAC1) protein implicated in cancer, for which the number of molecules with desired criteria in the training database is very low.
Our contributions in this work are: (i) An end-to-end framework for drug-like small molecule design that accounts for multiple relevant and critical factors such as target afﬁnity, off-target selectivity, toxicity of the parent molecules and their metabolites across different endpoints, target structure binding, and synthetic practicality. (ii) This is, to our knowledge, the ﬁrst deep generative approach that generates novel, speciﬁc, and selective drug-like small molecules for a unseen target sequence without model retraining. (iii) A system capable of generating drug-like molecules with high target afﬁnity and selectivity for selected targets that are either relatively novel or have a low ligand coverage. (iv) Although our framework learns from 1D protein sequence information only, generated molecules are still capable of binding to the druggable binding pockets of the 3D target structure with favorable binding free energy (BFE). (v) For three novel and very relevant COVID-19 targets (as well as for a cancer target with low coverage of optimal ligands), we are able to identify a set of generated novel and optimal drug-like molecules with high predicted target afﬁnity and selectivity, that docks favorably to the target structure, is synthetically practical and has low predicted parent and metabolite toxicity with respect to FDA-approved drugs. 3