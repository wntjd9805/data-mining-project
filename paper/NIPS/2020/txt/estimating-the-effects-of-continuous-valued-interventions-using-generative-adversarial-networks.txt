Abstract
While much attention has been given to the problem of estimating the effect of discrete interventions from observational data, relatively little work has been done in the setting of continuous-valued interventions, such as treatments associated with a dosage parameter. In this paper, we tackle this problem by building on a modiﬁcation of the generative adversarial networks (GANs) framework. Our model,
SCIGAN, is ﬂexible and capable of simultaneously estimating counterfactual outcomes for several different continuous interventions. The key idea is to use a signiﬁcantly modiﬁed GAN model to learn to generate counterfactual outcomes, which can then be used to learn an inference model, using standard supervised methods, capable of estimating these counterfactuals for a new sample. To address the challenges presented by shifting to continuous interventions, we propose a novel architecture for our discriminator - we build a hierarchical discriminator that leverages the structure of the continuous intervention setting. Moreover, we provide theoretical results to support our use of the GAN framework and of the hierarchical discriminator. In the experiments section, we introduce a new semi-synthetic data simulation for use in the continuous intervention setting and demonstrate improvements over the existing benchmark models. 1

Introduction
Estimating the personalised effects of interventions is crucial for decision making in many domains such as medicine, education, public policy and advertising. Such domains have a wealth of obser-vational data available. Most of the methods developed in the causal inference literature focus on learning the counterfactual outcomes of discrete interventions, such as binary or categorical treat-ments2 [1–9]. Unfortunately, in many cases, deciding how to intervene involves not only deciding which intervention to make (e.g. whether to treat cancer with radiotherapy, chemotherapy or surgery) but also deciding on the value of some continuous parameter associated with intervening (e.g. the dosage of radiotherapy to be administered). In medicine there are many examples of treatments
⇤Equal contribution. 2For ease of exposition, we will sometimes refer to interventions as treatments and to the associated continuous parameter as the dosage throughout the paper. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
that are associated with a continuous dosage parameter (such as vasopressors [10]). In the medical setting, using a high dosage for a treatment can lead to toxic effects while using a low dosage can result in no effect on the patient outcome [11, 12]. In other domains, there are many examples of continuous interventions, such as the duration of an education or job training program, the frequency of an exposure or the price used in an advert. Naturally, being able to estimate the effect of these continuous interventions will aid in the decision making process.
Learning from observational data already presents signiﬁcant challenges when there is only a single intervention (and thus the decision is binary - whether to intervene or not). As explained in [13], in an observational dataset, only the factual outcome is present - the “counterfactual" outcomes are not observed. This problem is exacerbated in the setting of continuous interventions where the number of counterfactuals is no longer even ﬁnite. Moreover, the decision to intervene is non-random and instead is assigned according to the features associated with each sample. Due to the continuous nature of the interventions, adjusting for selection bias is signiﬁcantly more complex than for binary (or even multiple) interventions. Thus, standard methods for adjusting for selection bias for discrete treatments cannot be easily extended to handle bias in the continuous setting.
GAN loss
Backpropagation
SCIGAN 
Discriminator
Factual outcome
Counterfactual  outcomes
We propose SCIGAN (eStimating the ef-fects of Continuous Interventions using
GANs). We build on the GAN framework of [14] to learn the distribution of the unob-served counterfactuals. GANs have already been used in GANITE [6] to generate the unobserved counterfactual outcomes for discrete interventions. The intuition is that if a counterfactual generator and discrimi-nator are trained adversarially, then the gen-erator can fool the discriminator (i.e. the discriminator will not be able to correctly identify the factual outcome) by generat-ing counterfactuals according to their true distribution. Unfortunately, no theoretical work was provided in [6] to back up this intuition. A key contribution of this paper is to provide theoretical results that justify using the GAN framework to learn to generate counterfactual outcomes; these results also apply to GANITE.
Figure 1: Overview of GAN framework used as part of
SCIGAN for learning the distribution of the counterfac-tual outcomes.
SCIGAN Counterfactual 
Generator
Intervention 2
Intervention 1 e m o c t u o t n e i t a
P e m o c t u o t n e i t a
P
Dosage
Dosage d<latexit sha1_base64="(null)">(null)</latexit> d<latexit sha1_base64="(null)">(null)</latexit>
<latexit sha1_base64="(null)">(null)</latexit>
<latexit sha1_base64="(null)">(null)</latexit>
<latexit sha1_base64="(null)">(null)</latexit>
<latexit sha1_base64="(null)">(null)</latexit>
<latexit sha1_base64="(null)">(null)</latexit>
<latexit sha1_base64="(null)">(null)</latexit>
GANITE itself presents a signiﬁcant modiﬁcation to the original GAN framework - rather than the discriminator discriminating between entirely real or entirely fake samples, the discriminator is attempting to identify the real component from a vector containing the real (factual) outcome from the dataset and the fake (counterfactual) outcomes generated by the generator. SCIGAN inherits this key difference from a standard GAN. However, beyond our theoretical contribution, we propose signiﬁcant changes to the generator and discriminator in order to tackle the more complex problem of estimating outcomes of continuous interventions.
We deﬁne a discriminator that acts on a ﬁnite set of points from each generated response curve (rather than on entire curves), as shown in Fig. 1. We draw on ideas from [15] to ensure that our discriminator acts as a function of a set, rather than of a vector. Moreover, we focus on the setting of interventions each with an associated continuous parameter. In this setting, we propose a hierarchical discriminator which breaks down the job of the discriminator into determining the factual intervention and determining the factual parameter using separate networks. We show in the experiments section that this approach signiﬁcantly improves performance and is more stable than using a single network discriminator. We also model the generator as a multi-task deep network capable of taking a continuous parameter as an input; this gives us the ﬂexibility to learn heterogeneous response curves for the different interventions.
Our contributions in this paper are 4-fold: (1) we propose SCIGAN, a signiﬁcantly modiﬁed GAN framework, capable of estimating outcomes for continuous and many-level-discrete interventions, (2) we provide theoretical justiﬁcation for both the use of a GAN framework and a hierarchical discriminator, (3) we propose novel architectures for each of our networks, (4) we propose a new semi-synthetic data simulation for use in the continuous intervention setting. We show, using semi-synthetic experiments, that our model outperforms existing benchmarks. 2    
2