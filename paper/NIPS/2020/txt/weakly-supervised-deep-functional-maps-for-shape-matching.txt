Abstract
A variety of deep functional maps have been proposed recently, from fully super-vised to totally unsupervised, with a range of loss functions as well as different regularization terms. However, it is still not clear what are minimum ingredi-ents of a deep functional map pipeline and whether such ingredients unify or generalize all recent work on deep functional maps. We show empirically the minimum components for obtaining state-of-the-art results with different loss functions, supervised as well as unsupervised. Furthermore, we propose a novel framework designed for both full-to-full as well as partial to full shape matching that achieves state of the art results on several benchmark datasets outperform-ing, even the fully supervised methods. Our code is publicly available at https:
//github.com/Not-IITian/Weakly-supervised-Functional-map 1

Introduction
Shape correspondence is a fundamental problem in computer vision, computer graphics and related
ﬁelds since it facilitates many applications such as texture or deformation transfer and statistical shape analysis Bogo et al. [2014] to name a few. While classical correspondence methods have been based on handcrafted features or deformation models Van Kaick et al. [2011], more recent approaches have focused on learning an optimal model directly from 3D data. This includes approaches based on template ﬁtting and reconstruction Groueix et al. [2018, 2019], and methods that exploit different deﬁnitions of convolution and phrase correspondence as a dense labeling problem Wei et al. [2016],
Masci et al. [2015], Boscaini et al. [2016] among others.
A prominent direction in learning-based shape matching was pioneered by the FMNet work, Litany et al. [2017a] by exploiting the functional map representation Ovsjanikov et al. [2012] and learning features that recover optimal functional maps rather than e.g. individual point labels. The use of the functional map representation allows to efﬁciently impose global correspondence constraints, and has been recently been extended in both unsupervised Halimi et al. [2019], Roufosse et al. [2019] and supervised settings Donati et al. [2020]. Despite signiﬁcant progress in this area, there still exist three major issues. First, the most accurate recent approach Donati et al. [2020] is limited to supervised setting that requires ground truth correspondences that are difﬁcult to obtain considering the cost of annotating a dense point-to-point map on each shape pair. Second, despite a variety of deep functional maps-based methods, it is still not clear what are minimum ingredients of a deep functional map pipeline. More importantly, do such minimum ingredients unify or generalize all recent work on deep functional maps. While a battery of loss functions and regularization have been proposed for different deep functional maps, as we demonstrate below, the devil is not in the loss functions. Instead, using a low number of Laplacian eigen-basis, very weak supervision in the form of rigid alignment and enforcing basic structural properties of resulting functional map are sufﬁcient to obtain high quality results. Moreover, our approach generalize to many loss functions proposed recently and does not require Geodesic matrices, as in FMnet Litany et al. [2017a] and UnSupFmnet Halimi et al. [2019], 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
ground truth maps, as in GeomFmap Donati et al. [2020] and FMnet, regularizers, such as descriptor preservation in SurfmNet Roufosse et al. [2019] and regularized FMap layer in GeomFMap Donati et al. [2020]. Third, recent learning-based approaches are neither designed nor tested for the partial shape matching problem [Rodolà et al., 2017, Litany et al., 2017b] which is of great interest in robotics [Chavdar et al., 2012] and Virtual reality applications [Sharma et al., 2016]. To this end, we propose a weakly supervised framework that addresses all three major issues.
In this paper, weak supervision implies that datasets are only approximately rigidly aligned, which is necessary primarily due to the presence of symmetries. Since some poses (e.g. the neutral pose) are fully extrinsically symmetric, a PointNet like feature extractor cannot distinguish left/right unless the shapes are aligned. Interestingly, as we demonstrate below, such weak supervision is sufﬁcient to obtain high quality results.
Broadly, there are three main components to any deep functional map pipeline, namely feature extractor, choice of basis functions and design of empirical loss or regularization on the functional map. In this paper, we make contributions on all three fronts. First, we propose to learn feature descriptors directly from raw data with a very weak supervision and establish that for non-rigid shape correspondence, rigid alignment supervision turns out to be sufﬁcient to obtain accurate results. Remarkably, it also outperforms the fully supervised state-of-the-art methods, which rely on ground truth point-to-point correspondences, on challenging benchmarks. Secondly, we show that the combination of our feature extractor projected to low number of Laplacian eigen basis (30) and unsupervised loss, consisting of simple regularization terms, sufﬁce to obtain state of the art result for any recently proposed loss functions. Thirdly, to address partial shape matching, we propose a novel data driven method to learn an optimal alignment between source and target Laplacian eigen basis functions which paves the way for future work on deep functional maps in partial shape matching. 2