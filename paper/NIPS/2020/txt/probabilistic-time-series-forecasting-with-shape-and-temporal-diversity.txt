Abstract
Probabilistic forecasting consists in predicting a distribution of possible future outcomes. In this paper, we address this problem for non-stationary time series, which is very challenging yet crucially important. We introduce the STRIPE model for representing structured diversity based on shape and time features, ensuring both probable predictions while being sharp and accurate. STRIPE is agnostic to the forecasting model, and we equip it with a diversiﬁcation mechanism relying on determinantal point processes (DPP). We introduce two DPP kernels for modeling diverse trajectories in terms of shape and time, which are both differentiable and proved to be positive semi-deﬁnite. To have an explicit control on the diversity structure, we also design an iterative sampling mechanism to disentangle shape and time representations in the latent space. Experiments carried out on synthetic datasets show that STRIPE signiﬁcantly outperforms baseline methods for representing diversity, while maintaining accuracy of the forecasting model. We also highlight the relevance of the iterative sampling scheme and the importance to use different criteria for measuring quality and diversity. Finally, experiments on real datasets illustrate that STRIPE is able to outperform state-of-the-art probabilistic forecasting approaches in the best sample prediction. 1

Introduction
Time series forecasting consists in analysing historical signal correlations to anticipate future out-comes. In this work, we focus on probabilistic forecasting in non-stationary contexts, i.e. we aim at producing plausible and diverse predictions where future trajectories can present sharp variations.
This forecasting context is of crucial importance in many applicative ﬁelds, e.g. climate [62, 34, 15], optimal control or regulation [66, 41], trafﬁc ﬂow [39, 38], healthcare [8, 1], stock markets [14, 7], etc. Our motivation is illustrated in the example of the blue input in Figure 1(a): we aim at performing predictions covering the full distribution of future trajectories, whose samples are shown in green.
State-of-the-art methods for time series forecasting currently rely on deep neural networks, which exhibit strong abilities in modeling complex nonlinear dependencies between variables and time.
Recently, increasing attempts have been made for improving architectures for accurate predictions
[31, 53, 37, 42, 35] or for making predictions sharper, e.g. by explicitly modeling dynamics [9, 16, 50], or by designing speciﬁc loss functions addressing the drawbacks of blurred prediction with mean squared error (MSE) training [12, 47, 33, 58]. Although Figure 1(b) shows that such approaches produce sharp and realistic forecasts, their deterministic nature limits them to a single trajectory prediction without uncertainty quantiﬁcation. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
(a) True predictive distribution (b) Sharp loss [33] (c) deep stoch model [65] (d) STRIPE (ours)
Figure 1: We address the probabilistic time series forecasting problem. (a) Recent deep learning models include a speciﬁc loss enabling sharp predictions [12, 47, 33, 58] (b), but are inadequate for producing diverse forecasts. On the other hand, probabilistic forecasting approaches based on generative models [65, 46] loose the ability to generate sharp forecasts (c). The proposed STRIPE model (d) produces both sharp and diverse future forecasts.
Methods targeting probabilistic forecasting enable to sample diverse predictions from a given input.
This includes deterministic methods that predict the quantiles of the predictive distribution or proba-bilistic methods that sample future values from a learned approximate distribution, parameterized explicitly (e.g. Gaussian [52, 45, 51]), or implicitly with latent generative models [65, 29, 46]. These approaches are commonly trained using MSE or variants for probabilisting forecasts, e.g. quantile loss
[28], and consequently often loose the ability to represent sharp predictions, as shown in Figure 1(c) for [65]. These generative models also lack an explicit structure to control the type of diversity in the latent space.
In this work, we introduce a model for including Shape and Time diverRsIty in Probabilistic forEcast-ing (STRIPE). As shown in Figure 1(d), this enables to produce sharp and diverse forecasts, which ﬁt well the ground truth distribution of trajectories in Figure 1(a).
STRIPE presented in section 3 is agnostic to the predictive model, and we use both deterministic or generative models in our experiments. STRIPE encompasses the following contributions. Firstly, we introduce a structured shape and temporal diversity mechanism based on determinantal point processes (DPP). We introduce two DPP kernels for modeling diverse trajectories in terms of shape and time, which are both differentiable and proved to be positive semi-deﬁnite (section 3.1). To have an explicit control on the diversity structure, we also design an iterative sampling mechanism to disentangle shape and time representations in the latent space (section 3.2).
Experiments are conducted in section 4 on synthetic datasets to evaluate the ability of STRIPE to match the ground truth trajectory distribution. We show that STRIPE signiﬁcantly outperforms baseline methods for representing diversity, while maintaining the accuracy of the forecasting model. Experiments on real datasets further show that STRIPE is able to outperform state-of-the-art probabilistic forecasting approaches when evaluating the best sample (i.e. diversity), while being equivalent based on its mean prediction (i.e. quality). 2