Abstract
We tackle the problem of establishing dense pixel-wise correspondences between a pair of images. In this work, we introduce Dual-Resolution Correspondence
Networks (DualRC-Net), to obtain pixel-wise correspondences in a coarse-to-ﬁne manner. DualRC-Net extracts both coarse- and ﬁne- resolution feature maps. The coarse maps are used to produce a full but coarse 4D correlation tensor, which is then reﬁned by a learnable neighbourhood consensus module. The ﬁne-resolution feature maps are used to obtain the ﬁnal dense correspondences guided by the re-ﬁned coarse 4D correlation tensor. The selected coarse-resolution matching scores allow the ﬁne-resolution features to focus only on a limited number of possible matches with high conﬁdence. In this way, DualRC-Net dramatically increases matching reliability and localisation accuracy, while avoiding to apply the expen-sive 4D convolution kernels on ﬁne-resolution feature maps. We comprehensively evaluate our method on large-scale public benchmarks including HPatches, InLoc, and Aachen Day-Night. It achieves the state-of-the-art results on all of them. 1

Introduction
Establishing correspondences between a pair of images that shares a common ﬁeld of view is critical for many important tasks in computer vision such as 3D reconstruction [1, 2, 3], camera motion estimation [4], relocalization [5, 6, 7, 8], etc. Most existing methods tackle the problem using a classic 3-stage pipeline, i.e., detection, description and matching [7, 9]. They ﬁrst detect local repeatable salient points known as the keypoints, then describe these keypoints by extracting feature vectors from some local regions around them, and ﬁnally form the keypoint pairs, also known as the correspondences, by selecting a set of high conﬁdent matches from all possible candidate matches. The resulting correspondences can then be used to triangulate 3D coordinates for model reconstruction [1] or to feed the RANSAC Perspective-n-Point (PnP) algorithms [10, 11] for camera pose estimation [12, 13]. This pipeline has demonstrated great success in dealing with certain illumination or camera viewpoint variations using the classic hand-crafted local feature descriptors such as SIFT [14], SURF [15], BRISK [16] or the modern CNN features [17]. However, many of these methods are based on local support regions and therefore suffer from the missing detection problems [6]. During matching, they only consider up to k nearest neighbours, instead of the entire matching space, which also limits their performance especially under extreme appearance changes such as day-to-night with wide viewpoint variations.
Recently, several approaches [18, 19, 5] aim to avoid the detection stage by considering every point from a regular grid for matching. As a result, dense matches can be obtained by retrieving the conﬁdent ones from all possible candidate matches. Hence, the missing detection problem can be alleviated. Among these approaches, the Neighbourhood Consensus Networks (NCNet) [5] and its variants [20, 21, 6] have shown encouraging results. These methods employ a CNN to extract features 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
from two images, then calculate a 4D correlation tensor representing the entire matching space where each location records the cosine correlation score between a pair of feature vectors, and reﬁne the correlation tensor by a sequence of 4D convolution kernels. The learnt 4D kernels turn out to be highly effective in ﬁltering incorrect matches. However, the use of 4D convolution kernels in these methods are prohibitively expensive, restricting them from handling images with a high resolution or resulting in inadequate localisation accuracy.
In this paper, we propose Dual-Resolution Correspondence Networks (DualRC-Net) to establish dense correspondences for high-resolution images in a coarse-to-ﬁne manner. DualRC-Net ﬁrst extracts both coarse- and ﬁne-resolution feature maps. Speciﬁcally, we employ an FPN-like [22] feature backbone to obtain the dual-resolution feature maps. Then, the coarse maps are used to produce a full 4D correlation tensor, which is then reﬁned by the neighbourhood consensus module.
The ﬁne-resolution feature maps are used to obtain the ﬁnal dense correspondences guided by the reﬁned coarse 4D correlation tensor. Speciﬁcally, the full 4D tensor is used to select local regions in the high-resolution feature maps where the corresponding regions have high correlation scores, avoiding calculating the expensive full 4D correlation tensor for the high-resolution feature maps.
When both the coarse and ﬁne correlation scores are coupled together, more reliable correspondences can be estimated from the candidate local regions for the high-resolution feature maps. This can drastically reduce the memory footprint and computation cost while boosting the matching results for more accurate localization.
The main contributions of this paper can be summarised as follow: First, we introduce a novel neural network architecture which generates dual-resolution feature maps allowing to match correspondences in a coarse-to-ﬁne manner; second, the rough matches extracted from the coarse correlation tensor allow the model to focus on the local regions in the ﬁne-resolution feature maps that are very likely to contain the correct matches. This dramatically reduces the memory footprint and computation cost for matching on ﬁne-resolution feature maps; third, we comprehensively evaluate our method on large-scale public benchmarks including HPatches [23], InLoc [24], and Aachen Day-Night [13] achieving the state-of-the-art results on all of them, which demonstrates the effectiveness as well as generalisability of the proposed method. Our code can be found at https://code.active.vision. 2