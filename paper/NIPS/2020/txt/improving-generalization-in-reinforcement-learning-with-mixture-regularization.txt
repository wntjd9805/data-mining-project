Abstract
Deep reinforcement learning (RL) agents trained in a limited set of environments tend to suffer overﬁtting and fail to generalize to unseen testing environments.
To improve their generalizability, data augmentation approaches (e.g. cutout and random convolution) are previously explored to increase the data diversity. How-ever, we ﬁnd these approaches only locally perturb the observations regardless of the training environments, showing limited effectiveness on enhancing the data diversity and the generalization performance. In this work, we introduce a simple approach, named mixreg, which trains agents on a mixture of observa-tions from different training environments and imposes linearity constraints on the observation interpolations and the supervision (e.g. associated reward) inter-polations. Mixreg increases the data diversity more effectively and helps learn smoother policies. We verify its effectiveness on improving generalization by conducting extensive experiments on the large-scale Procgen benchmark. Results show mixreg outperforms the well-established baselines on unseen testing envi-ronments by a large margin. Mixreg is simple, effective and general. It can be applied to both policy-based and value-based RL algorithms. Code is available at https://github.com/kaixin96/mixreg. 1

Introduction
Deep Reinforcement Learning (RL) has brought signiﬁcant progress in learning policies to tackle various challenging tasks, such as board games like Go [19, 21], Chess and Shogi [20], video games like Atari [15, 1] and StarCraft [27], and robotics control tasks [14]. Despite its outstanding performance, deep RL agents tend to suffer poor generalization to unseen environments [31, 23, 29, 3, 2, 30]. For example, in video games, agents trained with a small set of levels struggle to make progress in unseen levels of the same game [2]; in robotics control, agents trained in simulation environments of low diversity generalize poorly to the realistic environments [26]. Such a generalization gap has become a major obstacle for deploying deep RL in real applications.
One of the main causes for this generalization gap is the limited diversity of training environments [29, 3, 2]. Motivated by this, some works propose to improve RL agents’ generalizability by diversifying the training data via data augmentation techniques [3, 13, 12, 11]. However, these approaches merely augment the observations individually with image processing techniques, such as random crop, patch cutout [4] and random convolutions [13]. As shown in Figure 1 (left), such techniques are performing local perturbation within the state feature space, which only incrementally increases the training data diversity and thus leads to limited generalization performance gain. This is evidenced by our ﬁndings that these augmentation techniques fail to improve generalization performance of the RL agents when evaluated on a large-scale benchmark (see Section 4.1).
In this work, we introduce mixreg that trains the RL agent on a mixture of observations collected from different training environments. Inspired by the success of mixup [32] in supervised learning, 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Figure 1: Left: Previous data augmentation techniques (e.g. cutout) only apply local perturbations over the observation (s → saug); they independently augment each observation regardless of training environments and achieve limited data diversity increment. Right: Our mixreg method smoothly interpolates observations from different training environments (si, sj → smix) thus producing more diverse data. per training step, mixreg generates augmented observations by convexly combining two observations randomly sampled from the collected batch, and trains the RL agent on them with their interpolated supervision signal (e.g. the associated rewards or state values). In this way, the generated observations are widely distributed between the diverse observations and can effectively increase the training data diversity, as shown in Figure 1 (right). Moreover, mixreg imposes piece-wise linearity regularization to the learned policy and value functions w.r.t. the states. Such regularization encourages the agent to learn a smoother policy with better generalization performance. Notably, mixreg is a general scheme and can be applied to both policy-based and value-based RL algorithms.
We evaluate mixreg on the recently introduced Procgen Benchmark [2]. We compare mixreg with three best-performing data augmentation techniques (i.e. cutout-color, random crop, random convolution) in [12], and two regularization techniques (i.e. batch normalization [10] and (cid:96)2 regularization) adopted in previous works [3, 6]. We ﬁnd that mixreg boosts the generalization performance of the
RL agent more signiﬁcantly, surpassing the baselines by a large margin. Moreover, when combined with other methods such as (cid:96)2 regularization, mixreg brings further improvement. We also verify the effectiveness of mixreg for both policy-based and value-based algorithms. Additionally, we conduct several analytical experiments to study and provide better understanding on its effectiveness.
This work makes the following contributions.
• We are among the ﬁrst to study how to effectively increase training data diversity to improve
RL generalization. Different from data augmentation techniques as commonly adopted in recent works, we propose to look into mixing observations from different environments.
• We introduce mixreg, a simple and effective approach for improving RL generalization by learning smooth policy over mixed observations. Mixreg can be easily deployed for both policy and value-based RL algorithms.
• On the recent large-scale Procgen benchmark, mixreg outperforms many well-established baselines by large margins. It also serves as a strong baseline for future studies. 2