Abstract
Design of experiments and estimation of treatment effects in large-scale networks, in the presence of strong interference, is a challenging and important problem. Most existing methods’ performance deteriorates as the density of the network increases.
In this paper, we present a novel strategy for accurately estimating the causal effects of a class of treatments in a dense large-scale network. First, we design an approximate randomized controlled experiment by solving an optimization problem to allocate treatments in the presence of competition among neighboring nodes.
Then we apply an importance sampling adjustment to correct for any leftover bias (from the approximation) in estimating average treatment effects. We provide theoretical guarantees, verify robustness in a simulation study, and validate the scalability and usefulness of our procedure in a real-world experiment on a large social network. 1

Introduction
Measuring the effect of treatment variants is a fundamental problem in several ﬁelds of study
[2, 22, 14]. A/B testing is a commonly used method in the internet industry [18, 19, 25, 29] and beyond, wherein randomized experiments are run with two or more such variants. Traditional
A/B testing depends on the key assumption that the effect of treatment on an experiment unit is independent of the treatment allocation to other experiment units – commonly called “Stable Unit
Treatment Value Assumption” (SUTVA) [22]. However, in many important network settings, this assumption is violated due to various forms of interference [3, 4, 13, 16, 17, 23, 26, 28].
We focus on one such class of problems – a marketplace of commodity producers and consumers. An example is a social media platform, where the commodity is content, and the return utility is feedback.
Examples include Facebook, Instagram, LinkedIn, Twitter, etc. Other marketplace problems differ primarily on the commodity and return utility in question. Rides are commodities in Uber and Lyft, retail items are commodities in marketplaces like Amazon and eBay, and money is the common return utility. Note that we do not make any assumptions on how the utility affects a producer’s behavior (i.e., the incentive function).
In the marketplace setting, we deﬁne a treatment class represented by a modiﬁcation of the edge-level probability pij of showing a commodity of a producer i to a consumer j. This abstraction represents a very general class of treatments since any redistribution or shift in producer and consumer exposure can be expressed via the change in the edge-level probabilities. In content marketplaces, such treatments can reshape the content creator’s exposure to their audience, whereas, in a transportation marketplace, it can reshape the likelihood of speciﬁc drivers and riders being matched.
In such marketplace problems, SUTVA is violated because of interference from the network. For instance, the effect of treatment on a producer (the experimental unit) is inﬂuenced by the allocation and effect of the treatment on all potential consumers of that producer, which in turn depend on each 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
of their producers’ experiences (and hence, their allocated treatments) – thus leading to competition among producers connected to common consumers. When SUTVA is violated, the effect of treatment can be measured by allocating experimental units as well as their ﬁrst-degree neighbors (and second-degree neighbors, depending upon the interference function) to the same treatment (or control)
[10, 23]. The number of such units for which we can successfully allocate treatments in this fashion (i.e., whose neighborhood is appropriately treated) decreases with increasing density in the graph, resulting in lower statistical power in the measurements.
In this paper, we propose a novel technique named OASIS, “Optimal Allocation Strategy and
Importance Sampling Adjustment”, that provides a randomized testing framework for large-scale marketplace problems in the presence of interference. The performance of OASIS does not deteriorate (and may improve) as the density of the network increases, and it can be used to obtain high-power measurements. Our approach relies on the existence of an “intervening variable” (a.k.a. mediator) — i.e., the effect of the treatment allocation to an experimental unit’s network on the unit itself is fully captured by a sufﬁcient statistic (cf.[1, 8, 20]). For example, the total feedback received by a content producer (or the total money made by a driver) can be an intervening variable. The producers in a marketplace compete with each other to receive feedback, and we attempt to mimic this competition effect in the design of experiment. Furthermore, we construct an unbiased estimator of the treatment effect by applying an importance sampling correction. We use simulation studies to compare our method against a graph cluster based baseline. From both the simulation studies and from a real-world experiment on a large social network, we show that our technique (i) compares favorably against the baseline method and also (ii) works very well for large-scale dense graphs that cannot be decomposed into reasonably isolated clusters.
This technique can be used in any marketplace problem where the treatment in question can be expressed via the pij “edge weight” abstraction, and where the key assumptions (outlined as As-sumptions 1 and 2 in later sections) are satisﬁed. In many applications, the treatment needs to be applied over a time window during which pij can change periodically (e.g., consumers’ favored producers may change over time) and this dynamism can be handled by updating the experiment design periodically (see the real-world experiment in Section 5).
The rest of the paper is organized as follows. Section 2 formulates the problem and discusses the setup in detail. The key aspects of how we design an experiment via an optimization formulation are described in Section 3. We propose the OASIS estimator and provide theoretical guarantees in
Section 4. In Section 5, we provide some empirical results both from an elaborate simulation study and a real-world experiment on a large social network graph, before concluding with a discussion in
Section 6. We end this section with a selective literature review.