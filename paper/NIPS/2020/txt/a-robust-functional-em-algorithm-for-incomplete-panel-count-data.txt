Abstract
Panel count data describes aggregated counts of recurrent events observed at discrete time points. To understand dynamics of health behaviors and predict future negative events, the ﬁeld of quantitative behavioral research has evolved to increasingly rely upon panel count data collected via multiple self reports, for example, about frequencies of smoking using in-the-moment surveys on mobile devices. However, missing reports are common and present a major barrier to downstream statistical learning. As a ﬁrst step, under a missing completely at random assumption (MCAR), we propose a simple yet widely applicable functional
EM algorithm to estimate the counting process mean function, which is of central interest to behavioral scientists. The proposed approach wraps several popular panel count inference methods, seamlessly deals with incomplete counts and is robust to misspeciﬁcation of the Poisson process assumption. Theoretical analysis of the proposed algorithm provides ﬁnite-sample guarantees by expanding parametric
EM theory [3, 34] to the general non-parametric setting. We illustrate the utility of the proposed algorithm through numerical experiments and an analysis of smoking cessation data. We also discuss useful extensions to address deviations from the
MCAR assumption and covariate effects. 1

Introduction
A major goal in behavioral medicine is identifying temporal patterns of risk factors preventing an individual from successfully modifying a health-related behavior. In smoking cessation, one would like to know times of day, locations, and other contextual factors such as smoking opportunity [17] that may precipitate lapse to inform interventions to prevent lapse [24]. A basic task is to describe when smoking occurs through modeling the counting process of repeated negative events. One goal is to estimate the mean function of the counting process to characterize the dynamics of health-related behaviors at the population level.
The counting process mean function can describe population-level temporal patterns of smoking. It converts the discrete patterns of smoking counts from a population of participants (see Fig. 1) into a temporally-continuous summary of smoking behavior (see Fig. 2b). However, the missingness inherent in EMA data makes consistent estimation of the mean function difﬁcult. There are several 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
conditions causing missingness. An EMA may be ignored by the user or opened and then abandoned.
Second, the mobile app itself may postpone the triggering of an EMA for any of several reasons (e.g. battery low). While EMAs are triggered randomly, the random process is constrained to have a minimum temporal spacing between EMAs, in order to keep participant burden at an acceptable level. If EMAs are postponed or ignored too many times, it will not be possible to trigger the full set of EMAs for the day, resulting in missing EMAs. Missing data is a common issue in studies that involve EMAs, with [16] noting that over 126 studies, the average missingness rate is 25%.
For mean function estimation, missing EMAs cause problems when they lead to inaccurate counts of the total cigarettes smoked between EMAs. Due to recall bias, longer intervals between EMAs are less reliable.1 Behavioral scientists have developed heuristic imputation schemes to adjust for missing counts [13], which may not consistently estimate the mean function. We present the
ﬁrst self-contained and systematic treatment of missing data for panel count data, by providing a simple Expectation-Maximization (EM) algorithm [9, 3] to estimate the mean function with ﬁnite-sample theoretical guarantees. In doing so, we provide a framework for ﬁnite-sample theoretical guarantees for non-parametric EM more generally, potentially allowing ﬁnite sample theory for inﬁnite dimensional missing data and latent variable models.
Our primary methodological contribution is a functional EM algorithm to wrap standard non-parametric mean function estimators to handle missing data under a missing completely at random (MCAR) assumption [18]. The E-step uses estimates from a ﬁtting method to impute missing data, and the M-step calls that ﬁtting method to estimate a mean function. This extends several classic non-parametric methods [31, 19] and the baseline-only version of a semi-parametric mean function estimation method [29] to the setting of missing data.
We analyze our EM algorithm using the frameworks described in [3, 34] and obtain ﬁnite sample guarantees. This requires care as we extend their work from the parametric to the non-parametric setting. This paper addresses three major theoretical challenges in the context of functional EM by: (i) noting that an inﬁnite dimensional derivative in our setting is analogous to the inner products used in [34, 3], (ii) using a more general technique for showing local uniform strong concavity of our population E-step than previous work, which relied on quadratic dependence on parameters, and (iii) a high probability ﬁnite sample bound on the convergence of the M-step. The lack of ground truth for missing data in real-world settings makes evaluation difﬁcult and theoretical guarantees important.
Finally, our proposed algorithm can consistently estimate the mean function even when the Poisson process assumption is violated. This is achieved by recovering the population MLE, and noting that under certain integrability conditions the population MLE of the Poisson process log-likelihood is the true mean function of the counting process, even when the counting process is not Poisson.
We analyze two datasets empirically. We ﬁrst look at a bladder tumor dataset where there are no missing intervals, and simulate missingness under missing completely at random (MCAR), missing at random (MAR), and missing not at random (MNAR) for various initializations and missingness probabilities. We ﬁnd that recovery under MCAR tends to be very close to if we had complete data, as long as initialization is good. MAR also shows strong performance and MNAR shows relatively strong performance. We further analyze a recent smoking cessation dataset, where the system targets 3-4 prompts per day asking about smoking counts since the last assessment, but sometimes there are fewer responses. We treat self-reports over 24 hours as unreliable or missing data. We ﬁnd that there is a difference of 21.7% in the ﬁnal estimates of smoking counts of a 14 day study when using our
EM algorithm vs believing their responses over these long intervals. 2