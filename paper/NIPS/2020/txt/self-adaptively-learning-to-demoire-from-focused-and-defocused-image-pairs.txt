Abstract
Moiré artifacts are common in digital photography, resulting from the interference between high-frequency scene content and the color ﬁlter array of the camera.
Existing deep learning-based demoiréing methods trained on large scale datasets are limited in handling various complex moiré patterns, and mainly focus on demoiréing of photos taken of digital displays. Moreover, obtaining moiré-free ground-truth in natural scenes is difﬁcult but needed for training. In this paper, we propose a self-adaptive learning method for demoiréing a high-frequency image, with the help of an additional defocused moiré-free blur image. Given an image degraded with moiré artifacts and a moiré-free blur image, our network predicts a moiré-free clean image and a blur kernel with a self-adaptive strategy that does not require an explicit training stage, instead performing test-time adaptation.
Our model has two sub-networks and works iteratively. During each iteration, one sub-network takes the moiré image as input, removing moiré patterns and restoring image details, and the other sub-network estimates the blur kernel from the blur image. The two sub-networks are jointly optimized. Extensive experiments demonstrate that our method outperforms state-of-the-art methods and can produce high-quality demoiréd results. It can generalize well to the task of removing moiré artifacts caused by display screens. In addition, we build a new moiré dataset, including images with screen and texture moiré artifacts. As far as we know, this is the ﬁrst dataset with real texture moiré patterns. 1

Introduction
Image demoiréing is the task of removing moiré patterns from images, taken by digital cameras from screens or from natural images with high-frequency patterns. Moiré artifacts are caused by the interference between the color ﬁlter array (CFA) of a camera and high-frequency repetitive signals, which can result from an LCD screen’s subpixel layout or a natural scene’s high-frequency repetitive patterns (e.g., textures on clothes). Image demoiréing is challenging as the moiré patterns vary in shape, color, and frequency. Existing deep learning based demoiréing models [39, 20, 12, 50, 24] rely heavily on training with large amounts of annotated clean and moiré image pairs in order to obtain good performance. However, the models are still limited in handling various complex moiré patterns.
Moreover, these models are restricted to perform demoiréing of images captured from screens, having difﬁculty in removing moiré artifacts from natural images.
Lack of high-quality training data also limits the performance of supervised methods. There are two public datasets for screen image demoiréing, which are TIP2018 dataset [39] and LCDMoire dataset
[46, 47]. TIP2018 is a real dataset with slight misalignment between each image pair and LCDMoire
∗Corresponding author 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
is a synthetic dataset. Because both datasets were developed for screen image demoiréing, they are unsuitable to train a model to remove moiré patterns from images of high-frequency textures.
To reduce moiré artifacts, some digital-camera manufacturers design special hardware, including special CFAs (Fuji’s X-Trans, Sigma SD Quattro) and variable low-pass ﬁlters (Sony RX1RM2).
Special CFAs and variable low-pass ﬁlters require special hardware design and thus cannot be widely used on smartphones.
In this paper, we propose a self-adaptive learning method for image demoiréing. Our method removes moiré patterns from a moiré image with the help of a moiré-free blur image. We design a defocusing method to model the low-pass ﬁlter to obtain the blur image without moiré patterns. We use it as an additional input (defocused moiré-free image) to help remove moiré patterns from the moiré image (focused), and treat it as a joint ﬁltering problem. Our method can be easily applied to any digital camera. During the focusing process, a defocused blur image can be stored and combined with the focused image to perform image demoiréing. Deep image prior [17] shows that the structure of a generator network can capture a great deal of low-level image statistics without any training. In our model, we use a 3-layer fully connected sub-network to generate a blur kernel, and adopt a U-Net-like encoder/decoder architecture to perform image demoiréing. Neither network is learned in an explicit training stage; but rather they are learned at test-time through an iterative, self-adaptive optimization.
In summary, our main contributions are: 1. We propose a self-adaptive learning method for image demoiréing, which uses an additional input (defocused moiré-free image) to help remove moiré patterns from the focused moiré image. 2. We create a new dataset with pairs of focused moiré and defocused moiré-free images, containing both screen moiré images and high-frequency texture moiré images2. 3. Quantitative and qualitative experimental results on both public and our datasets show that our model outperforms state-of-the-art methods. 4. Our method, without a training stage, can be easily applied to any digital camera or smart-phone. 2