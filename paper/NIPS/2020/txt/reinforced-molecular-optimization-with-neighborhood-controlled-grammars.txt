Abstract
A major challenge in the pharmaceutical industry is to design novel molecules with speciﬁc desired properties, especially when the property evaluation is costly. Here, we propose MNCE-RL, a graph convolutional policy network for molecular opti-mization with molecular neighborhood-controlled embedding grammars through reinforcement learning. We extend the original neighborhood-controlled embed-ding grammars to make them applicable to molecular graph generation and design an efﬁcient algorithm to infer grammatical production rules from given molecules.
The use of grammars guarantees the validity of the generated molecular structures.
By transforming molecular graphs to parse trees with the inferred grammars, the molecular structure generation task is modeled as a Markov decision process where a policy gradient strategy is utilized. In a series of experiments, we demonstrate that our approach achieves state-of-the-art performance in a diverse range of molecular optimization tasks and exhibits signiﬁcant superiority in optimizing molecular properties with a limited number of property evaluations. 1

Introduction
Traditional drug discovery relies on the development and exploration by expert chemists and pharma-cologists, which is time-consuming due to the large chemical structure space [33]. Effective methods for collecting chemical structures with desired properties will signiﬁcantly reduce the number of candidates for wet-lab experiments and thus accelerate the development of novel drugs.
Recently, several methods have been proposed to solve the molecular optimization problem within the deep learning framework [16, 36, 17, 19, 30, 10]. The major challenges for molecular optimization mainly lie in generating valid molecular structures and efﬁciently exploring the vast chemical structure space. Although several methods, including [34, 19, 16, 36], have been proposed to solve the ﬁrst challenge, they either involve complex network architectures or struggle to optimize properties due to the choices of molecular representations [16, 19]. The second challenge is addressed by Bayesian optimization (BO) [16, 19, 25] and reinforcement learning (RL) [36]. However, few of these methods considered the high cost to evaluate molecular properties in real-world applications [17]. In fact, for most chemical and biological properties, such as antibacterial, anticancer and teratogenicity, there are no known explicit functions to directly interpret a chemical structure as a corresponding numerical property score. Hence, time-consuming wet-lab experiments or simulations are typically required to evaluate these properties of molecules, resulting in a limited number of molecules with validated
∗Minlie Huang and Tao Jiang are the co-corresponding authors. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Figure 1: Illustration of our framework. We ﬁrst infer a molecular NCE grammar by representing molecules as molecular graphs, parsing the graphs using neighborhood-controlled rules, and extracting the production rules. In the generation process, a GCN-based policy network samples a sequence of productions from the action space and obtains rewards from the reward function. The reward function measures the speciﬁc property of the molecule decoded from the generated action sequence. properties. Therefore, generating molecules with desired properties using a small number of property evaluations as well as a small number of molecules with known properties is critical.
To tackle these challenges, we propose MNCE-RL, an RL-based framework using the proposed molecular neighborhood-controlled embedding grammars and a graph convolutional network (GCN).
The molecular neighborhood-controlled embedding graph grammars are extended from neighborhood-controlled embedding (NCE) grammars [7, 14], which are a type of sequential context-free graph grammars. As shown in Figure 1, a molecular NCE grammar can be inferred from the input molecular graphs so that each molecule can be represented as a parse tree. In the generation process, an RL agent generates a sequence of production rules, and receives a reward from the environment, which measures the speciﬁc property of the generated molecule, that can be used to update the GCN policy network. Our proposed molecular NCE grammars guarantee the chemical validity and the RL agent can efﬁciently explore the vast chemical structure space.
Our major contributions include 1) a novel molecular NCE grammar and an efﬁcient algorithm to infer production rules from given molecules, where the grammar provides a way to simplify the generation of valid molecules; 2) a novel GCN architecture updating both node and edge features to compute feature vectors for nodes in molecular graphs, where the update of edge features in the
GCN makes it possible to capture subtle physical differences between bonds with the same labels and thus lead to better node features for policy decision making; 3) the experimental results show that MNCE-RL signiﬁcantly outperforms state-of-the-art methods in molecular optimization and has a high potential to be useful in drug discovery. 2