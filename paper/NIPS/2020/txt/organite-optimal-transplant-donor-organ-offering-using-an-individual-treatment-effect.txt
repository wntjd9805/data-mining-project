Abstract
Transplant-organs are a scarce medical resource. The uniqueness of each organ and the patients’ heterogeneous responses to the organs present a unique and challeng-ing machine learning problem. In this problem there are two key challenges: (i) assigning each organ "optimally" to a patient in the queue; (ii) accurately estimating the potential outcomes associated with each patient and each possible organ. In this paper, we introduce OrganITE, an organ-to-patient assignment methodology that assigns organs based not only on its own estimates of the potential outcomes but also on organ scarcity. By modelling and accounting for organ scarcity we signiﬁcantly increase total life years across the population, compared to the existing greedy approaches that simply optimise life years for the current organ available.
Moreover, we propose an individualised treatment effect model capable of address-ing the high dimensionality of the organ space. We test our method on real and simulated data, resulting in as much as an additional year of life expectancy as compared to existing organ-to-patient policies. 1

Introduction
For patients with endstage diseases, organ-transplantation surgery is often a last resort. With an increasing number of donors and patients in need of a transplant [1, 2]– organ transplantation surgeries have doubled in the last ﬁfteen years [3] –ﬁnding the best recipient for each available organ is becoming an ever more important problem. Though the problem is one of treatment effect estimation and resource allocation, unique challenges arise in each sub-problem in the setting of organ transplantation.
The problem. There are several possible objectives we could consider optimising in the setting of organ matching, e.g. total life years of the population, number of deaths in the waiting queue, deaths before 5 years after transplant, etc. We focus on the objective of maximising the total life 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
years of the population (or equivalently the mean life expectancy), a discussion on the morality of this objective is provided in our broader impact section at the end of this paper. Even with a clearly deﬁned metric, assigning organs to patients involves a challenging balance of several aspects: (i) optimality in this setting is subject to a Pareto efﬁciency - assigning an organ to a patient implies not assigning the organ to other patients; (ii) each organ is unique and high-dimensional, thus rendering outcome estimation for each (also unique) patient very difﬁcult; (iii) organs arrive in a stream - while the current organ might result in a positive outcome for a patient, future organs might have an even greater positive outcome (and we do not know which organs will become available in the future); (iv) each patient will die soon if not given an organ and thus has (potential) access to only a limited number of organs.
Transplant surgery is an invasive procedure. Besides rarity of an organ, an organ-to-patient assignment policy should be based on the difference between transplanting the organ and not, rather than either outcome alone. Both outcomes will therefore need to be estimated, though no paired observations are present in the data - all patients either received or did not receive an organ. This is the well-studied problem of individualised treatment effect (ITE) estimation [4–7].
In signiﬁcant contrast to our setting, though, most existing work for ITE estimation focuses on a single binary treatment (e.g. [4, 5, 7]). Few methods exist that can naturally handle even multiple categorical treatments (e.g. [6]). Methods addressing the continuous setting (e.g. treatments with a dosage) have typically only been applied to one-dimensional treatments (e.g. [8]). Performing ITE estimation in organ transplantation is non-trivial for several reasons: (i) organs - our treatments - are high dimensional, with a mixture of continuous and categorical features; (ii) observational data for organ transplantation is highly biased towards organ-assignment policies already in place; (iii) organs are unique and limited - each patient’s ideal organ may not be available to them. It is exactly this last challenge that makes the problem of transplant-organ assignment so interesting.
Estimating outcomes is not enough. Contemporary organ-to-patient matching policies assign an organ to the patient based on estimated outcomes (e.g., life expectancy or survival probability) [9].
Indeed, by increasing outcome prediction accuracy, one can better optimise relevant metrics such as life expectancy [10]. However, such policies fail to account for the arrival distribution of organs and thus ignore (iii) and (iv) above. The importance of how rare an organ is, is a direct result of every patient’s deteriorating condition. When a particular patient is in need of a rare type of organ, they might need to settle for a less suitable organ that is available now. Moreover, the organ may be a better ﬁt for someone else, but that other patient may be in better condition and thus able to wait longer for a second suitable organ to be available. Such a consideration is completely ignored when a policy focuses solely on a patient’s potential outcomes. Figure 1a illustrates why organ density is an important consideration and Figure 1b compares existing policies’ considerations with OrganITE’s.
While rarity of an organ has previously been taken into account through sensitization levels in the kidney exchange setting [11], OrganITE is the ﬁrst to explicitly model the organ density.
In this paper we propose a high-dimensional ITE estimator and an
Our contribution: OrganITE. organ-to-patient assignment policy that accounts for organ rarity. For our ITE estimator, we create a latent space of patient-organ pairs, balanced using domain adversarial training, upon which we build an outcome predictor. For our organ-to-patient policy, we rank patient-organ pairs based on three criteria: (i) the organ-to-patient match in terms of an organ’s ITE on life expectancy, (ii) how distant the organ is to the patient’s optimal organ, and (iii) organ rarity. We conduct experiments on a mixture of real and synthetic data, with the real data consisting of 26 years of organ transplantation surgery in the UK (approx. 19k patients). Our experiments demonstrate the efﬁcacy of our method, by demonstrating a higher life expectancy and fewer deaths, both before and after transplant surgery, in comparison to other policies. 2