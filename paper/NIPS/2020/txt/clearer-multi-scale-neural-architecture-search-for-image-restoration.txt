Abstract
Multi-scale neural networks have shown effectiveness in image restoration tasks, which are usually designed and integrated in a handcrafted manner. Different from the existing labor-intensive handcrafted architecture design paradigms, we present a novel method, termed as multi-sCaLe nEural ARchitecture sEarch for image
Restoration (CLEARER), which is a speciﬁcally designed neural architecture search (NAS) for image restoration. Our contributions are twofold. On one hand, we design a multi-scale search space that consists of three task-ﬂexible modules. Namely, 1) Parallel module that connects multi-resolution neural blocks in parallel, while preserving the channels and spatial-resolution in each neural block, 2) Transition module remains the existing multi-resolution features while extending them to a lower resolution, 3) Fusion module integrates multi-resolution features by passing the features of the parallel neural blocks to the current neural blocks.
On the other hand, we present novel losses which could 1) balance the tradeoff between the model complexity and performance, which is highly expected to image restoration; and 2) relax the discrete architecture parameters into a continuous distribution which approximates to either 0 or 1. As a result, a differentiable strategy could be employed to search when to fuse or extract multi-resolution features, while the discretization issue faced by the gradient-based NAS could be alleviated. The proposed CLEARER could search a promising architecture in two GPU hours. Extensive experiments show the promising performance of our method comparing with nine image denoising methods and eight image deraining approaches in quantitative and qualitative evaluations. The codes are available at https://github.com/limit-scu. 1

Introduction
Due to the complicated environments and the quality of digital image acquisition devices, the captured images are often contaminated by various of signal-dependent or -independent noises. To recover the clean image from the observed noisy image, a huge number of image restoration methods [30, 1, 5, 10] have been proposed based on different handcrafted priors. However, once the prior is inconsistent with the real data distribution, an unpleasant recovery will be achieved.
∗Corresponding author 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Different from the prior-based methods, some deep learning based methods adopt a data-driven fashion to remove the possible corruptions by mapping the degraded images to the latent clean versions, which have achieved state-of-the-art performance. In other words, these so-called learning-based methods substitute the explicit and handcrafted image priors with implicit and learning-based priors which are captured by neural architectures [41, 11, 29]. Hence, it is considerably important to seek an effective neural network architecture for facilitating image restoration. As a matter of fact, the advances of image restoration in recent years are beneﬁted from the developments of various handcrafted neural network architectures [27, 14, 15, 19, 24, 40, 31, 34].
In these handcrafted models, multi-scale architectures [16, 37, 33, 35, 39, 42] have played a signif-icant role in improving the performance, of which the basic idea is to fuse features with different resolutions/scales. The success of multi-scale methods are attributed to different roles of low- and high-resolution networks. In brief, the low-resolution networks could capture the global structure of the given image, while losing the perception of details. In contrast, the high-resolution networks could preserve the local details of images, while being with less semantics and robustness to noise.
As either using low- or high-scale information alone cannot guarantee encouraging recovery, it is highly expected to use them together so that their merits are taken and the demerits are overcome.
Although it is well-known that multi-resolution fusion is helpful to boosting image recovery perfor-mance [7, 12, 44, 23], it is difﬁcult to obtain an effective architecture and almost all existing works rely on human design. Such a handcrafted paradigm has suffered from the following limitations.
First, it is labor-intensive to seek an effective architecture, while the image recovery performance is sensitive to neural architecture according to the advances in recent years. Especially, multi-scale networks often consist of multiple subnetworks, which further increases the difﬁculty of handcrafted design. Second, one more daunting task of multi-scale architecture design is unknown when to fuse multi-scale features. Third, as multi-scale network is more complex than the single-scale one, it is highly expected to ﬁnd an elegant tradeoff between the model complexity and recovery quality.
Clearly, it is difﬁcult to achieve the above goals through human design.
To overcome the aforementioned limitations, we propose a novel method, termed as multi-sCaLe nEural ARchitecture sEarch for image Restoration (CLEARER), which could be one of the ﬁrst attempts towards automatic integration and design of multi-resolution neural architectures. The contributions and novelty could be summarized as follows:
• We propose a multi-resolution search space consisting of three task-ﬂexible modules, i.e., parallel module, transition module, and fusion module. All these modules are speciﬁcally designed to facilitate image restoration. With the increasing depth of our CLEARER, a series of high-to-low resolution subnetworks (cells) are gradually added one by one.
• We propose employing a data-driven strategy to search when to fuse low- and high-resolution features with the help of our novel loss function. The proposed method is time efﬁcient, which only takes two hours to search architectures using a single V100 GPU.
• We show a feasible solution to formulate the model complexity into our loss function in a differentiable manner. In other words, our method could control the balance between performance and model size, which is highly expected to a wide range of applications including resource-constrained scenario. In addition, to avoid the trivial solution caused by the continuous relaxation using softmax, an architecture loss is proposed which could polarize the distribution of architecture parameters, i.e., approach to 0 or 1. 2