Abstract
Time-reversal symmetry, which requires that the dynamics of a system should not change with the reversal of time axis, is a fundamental property that frequently holds in classical and quantum mechanics. In this paper, we propose a novel loss function that measures how well our ordinary differential equation (ODE) networks comply with this time-reversal symmetry; it is formally deﬁned by the discrepancy in the time evolutions of ODE networks between forward and backward dynamics.
Then, we design a new framework, which we name as Time-Reversal Symmetric
ODE Networks (TRS-ODENs), that can learn the dynamics of physical systems more sample-efﬁciently by learning with the proposed loss function. We evaluate
TRS-ODENs on several classical dynamics, and ﬁnd they can learn the desired time evolution from observed noisy and complex trajectories. We also show that, even for systems that do not possess the full time-reversal symmetry, TRS-ODENs can achieve better predictive performances over baselines. 1

Introduction
Recent advances in artiﬁcial intelligence allow researchers to recover laws of physics and predict dynamics of physical systems from observed data by utilizing machine learning techniques, e.g., evolutionary algorithms [37, 29], sparse optimizations [35, 4], Gaussian process regressions [40, 8], and neural networks [18, 1, 15, 46, 34]. Among various models, the neural networks are considered as one of the most powerful tools to model complicated physical phenomena, owing to their remarkable ability to approximate arbitrary functions [17]. One notable aspect of the observations in physical systems is that they manifest some fundamental properties including conservation or invariance
[14, 2]. However, it is not straightforward for neural networks to learn and model the embedded physical properties from observed data only. Consequently, they often overﬁt to short-term training trajectories and fail to predict the long-term behaviors of complex dynamical systems [15, 46].
To overcome these issues, it is important to introduce appropriate inductive biases based on knowledge of physics, dynamics and their properties [46, 34]. Common approaches to incorporate physics-based inductive bias include modifying neural network architectures or introducing regularization terms based on specialized knowledge of physics and natural sciences [31, 28, 38, 39]. These methods demonstrate impressive performance on their target problems, but such a problem-speciﬁc model suffers from generalizing across domains. Namely, they can be used only when the governing physics for the target domain is exactly known, e.g., Navier-Stokes equation for ﬂuid mechanics [31, 28]. As for more general approaches, the authors in [6, 5] propose the ordinary differential equation (ODE) networks, which view the neural networks as parameterized ODE functions. They are shown to be able to represent the vast majority of dynamical systems with higher precision over vanilla recurrent neural networks and their variants [6, 5], but are still unable to learn underlying physics such as the 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Figure 1: (a) Time-reversal symmetry of dynamical systems. The gray ellipse is a phase space trajectory, which does not change under t (cid:55)→ −t. The reversing of forward time evolution (blue arrows) of an arbitrary state should yield an equal state to what is estimated by the backward time evolution of the reversed state (orange arrows). For more mathematical details, see Section 3.2. Examples of (b) non-linear and (c) non-ideal dynamical systems modeled by various ODE networks including TRS-ODENs. TRS-ODENs can learn appropriate long-term dynamics from noisy and short-term training samples. law of conservation [15]. Recent works [15, 46, 34, 7, 43] apply the Hamiltonian mechanics to ODE networks, and succeed in enforcing the energy conservation as well as the accurate time evolution of classical conservative systems. However, these Hamiltonian ODE networks have inherent limitations that they cannot be applied to non-conservative systems, since the Hamiltonian structures require to strictly conserve the total energy [15].
To address such limitations of existing works on modeling classical dynamics, we introduce a physics-inspired, general, and ﬂexible inductive bias, symmetries. It is at the heart of the physics: the laws of physics are invariant under certain transformations in space and time coordinates, thus show the universality [12, 27]. For example, the classical dynamics possess the time-reversal symmetry, which means the classical equations of motion should not change under the transformation of time reversal: t (cid:55)→ −t [23, 32, 42] (see Figure 1). Therefore, if the target underlying physics being approximated has some symmetries, it is natural that the approximated physics using neural networks should also comply with these properties. Motivated by this, we feed the symmetry as an additional information to help neural networks learn the physical systems more efﬁciently.
Speciﬁcally, we focus on the time-reversal symmetry of classical dynamics described above, due to its simplicity and popularity. We propose a new ODE learning framework, which we refer to as Time-Reversal Symmetry ODE Network (TRS-ODEN)1, that utilize the time-reversal symmetry as a regularizer in training ODE networks, by unifying recent studies of ODE networks [7] and classical symmetry theory for ODE systems [23]. Our scheme can be easily implemented with a small modiﬁcation of codes for conventional ODE networks, and is also compatible with extensions of ODE networks, such as Hamiltonian ODE networks [46, 34, 7]. It can be used to predict many branches of physical systems, because the isolated classical and quantum dynamics exhibit the perfect time-reversal symmetry [23, 33]. Moreover, even for the case when the full time-reversal symmetry are broken [23], e.g., in the presence of the entropy production [30] through heat or mass transfer, we also show that TRS-ODENs are beneﬁcial to learn such system by annealing the strength of the proposed regularizer appropriately. This ﬂexibility with regard to the target problem is the main advantage of the proposed framework, in contrast to prior methods, e.g., only for suitable explicitly conservative systems [15].We validate our proposed model in several domains including synthetic
Dufﬁng oscillators [22] (see Section 4.1), real-world coupled oscillators [37] (see Section 4.2), and reversible strange attractors [41] (see Section 4.3). In summary, our contribution is threefold:
• We propose a novel loss function that measures the discrepancy in the time evolution of
ODE networks between forward and backward dynamics, thus estimates whether the ODE networks are time-reversal symmetric or not.
• We show ODE networks with the proposed loss, coined TRS-ODENs, achieve better predictive performance than baselines, e.g., from 50.81 to 10.85 for non-linear oscillators.
• We validate even for time-irreversible systems, the proposed framework still works well compared to baselines, e.g., from 3.68 to 0.12 in terms of error for damped oscillators. 1Code is available at https://github.com/inhuh/trs-oden. 2
2