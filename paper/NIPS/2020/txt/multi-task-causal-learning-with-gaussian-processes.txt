Abstract
This paper studies the problem of learning the correlation structure of a set of intervention functions deﬁned on the directed acyclic graph (DAG) of a causal model. This is useful when we are interested in jointly learning the causal effects of interventions on different subsets of variables in a DAG, which is common in ﬁeld such as healthcare or operations research. We propose the ﬁrst multi-task causal
Gaussian process (GP) model, which we call DAG-GP, that allows for information sharing across continuous interventions and across experiments on different vari-ables. DAG-GP accommodates different assumptions in terms of data availability and captures the correlation between functions lying in input spaces of different dimensionality via a well-deﬁned integral operator. We give theoretical results detailing when and how the DAG-GP model can be formulated depending on the
DAG. We test both the quality of its predictions and its calibrated uncertainties.
Compared to single-task models, DAG-GP achieves the best ﬁtting performance in a variety of real and synthetic settings. In addition, it helps to select optimal inter-ventions faster than competing approaches when used within sequential decision making frameworks, like active learning or Bayesian optimization. 1

Introduction
Solving decision making problems in a variety of domains such as healthcare, systems biology or operations research, often requires experimentation. By performing interventions one can understand how a system behaves when an action is taken and thus infer the cause-effect relationships of a phenomenon. Experiments are especially useful when observational causal inference methods do not provide accurate estimation of the causal effects. For instance, in healthcare, drugs are tested in randomized clinical trials before commercialization. Biologists might want to understand how genes interact in a cell once one of them is knocked out. Finally, engineers investigate the impact of design changes on complex physical systems by conducting experiments on digital twins [34]. Experiments in these scenarios are usually expensive, time-consuming, and, especially for ﬁeld experiments, they may present ethical issues. Therefore, researchers generally have to trade-off cost, time, and other practical considerations to decide which experiments to conduct, if any, to learn about the system.
Consider the causal graph in Fig. 1 which describes how crop yield Y is affected by soil fumi-gants X and the level of eel-worm population at different times Z = {Z1, Z2, Z3} [11, 27]. By performing a set of experiments, the investigator aims at learning the intervention functions relating the expected crop yield to each possible intervention set and level. Naïvely, one could achieve that by modelling each intervention function separately. However, this approach would disregard the correlation structure existing across experimental outputs and would increase the computational 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
complexity of the problem. Indeed, the intervention functions are correlated and each experiment carries information about the yield we would obtain by performing alternative interventions in the graph. For instance, observing the yield when running an experiment on the intervention set {X, Z1} and setting the value to the intervention value {x, z1}, provides information about the yield we would get from intervening only on X or on {X, Z1, Z2, Z3}. This paper studies how to jointly model such intervention functions so as to transfer knowledge across different experimental setups and integrate observational and interventional data. The model proposed here enables proper uncertainty quan-tiﬁcation of the causal effects thus allowing the deﬁnition of optimal experimental design strategies. 1.1 Motivation and Contributions
The framework proposed in this work combines causal inference with multi-task learning via Gaussian processes (GP, [30]). Prob-abilistic causal models are commonly used in disciplines where explicit experimentation may be difﬁcult and the do-calculus [27] enables prediction of the effect of an intervention without perform-ing the experiment. In do-calculus, different intervention functions are modelled individually and there is no information shared across experiments. Modelling the correlation across experiments is crucial especially when the number of observational data points is limited and experiments on some variables cannot be performed. Multi-task
GP methods have been extensively used to model non-trivial corre-lations between outputs [4]. However, to the best of our knowledge, this is the ﬁrst work focusing on intervention functions, possibly of different dimensionality, deﬁned on a causal graph. Particularly, we make the following contributions:
Figure 1: DAG for the crop yield. Nodes denote variables, arrows represent causal effects and dashed edges indicate un-observed confounders.
• We give theoretical results detailing when and how a causal multi-task model for the experimental outputs can be developed depending on the topology of the DAG of a causal model.
• Exploiting our theoretical results, we develop a joint probabilistic model for all intervention functions, henceforth named DAG-GP, which ﬂexibly accommodates different assumptions in terms of data availability – both observational and interventional.
• We demonstrate how DAG-GP achieves the best ﬁtting performance in a variety of experimental settings while enabling proper uncertainty quantiﬁcation and thus optimal decision making when used within Active Learning (AL) and Bayesian Optimization (BO). 1.2