Abstract
Diffusion-weighted magnetic resonance imaging (DWI) is the only noninvasive method for quantifying microstructure and reconstructing white-matter pathways in the living human brain. Fluctuations from multiple sources create signiﬁcant addi-tive noise in DWI data which must be suppressed before subsequent microstructure analysis. We introduce a self-supervised learning method for denoising DWI data,
Patch2Self, which uses the entire volume to learn a full-rank locally linear denoiser for that volume. By taking advantage of the oversampled q-space of DWI data,
Patch2Self can separate structure from noise without requiring an explicit model for either. We demonstrate the effectiveness of Patch2Self via quantitative and qualitative improvements in microstructure modeling, tracking (via ﬁber bundle coherency) and model estimation relative to other unsupervised methods on real and simulated data. 1

Introduction
Diffusion Weighted Magnetic Resonance Imaging (DWI) [3] is a powerful method for measuring tissue microstructure [33, 34]. Estimates of the diffusion signal in each voxel can be integrated using mathematical models to reconstruct the white matter pathways in the brain. The ﬁdelity of those inferred structures is limited by the substantial noise present in DWI acquisitions, due to numerous factors including thermal ﬂuctuations. With new acquisition schemes or diffusion-encoding strategies, the sources and distribution of the noise can vary, making it difﬁcult to model and remove. The noise confounds both qualitative (visual) and quantitative (microstructure and tractography) analysis.
Denoising is therefore a vital processing step for DWI data prior to anatomical inference.
DWI data consist of many 3D acquisitions, in which diffusion along different gradient directions is measured. Simple models of Gaussian diffusion are parametrized by a six-dimensional tensor, for which six measurements would be sufﬁcient, but as each voxel may contain an assortment of tissue microstructure with different properties, many more gradient directions are often acquired. While each of these acquired volumes may be quite noisy, the fact that the same structures are represented in each offers the potential for signiﬁcant denoising.
The ﬁrst class of denoising methods used for DWI data were extensions of techniques developed for 2D images, such as non-local means (NL-means [9] and its variants [36, 8]), total variation norm minimization [24], cosine transform ﬁltering [30], empirical Bayes [2] and correlation based joint
ﬁltering [47]. Other methods take more direct advantage of the fact that DWI measurements have a special 4D structure, representing many acquisitions of the same 3D volume at different b-values and in different gradient directions. Assuming that small spatial structures are more-or-less consistent across these measurements, these methods project to a local low-rank approximation of the data
[37, 31]. The top performing methods are overcomplete Local-PCA (LPCA) [31] and its Marchenko-Pastur extension [48]. The current state-of-the-art unsupervised method for denoising DWI is the
Marchenko-Pastur PCA, which handles the choice of rank in a principled way by thresholding based on the eigenspectrum of the expected noise covariance matrix. Note that Marchenko-Pastur PCA, 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
like the classical total variation norm and NL-means methods as well, requires a noise model to do the denoising, either as an explicit standard deviation and covariance as in LPCA, or implicitly in the choice of a noise correction method [25, 44].
We propose a self-supervised denoising method for DWI data that incorporates the key features of successful prior methods while removing the requirement to select or calibrate a noise model. Our method, Patch2Self, learns locally linear relationships between different acquisition volumes on small spatial patches. This regression framework satisﬁes the J -invariance property described in [4], which, as long as the noise in different acquisitions is statistically independent, will guarantee denoising performance. With thorough comparisons on real and simulated data, we show that Patch2Self outperforms other unsupervised methods for denoising DWI at visual and modeling tasks. 2
Self-Supervised Local Low Rank Approximation 2.1 Approach and