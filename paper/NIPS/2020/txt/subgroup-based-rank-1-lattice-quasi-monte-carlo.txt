Abstract
Quasi-Monte Carlo (QMC) is an essential tool for integral approximation, Bayesian inference, and sampling for simulation in science, etc. In the QMC area, the rank-1 lattice is important due to its simple operation, and nice properties for point set construction. However, the construction of the generating vector of the rank-1 lattice is usually time-consuming because of an exhaustive computer search. To address this issue, we propose a simple closed-form rank-1 lattice construction method based on group theory. Our method reduces the number of distinct pairwise distance values to generate a more regular lattice. We theoretically prove a lower and an upper bound of the minimum pairwise distance of any non-degenerate rank-1 lattice. Empirically, our methods can generate a near-optimal rank-1 lattice compared with the Korobov exhaustive search regarding the l1-norm and l2-norm minimum distance. Moreover, experimental results show that our method achieves superior approximation performance on benchmark integration test problems and kernel approximation problems. 1

Introduction
Integral operation is critical in a large amount of interesting machine learning applications, e.g. kernel approximation with random feature maps [29], variational inference in Bayesian learning [3], generative modeling and variational autoencoders [15]. Directly calculating an integral is usually infeasible in these real applications. Instead, researchers usually try to ﬁnd an approximation for the integral. A simple and conventional approximation is Monte Carlo (MC) sampling, in which the integral is approximated by calculating the average of the i.i.d. sampled integrand values. Monte
Carlo (MC) methods [12] are widely studied with many techniques to reduce the approximation error, which includes importance sampling and variance reduction techniques and more [1].
To further reduce the approximation error, Quasi-Monte Carlo (QMC) methods utilize a low dis-crepancy point set instead of the i.i.d. sampled point set used in the standard Monte Carlo method.
There are two main research lines in the area of QMC [8, 25], i.e., the digital nets/sequences and lattice rules. The Halton sequence and the Sobol sequence are the widely used representatives of digital sequences [8]. Compared with digital nets/sequences, the points set of lattice rules preserve the properties of lattice. The points partition the space into small repeating cells. Among previous research on the lattice rules, Korobov introduced integration lattice rules in [16] for an integral approximation of the periodic integrands. [33] proves that there also exist good lattice rules for
∗Correspondence to: yueminglyu@gmail.com and Ivor.Tsang@uts.edu.au 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
(a) i.i.d. Monte Carlo sampling (b) Sobol sequence (c) Our subgroup rank-1 lattice
Figure 1: The 89 points constructed by i.i.d. Monte Carlo sampling, Sobol sequence and our subgroup rank-1 lattice on [0, 1]2. non-periodic integrands. According to general lattice rules, a point set is usually constructed by enumerating the integer vectors and multiplying them with an invertible generator matrix. A general lattice rule has to check each constructed point to see whether it is inside a unit cube and discard it if it is not. The process is repeated until we reach the desired number of points. This construction process is inefﬁcient since the checking step is required for every point. Note that rescaling the unchecked points by the maximum norm of all the points may lead to non-uniform points set in the cube.
An interesting special case of the lattice rules is the rank-1 lattice, which only requires one generating vector to construct the whole point set. Given the generating vector, rank-1 lattices can be obtained by a very simple construction form. It is thus much more efﬁcient to construct the point set with the simple construction form. Compared with the general lattice rule, the construction form of the rank-1 lattice has already guaranteed the constructed point to be inside the unit cube, therefore, no further checks are required. We refer to [8] and [25] for a more detailed survey of QMC and rank-1 lattice.
Although the rank-1 lattice can derive a simple construction form, obtaining the generating vector remains difﬁcult. Most methods [17, 26, 9, 21, 20, 18, 27] in the literature rely on an exhaustive computer search by optimizing some criteria to ﬁnd a good generating vector. Korobov [17] suggests searching the generating vector in a form of [1, α, α2, · · · , αd−1] with α ∈ {1, · · · , n − 1}, where d is the dimension and n is the number of points, such that the greatest common divisor of α and n equals to 1. Sloan et al. study the component-by-component construction for the lattice rules [32]. It is a greedy search that is faster than an exhaustive search. Nuyens et al. [26] propose a fast algorithm to construct the generating vector using a component-by-component search method. Although the exhaustive checking steps are avoided compared with general lattice rules, the rank-1 lattice still requires a brute-force search for the generating vector, which is still very time-consuming, especially when the dimension and the number of points are large.
To address this issue, we propose a closed-form rank-1 lattice rule that directly computes a generating vector without any search process. To generate a more evenly spaced lattice, we propose to reduce the number of distinct pairwise distance in the lattice point set to make the lattice more regular w.r.t. the minimum toroidal distance [11]. Larger minimum toroidal distance means more regular.
Based on group theory, we derive that if the generating vector z satisﬁes the condition that set
{z, −z} := {z1, · · · , zd, −z1, · · · , −zd} is a subgroup of the multiplicative group of integers modulo n, where n is the number of points, then the number of distinct pairwise distance can be efﬁciently reduced. We construct the generating vector by ensuring this condition. With the proposed subgroup-based rank-1 lattice, we can construct a more evenly spaced lattice. An illustration of the generated lattice is shown in Figure 1. Our contributions are summarized as follows:
• We propose a simple and efﬁcient closed-form method for rank-1 lattice construction, which does not require the time-consuming exhaustive computer search that previous rank-1 lattice algorithms rely on. A side product is a closed-form method to generate QMC points set on sphere Sd−1 with bounded mutual coherence, which is presented in Appendix.
• We generate a more regular lattice by reducing the number of distinct pairwise distances.
We prove a lower and an upper bound for the minimum l1-norm-based and l2-norm-based toroidal distance of the rank-1 lattice. Theoretically, our constructed lattice is the optimal rank-1 lattice for maximizing the minimum toroidal distance when the number of points n is a prime number and n = 2d + 1. 2
• Empirically, the proposed method generates near-optimal rank-1 lattice compared with the
Korobov search method in maximizing the minimum of the l1-norm-based and l2-norm-based toroidal distance.
• Our method obtains better approximation accuracy on benchmark test problems and kernel approximation problem. 2