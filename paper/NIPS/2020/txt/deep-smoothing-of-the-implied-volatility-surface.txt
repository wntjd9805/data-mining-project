Abstract
We present a neural network (NN) approach to ﬁt and predict implied volatility surfaces (IVSs). Atypically to standard NN applications, ﬁnancial industry prac-titioners use such models equally to replicate market prices and to value other
ﬁnancial instruments. In other words, low training losses are as important as generalization capabilities. Importantly, IVS models need to generate realistic arbitrage-free option prices, meaning that no portfolio can lead to risk-free proﬁts.
We propose an approach guaranteeing the absence of arbitrage opportunities by penalizing the loss using soft constraints. Furthermore, our method can be com-bined with standard IVS models in quantitative ﬁnance, thus providing a NN-based correction when such models fail at replicating observed market prices. This lets practitioners use our approach as a plug-in on top of classical methods. Empirical results show that this approach is particularly useful when only sparse or erroneous data are available. We also quantify the uncertainty of the model predictions in regions with few or no observations. We further explore how deeper NNs improve over shallower ones, as well as other properties of the network architecture. We benchmark our method against standard IVS models. By evaluating our method on both training sets, and testing sets, namely, we highlight both their capacity to reproduce observed prices and predict new ones. 1

Introduction
The implied volatility surface (IVS) is a key input for computing margin requirements for brokers, quotes for market makers, prices of exotic derivatives for quants, and strategies positions for traders.
As a result, tiny predictions errors can lead to dramatic ﬁnancial losses. But standard IVS models often lack the ability to ﬂexibly reproduce market prices and value other instruments without quotes.
In this paper, we merge known ideas from different ﬁelds, namely machine learning (ML) and mathematical ﬁnance, to build a new solution for a non-trivial and relevant ﬁnancial problem: the interpolation and extrapolation of the IVS. More speciﬁcally, we use a neural network (NN) to correct the IVS produced by any standard model. This lets practitioners plug our method on top of existing approaches while offering an unprecedented trade-off between ﬂexibility and computational complexity. This problem was initially brought to us by a ﬁnancial institution willing to improve its existing solution and a version of this method is being tested in production by a ﬁnancial institution, where thousands of models are continuously updated throughout the day and used as inputs to various quantitative tools.
Practitioners have a growing interest to leverage NNs as ﬂexible predictors for applications requiring an understanding of the complex dynamics of ﬁnancial markets. And the ML community continues 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
to build better tools and understanding deep models. But leveraging domain expertise about a speciﬁc problem is often difﬁcult, and still an active ﬁeld of research. In this paper, we show how knowledge from both ML and mathematical ﬁnance can be merged to build a well performing and consistent hybrid model. Our application focuses on options, yet, the same approach could be similarly applied to other ﬁnancial problems.
Problem setting and background context. An option is a ﬁnancial contract giving the option holder the right to buy (a call option) or the right to sell (a put option) an asset, such as a stock or a commodity, for a predetermined price (the strike price) on a predetermined date (the expiry date). An initial premium must be paid to the option seller in order to acquire today the right to buy or sell and asset in the future at, possibly, a preferential price. The standard, textbook approach to model option pricing is based on the so-called Black-Scholes (BS) formula. The Black-Scholes formula provides a closed-form formula for option prices for a speciﬁc stock price model, the geometric Brownian motion (GBM). However, the formula builds on unrealistic assumptions such as continuous price trajectory and trading, absence of market frictions such as bid-ask spread and integer contract size, and normality of log-returns. Options are traded on ﬁnancial exchanges, and their prices typically invalidate the GBM model. The Black-Scholes formula is a convenient one-to-one mapping between a price and a volatility parameter that is preferred by practitioners for a variety of reasons. For example, it allows them to easily compare the price of options with different contract strike prices and maturities. As a consequence, a lot of domain expertise has been developed for the so-called implied volatility surface (IVS): the continuous representation of this volatility parameter expressed as a function of the strike price and of the expiry at a given point in time. However, only a ﬁnite number of option prices are observed in practice. In addition, quoted option prices should not allow arbitrage opportunities, that is, constructing a portfolio that may generate proﬁts at a zero initial cost. Therefore the two main challenges when modeling the implied volatility surface are, ﬁrst, to ensure that the corresponding option prices do not allow arbitrage opportunities and, second, the generalization to an entire surface given a limited number of observations. Such a construction allows the IVS to be used as input to price ﬁnancial derivatives in a consistent way, and that enables effective risk-management. It is then worth noting that some commonly used models, such as SABR [26] and
SVI [18], may not be arbitrage-free for some parameters values, see for example [48, Section 3], which contradicts real-life scenarios.
Short literature review. As neural networks and machine learning in general, prevail almost all aspects in science and industry, ﬁnance applications have also been impacted [30, 21, 31, 9, 29]. Deep learning have been studied with applications to option pricing in [49, 27, 17, 6, 37, 42, 43]. These papers exploit the well-known universal approximation property of neural networks [35, 34, 41].
Several applications of NN models for implied volatility smoothing exist, see [14, 53, 44, 38, 52] with more details in Appendix A. [53] in his PhD thesis also studied the use of soft constraints to train an arbitrage-free model. Extensive domain speciﬁc knowledge has been built on the IVS. In this work, we will use the no-arbitrage constraints on the IVS derived in [48], and later reﬁned in [24], the moment condition of [40], and the surface SVI (SSVI) model of [20]. A more exhaustive literature review is available in Appendix A.1.
Summary of contributions. We present a new methodology to correct, interpolate, and extrapolate the implied volatility surface in an arbitrage-free way. We achieve this by modeling the implied total variance as a product of a neural network and a prior model, and by penalizing the loss using soft constraints during training so as to prevent arbitrage opportunities. The prior model should be a standard valid model for the total variance that will guide the general shape of the predictions, two examples are the Black-Scholes model and the SSVI model of [20]. The neural network is thus acting as a corrector of the prior model, enhancing its ability to reproduce observed market prices.
The soft-constraints speciﬁcation is guided by theoretical results from mathematical ﬁnance. The two elements together allow to build a realistic, ﬂexible, and parsimonious model for the IVS. We benchmark our method against standard models and study its performance both on training and testing sets, as well as on synthetic data, and real market prices of contracts on the S&P 500 index.
Numerical experiments suggest that our method appropriately captures the features of standard option pricing models. We show that increasing model capacity generally leads to better ﬁts, and that the soft constraints generally help decreasing the ﬁtting error and the convergence speed. Similar results are obtained when applying our method to real data, where an ablation study shows that constrained learning helps producing better volatility surfaces, both in interpolation and extrapolation. 2
Novelty and signiﬁcance. Since options and related derivatives are actively exchange traded contracts that are used for risk-management and investment purposes, their fair valuation requires a reliable model for the IVS. The main ambition of this work is bridging the existing gap between a traditional challenge in ﬁnance and recent developments from the deep learning community, resulting in a trust-worthy, computationally efﬁcient option pricing framework. This work is the ﬁrst peer-reviewed published work to use soft-constraints to guide the training of a deep NN model for the IVS. Previous work used hardwired constraints which limits tremendously the neural network ﬂexibility [14], or used constraints on the option price surface which requires additional transformations at each training step [44]. This work also appears to be the ﬁrst suggesting a hybrid model for the IVS combining a neural network component, and a standard model component.
Paper structure. Section 2 reviews background knowledge such as the implied volatility surface, the no-arbitrage conditions, and formulates the modeling problem. We describe the methodology in Section 3. The numerical experiments and the empirical analysis can be found in Section 4.
Section 5 discusses the broader impact. Section 5 concludes. More information on standard option pricing models, on implied volatility models, on the experiments, as well as additional results can be found in the online Appendix. 2