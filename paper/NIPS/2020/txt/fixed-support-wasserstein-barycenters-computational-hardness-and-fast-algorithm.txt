Abstract
We study the ﬁxed-support Wasserstein barycenter problem (FS-WBP), which con-sists in computing the Wasserstein barycenter of m discrete probability measures supported on a ﬁnite metric space of size n. We show ﬁrst that the constraint matrix arising from the standard linear programming (LP) representation of the FS-WBP is not totally unimodular when m ≥ 3 and n ≥ 3. This result resolves an open question pertaining to the relationship between the FS-WBP and the minimum-cost
ﬂow (MCF) problem since it proves that the FS-WBP in the standard LP form is not an MCF problem when m ≥ 3 and n ≥ 3. We also develop a provably fast deterministic variant of the celebrated iterative Bregman projection (IBP) algorithm, named FASTIBP, with a complexity bound of (cid:101)O(mn7/3ε−4/3), where ε ∈ (0, 1) is the desired tolerance. This complexity bound is better than the best known complexity bound of (cid:101)O(mn2ε−2) for the IBP algorithm in terms of ε, and that of (cid:101)O(mn5/2ε−1) from accelerated alternating minimization algorithm or acceler-ated primal-dual adaptive gradient algorithm in terms of n. Finally, we conduct extensive experiments with both synthetic data and real images and demonstrate the favorable performance of the FASTIBP algorithm in practice. 1

Introduction
Over the past decade, the Wasserstein barycenter problem [1] (WBP) has served as a foundation for theoretical analysis in a wide range of ﬁelds, including economics [12, 14] and physics [11, 16, 53] to statistics [39, 30, 51], image and shape analysis [47, 7, 8] and machine learning [19]. The
WBP problem is related to the optimal transport (OT) problem, in that both are based on the
Wasserstein distance, but the WBP is signiﬁcantly harder. It requires the minimization of the sum of Wasserstein distances, and typically considers m > 2 probability measures. Its closest relative is the multimarginal optimal transport problem [25], which also compares m measures; see Villani
[55] for a comprehensive treatment of OT theory and Peyré and Cuturi [44] for an introduction of OT applications and algorithms.
An ongoing focus of work in both the WBP and the OT problem is the design of fast algorithms for computing the relevant distances and optima and the delineation of lower bounds that capture the computational hardness of these problems [44]. For the OT problem, Cuturi [18] introduced the
Sinkhorn algorithm which has triggered signiﬁcant progress [20, 27, 2, 23, 6, 37, 33, 46, 31, 38].
Variants of the Sinkhorn and Greenkhorn algorithms [2, 23, 37] continue to serve as the baseline approaches in practice. As for the theoretical complexity, the best bound is (cid:101)O(n2ε−1) [6, 46, 33, 31].
Moreover, Lin et al. [36] provided a complexity bound for the multimarginal OT problem. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
There has been signiﬁcant effort devoted to the development of fast algorithms in the case of m > 2 discrete probability measures [47, 19, 13, 7, 4, 3, 52, 57, 10, 45, 15, 54, 22, 56, 34, 32, 29, 26, 9].
This work has provided the foundation for progress on the WBP. An important step forward was the proposal of Cuturi and Doucet [19] to smooth the WBP using an entropic regularization, leading to a simple gradient-descent scheme that was later improved and generalized under the name of the iterative Bregman projection (IBP) algorithm [4, 32]. Further progress includes the semi-dual gradient descent [20, 21], accelerated primal-dual gradient descent (APDAGD) [22, 32], accelerated IBP [29], stochastic gradient descent [15], distributed and parallel gradient descent [52, 54], alternating direction method of multipliers (ADMM) [57, 56] and interior-point algorithm [26]. Very recently, Kroshnin et al. [32] and Guminov et al. [29] have proposed a novel primal-dual framework that made it possible to derive complexity bounds for various algorithms, including IBP, accelerated IBP and APDAGD.
Concerning the computational hardness of the WBP with free support, Anderes et al. [3] proved that the barycenter of m empirical measures is also an empirical measure with support whose cardinality is at most the size of the union of the support of the m measures, minus m − 1. When m = 2 and the measures are bound and the support is ﬁxed, the computation of the barycenter amounts to solving a network ﬂow problem on a directed graph. Borgwardt and Patterson [9] proved that
ﬁnding a barycenter of sparse support is NP hard even in the simple setting when m = 3. However, their analysis cannot be extended to the ﬁxed-support WBP, where the supports of the constituent m probability measures are prespeciﬁed.
Contribution.
In this paper, we revisit the ﬁxed-support Wasserstein barycenter problem (FS-WBP) between m discrete probability measures supported on a prespeciﬁed set of n points. Our contributions can be summarized as follows: 1. We prove that the FS-WBP in the standard LP form is not a minimum-cost ﬂow (MCF) problem in general. In particular, we show that the constraint matrix arising from the standard LP representation of the FS-WBP is totally unimodular when m ≥ 3 and n = 2 but not totally unimodular when m ≥ 3 and n ≥ 3. Our results shed light on the necessity of problem reformulation—e.g., entropic regularization [19, 4] and block reduction [26]. 2. We propose a fast deterministic variant of the iterative Bregman projection (IBP) algorithm, named FASTIBP, and provide a theoretical guarantee for the algorithm. Letting ε ∈ (0, 1) denote the target tolerance, the complexity bound of the algorithm is (cid:101)O(mn7/3ε−4/3), which improves the complexity bound of (cid:101)O(mn2ε−2) of the IBP algorithm [4] in terms of ε and the complexity bound of (cid:101)O(mn5/2ε−1) from the accelerated IBP and APDAGD algorithms in terms of n [32, 29]. We conduct experiments on synthetic and real datasets and demonstrate that the FASTIBP algorithm achieves the favorable performance in practice.
Organization. In Section 2, we present the entropic-regularized FS-WBP and the dual problem. In
Section 3, we provide our computational hardness results for the FS-WBP in the standard LP form.
In Section 4, we propose and analyze the FASTIBP algorithm. We conduct experiments on synthetic and real data in Section 5 and conclude in Section 6. All the proofs are deferred to Appendix.
Notation. We let [n] be the set {1, . . . , n} and Rn
+ be all vectors in Rn with nonnegative components. 1n and 0n are the n-vectors of ones and zeros. ∆n stands for the probability simplex. For a function f , we denote ∇f and ∇λf as the full gradient and the gradient with respect to λ. For x ∈ Rn and 1 ≤ p ≤ ∞, we write (cid:107)x(cid:107)p for its (cid:96)p-norm. For X ∈ Rn×n, vec (X) ∈ Rn2 and det(X) stand for the vector representation and the determinant. r(X) = X1n and c(X) = X (cid:62)1n. Let X, Y ∈ Rn×n, the Frobenius and Kronecker inner product are denoted by (cid:104)X, Y (cid:105) and X ⊗ Y . Given n and ε, the notation a = O(b(n, ε)) stands for a ≤ C · b(n, ε) where C > 0 is independent of n and ε, and a = (cid:101)O(b(n, ε)) indicates previous inequality where C depends on the logarithmic factors of n and ε. 2 Preliminaries and Technical