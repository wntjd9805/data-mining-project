Abstract
Neural networks have been shown effective in deep steganography for hiding a full image in another. However, the reason for its success remains not fully clear. Under the existing cover (C) dependent deep hiding (DDH) pipeline, it is challenging to analyze how the secret (S) image is encoded since the encoded message cannot be analyzed independently. We propose a novel universal deep hiding (UDH) meta-architecture to disentangle the encoding of S from C. We perform extensive analysis and demonstrate that the success of deep steganography can be attributed to a frequency discrepancy between C and the encoded secret image. Despite S being hidden in a cover-agnostic manner, strikingly, UDH achieves a performance comparable to the existing DDH. Beyond hiding one image, we push the limits of deep steganography. Exploiting its property of being universal, we propose universal watermarking as a timely solution to address the concern of the exponentially increasing number of images and videos. UDH is robust to a pixel intensity shift on the container image, which makes it suitable for challenging application of light ﬁeld messaging (LFM). Our work is the ﬁrst to demonstrate the success of (DNN-based) hiding a full image for watermarking and LFM. Code: https://github.com/ChaoningZhang/Universal-Deep-Hiding 1

Introduction
The craft of steganography describes the secret communication without revealing the transported information to a third-party [25, 27, 14, 28]. The challenge for image steganography is to hide more information while keeping the container image look natural [17, 10, 9]. Recently, deep neural networks [32] have been shown to successfully hide a full image in another one [2] with a message ca-pacity of 24 bits per pixel (bpp) signiﬁcantly exceeding that of traditional techniques, e.g. HUGO [39] hides < 0.5 bpp. The task of (image) “steganography" with traditional techniques often requires perfectly decoding the secret message while remaining undetected by steganalysis [40]. In contrast, deep steganography in [2] has introduced a conceptually similar but technically different task of hiding a full image. Speciﬁcally, it relaxed the constraint of perfect decoding while focused on a high hiding capacity with a visual quality trade-off between container image and decoded secret image [2].
Due to the large hiding capacity, it is unlikely that the hidden image can remain undetected [3]. This new task has also been explored in a wide range of works [45, 47]. Acknowledging the difference between traditional steganography and deep steganography, in this work we adopt the term “deep
∗Equal contribution 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
steganography” to be consistent with [2, 45, 47, 46]. The success of deep steganography also inspired the exploration of hiding binary information in deep watermarking [55] and deep photographic steganography, also termed light ﬁled messaging (LFM) [46]. Despite large information capacity, deep steganography has a high visual quality, the reason of which remains yet unexplored. With the focus of hiding a secret image, our work is the ﬁrst one towards explaining how deep steganography works as well as investigating it for applications in watermarking and LFM.
Figure 1: Existing DDH meta-architecture with (left) [2] or without(right) [45] P network.
In this work, the general practice of hiding one image in another one is termed deep hiding which serves as a hypernym or umbrella term including deep steganography, watermarking and LFM. The existing deep hiding pipelines fall into one meta-architecture category termed cover-dependent deep hiding (DDH). As shown in Figure 1, the cover image (C) and (processed) secret image (S) are concatenated as the input of a hiding (H) network to generate a container image (C (cid:48)). Another reveal (R) network is used to recover the secret image (S(cid:48)). The objective is to minimize ||C (cid:48) − C|| and ||S(cid:48) − S|| simultaneously. Given C (cid:48) remains natural-looking, i.e. ||C (cid:48) − C|| is so small that it is human imperceptible, it is striking that the reveal (R) network can decode S(cid:48) almost perfectly from C (cid:48) [2]. The phenomenon of imperceptible hidden information triggering the R network echos with a parallel research line of adversarial attack [42, 18, 48, 21, 5, 8, 7, 1, 15], where a small imperceptible perturbation fools a target network. More intriguingly, a single image-agnostic perturbation is found to exist for attacking most images and often called universal adversarial perturbations [35, 36, 23, 49, 50, 6]. Inspired by this, we explore the possibility to hide an image in a cover-agnostic manner, i.e. universal deep hiding (UDH).
The primary motivation of UDH is to facilitate explaining the success of deep steganography [2]. One natural guess is that messages are hidden in the least signiﬁcant bits (LSB) [10], however, preliminary analysis in [2] rules out this possibility. Intuitively, Se = C (cid:48) − C represents how S is encoded in C (cid:48), however, it is not meaningful to analyze Se independent of C in the existing DDH because Se, (being equal to H(C, S) − C), is dependent on C. Since S is encoded in C (cid:48), one alternative is to analyze
C (cid:48) as a whole but the magnitude dominance of C over Se makes it impractical. The above reasons complicate the exploration of how S is encoded under the existing DDH. In the proposed UDH (See
Figure 2), Se (being equal to H(S)) is independent of C. Thus, Se can be analyzed directly, which is a noticeable merit of UDH for understanding where and/or how the S is encoded. We ﬁnd that the success of UDH can be directly attributed to a frequency discrepancy between Se and C. With a cross-test of H and R from DDH and UDH, we also successfully demonstrate how DDH works.
Overall, compared with DDH, UDH is a more challenging task because the algorithm of UDH can not adaptively encode Se based on C. Empirically, however, we ﬁnd that UDH results in a more smooth training and achieves comparable performance for deep steganography. Beyond hiding one image, we further push the limits of deep steganography with higher hiding capacity. Exploiting its property of being universal for high efﬁciency, we are the ﬁrst to investigate and demonstrate the possibility of (DNN-based) universal watermarking. This can be a timely solution for efﬁcient watermarking tackling the exponentially increasing number of images or videos. In contrast to HiDDeN [55] which watermarks by hiding binary information, we are the ﬁrst to demonstrate (DNN-based) watermarking by hiding images. The UDH for hiding images without retraining can be readily extended to hide simple binary information, achieving superior performance than [55]. UDH is robust to pixel intensity shift on C (cid:48), which makes it more suitable for the task of LFM. In contrast to [46] that only hides binary information, UDH is the ﬁrst to successfully hide and transmit an image robust to light effect, increasing its real-world applicability. It is also worth mentioning that UDH does not require collecting a large screen-pair dataset (1.9TB) as in [46]. For transmitting simple binary information,
UDH achieves signiﬁcantly better performance than [46]. 2
2