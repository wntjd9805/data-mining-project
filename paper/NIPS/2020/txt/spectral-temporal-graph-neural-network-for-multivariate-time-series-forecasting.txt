Abstract
Multivariate time-series forecasting plays a crucial role in many real-world ap-plications. It is a challenging problem as one needs to consider both intra-series temporal correlations and inter-series correlations simultaneously. Recently, there have been multiple works trying to capture both correlations, but most, if not all of them only capture temporal correlations in the time domain and resort to pre-deﬁned priors as inter-series relationships.
In this paper, we propose Spectral Temporal Graph Neural Network (StemGNN) to further improve the accuracy of multivariate time-series forecasting. StemGNN captures inter-series correlations and temporal dependencies jointly in the spectral domain. It combines Graph Fourier Transform (GFT) which models inter-series correlations and Discrete Fourier Transform (DFT) which models temporal de-pendencies in an end-to-end framework. After passing through GFT and DFT, the spectral representations hold clear patterns and can be predicted effectively by convolution and sequential learning modules. Moreover, StemGNN learns inter-series correlations automatically from the data without using pre-deﬁned priors.
We conduct extensive experiments on ten real-world datasets to demonstrate the effectiveness of StemGNN. 1

Introduction
Time-series forecasting plays a crucial role in various real-world scenarios, such as trafﬁc forecasting, supply chain management and ﬁnancial investment. It helps people to make important decisions if the future evolution of events or metrics can be estimated accurately. For example, we can modify our driving route or reschedule an appointment if there is a severe trafﬁc jam anticipated in advance.
Moreover, if we can forecast the trend of COVID-19 in advance, we are able to reschedule important events and take quick actions to prevent the spread of epidemic.
Making accurate forecasting based on historical time-series data is challenging, as both intra-series temporal patterns and inter-series correlations need to be modeled jointly. Recently, deep learning models shed new lights on this problem. On one hand, Long Short-Term Memory (LSTM) [10],
Gated Recurrent Units (GRU) [6], Gated Linear Units (GLU) [7] and Temporal Convolution Networks (TCN) [3] have achieved promising results in temporal modeling. At the same time, Discrete Fourier
Transform (DFT) is also useful for time-series analysis. For instance, State Frequency Memory (SFM) network [32] combines the advantages of DFT and LSTM jointly for stock price prediction;
Spectral Residual (SR) model [23] leverages DFT and achieves state-of-the-art performances in
∗The work was done when the author did internship at Microsoft.
†Equal Contribution 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
time-series anomaly detection. Another important aspect of multivariate time-series forecasting is to model the correlations among multiple time-series. For example, in the trafﬁc forecasting task, adjacent roads naturally interplay with each other. Current state-of-the-art models highly depend on
Graph Convoluational Networks (GCNs) [13] originated from the theory of Graph Fourier Transform (GFT). These models [31, 17] stack GCN and temporal modules (e.g., LSTM, GRU) directly, which only capture temporal patterns in the time domain and require a pre-deﬁned topology of inter-series relationships.
In this paper, our goal is to better model the intra-series temporal patterns and inter-series correlations jointly. Speciﬁcally, we hope to combine both the advantages of GFT and DFT, and model multivariate time-series data entirely in the spectral domain. The intuition is that after GFT and DFT, the spectral representations could hold clearer patterns and can be predicted more effectively. It is non-trivial to achieve this goal. The key technical contribution of this work is a carefully designed StemGNN (Spectral Temporal Graph Neural Network) block. Inside a StemGNN block, GFT is ﬁrst applied to transfer structural multivariate inputs into spectral time-series representations, while different trends can be decomposed to orthogonal time-series. Furthermore, DFT is utilized to transfer each univariate time-series into the frequency domain. After GFT and DFT, the spectral representations become easier to be recognized by convolution and sequential modeling layers. Moreover, a latent correlation layer is incorporated in the end-to-end framework to learn inter-series correlations automatically, so it does not require multivariate dependencies as priors. Moreover, we adopt both forecasting and backcasting output modules with a shared encoder to facilitate the representation capability of multivariate time-series.
The main contributions of this paper are summarized as follows:
• To the best of our knowledge, StemGNN is the ﬁrst work that represents both intra-series and inter-series correlations jointly in the spectral domain. It encapsulates the beneﬁts of
GFT, DFT and deep neural networks simultaneously and collaboratively. Ablation studies further prove the effectiveness of this design.
• StemGNN enables a data-driven construction of dependency graphs for different time-series. Thereby the model is general for all multivariate time-series without pre-deﬁned topologies. As shown in the experiments, automatically learned graph structures have good interpretability and work even better than the graph structures deﬁned by humans.
• StemGNN achieves state-of-the-art performances on nine public benchmarks of multivariate time-series forecasting. On average, it outperforms the best baseline by 8.1% on MAE an 13.3% on RMSE. A case study on COVID-19 further shows its feasibility in real scenarios. 2