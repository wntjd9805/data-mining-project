Abstract
Counterpoint is an important concept in Western music theory. In the past century, there have been signiﬁcant interests in incorporating counterpoint into Chinese folk music composition. In this paper, we propose a reinforcement learning-based system, named FolkDuet, towards the online countermelody generation for Chinese folk melodies. With no existing data of Chinese folk duets, FolkDuet employs two reward models based on out-of-domain data i.e., Bach chorales, and monophonic
Chinese folk melodies. An interaction reward model is trained on the duets formed from outer parts of Bach chorales to model counterpoint interaction, while a style reward model is trained on monophonic melodies of Chinese folk songs to model melodic patterns. With both rewards, the generator of FolkDuet is trained to generate countermelodies while maintaining the Chinese folk style. The entire generation process is performed in an online fashion, allowing real-time interactive human-machine duet improvisation. Experiments show that the proposed algorithm achieves better subjective and objective results than the baselines. 1

Introduction
Counterpoint [31], as an important and unique concept in Western music theory, is commonly identiﬁed in the works composed in the Baroque and Classical periods. It refers to the mediation of two or more musical voices into a meaningful and pleasing whole, where the role of these voices are somewhat equal. Chinese folk melodies, on the other hand, are typically presented in a monophonic form or with accompaniments that are less melodic [28], with few exceptions [45]; they feature unique melodic patterns and are mostly based on the pentatonic scale. In the past century, some renowned
Chinese composers, e.g., Xian Xinghai and He Luting, have explored incorporating counterpoints and fugues to Chinese music [38] and these attempts have brought several successful choral and orchestral works such as “Yellow River Cantata” and “Buffalo Boy’s Flute”. However, systematic theories and broader inﬂuences on the general public of integrating counterpoint with Chinese folk melodies are lacking. This motivates our work.
In this paper, we propose a system named FolkDuet to automatically generate countermelodies for
Chinese folk melodies, following the counterpoint concept in Western music theory while maintaining the Chinese folk style. Instead of ofﬂine harmonization, we make the generation in an online (causal) fashion, where the countermelody is generated in real time as the input melody streams in, for a broader research scope and better engagement of users [2]. We believe that this is an innovative idea and it would make broader impacts on two aspects: 1) It would facilitate music cultural exchanges between the West and the East at a much larger scale through automatic music generation and style 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
fusion, and 2) it would further the idea of collaborative counterpoint improvisation between a human and a machine [2] to music traditions where such counterpoint interaction was less common.
Automatically harmonizing a melody or a bass line into multi-part music has been investigated for decades, but primarily on Western classical music, especially J.S. Bach chorales. Early methods were rule-based [17, 43, 35], where counterpoint rules were encoded to guide the generation process.
Later, statistical machine learning based methods were proposed to learn counterpoint interaction from training data directly. For Chinese folk melodies, however, both systematic counterpoint rules and large repertoires of countermelodies are lacking, making these existing approaches infeasible.
The key idea of our proposed method is to employ reinforcement learning (RL) to learn and adapt counterpoint patterns from Western classical music while maintaining the melodic style of Chinese folk melodies during countermelody generation. Speciﬁcally, we design two data-driven reward models for this task. The ﬁrst one is trained on the outer parts (the soprano and the bass line)
It models the mutual information of Bach chorales to model generic counterpoint interaction. between the outer parts of Bach chorales. The other rewarder is trained by maximum entropy Inverse
Reinforcement Learning (IRL) on monophonic Chinese folk songs to model the melodic style. The reinforcement learning scheme then fuses the generic counterpoint interaction patterns with the melodic style during countermelody generation.
The proposed method works in an online fashion, aiming to support human-machine collaborative music improvisation. Compared to ofﬂine methods that can iteratively revise the generated music content (e.g., using Gibbs sampling) [7, 19, 24, 47], online harmonization is more difﬁcult to generate globally coherent and pleasing content.
In this regard, the proposed method follows RL-Duet
[27], which has shown that reinforcement learning helps to improve the global coherence in online harmonization in the style of Bach chorales. The proposed work differs from RL-Duet on two aspects: 1) It generates the countermelody in the Chinese folk style instead of the Bach chorale style on which the counterpoint rewarder is trained, and 2) it uses an iteratively updated rewarder (i.e., IRL) instead of a ﬁxed rewarder to achieve the knowledge transfer and style fusion.
To validate the proposed FolkDuet system, we compare it with two baselines: RL-Duet and a maximum likelihood estimation (MLE) baseline trained on outer parts of Bach chorales. Objective experiments show that FolkDuet generates countermelodies that show closer statistics to the Chinese folk melodies in the dataset and better key consistency with the melody. Subjective listening tests also show that the proposed approach achieves higher ratings than the baseline method, in terms of both harmonicity between the two parts and the maintenance of the Chinese folk style.
Our main contributions are summarized as follows: 1) To our best knowledge, this is the ﬁrst attempt to fuse Western counterpoint interaction with the Chinese folk melody style in countermelody generation. 2) The proposed RL approach learns to generate countermelodies in real time for Chinese folk melodies purely from out-of-domain data (i.e., Bach chorales, and Chinese folk melodies) instead of Chinese folk duets that are scarce. 3) The proposed counterpoint rewarder learns and transfers counterpoint interaction from mutual information between the two outer parts of Bach chorales to the
Chinese folk countermelody task. 2