Abstract
Functional magnetic resonance imaging (fMRI) is a crucial technology for gaining insights into cognitive processes in humans. Data amassed from fMRI measure-ments result in volumetric data sets that vary over time. However, analysing such data presents a challenge due to the large degree of noise and person-to-person vari-ation in how information is represented in the brain. To address this challenge, we present a novel topological approach that encodes each time point in an fMRI data set as a persistence diagram of topological features, i.e. high-dimensional voids present in the data. This representation naturally does not rely on voxel-by-voxel correspondence and is robust to noise. We show that these time-varying persis-tence diagrams can be clustered to ﬁnd meaningful groupings between participants, and that they are also useful in studying within-subject brain state trajectories of subjects performing a particular task. Here, we apply both clustering and tra-jectory analysis techniques to a group of participants watching the movie ‘Partly
Cloudy’. We observe signiﬁcant differences in both brain state trajectories and overall topological activity between adults and children watching the same movie. 1

Introduction
Human cognitive processes are commonly studied using functional magnetic resonance imag-ing (fMRI), amassing highly complex, well-structured, and time-varying data sets across multiple individual subjects. fMRI uses blood oxygen measurements of 3D brain volumes divided into voxels, i.e. 3D pixels with dimensions in the mm range. Voxels are measured over time while participants
∗These authors contributed equally.
†These authors jointly supervised this work; corresponding authors. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
(a) fMRI images (b) fMRI volume (c) Cubical complex (d) Persistence diagrams (e) Persistence images
Figure 1: A graphical overview of our method. We represent an fMRI stack (a) as a volume (b), from which we create a sequence of cubical complexes (c). Calculating the persistent homology of this sequence results in a set of time-varying persistence diagrams (d); note that we only show the diagrams for a single dimension of the cubical complex. We calculate summary statistics from the diagrams (not shown), and convert them to vectorial representations (e) for analysis tasks. perform cognitive tasks, resulting in time-varying activity measurements and an activation function over the volume. The ultimate goal of extracting higher-level abstractions from such data is primarily impeded by two factors: (i) the measurements are inherently noisy, due to changes in machine calibration, spurious patient movements, or environmental conditions, and (ii) there is a high degree of variability even between otherwise healthy brains (e.g. in terms of the representation of stimulus and activity in the brain). While these factors can be mitigated by certain experimental protocols and pre-processing decisions, they cannot be fully eliminated. This demonstrates the need for using representations that are to some extent robust with respect to noise and invariant with respect to isometric transformations in order to better capture cognitively-relevant fMRI activity, particularly across populations where anatomy–function relations may differ.
Traditional approaches largely ignore these factors, considering them inevitable noise in the mea-surements. Voxel activity is often either directly compared across different cognitive tasks, or the time-varying activity of voxels in pre-deﬁned brain regions sharing functional properties is correlated to create a ‘functional connectivity’ graph. Our approach differs from existing approaches for fMRI data analysis in two crucial ways, namely (i) it is coordinate-free, providing a stable representation of high-level brain activity, even without a voxel-by-voxel match, and (ii) it does not require the creation of a correlation graph, or operate on any other approximated graph structure (in contrast to the MAPPER algorithm [55], for example). Instead, our method uses the ‘raw’ voxel activations themselves as a cubical complex, which we further characterise using time-varying persistence diagrams that indicate the presences of topological features such as voids of various dimensions in the voxel activations. These topological features are naturally invariant to a variety of shifts and noise (see Section 4 for more details). Our formulation enables the non-parametric analysis of fMRI data both statically and dynamically, i.e. for assessing differences between cohorts across time, and enabling insights into time-varying topological brain state trajectories within cohorts or individuals.
For individuals, we calculate an averaged summary statistic over time that can be embedded to explore population structure and variability statically, which we use to organise subjects in our test set by age. Then, after partitioning subjects into cohorts, we propose a novel method for producing a time-varying trajectory of persistence diagrams that can be used to quantify the progression and entropy of brain states. In summary, we make the following contributions:
• We present a novel non-parametric framework for transforming time-varying fMRI data into time-varying topological representations.
• We empirically show that these representations (i) capture age-related differences, and (ii) shed light on the cognitive processes of age-stratiﬁed cohorts.
• Finally, we show that our topological features are more informative for an age prediction task than other representations of the data set. 2