Abstract
Multi-voxel pattern analysis (MVPA) learns predictive models from task-based functional magnetic resonance imaging (fMRI) data, for distinguishing when subjects are performing different cognitive tasks — e.g., watching movies or making decisions. MVPA works best with a well-designed feature set and an adequate sample size. However, most fMRI datasets are noisy, high-dimensional, expensive to collect, and with small sample sizes. Further, training a robust, generalized predictive model that can analyze homogeneous cognitive tasks provided by multi-site fMRI datasets has additional challenges. This paper proposes the Shared
Space Transfer Learning (SSTL) as a novel transfer learning (TL) approach that can functionally align homogeneous multi-site fMRI datasets, and so improve the prediction performance in every site. SSTL ﬁrst extracts a set of common features for all subjects in each site. It then uses TL to map these site-speciﬁc features to a site-independent shared space in order to improve the performance of the MVPA. SSTL uses a scalable optimization procedure that works effectively for high-dimensional fMRI datasets. The optimization procedure extracts the common features for each site by using a single-iteration algorithm and maps these site-speciﬁc common features to the site-independent shared space. We evaluate the effectiveness of the proposed method for transferring between various cognitive tasks. Our comprehensive experiments validate that SSTL achieves superior performance to other state-of-the-art analysis techniques. 1

Introduction
The task-based functional magnetic resonance imaging (fMRI) is one of the prevalent tools in neuroscience to analyze how human brains work [1–5]. It can be used to visualize the neural activities when subjects are performing cognitive tasks — such as watching photos or making decisions [1].
Since brain images are high-dimensional and noisy, most of the recent neuroimage studies utilize machine learning approaches such as classiﬁcation techniques for analyzing fMRI datasets [1, 2].
Multi-voxel pattern analysis (MVPA) learns a classiﬁcation model based on a set of fMRI responses (with labels), which can be used to predict the cognitive tasks performed by a novel subject, who was not part of the training phase [1]. An accurate MVPA model needs a well-designed feature space and sufﬁcient number of training instances [1–3]. However, most fMRI datasets include a limited set of samples because collecting neuroimage data is an expensive procedure and needs a wide range
∗Corresponding author. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
of agreements [2, 3]. As an alternative, increasing the number of publicly available fMRI datasets motivate the idea of combining multi-site homogeneous cognitive tasks (i.e., all performing the same set of fMRI tasks) in order to increase the sample size, which we hope will boost the accuracy of the predictive models [2]. The best examples are the (U.S.) National Institute of Mental Health (NIMH)2 [2] and Open NEURO3 [7] projects that share thousands of fMRI scans with various types of cognitive tasks [2, 3].
It is challenging to train a generalized classiﬁcation model from multi-site fMRI datasets, all involving the same set of homogeneous cognitive tasks [2, 3, 6]. There are two signiﬁcant issues, viz., differences in brain connectomes, and batch effects [2, 3]. As every human brain has a different connectome, each person will have a different neural response for the same stimulus [1]. Recent studies suggested applying functional alignment as an extra processing step before generating a prediction model for fMRI analysis [1, 3–5]. This functional alignment process extracts a set of common features from multi-subject fMRI data, which can be used to boost the prediction rate [3–5]. However, functional alignment techniques need temporal alignment — i.e., the i-th time point for all subjects must involve the same type of cognitive task [4, 5]. Although applying temporal alignment to a single-site fMRI data is a relatively straightforward process, this approach cannot be directly used for any multi-site datasets with different schemes of experimental designs [3, 4]. As another issue, batch effects [6] refers to a set of external elements that may affect the distribution of collected fMRI data in each site
— e.g., the environment noise, standards that are used by vendors of fMRI machines, etc. To deal with these issues, recent studies [2, 3, 8–10] show that transfer learning (TL) can signiﬁcantly improve the quality of classiﬁcation models for a multi-site fMRI analysis by leveraging the existing domain knowledge of the homogeneous cognitive tasks.
As the primary contribution of this paper, we propose Shared Space Transfer Learning (SSTL) as a novel TL approach that can generate a robust, generalized, accurate classiﬁcation model from multi-site fMRI datasets, which can then be used effectively over each of these sites. SSTL learns a shared feature space by using a hierarchical two-step procedure. It ﬁrst extracts a set of common features for all subjects in each site and then uses TL to map these site-speciﬁc features to a site-independent shared space. Further, SSTL uses a scalable optimization algorithm that works effectively for high-dimensional fMRI datasets with a large number of subjects. The optimization procedure extracts the common features for each site by using a single iteration multi-view approach and then maps these site common features to the site-independent shared space.
The rest of this paper is organized as follows: Section 2 brieﬂy introduces some related works.
Section 3 presents our proposed method. Section 4 reports the empirical studies, and ﬁnally, Section 5 presents the conclusion and points out some future works. 2