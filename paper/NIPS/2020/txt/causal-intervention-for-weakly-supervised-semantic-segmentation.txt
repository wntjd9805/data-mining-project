Abstract
We present a causal inference framework to improve Weakly-Supervised Semantic
Segmentation (WSSS). Speciﬁcally, we aim to generate better pixel-level pseudo-masks by using only image-level labels — the most crucial step in WSSS. We attribute the cause of the ambiguous boundaries of pseudo-masks to the confound-ing context, e.g., the correct image-level classiﬁcation of “horse” and “person” may be not only due to the recognition of each instance, but also their co-occurrence context, making the model inspection (e.g., CAM) hard to distinguish between the boundaries. Inspired by this, we propose a structural causal model to analyze the causalities among images, contexts, and class labels. Based on it, we develop a new method: Context Adjustment (CONTA), to remove the confounding bias in image-level classiﬁcation and thus provide better pseudo-masks as ground-truth for the subsequent segmentation model. On PASCAL VOC 2012 and MS-COCO, we show that CONTA boosts various popular WSSS methods to new state-of-the-arts.1 1

Introduction
Semantic segmentation aims to clas-sify each image pixel into its corre-sponding semantic class [32]. It is an indispensable computer vision build-ing block for scene understanding ap-plications such as autonomous driv-ing [54] and medical imaging [18].
However, the pixel-level labeling is expensive, e.g., it costs about 1.5 man-hours for one 500 × 500 daily life image [12]. Therefore, to scale up, we are interested in Weakly-Supervised Semantic Segmentation (WSSS), where the “weak” denotes a much cheaper labeling cost at the instance-level [9, 28] or even at the image-level [23, 57]. In particular, we focus on the latter as it is the most economic way — only a few man-seconds for tagging an image [26].
Figure 1: The prevailing pipeline for training WSSS. Our contribution is to improve the Classiﬁcation Model, which is the foundation for better pseudo-masks.
The prevailing pipeline for training WSSS is depicted in Figure 1. Given training images with only image-level class labels, we ﬁrst train a multi-label classiﬁcation model. Second, for each image, we infer the class-speciﬁc seed areas, e.g., by applying Classiﬁcation Activation Map (CAM) [68] to the above trained model. Finally, we expand them to obtain the Pseudo-Masks [20, 57, 59], which are
∗
Corresponding author. 1Code is open-sourced at: https://github.com/ZHANGDONG-NJUST/CONTA 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Figure 2: Three basic problems in existing pseudo-masks [57] (dataset: PASCAL VOC 2012 [12]): (a) Object Ambiguity, (b) Incomplete