Abstract
Haplotype assembly and viral quasispecies reconstruction are challenging tasks con-cerned with analysis of genomic mixtures using sequencing data. High-throughput sequencing technologies generate enormous amounts of short fragments (reads) which essentially oversample components of a mixture; the representation redun-dancy enables reconstruction of the components (haplotypes, viral strains). The reconstruction problem, known to be NP-hard, boils down to grouping together reads originating from the same component in a mixture. Existing methods strug-gle to solve this problem with required level of accuracy and low runtimes; the problem is becoming increasingly more challenging as the number and length of the components increase. This paper proposes a read clustering method based on a convolutional auto-encoder designed to ﬁrst project sequenced fragments to a low-dimensional space and then estimate the probability of the read origin using learned embedded features. The components are reconstructed by ﬁnding consensus sequences that agglomerate reads from the same origin. Mini-batch stochastic gradient descent and dimension reduction of reads allow the proposed method to efﬁciently deal with massive numbers of long reads. Experiments on simulated, semi-experimental and experimental data demonstrate the ability of the proposed method to accurately reconstruct haplotypes and viral quasispecies, often demonstrating superior performance compared to state-of-the-art methods. Source codes are available at https://github.com/WuLoli/CAECseq. 1

Introduction
Genetic material in living cells and viruses experiences mutations which lead to unique blueprints and/or may create potentially diverse and complex genomic communities.
In humans, genetic mutations impact an individual’s health by causing genetic diseases and rendering the individual predisposed to complex diseases. In general, genetic material of eukaryotic organisms is organized in chromosomes, each with two or more copies present in a cell; variations between chromosomal copies have major implications on cellular functions. Beyond the living organisms, genetic variations also occur in viruses where they lead to emergence of rich viral populations that co-exist as the so-called quasispecies; spectrum of such quasispecies is reﬂective of the proliferative advantage that particular mutations may provide to viral strains present in the community. Therefore, inferring the composition and studying evolution of genomic communities that emerge due to occurrence and accumulation of mutations provide valuable information about genetic signatures of diseases, and generally suggest directions for medical and pharmaceutical research. High-throughput sequencing technologies enable sampling of such genomic communities/mixtures (Schwartz, 2010; Clark, 2004;
Sabeti et al., 2002); however, the composition inference is computationally challenging and of limited accuracy due to sequencing errors and relatively short lengths of sequencing reads. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Haplotypes. Perhaps the simplest manifestation of genetic diversity in an individual’s genome are the variations between copies of autosomal chromosomes inherited from the individual’s parents. An ordered list of single nucleotide polymorphisms (SNPs) on the individual’s autosomal chromosomes is referred to as haplotype (Schwartz, 2010). While humans are diploids, i.e., have a genome organized in chromosomal pairs, many organisms are polyploids and thus their chromosomes (consequently, haplotypes) come in triplets, quadruplets and so on. Accurate assembly of haplotypes requires deep sequencing coverage, especially in the case of polyploids. Presence of sequencing errors and relatively short length of reads compared to distance between mutations, render haplotype assembly challenging (Motazedi et al., 2018).
Viral quasispecies. An even more challenging problem than haplotype assembly is the reconstruction of viral populations. RNA viruses such as HIV, HCV, Zika, coronavirus and so on, typically exist as communities of closely related yet still decidedly distinct variants present at different abundances (i.e., have varied relative frequencies). A collection of such variants (i.e., strains) is referred to as a viral quasispecies; studies of quasispecies are essential for the understanding of viral dynamics, including insight into processes that enable viruses to become resistant to drugs and vaccines. In addition to the challenges encountered in solving haplotype assembly problems, viral quasispecies reconstruction (for convenience also referred to as viral haplotype reconstruction) is even more challenging due to unknown viral population size and imbalanced abundances of viral strains. 1.1 Contributions
In this paper we propose CAECseq, a novel convolutional auto-encoder with a clustering layer, inspired by (Guo et al., 2017), for solving both haplotype assembly and viral quasispecies reconstruc-tion problems. Auto-encoders are neural networks that can be trained to automatically extract salient low-dimensional representations of high-dimensional data in an unsupervised manner (Goodfellow,
Bengio, and Courville, 2016). In auto-encoders, an encoder aims to compress input data to obtain useful feature embeddings while a decoder aims to reconstruct input data from the learned feature.
The learned features have been proved to perform well in many ﬁelds including anomaly detection (Zhou and Paffenroth, 2017), image clustering (Guo et al., 2017), natural language processing (Socher et al., 2011), information retrieval (Kipf and Welling, 2016) and so on.
CAECseq’s encoder consists of convolutional layers followed by a dense layer and converts reads into learned low-dimensional feature embeddings, while the decoder consists of a dense layer followed by deconvolutional layers and reconstructs the reads. After pre-training the convolutional auto-encoder to project reads to a stable low-dimensional feature space, we utilize k-means on the learned features to initialize parameters of the clustering layer. The convolutional auto-encoder and the clustering layer are then trained simultaneously to cluster reads without distorting the low-dimensional feature space, where the clustering task is guided by a target distribution aimed to reduce the MEC score.
Our main contributions are summarized as follows:
• We developed a convolutional auto-encoder with a clustering layer, CAECseq, for haplotype assembly and viral quasispecies reconstruction; CAECseq is trained to automatically group together reads originating from the same genomic component, processing sequencing data in an end-to-end manner. The ability of convolutional layers to capture spatial relationship between SNPs enables the proposed method to distinguish reads obtained from highly similar genomic components.
• Our proposed framework pursues indirect optimization of the MEC score, which enables use of mini-batch stochastic gradient; this, combined with dimension reduction of the reads, allows us to efﬁciently deal with massive amounts of long reads.
• We conducted extensive experiments on simulated, semi-experimental and experimental data, obtaining results which demonstrate the ability of the proposed method to efﬁciently and with high accuracy assemble haplotypes and reconstruct viral quasispecies from high-throughput sequencing data. 1.2