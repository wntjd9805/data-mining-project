Abstract
Value-function-based methods have long played an important role in reinforcement learning. However, ﬁnding the best next action given a value function of arbitrary complexity is nontrivial when the action space is too large for enumeration. We develop a framework for value-function-based deep reinforcement learning with a combinatorial action space, in which the action selection problem is explicitly formulated as a mixed-integer optimization problem. As a motivating example, we present an application of this framework to the capacitated vehicle routing problem (CVRP), a combinatorial optimization problem in which a set of locations must be covered by a single vehicle with limited capacity. On each instance, we model an action as the construction of a single route, and consider a deterministic policy which is improved through a simple policy iteration algorithm. Our approach is competitive with other reinforcement learning methods and achieves an average gap of 1.7% with state-of-the-art OR methods on standard library instances of medium size. 1

Introduction
Reinforcement learning (RL) is a powerful tool that has made signiﬁcant progress on hard problems.
For instance, in games like Atari [1] or Go [2], RL algorithms have devised strategies that signiﬁcantly surpass the performance of experts, even with little to no knowledge of problem structure. The success of reinforcement learning has carried over to other applications such as robotics [3] and recommender systems [4]. As they encompass ever more application areas, RL algorithms need to be adjusted and expanded to account for new problem-speciﬁc features.
One area in which RL has yet to make a convincing breakthrough is combinatorial optimization.
There has been signiﬁcant effort in recent years to apply RL frameworks to NP-hard combinatorial optimization problems [5, 6, 7], including the traveling salesman problem (TSP) or more general vehicle routing problem (VRP) (see [8] for a recent survey). Solving these problems produces a practical impact for many industries, including transportation, ﬁnance, and energy. Yet in contrast to [1, 2], RL methods have yet to match the performance of expert implementations in this domain, such as the state-of-the-art Concorde TSP solver [9, 10].
A major difﬁculty of designing an RL framework for combinatorial optimization is formulating the action space. Value-based RL algorithms typically require an action space small enough to enumerate, while policy-based algorithms are designed with continuous action spaces in mind [11]. These twin requirements severely limit the expressiveness of the action space, thus placing the entire weight of the problem on the machine learning model. For instance, in [12], the selected action space models advancing the current vehicle one city at a time. RL algorithms for combinatorial optimization must therefore rely on complex architectures such as pointer networks [5, 6, 12] or graph embeddings [7]. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
This paper presents a different approach, in which the combinatorial complexity is captured not only by the learning model, but also by the formulation of the underlying decision problem. We focus on the Capacitated Vehicle Routing Problem, a classical combinatorial problem from operations research
[13], where a single capacity-limited vehicle must be assigned one or more routes to satisfy customer demands while minimizing total travel distance. Despite its close relation to the TSP, the CVRP is a much more challenging problem and optimal approaches do not scale past hundreds of cities.
Our approach is to formulate it as a sequential decision problem where the state space is the set of unvisited cities, and the action space consists of feasible routes. We estimate the value function of a state (i.e., its cost-to-go) using a small neural network. The action selection problem is then itself combinatorial, with the structure of a Prize Collecting Traveling Salesman Problem (PC-TSP) with a knapsack constraint and a nonlinear cost on unvisited cities. Crucially, the PC-TSP is a much easier combinatorial problem than the CVRP, allowing us to tractably exploit some of the combinatorial structure of the problem.
The contributions in this paper are threefold. 1. We present a policy iteration algorithm for value-based reinforcement learning with combi-natorial actions. At the policy improvement step, we train a small neural network with ReLU activations to estimate the value function from each state. At the policy evaluation step, we formulate the action selection problem from each state as a mixed-integer program, in which we combine the combinatorial structure of the action space with the neural architecture of the value function by adapting the branch-and-cut approach described in [14]. 2. We apply this technique to develop a reinforcement learning framework for combinatorial optimization problems in general and the Capacitated Vehicle Routing Problem in particular.
Our approach signiﬁcantly differs from existing reinforcement learning algorithms for vehicle routing problems, and allows us to obtain comparable results with much simpler neural architectures. 3. We evaluate our approach against several baselines on random and standard library instances, achieving an average gap against the OR-Tools routing solver of 1.7% on moderately-sized problems. While we do not yet match state-of-the-art operations research methods used to solve the CVRP, we compare favorably with heuristics using oracles of equal strength to our action selection oracle and to other RL approaches for solving CVRP [12]. 2