Abstract
Causal effect estimation relies on separating the variation in the outcome into parts due to the treatment and due to the confounders. To achieve this separation, practitioners often use external sources of randomness that only inﬂuence the treatment called instrumental variables (IVs). We study variables constructed from treatment and IV that help estimate effects, called control functions. We characterize general control functions for effect estimation in a meta-identiﬁcation result. Then, we show that structural assumptions on the treatment process allow the construction of general control functions, thereby guaranteeing identiﬁcation.
To construct general control functions and estimate effects, we develop the general control function method (GCFN). GCFN’s ﬁrst stage called variational decoupling (VDE) constructs general control functions by recovering the residual variation in the treatment given the IV. Using VDE’s control function, GCFN’s second stage estimates effects via regression. Further, we develop semi-supervised GCFN to construct general control functions using subsets of data that have both IV and confounders observed as supervision; this needs no structural treatment process assumptions. We evaluate GCFN on low and high dimensional simulated data and on recovering the causal effect of slave export on modern community trust [30]. 1

Introduction
Many disciplines use observational data to estimate causal effects: economics [5], sociology [23], psychology [26], epidemiology [35], and medicine [40]. Estimating causal effects with observational data requires care due to the presence of confounders that inﬂuence both treatment and outcome.
Observational causal estimators deal with confounders in one of two ways. One, they assume that all confounders are observed; an assumption called ignorability. Two, they assume a source of external randomness that has a direct inﬂuence only on the treatment. Such a source is called an instrumental variable (IV) [4, 19]. An example is college proximity as an IV to study effects of education [8].
Two common IV-based causal effect estimation methods are the two-stage least-squares method (2SLS) [21, 2, 3] and the traditional control function method (CFN) [19, 45, 43, 12]. Both methods have a common ﬁrst stage: learn a distribution over the treatment conditioned on the IV. In the second stage, 2SLS regresses the outcome on simulated treatments from the ﬁrst stage, while CFN’s second stage regresses the outcome on the true treatment and the error in the prediction of treatment from the ﬁrst stage. The prediction error can be used to control for confounding and is thus called a control function. Though widely used, both 2SLS and CFN breakdown under certain conditions like, for example, when the outcome depends on multiplicative interactions of treatment and confounders.
Further, CFN requires an additional assumption about the correlations between noise and outcome.
We study causal estimation with control functions. To estimate effects, control functions must satisfy ignorability. Our meta-identiﬁcation result (theorem 1) shows that a control function satisﬁes ignorability if 1) the control function and IV together reconstruct the treatment, and 2) the confounder and control function together are jointly independent of the IV. We will refer to such control functions 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
as general control functions. Effect estimation in general requires that the treatment has a chance to take any value given the control function; this is called positivity. We show positivity for general control functions holds if the IV can set treatment to any value; we call this a strong IV.
Any general control function uniquely determines the effect because it satisﬁes ignorability and positivity (given a strong IV). Causal identiﬁcation requires effects to be uniquely determined by the observed data distribution. Thus, building general control functions using observed data guarantees causal identiﬁcation. As reconstruction and marginal independence are properties of the joint distribution over observed data and control function, they can be guaranteed. Guaranteeing joint independence requires further assumptions as it involves the unobserved confounder. We show that structural assumptions on the treatment process, such as treatment being an additive function of the confounder and IV, help ensure joint independence.
To build general control functions and use them to estimate effects, we develop the general control function method (GCFN). GCFN’s ﬁrst stage, called variational decoupling (VDE), constructs the general control function. VDE is a type of autoencoder where the encoder constructs the control function and the decoder reconstructs treatment from control function and IV, under the constraint that the control function and IV are independent. When VDE is perfectly solved with a decoder that reﬂects a structural treatment process assumption, like additivity, reconstruction and joint independence are guaranteed. Thus with a strong IV, ignorability and positivity hold which implies identiﬁcation, and that effect estimation does not require structural assumptions on the outcome process like those in 2SLS and CFN. Using VDE’s general control function, GCFN’s second stage estimates the causal effect. GCFN’s second stage can be any method that relies on ignorability like matching/balancing methods [41, 13, 38] and doubly-robust methods [14].
We also consider a setting where a subset of the data has observed confounders that provide ignorabil-ity. We develop semi-supervised GCFN to estimate effects in this setting. Semi-supervised GCFN’s
ﬁrst stage is an augmented VDE that forces the control function to match the confounder in the subset where it is observed. This augmented VDE helps guarantee joint independence even with a decoder that does not reﬂect structural treatment process assumptions.
In section 4, we evaluate GCFN’s causal effect estimation on simulated data with the outcome, treatment, and IV observed. We demonstrate how GCFN produces correct effect estimates without additional assumptions on the true outcome process, whereas 2SLS, CFN, and DeepIV [18] fail to produce the correct estimate. Further, we show that GCFN performs on par with recently proposed methods DeepGMM [7] and DeepIV [18] on high-dimensional simulations from each respective paper. We also demonstrate that in data with a small subset having observed confounders, semi-supervised GCFN outperforms outcome regression on treatment and confounder within the subset.
We also show recovery of the effect of slave export on current societal trust [30].