Abstract
Unsupervised domain adaptation methods traditionally assume that all source categories are present in the target domain. In practice, little may be known about the category overlap between the two domains. While some methods address target settings with either partial or open-set categories, they assume that the particular setting is known a priori. We propose a more universally applicable domain adaptation framework that can handle arbitrary category shift, called Domain
Adaptative Neighborhood Clustering via Entropy optimization (DANCE). DANCE combines two novel ideas: First, as we cannot fully rely on source categories to learn features discriminative for the target, we propose a novel neighborhood clustering technique to learn the structure of the target domain in a self-supervised way. Second, we use entropy-based feature alignment and rejection to align target features with the source or reject them as unknown categories based on their entropy.
We show through extensive experiments that DANCE outperforms baselines across open-set, open-partial, and partial domain adaptation settings. Implementation is available at https://github.com/VisionLearningGroup/DANCE.

Introduction 1
Deep neural networks can learn highly discriminative representations for image recognition tasks [8, 37, 20, 31, 16], but do not generalize well to new domains that are not distributed identically to the training data. Domain adaptation (DA) aims to transfer representations of source categories to novel target domains without additional supervision. Recent deep DA methods primarily achieve this by minimizing the feature distribution shift between the source and target samples [11, 24, 38]. However, these methods make strong assumptions about the degree to which the source categories overlap with the target domain, which limits their applicability to many real-world settings.
In this paper, we investigate the problem of Universal DA. Suppose Ls and Lt are the label sets in the source and target domain. In Universal DA we want to handle all of the following potential “category shifts”: closed-set (Ls = Lt), open-set (Ls ⊂ Lt) [1, 35], partial (Lt ⊂ Ls) [2], or a mix of open and partial [43]. Existing DA methods cannot address Universal DA well because they are each designed to handle just one of the above settings. However, since the target domain is unlabeled, we may not know in advance which of these situations will occur. Thus, an unexpected category shift could lead to catastrophic misalignment. For example, using a closed-set method when the target has novel (“unknown”) classes could incorrectly align them to source (“known”) classes. The underlying issue at play is that existing work heavily relies on prior knowledge about the category shift.
The second problem is that the over-reliance on source supervision makes it challenging to obtain discriminative features on the target. Prior methods focus on aligning target features with source, rather than on exploiting structure speciﬁc to the target domain. In the universal DA setting, this 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Figure 1: We propose DANCE, which combines a self-supervised clustering loss (red) to cluster neighboring target examples and an entropy separation loss (gray) to consider alignment with source (best viewed in color). means that we may fail to learn features useful for discriminating “unknown” categories from the known categories, because such features may not exist in the source. Self-supervision was proposed in [5] to extract domain-generalizable features, but it is limited in that they did not utilize the cluster structure of the target domain.
We propose to overcome these challenging problems by introducing Domain Adaptive Neighborhood
Clustering via Entropy optimization (DANCE). An overview is shown in Fig. 1. Rather than relying only on the supervision of source categories to learn a discriminative representation, DANCE harnesses the cluster structure of the target domain using self-supervision. This is done with a “neighborhood clustering“ technique that self-supervises feature learning in the target. At the same time, useful source features and class boundaries are preserved and adapted via distribution alignment with batch-normalization [7] and a novel partial domain alignment loss that we refer to as “entropy separation loss“. This loss allows the model to either match each target example with the source, or reject it as an “unknown” category. Our contributions are summarized as follows: (i) we propose DANCE, a universal domain adaptation framework that can be applied out-of-the-box without prior knowledge of speciﬁc category shift, (ii) design two novel loss functions, neighborhood clustering and entropy separation, for category shift-agnostic adaptation, (iii) experimentally observe that DANCE is the only method that outperforms the source-only model in every setting, achieving state-of-the-art performance on all open-set and open-partial DA settings, and some partial DA settings, and (iv) learn discriminative features of “unknown” target samples without any supervision. 2