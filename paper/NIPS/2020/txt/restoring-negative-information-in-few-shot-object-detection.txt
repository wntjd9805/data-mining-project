Abstract
Few-shot learning has recently emerged as a new challenge in the deep learning
ﬁeld: unlike conventional methods that train the deep neural networks (DNNs) with a large number of labeled data, it asks for the generalization of DNNs on new classes with few annotated samples. Recent advances in few-shot learning mainly focus on image classiﬁcation while in this paper we focus on object detection. The initial explorations in few-shot object detection tend to simulate a classiﬁcation scenario by using the positive proposals in images with respect to certain object class while discarding the negative proposals of that class. Negatives, especially hard negatives, however, are essential to the embedding space learning in few-shot object detection. In this paper, we restore the negative information in few-shot object detection by introducing a new negative- and positive-representative based metric learning framework and a new inference scheme with negative and positive representatives. We build our work on a recent few-shot pipeline RepMet [1] with several new modules to encode negative information for both training and testing.
Extensive experiments on ImageNet-LOC and PASCAL VOC show our method substantially improves the state-of-the-art few-shot object detection solutions. Our code is available at https://github.com/yang-yk/NP-RepMet. 1

Introduction
In the past decade, there has been a transformative revolution in computer vision cultivated by the adoption of deep learning [2]. Driven by the increasing availability of large annotated datasets and efﬁcient training techniques, deep learning-based solutions have been progressively employed from image classiﬁcation to action recognition. The majority of deep learning methods are designed to solve fully-supervised problems where large amount of data come with carefully assigned labels. In contrast, humans, even children can easily recognize a multitude of objects in images when told only once or few times, despite the fact that the image of objects may vary in different viewpoints, sizes and scales. This ability, however, is still a challenge for machine perception.
To enable machine perception with only few training samples, some studies start shifting towards the so-called few-shot learning problem: after learning on a set of base (seen) classes with abundant examples, new tasks are given with only few support images of novel (unseen) classes. Recent advances in few-shot learning mainly focus on image classiﬁcation and recognition tasks [3–9].
∗The work is done when Yukuan Yang was an intern at Microsoft Research Asia. Miaojing Shi and Guoqi Li are the corresponding authors. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Figure 1: Restoring negative information in few-shot object detection.
Nonetheless, few-shot learning can also be applied to more complex tasks, e.g. object detection [10, 1, 11–13], assuming bounding box annotations are available in few support images for new classes.
Investigation further this line is very limited. Initial explorations resemble solutions in the few-shot classiﬁcation [3, 4], where prototype representations are learned [1] and weighted [10, 11] from the few labeled samples per class, and used to match the query sample of a speciﬁc class.
For the convenience of adapting few-shot classiﬁcation methods, the common practice in few-shot object detection [10, 1, 12, 11, 13] directly extracts positive proposals (green boxes in Figure. 1) of large Intersection over Union (IoU) with ground truth (yellow) from support images, while discards negative proposals (red) containing partial objects, ambiguous surrounds, or complex backgrounds in images. As a result, these negative proposals often end up as false positives in the ﬁnal detection (see Figure. 3). In the meantime, negative proposals in fully-supervised object detection [14–16] are carefully evaluated via their IoU with ground truth; hard negatives (e.g. τ <IoU<t ) are particularly selected to train against with and improve the robustness of the classiﬁer.
Building upon the above observation, the purpose of this study is to restore the negative information properly in few-shot object detection. Our essential idea is to make use of both positive and negative proposals in training images (Figure. 1): an embedding space can be learnt upon them where distances correspond to a measure of object similarity to both positive and negative representatives. Once this space is learnt, few-shot object detection can be easily implemented using any standard techniques with our proposed embedding method as feature vectors. Without loss of generality, we build our work on top of an established pipeline, RepMet [1], where multiple positive representatives are learnt for each base class at training, and replaced by embedding vectors from positive proposals of support images for new classes at testing. In light of the importance of negative information in images, we propose to split the class representation in RepMet into two modules to learn negative and positive representatives separately; the embedding vector of a given proposal is also replaced with a new negative and positive embedding (NP-embedding). The optimization of the embedding space differs between negative and positive proposals: if a proposal is positive to a certain class, we want to push it close to those positive representatives of that class and away from those negative representatives of that class; if it is negative to a certain class, the optimization is the opposite. We introduce triplet losses based on the NP-embedding for this purpose. The class label prediction branch in RepMet is also adapted with the proposed NP-embedding.
At the inference stage with new classes, the learnt representatives are replaced with embedding vectors from both positive and negative proposals harvested in supported images. The number of negative proposals is much more than that of positive proposals. To select hard and diverse negatives, we ﬁrst choose them with an IoU criterion (τ <IoU<t) w.r.t ground truth; a clustering-based selection strategy is further introduced to guarantee the diversity of negative proposals.
To our knowledge, we are the ﬁrst to present the idea of restoring negative information in few-shot object detection. The contribution of our work is three-fold:
• We introduce a new negative- and positive-representative based metric learning framework (NP-RepMet) with negative information incorporated in different modules for better feature steering in the embedding space.
• We propose a new inference scheme using both negative and positive representatives; for harvesting the hard and diverse negatives from the support set, a clustering-based hard negative selection strategy is also introduced.
• Extensive experiments on standard benchmarks ImageNet-LOC [1] and PASCAL VOC 2007 [10] demonstrate that our method substantially improves the SOTA (i.e. up to +11% on ImageNet-LOC and +19% on PASCAL VOC). 2
2