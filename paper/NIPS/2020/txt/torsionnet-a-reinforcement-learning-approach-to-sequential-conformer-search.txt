Abstract
Molecular geometry prediction of ﬂexible molecules, or conformer search, is a long-standing challenge in computational chemistry. This task is of great importance for predicting structure-activity relationships for a wide variety of substances ranging from biomolecules to ubiquitous materials. Substantial computational resources are invested in Monte Carlo and Molecular Dynamics methods to generate diverse and representative conformer sets for medium to large molecules, which are yet intractable to chemoinformatic conformer search methods. We present TorsionNet, an efﬁcient sequential conformer search technique based on reinforcement learning under the rigid rotor approximation. The model is trained via curriculum learning, whose theoretical beneﬁt is explored in detail, to maximize a novel metric grounded in thermodynamics called the Gibbs Score. Our experimental results show that
TorsionNet outperforms the highest scoring chemoinformatics method by 4x on large branched alkanes, and by several orders of magnitude on the previously unexplored biopolymer lignin, with applications in renewable energy. TorsionNet also outperforms the far more exhaustive but computationally intensive Self-Guided
Molecular Dynamics sampling method. 1

Introduction
Accurate prediction of likely 3D geometries of ﬂexible molecules is a long standing goal of com-putational chemistry, with broad implications for drug design, biopolymer research, and QSAR analysis. However, this is a very difﬁcult problem due to the exponential growth of possible stable physical structures, or conformers, as a function of the size of a molecule. Levinthal’s infamous paradox notes that a medium sized protein polypeptide chain exposes around 10143 possible torsion angle combinations, indicating brute force to be an intractable search method for all but the smallest molecules [21]. While the conformational space of a molecule’s rotatable bonds is continuous with an inﬁnite number of possible conformations, there are a ﬁnite number of stable, low energy conformers that lie in a local minimum on the energy surface [26]. Research in pharmaceuticals and bio-polymer material design can be accelerated by developing efﬁcient methods for low energy conformer search of large molecules.
Take the example of lignin, a class of chemically complex branched biopolymer that has great potential as a renewable biofuel [32, 56]. The challenge in taking advantage of lignin is its structural complexity that makes it hard to selectively break down into useful chemical components [45]. Effective strategies to make use of lignin require deep understanding of its chemical reaction pathways, which in turn require accurate sampling of conformational behavior [4, 24]. Molecular dynamics (MD) simulations (though expensive) is the usual method for sampling complex molecules such as lignin [37, 54].
Understanding lignin processing on a molecular level using MD appears essential for improving their degradation efﬁciencies in mechano-chemical experimental processes [19]. 34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
Conformer generation and rigid rotor model. The goal of conformer generation is to build a representative set of conformers to "cover" the likely conformational space of a molecule, and sample its energy landscape well [8]. To that end, many methods have been employed [8, 15] to generate diverse sets of low energy conformers. Three notable cheminformatics methods are RDKit’s
Experimental-Torsion Distance Geometry with Basic Knowledge (ETKDG) [33], OpenBabel’s
Confab systematic search algorithm [30], and CORINA [39]. ETKDG and Confab are open source whereas CORINA is commercial. The latter focuses on generating a single low-energy conformer.
ETKDG generates a distance bounds matrix to specify minimum and maximum distances each atomic pair in a molecule can take, and stochastically samples conformations that ﬁt these bounds.
On the other hand, Confab is a systematic search process, utilizing the rigid rotor approximation of ﬁxing constant bond angles and bond lengths. With bond angles and lengths frozen, the only degrees of freedom for molecular geometry are the torsion angles of rotatable bonds, which Confab discretizes into buckets and then sequentially cycles through all combinations. It has been previously demonstrated that the exhaustive Confab search performs similarly to RDKit for molecules with small rotatable bond number (rbn), but noticeably better for large, ﬂexible (rbn > 10) molecules [8] if the compute time is available. Systematic search is intractable at very high rbn (> 50) due to the combinatorial explosion of torsion angle combinations, whereas distance geometry fails entirely.
Differences from protein folding. Protein folding is a well-studied subproblem of conformer generation, where there is most often only one target conformer of a single, linear chain of amino acids. Protein folding is aided by vast biological datasets including structural homologies and genetic multiple sequence alignments (MSAs). In addition, the structural motifs for most ﬁnite sequences of amino acids are well known, greatly simplifying the folding problem. The few papers [2, 7, 16, 18] that apply machine learning methods to protein folding or conformer generation without any structural motifs predict only one target. In contrast, the general conformer generation problem is a far broader challenge where the goal is to generate a set of representative conformers. Additionally, there is insufﬁcient database coverage for other complex polymers that are structurally different from proteins since they are not as immensely studied [15]. For these reasons, deep learning techniques such as
Alphafold [41] developed for de novo protein generation do not have the same goal as we do.
Main Contributions. First, we argue that posing conformer search as a reinforcement learning problem has several beneﬁts over alternative formulations including generative models. Second, we present TorsionNet, a conformer search technique based on Reinforcement Learning (RL). We make careful design choices in the use of MPNNs [12] with LSTMs [17] to generate independent torsion sampling distributions for all torsions at every timestep. Further, we construct a nonstationary reward function to model the task as a dynamic search process that conditions over histories. Third, we employ curriculum learning, a learning strategy that trains a model on simpler tasks and then gradually increases the task difﬁculty. In conformer search, we have a natural indication of task difﬁculty, namely the number of rotatable bonds, and size of the molecule. Fourth, we demonstrate that TorsionNet outperforms chemoinformatic methods in an environment of small and medium sized alkanes by up to 4x, and outclasses them by at least four orders of magnitude on a large lignin polymer.
TorsionNet also performs around twice as well as the far more compute intensive Self-Guided MD (SGMD) on the lignin environment. We also demonstrate that TorsionNet has learned to detect important conformational regions. Curriculum learning is increasingly used in RL but we have little theoretical understanding for why it works [27]. Our ﬁnal contribution is showing, via simple simple theoretical arguments, why curriculum learning might be able to reduce the sample complexity of simple exploration strategies in RL under suitable assumptions about task relatedness.