Causal effect estimation in research involves separating the outcome's variation into parts attributed to the treatment and confounding factors. Instrumental variables (IVs) are often used to accomplish this separation by introducing external sources of randomness that only affect the treatment. We examine control functions, which are variables constructed from the treatment and IVs that aid in estimating effects. We establish a meta-identification result that characterizes general control functions for effect estimation. Additionally, we demonstrate that specific assumptions about the treatment process enable the creation of general control functions, ensuring identification. To estimate effects and construct general control functions, we introduce the general control function method (GCFN). The first stage of GCFN, known as variational decoupling (VDE), constructs general control functions by capturing the residual variation in the treatment based on the IV. The second stage of GCFN uses regression to estimate effects using the control function obtained from VDE. Moreover, we develop a semi-supervised version of GCFN that constructs general control functions using subsets of data where both IVs and confounders are observed as supervision, eliminating the need for assumptions about the structural treatment process. We evaluate the performance of GCFN on simulated data with varying dimensions and on determining the causal effect of slave export on modern community trust.