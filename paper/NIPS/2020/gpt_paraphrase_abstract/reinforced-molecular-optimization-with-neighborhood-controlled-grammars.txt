Designing new molecules with specific properties is a major challenge in the pharmaceutical industry, particularly when property evaluation is expensive. In this study, we propose MNCE-RL, a graph convolutional policy network that utilizes molecular neighborhood-controlled embedding grammars to optimize molecules through reinforcement learning. We enhance the embedding grammars to enable their application in molecular graph generation and develop an efficient algorithm to infer grammatical production rules from given molecules. By employing grammars, we ensure the validity of the generated molecular structures. The transformation of molecular graphs into parse trees using the inferred grammars allows us to model the task of molecular structure generation as a Markov decision process, utilizing a policy gradient strategy. Through a series of experiments, we demonstrate that our approach achieves state-of-the-art performance across various molecular optimization tasks and outperforms other methods in optimizing molecular properties with a limited number of property evaluations.