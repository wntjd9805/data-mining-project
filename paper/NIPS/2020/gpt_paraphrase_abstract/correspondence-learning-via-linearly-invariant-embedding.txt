This paper presents a fully differentiable pipeline for accurately estimating dense correspondences between 3D point clouds. The pipeline builds upon the functional maps framework but introduces a novel approach of learning the basis from data. Unlike previous methods that rely on Laplace-Beltrami eigenfunctions, our approach demonstrates improved robustness and accuracy in challenging scenarios. We interpret the basis as a learned embedding in a higher dimensional space and propose a separate architecture for estimating the optimal transformation using learned descriptor functions. This creates the first end-to-end trainable functional map-based correspondence approach where both the basis and descriptors are learned from data. Surprisingly, we find that learning a canonical embedding leads to worse results, suggesting that allowing for an extra linear degree of freedom improves the robustness of the embedding network. Additionally, our approach achieves state-of-the-art results in challenging non-rigid 3D point cloud correspondence applications.