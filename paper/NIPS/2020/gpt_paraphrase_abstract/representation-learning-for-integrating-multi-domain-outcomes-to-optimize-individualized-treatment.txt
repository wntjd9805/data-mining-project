To address the challenges in treating mental disorders, we propose an integrated learning framework that can simultaneously determine patients' underlying mental states and recommend optimal treatments for each individual. This framework is based on measurement theory in psychiatry and allows for the incorporation of various diagnostic measures and patient outcomes, while maintaining the structure of patients' latent mental states. We use a multi-layer neural network to account for complex treatment effect heterogeneity. By comparing potential mental states under different treatments, we can infer the optimal treatment policy for future patients. Our experiments on simulated data and real-world clinical trial data demonstrate that our framework outperforms alternative methods in terms of treating patients with different treatment effects and leads to improved patient outcomes in multiple domains.