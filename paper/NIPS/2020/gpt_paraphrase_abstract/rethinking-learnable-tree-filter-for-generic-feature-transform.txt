The Learnable Tree Filter offers a unique approach to modeling structure-preserving relations in semantic segmentation. However, its reliance on spatial distance limits its ability to effectively capture long-range interactions. To address this issue, we reformulate the filter as a Markov Random Field and introduce a learnable unary term. We also replace the original non-differentiable algorithm with a learnable spanning tree algorithm, enhancing flexibility and robustness. These improvements enable our method to better capture long-range dependencies and preserve structural details with linear complexity. We extend our approach to other vision tasks and achieve superior performance in object detection/instance segmentation. In the Cityscapes benchmark for semantic segmentation, we achieve a leading mIoU score of 82.1% without additional enhancements. The code for our method is available at https://github.com/StevenGrove/LearnableTreeFilterV2.