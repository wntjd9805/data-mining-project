In this paper, we address the challenge of multi-agent credit assignment in cooperative multi-agent systems (MAS) by proposing a novel approach called Value function factorization with variable agent sub-teams (VAST). We argue that the existing VFF approaches suffer from performance bottlenecks when applied to domains with a large number of agents. To overcome this limitation, VAST approximates a centralized value function by factorizing it into local values for agent sub-teams, which can be defined in an arbitrary and adaptable manner. We present the formulation of VAST, introduce a meta-gradient approach for optimizing sub-team assignments, and evaluate the performance of various VAST variants in three multi-agent domains. The results show that VAST outperforms state-of-the-art VFF approaches in scenarios with a large number of agents, effectively addressing the credit assignment problem in MAS.