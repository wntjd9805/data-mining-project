Abstract
We study the problem of extracting correspondences between a pair of point clouds for registration. For correspondence retrieval, existing works beneﬁt from matching sparse keypoints detected from dense points but usually struggle to guarantee their repeatability. To address this issue, we present CoFiNet - Coarse-to-Fine Network which extracts hierarchical correspondences from coarse to ﬁne without keypoint detection. On a coarse scale and guided by a weighting scheme, our model ﬁrstly learns to match down-sampled nodes whose vicinity points share more overlap, which signiﬁcantly shrinks the search space of a consecutive stage. On a ﬁner scale, node proposals are consecutively expanded to patches that consist of groups of points together with associated descriptors. Point correspondences are then reﬁned from the overlap areas of corresponding patches, by a density-adaptive matching module capable to deal with varying point density. Extensive evaluation of CoFiNet on both indoor and outdoor standard benchmarks shows our superiority over existing methods. Especially on 3DLoMatch where point clouds share less overlap, CoFiNet signiﬁcantly outperforms state-of-the-art approaches by at least 5% on Registration Recall, with at most two-third of their parameters. [Code] 1

Introduction
Correspondence search is a core topic of computer vision and establishing reliable correspondences is a key to success in many fundamental vision tasks, such as tracking, reconstruction, ﬂow estimation, and particularly, point cloud registration. Point cloud registration aims at recovering the transforma-tion between a pair of partially overlapped point clouds. It is a fundamental task in a wide range of real applications, including scene reconstruction, autonomous driving, simultaneous localization and mapping (SLAM), etc. However, due to the unordered and irregular properties of point clouds, extracting reliable correspondences from them has been a challenging task for a long time. From early-stage hand-crafted methods [1, 2, 3, 4, 5] to recently emerged deep learning-based approaches
[6, 7, 8, 9, 10, 11, 12], many works contributed to improving the reliability of correspondences.
We can broadly categorize recent deep learning-based point cloud registration methods into three categories. The ﬁrst [13, 14, 15] follows the idea of ICP [16], where they iteratively ﬁnd dense correspondences and compute pose estimation. The second [17, 18] includes the correspondence-free methods based on the intuition that the feature distance between two well-aligned point clouds should be small. Such methods encode the whole point cloud as a single feature and iteratively optimize the relative pose between two frames by minimizing the distance of corresponding features. Though achieving reasonable results on synthetic object datasets [19], both of them struggle on large-scale real benchmarks [20, 6], as the ﬁrst suffers from low correspondence precision and high computational complexity, while the second lacks robustness to noise and partial overlap. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: Left: Overview of CoFiNet. From top to bottom: 1) Dense points are down-sampled to uniformly distributed nodes, while associated features are jointly learned. 2) Correspondence
Proposal Block (Top Right): Features are strengthened and used to calculate the similarity matrix.
Coarse node correspondences are then proposed from the conﬁdence matrix. 3) Strengthened features are decoded to dense descriptors associated with each input point. 4) Correspondence Reﬁnement
Block (Bottom Right): Coarse node proposals are ﬁrst expanded to patches via grouping. Patch correspondences are then reﬁned to point level by our proposed density-adaptive matching module, whose details can be found in Fig. 2.
Differently, the last category of methods [6, 7, 8, 9, 10, 11, 12] tackles point cloud registration in a two-stage manner. They ﬁrstly learn local descriptors of down-sampled sparse points (nodes) for matching, and afterward use robust pose estimators, e.g., RANSAC [21], for recovering the relative transformation. Their two-stage strategy makes them achieve state-of-the-art performance on large-scale real benchmarks [20, 6]. Uniform sampling [7, 8] and keypoint detection [22, 10, 11, 12] are two common ways to introduce sparsity. Compared to uniform sampling that samples points randomly, keypoint detection estimates the saliency of points and samples points with strong geometry features, which signiﬁcantly reduces the ambiguity of matching. However, the sparsity by nature challenges repeatability, i.e., sub-sampling increases the risk where a certain point loses its corresponding point in the other frame, which constrains the performance of detection-based methods [22, 10, 11, 12].
Recently, a coarse-to-ﬁne mechanism is leveraged by our 2D counterparts [23, 24, 25] to avoid direct keypoint detection, which shows superiority over the state-of-the-art detection-based method [26].
However, in 3D point cloud matching, where keypoint detectors usually perform worse, existing deep learning-based methods do not yet exploit such a coarse-to-ﬁne strategy. To ﬁll the gap, we focus on leveraging the coarse-to-ﬁne mechanism to eliminate the side effects of detecting sparse keypoints.
Nevertheless, designing such a coarse-to-ﬁne pipeline in point cloud matching is non-trivial, mainly due to the inherent unordered and irregular nature of point clouds. To this end, we propose a weighting scheme for coarse node matching and a density-adaptive matching module for correspondence reﬁnement, which enables CoFiNet to extract coarse-to-ﬁne correspondences from point clouds.
More speciﬁcally, on a coarse scale, the weighting scheme proportional to local overlap ratios guides the model to propose correspondences of nodes whose vicinity areas share more overlap, which effectively squeezes the search space of the consecutive reﬁnement. On a ﬁner scale, the density-adaptive matching module reﬁnes coarse correspondence proposals to point level by solving a differentiable optimal transport problem [26] with awareness to varying point density, which shows more robustness on irregular points. An overview of our proposed method can be found in Fig. 1.
Our main contributions are summarized as follows:
• A detection-free learning framework that treats point cloud registration as a coarse-to-ﬁne correspondence problem, where point correspondences are consecutively reﬁned from coarse proposals that are extracted from unordered and irregular point clouds. 2
• A weighting scheme that, on a coarse scale, guides our model to learn to match uniformly down-sampled nodes whose vicinity areas share more overlap, which signiﬁcantly shrinks the search space for the reﬁnement.
• A differentiable density-adaptive matching module that reﬁnes coarse correspondences to point level based on solving an optimal transport problem with awareness to point density, which is more robust to the varying point density.
To the best of our knowledge, we are the ﬁrst deep learning-based work that incorporates a coarse-to-ﬁne mechanism in correspondence search for point cloud registration. Extensive experiments are conducted on both indoor and outdoor benchmarks to show our superiority. Notably, CoFiNet surpasses the state-of-the-art with much fewer parameters. Compared to [12], we only use around two-third and one-fourth of parameters on indoor and outdoor benchmarks, respectively. 2