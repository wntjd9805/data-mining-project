Abstract
Integrating data from multiple experiments is common practice in systems neuro-science but it requires inter-experimental variability to be negligible compared to the biological signal of interest. This requirement is rarely fulﬁlled; systematic changes between experiments can drastically affect the outcome of complex anal-ysis pipelines. Modern machine learning approaches designed to adapt models across multiple data domains offer ﬂexible ways of removing inter-experimental variability where classical statistical methods often fail. While applications of these methods have been mostly limited to single-cell genomics, in this work, we develop a theoretical framework for domain adaptation in systems neuroscience. We imple-ment this in an adversarial optimization scheme that removes inter-experimental variability while preserving the biological signal. We compare our method to previ-ous approaches on a large-scale dataset of two-photon imaging recordings of retinal bipolar cell responses to visual stimuli. This dataset provides a unique benchmark as it contains biological signal from well-deﬁned cell types that is obscured by large inter-experimental variability. In a supervised setting, we compare the gener-alization performance of cell type classiﬁers across experiments, which we validate with anatomical cell type distributions from electron microscopy data. In an un-supervised setting, we remove inter-experimental variability from data which can then be fed into arbitrary downstream analyses. In both settings, we ﬁnd that our method achieves the best trade-off between removing inter-experimental variability and preserving biological signal. Thus, we offer a ﬂexible approach to remove inter-experimental variability and integrate datasets across experiments in systems neuroscience. Code available at https://github.com/eulerlab/rave.
˚;Equal contributions, 1 University of Tübingen, 2 Norwegian University of Science and Technology. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
1

Introduction
Systems neuroscientists are often concerned with identifying and characterizing how properties of neurons vary along certain dimensions of interest. Differences in these properties between neurons form the basis for sorting them into discrete categories. Both the advance of large-scale data acquisition techniques in experimental neuroscience as well as the development of more efﬁcient and powerful data analysis methods allow collecting and analyzing datasets of increasing size; and hence the discovery of more subtle variations in neural function between cell types [e.g. 1–4]. However, as data acquisition is often an incremental process, it has become common practice to pool data from multiple experiments. This practice ignores variability in the data stemming from external factors, which include non-biological ones (e.g. sample handling resulting in small differences in tissue quality, or temperature ﬂuctuations affecting the rates of biochemical processes) but potentially also unforeseen biological ones (e.g. subtle genetic variations) [3, 5, 6]. Such variability due to external factors, here referred to as inter-experimental variability, can confound and obscure the biological signals of interest. In some cases, the source of inter-experimental variability is known and can be modeled [5], but if this is not the case, a method for removing it from the data is required.
The issue of inter-experimental variability in systems neuroscience is analogous to the problem of domain shift in machine learning, where the data distribution changes between training (‘source’) and test (‘target’) data, causing an algorithm to fail when deployed on data from an unseen target domain [7–10]. Methods that address this issue have to perform some form of domain adaptation, i.e. adapting the algorithm to work both on the training as well as some (usually unseen) test domain
[11]. In single-cell genomics, a number of different studies have proposed methods for removing inter-experimental variability (see Section 2), but related works in systems neuroscience are lacking, despite the recognized need for such approaches [3, 5]. Here, we contribute to closing this gap as follows:
• We cast the removal of inter-experimental variability from functional data in systems neuroscience in the theoretical framework of domain adaptation (Figure 1 and Section 3).
• We adapt and evaluate different approaches and demonstrate improved performance of cell type assignment, while preserving the biological signals of interest (Table 1 and Figure 4).
• We demonstrate that our method produces cell type predictions on a new dataset that are best aligned with anatomical data (Table 2 and Figure 5).
• Finally, we showcase in a downstream analysis that the corrected data (Figure 3) clearly exhibits biological effects that were obscured by inter-experimental variability (Figure 6). 2