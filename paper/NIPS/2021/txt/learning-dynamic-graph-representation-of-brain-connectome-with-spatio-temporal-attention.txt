Abstract
Functional connectivity (FC) between regions of the brain can be assessed by the degree of temporal correlation measured with functional neuroimaging modal-ities. Based on the fact that these connectivities build a network, graph-based approaches for analyzing the brain connectome have provided insights into the functions of the human brain. The development of graph neural networks (GNNs) capable of learning representation from graph structured data has led to increased interest in learning the graph representation of the brain connectome. Although recent attempts to apply GNN to the FC network have shown promising results, there is still a common limitation that they usually do not incorporate the dy-namic characteristics of the FC network which ﬂuctuates over time. In addition, a few studies that have attempted to use dynamic FC as an input for the GNN reported a reduction in performance compared to static FC methods, and did not provide temporal explainability. Here, we propose STAGIN, a method for learn-ing dynamic graph representation of the brain connectome with spatio-temporal attention. Speciﬁcally, a temporal sequence of brain graphs is input to the STAGIN to obtain the dynamic graph representation, while novel READOUT functions and the Transformer encoder provide spatial and temporal explainability with at-tention, respectively. Experiments on the HCP-Rest and the HCP-Task datasets demonstrate exceptional performance of our proposed method. Analysis of the spatio-temporal attention also provide concurrent interpretation with the neuro-scientiﬁc knowledge, which further validates our method. Code is available at https://github.com/egyptdj/stagin 1

Introduction
Neuroimaging modalities provide measurements of brain activity by capturing the signals of neural activity. Functional magnetic resonance imaging (fMRI) is a non-invasive imaging method that measures the blood-oxygen level dependence (BOLD) in order to estimate the neural activity of the whole brain over time [20]. Functional connectivity (FC) is deﬁned as the degree of temporal
∗This work was conducted while the ﬁrst author was at KAIST 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
correlation between regions of the brain. Based on the fact that these connectivities form networks that change over time, graph-based network analysis of brain connectome has been one of the key approaches to understanding how the brain works [7, 4, 43].
Graph neural networks (GNNs) are a type of deep neural networks that have recently been successful in learning the representation of graph-structured data [50]. The graph-structured nature of the brain has led to an increased interest in learning the reperesentation of the brain FC network with the GNNs.
Learning the representation of the brain connectome can be linked to decoding trait or state from human brain signal measurements. Accordingly, the current trend in studies attempting to apply GNN to the brain connectome is to input the FC graph from either resting-state [25, 26, 2, 33, 23, 48, 49] or task fMRI data [29, 30, 32] and predict a particular phenotype of the subjects, such as gender
[26, 2, 23, 22] or presence of a speciﬁc disease [26, 33, 29, 30, 32, 22]. While these studies have shown potential strengths and opportunities for learning the network representation of the brain, they also suggest limitations of current GNN-based methods.
One of the most common limitations with previous GNN-based FC network analysis methods is that most of them fail to take advantage of the dynamic properties of the FC network, which ﬂuctuates over time. Incorporating the dynamic features of the FC network into the neuroimaging analysis has been an important direction in the ﬁeld of functional neuroimaging [21, 37]. A work by [15] tried to address this issue by using the Spatial Temporal Graph Convolutional Network (ST-GCN) [54] model to incorporate dynamic features of the FC network. However, [15] reported lower accuracy than other non-dynamic GNN-based FC methods [23, 2] in the gender classiﬁcation experiment, leaving a question about the effectiveness of the dynamic FC method. In addition, another limitation of the method is that no temporal explainability is provided from the model. This is a major drawback considering that the goal of applying GNNs to functional neuroimaging methods is not only to achieve high classiﬁcation accuracy, but also to uncover the functional basis of the brain [23, 32]. Another recent work by [3], using GraphNets [5] and DiffPool [58] for the dynamic FC analysis, also suffers from the same limitations in terms of poor classiﬁcation accuracy and lack of temporal explainability.
Here, we propose Spatio-Temporal Attention Graph Isomorphism Network (STAGIN) for learning the dynamic graph representation of the brain connectome with spatio-temporal attention. The proposed method exploits the temporal features of the dynamic FC network graphs to improve the classiﬁcation accuracy of the model. In particular, we address the issue that the node features of the input dynamic graph should contain temporal information and concatenate encoded timestamp with the node features (Section 4.1). In addition, the proposed method includes novel attention-based
READOUT modules (Section 4.2) and the Transformer encoder [46] (Section 4.3) in order to further improve the classiﬁcation performance and provide spatial-temporal explainability at the same time.
STAGIN achieves state-of-the-art performance with the Human Connectome Project (HCP) dataset
[45] in gender classiﬁcation for resting-state fMRI and task decoding for task fMRI. We inherit k-means clustering analysis of the resting-state dynamic FC [1] and general linear model (GLM) statistical mapping of task fMRI [14] for interpreting the spatio-temporal attention learned from
STAGIN, which are widely accepted analysis methods for the fMRI data. The interpretation of the learned spatio-temporal attention replicates neuroscientiﬁc ﬁndings from previous large-scale fMRI studies in both resting-state and task fMRI, which further validates our proposed method.
Our work holds potential societal impact in that brain decoding methods can be linked to ﬁnding neural biomarkers of important phenotypes or diseases. However, potential negative impact related to privacy concerns that arise from abuse or misuse of accurate decoding methods should also be noted. Although our method is yet behind the decoding capability that can be abused or misused, our research cannot still be free from these ethical considerations. 2