Abstract
Learning the distribution of future trajectories conditioned on the past is a crucial problem for understanding multi-agent systems. This is challenging because humans make decisions based on complex social relations and personal intents, resulting in highly complex uncertainties over trajectories. To address this problem, we propose a conditional deep generative model that combines advances in graph neural networks. The prior and recognition model encodes two types of latent codes for each agent: an inter-agent latent code to represent social relations and an intra-agent latent code to represent agent intentions. The decoder is carefully devised to leverage the codes in a disentangled way to predict multi-modal future trajectory distribution. Speciﬁcally, a graph attention network built upon inter-agent latent code is used to learn continuous pair-wise relations, and an agent’s motion is controlled by its latent intents and its observations of all other agents. Through experiments on both synthetic and real-world datasets, we show that our model outperforms previous work in multiple performance metrics. We also show that our model generates realistic multi-modal trajectories. 1

Introduction
Generative trajectory forecasting requires learning the distribution of future trajectories conditioned on the past. It can provide an important foundation of path planning and tracking in many domains [28, 1].
In a highly interactive multi-agent environment, such as team sports, each individual takes actions based on its intentions, relations with, and observation of other agents [7]. For example, an attacking basketball player acts based on his/her strategy along with observations of teammates and the defending team. Similarly, an experienced driver identiﬁes potential dangers from observed actions and motions of other drivers, thereby planning ahead of time [27]. Notably, in many such real-world examples, intentions, relations, and interactions are all dynamic, hidden, and stochastic, leading to highly variable future trajectories.
We argue that to model uncertainty correctly we should account for factors that arise from both individual and social (i.e. relation) perspectives, and do so explicitly. That is to say, individual decision/intention and social relation/observation are inductive biases that should be explicitly
∗Work completed during internship at AWS Shanghai AI Labs.
†Correspondence authors are Junchi Yan and Tong He. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
introduced into a model design. Existing works model either intention [15, 32] or relations [24, 3, 36], not both, lead to compromised performance under highly interactive and uncertain environments [22].
To better address the problems above, we propose Generative Relation and Intention Network (GRIN) that explicitly models uncertainties of both the intention and relations, the design comes with an added beneﬁt of being more interpretable. Speciﬁcally, our contributions are: 1) We present GRIN, a conditional generative model for multi-agent trajectory prediction, trained by variational inference and learning [35]; 2) We propose a disentangled design of the model architecture such that the uncertainty from the intention and relations are modelled separately; 3) We evaluate our model on both a deterministic synthetic dataset [18] and a highly stochastic real-world dataset [41] by single-path and distributional metrics, quantifying the ability to predict accurately while being aware of multiple possibilities. Our model consistently outperforms advanced baselines on all datasets and metrics tested, highlighting the critical advantage of generative modeling of intentions and relations. 2