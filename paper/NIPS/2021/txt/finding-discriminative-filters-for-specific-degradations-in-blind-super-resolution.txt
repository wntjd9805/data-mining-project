Abstract
Recent blind super-resolution (SR) methods typically consist of two branches, one for degradation prediction and the other for conditional restoration. However, our experiments show that a one-branch network can achieve comparable performance to the two-branch scheme. Then we wonder: how can one-branch networks automatically learn to distinguish degradations? To find the answer, we propose a new diagnostic tool – Filter Attribution method based on Integral Gradient (FAIG).
Unlike previous integral gradient methods, our FAIG aims at finding the most discriminative filters instead of input pixels/features for degradation removal in blind SR networks. With the discovered filters, we further develop a simple yet effective method to predict the degradation of an input image. Based on FAIG, we show that, in one-branch blind SR networks, 1) we are able to find a very small number of (1%) discriminative filters for each specific degradation; 2) The weights, locations and connections of the discovered filters are all important to determine the specific network function. 3) The task of degradation prediction can be implicitly realized by these discriminative filters without explicit supervised learning. Our findings can not only help us better understand network behaviors inside one-branch blind SR networks, but also provide guidance on designing more efficient architectures and diagnosing networks for blind SR. The codes are available at https://github.com/TencentARC/FAIG. 1

Introduction
As a special category of image Super-Resolution (SR) [11, 6, 22], blind super-resolution [28, 3, 48] is an active research topic towards real-world restoration applications, and has attracted increasing attention. Blind SR aims at reconstructing a high-resolution image from its low-resolution counterpart which contains unknown and complex degradations (e.g., blur, noise). Recent deep-learning-based blind SR methods typically consist of two branches: one for degradation prediction and the other for conditional restorations [14, 25, 39], as illustrated in Fig. 1. This design incorporates human knowledge about the degradation process [8, 23] and is consistent in classical blind SR methods [28, 11], thus implying a certain degree of interpretability.
With the powerful representation ability of deep learning, it is natural to wonder whether a unified one-branch network can effectively address the blind SR problem without the delicate two-branch
∗Equal contributions. Liangbin Xie is an intern in ARC Lab, Tencent PCG. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: Left: Illustration for two-branch and one-branch blind SR networks. Right: A unified one-branch network could achieve comparable performance under similar computation budgets for state-of-the-art blind SR methods DAN [25] and DASR [39]. design from human prior knowledge. Thus, we conduct preliminary experiments on several state-of-the-art methods [25, 39] (more details in Sec. 3), and draw the observation that a unified one-branch network can achieve comparable results with similar computation budgets under proper training strategies, as shown in Fig. 1.
Despite its comparable performance, the one-branch network is more like a ‘black-box’, and we are curious about its connection with delicate two-branch designs with higher interpretability. Specifi-cally, the phenomenon mentioned above motivates us to raise two key questions: 1) Could one-branch networks automatically learn to distinguish degradations as what we specially design in two-branch methods? 2) Are there any small sub-network (i.e., a set of filters) existing for a specific degrada-tion? For these open questions, we lack systematic investigations and analysis tools to gain further understandings.
In this paper, we make the first attempt to explore the underlying mechanism of blind SR networks.
Our key findings are as follows: 1) In one-branch blind SR networks, we are able to find a very small number of (at least to 1%) discriminative filters for each specific degradation (e.g., blur, noise). When we mask these discovered filters for a specific degradation, the corresponding function is eliminated while functions for other degradations are maintained (as shown in Fig. 2, more details in Sec. 5.2.1). 2) Except for the filter weights, the locations and connections of the discovered filters also play an essential role in the network function for a specific degradation (see Sec. 5.2.2). 3) Based on these discovered filters, we could easily predict the degradation of input images without training in the supervision of degradation labels (see Sec. 5.3). In a word, a unified one-branch network is similar to a well-designed two-branch network in the working mechanism. The degradation prediction branch and several small sub-networks for various degradations could be automatically learned within the one-branch network, even it is trained without any supervision about degradation distinctions.
To analyze the mysterious blind SR networks and draw the above key findings, we propose a novel
Filter Attribution method based on Integral Gradient (FAIG), aiming at finding core filters in a network that make the greatest contribution to the function of a specific degradation removal. Different from previous integral gradient methods [37, 36] that cumulate gradients along paths in the pixel/feature space, our FAIG utilizes paths in the parameter space, which has a clearer meaning in attributing network functional alterations to filter changes (i.e., the changes of filter parameters rather than inputs result in the network function alteration). Built on FAIG, we further develop a simple yet effective method to predict the degradation of an input image (see Sec. 4.3).
To summarize, the contributions are three-fold. 1) Our findings provide a better understanding of the mechanism under blind SR networks, especially, bringing insightful connections between popular two-branch methods and unified one-branch networks. 2) The discovered discriminative filters for specific degradations allow us not only to perform degradation prediction, but also achieve a controllable adjustment of restoration strength without introducing extra parameters. 3) Exploiting the interpretability of blind SR would bring great significance for future works in i) designing more efficient architectures; ii) diagnosing an SR network, such as determining the boundary of network restoration capacity and improving algorithm robustness. 2