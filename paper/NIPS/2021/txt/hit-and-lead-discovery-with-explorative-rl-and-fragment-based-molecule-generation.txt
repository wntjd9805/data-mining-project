Abstract
Recently, utilizing reinforcement learning (RL) to generate molecules with de-sired properties has been highlighted as a promising strategy for drug design. A molecular docking program – a physical simulation that estimates protein-small molecule binding afﬁnity – can be an ideal reward scoring function for RL, as it is a straightforward proxy of the therapeutic potential. Still, two imminent challenges exist for this task. First, the models often fail to generate chemically realistic and pharmacochemically acceptable molecules. Second, the docking score optimization is a difﬁcult exploration problem that involves many local optima and less smooth surfaces with respect to molecular structure. To tackle these challenges, we propose a novel RL framework that generates pharmacochemically acceptable molecules with large docking scores. Our method – Fragment-based generative RL with Ex-plorative Experience replay for Drug design (FREED) – constrains the generated molecules to a realistic and qualiﬁed chemical space and effectively explores the space to ﬁnd drugs by coupling our fragment-based generation method and a novel error-prioritized experience replay (PER). We also show that our model performs well on both de novo and scaffold-based schemes. Our model produces molecules of higher quality compared to existing methods while achieving state-of-the-art performance on two of three targets in terms of the docking scores of the gener-ated molecules. We further show with ablation studies that our method, predictive error-PER (FREED(PE)), signiﬁcantly improves the model performance. 1

Introduction
Searching for “hits", the molecules with desired therapeutic potentials, is a critical task in drug discovery. Instead of screening a library of countless potential candidates in a brute-force manner, designing drugs with sample-efﬁcient generative models has been highlighted as a promising strategy.
While many generative models for drug design are trained on the distribution of known active compounds [1–3], such models tend to produce molecules that are similar to that of the training dataset [4], which discourages ﬁnding novel molecules.
In this light, reinforcement learning (RL) has been increasingly used for goal-directed molecular design, thanks to its exploration ability. Previous models have been assessed with relatively simple
∗Currently at MIT.
†Currently at LG AI Research.
‡Currently at Galux inc. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: Overview of our generative drug discovery method. To ﬁnd realistic ‘hit’ molecules that have high docking scores, we combine fragment-based generation method with SAC and PER. This
ﬁgure illustrates our version of PER where the priority of the experience is deﬁned by predictive error. objectives, such as cLogP and QED, or estimated bioactivity scores predicted by auxiliary models
[5–8]. However, high scores in those simple properties of molecules guarantee neither drug-likeness nor therapeutic potential, emphasizing the necessity of more relevant design objectives in generative tasks [9, 10]. The molecular docking method is a physical simulation that estimates the protein-small molecule binding afﬁnity, a key measure of drug efﬁcacy. As docking simulations are a more straightforward proxy of therapeutic potential, coupling RL with docking simulations would be a promising strategy. While the simplistic scores (e.g., cLogP, QED) are computed by a sum of local fragments’ scores and are not a function of global molecular structure, making the optimization tasks relatively simple, docking score optimization is a more demanding exploration problem for RL agents.
A change in docking score is nonlinear with the molecule’s local structural changes, and a signiﬁcant variance exists among the structures of high-scoring molecules, meaning that there exists many local optima [9].
In addition, many previous RL models often suffer from generating unreal and inappropriate struc-tures. Docking score maximization alone is not sufﬁcient to qualify molecules as drug candidates, as the molecules should satisfy strong structural constraints such as chemical realisticness and pharma-cochemical suitability. In other words, small molecule drug candidates should have enough steric stability to arrive at the target organ in the intended form (chemical realisticness), and they should not include any seriously reactive or toxic substructure (pharmacochemical suitability). The low quality of generated molecules can arise from a single improper addition of atoms and bonds, which would deteriorate the entire sanity of the structure. Since such ‘mistakes’ are easy to occur, implicitly guiding the model (e.g., jointly training the model with QED optimization) cannot completely prevent the mistakes. Thus, explicitly restricting the generation space within realistic and qualiﬁed molecules by generating molecules as a combination of appropriate fragments can be a promising solution
[1, 11, 12].
However, such a strong constraint in generation space would make the optimization problem of docking score even harder and render a higher probability of over-ﬁtting to few solutions, urging a need for better exploration for RL agents. In this respect, we introduce a new framework, Fragment-based generative RL with an Explorative Experience replay for Drug design (FREED), which encourages effective exploration while only allowing the generation of qualiﬁed molecules.
Our model generates molecules by attaching a chemically realistic and pharmacochemically ac-ceptable fragment unit on a given state of molecules at each step4. We enforce the model to form a new bond only on the attachment sites that are considered as appropriate at the fragment library preparation step. These strategies enable us to utilize medicinal chemistry prior knowledge and successfully constrain the molecule generation within the chemical space eligible for drug design.
We also explore several explorative algorithms based on curiosity-driven learning and prioritized 4In this work, we widely deﬁne the term “chemically realistic molecule" as a stable molecule and narrowly deﬁne it as a molecule that is an assembly of fragments that appear in the ZINC data. Also, we widely deﬁne the term “inappropriate molecule/fragment" or “pharmacochemically inacceptable molecule/fragment" as a molecule that has nonspeciﬁc toxicity or reactivity, and narrowly deﬁne it as a molecule that cannot pass through the three medicinal chemistry ﬁlters, which are Glaxo, PAINS, SureChEMBL ﬁlters. 2
experience replay (PER) [13]. We devise an effective novel PER method that deﬁnes priority as the novelty of the experiences estimated by the predictive error or uncertainty of the auxiliary reward pre-dictor’s outcome. With this method, we aim to avoid the lack of robustness of previous methods and encourage the exploration of diverse solutions. We provide an overall illustration of our framework in
Figure 1.
Our main contributions can be summarized as follows:
• We propose a novel RL framework that can be readily utilized to design qualiﬁed molecules of high therapeutic potential.
• Our fragment-based generation method including connectivity-preserving fragmentation and augmentation allows our model to leverage Chemical prior knowledge.
• We propose novel explorative algorithms based on PER and show that they signiﬁcantly improve the model performance. 2