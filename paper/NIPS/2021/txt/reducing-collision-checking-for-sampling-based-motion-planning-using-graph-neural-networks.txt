Abstract
Sampling-based motion planning is a popular approach in robotics for ﬁnding paths in continuous conﬁguration spaces. Checking collision with obstacles is the major computational bottleneck in this process. We propose new learning-based methods for reducing collision checking to accelerate motion planning by training graph neural networks (GNNs) that perform path exploration and path smoothing.
Given random geometric graphs (RGGs) generated from batch sampling, the path exploration component iteratively predicts collision-free edges to prioritize their exploration. The path smoothing component then optimizes paths obtained from the exploration stage. The methods beneﬁt from the ability of GNNs of capturing geometric patterns from RGGs through batch sampling and generalize better to unseen environments. Experimental results show that the learned components can signiﬁcantly reduce collision checking and improve overall planning efﬁciency in challenging high-dimensional motion planning tasks. 1

Introduction
Sampling-based planning is a popular approach to high-dimensional continuous motion planning in robotics [36, 14, 31, 27, 19, 53, 35]. The idea is to iteratively sample conﬁgurations of the robots and construct one or multiple exploration trees to probe the free space, such that the start and goal states are eventually connected by some collision-free path through the sampled states, ideally with path cost minimized. This motion planning problem is hard, theoretically PSPACE-complete [48], and existing algorithms are challenged when planning motions of robots with a few degrees of freedom [34, 15, 1, 39, 9, 15]. In particular, the planning algorithms need to repeatedly check whether an edge connecting two sample states is feasible, i.e., that no state along the edge collides with any obstacle. This collision checking operation is the major computational bottleneck in the planning process and by itself NP-hard in general [28, 7]. For instance, consider the 7D Kuka arm planning problem in the environment shown in Figure 1. The leading sampling-based planning algorithm
BIT* [19] spends about 28.6 seconds to ﬁnd a complete motion plan for the robot, in which 20.2s (70.6% of time) is spent on collision checking. In comparison, it only takes 0.06s (0.2% of time) for sampling all the probing states needed for constructing random graphs for completing the search.
Learning-based approaches have become popular for accelerating motion planning. Many recent approaches learn patterns of the conﬁguration spaces to improve the sampling of the probing states, typically through reinforcement learning or imitation learning [29, 25, 65, 47, 8]. For instance, Ichter et al. [25] and motion planning networks [47] apply imitation learning on collected demonstrations to bias the sampling process. The NEXT algorithm [8] provides a state-of-the-art design for embedding high-dimensional continuous state spaces into low-dimensional representations, while balancing exploration and exploitation in the sampling process. It has demonstrated clear beneﬁts of using learning-based components to reduce samples and accelerate planning. However, we believe two 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
aspects in NEXT can be improved, if we shift the focus from reducing sample complexity to reducing collision checking. First, instead of taking the grid-based encoding of the entire workspace as input, we can use the graphs formed by batches of samples from the free space to better capture the geometric patterns of an environment. Second, having access to the entire graph formed by samples allows us to better prioritize edge exploration and collision checking based on relatively global patterns, and avoid getting stuck in local regions. In short, with reasonably relaxed budget of samples taken uniformly from the space, we can better exploit global patterns to reduce the more expensive collision checking operations instead. Figure 1 shows a typical example of how the trade-off beneﬁts overall planning, and more thorough comparisons are provided in the experimental results section.
We design two novel learning-based components that utilize Graph Neural Networks (GNNs) to accelerate the search for collision-free paths in batch sampling-based motion planning algorithms. The ﬁrst com-ponent is the GNN Path Explorer, which is trained to ﬁnd collision-free paths given the environment conﬁguration and a random geometric graph (RGG) formed by probing samples. The second component is the GNN Path Smoother, which learns to optimize the path obtained from the explorer. In both models, we rely on the expressiveness and permutation invari-ance of GNNs as well as attention mechanisms to identify geometric patterns in the RGGs formed by samples, and accelerate combinatorial search.
Figure 1: Performance on 7D Kuka arm. Left:
Trajectory generated by the proposed GNN-based approach. Right: NEXT getting stuck at a local region. Both methods were trained on the same training set.
The proposed learning-based components can accelerate batch sampling-based planning algorithms without compromising probabilistic completeness properties. The methods achieve higher success rate, much lower rate of collision checking, and accelerate the overall planning compared to state-of-the-art methods. We evaluate the proposed approach in a variety of planning environments from 2D mazes to 14D dual KUKA arms. Experiments show that our method signiﬁcantly reduces collision checking, improves the overall planning efﬁciency, and scales well to high-dimensional tasks.
The paper is organized as follows. We review related work and preliminaries in Section 2 and 3. We describe the detailed design of the GNN architectures in Section 4, followed by the training of GNN explorer and smoother in Section 5. We discuss experimental results in Section 6. 2