Abstract
We introduce weak barycenters of a family of probability distributions, based on the recently developed notion of optimal weak transport of mass [26], [9]. We provide a theoretical analysis of this object and discuss its interpretation in the light of convex ordering between probability measures. In particular, we show that, rather than averaging the input distributions in a geometric way (as the Wasser-stein barycenter based on classic optimal transport does) weak barycenters extract common geometric information shared by all the input distributions, encoded as a latent random variable that underlies all of them. We also provide an iterative algorithm to compute a weak barycenter for a ﬁnite family of input distributions, and a stochastic algorithm that computes them for arbitrary populations of laws.
The latter approach is particularly well suited for the streaming setting, i.e., when distributions are observed sequentially. The notion of weak barycenter and our approaches to compute it are illustrated on synthetic examples, validated on 2D real-world data and compared to standard Wasserstein barycenters. 1

Introduction
Optimal transport (OT) [41] has had a tremendous impact in the machine learning (ML) community recently, as it provides meaningful and implementable distances between probability distributions
[34], thus advancing many aspects in the ﬁeld, see e.g. [7, 43, 33]. The space of probability measures on Rd with ﬁnite second moment can be metrised with the Wasserstein-2 distance, the computation of which amounts to ﬁnding a transport plan that minimises the quadratic average cost of transporting mass from a source probability measure onto a target one. In this context, a natural method for averaging a ﬁnite family of probability measures is to compute their Fréchet mean, with respect to the Wasserstein-2 distance, which corresponds to the Wasserstein barycenter introduced in [1].
The goal of the present work is to explore theoretical features and potential applications to ML of barycenters of probability measures analogously deﬁned in terms of optimal weak transport (OWT, see [26]) or more precisely quadratic barycentric transport costs. In a nutshell, for a source measure µ and a target measure ν, the OWT problem aims to transport mass so that the conditional spatial mean of target support points y, given their source support points x, is close to x in average. This amounts to ﬁnding an intermediate measure η, possibly more concentrated than ν in the sense of convex ordering of probability measures, which is close to µ with respect to the Wasserstein-2 distance.
The main motivation of our work is to investigate the effect and meaning of combining a family of probability measures using OWT instead of OT. To that end, we will deﬁne the weak barycenter of 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
this family through an optimisation problem, and discuss some of its properties. Importantly, we will see that, rather than averaging the input distributions in a metric sense, solving a weak barycenter problem corresponds to ﬁnding probability measures that encode geometric or shape information shared across all of them. In fact, the weak barycenter problem will be interpreted as ﬁnding a latent random variable common to all the input distributions. Implications of this latent variable interpretation, in terms of robustness to outliers, will also be drawn in our work.
A second motivation for our work is to develop and implement computational methods for weak barycenters, capitalising on the fact that the optimal weak coupling between any pair of distributions, with ﬁnite second moments, is always realised by a unique optimal map. This property is in sharp contrast to standard OT, where the absolute continuity with respect to the Lebesgue measure of the source or target measure is typically needed to grant the existence and uniqueness of a map—the so-called Monge map— realising the optimal coupling between them. This map is often required in different ways to compute Wasserstein barycenters (see [5], [44] or [35]).
Similarly to the Wasserstein barycenter problem, we will develop a ﬁxed-point formulation of the weak barycenter problem, based on OWT plans. This allows us to, following [5, 44], construct an iterative procedure to compute a weak barycenter for a ﬁnite family of distributions and analyse its convergence properties. We will also deﬁne and study the so-called weak population barycenters, that deal with a population of probability measures distributed according to a given law Q supported on the Wasserstein-2 space, as in [30] for the OT case. Extending ideas from [10], we will then propose an iterative stochastic algorithm for online computation of the weak population barycenter, from a stream of probability measures sampled from Q. We will then provide numerical simulations using this proposed method, in order to illustrate the geometric meaning of the weak barycenter, and we will compare it with related objects obtained with standard OT or its entropy-regularised counterpart.
Organisation of the paper. Sec. 2 documents the background on OWT and the assumptions underlying our work. Sec. 3 analyses the weak barycenter problem, interprets it in the light of convex ordering and a latent variable model and addresses the case of an inﬁnite population of distributions.
Sec. 4 introduces two algorithms for computing the weak barycenter in the ﬁnite or population settings. Sec. 5 and 6 present the experimental setting and validation of our proposal respectively.
Lastly, Sec. 7 discusses our ﬁndings and future research questions. The Appendix contains all the proofs, additional details or our simulations and the code of our experiments. 2