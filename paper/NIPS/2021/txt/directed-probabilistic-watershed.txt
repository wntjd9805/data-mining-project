Abstract
The Probabilistic Watershed is a semi-supervised learning algorithm applied on undirected graphs. Given a set of labeled nodes (seeds), it deﬁnes a Gibbs prob-ability distribution over all possible spanning forests disconnecting the seeds. It calculates, for every node, the probability of sampling a forest connecting a certain seed with the considered node. We propose the "Directed Probabilistic Watershed", an extension of the Probabilistic Watershed algorithm to directed graphs. Building on the Probabilistic Watershed, we apply the Matrix Tree Theorem for directed graphs and deﬁne a Gibbs probability distribution over all incoming directed forests rooted at the seeds. Similar to the undirected case, this turns out to be equivalent to the Directed Random Walker. Furthermore, we show that in the limit case in which the Gibbs distribution has inﬁnitely low temperature, the labeling of the Directed
Probabilistic Watershed is equal to the one induced by the incoming directed forest of minimum cost. Finally, for illustration, we compare the empirical performance of the proposed method with other semi-supervised segmentation methods for directed graphs. 1

Introduction
In the last years, machine learning has experienced a great boost thanks to the large quantity of available data and increasing accessibility of less expensive and more powerful processing capacities.
However, the acquisition of labeled data is still laborious in some applications like computer-aided diagnosis or drug discovery. Semi-supervised learning is the subﬁeld of machine learning that utilizes both labeled and unlabeled data. It permits exploiting the large amount of unlabeled data available in many use cases jointly with frequently smaller sets of labeled data. When data is encoded as a network, graph-based semi-supervised learning aims to assign a label or class to each of the nodes of a network based on its topology and a given set of labeled nodes / seeds. Graph-based semi-supervised learning has been applied in multiple domains like computer vision [6, 15, 17], NLP [2, 28, 31], social networks [1, 45] and biomedical science[24]. Most graph-based semi-supervised learning algorithms focus on undirected weighted graphs [5, 36], though directed graphs appear naturally in many cases like in k-Nearest Neighbors graphs or citation and recommendation networks among others. Instances of methods proposed for directed graphs are [9, 11, 42, 48, 49].
Recently, [12] proposed the transductive graph-based semi-supervised learning algorithm Probabilistic
Watershed (ProbWS). It envisages a Gibbs distribution over the labeled nodes separating forests (forests whose trees contain a unique labeled node) that span a weighted undirected graph. The probability of each forest is proportional to its weight. By means of the Matrix Tree Theorem [19, 40], the ProbWS computes the probability of sampling a seed separating forest such that a query node is connected to a single labeled node / seed. This approach turns out to be equivalent computationally and by result to the Random Walker / Harmonic energy minimization [3, 15, 47, 50].
The Matrix Tree Theorem [19, 40] has been generalized to directed graphs [25]. We propose an extension of the ProbWS, the “Directed Probabilistic Watershed" (DProbWS), that can be applied 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
F
S m q s2 q s2 q s2 q s2 s1 s1 s1 s1 q s2 s1 0.65 1.00 1.00 0.37 0.45 0.63 0.00 0.24 0.63 1 0
Figure 1: The DProbWS computes the expected seed assignment of every node for a Gibbs distribution over all exponentially many spanning in-forests in closed-form. It thus avoids the winner-takes-all behaviour of the minimum cost spanning in-forest (mSF). (Top right) Two-seeded directed graph with edge costs represented by the widths of the arrows. (Bottom left) The mSF and other, higher cost in-forests. The mSF assigns the query node q to s1. Other in-forests of low cost might however induce different labelings. (Top left) We therefore consider a Gibbs distribution over all spanning in-forests with respect to their cost (see equation (6)). Each green bar corresponds to the cost of one of the 60 possible spanning in-forests. (Bottom right) DProbWS probabilities for assigning a node to s2. The dashed lines indicate the cut of the assignment. Query q is now assigned to s2.
Considering a distribution over all spanning in-forests gives an uncertainty measure and can yield a different assignment from the mSF’s. In contrast to the 60 forests in this toy graph, for real-life graphs the number of in-forests increases exponentially with the number of edges and nodes. to directed graphs. Instead of considering seed separating spanning forests, we deal with incoming directed forests rooted at the seed nodes (see Figure 1). We analyze the DProbWS from a theoretical point of view and generalize the results presented in [12] to directed graphs. Building on the arguments used in the original ProbWS paper, we
• analytically compute the probability that a graph node is assigned to a particular seed in an ensemble of Gibbs distributed incoming directed spanning forests rooted at the seeds,
• demonstrate the equivalence of the Directed Probabilistic Watershed and the directed version of the Random Walker presented in [15],
• propose a natural extension of the Power Watershed [6] to directed graphs,
• run an illustrative experiment to show the empirical performance of the Directed Probabilistic
Watershed and compare it with other semi-supervised transductive methods. 1.1