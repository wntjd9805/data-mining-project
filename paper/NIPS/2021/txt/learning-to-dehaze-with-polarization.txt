Abstract
Haze, a common kind of bad weather caused by atmospheric scattering, decreases the visibility of scenes and degenerates the performance of computer vision algo-rithms. Single-image dehazing methods have shown their effectiveness in a large variety of scenes, however, they are based on handcrafted priors or learned features, which do not generalize well to real-world images. Polarization information can be used to relieve its ill-posedness, however, real-world images are still challenging since existing polarization-based methods usually assume that the transmitted light is not signiﬁcantly polarized, and they require speciﬁc clues to estimate necessary physical parameters. In this paper, we propose a generalized physical formation model of hazy images and a robust polarization-based dehazing pipeline without the above assumption or requirement, along with a neural network tailored to the pipeline. Experimental results show that our approach achieves state-of-the-art performance on both synthetic data and real-world hazy images. 1

Introduction
When taking photos in hazy environments, the visibility and color ﬁdelity of recorded scenes are usually contaminated, because the captured images often contain a superposition of two unknown components: the transmitted light (an attenuated fraction of original scene radiance), and the airlight (ambient light scattered towards the viewer). It is highly ill-posed to separate them in a single hazy image as it requires estimating multiple unknowns from a single observation. Handcrafted priors from natural image statistics [21, 15, 1] have been wildly used to solve this problem. With the development of deep neural networks, learning-based methods (e.g., CNN-based [24, 65, 7, 82] and GAN-based
[79, 5]) have also been adopted to recover the haze-free images by extracting image features from a large amount of training data. However, these methods do not generalize well to real-world images, because they depend strongly on the image features extracted from training data and do not explicitly consider useful constraints from physical image formation models.
For better generalization, multi-image dehazing methods have been proposed. They capture multiple images from different viewpoints [38, 52, 84, 63], weather conditions [58, 55, 56, 57], or polarization angles [77, 78, 53, 81, 76, 25, 54]. Although all of these multi-image dehazing methods can relieve the ill-posedness, polarization-based ones have their unique advantages, since they directly utilize the physical image formation model with less dependency on image features extracted from training data. Nowadays, multiple polarized images can be conveniently captured in a single shot using a
∗Corresponding author. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
polarization camera such as Lucid Vision Phoenix polarization camera2. However, these polarization-based methods are not robust due to several issues: (1). They are largely based on a strong assumption that the transmitted light is not signiﬁcantly polarized, while it is not the case for real-world images since both transmitted light and airlight contribute to the polarization [13, 29]. (2). They usually require speciﬁc clues (e.g., sky regions [13, 77, 53], similar objects [54, 50], known depth [54]) to estimate the inﬁnite airlight and the degree of polarization (DoP), which signiﬁcantly reduces their applicability since these requirements are not always met. (3). They are optimization-based methods which do not make full use of semantic and contextual information in image features to handle the spatially-variant real-world scattering.
In this paper, to enable the polarization-based dehazing methods to handle images captured in the wild more robustly, we propose a generalized physical formation model of hazy images, without assuming that the transmitted light is not signiﬁcantly polarized, while considering the spatially-variant real-world scattering. Based on the physical model, we propose a robust polarization-based dehazing pipeline to extend their applicability by adopting deep learning to estimate the inﬁnite airlight and the DoP of both transmitted light and airlight without the requirement of speciﬁc clues like sky regions, similar objects, etc. According to our dehazing pipeline, we design a neural network to perform the dehazing process: It ﬁrst estimates the DoP of both transmitted light and airlight to solve the transmitted light, then predicts the inﬁnite airlight to reconstruct the original scene radiance.
Thanks to our learning-based pipeline, our method extracts image features from training data and use semantic and contextual information to reﬁne the results, which is suitable for handling the spatially-variant real-world scattering.
To summarize, this paper makes contributions by demonstrating: (1). A generalized physical formation model of hazy images, taking into account the polarization effects of both transmitted light and airlight, along with the spatially-variant real-world scattering. (2). A robust polarization-based dehazing pipeline without the requirement of speciﬁc clues, by adopting deep learning to estimate necessary physical parameters (inﬁnite airlight, DoP of both transmitted light and airlight). (3). A neural network making full use of semantic and contextual information to handle the spatially-variant real-world scattering to improve the clarity of original scene radiance recovery.
Experimental results show that our approach achieves state-of-the-art performance on both synthetic data and real-world hazy images. 2