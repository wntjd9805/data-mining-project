Abstract
Background. Floods are the most common natural disaster in the world, affecting the lives of hundreds of millions. Flood forecasting is therefore a vitally important endeavor, typically achieved using physical water ﬂow simulations, which rely on accurate terrain elevation maps. However, such simulations, based on solving partial differential equations, are computationally prohibitive on a large scale. This scalability issue is commonly alleviated using a coarse grid representation of the elevation map, though this representation may distort crucial terrain details, leading to signiﬁcant inaccuracies in the simulation.
Contributions. We train a deep neural network to perform physics-informed down-sampling of the terrain map: we optimize the coarse grid representation of the terrain maps, so that the ﬂood prediction will match the ﬁne grid solution. For the learning process to succeed, we conﬁgure a dataset speciﬁcally for this task. We demonstrate that with this method, it is possible to achieve a signiﬁcant reduction in computational cost, while maintaining an accurate solution. A reference imple-mentation accompanies the paper as well as documentation and code for dataset reproduction. 1

Introduction
A physical process is a time-evolving phenomenon marked by gradual transitions through a series of states, following physical rules. Scientists attempt to model these physical processes by employing analytical descriptions that correspond to the underlying physics of these processes. Commonly, the analytical descriptions, or physical models, such as conservation laws, are in the form of partial differential equations (PDEs). Physical models are the backbone behind modeling phenomena such as weather forecasts, ﬂood forecasting, aerodynamics, chemical processes, and more. Traditionally, these physical models are solved numerically, as no closed form solution is available for most problems. One typical numerical method is to discretize the PDEs using a Taylor expansion and repeatedly integrate in time over short intervals. However, solving PDEs numerically on a large scale is challenging because of the need to resolve spatiotemporal features over many scales.
In this paper, we focus on hydraulic models, which are a widely used physical models. The goal of these models is to simulate the ﬂow of water in a given environment. We are speciﬁcally interested in simulating water ﬂow through a ﬂoodplain in order to predict inundation, i.e., where and to what extent will ﬂooding occur. Speciﬁcally, in inundation modeling we are given an elevation map of the terrain, boundary conditions, initial conditions — and we wish to predict, the water height in each pixel at some future time t, with maximum accuracy and minimum computational cost. Such prediction is an important task in operational ﬂood alert systems [5, 43, 10]. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Unfortunately, inundation modeling is often computationally intractable when modeling ﬂow on a large scale with ﬁne grid resolution. A coarse grid representation of the elevation map can signiﬁcantly improve computation time, for two reasons. First, less computation is done at each step of the PDE solver. Speciﬁcally, in a discretized PDE the per-step spatial computation is done between neighboring pixels. Therefore, if we downsample a d-dimensional map by a factor of x, we decrease this per-step computation by a factor of xd. Second, the maximum stable time step in the numerical solution can be increased by a factor of x, as entailed by the Courant–Friedrichs–Lewy (CFL) condition [23, 7].
Taking both factors into account, we gain a total theoretical speedup of xd+1. For example, in this paper we will show that for the two-dimensional problem (d = 2) of inundation modeling, we retain fairly good accuracy when downsampling by a factor of 16, leading to a signiﬁcant 4096 speedup.
So far it was considered challenging to coarse-grain a general elevation map without losing accuracy in the inundation prediction. In particular, small details in the elevation map can signiﬁcantly impact the water ﬂow evolution. Narrow canals, dams, and embankments (barriers preventing a river from
ﬂooding an area) are examples of such details that require special care. There are several typical methods to represent an elevation map on a coarse grid, all of which can cause a sub-optimal representation, as small, important details might get lost [11, 44, 43]. For example, when applying standard downsampling methods, an 8 meter wide embankment might be reduced to half its original height above its neighboring surroundings in a 16 meters resolution coarse map. More complex downsampling techniques can be employed, but in practice, to achieve high-quality simulations at a coarse resolution, domain expertise is required, along with a deep understating of the underlying physics of the speciﬁc problem.
×
To address these limitations, we optimize the coarse grid representation of the elevation map so that its water height solution will match the accurate ﬁne grid solution. This is accomplished by combining a deep neural network (DNN) with the PDEs describing the ﬂow of water. The DNN downsamples the
ﬁne grid elevation map, and the downsampled elevation map is fed into the PDEs, where each time step is a recurrent unit, to calculate the water height solution. Thus, the DNN is optimized directly on the water height solution, through the PDEs. This also requires back-propagating through the PDEs, whose time-steps need to be unrolled. We demonstrate that this approach can yield a better coarse grid representation than conventional methods, in terms of water ﬂow estimation. To this end, we conﬁgured a dataset designed speciﬁcally for inundation modeling. Each sample consists of a ﬁne grid elevation map, boundary conditions, and a simulation time. The ground truth of each sample is the corresponding ﬂuid state, calculated on a ﬁne grid. This dataset is available along with code for further use.
The contributions of our work include:
• A new framework for learning how to coarse-grain a PDE together with its external environment — by minimizing the distance between the solutions on the ﬁne and coarse grids (Sec. 4.1).
• A novel conﬁgured dataset for 2D water ﬂow estimation, with accessible code for reproduction1. (Sec. 4.2)
• A demonstration that gradients backpropgated for tens of thousands of steps through the PDE remain informative (Sec. 5.1) and can pinpoint key features (Fig. 2)
• A demonstration of the accuracy of our approach in inundation modeling, for two different application settings (Sec. 5.2 and 5.3). Since we decrease the map resolution by a factor 16, this entails a 4096 speedup. Such a speedup has a signiﬁcant impact on the feasibility of real-time
ﬂood warning for large populations (Sec. 8).
× 2