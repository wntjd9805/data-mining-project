Abstract
The process of manually searching for relevant instances in, and extracting infor-mation from, clinical databases underpin a multitude of clinical tasks. Such tasks include disease diagnosis, clinical trial recruitment, and continuing medical educa-tion. This manual search-and-extract process, however, has been hampered by the growth of large-scale clinical databases and the increased prevalence of unlabelled instances. To address this challenge, we propose a supervised contrastive learning framework, CROCS, where representations of cardiac signals associated with a set of patient-speciﬁc attributes (e.g., disease class, sex, age) are attracted to learnable embeddings entitled clinical prototypes. We exploit such prototypes for both the clustering and retrieval of unlabelled cardiac signals based on multiple patient attributes. We show that CROCS outperforms the state-of-the-art method, DTC, when clustering and also retrieves relevant cardiac signals from a large database.
We also show that clinical prototypes adopt a semantically meaningful arrangement based on patient attributes and thus confer a high degree of interpretability. 1

Introduction
Clinical databases can comprise instances that are either unlabelled or labelled with patient attribute information, such as disease class, sex, and age. The process of manually searching for relevant instances in, and extracting information from, such databases underpin a multitude of tasks [1]. For example, clinicians extract a disease diagnosis from patient data, researchers involved in clinical trials search for and recruit patients satisfying speciﬁc inclusion criteria [2], and educators retrieve relevant information as part of the continuing medical education scheme [3]. This manual search-and-extract process, however, is hampered by the rapid growth of large-scale clinical databases and the increased prevalence of unlabelled instances; those for which patient attribute information is unavailable.
Given such a setting, in this paper, we are interested in addressing two questions: given a large, unlabelled clinical database, (1) how do we extract attribute information from such unlabelled instances? and (2) how do we reliably search for and retrieve relevant instances? To address the former, the task of clustering holds value. In this setting, a centroid groups together instances that share some similarities. Recent research has focused on exploiting existing clustering algorithms, such as k-means, to group similar patients from electronic heath record (EHR) data [4, 5]. Such methods, however, are exclusively unsupervised; they do not exploit patient attribute information.
To address the second question, the task of information retrieval holds promise. In this setting, a query associated with a set of desired attributes is exploited to retrieve a relevant instance. Recent research has focused predominantly on retrieving medical images [6], clinical text [7], and EHR data
[8], with minimal emphasis on medical time-series data [9]. These methods do not extend to cardiac 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
time-series data nor do they account for search based on multiple patient attributes. Most notably, previous work performs either clustering or retrieval, and not both.
In this work, we address both questions while exploiting large-scale electrocardiogram (ECG) databases comprising patient attribute information. Our contributions are the following: (1) we propose a supervised contrastive learning framework, CROCS, in which we attract representations of cardiac signals associated with a unique set of patient attributes to embeddings, entitled clinical prototypes. Such attribute-speciﬁc prototypes, which create “islands” of similar representations [10], allow for both the clustering and retrieval of cardiac signals based on multiple patient attributes. (2)
We show that CROCS outperforms the state-of-the-art method, DTC, in the clustering setting and retrieves relevant cardiac signals from a large database. At the same time, clinical prototypes adopt a semantically meaningful arrangement and thus confer a high degree of interpretability. 2