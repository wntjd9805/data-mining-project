Abstract
Effective control and prediction of dynamical systems require appropriate handling of continuous–time and discrete, event–triggered processes. Stochastic hybrid systems (SHSs), common across engineering domains, provide a formalism for dynamical systems subject to discrete, possibly stochastic, state jumps and multi– modal continuous–time ﬂows. Despite the versatility and importance of SHSs across applications, a general procedure for the explicit learning of both discrete events and multi–mode continuous dynamics remains an open problem. This work introduces Neural Hybrid Automata (NHAs), a recipe for learning SHS dynamics without a priori knowledge on the number of modes and inter-modal transition dynamics. NHAs provide a systematic inference method based on normalizing
ﬂows, neural differential equations and self–supervision. We showcase NHAs on several tasks, including mode recovery and ﬂow learning in systems with stochastic transitions, and end–to–end learning of hierarchical robot controllers. 1

Introduction
Behaviors emerging from the interaction of continuous and discrete–time dynamics in the presence of uncertainty are described through the language of stochastic hybrid systems (SHSs). Such discrete events can bring along abrupt changes in the state, and in complex multi–mode systems, may also cause a switch between system modes, and corresponding underlying continuous dynamics [1].
Communication networks [2], [3], where changes in communication protocol can happen at certain levels of trafﬁc congestion, and biological systems [4]–[6] are example domains where the SHS modeling paradigm has proven fruitful.
Data–driven identiﬁcation and learning of hybrid systems are known to be challenging due to the entanglement of continuous ﬂows and discrete events [7]; ﬁnding a generally applicable technique remains an open problem, particularly in the common scenarios where no a priori knowledge on the number and type of system modes is given. The aim of this work is to apply continuous neural models [8]–[10] to the learning SHSs. We introduce a compact descriptive language for this task, decomposing the system into a set of core primitives. Prior work is integrated into the framework, highlighting in the process limiting assumptions and areas of further improvement.
∗Equal contribution. Author order was decided by ﬂipping a coin. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
To address the shortcomings of existing techniques, we introduce Neural Hybrid Automata (NHA) as a general procedure designed to enable learning and simulation of SHSs from data. NHAs are comprised of three components: a dynamics module, taking the form of an neural differential equation (NDE) [8]–[10] capable of approximating a different vector ﬁeld for each mode, a discrete latent state tracking the internal mode of the target system, and an event module determining the time to next event. In particular, our approach does not require prior knowledge on the number of modes.
The synergy among NHA components ensures a broader range of applicability compared to previous attempts, which in example do not directly tackle multi–mode hybrid systems [11]–[14]. NHAs are shown to enable mode recovery and learning of systems with stochastic transitions, with additional applications in end–to–end learning of hierarchical robot controllers. 2