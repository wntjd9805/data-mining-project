Abstract
Learning binary representations of instances and classes is a classical problem with several high potential applications. In modern settings, the compression of high-dimensional neural representations to low-dimensional binary codes is a chal-lenging task and often require large bit-codes to be accurate. In this work, we propose a novel method for Learning Low-dimensional binary Codes (LLC) for instances as well as classes. Our method does not require any side-information, like annotated attributes or label meta-data, and learns extremely low-dimensional bi-nary codes (≈ 20 bits for ImageNet-1K). The learnt codes are super-efﬁcient while still ensuring nearly optimal classiﬁcation accuracy for ResNet50 on ImageNet-1K.
We demonstrate that the learnt codes capture intrinsically important features in the data, by discovering an intuitive taxonomy over classes. We further quantitatively measure the quality of our codes by applying it to the efﬁcient image retrieval as well as out-of-distribution (OOD) detection problems. For ImageNet-100 retrieval problem, our learnt binary codes outperform 16 bit HashNet using only 10 bits and also are as accurate as 10 dimensional real representations. Finally, our learnt bi-nary codes can perform OOD detection, out-of-the-box, as accurately as a baseline that needs ≈ 3000 samples to tune its threshold, while we require none. Code is open-sourced at https://github.com/RAIVNLab/LLC. 1

Introduction
Embedding data in low-dimensional binary space is a long-standing machine learning problem [56].
The problem has received a lot of interest in the computer vision (CV) domain, where the goal is to
ﬁnd binary codes that capture the key semantics of the image, like, objects present in the image or interpretable attributes. Section 2 covers the literature on learning binary codes and their applications.
In addition to learning semantically meaningful representations of the instances, low-dimensional binary codes allow efﬁciency in a variety of large-scale machine learning (ML) applications. Low-dimensional codes are crucial in extreme classiﬁcation with millions of classes [8, 30, 15] and also critical in efﬁcient large-scale retrieval settings [38, 16, 59].
Compressing information into binary codes is challenging due to its highly non-smooth nature while requiring the preservation of relevant information in an instance/class. This might explain the lack of good classiﬁcation accuracy for existing classiﬁcation-based embedding techniques [28, 13]. To address that, traditional methods often relied on side-information like attributes to construct class codes and then use that to learn the instance codes [18, 1]. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Learning binary embeddings can be posed in a variety of formulations like pairwise optimization [34] or unsupervised learning [11, 50], in this work we focus on learning binary codes using a given labeled multi-class dataset, e.g., ImageNet-1K. This allows us to couple the representation (code) learning of both instances and classes thus enabling us to capture the underlying semantic structure efﬁciently to assist in downstream tasks like classiﬁcation, retrieval etc.
We propose LLC, a method to learn both class and instance codes via the standard classiﬁcation task and its setup without any side-information. Our Learning Low-dimensional binary Codes (LLC) technique, formulates the embedding (code) learning problem as that of learning a low-dimensional binary embedding of a standard deep neural “backbone”. Instead of directly training for the low-dimensional binary instance codes, we propose a two-phase approach. In the ﬁrst phase, LLC learns low-dimensional (k-bit) binary codes for classes that capture semantic information through a surrogate classiﬁcation task. Then in the second phase, LLC uses these learnt class codes as an efﬁcient alternative to learning instance codes in sub-linear cost (in the number of classes, L) using the Error-Correcting Output Codes (ECOC) approach [19]. This two-phase pipeline helps in the effective distillation of required semantic similarity between instances through the learnt class codes.
For example, on ImageNet-1K with ResNet50, LLC is able to learn tight 20-bit codes that can be used for efﬁcient classiﬁcation and achieve 74.5% accuracy compared to the standard baseline 77% on ImageNet-1K (Section 4.1). Furthermore, we observe that the learnt 20-bit class codes capture intuitive taxonomy over classes (Figure 1) while the instance codes retain the distilled class similarity information useful in efﬁcient retrieval and OOD detection.
Retrieval. To further study, the effectiveness of our learnt binary codes, we apply them to hashing-based efﬁcient retrieval, where the goal is to retrieve a large number of similar instances with the same class label in top retrieved samples. Deep supervised hashing is a widely studied problem with several recent results [9, 53] which are designed speciﬁcally for the learnt hashing-based retrieval.
Interestingly, our learnt instance codes through the LLC routine provide strikingly better performance while not being learnt explicitly for hashing. For eg., using AlexNet, with just 32-bit codes we are can provide 5.4% more accurate retrieval than HashNet’s 64-bit codes on ImageNet-100 (Section 4.2).
OOD Detection. We similarly apply LLC based learnt binary codes to detect OOD instances [26].
We adopt a simple approach based on our binary codes: if an instance is not within a Hamming distance of 1 to any class codes, we classify it as OOD. That is, we do not ﬁne-tune our OOD detector for the new domain, which is critical in practical settings. In contrast, baseline techniques for OOD detection require a few samples (eg., ≈ 3000 for ImageNet-750) from the OOD domain to ﬁne-tune thresholds, while we require no samples yet reaching similar OOD detection (Section 4.3).
In this work, we make the following key contributions:
• LLC method to learn semantically-rich low-dimensional binary codes for both classes & instances.
• Show that the learnt codes enable accurate & efﬁcient classiﬁcation: ImageNet-1K with 20-bits.
• Apply LLC to image retrieval task, and demonstrate that it comfortably outperforms the instance code learning methods for hashing-based retrieval on ImageNet-100.
• Finally, use codes from LLC for strong & sample efﬁcient OOD detection in practical settings. 2