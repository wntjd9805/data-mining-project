Abstract
Switching dynamical systems provide a powerful, interpretable modeling frame-work for inference in time-series data in, e.g., the natural sciences or engineering applications. Since many areas, such as biology or discrete-event systems, are naturally described in continuous time, we present a model based on a Markov jump process modulating a subordinated diffusion process. We provide the exact evolution equations for the prior and posterior marginal densities, the direct solu-tions of which are however computationally intractable. Therefore, we develop a new continuous-time variational inference algorithm, combining a Gaussian process approximation on the diffusion level with posterior inference for Markov jump processes. By minimizing the path-wise Kullback-Leibler divergence we obtain (i) Bayesian latent state estimates for arbitrary points on the real axis and (ii) point estimates of unknown system parameters, utilizing variational expectation maximization. We extensively evaluate our algorithm under the model assumption and for real-world examples. 1

Introduction
Many natural and engineered dynamical systems can be understood in terms of continuous-discrete hybrid models, in which a given system switches between discrete modes exhibiting continuous dynamics. Examples include neuro-mechanical models of locomotion [1], transition dynamics between different brain states [2, 3] and brain-state dependent decision-making in neuroscience [4]; regime-switching volatility dynamics [5] and risk assessment [6, 7] in ﬁnancial analysis or electric power systems [8]; and phenotype differentiation in systems biology [9].
In a discrete-time setting, a widely used class of stochastic hybrid models are switching linear dynamical system (SLDS) [10], which have received considerable attention in recent years [11, 12, 13, 14, 15]. Since real-world physical and biological systems naturally evolve in continuous time, a discrete-time description of such systems is however limiting. In biological experiments and discrete-event systems in engineering [16], for instance, one typically (i) is interested in the system behavior at any given point in time and (ii) can not easily determine an appropriate time discretization. To overcome these limitations, a continuous-time analog to SLDS models has been put forward termed switching stochastic differential equations (SSDEs) [17], which augment a set of diffusion processes with an underlying Markov jump process (MJP). Hybrid models of this kind have a long tradition in statistics [18] and have been analyzed in particular in applications to biological systems [19].
Diffusion processes and MJPs have been treated extensively in the literature [20, 21]. For each process class individually, exact expressions for the posterior paths given some set of observations can be obtained [22]. However, for diffusion processes in particular, these expressions quickly become intractable as they entail solving multi-dimensional partial differential equations (PDEs). This is 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: Sketch of the three layers of the hybrid process model. A two-state MJP Z(t) (blue) evolves freely in the time interval t ∈ [0, T ], see Eq. (1) . The MJP controls the dynamics of the
SSDE Y (t) | Z(t) (green), see Eq. (2). From these continuous dynamics, only noisy observations
X1, X2, . . . (red) are available for inference at irregularly-spaced time points t1, t2, . . . . Left:
Graphical model. Right: Sample path (vertical dashed lines indicate the Z-transitions). aggravated if the diffusion is coupled to an underlying jump process, because both processes then have to be solved jointly.
One way to circumvent this issue are Monte Carlo approaches, which have been devised for both dif-fusion [23] and jump processes [24]. Sampling methods may however suffer from slow convergence, and, as we shall show, still face computational intractabilities for hybrid systems. An established approach avoiding these problems are variational inference (VI) methods, which approximate the exact posteriors by optimization [25]. For inference and parameter learning in diffusion processes, continuous-time VI frameworks have been developed utilizing, e.g., Gaussian processes (GPs) [26, 27], and general exponential family distributions [28]. Similar methods have also been devised for inference in MJPs [29, 30]. To the best of our knowledge, an inference framework for continuous-time hybrid processes is however lacking. We draw on these previous works and present a generalized VI framework for hybrid systems which recovers existing diffusion and MJP approximations as special cases. We speciﬁcally focus on meta-stable systems which remain in distinct, qualitatively different regimes over extended periods of time, which are of special interest, e.g., in computational structural biology [31]. An implementation of our proposed method is publicly available.1 2 Mathematical