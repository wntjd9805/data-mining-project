Abstract
Spatial networks are networks for which the nodes and edges are constrained by geometry and embedded in real space, which has crucial effects on their topolog-ical properties. Although tremendous success has been achieved in spatial and network representation separately in recent years, there exist very little works on the representation of spatial networks. Extracting powerful representations from spatial networks requires the development of appropriate tools to uncover the pairing of both spatial and network information in the appearance of node permutation invariant, and rotation and translation invariant. Hence it can not be modeled merely with either spatial or network models individually. To ad-dress these challenges, this paper proposes a generic framework for spatial net-work representation learning. Speciﬁcally, a provably information-lossless and rotation-translation invariant representation of spatial information on networks is presented. Then a higher-order spatial network convolution operation that adapts to our proposed representation is introduced. To ensure efﬁciency, we also propose a new approach that relied on sampling random spanning trees to reduce the time and space complexity from O(N 3) to O(N ). We demonstrate the strength of our proposed framework through extensive experiments on both synthetic and real-world datasets. The code for the proposed model is available at https://github.com/rollingstonezz/SGMP_code. 1

Introduction
Spatial data and network data are both popular types of data in modern big data era. The study of spatial data focuses on the properties of continuous spatial entities under speciﬁc geometry, while analysis of network data investigates the properties of discrete objects and their pairwise relationship.
Spanning these two data types, spatial networks is a crucial type of data structure that nodes occupy po-sitions in a Euclidean space, where spatial patterns and constraints may have a strong effect on their connectivity patterns [6]. Understanding the mecha-nism of organizing spatial networks has signiﬁcant importance for a broad range of ﬁelds [29], ranging from micro-scale (e.g., molecule structure [94]), to middle-scale (e.g., biological neural network [31]), to macro-scale (e.g., mobility networks [18]). Ef-fectively learning the representations of spatial net-works is extremely challenging due to the close interactions between network and spatial topology, the incompatibility between the treatments for dis-crete and continuous data, and particular properties
Figure 1: Spatial network contains not only the infor-mation of network topology and spatial topology but also their interaction. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
such as permutation invariant and rotation-translation invariant. Spatial networks have long been researched in the domains such as physics and mathematics, which usually extend complex networks and graph theory into spatial networks [80, 7]. They typically rely on network generation principles predeﬁned by human heuristics and prior knowledge. Such methods usually characterize well on the aspects of the data that have been covered by the predeﬁned principles, but not on those have not been covered[6]. However, the underlying network process in complex networks is largely unknown and extremely difﬁcult to be predeﬁned in simple rules, especially in crucial and open domains such as brain network modeling [81], network catastrophic failure [72], and protein folding [27].
Remarkable progress has been made towards generalizing deep representation learning approaches in spatial data and network data [96, 13, 46, 43, 28], respectively, in recent years. For spatial data, deep learning achieved signiﬁcant progress in different commonly used formats such as images [53, 75, 61, 21], point clouds [34, 71, 57], meshes [85, 90], and volumetric grids [95, 66]. On the other hand, deep learning has also boosted the research of encoding graph structure on network data [46, 51, 45], and downstream applications such as recommender systems [99, 60], drug discovery [39, 22, 41, 42],
FinTech [91], customer care [93], and natural language processing [62, 8, 92].
Despite the respective progress in representation learning on spatial data and network data in par-allel, the representation learning for spatial networks have been largely underexplored and has just started to attract fast-increasing attention. Merely combining spatial and graph representa-tions separately cannot handle that for spatial networks where spatial and network process are deeply coupled together [6, 68, 33]. For example, Fig. 2 shows a simple example with a pair of spatial networks, in which there are different formation rules on the edges relied on the spa-tial distance, that is non-distinguishable for spatial and network embedding methods, respectively.
Few recent attempts have been proposed to handle representation learning on spatial net-works but still suffer from key challenges:
Spatial network representation learning is a problem extremely difﬁcult to address due to several unique challenges: 1) Difﬁcult in distinguishing the patterns that require joint spatial and graph consideration. Examples like Figure. 2 that share the same spatial and network topology, respectively, but with sig-niﬁcantly different interaction mechanisms, are non-distinguishable to either spatial or graph methods. 2) Difﬁcult in jointly maintaining that the learned representation is invariant to node permutation, and rotation and translation transformations. Notice that spatial and graph information conﬁne each other which neutralizes conventional methods to have either of them. For example, although point clouds representation learning can easily preserve rotation- and translation-invariant by using spatial nearest neighbors, here in spatial networks the neighbor is conﬁned also by graph neighbors. Such additional conﬁnement largely harden our task. 3) High efﬁciency and scalability in the graph size. The conﬁnement between spatial and graph information inevitably leads to taking into account more entities simultaneously to maintain sufﬁcient information. The requirement to handle incremental information increases the demand for model efﬁciency and scalability.
Figure 2: The left ﬁgure reﬂects closer nodes tend to connect with each other (known as the ﬁrst law of geography [79]), while the right ﬁgure reﬂects a spatial tele-connecting pat-tern where faraway nodes tend to connect. Discriminating these two spatial networks requires new method that can jointly consider spatial and network properties.
In order to address all the aforementioned challenges, this paper proposes a new spatial graph message passing neural network (SGMP) for learning the representations of generic spatial networks, with theoretical guarantees on discriminative power and various spatial and network properties, and an accelerating algorithm which adjusts to our theoretical framework. Speciﬁcally, to capture and model the intrinsic coupled spatial and graph properties, we propose a novel message passing neural network to organically aggregate the spatial and graph information. To ensure the invariance of learned representation under rotation and translation transformations, a novel way to represent the node spatial information by characterizing geometric invariant features with lossless information is proposed. To alleviate the efﬁciency issue, we propose a new accelerating algorithm for learning on graph-structured data. The proposed accelerating algorithm effectively reduces the time and memory complexity from O(N 3) to O(N ), and maintains the theoretical guarantees for spatial networks.
Finally, we demonstrate the strength of our theoretical ﬁndings through extensive experiments on both synthetic datasets and real-world datasets. 2
2