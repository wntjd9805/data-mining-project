Abstract
Many applications involve multi-type event data. Understanding the complex inﬂuences of the events on each other is critical to discover useful knowledge and to predict future events and their types. Existing methods either ignore or partially account for these inﬂuences. Recent works use recurrent neural networks to model the event rate. While being highly expressive, they couple all the tem-poral dependencies in a black-box and can hardly extract meaningful knowledge.
More important, most methods assume an exponential time decay of the inﬂuence strength, which is over-simpliﬁed and can miss many important strength varying patterns. To overcome these limitations, we propose SPRITE, a Self-adaptable
Point pRocess wIth nonparametric Time dEcays, which can decouple the inﬂuences between every pair of the events and capture various time decays of the inﬂuence strengths. Speciﬁcally, we use an embedding to represent each event type and model the event inﬂuence as an unknown function of the embeddings and time span. We derive a general construction that can cover all possible time-decaying functions. By placing Gaussian process (GP) priors over the latent functions and using Gauss-Legendre quadrature to obtain the integral in the construction, we can ﬂexibly estimate all kinds of time-decaying inﬂuences, without restricting to any speciﬁc form or imposing derivative constraints that bring learning difﬁculties.
We then use weight space augmentation of GPs to develop an efﬁcient stochastic variational learning algorithm. We show the advantages of our approach in both the ablation study and real-world applications. 1

Introduction
Events of multiple types are ubiquitous, such as in online shopping, social networking and biological signal transduction. Understanding the complex inﬂuences of those events on each other, including excitation, inhibition, and how the strength of these inﬂuences varies with time, is crucial to discover useful knowledge and to predict future events and their types, which can beneﬁt many applications, e.g., marketing analysis, biological study, and early warnings of catastrophes.
While many excellent works have been proposed for event modeling and analysis (Blundell et al., 2012; Linderman and Adams, 2014; Xu et al., 2016; Tan et al., 2016; Xu and Zha, 2017; Zhang et al., 2020a), most of them are inadequate to capture complex inﬂuences between the events. The classical
Poisson processes simply ignore these inﬂuences and assume independent increments. Although
Hawkes processes (HP) can estimate the mutual excitation between the events, they ignore the inhibition effect, which is common in real world. More important, existing methods (Xu et al., 2016;
Zhang et al., 2020a), even for those considering both the excitation and inhibition, mostly assume an exponential time decay of the inﬂuence strength, which is over-simpliﬁed and can miss many other decay patterns. While recent works have also used recurrent neural networks (RNNs) (Du et al., 2016; Mei and Eisner, 2017) to model the event rate and hence are highly expressive, they couple 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
all the temporal dependencies in a black box, and are difﬁcult to distill meaningful and important knowledge, e.g., inﬂuence types and strengths.
To address these limitations, we propose SPRITE, a multi-variate self-adaptable point process with nonparametric time decays. Our method not only can discover the type of the inﬂuence (i.e., excitation or inhibition) between every pair of the events, but also is ﬂexible enough to estimate all kinds of inﬂuence strength decaying patterns, not limited to the exponential decay or other particular forms. Speciﬁcally, we ﬁrst introduce an embedding to represent each event type, and model the inﬂuence between any two events as an unknown function of the event type embeddings and time span. In so doing, we avoid separately estimating the inﬂuence between every pair of the events, and largely reduce the parameters. Next, we propose a general construction that covers all possible time decaying functions. We assign Gaussian process (GP) priors over the free latent functions and use
Gauss-Legendra quadrature to calculate the integral in the construction. In this way, we can ﬂexibly estimate a variety of time decaying inﬂuences while not needing to impose any derivative constraint, which can bring learning difﬁculties. For efﬁcient inference, we use weight-space augmentation of
GPs to prevent computing huge covariances matrices, and neural network feature mapping to enhance the learning capacity. We then use the re-reparameterization trick to develop a scalable stochastic variational learning algorithm.
For evaluation, we ﬁrst examined SPRITE in an ablation study. We tested the case of a single event type with excitation effects only and three time decays, and a bi-type event case with mixed excitation and inhibition effects. In both cases, our method accurately recovered the rate function of each type of events and the inﬂuence between the events, performing better than state-of-the-art methods based on or extending Hawkes processes and RNNs. Next, we examined SPRITE in three real-world and one synthetic benchmark datasets. We examined the accuracy in predicting the occurrence time and type of future events. In both tasks, our method nearly always outperforms the competing approaches, often by a large margin. Finally, by looking into the embeddings and inﬂuence functions learned by our model, we found interesting patterns within the event types and their interactions. 2