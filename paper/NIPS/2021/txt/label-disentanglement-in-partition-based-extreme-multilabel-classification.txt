Abstract
Partition-based methods are increasingly-used in extreme multi-label classiﬁcation (XMC) problems due to their scalability to large output spaces (e.g., millions or more). However, existing methods partition the large label space into mutually exclusive clusters, which is sub-optimal when labels have multi-modality and rich semantics. For instance, the label “Apple” can be the fruit or the brand name, which leads to the following research question: can we disentangle these multi-modal labels with non-exclusive clustering tailored for downstream XMC tasks? In this paper, we show that the label assignment problem in partition-based XMC can be formulated as an optimization problem, with the objective of maximizing precision rates. This leads to an efﬁcient algorithm to form ﬂexible and overlapped label clusters, and a method that can alternatively optimizes the cluster assignments and the model parameters for partition-based XMC. Experimental results on synthetic and real datasets show that our method can successfully disentangle multi-modal labels, leading to state-of-the-art (SOTA) results on four XMC benchmarks. 1

Introduction
The eXtreme Multi-label Classiﬁcation (XMC) task is to ﬁnd relevant labels from an enormous output space of candidate labels, where the size is in the order of millions or more ([1, 2, 3, 4, 5]; etc.)
This problem is of interest in both academia and industry: for instance, tagging a web page given its contents from tens of thousands of categories [6]; ﬁnding a few products that a customer will purchase from among an enormous catalog on online retail stores [7]; or recommending proﬁtable keywords given an item/product from millions of advertisement keywords [8].
The XMC problem is challenging not only because of the data scalability (e.g., the number of instances, features, and labels are of the scale of millions or more), but also due to the label sparsity issue where there is little training signal for long-tailed labels. To tackle these issues, most prevailing
XMC algorithms use a partition-based approach. Instead of ranking the entire set of millions of labels, they partition the label space into smaller mutually-exclusive clusters. Each instance is only mapped to one or a few label clusters based on a matching model, and then ranking is only conducted within the smaller subset of labels. Some exemplars are Parabel [8], eXtremeText [9], AttentionXML [10],
XR-Linear [11] and X-Transformer [12].
∗Work done while Xuanqing was interning at Amazon Inc. Code will be released at https://github.com/ amzn/pecos. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Partitioning labels into mutually-exclusive clusters may not be ideal. When labels are semantically complex and multi-modal, it is more natural to assign a label to multiple semantic clusters. In product categorization, for instance, the tag “belt” can be related to a vehicle belt (under “vehicle accessories” category), or a man’s belt (under “clothing” category). Assigning “belt” to just one of the clusters but not the other is likely to cause a mismatch for certain queries. To solve this problem, we reformulate the label clustering step as an assignment problem, where each label can be assigned to multiple clusters to allow disentanglement of mixed semantics. Further, we formulate learning optimal assignments by maximizing the precision as an optimization problem, and propose efﬁcient solvers that automatically learn a good label assignment based on the current matching models. With this formulation, we apply our algorithm to alternatively reﬁne label assignments and matching model in existing partition-based XMC methods to boost their performance. Similar idea can be found in
[13, 14], however, our tree structures are constructed in one pass with hierarchical k-means. Our contributions can be summarized below:
• We propose a novel way to obtain label assignments that disentangle multi-modal labels to multiple clusters.
• Unlike previous methods that partition the label set before training, we propose an optimization-based framework that allows optimizing label assignment with the matching and ranking modules inside a partition-based XMC solver. Our method is plug-and-play; it is orthogonal to the models so most of the partition-based methods can beneﬁt from our method.
• Our proposed solution yields consistent improvements over two leading partition-based methods,
XR-Linear [11] and X-Transformer [12]. Notably, with the concatenation of tﬁdf features and
X-Transformer embeddings, we achieve new SOTA results on four XMC benchmark datasets. 2