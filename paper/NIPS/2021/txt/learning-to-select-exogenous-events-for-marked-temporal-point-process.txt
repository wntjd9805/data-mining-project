Abstract
Marked temporal point processes (MTPPs) have emerged as a powerful modeling tool for a wide variety of applications which are characterized using discrete events localized in continuous time. In this context, the events are of two types— endogenous events which occur due to the inﬂuence of the previous events and exogenous events which occur due to the effect of the externalities. However, in practice, the events do not come with endogenous or exogenous labels. To this end, our goal in this paper is to identify the set of exogenous events from a set of unlabeled events. To do so, we ﬁrst formulate the parameter estimation problem in conjunction with exogenous event set selection problem and show that this problem is NP hard. Next, we prove that the underlying objective is a monotone and α-submodular set function, with respect to the candidate set of exogenous events. Such a characterization subsequently allows us to use a stochastic greedy algorithm which was originally proposed in [64] for submodular maximization.
However, we show that it also admits an approximation guarantee for maximizing
α-submodular set function, even when the learning algorithm provides an imperfect estimates of the trained parameters. Finally, our experiments with synthetic and real data show that our method performs better than the existing approaches built upon superposition of endogenous and exogenous MTPPs.

Introduction 1
In recent years, marked temporal point processes (MTPPs) have shown tremendous potential in modeling the arrival process of the asynchronous events in continuous time [65, 46, 66, 16, 22, 17, 52, 82, 33, 13, 60, 83, 74, 49, 77, 27, 53, 47]. They are extensively used in a wide variety of applications, e.g., information diffusion in social networks [66, 77, 16, 43, 12, 85, 76], improving human learning [76, 74], location modeling [83], epidemic forecasting [49, 66], etc. At the outset, an
MTPP event consists of two elements— its arrival time and the mark, where the latter encodes the category of the event, e.g., the topic of a blog post, the sentiment associated with a tweet, disease of an individual, etc.
In the context of learning an MTPP, we observe two types of events— endogenous events which occur due to inﬂuence of the previously observed events and, exogenous events which are driven by the external sources or unobserved events, rather than being inﬂuenced by the previously observed events. For example, a post in social media may be inﬂuenced by some external news source, rather than the previous messages [26, 60, 13]; in epidemic process, an infection may be triggered by community transmission where the source is other than any previously known infections [50], etc. In such applications, the observed events appear unlabeled, i.e., they are not tagged with their sources of inﬂuence. Consequently, the existing MTPP models [21, 12, 84, 78, 66] resort to the superposition of exogenous and endogenous MTPPs. However, such approaches view an event being exogenous or endogenous with equal likelihood and therefore, they do not focus on identifying which events are more likely to be exogenous than others. Consequently, they often remain oblivious to the presence of the exogenous events, which often preclude these models from realizing their full potential. While 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
De et al. [13] tackle this problem in the particular context of opinion dynamics in social networks, their formulation focus only on the mark dynamics and, skirt the effect of exogenous events on the arrival times. As a result, their framework can not be extended to a generic MTPP model, where the arrival time is often a key component. 1.1 Our contributions
In order to respond to the above limitations, we make the following contributions.
Learning in conjunction with selection of exogenous events. We design TPP-SELECT, a novel event selection algorithm which, for any given MTPP model, simultaneously ﬁlters the exogenous events from a stream of unlabeled events as well as train the model parameters over the remaining (endogenous) events (Section 3). More speciﬁcally, we seek to maximize the likelihood of all the events, jointly with respect to the set of exogenous events and the parameters of the associated
MTPP model. Such a formulation induces a parameter estimation problem in conjunction with the combinatorial optimization problem for selecting the exogenous events.
Characterization of the objective. Subsequently, we show that our problem is NP-hard due to the involvement of the candidate exogenous events as an optimization variable. We tackle this problem using several technical innovations. First, we reformulate it as an instance of a set function maximization problem, where the objective corresponds to the value of the maximum likelihood, as a function of the candidate set of exogenous events. Then, based on this representation, we show that this objective satisﬁes monotonicity and α-submodularity— a notion of approximate submodularity [25, 44, 29] for linear MTPP and a wide variety of nonlinear MTPPs (Section 4).
These results reveal an unexplored connection between approximate submodularity and temporal point process, that is of independent interest.
Approximation guarantee for greedy method in the face of imperfect training. Next, we show that these properties allow us to use an existing stochastic greedy algorithm [64]. While this algorithm is known to admit an approximation guarantee for submodular maximization, we show that it also enjoys an approximation guarantee for maximizing α-submodular functions. Moreover, we show that this algorithm also admits an approximation guarantee even when the training algorithm provides an imperfect estimation of the MTPP parameters.
Finally, we perform a comprehensive evaluation of our proposal on both synthetic and real data.
Our experiments with synthetically generated sequences show that TPP-SELECT can accurately select the exogenous events from a stream of unlabeled events, even though it is completely unsu-pervised. Our experiments on real datasets show that, despite training on a subset (endogenous) of events, TPP-SELECT outperforms several baselines as well as the corresponding model which is trained on the entire dataset in the presence of exogenous events. Our code is available in https://github.com/noilreed/TPP-Select. 2