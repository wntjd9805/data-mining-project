Abstract
The latent space of a Generative Adversarial Network (GAN) has been shown to encode rich semantics within some subspaces. To identify these subspaces, researchers typically analyze the statistical information from a collection of synthesized data, and the identiﬁed subspaces tend to control image attributes globally (i.e., manipulating an attribute causes the change of an entire image).
By contrast, this work introduces low-rank subspaces that enable more precise control of GAN generation. Concretely, given an arbitrary image and a region of interest (e.g., eyes of face images), we manage to relate the latent space to the image region with the Jacobian matrix and then use low-rank factorization to discover steerable latent subspaces. There are three distinguishable strengths of our approach that can be aptly called LowRankGAN. First, compared to analytic algorithms in prior work, our low-rank factorization of Jacobians is able to ﬁnd the low-dimensional representation of attribute manifold, making image editing more precise and controllable. Second, low-rank factorization naturally yields a null space of attributes such that moving the latent code within it only affects the outer region of interest. Therefore, local image editing can be simply achieved by projecting an attribute vector into the null space without relying on a spatial mask as existing methods do. Third, our method can robustly work with a local region from one image for analysis yet well generalize to other images, making it much easy to use in practice. Extensive experiments on state-of-the-art GAN models (including StyleGAN2 and BigGAN) trained on various datasets demonstrate the effectiveness of our LowRankGAN1. 1

Introduction
Generative Adversarial Networks (GANs), which can produce high-ﬁdelity images visually indistinguishable from real ones [18, 19, 4], have made tremendous progress in many real-world applications [16, 39, 32, 10, 38, 27, 7, 34]. Some recent studies [12, 26, 17] show that pre-trained
GAN models spontaneously learn rich knowledge in latent spaces such that moving latent codes towards some certain directions can cause corresponding attribute change in images. In this way, we are able to control the generation process by identifying semantically meaningful latent subspaces.
For latent semantic discovery, one of the most straightforward ways is to ﬁrst generate a collection of image synthesis, then label these images regarding a target attribute, and ﬁnally ﬁnd the latent separation boundary through supervised training [12, 26, 17]. Prior work [30, 25, 14] has pointed out that the above pipeline could be limited by the labeling step (e.g., unable to identify semantics
∗ denotes the corresponding author. 1Code is available at https://github.com/zhujiapeng/LowRankGAN/. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
beyond well-deﬁned annotations) and proposed to ﬁnd steerable directions of the latent space in an unsupervised manner, such as using Principal Component Analysis (PCA) [14]. However, existing approaches prefer to discover global semantics, which alter the entire image as a whole and fail to relate a latent subspace to some particular image region. Consequently, they highly rely on spatial masks [29, 8, 2] to locally control the GAN generation, which is of more practical usage.
In this work, we bridge this gap by introducing a low-rank subspace of GAN latent space. Our approach, called LowRankGAN, starts with an arbitrary synthesis together with a region of interest, such as the eyes and nose in a face image or the ground in a scene image. Then, we manage to relate the latent space and the image region via computing the Jacobian matrix with the pre-trained generator.
After that comes the core part of our algorithm, which is to perform low-rank factorization based on the resulting Jacobian matrix. Different from other analytic methods, the low-rank factorization of
Jacobians is capable of uncovering the intrinsic low-dimensional representation of attribute manifold, thus helping solve more precise editing direction to the target attribute. Besides, the low-rank factorization naturally yields a null space of attributes such that moving the latent code within this subspace mainly affects the remaining image region. With such an appealing property, we can achieve local image control by projecting an attribute vector into the null space and using the projected result to modulate the latent code. This observation is far beyond trivial because the latent code is commonly regarded to act on the entire feature map of GAN generator [13, 4, 18]. We also ﬁnd that the low-rank subspace derived from local regions of one image is widely applicable to other images. In other words, our approach requires only one sample instead of abundant data for analysis. More astonishingly, supposing that we identify a changing-color boundary on one car image, we can use this boundary to change the color of cars from other images, even the cars locate at a different spatial area or with different shapes. This suggests that the GAN latent space is locally semantic-aware. Moreover,
LowRankGAN is strongly robust to the starting image region for Jacobian matrix computation. For instance, to control the sky in synthesized images, our algorithm does not necessarily rely on a rigid sky segmentation mask but can also satisfyingly work with a casual bounding box that marks the sky region (partially or completely), making it much easy to use in practice.
Our main contributions are summarized as follows. First, we study low-rank subspaces of the GAN latent space and manage to locally control the GAN image generation by simply modulating the latent code without the need for spatial masks. Second, our method can discover latent directions regarding local regions of only one image yet generalize to all images, shedding light on the intrinsic semantic-aware structure of GAN latent space. Third, we conduct comprehensive experiments to demonstrate the effectiveness and robustness of our algorithm on a wide range of models and datasets. 2