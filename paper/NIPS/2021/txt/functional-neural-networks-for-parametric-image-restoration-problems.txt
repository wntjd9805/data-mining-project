Abstract
Almost every single image restoration problem has a closely related parameter, such as the scale factor in super-resolution, the noise level in image denoising, and the quality factor in JPEG deblocking. Although recent studies on image restoration problems have achieved great success due to the development of deep neural networks, they handle the parameter involved in an unsophisticated way.
Most previous researchers either treat problems with different parameter levels as independent tasks, and train a speciﬁc model for each parameter level; or simply ignore the parameter, and train a single model for all parameter levels. The two popular approaches have their own shortcomings. The former is inefﬁcient in computing and the latter is ineffective in performance. In this work, we propose a novel system called functional neural network (FuncNet) to solve a parametric image restoration problem with a single model. Unlike a plain neural network, the smallest conceptual element of our FuncNet is no longer a ﬂoating-point variable, but a function of the parameter of the problem. This feature makes it both efﬁcient and effective for a parametric problem. We apply FuncNet to super-resolution, image denoising, and JPEG deblocking. The experimental results show the superiority of our FuncNet on all three parametric image restoration tasks over the state of the arts. 1

Introduction
Image restoration [40] is a classical yet still active topic in low-level computer vision, which estimates the original image from a degraded measurement. For example, single image super-resolution [16] estimates the high-resolution image from a downsampled one, image denoising [4] estimates the clean image from a noisy one, and JPEG deblocking [7] estimates the original image from a compressed one. It is a challenging ill-posed inverse problem which aims to recover the information lost to the image degradation process [3], and it is also important since it is an essential step in various image processing and computer vision applications [71, 58, 2, 33, 46, 31, 20].
Almost every single image restoration problem has a closely related parameter, such as the scale factor in super-resolution, the noise level in image denoising, and the quality factor in JPEG deblocking.
The parameter in an image restoration problem tends to have a strong connection with the image degradation process. In the super-resolution problem, the blur kernel of the downsampling process is determined by the scale factor [62]. In the image denoising problem, the standard deviation of the additive white Gaussian noise is determined by the noise level [11]. In the JPEG deblocking problem, the quantization table for DCT coefﬁcients is determined by the quality factor [42]. When we try to restore the clean image from a corrupt one, we might know the value of the corresponding parameter for various reasons. In the super-resolution problem, the scale factor is speciﬁed by users [28]. In the image denoising problem, the noise level could be measured by other devices [43, 37]. In the
∗Corresponding author 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: The difference between a plain neural network and our functional neural network (FuncNet).
The left and right ﬁgure visualize a 3 × 3 convolution kernel in a plain neural network and its counterpart in a FuncNet respectively. For the kernel in a plain network, its weights remain unchanged for different problem related parameter levels, so the network only has a limited adaptability to parametric image restoration problems. Unlike a plain network, the smallest conceptual element of our FuncNet is no longer a ﬂoating-point variable, but a function of the problem related parameter.
In other words, the kernel weights of our FuncNet can change for different situations and make our
FuncNet perform better for parametric image restoration problems.
JPEG deblocking problem, the quality factor could be derived from the header of the JPEG ﬁle [10].
Therefore, it is very important to use the known parameter well in such a parametric image restoration problem.
Recently, deep convolutional neural network based methods are widely used to tackle the image restoration tasks, including super-resolution [14, 28, 45, 34, 47, 50, 68, 67, 12, 41], image denois-ing [25, 5, 64, 32, 48, 63, 65, 60, 1], and JPEG deblocking [36, 13, 55, 18, 6, 17, 35, 66, 15]. They have achieved signiﬁcant improvements over conventional image restoration methods due to their powerful learning ability. However, they have not been paying attention to the parameter involved in an image restoration problem, and handled it in an unsophisticated way. Most previous researchers either treat problems with different parameter levels as independent tasks, and train a speciﬁc model for each parameter level [14, 45, 67, 63, 66]; or simply ignore the parameter, and train a single model for all parameter levels [28, 60]. The two popular approaches have their own shortcomings. The former is inefﬁcient in computing, because they may have to train and store dozens of models for different parameter levels. The latter is ineffective in performance, since they ignore some important information that could have helped the restoration process.
To overcome these weaknesses, we propose a novel system called functional neural network (FuncNet) to solve a parametric image restoration problem with a single model. The difference between a plain neural network and our FuncNet is shown in Figure 1. Unlike a plain neural network, the smallest conceptual element of our FuncNet is no longer a ﬂoating-point weight, but a function of the parameter of the problem. When we train a FuncNet, we gradually change these functions to reduce the value of the loss function. When we use the trained FuncNet to restore a degraded image with a given parameter, we ﬁrst evaluate those functions with the parameter, use the evaluation values as weights of the network, and then do inference as normal. This feature makes it both efﬁcient and effective for a parametric problem. By this way, we neatly blend the parameter information into a neural network model, use it to help the restoration process, and only increase a negligible amount of computation as we will demonstrate later. We apply FuncNet to super-resolution, image denoising, and JPEG deblocking. The experimental results show the superiority of our FuncNet on all three parametric image restoration tasks over the state of the arts.
The remainder of the paper is organized as follows. Section 2 provides a brief survey of related work. Section 3 presents the proposed FuncNet model, discusses the details of implementation, and analyses its storage and computational efﬁciency. In Section 4, extensive experiments are conducted to evaluate FuncNets on three parametric image restoration tasks. Section 5 concludes the paper. 2
2