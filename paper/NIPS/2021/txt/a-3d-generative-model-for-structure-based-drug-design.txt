Abstract
We study a fundamental problem in structure-based drug design — generating molecules that bind to speciﬁc protein binding sites. While we have witnessed the great success of deep generative models in drug design, the existing methods are mostly string-based or graph-based. They are limited by the lack of spatial information and thus unable to be applied to structure-based design tasks. Partic-ularly, such models have no or little knowledge of how molecules interact with their target proteins exactly in 3D space. In this paper, we propose a 3D generative model that generates molecules given a designated 3D protein binding site. Speciﬁ-cally, given a binding site as the 3D context, our model estimates the probability density of atom’s occurrences in 3D space — positions that are more likely to have atoms will be assigned higher probability. To generate 3D molecules, we propose an auto-regressive sampling scheme — atoms are sampled sequentially from the learned distribution until there is no room for new atoms. Combined with this sampling scheme, our model can generate valid and diverse molecules, which could be applicable to various structure-based molecular design tasks such as molecule sampling and linker design. Experimental results demonstrate that molecules sampled from our model exhibit high binding afﬁnity to speciﬁc targets and good drug properties such as drug-likeness even if the model is not explicitly optimized for them. 1

Introduction
Designing molecules that bind to a speciﬁc protein binding site, also known as structure-based drug design, is one of the most challenging tasks in drug discovery [2]. Searching for suitable molecule candidates in silico usually involves massive computational efforts because of the enormous space of synthetically feasible chemicals [22] and conformational degree of freedom of both compound and protein structures [11].
In recent years, we have witnessed the success of machine learning approaches to problems in drug design, especially on molecule generation. Most of these approaches use deep generative models to propose drug candidates by learning the underlying distribution of desirable molecules. However, most of such methods are generally SMILES/string-based [10, 17] or graph-based [18, 19, 13, 14].
They are limited by the lack of spatial information and unable to perceive how molecules interact with proteins in 3D space. Hence, these methods are not applicable to generating molecules that ﬁt to a speciﬁc protein structure which is also known as the drug target. Another line of work studies 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
generating molecules directly in 3D space [8, 28, 29, 20, 30, 15]. Most of them [8, 28, 29] can only handle very small organic molecules, not sufﬁcient to generate drug-scale molecules which usually contain dozens of heavy atoms. [20] proposes to generate voxelized molecular images and use a post-processing algorithm to reconstruct molecular structures. Though this method could produce drug-scale molecules for speciﬁc protein pockets, the quality of the sampling is heavily limited by voxelization. Therefore, generating high-quality drug molecules for speciﬁc 3D protein binding sites remains challenging. as input, we model the distribution p(e, r
In this work, we propose a 3D generative model to approach this task. Speciﬁcally, we aim at modeling the distribution of atom occurrence in the 3D space of the binding site. Formally, given
R3 is an arbitrary 3D a binding site coordinate and e is atom type. To realize this distribution, we design a neural network architecture which takes as input a query 3D coordinate r, conditional on the 3D context
, and outputs the probability of r being occupied by an atom of a particular chemical element. In order to ensure the
’s rotation and translation, we utilize rotationally invariant graph neural distribution is equivariant to
C networks to perceive the context of each query coordinate.
), where r
|C
∈
C
C
|C
Despite having a neural network to model the distribution of atom occurrence p(e, r
), how to generate valid and diverse molecules still remains technically challenging, mainly for the following two reasons: First, simply drawing i.i.d. samples from the distribution p(e, r
) does not yield valid molecules because atoms within a molecule are not independent of each other. Second, a desirable sampling algorithm should capture the multi-modality of the feasible chemical space, i.e. it should be able to generate a diverse set of desired molecules given a speciﬁc binding context. To tackle the challenge, we propose an auto-regressive sampling algorithm. In speciﬁc, we start with a context consisting of only protein atoms. Then, we iteratively sample one atom from the distribution at each step and add it to the context to be used in the next step, until there is no room for new atoms. Compared to other recent methods [20, 23], our auto-regressive algorithm is simpler and more advantageous. It does not rely on post-processing algorithms to infer atom placements from density.
More importantly, it is capable of multi-modal sampling by the nature of auto-regressive, avoiding additional latent variables via VAEs [16] or GANs [9] which would bring about extra architectural complexity and training difﬁculty.
|C
We conduct extensive experiments to evaluate our approach. Quantitative and qualitative results show that: (1) our method is able to generate diverse drug-like molecules that have high binding afﬁnity to speciﬁc targets based on 3D structures of protein binding sites; (2) our method is able to generate molecules with fairly high drug-likeness score (QED) [4] and synthetic accessibility score (SA) [6] even if the model is not speciﬁcally optimized for them; (3) in addition to molecule generation, the proposed method is also applicable to other relevant tasks such as linker design. 2