Abstract
Accurate and trustworthy epidemic forecasting is an important problem for public health planning and disease mitigation. Most existing epidemic forecasting models disregard uncertainty quantiﬁcation, resulting in mis-calibrated predictions. Recent works in deep neural models for uncertainty-aware time-series forecasting also have several limitations; e.g., it is difﬁcult to specify proper priors in Bayesian
NNs, while methods like deep ensembling can be computationally expensive. In this paper, we propose to use neural functional processes to ﬁll this gap. We model epidemic time-series with a probabilistic generative process and propose a func-tional neural process model called EPIFNP, which directly models the probability distribution of the forecast value in a non-parametric way. In EPIFNP, we use a dynamic stochastic correlation graph to model the correlations between sequences, and design different stochastic latent variables to capture functional uncertainty from different perspectives. Our experiments in a real-time ﬂu forecasting set-ting show that EPIFNP signiﬁcantly outperforms state-of-the-art models in both accuracy and calibration metrics, up to 2.5x in accuracy and 2.4x in calibration.
Additionally, as EPIFNP learns the relations between the current season and similar patterns of historical seasons, it enables interpretable forecasts. Beyond epidemic forecasting, EPIFNP can be of independent interest for advancing uncertainty quantiﬁcation in deep sequential models for predictive analytics. 1

Introduction
Infectious diseases like seasonal inﬂuenza and COVID-19 are major global health issues, affecting millions of people [14, 34]. Forecasting disease time-series (such as infected cases) at various temporal and spatial resolutions is a non-trivial and important task [34]. Estimating various indicators e.g. future incidence, peak time/intensity and onset, gives policy makers valuable lead time to plan interventions and optimize supply chain decisions, as evidenced by various Centers for Disease
Control (CDC) prediction initiatives for diseases like dengue, inﬂuenza and COVID-19 [33, 16, 30].
Statistical approaches [5] for the forecasting problem are fairly new compared to more traditional mechanistic approaches [13, 38]. While valuable for ‘what-if’ scenario generation, mechanistic models have several issues in real-time forecasting. For example, they cannot easily leverage data from multiple indicators or predict composite signals. In contrast, deep learning approaches in this context are a novel direction and have become increasingly promising, as they can ingest numerous data signals without laborious feature engineering [37, 33, 1, 8].
However, there are several challenges in designing such methods, primarily with the need to handle uncertainty to give more reliable forecasts [14]. Decision makers need to understand the inherent uncertainty in the forecasts so that they can make robust decisions [32]. Providing probabilistic 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
forecasts and interpreting what signals cause the model uncertain is also helpful to better communicate the situation to the public. Due to the inherent complexity of the prediction problem, just like weather forecasting, so-called ‘point’ forecasts without uncertainty are increasingly seen as not very useful for planning for such high-stake decisions [14, 33].
Uncertainty quantiﬁcation in purely statistical epidemic forecasting models is a little explored area.
Most traditional methods optimize for accuracy of ‘point-estimates’ only. Some approaches that model the underlying generative distribution of the data naturally provide a probability distribution of the outputs [4, 5, 44, 32], but they do not focus on producing calibrated distributions [12, 22] as well.
Another line of research addresses this problem with the use of simple methods such as an ensemble of models to build a sample of forecasts/uncertainty bounds [34, 6]. Recent attempts for deep learning forecasting models use ad-hoc methods such as bootstrap sampling [37]; while others disregard this aspect [42, 36]. As a result these can produce wildly wrong predictions (especially in novel/atypical scenarios) and can be even conﬁdent in their mistakes. In time-series analysis, while a large number of deep learning models [1] have been proposed, little work has been done to quantify uncertainty in their predictions. Bayesian deep learning [28, 3, 27] (and approximation methods [10, 25, 43]) and deep ensembling [24] are two directions that may mitigate this issue, but their applicability and effectiveness are still largely limited by factors such as intractable exact model inference [3, 27], difﬁculty of specifying proper parameter priors [26], and uncertainty underestimation [21, 19]. Neural
Process (NP) [11] and Functional Neural Process (FNP) [26] are recent frameworks developed to incorporate stochastic processes with DNNs, but only for static data.
Our work aims to close these crucial gaps from both viewpoints. We propose a non-parametric model for epi-forecasting by ‘marrying’ deep sequential models with recent development of neural stochastic processes. Our model, called EPIFNP, leverages the expressive power of deep sequential models, while quantifying uncertainty for epidemic forecasting directly in the functional space. We extend the idea of learning dependencies between data points [26] to sequential data, and introduce additional latent representations for both local and global views of input sequences to improve model calibration. We also ﬁnd that the dependencies learned by EPIFNP enable reliable interpretation of the model’s forecasts.
Figure 1 shows an example of a well-calibrated forecast due to EPIFNP in
ﬂu forecasting. CDC is interested in forecasting weighted Inﬂuenza-like-illness (wILI) counts, where ILI is deﬁned as “fever and a cough and/or a sore throat without a known cause other than ﬂu. Figure 1 (a) shows the historical ILI data with abnormal seasons highlighted; Figure (b) shows how our method EPIFNP, in contrast to others, is able to react well to a par-ticularly novel event (in this case, in-troduction of a symptomatically simi-lar COVID-19 disease), giving both accurate and well-calibrated forecasts. (a) Historical wILI seasons se-quences, 2003-20
Figure 1: EPIFNP (red) is the only model reacting reliably for the atypical 3rd peak of 2019/20 season and whose 95% conﬁdence bounds completely encloses the ground truth. (b) Probabilistic predictions of all methods
Our main contributions are:
• Probabilistic Deep Generative Model: We design a neural Gaussian processes model for epi-demic forecasting, which automatically learns stochastic correlations between query sequences and historical data sequences for non-parametic uncertainty quantiﬁcation.
• Calibration and Explainability: EPIFNP models the output forecast distribution based on simi-larity between the current season and the historical seasons in a latent space. We introduce additional latent variables to capture global information of historical seasons and local views of sequences, and show that this leads to better-calibrated forecasts. Further, the relations learned between the current season and similar patterns from previous seasons enable explaining the predictions of EPIFNP.
• Empirical analysis of accurate well-calibrated forecasting: We perform rigorous benchmarking on ﬂu forecasting and show that EPIFNP signiﬁcantly outperforms strong baselines, providing up to 2.5x more accurate and 2.4x better calibrated forecasts. We also use outlier seasons to show the uncertainty in EPIFNP makes it adapt well to unseen patterns compared with baselines. 2
2 Problem and