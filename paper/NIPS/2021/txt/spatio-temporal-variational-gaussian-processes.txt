Abstract
We introduce a scalable approach to Gaussian process inference that combines spatio-temporal ﬁltering with natural gradient variational inference, resulting in a non-conjugate GP method for multivariate data that scales linearly with respect to time. Our natural gradient approach enables application of parallel ﬁltering and smoothing, further reducing the temporal span complexity to be logarithmic in the number of time steps. We derive a sparse approximation that constructs a state-space model over a reduced set of spatial inducing points, and show that for separable Markov kernels the full and sparse cases exactly recover the standard variational GP, whilst exhibiting favourable computational properties. To further improve the spatial scaling we propose a mean-ﬁeld assumption of independence between spatial locations which, when coupled with sparsity and parallelisation, leads to an efﬁcient and accurate method for large spatio-temporal problems. 1

Introduction
Most real-world processes occur across space and time, exhibit complex dependencies, and are observed through noisy irregular samples. Take, for example, the task of modelling air pollution across a city. Such a task involves large amounts of noisy, partially-observed data with strong seasonal effects governed by weather, trafﬁc, human movement, etc. This setting motivates a probabilistic perspective, allowing for the incorporation of prior knowledge and the quantiﬁcation of uncertainty.
Gaussian processes (GPS, [38]) provide such a probabilistic modelling paradigm, but their inherent cubic computational scaling in the number of data, N , limits their applicability to spatio-temporal tasks. Arguably the most successful methods to address this issue are sparse GPS [37], which summarise the true GP posterior through a reduced set of M inducing points and have dominant computational scaling O(N M 2), and spatio-temporal GPS [43], which rewrite the GP prior as a state-space model and use ﬁltering to perform inference in O(N d3), where d is the dimensionality of the state-space. Sparse GPS and spatio-temporal GPS have been combined by constructing a
Markovian system in which a set of spatial inducing points are tracked over time [24, 51].
However, existing methods for spatio-temporal GPS make approximations to the prior conditional model [24] or do not exploit natural gradients [45], meaning they do not provide the same inference and learning results as state-of-the-art variational GPS [26] in the presence of non-conjugate like-lihoods or sparsity, which has hindered their widespread adoption. We introduce spatio-temporal
∗equal contribution 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
SVGP
ST-SVGP
ST-SVGP recovers the same spatio-temporal model as SVGP if the inducing points repeat over time
ST-SVGP’s effective inducing point count scales with the data, but its computational scaling is linear in the number of time steps
Inducing points are shared over the temporal domain 1 3 - 0 3 3 - 0 5 3 - 0 5 - 0 1 0 2 5 - 0 1 0 2 5 - 0 1 0 2 5 - 0 1 0 2 6 3 - 0 5 - 0 1 0 2 9 3 - 0
Time
Figure 1: A demonstration of the spatio-temporal sparse variational GP (ST-SVGP) applied to crime count data in New York. ST-SVGP tracks spatial points over time via spatio-temporal ﬁltering. The colourmap is the posterior mean, and the red dots are spatial inducing points. The diagram shows the difference between how inducing points are treated in ST-SVGP and SVGP. variational GPS (ST-VGP), which provide the exact same results as standard variational GPS, whilst reducing the computational scaling in the temporal dimension from cubic to linear. ST-VGP is derived using a natural gradient variational inference approach based on ﬁltering and smoothing. We also derive this method’s sparse variant, and demonstrate how it enables the use of signiﬁcantly more inducing points than the standard approach, leading to improved predictive performance.
We then show how the spatio-temporal structure can be exploited even further to improve both the temporal and spatial scaling. We demonstrate for the ﬁrst time how to apply parallel ﬁltering and smoothing [41] to non-conjugate GPS to reduce the temporal (span) complexity to be logarithmic. We then reformulate the model to enable an efﬁcient mean-ﬁeld approximation across space, improving the complexity with respect to the number of spatial points. We analyse the practical performance and scalability of our proposed methods, demonstrating how they make it possible to apply GPS to large-scale spatio-temporal scenarios without sacriﬁcing inference quality. 1.1