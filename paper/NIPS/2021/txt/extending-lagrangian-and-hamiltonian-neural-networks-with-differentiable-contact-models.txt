Abstract
The incorporation of appropriate inductive bias plays a critical role in learning dynamics from data. A growing body of work has been exploring ways to enforce energy conservation in the learned dynamics by encoding Lagrangian or Hamil-tonian dynamics into the neural network architecture. These existing approaches are based on differential equations, which do not allow discontinuity in the states and thereby limit the class of systems one can learn. However, in reality, most physical systems, such as legged robots and robotic manipulators, involve contacts and collisions, which introduce discontinuities in the states. In this paper, we introduce a differentiable contact model, which can capture contact mechanics: frictionless/frictional, as well as elastic/inelastic. This model can also accommo-date inequality constraints, such as limits on the joint angles. The proposed contact model extends the scope of Lagrangian and Hamiltonian neural networks by allow-ing simultaneous learning of contact and system properties. We demonstrate this framework on a series of challenging 2D and 3D physical systems with different coefﬁcients of restitution and friction. The learned dynamics can be used as a differentiable physics simulator for downstream gradient-based optimization tasks, such as planning and control. 1 2 1

Introduction
A large class of real-world physical systems evolves in a piecewise-continuous manner. For example, while playing tennis, tennis balls collide with the ground and the rackets with high elasticity but follow smooth trajectories governed in between those collisions. The ability to walk/run depends heavily on the contacts between the legs and the ground. Unfavorable contact properties can signiﬁcantly hinder this ability; for example, lack of friction makes it very difﬁcult to walk on icy roads. Robotic manipulators and grippers also rely on contacts and collisions to perform their assigned tasks. These examples highlight the importance of contacts and collisions, which can be found everywhere.
Encoding energy conservation into the computation graph of a neural network constitutes an effective way to improve its data-efﬁciency and generalization performance in inferring the dynamics of a physical system from its trajectory data [1]. However, as these energy-conserving models assume the system trajectories to be smooth and governed by ordinary differential equations (ODE), they cannot model dynamics with contacts and collisions. On the other hand, another line of work, for example, interaction network [2], neural physics engine [3], and iterative neural projection [4] can model collisions and contacts and learn the associated properties. However, they are not ODE-based and hence cannot infer the continuous dynamics governing the smooth portion of the trajectories. A more recent work [5] has encoded a discrete form of the Euler-Lagrange equation while learning 1Code available at https://github.com/Physics-aware-AI/DiffCoSim. 2Video available at https://www.youtube.com/watch?v=DdJ7RLmG0kg. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
properties of frictionless 2D contacts. Learning of properties associated with frictional contacts and 3D contacts still remains a relatively underexplored topic in the literature.
In this work, we introduce a contact model that can handle frictional contacts both with or without elasticity as well as enforces energy-conservation during the smooth portions of the trajectories. The scope of energy-conserving neural networks are extended by the contact model. The contact model solves convex optimization problems to calculate the jump in velocity during contact. In order to use this contact model in deep learning tasks, we build upon the recent progress on differentiating through convex optimization problems [6]. We demonstrate the performance of the differentiable contact model in learning coefﬁcients of restitution and friction associated with a variety of 2D and 3D contacts. In addition, we also demonstrate the framework as a differentiable physics simulator and test it in downstream planning tasks. 1.1