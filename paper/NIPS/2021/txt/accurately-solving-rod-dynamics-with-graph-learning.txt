Abstract
Iterative solvers are widely used to accurately simulate physical systems. These solvers require initial guesses to generate a sequence of improving approximate solutions. In this contribution, we introduce a novel method to accelerate itera-tive solvers for rod dynamics with graph networks (GNs) by predicting the initial guesses to reduce the number of iterations. Unlike existing methods that aim to learn physical systems in an end-to-end manner, our approach guarantees long-term stability and therefore leads to more accurate solutions. Furthermore, our method improves the run time performance of traditional iterative solvers for rod dynamics. To explore our method we make use of position-based dynamics (PBD) as a common solver for physical systems and evaluate it by simulating the dynam-ics of elastic rods. Our approach is able to generalize across different initial condi-tions, discretizations, and realistic material properties. We demonstrate that it also performs well when taking discontinuous effects into account such as collisions between individual rods. Finally, to illustrate the scalability of our approach, we simulate complex 3D tree models composed of over a thousand individual branch segments swaying in wind ﬁelds. 1

Introduction
The numeric simulation of a dynamic system commonly comprises the derivation of the mathemati-cal model given by the underlying differential equations and their integration forward in time. In the context of physics-based systems, the mathematical model is usually based on ﬁrst principles and depending on the properties of the simulated system, the numerical integration of a complex sys-tem can be very resource demanding (Nealen et al., 2006), e.g., hindering interactive applications.
Enabled by the success of deep neural networks to serve as effective function approximators, re-searchers recently started investigating the applicability of neural networks for simulating dynamic systems. While many physical phenomena can well be described within ﬁxed spatial domains (e.g., in ﬂuid dynamics) that can be learned with convolutional neural network (CNN) architectures (Chu
& Thuerey, 2017; Guo et al., 2016; Tompson et al., 2016; Xiao et al., 2020), a large range of physical systems can more naturally be represented as graphs. Examples include systems based on connected particles (M¨uller et al., 2007), coupled oscillators (Michels & Desbrun, 2015; Michels et al., 2014), 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: Renderings taken from real-time simulations of the elastic deformation of a helix falling down on the ground plane (left) and two rods colliding with each other (right). or ﬁnite elements (Nealen et al., 2006). Existing methods enable learning these systems often in an end-to-end manner and with a focus on replacing the entire or a part of the integration procedure. A number of methods show initial success in approximating physical systems; however, they often fail to reliably simulate the state of a system over longer time horizons if signiﬁcant disadvantages are not accepted, such as the use of large datasets containing long-term simulations and the employment of speciﬁc memory structures (Sanchez-Gonzalez et al., 2020).
In this paper, we aim to improve the performance of iterative solvers for physical systems with graph networks (GN). An iterative solver requires an initial guess, and based on it generates a sequence of improving approximate solutions. The initial guess can be computed by simply using values obtained in the previous iteration or by solving a few steps of a similar but simpler physical system.
The performance of an iterative solver is signiﬁcantly inﬂuenced by the calculation of the initial guess, which we aim to replace with the prediction of a GN. To demonstrate our approach, we use a position-based dynamics (PBD) solver that approximates physical phenomena by using sets of connected vertices (Bender et al., 2017, 2014b; Macklin et al., 2016; M¨uller et al., 2007). To simulate a physical system, PBD ﬁrst computes updated locations of vertices using symplectic Euler integration to then correct the initial position estimates so as to satisfy a set of predeﬁned constraints.
The correction step is known as constraint projection and is commonly solved iteratively. The explicit forward integration for predicting the system’s updated state has negligible cost, whereas the projection step is computationally expensive. Our goal is to employ a GN to predict the outcome of the constraint projection step as an initial guess. This way, our approach inherits the long-term stability of a classic PBD solver, while providing better run-time performance.
To showcase the capabilities of our combined PBD solver, we aim to simulate the physically plau-sible mechanics of elastic rods. Rods play an important role for a variety of application domains, ranging from surgical simulation of sutures (Feess et al., 2016), catheters, and tendons (Pai, 2002), to human hair (Michels et al., 2015) and vegetation (Pirk et al., 2017) in animated movies. Furthermore, approaches exist to realistically simulate rods as sets of connected vertices accurately capturing their mechanical properties (Bergou et al., 2008; Kugelstadt & Schoemer, 2016; Michels et al., 2015; Pai, 2002). Our approach is able to generalize across different initial conditions, rod discretizations, and realistic material parameters such as Young’s modulus and torsional modulus (Deul et al., 2018).
Moreover, we demonstrate that our approach can handle discontinuous collisions between individ-ual rods. Figure 1 shows examples of elastic rod deformations of a helix falling down (left) and two colliding rods (right). Finally, we show that the data-driven prediction of the initial guesses of the constraint projection leads to a decreased number of required iterations, which – in turn – results in a signiﬁcant increase of performance compared to canonical initial guesses.
In summary, our contributions are: (1) we show how to accelerate iterative solvers with GNs; (2) we show that our network-enabled solver ensures long-term stability required for simulating physical systems; (3) we showcase the effectiveness of our method by realistically simulating elastic rods; (4) we demonstrate accuracy and generalizability of our approach by simulating different scenarios and various mechanical properties of rods including collisions and complex topologies (dynamic tree simulations). 2