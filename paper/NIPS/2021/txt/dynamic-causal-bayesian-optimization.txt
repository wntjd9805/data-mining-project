Abstract
This paper studies the problem of performing a sequence of optimal interventions in a causal dynamical system where both the target variable of interest and the inputs evolve over time. This problem arises in a variety of domains e.g. system biology and operational research. Dynamic Causal Bayesian Optimization (DCBO) brings together ideas from sequential decision making, causal inference and Gaussian process (GP) emulation. DCBO is useful in scenarios where all causal effects in a graph are changing over time. At every time step DCBO identiﬁes a local optimal intervention by integrating both observational and past interventional data collected from the system. We give theoretical results detailing how one can transfer interventional information across time steps and deﬁne a dynamic causal
GP model which can be used to quantify uncertainty and ﬁnd optimal interventions in practice. We demonstrate how DCBO identiﬁes optimal interventions faster than competing approaches in multiple settings and applications. 1

Introduction
Solving decision making problems in a variety of domains requires understanding of cause-effect relationships in a system.
This can be obtained by experimentation. However, deciding how to intervene at every point in time is particularly complex in dynamical systems, due to the evolving nature of causal effects. For instance, companies need to decide how to allocate scarce resources across different quarters. In system biology, scientists need to identify genes to knockout at speciﬁc points in time. This paper describes a probabilistic framework that
ﬁnds such optimal interventions over time.
Focusing on a speciﬁc example, consider a setting in which Yt denotes the unemployment-rate of an economy at time t, Zt is the economic growth and Xt the inﬂation rate. Fig. 1a depicts the causal graph [26] representing an agent’s understanding of the causal links between these variables. The agent aims to 0, 1, 2
, the optimal action to determine, at each time step t
}
∈ { perform in order to minimize the current unemployment rate
∗Denotes equal contribution
Figure 1: DAG representation of a dynamic causal global optimisation (DCGO) problem (a) and the DAG considered when using CBO, ABO or BO to address the same prob-lem. Shaded nodes gives observed variables while the arrows represent causal effects. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Yt while accounting for the intervention cost. The investigator could frame this setting as a sequence of global optimization problems and ﬁnd the solutions by resorting to Causal Bayesian Optimization
[CBO, 2]. CBO extends Bayesian Optimization [BO, 30] to cases in which the variable to optimize is part of a causal model where a sequence of interventions can be performed. However, CBO does not account for the system’s temporal evolution thus breaking the time dependency structure existing among variables (Fig. 1b). This will lead to sub-optimal solutions, especially in non-stationary scenarios. The same would happen when using Adaptive Bayesian Optimization [ABO, 25] (Fig. 1c) or BO (Fig. 1d). ABO captures the time dependency of the objective function but neither considers the causal structure among inputs nor their temporal evolution. BO disregards both the temporal and the causal structure. Our setting differs from both reinforcement learning (RL) and the multi-armed bandits setting (MAB). Differently from MAB we consider interventions on continuous variables where the dynamic target variable has a non-stationary interventional distribution. In addition, compared to RL, we do not model the state dynamics explicitly and allow the agent to perform a number of explorative interventions which do not change the underlying state of the system, before selecting the optimal action. We discuss these points further in §1.1.
Dynamic Causal Bayesian Optimization2, henceforth DCBO, accounts for both the causal relationships among input variables and the causality between inputs and outputs which might evolve over time.
DCBO integrates CBO with dynamic Bayesian networks (DBN), offering a novel approach for decision making under uncertainty within dynamical systems. DBN [19] are commonly used in time-series modelling and carry dependence assumptions that do not imply causation. Instead, in probabilistic causal models [27], which form the basis for the CBO framework, graphs are buildt around causal information and allow us to reason about the effects of different interventions. By combining CBO with DBNs, the proposed methodology ﬁnds an optimal sequence of interventions which accounts for the causal temporal dynamics of the system. In addition, DCBO takes into account past optimal interventions and transfers this information across time, thus identifying the optimal intervention faster than competing approaches and at a lower cost. We make the following contributions:
• We formulate a new class of optimization problems called Dynamic Causal Global Optimization (DCGO) where the objective functions account for the temporal causal dynamics among variables.
• We give theoretical results demonstrating how interventional information can be transferred across time-steps depending on the topology of the causal graph.
• Exploiting our theoretical results, we solve the optimization problem with DCBO. At every time step, DCBO constructs surrogate models for different intervention sets by integrating various sources of data while accounting for past interventions.
• We analyze DCBO performance in a variety of settings comparing against CBO, ABO and BO. 1.1