Abstract
Deep-learning based Super-Resolution (SR) methods have exhibited promising performance under non-blind setting where blur kernel is known. However, blur kernels of Low-Resolution (LR) images in different practical applications are usually unknown. It may lead to signiﬁcant performance drop when degradation process of training images deviates from that of real images. In this paper, we propose a novel blind SR framework to super-resolve LR images degraded by arbitrary blur kernel with accurate kernel estimation in frequency domain. To our best knowledge, this is the ﬁrst deep learning method which conducts blur kernel estimation in frequency domain. Speciﬁcally, we ﬁrst demonstrate that feature representation in frequency domain is more conducive for blur kernel reconstruction than in spatial domain. Next, we present a Spectrum-to-Kernel (S2K) network to estimate general blur kernels in diverse forms. We use a Conditional GAN (CGAN) combined with SR-oriented optimization target to learn the end-to-end translation from degraded images’ spectra to unknown kernels. Extensive experiments on both synthetic and real-world images demonstrate that our proposed method sufﬁciently reduces blur kernel estimation error, thus enables the off-the-shelf non-blind SR methods to work under blind setting effectively, and achieves superior performance over state-of-the-art blind SR methods, averagely by 1.39dB, 0.48dB on commom blind SR setting (with Gaussian kernels) for scales 2× and 4×, respectively. 1

Introduction
Single Image Super-Resolution (SISR) is a low-level visual task to recover High-Resolution (HR) im-ages from its degraded Low-Resolution (LR) counterparts. Deep learning methods have signiﬁcantly promoted SR research and achieved remarkable results on benchmarks [16, 26, 27, 13, 29, 35, 17].
Most of these works are based on the degradation model assuming that the LR image is down-sampled with blur kernel (e.g., bicubic kernel) and additional noise from its HR source. Recent studies [6, 11] show that pre-trained SR model is sensitive to the degradation of LR image. The mismatch for
Gaussian kernels may cause SR result either over-sharpening or over-smoothing, and for motion kernels, it may bring unpleasant jitters and artifacts. Blind SR is to super-resolve a single LR image with its kernel unknown. It has attracted more and more attention due to its close relationship with the real scene. However, compared with the advanced non-blind SR researches, existing blind SR methods are insufﬁcient to meet the needs of various degradation processes in real general scenes.
∗Work done during an intership at Tencent Youtu Lab.
† Corresponding author (lutong@nju.edu.cn). 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: 4× blind SR results comparison on real historic images. Our method achieves the best visual perception in recovery of real-scene objects such as clearer text shape and building structures.
LR patches are cropped from images in http://vllab.ucmerced.edu/wlai24/LapSRN/.
Some representative works have been proposed on this challenging problem. Bell-Kligler et al. estimate the kernel with internal-Generative Adversarial Network (GAN) on the basis of maximum similarity of patches across scales, whose performance is limited even with handcraft constraints for the weak prior fails to capture the kernel-related features directly [2]. Gu et al. propose an Iterative
Kernel Correction (IKC) framework to correct the kernel estimation from the mismatch between kernel and SR result in an iterative way [6]. IKC is based on Maximum A Posteriori (MAP), in which the estimator depends on the posterior of the pre-trained restorer. As demonstrated in [14], due to the accuracy limitation of the restorer, the maximum performance of the estimator cannot be guaranteed.
Ji et al. introduce the frequency consistency constraint between the generated down-sampled image and the real input to estimate the blur kernel in spatial domain [11]. However, its training requires a certain amount of data with the same degradation and fails to capture blur diversities in various directions, limiting its application for a speciﬁc input LR image degraded with an arbitrary kernel.
In this paper, we capture the convolution degradation feature of the local distribution in LR images from a novel perspective. Based on convolution theorem and sparsity analysis, we demonstrate the Fourier frequency spectrum of degraded LR image provides a robust shape structure of the degradation kernel in the frequency domain, which can be utilized to reconstruct the unknown kernel more accurately and robustly. Based on the above analysis, we design a Spectrum-to-Kernel (S2K) translation network to directly obtain the kernel interpolation result from degraded LR’s frequency spectrum. As far as we know, this is the ﬁrst work to estimate kernel thoroughly in the frequency domain instead of in the spatial domain previously. The experimental results demonstrate that our method accurately estimates the target kernel and has a high universality capacity for diverse kernels.
Moreover, when combined with the existing non-blind methods, we achieve the best results in quality evaluation and visual perception on synthetic and real images against existing blind SR methods.
Figure 1 compares 4× blind SR results with recently proposed methods on real historical images.
In general, our main contributions are summarized as follows:
• We theoretically demonstrate that for common sparse kernels, it is more conducive to reconstruct it in the frequency domain instead of the commonly used spatial domain.
• We analyze the impacts of kernel estimation optimization objectives for blind SR performance and design a novel network S2K to estimate kernel from Fourier amplitude spectrum.
• When plugged into existing non-blind SR models, our proposed pipeline achieves the best perfor-mance on both synthetic and real-world images against existing blind SR methods. 2