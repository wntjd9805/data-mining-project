Abstract
While probabilistic models are an important tool for studying causality, doing so suffers from the intractability of inference. As a step towards tractable causal models, we consider the problem of learning interventional distributions using sum-product networks (SPNs) that are over-parameterized by gate functions, e.g., neural networks. Providing an arbitrarily intervened causal graph as input, effectively subsuming Pearlâ€™s do-operator, the gate function predicts the parameters of the
SPN. The resulting interventional SPNs are motivated and illustrated by a structural causal model themed around personal health. Our empirical evaluation against competing methods from both generative and causal modelling demonstrates that interventional SPNs indeed are both expressive and causally adequate. 1

Introduction
Identifying causal relationships between variables in observational data is one of the fundamental and well-studied problem in machine learning. There have been several great strides in causality
[Granger, 1969, Pearl, 2009, Bareinboim and Pearl, 2016] over the years specifically characterized by efforts that focused on reasoning about interventions [Hagmayer et al., 2007, Dasgupta et al., 2019] and counterfactuals [Morgan and Winship, 2015, Oberst and Sontag, 2019].
The notion of causality has long been explored in the realm of probabilistic models [Oaksford and Chater, 2017, Beckers and Halpern, 2019] with a special focus on graphical models, called causal Bayesian networks (CBNs) [Heckerman et al., 1995, Neapolitan, 2004, Pearl, 1995, Acharya et al., 2018]. CBNs have widely been applied to infer causal relationships in high-impact diverse applications such as disease progression [Koch et al., 2017], ecological risk assessment [Carriger and Barron, 2020] and more recently Covid-19 [Fenton et al., 2020, Feroze, 2020] to name a few.
Although successful, classical CBN models are difficult to scale and also suffer from the problem of intractable inference. Recently, tractable probabilistic models such as probabilistic sentential decision diagrams [Kisa et al., 2014] and sum-product networks [Poon and Domingos, 2011] have emerged, which guarantee that conditional marginals can be computed in time linear in the size of the model.
While weaving in the notion of interpretability, the computational view on probabilistic models allows one to exploit ideas from deep learning and can thus be very useful in modelling complex problems.
Recently, there has been an effort to take advantage of this tractability to reason for causality. Zhao et al. [2015] showed how to compile back and forth between sum-product networks (SPNs) and
Bayesian networks (BNs). Although this opened up a whole range of possibilities for tractable 35th Conference on Neural Information Processing Systems (NeurIPS 2021), virtual.
Figure 1: Capturing interventional distributions using iSPN. The interventional distributions for the ASIA data set using a causal Bayesian network (CBN, small-scale gold standard, gray bars) as well as an interventional SPN (iSPN) by intervening on lung. The iSPN is sensible to all the influences of the given intervention onto the system i.e., subsequent effects in the causal hierachy. (Best viewed in color.) causal models, Papantonis and Belle [2020] argued that such conversion leads to degenerated BNs thereby rendering it ineffective for causal reasoning. For the considered compilation of SPNs to BNs, this is indeed the case since a bipartite graph between the hidden and observed variables loses the relationships between the actual variables. Thus, either a new compilation method for transforming between tractable and causal model or alternatively a method to condition the probabilistic models directly on the do-operator to obtain interventional distributions, P (y| do(x)), is being required.
Here, we consider the latter strategy and extend the idea of conditionally parameterizing SPNs [Shao et al., 2019] by conditioning on the do-operator while predicting the complete set of observed variables therefore capturing the effect of intervention(s). The resulting interventional sum-product networks (iSPNs) take advantage of both the expressivity, due to the neural network, and the tractability, due to the SPN in order to capture the interventional distributions faithfully. This shows that the dream of tractable causal models is not insurmountable, since iSPNs are causal. Pearl [2019] defined a three-level causal hierarchy that separates association (purely statistical level 1) from intervention (level 2) and counterfactuals (level 3), and argued that the latter two levels involve causal inference. iSPNs are a modelling scheme for arbitrary interventional distributions. They thus belong to level 2 and, in turn, are causal. So, while SPNs are not universal function approximators and the use of gate functions turns them into universal approximators, we go one step ahead and make the first effort towards introducing causality to SPNs without the need for compilation to Bayesian networks, as the functional approximator subsumes the do-operator. Fig. 1 shows an example of the effectiveness of iSPNs to capture interventional distributions on the ASIA data set. Our extensive experiments against strong baselines demonstrate that our method is able to capture ideal interventional distributions.
To summarize, we make the following contributions: 1. We introduce iSPNs, the first method that applies the idea of tractable probabilistic models to causality without the need for compilation and that accordingly generate interventional distributions w.r.t. the provided causal structure. 2. We formulate the inductive bias necessary for turning conditional SPN into iSPN while taking advantage of the neural network modelling capacities within the gating nodes for for modelling interventional distributions while capturing all influences within the given intervention (i.e., consequences propagated through the structural hierarchy). 3. We show that, by construction, iSPNs can identify any interventional distribution permitted by the underlying structural causal model due to the inducted bias on the interface modalities in junction with the universal function approximation of the underlying gated SPN.
We proceed as follows. We start by reviewing the basic concepts required and related work, namely the tractable model class of sum-product networks and key concepts from causality. Then we motivate using a newly curated causal model themed around personal health. Subsequently, we introduce iSPNs formally and prove that by construction they are capable of approximating any do-query (given corresponding data). Before concluding, we present our experimental evaluation in which we 2
challenge iSPN in its density estimation and causal inference capabilities against various baselines.
We make our code publically available at: https://github.com/zecevic-matej/iSPN. 2