Abstract
In this paper we introduce CorticalFlow, a new geometric deep-learning model that, given a 3-dimensional image, learns to deform a reference template towards a targeted object. To conserve the template mesh’s topological properties, we train our model over a set of diffeomorphic transformations. This new implementa-tion of a ﬂow Ordinary Differential Equation (ODE) framework beneﬁts from a small GPU memory footprint, allowing the generation of surfaces with several hundred thousand vertices. To reduce topological errors introduced by its discrete resolution, we derive numeric conditions which improve the manifoldness of the predicted triangle mesh. To exhibit the utility of CorticalFlow, we demonstrate its performance for the challenging task of brain cortical surface reconstruction.
In contrast to current state-of-the-art, CorticalFlow produces superior surfaces while reducing the computation time from nine and a half minutes to one second.
More signiﬁcantly, CorticalFlow enforces the generation of anatomically plausible surfaces; the absence of which has been a major impediment restricting the clinical relevance of such surface reconstruction methods. 1

Introduction
The ﬁeld of 3D shape reconstruction using deep learning techniques has attracted much attention.
Recently, a plethora of methods have been developed for problems such as single-view object reconstruction [22, 50, 77], surface generation [27, 74], and meshing noisy point clouds [32, 42]. At
ﬁrst, these methods solely aimed to retrieve surface meshes as geometrically close as possible to the target shape. However, recent applications require generating regular meshes with a known genus, such as physics simulation, 3D-printing, and clinical analysis of anatomical surfaces [24, 58, 62].
In this direction, three approaches in the literature stand out: DeepCSR [61], Voxel2Mesh [73], and Neural Mesh Flow (NMF) [30]. DeepCSR ﬁrst predicts implicit surface functions and then employs an iso-surface extraction method along with a topology correction algorithm to obtain genus-zero surfaces without handles or holes. Voxel2Mesh extends the vertex-wise template deformation approach of Wang et al. [71] by optimizing several mesh-smoothing penalty functions. In contrast,
NMF builds an invertible mapping that enforces topology conservation upon the resolution of an
Ordinary Differential Equation (ODE) through a sequence of residual blocks called Neural Ordinary
Differential Equation (NODE) [9]. However, these methods come with several limitations. The topology correction algorithm employed by DeepCSR is computationally expensive and is blind
† Equal contribution
Check our project web-page https://lebrat.github.io/CorticalFlow/ 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
towards the anatomical validity of its reconstructions, which can result in implausible corrections and mesh artifacts. On the other hand, Voxel2Mesh and NMF rely on time-demanding and vertex-dependent building blocks such as graph convolution that do not scale up well as the number of vertices in the template mesh increases to accommodate complex shapes. In addition, the dynamics learned by the NODE model in NMF can be very complex and may lead to a non-diffeomorphic mapping resulting in self-intersections in the reconstructed mesh.
This paper introduces CorticalFlow (CF), a new geometric deep learning model that smoothly deforms a template mesh towards complex shapes producing high-resolution regular meshes. First, a simple 3D convolution neural network predicts a dense 3D ﬂow ﬁeld from a volumetric image with a modest GPU memory footprint. Second, we formulate a tractable mathematical framework to compute diffeomorphic mapping for each vertex by solving a ﬂow ODE. We derive sufﬁcient and comprehensible conditions for meeting the diffeomorphic properties of these transformations.
Finally, a sequence of these diffeomorphic mappings is composed to produce accurate high-resolution genus-zero regular meshes.
To evaluate our approach and compare it to existing techniques for regular surface reconstruction, we consider the problem of brain cortical surface reconstruction, which is an essential step for the analysis of brain morphometry in neurodegenerative diseases [18] and psychological disorders [57]. Given a 3D MRI of the brain, the goal is to describe the inner and outer surfaces of the brain cortex, which are both homeomorphic to a sphere. Cortical surface reconstruction is challenging given the complexity, high resolution, and regularity required for the predicted meshes. In our experiments, CorticalFlow is more accurate than state-of-the-art methods, providing an average reduction of 17.38% in Chamfer distance across all cortical surfaces compared to DeepCSR (the second-best performing method in this criteria). In terms of surface regularity, it surpasses NMF or Voxel2Mesh with an average reduction of at least 32.58% of self-intersecting faces while handling template meshes with many more vertices. It is also faster and more memory-efﬁcient than all of these competitors. 2