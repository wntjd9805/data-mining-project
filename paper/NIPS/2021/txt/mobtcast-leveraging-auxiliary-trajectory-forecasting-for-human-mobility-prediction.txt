Abstract
Human mobility prediction is a core functionality in many location-based services and applications. However, due to the sparsity of mobility data, it is not an easy task to predict future POIs (place-of-interests) that are going to be visited. In this paper, we propose MobTCast, a Transformer-based context-aware network for mobility prediction. Speciﬁcally, we explore the inﬂuence of four types of context in mobility prediction: temporal, semantic, social, and geographical contexts. We
ﬁrst design a base mobility feature extractor using the Transformer architecture, which takes both the history POI sequence and the semantic information as input.
It handles both the temporal and semantic contexts. Based on the base extractor and the social connections of a user, we employ a self-attention module to model the inﬂuence of the social context. Furthermore, unlike existing methods, we introduce a location prediction branch in MobTCast as an auxiliary task to model the geographical context and predict the next location. Intuitively, the geographical distance between the location of the predicted POI and the predicted location from the auxiliary branch should be as close as possible. To reﬂect this relation, we design a consistency loss to further improve the POI prediction performance. In our experimental results, MobTCast outperforms other state-of-the-art next POI prediction methods. Our approach illustrates the value of including different types of context in next POI prediction. 1

Introduction
Human mobility prediction plays an important role in a wide range of applications, including personalised advertisement, trafﬁc modelling, and predicting the spread of pandemics [14, 17]. For example, targeted advertisements, such as store information and coupons can be delivered precisely by predicting the future POIs that users might visit. It could also be valuable in the context of pandemics, to support contact tracing and crowd management.
Unlike other densely acquired trajectory sequence data (such as trajectories extracted from videos [1, 20] and GPS trajectories [21, 29]), trajectory data for the next POI prediction task is typically in the form of check-in sequences and collected from popular Location Based Social Networks (LBSNs), such as Foursquare. As the visited POI information is recorded only when a user chooses to check-in 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
and accesses the location service, the check-in sequence data is very sparse. Due to privacy concerns or battery limitations on mobile devices, users rarely report their locations all the time. This inherent sparsity increases the difﬁculty of the prediction of future POIs dramatically.
In the last few years, given major advances in deep learning techniques and especially the success of applying Recurrent Neural Networks (RNNs) for sequence prediction tasks, many research works have leveraged the user’s historical trajectories to predict most likely POI to be visited by that user. A pioneering work proposed ST-RNNs [25] which employ both time-speciﬁc and distance-speciﬁc transition matrices in an RNN architecture to model time intervals and geographical distances between two consecutive check-in POIs in historical trajectories. DeepMove [9] incorporates a historical attention module to capture the periodicity of human mobility. Following this trend, more recently, VANext [11] and ACN [27] propose two more attention mechanisms to learn long term preferences for users from history trajectories. However, considering the data sparsity, only exploring the historical visiting information may not be enough. For instance, compared to the large number of
POIs and the complexity of the nature of people’s preferences, the small amount of visited POIs in a user’s historical log is unlikely to reveal their entire range of preferences over all available POIs.
Therefore, in addition to exploring the temporal context based on the user’s own past visiting history, the inﬂuence from other types of context could be valuable to achieve more accurate POI prediction.
In particular, there are three important types of context that could help tackle the sparsity problem: (1) Semantic Context: Typically, in LBSNs, each POI belongs to a category with high level semantic meanings such as Shops and Education. This context is an indicator in predicting the next POI. For example, at lunchtime, people are more likely to visit Food POIs than other types of POIs. Leisure travellers will tend to check in at tourism POI attractions. (2) Social Context: Friends and family members often visit a POI together. A user may also check in a new POI recommended by friends. (3) Geographical Context: POIs that are close to each other might be visited by the same user due to their proximity. For example, a user may visit a shopping mall and then go to a nearby cinema. A detailed data-driven analysis of these contexts is given in Section 7.2.
However, one limitation in the existing literature is that the context has been typically modelled based on manually designed functions. For example, Sun et al. [30] noticed that the geographical distances between any two non-consecutive visited POIs are also important. A geo-nonlocal function is introduced into the RNN to measure the distance between each visited POI and the average location of all visited POIs. Similarly, Flashback [38] introduces a manually designed weighting function to assign weights based on both temporal and geographical distances for each time step.
In this paper, we propose a novel method called MobTCast, for the next POI prediction task, which is explicitly designed to model and incorporate the inﬂuence of the aforementioned contexts in a data-driven manner. A Transformer [31]-based mobility feature extractor is a fundamental component in MobTCastto perform the main POI prediction task. It takes both the visited POI history and the semantic category information to learn semantic-aware mobility features. Using this mobility feature extractor, we extract not only the semantic-aware mobility features of a user but also the features of his/her neighbours. A self-attention mechanism is then applied to model the social inﬂuence from neighbours to the user. This aggregated feature is both semantic and social-aware. To include geographical context, the model includes an auxiliary task, which is different from previously proposed methods that depend on manually designed kernels. Considering that the focus of this auxiliary task is exploring the geographical information (i.e., geographical coordinates of visited
POIs), it is designed as a trajectory forecasting task. The purpose is to predict a future location (coordinate) based on the previously visited locations.
As a result of these two tasks (main and auxiliary), there are two predicted coordinates available: the predicted location from the auxiliary trajectory forecasting task and the inferred location from the predicted POI given by the main task. Ideally, the Euclidean distance between these two locations should be as close as possible. To this end, a novel consistency loss function is proposed to reﬂect and embody this relationship in the training process of MobTCast. Thus, the main and the auxiliary tasks are connected not only at the feature level but also at the output level. We conduct extensive experiments on three publicly available real-world datasets. The results demonstrate MobTCast´s competitive POI prediction performance and show the value of incorporating different types of context as well as the consistency loss function.
In summary, the main contributions of our work are two-fold: (i) We address the next POI prediction problem by including four types of context: temporal, geographical, social and semantic. Moreover, 2
we design an auxiliary trajectory forecasting task to predict the geographical coordinates of the next most likely location. To the best of our knowledge, this is the ﬁrst time that auxiliary trajectory forecasting is incorporated in a POI prediction model, which provides a new perspective for under-standing human mobility. (ii) We introduce a novel consistency loss function to connect the predicted
POI (from the main task) and the predicted location (from the auxiliary task). This consistency loss function helps further improve the POI prediction performance. 2