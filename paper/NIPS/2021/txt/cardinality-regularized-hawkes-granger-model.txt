Abstract
We propose a new sparse Granger-causal learning framework for temporal event data. We focus on a speciﬁc class of point processes called the Hawkes process. We begin by pointing out that most of the existing sparse causal learning algorithms for the Hawkes process suffer from a singularity in maximum likelihood estimation. As a result, their sparse solutions can appear only as numerical artifacts. In this paper, we propose a mathematically well-deﬁned sparse causal learning framework based on a cardinality-regularized Hawkes process, which remedies the pathological issues of existing approaches. We leverage the proposed algorithm for the task of instance-wise causal event analysis, where sparsity plays a critical role. We validate the proposed framework with two real use-cases, one from the power grid and the other from the cloud data center management domain. 1

Introduction
The Hawkes process [14] is one of the most popular models for analyzing temporal events in the machine learning (ML) community. It has been applied in a variety of application areas including analysis of human activities on social networks [23, 36, 39, 15, 38, 22, 2, 44], healthcare event analysis [6, 12], search query analysis [21, 20], and even water pipe maintenance [48]. In the studies of Hawkes processes, there have been two major milestones to date. One is the minorization-maximization (MM) algorithm [16]. The other is Granger causal analysis through Hawkes processes.
The ﬁrst milestone was marked by Veen and Schoenberg [42]. Based on the intuition of branching process of earthquake aftershocks, they introduced the ﬁrst MM-based maximum likelihood algorithm, which is often loosely referred to as EM (expectation-maximization) due to their similarity (See
Eq. (14) and the discussion below). As their paper pointed out, the standard gradient-based maximum likelihood estimation (MLE) of multivariate Hawkes processes suffered from numerical stability issues, limiting their applicability in practice.
The second milestone was achieved by a few pioneers including Kim et al. [18] who ﬁrst proposed an approach to Granger causal learning through the Hawkes process; Zhou et al. [51] who introduced (cid:96)1 regularized MLE of a multivariate Hawkes process in the context of Granger causal analysis; and
Eichler et al. [9] who theoretically established the equivalence between the Hawkes-based causality and the Granger causality [13].
Given these achievements and the well-known importance of sparsity in Granger causal learning [3, 24], the MM algorithm combined with a sparsity-enforcing regularizer would seem to be a promising path for Granger-causal analysis for stochastic events. This is especially true when the main interest is in analyzing causal triggering mechanism of event instances since the MM framework provides
Interestingly, however, the likelihood instance-wise triggering probabilities as a side product. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Figure 1: The Hawkes-Granger model allows two different levels of causal analysis: (a) instance-wise and (b) type-wise, in which well-deﬁned sparsity is essential for causal diagnosis. (c) Example of
ﬁve-variate point process data, where each ‘|’ represents an event instance. function of the MM algorithm has a singularity that in fact prohibits any sparse solutions. Despite its signiﬁcance, to date little attention has been paid to this issue in the ML community.
In this paper, we provide a mathematically well-deﬁned solution to sparse causal learning on temporal event data for the ﬁrst time. Speciﬁcally, we introduce a novel cardinality-regularized MM framework for the Hawkes process. Although cardinality- or (cid:96)0-regularization is known as an ideal way of en-forcing sparsity, it makes optimization problems generally hard to solve. Even checking the feasibility is NP-complete [17]. We will show that the Hawkes process in fact has a semi-analytic solution under an (cid:96)0-constraint, which is free from pathological issues due to the logarithmic singularity at zero, unlike existing (cid:96)1-regularization approaches [51, 46]. By leveraging the well-deﬁned sparsity and the side product provided by the MM framework, we tackle the task of instance-wise causal diagnosis in real world domains. Since any event instance occurring in the past is a potential candidate cause of a given event of interest, achieving sufﬁcient sparsity in the learned causal structure has proven critical in these applications. See also Fig. 1 for illustration.
To the best of our knowledge, this work represents the ﬁrst (cid:96)0-regularized MM learning framework for the Hawkes process applied to simultaneous instance- and type-level causal analysis. 2