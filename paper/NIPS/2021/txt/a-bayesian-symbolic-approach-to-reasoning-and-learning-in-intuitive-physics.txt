Abstract
Humans can reason about intuitive physics in fully or partially observed envi-ronments even after being exposed to a very limited set of observations. This sample-efﬁcient intuitive physical reasoning is considered a core domain of human common sense knowledge. One hypothesis to explain this remarkable capacity, posits that humans quickly learn approximations to the laws of physics that govern the dynamics of the environment. In this paper, we propose a Bayesian-symbolic framework (BSP) for physical reasoning and learning that is close to human-level sample-efﬁciency and accuracy. In BSP, the environment is represented by a top-down generative model of entities, which are assumed to interact with each other under unknown force laws over their latent and observed properties. BSP models each of these entities as random variables, and uses Bayesian inference to estimate their unknown properties. For learning the unknown forces, BSP leverages sym-bolic regression on a novel grammar of Newtonian physics in a bilevel optimization setup. These inference and regression steps are performed in an iterative manner using expectation-maximization, allowing BSP to simultaneously learn force laws while maintaining uncertainty over entity properties. We show that BSP is more sample-efﬁcient compared to neural alternatives on controlled synthetic datasets, demonstrate BSP’s applicability to real-world common sense scenes and study
BSP’s performance on tasks previously used to study human physical reasoning.1 1

Introduction
Imagine a ball rolling down a ramp. If asked to predict the trajectory of the ball, most of us will ﬁnd it fairly easy to make a reasonable prediction. Not only that, simply by observing a single trajectory people can make reasonable guesses about the material and weight of the ball and the ramp. It is astonishing that while the exact answers to any of these prediction and reasoning tasks requires an in-depth knowledge of Newtonian mechanics and solving of some intricate equations, yet an average human can perform such tasks without any formal training in physics. Studies suggest that from early age humans come to understand physical interactions with very limited supervision, and can 1Source code as well as training and testing data can be accessed at https://bsp.xuk.ai/. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
efﬁciently reason and plan actions in common sense tasks, even in absence of complete information (Spelke, 2000; Battaglia et al., 2013). For example, with limited data, 4 or 5 years old children are capable of learning the physical laws behind magnetism (Bonawitz et al., 2019). Physical reasoning is considered a core domain of human common-sense knowledge (Spelke & Kinzler, 2007). Recent studies suggest that the ability to efﬁciently learn physical properties and interactions with limited supervision is driven by a noisy model of Newtonian dynamics, referred to as the intuitive physics engine (IPE; Bates et al., 2015; Gerstenberg et al., 2015; Sanborn et al., 2013; Lake et al., 2017;
Battaglia et al., 2013). This has led to a surge in research aimed at developing agents with an IPE, or a model of the environment dynamics (Amos et al., 2018; Chang et al., 2016; Grzeszczuk & Animator, 1998; Fragkiadaki et al., 2015; Battaglia et al., 2016; Watters et al., 2017; Sanchez-Gonzalez et al., 2019; Ehrhardt et al., 2017; Kipf et al., 2018; Seo et al., 2019; Baradel et al., 2020). These efforts have created methods that either trade-off data-efﬁciency, by using deep neural networks (NNs), for high predictive accuracy (Breen et al., 2019; Battaglia et al., 2016; Sanchez-Gonzalez et al., 2019) or trade-off ﬂexibility to learn from data for data-efﬁciency by using symbolic methods (Ullman et al., 2018; Smith et al., 2019; Sanborn et al., 2013; Bramley et al., 2018).
Inspired by the highly data-efﬁcient ability of humans to learn and reason about their physical environment with incomplete information, we present Bayesian-symbolic physics (BSP), a
Bayesian-symbolic model with an expectation-maximization (EM) algorithm that combines the sample efﬁciency of symbolic methods with the accuracy and generalization of data-driven approaches, using statistical inference of unobserved object properties and symbolic learning of physical force laws. In BSP, we model the evolution of the environment’s dynamics over time as a generative program of entities interacting under Newtonian mechanics. As a probabilistic method,
BSP treats the properties of entities, such as mass and charge, as random variables. Since Newtonian force laws are functions of these properties, in BSP we replace data-hungry NNs with symbolic regression (SR) to learn explicit force expressions, and then evolve them deterministically using equations of motion. A naive SR implementation here is not enough though due to two issues. One is that if it operates on a vanilla grammar that does not constrain the search space over force-laws, it can potentially have worse data-efﬁciency than a NN. Therefore, we introduce a grammar of Newtonian physics that leverages dimensional analysis to induce a physical unit system over the search space and impose physics-based constraints on the production rules. This prunes physically meaningless laws, therefore, drastically speeding up SR. Another issue is that the symbolic force expressions usually contain global constants, e.g. the gravitational constant, to learn, and common ways to deal with this challenge turn out to be inefﬁcient especially in an EM setup. We tackle this challenge by using SR in a bilevel optimization framework in which a lower-level gradient based optimization step is used to optimize the constant. In short, our three main contributions are:
•
•
•
We introduce a Bayesian-symbolic model for physical dynamics and an EM based algorithm, which combines approximate inference methods and SR, for maximum likelihood learning.
We introduce a grammar of Newtonian physics that appropriately constrains SR for data-efﬁcient learning, based on priors from dimensional analysis and physics-based constraints.
Empirically, we show that BSP reaches human-like data-efﬁciency, often requiring just 1 to 5 synthetic scenes to learn the underlying force laws – much more data efﬁcient than the closest neural alternatives. We then illustrate how BSP can discover physical laws from real-world common sense scenes from Wu et al. (2016). Finally, we study BSP on tasks previously used to study human phys-ical reasoning in Ullman et al. (2018) and discuss the similarity and differences with human results. 2