Abstract
Identifying an effective model of a dynamical system from sensory data and using it for future state prediction and control is challenging. Recent data-driven algorithms based on Koopman theory are a promising approach to this problem, but they typically never update the model once it has been identiﬁed from a relatively small set of observations, thus making long-term prediction and control difﬁcult for realistic systems, in robotics or ﬂuid mechanics for example. This paper introduces a novel method for learning an embedding of the state space with linear dynamics from sensory data. Unlike previous approaches, the dynamics model can be updated online and thus easily applied to systems with non-linear dynamics in the original conﬁguration space. The proposed approach is evaluated empirically on several classical dynamical systems and sensory modalities, with good performance on long-term prediction and control. 1

Introduction 1.1 Context and motivation
Providing complex machines such as robots with the capacity of learning effective models of their dynamics from their physical interactions with the world is a key enabling factor for deploying them outside of laboratories and factories. Analytical models of these interactions through state-based representations are traditionally derived from physical principles and used to solve challenging problems in various domains. They have been successfully deployed on heterogeneous systems such as robots or aircrafts/spacecrafts. Through the prism of control theory, these analytical models enable engineers to characterize and study the intrinsic dynamical properties of systems (contraction, stability, etc.), which are essential for system comprehension and for critical applications. In this context, optimal control theory [1] and its online counterpart known as model predictive control [2], exploit these models to plan and control complex dynamical systems (robots, rockets, etc.). Yet, the physical interactions of machines with the world are subject to complex natural phenomena, hardly describable by closed-form mathematical models.
By leveraging recent progress in machine learning, data-driven approaches [3, 4] have emerged as an effective way of learning advanced models of complex physical phenomena such as turbulence in
ﬂuid mechanics [3, 5, 6]. In particular, the Koopman formalism [7] is an attractive and versatile math-ematical framework to learn and analyse complex dynamics. The overall objective of this formalism is to map the intrinsic state space of the system to a typically inﬁnite-dimensional vector space where the system dynamics evolve linearly. However, exhibiting such a map remains challenging, especially in the context of instrumented systems such as robots, which evolve in the world by exploiting their 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
sensory input. The sensory inputs used to build a representation of the internal state of the system and the world may be of various nature: images and force, temperature values or encoder readings, etc. Importantly, to be effective for real-world applications such as the control of robotic systems, learned dynamical representations should also offer online update capacities, to account for new measurements as they come, which is essential to get long-term accurate prediction capacities in changing environments, and update the internal dynamics model accordingly. 1.2