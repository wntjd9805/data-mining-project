Abstract
Vehicle routing problems (VRPs) form a class of combinatorial problems with wide practical applications. While previous heuristic or learning-based works achieve decent solutions on small problem instances, their performance deteriorates in large problems. This article presents a novel learning-augmented local search framework to solve large-scale VRP. The method iteratively improves the solution by identifying appropriate subproblems and delegating their improvement to a black box subsolver. At each step, we leverage spatial locality to consider only a linear number of subproblems, rather than exponential. We frame subproblem selection as regression and train a Transformer on a generated training set of problem instances. Our method accelerates state-of-the-art VRP solvers by 10x to 100x while achieving competitive solution qualities for VRPs with sizes ranging from 500 to 3000. Learned subproblem selection offers a 1.5x to 2x speedup over heuristic or random selection. Our results generalize to a variety of VRP distributions, variants, and solvers. 1

Introduction
Vehicle routing problems (VRPs) have enjoyed ample applications in logistics and ride-hailing services [23] around the world for decades. While determining the optimal solution to a VRP is
NP-hard [25], there have been numerous attempts to solve VRPs both exactly and approximately: provable algorithms have been designed for speciﬁc problem instances up to size 130 [28], and powerful heuristic solvers such as LKH-3 [13] and HGS [49, 48] ﬁnd good solutions in practice for problems of size more than 1000. However, heuristics methods often suffer from inﬂexibility due to extensive hand-crafting and the heavy computational burden from lengthy iterative procedures, as in the case of LKH-3. For example, LKH-3 takes more than an hour to solve a size 2000 CVRP instance (Table 1), which is impractical for applications such as large-scale courier or municipal services.
More recently, machine learning methods inspired by the Pointer Network [50] provide alternatives to traditional solvers: the learning-based methods greatly reduce computation time while maintaining decent solution quality on small problem instances (less than 100 cities), by training on diverse sets of problem distributions either via supervised [50] or reinforcement learning [29, 20]. However, these methods remain difﬁcult to scale, and few report results on problems of size more than 200.
Our work aims to address scalability by learning to identify smaller subproblems which can be readily solved by existing methods. Our learned subproblem selector guides the problem-solving process to focus local improvement on promising subregions. While there exists a combinatorial number
⇤Equal Contribution 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
of subproblems that can be selected at each step, we leverage spatial locality commonly found in combinatorial optimization problems to restrict the selection space size to be linear in the problem size. Intuitively, objects far away from each other generally have very small inﬂuence on each other’s solution and are likely to be in different routes, so they should not be part of the same subproblem.
The greatly reduced search space enables us to feasibly train an attention-based subproblem selector.
Our framework combines the advantages of learning and heuristics: our network identiﬁes promising subproblems to improve upon, dramatically speeding up solution times. Using a competitive subsolver on subproblems, we achieve good solution quality without the high computational costs of running the subsolver on large problem instances. In summary, our contributions are:
• We propose learning-to-delegate, a learning-based framework for solving large-scale VRPs by iteratively identifying and solving smaller subproblems.
• Despite the high dimensionality and NP-hardness of subproblems, we design a Transformer architecture that effectively predicts the subsolver’s solution quality for a subproblem.
• With extensive validation, we show that learning-to-delegate offers signiﬁcant speedups and/or objective improvements over both its base subsolver and random (or heuristic) subproblem selection, for a variety of VRP variants, distributions, and solvers. 2 Preliminary: Capacitated Vehicle Routing Problems (CVRP)
In CVRP, there is a depot node 0 and city nodes
. Each city node i has demand di to fulﬁll.
}
A vehicle with capacity C starts and ends at the depot and visits a route of city nodes such that the sum of city demands along the route does not exceed C, after which the vehicle starts a new route again. The objective is to ﬁnd a valid solution minimizing the solution cost. We deﬁne the following: 1, ..., N
{
• Route: a sequence of nodes, where the ﬁrst and last node are the depot 0, and the rest are city nodes. In a valid route, the sum of demands of the city nodes does not exceed C.
• Route cost: the sum of edge costs for the sequence of nodes. For an edge from node i to node j, the edge cost is the Euclidean distance between node i and j.
• Solution: a feasible solution consists of a set of valid routes visiting each city exactly once.
• Solution cost: the sum of route costs for all routes in the solution. An optimal solution is a feasible solution with the minimum solution cost.
• Subproblem: a CVRP consisting of the depot, a subset of cities, and corresponding demands. 3