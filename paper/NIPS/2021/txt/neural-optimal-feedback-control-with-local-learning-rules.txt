Abstract
A major problem in motor control is understanding how the brain plans and executes proper movements in the face of delayed and noisy stimuli. A prominent framework for addressing such control problems is Optimal Feedback Control (OFC). OFC generates control actions that optimize behaviorally relevant criteria by integrating noisy sensory stimuli and the predictions of an internal model using the Kalman
ﬁlter or its extensions. However, a satisfactory neural model of Kalman ﬁltering and control is lacking because existing proposals have the following limitations: not considering the delay of sensory feedback, training in alternating phases, and requiring knowledge of the noise covariance matrices, as well as that of systems dynamics. Moreover, the majority of these studies considered Kalman ﬁltering in isolation, and not jointly with control. To address these shortcomings, we introduce a novel online algorithm which combines adaptive Kalman ﬁltering with a model free control approach (i.e., policy gradient algorithm). We implement this algorithm in a biologically plausible neural network with local synaptic plasticity rules. This network performs system identiﬁcation and Kalman ﬁltering, without the need for multiple phases with distinct update rules or the knowledge of the noise covariances. It can perform state estimation with delayed sensory feedback, with the help of an internal model. It learns the control policy without requiring any knowledge of the dynamics, thus avoiding the need for weight transport. In this way, our implementation of OFC solves the credit assignment problem needed to produce the appropriate sensory-motor control in the presence of stimulus delay. 1

Introduction
The sensorimotor control system has exceptional abilities to perform fast and accurate movements in a variety of situations. To achieve such skillful control, this system faces two key challenges: (i) sensory stimuli are noisy, making estimation of current state of the system difﬁcult, and (ii) sensory stimuli is often delayed, which if unaccounted, results in movements that are inaccurate and unstable
[1]. Optimal Feedback Control (OFC) has been proposed as a solution to this control problem [2, 3].
OFC approaches these problems by building an internal model of the system dynamics, and using 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
this internal model to generate control actions. OFC often employs Kalman ﬁltering to optimally integrate the predictions of this internal model and the noisy/delayed sensory stimuli.
Because of the power and ﬂexibility of the OFC framework, biologically plausible neural architectures capable of building such internal models has been under active investigation. Speciﬁcally, earlier works used attractor dynamics implemented through a recurrent basis function network [4] or a line attractor network [5] to implement Kalman ﬁlters. Kalman ﬁltering and control has also been implemented through different phases of estimation, system identiﬁcation and control [6], and more recently, using a particle ﬁltering method for Kalman ﬁltering [7].
Nonetheless, these works suffer from major limitations. Importantly, none of these considered that sensory feedback is delayed [4, 6, 5, 7, 8], although it has been prominent in the original computational-level OFC proposal [2], or merely considered the case of Kalman ﬁltering, and not the combination of it with control [4, 5, 7, 8]. These works also required knowledge of the noise covariances, either a priori [4, 5, 7, 8] or obtained in a separate ‘ofﬂine sensor’ mode [6]. Moreover, many of these works lack biological plausibility and realism one would expect from a viable model of brain function [4, 5, 7, 8]. Crucially, biological plausibility requires the network to operate online, (i.e. receive a stream of noisy measurement data and process them on the ﬂy), and also requires synaptic plasticity rules to be local (i.e. learn using rules that only depend on variables represented in pre and postsynaptic neurons and/or on global neuromodulatory signals). Lastly, several of these models suffer from combinatorial explosion as the dimensionality of the input grows [4, 5], require running an inner loop until convergence at each time step [8, 6], or require separate learning and execution phases [6], cf. Table 1.
We address these shortcomings and present a complete neural implementation of optimal feedback control, thus tackling an open issue in biological control [9]. In this model, which we call Bio-OFC, the state space, the prediction error [10, 11] (i.e., the mismatch between the network’s internal prediction and delayed sensory feedback), and the control are represented by different neurons, cf.
Fig. 1. The network also receives scalar feedback related to the objective function, as a global signal, and utilizes this signal to update the synaptic connection according to policy gradient method [12, 13].
To test the performance of our network, we simulate Bio-OFC in episodic (ﬁnite horizon) tasks (e.g., a discrete-time double integrator model, a hand reaching task [1], and a simpliﬁed ﬂy simulation).
Summary of contributions:
• We introduce Bio-OFC, a biologically plausible neural network that combines adaptive model based state discovery via adaptive Kalman ﬁltering with a model free control agent.
• Our implementation does not require knowledge of noise covariances nor the system dy-namic, considers delayed sensory feedback, and has no separate learning/execution phases.
• Our model-free control agent enables closed-loop control, thus avoiding the weight transport problem, a challenging problem even in non-biological control. [14, 15]
Table 1: Limitations of previously proposed neural implementations of OFC. Presence or absence of different properties in previously proposed neural models, and their comparison to Bio-OFC. Guide to symbols: (cid:51): true, (cid:55): false, (cid:51)(cid:55): partially true, N/A: not applicable. delayed sensory feedback control included noise covariance agnostic online system identiﬁcation local learning rules tractable latent size absence of inner loop single phase learning/execution
[8] Bio-OFC
[7]
[5]
[6]
[4] (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) (cid:55) (cid:51) (cid:51)(cid:55) (cid:55) (cid:55) (cid:51) (cid:51) (cid:55)
N/A (cid:51) N/A (cid:51) (cid:51) (cid:55) (cid:51) (cid:55) (cid:55) (cid:51) (cid:55) (cid:51) (cid:51) (cid:51)
N/A (cid:51) (cid:55) (cid:51) (cid:51) (cid:51) (cid:51) (cid:51) (cid:51) (cid:51) (cid:51)
N/A 2
Figure 1: The circuit and learning rules of the Bio-OFC algorithm. Our circuit is comprised of two main parts. First (in blue), the circuit performs Kalman ﬁltering. Then (in red), the circuit performs control using policy gradients with eligibility traces. Triangular arrowheads denote synaptic connections and the ﬂat arrowhead denotes the modulatory effect of the cost signal. 2