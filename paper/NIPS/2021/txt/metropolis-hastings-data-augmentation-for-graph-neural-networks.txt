Abstract
Graph Neural Networks (GNNs) often suffer from weak-generalization due to sparsely labeled data despite their promising results on various graph-based tasks.
Data augmentation is a prevalent remedy to improve the generalization ability of models in many domains. However, due to the non-Euclidean nature of data space and the dependencies between samples, designing effective augmentation on graphs is challenging. In this paper, we propose a novel framework Metropolis-Hastings
Data Augmentation (MH-Aug) that draws augmented graphs from an explicit target distribution for semi-supervised learning. MH-Aug produces a sequence of aug-mented graphs from the target distribution enables ﬂexible control of the strength and diversity of augmentation. Since the direct sampling from the complex target distribution is challenging, we adopt the Metropolis-Hastings algorithm to obtain the augmented samples. We also propose a simple and effective semi-supervised learning strategy with generated samples from MH-Aug. Our extensive experiments demonstrate that MH-Aug can generate a sequence of samples according to the target distribution to signiﬁcantly improve the performance of GNNs. 1

Introduction
Graph Neural Networks (GNNs) [1] have been widely used for representation learning on graph-structured data due to their superior performance in various applications such as node classiﬁcation [2– 4], link prediction [5–7] and graph classiﬁcation [8, 9]. They have been proven effective by achieving impressive performance for diverse datasets such as social networks [10], citation networks [4], physics [11], molecules [12], and knowledge graphs [10]. However, GNNs often suffer from weak-generalization due to their small and sparsely labeled graph datasets. One prevalent remedy to address the problem is data augmentation. Data augmentation increases the diversity of data and improves the generalization power of machine learning models trained on randomly augmented samples. It is widely used to enhance the generalization ability of models in many domains. For instance, in image recognition, advanced methods like [13–15] as well as simple transformations such as random cropping, cutout, Gaussian noise, or blurring have been used to achieve competitive performance.
However, unlike image recognition, designing effective and label-preserving data augmentation for individual samples on graphs is challenging due to their non-Euclidean nature and the dependencies between data samples. In image recognition, it is straightforward to identify operations that preserve labels. For instance, human can verify that rotation, translation, and small color jittering do not change the labels in image classiﬁcation. In contrast, graphs are less interpretable and it is non-trivial
∗First two authors have equal contribution
†is the corresponding author 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
for even human to check whether the augmented samples belong to the original class or not. In addition, due to the dependencies between nodes and edges in a graph, it is hard to control the degree of augmentation for individual samples. For instance, a simple operation on a graph, e.g., dropping a node, may result in a completely different degree of augmentation depending on the graph structure. If a hub node is removed, the single perturbation affects a substantial amount of other nodes, which are data samples in node classiﬁcation. To address these challenges, learning-based data augmentation methods for graphs have been proposed. AdaEdge [16] optimizes the graph topology based on the model prediction. [17] proposes GAug-M and GAug-O that generate augmented graphs via a differentiable edge predictor. GraphMix [18] presents interpolation-based regularization by jointly train a fully connected network and graph neural networks. However, they require additional models for augmentation and more importantly do not explicitly guarantee that augmentation has a proper strength and diversity.
In this paper, we proposed a novel framework called Metropolis-Hastings Data Augmentation (MH-Aug) that draws augmented graphs from an ‘explicit’ target distribution with the desired strength and diversity for semi-supervised learning. Since the direct sampling from the complex distribution is challenging, we adopt the Metropolis-Hastings algorithm to obtain the augmented samples. Re-cently, the importance of leveraging unlabeled data as well as adopting advanced augmentation has emerged [19, 20]. Inspired by that, we also adopt the consistency training by utilizing the regularizers for unlabeled data. Our extensive experiments demonstrate that MH-Aug can generate a sequence of samples according to the desired distribution and be combined with the consistency training and it signiﬁcantly improves the performance of graph neural networks.
Our contributions are summarized as follows:
• We proposed a novel framework Metropolis-Hastings Data Augmentation that draws aug-mented samples from an ‘explicit’ target distribution. To the best of our knowledge, this is the ﬁrst work that studies data augmentation for graph-structured data from a perspective of a Markov chain Monte Carlo sampling.
• We theoretically and experimentally prove that our MH-Aug generates the augmented samples according to the desired distribution with respect to the strength and diversity.
• We propose a target distribution that ﬂexibly controls the strength and diversity of augmen-tation. This includes an efﬁcient way to measure the strength of augmentation reﬂecting the structural changes of ego-graphs (or samples in node classiﬁcation).
• Lastly, we propose a simple and effective semi-supervised learning strategy leveraging sequentially generated samples from our method. 2