Abstract
In recent years, the ML community has seen surges of interest in both adversarially robust learning and implicit layers, but connections between these two areas have seldom been explored. In this work, we combine innovations from these areas to tackle the problem of N-k security-constrained optimal power ﬂow (SCOPF).
N-k SCOPF is a core problem for the operation of electrical grids, and aims to schedule power generation in a manner that is robust to potentially k simultaneous equipment outages. Inspired by methods in adversarially robust training, we frame
N-k SCOPF as a minimax optimization problem – viewing power generation settings as adjustable parameters and equipment outages as (adversarial) attacks – and solve this problem via gradient-based techniques. The loss function of this minimax problem involves resolving implicit equations representing grid physics and operational decisions, which we differentiate through via the implicit function theorem. We demonstrate the efﬁcacy of our framework in solving N-3 SCOPF, which has traditionally been considered as prohibitively expensive to solve given that the problem size depends combinatorially on the number of potential outages. 1

Introduction
Robust optimization problems are pervasive across many applications and domains – such as electric power systems, supply chain management, and civil engineering – where the goal is to construct some solution that is robust under any allowable instantiation of uncertainty [1, 2]. While the aim is generally that these solutions be provably robust, there unfortunately remain many settings where it is either not easy or not possible to construct such solutions. This has often motivated the use of heuristic approaches. For instance, many approaches in adversarially robust deep learning formulate neural network training as a minimax game over neural network parameters and input perturbations, optimizing this problem via gradient-based techniques that do not yield provable robustness guarantees, but are nonetheless effective in practice [3].
In this work, we draw inspiration from adversarially robust training to address the problem of
N-k security-constrained optimal power ﬂow (SCOPF). N-k SCOPF is a fundamental problem to schedule power generation in a way that is robust to k potential equipment failures (e.g., generator or line outages). Unfortunately, N-k SCOPF is prohibitively expensive to solve at scale, leading grid operators to use rough approximations in practice. To address this challenge, we frame N-k SCOPF as a minimax attacker-defender problem, where the “defender” aims to schedule power generation, and the “attacker” aims to pick adversarial equipment failures. The loss function of this problem requires solving implicit equations representing the physics of the electric grid as well as additional operational decisions that are made after an attack has occurred. As such, we optimize this problem using gradient-based techniques, and employ insights from the literature on implicit differentiation and implicit layers to cheaply compute gradients through the loss function.
⇤These authors contributed equally. 35th Conference on Neural Information Processing Systems (NeurIPS 2021).
Our key contributions are:
•
•
•
Formulation for minimax optimization with implicit variables. To streamline the pre-sentation of concepts, we provide a generic formulation for gradient-based optimization of minimax problems with implicitly-deﬁned variables. While our main focus in this paper is on N-k SCOPF, we believe this generic formulation may also be of broader interest for minimax settings with physics in the loop, as well as for tri-level optimization settings.
Formulation for gradient-based optimization of N-k SCOPF. We rewrite N-k SCOPF as a continuous minimax optimization problem, and demonstrate how to efﬁciently compute gradients through relevant implicit components. We also utilize the underlying structure of our optimization solvers to further streamline the outer minimization procedure. Importantly, the per-iteration cost of this approach is agnostic to the number of simultaneous outages k, despite the combinatorial blowup in the number of associated “contingency scenarios.”
Demonstration on N-1, N-2, and N-3 SCOPF. We demonstrate the efﬁcacy of our method in addressing SCOPF settings that allow for one, two, or three simultaneous outages on a realistic 4622-node power system with over 38 billion potential N-3 outage scenarios. We
ﬁnd that our method incurs 3-4 fewer N-3 feasibility violations than a baseline optimal power ﬂow approach, and requires only 21 minutes to run on a standard laptop.
⇥ 2