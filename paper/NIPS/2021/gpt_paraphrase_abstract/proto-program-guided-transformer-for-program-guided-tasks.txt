In order to facilitate communication between humans and agents, programs that contain semantic and structural information are crucial. To achieve a unified approach for perception, reasoning, and decision making, we introduce program-guided tasks that involve learning to execute a given program based on observed task specifications. To address this, we propose Program-GuidedTransformer (ProTo), which combines semantic and structural guidance by utilizing cross-attention and masked self-attention to exchange information between the task specifications and program routines. ProTo operates within a learned latent space, resulting in more powerful representation capabilities compared to previous neural-symbolic methods. Our experiments demonstrate that ProTo significantly outperforms existing state-of-the-art techniques on GQA visual reasoning and 2D Minecraft policy learning datasets. Moreover, ProTo exhibits improved generalization to unseen, complex, and human-written programs.