This paper introduces a new method called ROADMAP for evaluating image retrieval systems. Existing evaluation metrics, such as average precision (AP), rely on score ranking but face challenges in training deep neural networks due to non-differentiability and non-decomposability. ROADMAP addresses these challenges by proposing a differentiable approximation of the rank function, ensuring robust training, and designing a simple yet effective loss function to reduce the decomposability gap. Experimental results on three image retrieval datasets demonstrate that ROADMAP outperforms other AP approximation methods and achieves state-of-the-art performance. The code and instructions to reproduce the results are publicly available at https://github.com/elias-ramzi/ROADMAP.