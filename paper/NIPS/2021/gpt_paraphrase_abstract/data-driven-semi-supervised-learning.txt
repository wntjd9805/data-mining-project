We propose a new approach to designing semi-supervised learning algorithms that can effectively learn with only a small number of labeled examples. Our focus is on graph-based techniques, where unlabeled examples are connected in a graph based on the assumption that similar nodes have similar labels. While previous graph-based algorithms have been proposed, the problem of creating the graph has been left to heuristics and domain-specific art, lacking general principles. In this study, we introduce a data-driven approach to learn the graph and provide formal guarantees in both distributional and online learning contexts. By leveraging problem instances from the same domain, we learn the graph hyperparameters for commonly used graph families that perform well on new instances. Our approach achieves low regret and efficiency in the online setting, as well as generalization guarantees in the distributional setting. We also demonstrate the ability to combine different similarity metrics and learn multiple hyperparameters, applicable to a wide range of problems. The tools and techniques developed in this work have potential application in data-driven algorithms more broadly.