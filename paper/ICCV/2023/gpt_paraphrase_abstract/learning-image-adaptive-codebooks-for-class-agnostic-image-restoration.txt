Recent advancements in discrete generative priors, specifically codebooks, have shown promising results in image reconstruction and restoration. By expanding the discrete prior space covered by codebooks, these methods have enhanced the robustness against various image degradations. However, the existing approaches require separate training of codebooks for different image categories, limiting their applicability to specific categories like faces or architecture. Moreover, they struggle to handle arbitrary natural images.In this study, we propose a novel approach called AdaCode, which addresses these limitations. Instead of learning a single codebook for each image category, AdaCode learns a collection of basis codebooks. When presented with an input image, AdaCode learns a weight map and computes a weighted combination of the basis codebooks. This enables adaptive image restoration tailored to the specific characteristics of the input image. In essence, AdaCode offers greater flexibility and expressiveness as a discrete generative prior compared to previous methods.To evaluate the performance of AdaCode, we conducted experiments on various image reconstruction and restoration tasks, such as image super-resolution and inpainting. The results demonstrate that AdaCode achieves state-of-the-art performance in these tasks. We have made the source code available at https://github.com/kechunl/AdaCode.