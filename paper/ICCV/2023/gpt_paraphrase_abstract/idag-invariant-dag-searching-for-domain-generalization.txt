Current machine learning models often struggle in open environments due to shifts in data distribution. Domain generalization aims to find consistent patterns for accurate predictions across different domains. This study identifies the insufficient identification of causal structures as the reason for the failure of conventional machine learning models in domain generalization. To address this issue, the researchers propose a new framework called iDAG (invariant Directed Acyclic Graph) that searches for an invariant graphical relation as a proxy for the causality structure in the data-generating process. iDAG uses a constrained optimization objective based on representative class-conditional prototypes to enable efficient computation. In addition, a hierarchical contrastive learning module is integrated to improve prototypes and enhance prediction stability. Extensive experiments on synthetic and real-world datasets demonstrate that iDAG surpasses existing approaches, highlighting the importance of causal structure identification in domain generalization. The code for iDAG is publicly available at https://github.com/lccurious/iDAG.