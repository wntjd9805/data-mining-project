This study focuses on the limitations of low-resolution hyperspectral images (HSIs) and proposes a novel approach called HSR-Diff, which utilizes deep generative models to enhance the resolution of HSIs. HSR-Diff combines a high-resolution multispectral image (MSI) with the corresponding low-resolution HSI to generate a high-resolution HSI through a process of repeated refinement. The refinement is achieved by removing noise using a Conditional Denoising Transformer (CDFormer), which is trained on denoising at different noise levels and conditioned on the hierarchical feature maps of the high-resolution MSI and low-resolution HSI. Additionally, a progressive learning strategy is employed to incorporate global information from full-resolution images. Experimental results on four public datasets demonstrate that HSR-Diff outperforms existing state-of-the-art methods in hyperspectral image super-resolution.