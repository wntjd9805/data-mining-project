We propose a novel approach called the minimal path method for simultaneously segmenting tubular structures with line-topology and extracting their centerlines. Minimal path methods are commonly used for segmenting tubular structures in various applications. Recent methods utilize features extracted by convolutional neural networks (CNNs) and often outperform methods that use manually engineered features. However, CNN-based methods may generate inappropriate training samples that differ significantly from samples encountered during inference. To address this issue, we introduce an iterative training scheme that generates better training samples specifically tailored for the minimal path methods without altering existing annotations. Unlike previous approaches, our method determines segmentation masks and centerlines simultaneously rather than sequentially through post-processing. Additionally, our method achieves state-of-the-art results for both segmentation masks and centerlines with minimal reliance on annotated training images. Comparative evaluations with seven previous approaches on three public datasets, including satellite and medical images, demonstrate the superior performance of our method.