Abstract
We present a novel framework to bootstrap Motion fore-castIng with Self-consistent Constraints (MISC). The mo-tion forecasting task aims at predicting future trajectories of vehicles by incorporating spatial and temporal informa-tion from the past. A key design of MISC is the proposed
Dual Consistency Constraints that regularize the predicted trajectories under spatial and temporal perturbation during training. Also, to model the multi-modality in motion fore-casting, we design a novel self-ensembling scheme to obtain accurate teacher targets to enforce the self-constraints with multi-modality supervision. With explicit constraints from multiple teacher targets, we observe a clear improvement in the prediction performance. Extensive experiments on the Argoverse motion forecasting benchmark and Waymo
Open Motion dataset show that MISC signiﬁcantly outper-forms the state-of-the-art methods. As the proposed strate-gies are general and can be easily incorporated into other motion forecasting approaches, we also demonstrate that our proposed scheme consistently improves the prediction performance of several existing methods. 1.

Introduction
Motion forecasting has been a crucial task for self-driving vehicles that aims at predicting the future trajec-tories of agents (e.g., cars, pedestrians) involved in traf-ﬁc. The predicted trajectories can further help self-driving vehicles plan their future actions and avoid potential acci-dents. Since the future is not deterministic, motion forecast-ing is intrinsically a multi-modal problem with substantial uncertainties. This implies that an ideal motion forecasting method should produce a distribution of future trajectories or at least multiple most likely ones.
Due to the inherent uncertainty, motion forecasting re-mains challenging and unsolved yet. Recently, researchers have proposed different architectures based on various rep-resentations to encode the kinematic states and context in-formation from HDMap in order to generate feasible multi-*Work done during an internship at DeepRoute.AI. modal trajectories [2, 7, 15, 18, 28, 29, 36, 51, 55, 56, 58].
These methods follow a traditional static training pipeline, where frames of each scenario are split into historical frames (input) and future frames (ground truth) in a ﬁxed pattern. Nevertheless, the prediction task is a streaming task in real-world applications, where the current state will become a historical state as time goes by, and the buffer of the historical state is a queue structure to make succes-sive predicted trajectories. As a result, temporal consis-tency thus becomes a crucial requirement for the down-stream tasks for fault and noise tolerance. To tackle this issue, trajectory stitching is widely applied in traditional planning algorithms [13] to ensure stability along the tem-poral horizon. However, as the trajectory stitching opera-tion is non-differentiable, it cannot be easily incorporated into learning-based models. Though deep-learning-based models show unprecedented motion prediction performance compared with traditional counterparts, they do not explic-itly consider temporal consistency, leading to unstable be-haviors in downstream tasks such as planning.
Inspired by these phenomena, we raise a question: can we explicitly enforce consistency when training a deep mo-tion prediction model? On the one hand, the predicted tra-jectories should be consistent given the successive inputs along the temporal horizon, namely temporal consistency.
On the other hand, the predicted trajectories should be sta-ble and robust against small spatial noise or disturbance, namely spatial consistency.
In this work, we propose a self-supervised scheme, named as MISC, to enforce con-sistency constraints in both spatial and temporal domains, namely Dual Consistency Constraints. Dual Consistency
Constraints could be viewed as an inner-model consistency and can signiﬁcantly improve the quality and robustness of motion forecasting, without the need for extra data.
On top of the inner-model consistency, we also exploit the intra-model consistency. Multi-modality is another core characteristic of the motion prediction task. Existing datasets [9, 49] only provide a single ground-truth trajectory for each scenario, which can not satisfy multi-choice situ-ations such as junction scenarios. Most methods adopt the winner-takes-all (WTA) [26] or its variants [4, 35] to allevi-ate this situation. However, WTA tends to produce confused
predictions when two trajectories are very close. In contrast, our method addresses the multi-modality problem by using more robust teacher targets obtained from self-ensembling, which leverages intra-model consistency. Multiple teacher targets can be viewed as a special kind of intra-model distil-lation while alleviating the problem of multi-modality. Our contributions are summarized as follows,
• We propose self-consistent constraints in both intra and inner model aspects.
• For the inner-model consistency, Dual Consistency
Constraints are proposed to enforce temporal and spa-tial consistency in our model, which is shown to be a general and effective way to improve the overall per-formance in motion forecasting.
• For the intra-model consistency constraints, a self-ensembling constraint is explicitly exploited to enforce self-consistency with teacher targets, which provides multi-modality supervision for training.
• Extensive experiments on the Argoverse [9] mo-tion forecasting benchmark and Waymo Open Motion dataset [12] show that the proposed approach achieves state-of-the-art performance. 2.