Abstract
Convolutional Neural Networks (CNN) are known to exhibit poor generalization performance under distribu-tion shifts. Their generalization have been studied ex-tensively, and one line of work approaches the problem from a frequency-centric perspective. These studies high-light the fact that humans and CNNs might focus on differ-ent frequency components of an image. First, inspired by these observations, we propose a simple yet effective data augmentation method HybridAugment that reduces the re-liance of CNNs on high-frequency components, and thus improves their robustness while keeping their clean accu-racy high. Second, we propose HybridAugment++, which is a hierarchical augmentation method that attempts to unify various frequency-spectrum augmentations. HybridAug-ment++ builds on HybridAugment, and also reduces the re-liance of CNNs on the amplitude component of images, and promotes phase information instead. This unification re-sults in competitive to or better than state-of-the-art results on clean accuracy (CIFAR-10/100 and ImageNet), corrup-tion benchmarks (ImageNet-C, CIFAR-10-C and CIFAR-100-C), adversarial robustness on CIFAR-10 and out-of-distribution detection on various datasets. HybridAugment and HybridAugment++ are implemented in a few lines of code, does not require extra data, ensemble models or ad-ditional networks 1. 1.

Introduction
The last decade witnessed machine learning (ML) ele-vating many methods to new heights in various fields. De-spite surpassing human performance in multiple tasks, the generalization of these models are hampered by distribu-tion shifts, such as adversarial examples [54], common im-age corruptions [21] and out-of-distribution samples [62]. 1Our code is available at https://github.com/MKYucel/ hybrid_augment.
Addressing these issues are of paramount importance to fa-cilitate the wide-spread adoption of ML models in practi-cal deployment, especially in safety-critical ones [46, 11], where such distribution shifts are simply inevitable.
Distribution shift-induced performance drops signal a gap between how ML models and us humans perform per-ception. Several studies attempted to bridge, or at least un-derstand, this gap from architecture [2, 63, 48] and train-ing data [21, 57, 29, 7, 39, 4, 22] centric perspectives. An interesting perspective is built on the frequency spectra of the training data; convolutional neural networks (CNN) are shown to leverage high-frequency components that are in-visible to humans [56] and also shown to be reliant on the amplitude component, as opposed to the phase component humans favour [7]. Several studies leveraged frequency spectra insights to improve model robustness. These meth-ods, however, either leverage cumbersome ensemble mod-els [48], formulate complex augmentation regimes [52, 34] or focus on a single robustness venue [33, 52, 34] rather than improving the broader robustness to various distribu-tion shifts. Furthermore, it is imperative to preserve, if not improve, the clean accuracy levels of the model while im-proving its robustness.
Our work aims to improve the robustness of CNNs to various distribution shifts. Inspired by the frequency spec-tra based data augmentations, we propose HybridAugment, inspired from the well-known hybrid images [45]. Based on the observation that the label information of images are predominantly related to the low-frequency components
[58, 31], HybridAugment simply swaps high-frequency and low-frequency components of randomly selected images in a batch, regardless of their class labels. This forces the net-work to focus on the low-frequency information of images and makes the models less reliant on the high-frequency in-formation, which are often shown to be the root cause of robustness issues [58]. With virtually no training overhead,
HybridAugment improves the corruption robustness while preserving or improving the clean accuracy, and addition-ally induces adversarial robustness.
Figure 1. An overview of our methods HybridAugment (HA) and HybridAugment++ (HA++), and their single image (S ) and paired (P )
++ variants. HAP combines the high-frequency (HF) and low-frequency (LF) contents of two randomly selected images, whereas HAP combines the HF of one image with the amplitude and LF-phase mixtures of two other images. Single image variants perform the same procedure, but based on different augmented versions of a single image.
Additionally, we set our eyes on jointly exploiting the contributions of frequency spectra augmentation methods while unifying them into a simpler, single augmentation regime. We then propose HybridAugment++, which per-forms hierarchical perturbations in the frequency spectra.
Exploiting the fact that the phase component carries most of the information in an image [7], HybridAugment++ first decomposes images into high and low-frequency compo-nents, swaps the amplitude and phase of the low frequency component with another image, and then combines this aug-mented low-frequency information with the high-frequency component of a random image. Essentially, HybridAug-ment++ forces the models to rely on the phase and the low-frequency information. As a result, HybridAugment++ fur-ther improves adversarial and corruption robustness, while further improving the clean accuracy against several alter-natives. See Figure 1 for a diagram of our methods.
Our main contributions can be summarized as follows.
• We propose HybridAugment, a simple data augmenta-tion method that helps models rely on low-frequency components of data samples. It is implemented in just three lines of code and has virtually no overhead.
• We extend HybridAugment and propose HybridAug-ment++, which performs hierarchical augmentations in frequency spectra to help models rely on low-frequency and phase components of images.
• We show that HybridAugment improves corruption ro-bustness of multiple CNN models, while preserving (or improving) the clean accuracy. We additionally observe clear improvements in adversarial robustness over strong baselines via HybridAugment.
• HybridAugment++ similarly outperforms many alter-natives by further improving corruption and clean ac-curacies on multiple benchmark datasets, with addi-tional gains in adversarial robustness. 2.