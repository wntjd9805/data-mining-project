Abstract
Pan-sharpening, a panchromatic image guided low-super-resolution task, spatial-resolution multi-spectral aims to reconstruct the missing high-frequency information of high-resolution multi-spectral counterpart. Although the inborn connection with frequency domain, existing pan-sharpening research has almost investigated the potential solution upon frequency domain, thus limiting the model performance improvement. To this end, we first revisit the degradation process of pan-sharpening in Fourier space, and then devise a Pyramid Dual Domain Injection Pan-sharpening Network upon the above observation by fully exploring and exploiting the distinguished information in both the spatial and frequency domains. Specifically, the proposed network is organized with multi-scale U-shape manner and composed by two core parts: a spatial guid-ance pyramid sub-network for fusing local spatial infor-mation and a frequency guidance pyramid sub-network for fusing global frequency domain information, thus encour-aging dual-domain complementary learning. In this way, the model can capture multi-scale dual-domain informa-tion to enable generating high-quality pan-sharpening re-sults. Quantitative and qualitative experiments over multi-ple datasets demonstrate that our method performs the best against other state-of-the-art ones and comprises a strong generalization ability for real-world scenes. 1.

Introduction
There is often a high demand for high-resolution mul-tispectral (HRMS) images in the domain of agricultural monitoring and mapping services. However, due to the limitations of satellite sensors, the existing approaches must instead separately capture high-resolution panchro-matic (PAN) and multispectral low-resolution (LRMS) im-ages and fuse them using a technique known as pan-*Co-first authors contributed equally, † Corresponding author.
Figure 1. Frequency domain analysis of multi-scale PAN, MS, and Ground Truth images. The amplitude, denoted by A, is dis-played for the original-scale image, the 2-times downsampled im-age, and the 4-times downsampled image, from top to bottom, re-spectively. The last two columns show the degradation of PAN and MS images relative to GT images. sharpening to get the desired HRMS images. Essentially, pan-sharpening is a super-resolution process that utilizes the richer details of PAN images to guide the reconstruc-tion process of LRMS images. Pan-sharpening technology has expanded the use of remote sensing images in a wider range and gained considerable attention.
Pan-sharpening has seen an increase in the use of deep learning-based techniques in recent years. The PNN [16], which started this trend, was motivated by the SRCNN [4] to introduce the convolutional neural network. The PNN presented a three-layer convolutional neural network that concatenated LRMS and PAN images as input and subse-quently generated the output through the network. Since then, a flood of deep learning-based techniques has been de-veloped to improve the model’s representation capacity by employing deeper models or model-driven techniques [33, 29, 7, 32]. While significant progress has been made, there are still limitations need to be addressed. Prior approaches have primarily focused on spatial domain solutions, thereby neglecting the exploration of frequency domain solutions.
Nevertheless, it has been established that CNNs in the spa-tial domain exhibit a preference for low-frequency informa-tion and struggle to capture high-frequency information [1], resulting in insufficient texture in the generated images [14].
However, by incorporating frequency domain information, high-frequency features in low-dimensional manifolds can be efficiently captured [20]. Additionally, the LRMS im-ages can be treated as degraded versions of HRMS images, which indicates that pan-sharpening is fundamentally an image restoration task. Image restoration are highly interre-lated with frequency domain, as image degradation and con-tent can be easily disentangled through the Fourier trans-form [9]. Thus, it is natural for us to investigate the fea-sibility of introducing frequency domain information into the pan-sharpening domain, as detailed in Figure 1 where the degradation effect of pan-sharpening is enlarged over multi-scale manner.
Motivation. We conducted multi-scale Fourier analysis on LRMS, PAN, and HRMS images since the degradation mostly affects the amplitude of the image and the diversity scale of remote sensing landforms has an effect on the pan-sharpening process. The analysis results of image spectrum is shown in the Figure 1. We can draw two inspirations from the figure: 1) The difference in amplitudes between the PAN and HRMS images is primarily in the low frequency com-ponent, whereas the difference between the amplitudes of the HRMS and LRMS images is observed in both the high and low frequency components. 2) As the scale decreases, we can observe the missing information in the PAN image becomes more concentrated in the low-frequency compo-nent, while the degradation of the LRMS image becomes more concentrated in the high frequency component, and the degradation of images at various scales is not exactly the same. We may deduce from observation 1 that the fre-quency information in the PAN image can be used to fill in the missing information of the LRMS image. For ob-servation 2, it is crucial to restore the information at sev-eral scales since the degradation is varied under multi-scale conditions. To encourage the learning of context informa-tion and multi-scale reconstruction, frequency domain in-formation should be handled at various scales. Additionally, we can encourage the interaction of global and local, low-frequency and high-frequency features through multi-scale processing in the spatial and frequency domains in accor-dance with CNN’s low-frequency preference in spatial do-main and the global receptive field described by the spectral convolution theorem [6] in frequency domain to enhance the model’s performance.
In light of the aforementioned observation, we pro-pose a brand new Pyramid Dual Domain Injection Network (PDDIN) to inject the multi-scale details of the PAN im-age into the LRMS image in both the spatial and frequency domains to aid in the restoration process. A Feature Ex-traction Pyramid, a Frequency Injection Pyramid, and a
Spatial Injection Pyramid compensate the three major key components of the network. The Feature Extraction Pyra-mid is responsible for extracting multi-scale feature infor-mation from the PAN image. By using these features, the
Frequency Injection Pyramid may inject global multi-scale features into the LRMS image, facilitating the recovery of global and high-frequency information in the spatial do-main. To promote the reconstruction of local and spatial information, the spatial domain feature of PAN images is injected into the LRMS image in the Spatial Injection Pyra-mid. This approach effectively compensates for degradation at various scales, leading to a more thorough and precise re-construction of the image. We conducted comprehensive experiments on multiple datasets to assess the effectiveness of our suggested network. The results show the efficacy of our method, by outperforming state-of-the-art techniques in both qualitative and quantitative evaluations.
Our contributions are summarized below:
• In this work, we revisit the degradation process of pan-sharpening in Fourier space, and then devise a Pyramid
Dual Domain Injection Pan-sharpening Network, in-spired by the above observation in both the spatial and frequency domains.
• To fully explore and exploit the distinguished informa-tion, we devised a frequency guidance pyramid sub-network and a spatial guidance pyramid sub-network.
This design allows for the fusion of multi-scale infor-mation from both the frequency and spatial domains, lifting the learning capability of the model.
• Extensive experiments on multiple satellite datasets demonstrate our approach’s quantitative and qual-itative superiority to existing state-of-the-art pan-sharpening algorithms. 2.