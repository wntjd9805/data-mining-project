Abstract
{yewen001}@e.ntu.edu.sg
{tongliang.liu}@sydney.edu.au
Human motion prediction is a classical problem in com-puter vision and computer graphics, which has a wide range of practical applications. Previous effects achieve great em-pirical performance based on an encoding-decoding style.
The methods of this style work by first encoding previous motions to latent representations and then decoding the la-tent representations into predicted motions. However, in practice, they are still unsatisfactory due to several issues, including complicated loss constraints, cumbersome train-ing processes, and scarce switch of different categories of motions in prediction. In this paper, to address the above issues, we jump out of the foregoing style and propose a novel framework from a new perspective. Specifically, our framework works in a masked completion fashion. In the training stage, we learn a motion diffusion model that gen-erates motions from random noise. In the inference stage, with a denoising procedure, we make motion prediction conditioning on observed motions to output more contin-uous and controllable predictions. The proposed frame-work enjoys promising algorithmic properties, which only needs one loss in optimization and is trained in an end-to-end manner. Additionally, it accomplishes the switch of different categories of motions effectively, which is signifi-cant in realistic tasks, e.g., the animation task. Comprehen-sive experiments on benchmarks confirm the superiority of the proposed framework. The project page is available at https://lhchen.top/Human-MAC. 1.

Introduction
The problem of Human Motion Prediction (HMP) fo-cuses on predicting possible future pose sequences from a sequence of observed motions [6, 16, 7, 20, 92, 84], which has a wide range of applications [83, 29, 90, 61, 45, 89, 87, 30, 99], e.g., autonomous driving [50] and healthcare [71].
This problem is complicated and challenging since the pre-dicted motions are always required to be continuous, di-verse, and realistic simultaneously [14].
*This project is led by Ling-Hao Chen and Xiaobo Xia jointly.
†Equal contribution.
‡Corresponding author. (a) encoding-decoding (b) masked completion (Ours)
Figure 1: Comparison between the encoding-decoding fashion and masked motion completion. (a) The methods in the encoding-decoding fashion encode the observation into a latent explicitly and then decodes the latent into prediction results. (b) The proposed motion diffusion model generates motions from noise in the training stage. In the inference stage, it treats HMP as a masked completion task.
Prior state-of-the-art methods work in an encoding-decoding fashion to tackle the HMP problem, which con-ditions on previous motion frames and predicts unobserved motions [61, 41, 8, 14, 82]. Technically, these methods first encode the previous motion frames to latent representations explicitly and then decode the latent representations into prediction results (see Figure 1a) [54, 75, 5, 22, 2].
Although these methods enjoy the good performance in some scenarios, they are still unsatisfactory in prac-(1) Most tice. We detail the issues from three aspects. state-of-the-art methods rely on multiple loss constraints for high-quality prediction results, e.g., the average pair-wise distance [4], final displacement error [19, 33], and adversarial loss [6, 20]. Consequently, they need care-fully designed hyper-parameters to balance different loss constraints, which makes it laborious for method applica-(2) Previous state-of-the-art methods need multi-tions. stage training [89, 5]. That is to say, the learning of the encoder/decoder and sampling in the latent space is per-formed in different stages. To make matters worse, com-plex pipelines always require an additional stage of engi-neering tuning. (3) For the methods, it is hard to realize the switch of different categories of motions, e.g., switch from
WalkDog to Sitting, which is pivotal for result diver-sity. The reason is that these methods are largely limited to observed motion sequences for prediction, which include few such switches.
In this paper, we get out of the encoding-decoding fash-ion and propose the MAsked motion Completion frame-work to handle the HMP problem (aka HumanMAC). To the best of our knowledge, this is the first time to tackle
HMP from the perspective of masked completion. Specif-ically, in the training stage, we integrate observed and pre-dicted motions, and learn a motion diffusion model to gen-erate motions from random noise. In the inference stage, we predict possible future motions given observed motions.
Note that traditional diffusion models [24, 65, 39, 48, 40, 85] have to make the prediction from random noise with a denoising procedure, which cannot make use of observed motions, resulting in uncontrollable results. We thereby propose a new method named DCT-Completion in the infer-ence stage, which can employ observed motions for future motion prediction. Particularly, we add noise to observa-tions to obtain a noisy spectrum of observed motions. In each denoising step of our method, we involve this noisy spectrum with a masking mechanism, where we combine the denoised and noisy spectrum with a mask. As the noisy spectrum is transformed from observations, the mech-anism makes prediction motions conditioned on observed motions. Controllable predictions are produced accord-ingly (see Figure 1b). (1) During training,
Compared with the methods in the encoding-decoding fashion, HumanMAC enjoys the following great proper-there is only one loss func-ties. tion in the objective of HumanMAC. This avoids previ-ous several hyper-parameters that balance different losses, and facilitates method applications. (2) HumanMAC is trained in an end-to-end manner, which is remarkably sim-pler to implement than multi-stage training. (3) Human-MAC can achieve more diverse prediction results that con-tain the switch of different categories of motions, even though the switch is rare or not presented in observed mo-tion sequences. This is benefited from that we holisti-cally model the whole sequence, i.e., the integrated ob-served and predicted motions. The generated motion is therefore controlled to be continuous between the observed frames and predicted frames. Due to the continuity of motions, e.g., from Squatting to Standing Up and from Standing Still to Walking for we humans, the trained model can naturally complete the switch of different categories of motions.
Before delving into details, we clearly summarize our contributions as follows:
• We carefully discuss the three issues of previous paradigms in human motion prediction, which can in-spire follow-up research for algorithm improvement.
• To address the issues, we propose a novel framework from the new perspective of masked completion. The proposed method enjoys promising algorithmic prop-erties that include only one loss function in the objec-tive, an end-to-end training manner, and great motion switch ability.
• We conduct a series of experiments on benchmark datasets to justify our claims.
In both qualitative and visualization comparisons with the state-of-the-art methods, our method achieves superior performance, which creates a simple and strong baseline for future research. Comprehensive ablation studies and discus-sions are also provided. 2.