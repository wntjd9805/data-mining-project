Abstract
Object detection via inaccurate bounding boxes super-vision has boosted a broad interest due to the expensive high-quality annotation data or the occasional inevitabil-ity of low annotation quality (e.g. tiny objects). The previ-ous works usually utilize multiple instance learning (MIL), which highly depends on category information, to select and refine a low-quality box. Those methods suffer from object drift, group prediction and part domination prob-In this pa-lems without exploring spatial information. per, we heuristically propose a Spatial Self-Distillation based Object Detector (SSD-Det) to mine spatial informa-tion to refine the inaccurate box in a self-distillation fash-ion. SSD-Det utilizes a Spatial Position Self-Distillation (SPSD) module to exploit spatial information and an in-teractive structure to combine spatial information and cate-gory information, thus constructing a high-quality proposal bag. To further improve the selection procedure, a Spa-tial Identity Self-Distillation (SISD) module is introduced in
SSD-Det to obtain spatial confidence to help select the best proposals. Experiments on MS-COCO and VOC datasets with noisy box annotation verify our method’s effective-ness and achieve state-of-the-art performance. The code is available at https://github.com/ucas-vg/
PointTinyBenchmark/tree/SSD-Det. 1.

Introduction
Object detection [18, 38, 58, 30, 57] relying on large-scale datasets like MS-COCO[31] has significantly pro-gressed and achieved good performance. However, accurate bounding box annotations are expensive and challenging in natural contexts [12]. Especially in many professional sce-narios, it is difficult to label accurate annotations without domain knowledge (e.g., agricultural crop observation and medical image processing) [12, 1]. As shown in Fig. 1a in some complex datasets, the human annotators may also annotate inaccurate bounding boxes due to the inherent ambiguities[20] of objects. In addition, labelling with a de-* Equal contribution.
† Corresponding authors. (hanzhj@ucas.ac.cn) (a) Labelling strategies lead to inaccurate annotations (red box). (b) Three problems during previous MIL refining. Because their se-lections depend solely on classification, (i,ii): the refined box (green box) drifts to another object or makes a group prediction (merging across multiple objects) due to neighbor disturbance. Yellow boxes are proposals in the middle person’s MIL bag. (iii): Local part may be more discriminative than the entire object and will be predicted.
Figure 1: The sources of inaccurate box annotations and three problems caused by previous refinement methods. tector or weak signal[11] (e.g., point) is much cheaper but brings more inaccuracy. Therefore learning robust detectors with inaccurate bounding boxes[12, 4, 35, 53, 25] is a prac-tical and meaningful task and has boosted a broad interest.
To use the inaccurate annotations, most related meth-ods [12, 11] refine the inaccurate annotations as Fig. 1a shows, and then train a detector head or re-train a detector with the refined box as the new supervision. There are two main steps during refining: 1) Bag Construction: For each object, obtaining some proposals around the inaccurate an-notated bounding box to form the object-level proposal bag; 2) Proposal Selection: Selecting the top-k proposals with the highest classification confidence from each bag and then weighting average them to obtain the refined box.
During the proposal selection, they usually utilize mul-tiple instance learning (MIL) [10] supervised by category information to choose the proposals with high classification confidence from the constructed bags. However, they pay less [12] or no [11] attention to mining spatial information, leading to the following problems as shown in Fig. 1b: (1)
Object Drift: For each object, some proposals in the con-structed bag do not have a high IoU with the original object but with another nearby object. These proposals are not spatially adjacent to the original object but still have high classification confidence, as the rightmost (the yellow box) proposal of O2 shows in the left-bottom corner of Fig. 1b.
Only the category confidence is relied on for selecting pro-posals for O2, and the rightmost proposal will be selected as the refined box. It means the refined box drifts to another object (Fig. 1b (i)), reducing the recall; (2) Group Predic-tion: Most works [7, 11, 56] select the top-k proposals by classification confidence and then weight average them as the refined box, causing the group prediction problem, as shown in Fig. 1b (ii); (3) Part Domination: The detector often focuses on the object’s semantic region, which can statistically represent the category (e.g. the face). As shown in Fig. 1b (iii), the high classification confidence of the an-imal is in the discriminant part (the face) rather than the entire object as mentioned by [44, 39].
To address these problems, we propose a Spatial Self-Distillation based detector (SSD-Det) to integrate the spa-tial cues into the bounding box refinement.
SSD-Det has two important components: the Spatial Position Self-Distillation (SPSD) module for the bag construction step and the Spatial Identity Self-Distillation (SISD) module for the proposal selection step. To construct high-quality pro-posal bags, SPSD utilizes a neighborhood sampler to gen-erate a balanced and flexible initial proposal bag for each object and then trains a regressor with the supervision of the annotated inaccurate bounding boxes. Finally, high-quality proposal bags are constructed with proposals corrected by the regressor. The mechanism behind SPSD is that the net-work learns the spatial information from the reliable sam-ples, e.g. those low-noise annotations, in the dataset and then guides the noisy samples to produce high-quality pro-posals, as shown in Fig. 2.
In addition, to further com-bine the category information and the spatial information, an interactive structure is implemented by alternately us-ing SPSD to mine spatial cues and MIL to utilize the cat-egory information. With SPSD and the interactive struc-ture, a high-quality proposal bag can be constructed. Ex-periments on MS-COCO show that SPSD can significantly improve the mean/max IoU between objects and proposals
Figure 2: The mechanism of Spatial Self-Distillation. By assigning higher weight, the low-noise annotations can be seen as reliable samples to guide the training of proposals’ spatial position and identity learning in SPSD and SISD. (about 18/10 points, Fig. 5) in the constructed bag. Instead of selecting proposals by classification confidence, we have proposed the SISD module in the proposal selection step.
We use it to obtain each proposal’s spatial confidence by predicting the IoU with the object and combining the IoU with classification confidence to select the top-k proposals.
It is worth mentioning that SISD is an object-related IoU predictor, which means that the predicted IoU may be dif-ferent for the same proposal that appears in different ob-jects’ bags. Accordingly, it guarantees that SISD can better handle object drift and group prediction problems. Experi-ments on MS-COCO and VOC datasets verify the effective-ness of our method and bring state-of-the-art performance.
The contributions are as follows: 1) We further investigate the inaccurate-box supervised object detection tasks and propose an end-to-end training
SSD-Det that combines the spatial and the category infor-mation in an interactive fashion. 2) We utilize an SPSD module to generate higher-quality proposals sampling through statistic-guide spatial position distillation, raising the upper bound of the refinement. 3) To add spatial cues to classification confidence, we also introduce an SISD module to select a proposal belong-ing to the object rather than the category. 4) The performance of our proposed SSD-Det improves the mean average precision (AP) of the best previous method (e.g. over 10 AP on 40% noisy MS-COCO) and achieves state-of-the-art under various noise rate box super-vision on MS-COCO and VOC datasets. 2.