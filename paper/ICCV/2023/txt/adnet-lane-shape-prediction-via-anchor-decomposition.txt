Abstract
In this paper, we revisit the limitations of anchor-based lane detection methods, which have predominantly focused on fixed anchors that stem from the edges of the image, dis-regarding their versatility and quality. To overcome the inflexibility of anchors, we decompose them into learning the heat map of starting points and their associated di-rections. This decomposition removes the limitations on the starting point of anchors, making our algorithm adapt-able to different lane types in various datasets. To en-hance the quality of anchors, we introduce the Large Ker-nel Attention (LKA) for Feature Pyramid Network (FPN).
This significantly increases the receptive field, which is cru-cial in capturing the sufficient context as lane lines typ-ically run throughout the entire image. We have named our proposed system the Anchor Decomposition Network (ADNet). Additionally, we propose the General Lane IoU (GLIoU) loss, which significantly improves the performance of ADNet in complex scenarios. Experimental results on three widely used lane detection benchmarks, VIL-100, CU-Lane, and TuSimple, demonstrate that our approach outper-forms the state-of-the-art methods on VIL-100 and exhibits competitive accuracy on CULane and TuSimple. Code and models will be released on https://github.com/
Sephirex-X/ADNet. 1.

Introduction
Recently, the utilisation of artificial intelligence technol-ogy for the field of autonomous driving has drawn large at-tention from academia and industry. As a crucial part of au-tonomous driving system, Advance Driver Assistance Sys-tem (ADAS) requires vehicles to respond timely and accu-rately to changes in the environment. Lane line is a vital part of the vehicle sensing the environment, as the ADAS
*Corresponding author (a) Annotations (b) Traditional (c) Ours
Figure 1: Illustration of different dynamic anchor proposal methods. (a) illustrates two common lane prediction scenar-ios. In the first row, the lane lines originate from the edges of the image, while in the second row, the lane lines can emanate from any location within the image. (b) proposes anchor dispersedly [49], resulting in low anchor quality.
This anchor proposal method is adequate on first row sce-narios but oversimplistic on the second (emphasised by yel-low oval). The points and lines represent start points and (c) we propose anchor concentra-anchors respectively. tively, possible start points are shown on activation map, anchors can merge from the whole image, which ensures anchor quality and flexibility. needs the shape of lane lines to keep the vehicle on track.
With the advancement of CNN, recent studies on lane shape detection have made great progress on either accu-racy [35, 40, 49] or real-time performance [31, 32, 24].
Anchor-based methods have shown superior accuracy and efficiency compared to other methods on popular bench-marks such as [29, 2, 37]. However there are still challenges to the wide application of anchor-based methods.
The first issue is the flexibility of anchors. Previous anchor-based methods [35, 21, 49, 31] have posited that lane lines can only originate from the three edges of an image (left, bottom, right). While this assumption lever-ages prior information of lane lines to achieve favourable accuracy and speed, it is oversimplistic as lane lines do not always start from the three edges due to the obstructions
such as vehicles in adjacent lanes or a vehicle’s front hood (shown on Figure 1(a)).
Another problem is the low quality of anchors. Anchor-based methods [21, 35] usually employ an approach of fixed anchors, while recent method [49] adopt a dynamic ap-proach with dispersed anchor prediction. This dispersed prediction (shown on Figure 1(b)) is possibly unreliable when the camera resolution is varying, particularly in cases where lane lines do not start from the edges. Additionally, the inherent physical characteristics of lane lines, such as their slenderness and continuity, presenting significant chal-lenges in capturing their geometric features. However, most existing approaches are limited in small kernel sizes which present an obstacle to accurately capture the whole feature descriptors of lane lines.
In this paper, to address these problems, we introduce
Anchor Decomposition Network (ADNet). Specifically, to make anchors flexible, we propose Start Point Generate
Unit (SPGU) which decomposes them into predicting the position of the start points and its associated direction on a global scale by the probability map (heat map). To enhance anchors’ quality, we realise the crucial role of large recep-tive in capturing slender and continue lane lines. Therefore we introduce a Large Kernel Attention (LKA) module and integrate it with the Feature Pyramid Network (FPN). Since we predict anchors in a concentrative way (shown in Fig-ure 1(c)), the location is invariant to the density of validated pixels and thus the anchors’ quality and flexibility can be mutually guaranteed.
We conduct extensive experiments on three lane detec-tion benchmarks: VIL-100 [47], CULane [29] and TuSim-ple [37]. Comparing along with state-of-art methods, our approach shows excellent performance on all datasets. In particular, on VIL-100 dataset where segmentation-based methods always perform superior to the anchor/keypoint-based counterparts, our framework outperforms all exist-ing state-of-art methods, making the anchor-based method a more generalised pipeline. The main contributions of this paper are summarised as :
• We emphasise the importance of anchor flexibility for the anchor-based approaches by explicitly decom-posed learning of the heat map of starting points and their associated directions. The decomposition makes our algorithm adaptable to different lane types in more scenarios.
• To our best knowledge, we are the first to investigate the effectiveness of Large Kernel mechanism on lane detection task to guarantee the anchor quality, as the lane lines usually cover the entire image which often require significantly large context to be accurately cap-tured.
• We rethink the limitations of LIoU loss and propose our own General Line IoU (GLIoU) loss tailor for anchor-based lane detection method on complex sce-narios. Furthermore, we utilise the explicit physical modelling by anchor decomposition to guide the learn-ing of kernel offsets in the proposed Adaptive Lane
Aware Unit (ALAU).
• Experiments on main benchmarks show excellent trade-offs on performance and speed compared with
SOTA methods, outperforming all recent methods on
VIL-100 dataset. 2.