Abstract
Pedestrian trajectory prediction is an essential link to understanding human behavior. Recent work achieves state-of-the-art performance gained from hand-designed post-processing, e.g., clustering. However, this post-processing suffers from expensive inference time and ne-glects the probability that the predicted trajectory disturbs downstream safety decisions.
In this paper, we present
Trajectory Unified TRansformer, called TUTR, which uni-fies the trajectory prediction components, social interac-tion, and multimodal trajectory prediction, into a trans-former encoder-decoder architecture to effectively remove the need for post-processing. Specifically, TUTR parses the relationships across various motion modes using an explicit global prediction and an implicit mode-level transformer encoder. Then, TUTR attends to the social interactions with neighbors by a social-level transformer decoder. Finally, a dual prediction forecasts diverse trajectories and corre-sponding probabilities in parallel without post-processing.
TUTR achieves state-of-the-art accuracy performance and improvements in inference speed of about 10× - 40× com-pared to previous well-tuned state-of-the-art methods using post-processing. 1.

Introduction
Pedestrian trajectory prediction aims to predict the fu-ture trajectory based on an observed trajectory. It is an es-sential link that connects the perception system upward and the planning system downward [13, 18]. Due to the ran-domness of human motion, there are diverse plausible fu-ture trajectories that pedestrians could take [6]. The popu-lar predictor addresses this multimodal prediction task in a generative style. They model the multimodality of the fu-ture trajectory in a specific space, such as an explicit Gaus-sian space [17, 27, 5], a latent space [34, 16, 37, 6], a hand-∗Corresponding author. (A) shows the comparison against the meth-Figure 1. ods (MemoNet[33], SocialVAE[34]) with post-processing and the
SIT[26] without post-processing, Simultaneously, it presents the accuracy performance variances of MemoNet and SocialVAE that use post-processing or not. (B) shows the inference speed vari-ances as the number of pedestrians increases. Our method achieves a balance of accuracy performance and inference speed. planning space [26], or a memory bank [33].
Recently, some works [33, 34] have achieved significant advances benefiting from hand-designed post-processing, as illustrated in Figure 1 (A). Most of the time, they first sample more plausible future trajectories than the de-sired number of predictions K. Then, a clustering algo-rithm (e.g., K-means) is operated on sampled trajectories to generate the desired K predictions, similar to NMS [9] in object detection. However, this post-processing suffers from expensive inference time due to the non-parallel loop iteration in clustering, especially for a dense scene.
As shown in Figure 1 (B), the methods with post-processing lead to being more and more time-consuming as the number of pedestrians increases. Furthermore, the post-processing neglects probability information, disturb-ing safety decisions. Actually, most works forecast diverse
trajectories equally (i.e., without probability information) in pedestrian trajectory prediction. Similarly, the cluster-ing operation also obtains K centers with equal weights.
Although these predictors have significant performance in best-of-K prediction, there is no information on which is the best. It is a disadvantage for the safety decision of an in-telligent system such as autonomous driving. Our goal aims to bridge the gap between accuracy and inference speed, keeping the corresponding probabilities of predicted trajec-tories simultaneously.
To address the above problems, we propose Trajectory
Unified TRansformer (named TUTR) to effectively elim-inate the need for post-processing in pedestrian trajectory prediction. TUTR unifies the components of pedestrian trajectory prediction, such as social interaction and mul-timodal trajectory prediction, into a transformer encoder-decoder architecture as illustrated in Figure 2.
TUTR first parses relationships across various motion modes using an explicit global prediction and an implicit mode-level transformer decoder. Specifically, global pre-diction employs two rigid transformations on training tra-jectories to obtain general motion modes, which are consid-ered as the input token of the mode-level transformer en-coder. Afterward, TUTR attends to the social interactions with neighbors using a social-level transformer decoder to prepare a social-acceptable prediction. Finally, a dual pre-diction is used to forecast diverse trajectories and corre-sponding probabilities in parallel to cover the multimodality of future trajectories without any post-processing.
We evaluate TUTR on the most popular datasets for pedestrian trajectory prediction, ETH [19], UCY [14], and
SDD [22]. The experimental results show that our pro-posed method achieves a comparable accuracy performance and faster inference speed without any post-processing step compared with existing state-of-the-art methods. Moreover,
TUTR performs the best performance in brier-ADE and brier-FDE, which are two metrics that consider the prob-abilities of predicted trajectories.
In summary, the contributions of this paper are summa-rized as follows.
• We propose a new pedestrian trajectory prediction framework (TUTR) based on encoder-decoder trans-former architecture entirely to unify the pedestrian tra-jectory prediction.
• TUTR parses the relationship across various motion modes by the explicit global prediction and implicit mode-level transformer encoder to effectively remove the need for post-processing.
• TUTR achieves state-of-the-art ADE/brier-ADE/brier-FDE, and comparable performance in FDE. Moreover,
TUTR performs a faster inference speed to balance ac-curacy performance and inference speed. 2.