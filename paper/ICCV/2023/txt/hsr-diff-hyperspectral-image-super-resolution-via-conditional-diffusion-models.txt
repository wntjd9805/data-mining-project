Abstract
Despite the proven significance of hyperspectral images (HSIs) in performing various computer vision tasks, its po-tential is adversely affected by the low-resolution (LR) prop-erty in the spatial domain, resulting from multiple physical factors. Inspired by recent advancements in deep generative models, we propose an HSI Super-resolution (SR) approach with Conditional Diffusion Models (HSR-Diff) that merges a high-resolution (HR) multispectral image (MSI) with the corresponding LR-HSI. HSR-Diff generates an HR-HSI via repeated refinement, in which the HR-HSI is initialized with pure Gaussian noise and iteratively refined. At each iter-ation, the noise is removed with a Conditional Denoising
Transformer (CDFormer) that is trained on denoising at dif-ferent noise levels, conditioned on the hierarchical feature maps of HR-MSI and LR-HSI. In addition, a progressive learning strategy is employed to exploit the global informa-tion of full-resolution images. Systematic experiments have been conducted on four public datasets, demonstrating that
HSR-Diff outperforms state-of-the-art methods. 1.

Introduction
Hyperspectral images (HSIs) contain dozens or hundreds of spectral bands, enabling them to provide more faithful knowledge of targeted scenes than conventional imaging modalities. As such, HSIs play an irreplaceable role in vari-ous computer vision tasks, including classification [35, 42], segmentation [6], and tracking [32]. Although HSIs con-tain rich spectral information, contemporary hyperspectral
*Equal contribution
†Corresponding author. This work is supported by the National Natural
Science Foundation of China under Grant (62271400), and in part by the
Shaanxi Provincial Key R&D Program, China (2023-GHZD-02).
Figure 1: Illustration of fusion-based Hyperspectral Image
Super-Resolution (HSI-SR). imaging sensors lack high-resolution (HR) in the spatial do-main, due to the stringent constraint of typically low signal-to-noise ratios. Their widespread use is significantly hin-dered by this fact. Restricted by hardware limitations, a practical way to work around this problem is to fuse the low-resolution (LR) HSI with an HR multispectral image (MSI). This requires the implementation of so-called HSI super-resolution (SR)[36], as shown in Figure 1.
Over the past few decades, a significant amount of research efforts have been devoted to developing HSI-SR approaches, which can be roughly classified into five categories [44]: Extensions of pansharpening [5, 25, 27], Bayesian inference-based methods [1, 29], ma-trix factorization-based methods [2], tensor-based methods
[18], and deep learning (DL)-based methods [31]. Whilst pansharpening methods [26] have been extended to the field of HSI-SR, such approaches are prone to spectral distortion.
Bayesian inference-based approaches rely on the assump-tion of prior knowledge, thereby having a weak flexibility in dealing with different HSI structures. Matrix factorization-based techniques reshape the 3D HSIs and MSIs into ma-trices, thus facing the challenge of learning the required relationship between space and spectrum. Although sev-eral tensor-based methods have been proposed that can maintain the 3D structure of input images, they consume much more memory and computational power. Further-more, these traditional approaches work via relying heavily on hand-crafted priors.
Recently, DL-based methods, especially convolutional neural network (CNN)-based approaches, have flooded over into the HSI-SR research community [8, 31, 10, 22, 46, 43, 19]. Rather than resorting to hand-crafted features, DL-based techniques learn prior knowledge automatically from given data. Particularly, Dong et al. proposed the first DL-based method for image SR, with the end-to-end mapping between LR images and HR images learned using a CNN
[9]. Subsequently, generative adversarial networks (GANs) were introduced to the field of image SR in an effort to pro-duce high-frequency details [17, 11]. After that, various
GAN-based models have been devised, showing state-of-the-art results in the HSI-SR literature [24]. However, such work requires carefully designed regularization and opti-mization tricks to tame optimization instability and avoid mode collapse.
Inspired by the recent developments in deep generative models [14, 23], in this paper, we propose an innovative approach that we refer to as HSR-Diff (HSI-SR with condi-tional diffusion models). It works by learning to transform the original standard normal distribution into the data dis-tribution of HR-HSI through a sequence of refinements. In contrast to GAN-based methods which require inner-loop maximization, HSR-Diff operates by simply minimizing a well-defined loss function to learn prior knowledge. Al-though conditional diffusion models are straightforward to define and efficient to train, there has been no demonstra-tion that they are capable of merging LR-HSI and HR-MSI to the best of our knowledge. We show that conditional dif-fusion models are capable of generating high-quality HR-HSIs, which may best the state-of-the-art results.
A key factor of HSR-Diff is its inherent denoising
In spite ability thanks to use of deep neural networks. of the effectiveness of CNNs for denoising, they have shown limitations in modelling long-range dependencies.
Some previous transformer-based HSI-SR works, espe-cially Pyramid Shuffle-and-Reshuffle Transformer (PSRT)
[7], Transformer-based Fusion network (Fusformer) [15], and Hyperspectral and Multispectral image Fusion Trans-former (HMF-Former) [40], all of which learn long-range dependencies with attention mechanisms. These Trans-formers only take LR-HSI and HR-MSI as input, while the denoising Transformer is also fed with noise level γ and noisy HR-HSI. To comprehensively exploit the spa-tial and spectral information in the LR-HSI, HR-MSI, and noisy HR-HSI, a Conditional Denoising Transformer (CD-Former) is herein designed and trained with a denoising ob-jective to remove various levels of noise iteratively. In ad-dition, a progressive learning strategy is utilized to help the
CDFormer learn the global statistics of full-resolution HSIs.
The main contributions of this work are summarized as fol-lows:
• We propose the novel application of conditional diffu-sion models in the field of HSI-SR that works by pro-gressively destroying HR-HSI through injecting noise and subsequently learning to reverse this process, in order to perform HSI-SR. To the best of our knowl-edge, this is the first work to exploit diffusion models within the realm of HSI-SR.
• We introduce a CDFormer that refines a noisy HR-HSI conditioned on the deep feature maps of HR-MSI and LR-HSI, capable of modelling global connec-tivity with self-attention. Rather than concatenation, cross-attention is utilized as the conditioning mech-anism to incorporate spatio-spectral information and noise level.
• We employ a progressive learning strategy to exploit the global information of full-resolution HSIs, with
CDFormer being trained on small image patches in the early epochs with high efficiency and on the global im-ages in the later epochs to acquire global information.
• We present experimental investigations on four pub-lic datasets, with quantitative and qualitative results il-lustrating the superior performance of our approach as compared with state-of-the-art methods. 2.