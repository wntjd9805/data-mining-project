Abstract
Few-shot classification aims to learn a discriminative feature representation to recognize unseen classes with few labeled support samples. While most few-shot learning methods focus on exploiting the spatial information of im-age samples, frequency representation has also been proven essential in classification tasks.
In this paper, we inves-tigate the effect of different frequency components on the few-shot learning tasks. To enhance the performance and generalizability of few-shot methods, we propose a novel
Frequency-Guided Few-shot Learning framework (dubbed
FGFL), which leverages the task-specific frequency com-ponents to adaptively mask the corresponding image in-formation, with a novel multi-level metric learning strat-egy including a triplet loss among original, masked and un-masked image as well as a contrastive loss between masked and original support and query sets to exploit more dis-criminative information. Extensive experiments on four benchmarks under several few-shot scenarios, i.e., stan-dard, cross-dataset, cross-domain, and coarse-to-fine an-notated classification, are conducted. Both qualitative and quantitative results show that our proposed FGFL scheme can attend to the class-discriminative frequency compo-nents, thus integrating those information towards more ef-fective and generalizable few-shot learning. 1.

Introduction
Deep learning typically relies on large-scale annotated datasets to achieve superior results on image classification tasks. However, the learned deep models may fail to gener-alize under some severe conditions, e.g., few data or annota-tions. Correspondingly, the task to classify a query sample using only a few labeled data is known as few-shot classifi-cation [10, 40]. The key challenge is to learn the discrim-inative feature representation that can be generalized from the given training set to novel testing classes. Recently, sev-*Corresponding author.
Figure 1: Visualizations of samples with different frequency masks on the CUB dataset [41]. Samples with the same color box belong to the same class. It is easier to distin-guish two classes with masked specific frequency compo-nents. Each square on the left represents the masked status of corresponding frequency components, i.e., the dark and light color for masked and reserved, respectively. For each row (column), top-to-bottom and left-to-right represent low frequency to high frequency, respectively. eral few-shot methods [36, 48, 58] have applied the meta-learning framework [40] to build a discriminative feature space by simulating numerous meta-tasks to obtain the gen-eralized feature representation, achieving superior perfor-mance for recognizing novel classes.
However, very recent studies [3, 17, 26, 39] report that existing methods may fail to generalize well to novel classes due to large domain gaps between training and testing sets, e.g., from general to fine-grained tasks or a specific
In these cases, the learned feature embeddings domain. based on spatial images may capture excessive domain-variant information from the training patterns, leading to degraded performance in the test scenario with a large do-main gap. Several domain adaptation-based few-shot al-gorithms [26, 37, 39, 57] have been proposed to alleviate the domain shift issues on few-shot classification. These
methods focus on learning a flexible feature embedding or fine-tuning on less novel support samples to transfer knowl-edge across domains. However, they cannot achieve stable performance improvements for different few-shot scenar-ios. Moreover, most domain adaption-based methods only focused on exploiting the image spatial features.
Beyond spatial features, the frequency-domain represen-tation plays a vital role for various computer vision tasks, e.g., deep fake recognition [12, 24, 27], domain generaliza-tion [19] and image classification [4, 32, 42, 50]. Different frequency components naturally convey discriminative and interpretive features for visual understanding [19, 32], e.g., the selected frequency components (FCs) of input images can be used to interpret the learned CNN features in classi-fication [42, 50]. In few-shot learning, Chen et al. [4] is the first attempt to apply image frequency spectrum for classi-fication, in which frequency information is naively concate-nated as an extra feature, without exploiting different effects of its FCs. Figure 1 provides an example, clearly show-ing that certain FCs are more discriminative, thus should be selected and highlighted for more effective classification.
However, no work to date has systematically investigated the roles of different FCs and how to adaptively select im-portant FCs for effective few-shot learning.
In this paper, we propose a novel Frequency-Guided
Few-shot Learning (FGFL) framework towards highly ef-fective few-shot classification and generalization. For each input image, FGFL adaptively generates a task-specific class-discriminative mask in the frequency domain using
Grad-CAM [35], where the activated FCs represent the im-portant frequency information associated with the current task. Then we convert the masked and unmasked frequency components output back to the spatial domain for generat-ing the masked and unmasked images, which contain lim-ited and rich task-specific class-discriminative information, respectively. After that, for each image in the meta-task, we construct its triplet with its corresponding unmasked and masked images as positive and negative samples. We also construct two additional few-shot tasks by regrouping the masked and original support and query images, i.e., Tms with masked support set and original query set, and Tmq with original support set and masked query set.
In addi-tion, we propose two types of ranking losses, including the triplet and contrastive loss functions at single images and tasks (i.e., Tms and Tmq) levels, respectively, to force the model to capture task-specific class-discriminative informa-tion that can well generalize to the novel classes. Moreover, the unmasked images are also added to the support set to enhance the discriminability of feature embeddings.
The contributions of this work are fourfold. First, we propose a Frequency-Guided Few-shot Learning (FGFL) framework to utilize the frequency information to enhance the performance and generalizability of few-shot methods
Second, we propose two types in the spatial domain. of ranking loss, including the triplet and contrastive loss functions at both sample and task levels based on origi-nal and generated images, to force the network to focus on class-discriminative frequency components for each few-shot meta-task.
In addition, the generated unmasked im-ages are also utilized to augment the support set to en-hance the discriminability of feature embeddings. Third, we investigate the impact of frequency components on cur-rent methods under several generalized few-shot settings, namely cross-dataset, cross-domain, and coarse-to-fine an-notated generalization. To the best of our knowledge, this is the first work that exploits the effect of different frequency components on few-shot classification and generalization tasks explicitly. Last, experimental results and visualiza-tions demonstrate that the proposed FGFL can improve the performance and generalizability of few-shot methods and achieve superior results under several few-shot settings. 2.