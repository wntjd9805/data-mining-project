Abstract
In this paper, we develop rotation-equivariant neural networks for 4D panoptic segmentation. 4D panoptic seg-mentation is a benchmark task for autonomous driving that requires recognizing semantic classes and object instances on the road based on LiDAR scans, as well as assigning temporally consistent IDs to instances across time. We ob-serve that the driving scenario is symmetric to rotations on the ground plane. Therefore, rotation-equivariance could provide better generalization and more robust feature learn-ing. Specifically, we review the object instance cluster-ing strategies and restate the centerness-based approach and the offset-based approach as the prediction of invari-ant scalar fields and equivariant vector fields. Other sub-tasks are also unified from this perspective, and different invariant and equivariant layers are designed to facilitate their predictions. Through evaluation on the standard 4D panoptic segmentation benchmark of SemanticKITTI, we show that our equivariant models achieve higher accu-racy with lower computational costs compared to their non-equivariant counterparts. Moreover, our method sets the new state-of-the-art performance and achieves 1st place on the SemanticKITTI 4D Panoptic Segmentation leaderboard. 1.

Introduction
Perception with LiDAR point clouds is an important part of building real-world autonomous systems, for example, self-driving cars [38, 32, 50, 36]. As the computer vision community gradually builds more capable neural networks, the tasks also become more complex. 4D panoptic segmen-tation [1] is an emerging task that combines several previ-ously independent tasks: semantic segmentation, instance segmentation, and object tracking, in a unified framework, given sequential LiDAR scans. As the output provides abundant useful information for understanding the dynamic
*Work done at Qualcomm AI Research during an internship.
†Qualcomm AI Research, an initiative of Qualcomm Technologies, Inc.
Figure 1. Predicting centerness or offset is a critical step in esti-mating object centers as part of the overall panoptic segmentation.
A centerness heatmap can be viewed as an invariant field, while the offset can be viewed as an equivariant vector field. In our pro-posed approach, we devise different, corresponding methods to predict invariant and equivariant fields, respectively. driving environment, solving this task has significant prac-tical value.
While there are a few existing methods to solve 4D panoptic segmentation [1, 24], they ignore the rich, inher-ent symmetries present in this task. For example, for the point cloud of an object instance, its center is invariant to rotations, and the offset vector from any point on the object to the center is attached to and thus rotates along with the body frame. See Fig. 1 for a visual illustration.
As such, in this paper, we propose to develop equivariant neural networks to solve 4D panoptic segmentation. Equiv-ariant networks [11] are deep learning models that are guar-anteed to render outputs that respect the symmetries in data.
For the 4D panoptic segmentation task, rotational equivari-ance can help the model perform consistently and general-ize over rotations in the input data.
While equivariance is a nice property, equivariant mod-els can be complex and incur high computational costs [52, 49, 45]. As a result, most existing equivariant models are only applied to small-scale problems, such as molecular analysis and single-object perception [17]. Recent works have looked into more efficient equivariant networks [52]
and applications in larger problems [49], but significant per-formance improvement without extra computational cost has not been achieved in large-scale equivariant perception solutions.
In this work, SO(2)-equivariance is incorporated in the 4D segmentation model. We find that the equivariance brings consistent improvements in several performance metrics and that formulating the output as equivariant vector fields helps maximize the benefits of equivariant models, as compared to restricting to invariant scalar fields (see Fig. 1).
Furthermore, our equivariant networks can improve the seg-mentation performance while reducing computational costs at the same time. With our proposed design, we outperform the non-equivariant models and, notably, achieve the top-1 ranking position in the SemanticKITTI benchmark.
Our main contributions in this paper are as follows:
• We develop the first rotation-equivariant model for 4D panoptic segmentation, bringing improvements in both performance and efficiency.
• We investigate different strategies and designs to con-struct the equivariant architecture. Specifically, we dis-cover the advantage of formulating prediction targets as equivariant vector fields, as compared to only in-variant fields.
• Evaluated on the SemanticKITTI benchmark, our equivariant models significantly outperform existing methods, validating the value of equivariance in this large-scale perception task.
• Our code at
//eq-4d-panoptic.github.io/. open-sourced is https: 2.