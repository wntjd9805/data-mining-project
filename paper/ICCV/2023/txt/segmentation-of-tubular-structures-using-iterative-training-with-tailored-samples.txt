Abstract
We propose a minimal path method to simultaneously compute segmentation masks and extract centerlines of tubular structures with line-topology. Minimal path meth-ods are commonly used for the segmentation of tubular structures in a wide variety of applications. Recent meth-ods use features extracted by CNNs, and often outperform methods using hand-tuned features. However, for CNN-based methods, the samples used for training may be gen-erated inappropriately, so that they can be very different from samples encountered during inference. We approach this discrepancy by introducing a novel iterative training scheme, which enables generating better training samples speciﬁcally tailored for the minimal path methods without changing existing annotations. In our method, segmenta-tion masks and centerlines are not determined after one an-other by post-processing, but obtained using the same steps.
Our method requires only very few annotated training im-ages. Comparison with seven previous approaches on three public datasets, including satellite images and medical im-ages, shows that our method achieves state-of-the-art re-sults both for segmentation masks and centerlines. 1.

Introduction
Segmentation of tubular structures is an essential task in many application areas of computer vision, including navi-gation, delineation of roads in satellite images, and analysis of blood vessels in medical images (see Fig. 1 for exam-ples). Beyond segmentation masks, such applications often also require centerlines with line-topology, i.e., the center-lines should not contain interruptions, isolated pieces, or width (Fig. 2). Centerlines with line-topology are usually represented as sequences of coordinates.
While non-tubular object such as cars often have rela-tively high variance of appearance (e.g., color or texture) but low variance of shapes, tubular structures typically have relatively low variance of appearance but high variance of (a) Input image (b) Our results
Figure 1. Examples of application areas of tubular structure seg-mentation. First row: Finding path between two points in a satel-lite image (navigation). Second row: Segmentation of road net-work in a satellite image. Third row: Segmentation of the vessel tree in a image of retinal vessels.
Figure 2. Illustration of line-topology and non-line-topology. shapes. For example, blood vessels in medical images of the same imaging modality typically have similar intensity distributions, but they may contain very irregular shapes caused by pathology. General segmentation methods, such as U-Net [23], are widely used also to segment tubular structures, but these methods do not take the special prop-erties of tubular structures into account, and cannot sat-isfy certain topological constraints, such as connectivity of two points. To obtain centerlines with line-topology, post-processing is usually required. Also, the amount of annota-tions needed to train such methods is usually quite high.
In contrast, using minimal path methods, such as Dijk-stra’s algorithm [9] or the fast marching method [7, 26], points on the centerlines are obtained explicitly, and line-topology is guaranteed naturally. However, to obtain seg-mentation masks of the tubular structures, often an ad-ditional post-processing step is necessary [11]. Alterna-tively, a new dimension can be introduced into the param-eter space of the minimal path method to represent the ra-dius [15, 22, 6], but this leads to signiﬁcantly higher com-In the recent method of Path-CNN [16], putational cost. a CNN is integrated into Dijkstra’s algorithm to obtain centerlines and masks without post-processing. However, the masks generated using this method is relatively impre-cise, since training is only performed using samples along user-speciﬁed centerlines, i.e., samples which are inside the ground truth masks of tubular structures but do not lie ex-actly on centerlines are not used. Furthermore, the sam-ples used to train this CNN are often different from samples which are actually encountered during the inference.
We propose a method to determine segmentation masks and centerlines with line-topology for tubular structures in a uniﬁed way. Our method uses a similar framework as
[16], i.e., we integrate a CNN classiﬁer into the minimal path method. However, we use a novel technique for cre-ating samples out of existing annotations (see Fig. 6 and 7
Instead of using the an-for an overview of differences). notation (i.e., ground truth mask) directly and training the model only once, we introduce an iterative training scheme.
In each iteration, we apply minimal path method with the
CNN classiﬁer trained in the previous iteration to gener-ate new samples out of the annotations. These samples are used to re-train the CNN classiﬁer in the current iteration.
The ground truth masks do not change, but by iteratively re-training and re-sampling, we are able to extract different samples which are much more realistic and better tailored for the minimal path method. To our knowledge, this is the ﬁrst approach to apply iterative training to minimal path method, and to use minimal path method itself to improve samples during the training phase. In this way, we better ex-ploit the properties of the minimal path method, and achieve more precise masks and centerlines on three datasets. Also, our method needs only very few annotated images, making it especially effective for medical image analysis, for which the amounts of annotations are often limited. structure. Several widely used methods employ differen-tial measures based on Hessian matrix [10, 25] or ﬂux [31].
While most of these methods rely on hand-tuned parame-ters, there also exist learning-based methods, such as [28].
These methods are usually used by other methods as fea-ture extraction step to achieve segmentation masks or cen-terlines. More recently methods [12, 27] use deep learn-ing to enhance tubular structures, but post-processing is still needed to achieve line-topology of the result.
Approaches based on minimal path Minimal path meth-ods are commonly used to extract centerlines of tubular structures with line-topology. These methods often suf-fer from the short cut problem, i.e., the centerlines may leak out the tubular structures. This can especially hap-pen when the tubular structure has high curvature, or two tubular structures are very close to each other, or the tubu-larity measure cannot differentiate between foreground and background. The short cut problem has been approached using a variety of methods [4, 5, 13, 32, 15, 22, 6]. The re-cent method [16] integrates a CNN classiﬁer into the min-imal path method to avoid several types of short cut prob-lems. However, the classiﬁer in [16] is only trained once, and minimal path method is only used during inference. In contrast, our method is trained iteratively, and minimal path method is used both during training and inference. Further-more, in [16] a hand-tuned tubularity feature [10] is used at initialization, but in later steps other learning-based fea-tures are used. In contrast, we use learning-based features throughout all steps, thus it is not necessary to tune param-eters manually for [10].
Training scheme
Instead of using annotations directly,
[21] uses more realistic samples provided by a segmenta-tion network. We use a similar idea, but in our approach, the training process is iterative, i.e., the classiﬁer is trained using samples which are generated in the previous iteration using the classiﬁer itself in conjunction with the minimal path method. The classiﬁer in [21] is only used to classify samples created by another segmentation network, while our classiﬁer is an integral part of the segmentation method itself. Furthermore, [21] relies on other tubularity features, which require large amounts of training data. In contrast, our method does not depend on other features and yields high-quality results even for small amounts of training data.
Finally, [21] does not achieve segmentation masks. 2.