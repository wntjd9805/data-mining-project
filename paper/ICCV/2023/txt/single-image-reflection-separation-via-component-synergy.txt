Abstract
The reflection superposition phenomenon is complex and widely distributed in the real world, which derives various simplified linear and nonlinear formulations of the problem.
In this paper, based on the investigation of the weaknesses of existing models, we propose a more general form of the superposition model by introducing a learnable residue term, which can effectively capture residual information during decomposition, guiding the separated layers to be complete. In order to fully capitalize on its advantages, we further design the network structure elaborately, including a novel dual-stream interaction mechanism and a powerful decomposition network with a semantic pyramid encoder.
Extensive experiments and ablation studies are conducted to verify our superiority over state-of-the-art approaches on multiple real-world benchmark datasets. Our code is pub-licly available at https://github.com/mingcv/DSRNet. 1.

Introduction
As a typical layer superimposition scenario, pictures captured through glass-like surfaces may be blended with undesired reflection, which not only impairs the aesthetic value but also hinders the downstream tasks [31].
In the meantime, scenes of interest are possibly concealed in re-flection [35]. Therefore, both the parts transmitted through a surface (transmission layer, T) and those reflected (reflec-tion layer, R) are desired to be reconstructed from a super-imposed image I to fulfill the practical demands.
Following a common assumption [17], I is linearly com-posed by T and R expressed as I = T + R, which has been popular due to its simplicity. However, in real-world sce-narios, the reflection and transmission layers are likely to be weakened due to diffusion and other problems during the superimposition [35]. Therefore, several methods [34, 39] introduce scalars α and β to the two components, respec-tively, obtaining I = αT + βR. However, the linear su-perimposition model is often violated due to over-exposure
*Corresponding author. This work was supported by National Natural
Science Foundation of China under Grant no. 62072327.
Figure 1: A visual example drawn from the SIR2 dataset.
The first row displays a real input I with ground-truth T and
R. In rows 2-5, the separations based on different physical models are compared, where ˆT and ˆR represent the predic-tions. Our method is able to produce a “Residue” term, sep-arating the nonlinearity from the layer reconstructions. and other phenomena [37]. Thus, an alpha-matting map W is introduced to the model as I = W ◦ T + ¯W ◦ R with
¯W = 1 − W, which, however, increases the degree of free-dom and makes this ill-posed problem much harder. In view of all these limitations, it is not a trivial task to represent dif-ferent kinds of reflection scenarios with a single model. In this work, we take a step forward in advancing the solution and deliver a more general form of the superimposition pro-cedure by introducing a residue term as follows:
I = ˜T + ˜R = T + R + Φ(T, R), (1) where T and R denote the groundtruth scenes of the trans-mission and reflection layers, while their respective infor-mation contained in I after superimposition and other degra-dations and finally reach the camera sensors is represented by ˜T and ˜R. Φ(T, R) = I − T − R is the residue of the reconstruction, which can be caused by attenuation, over-exposure, etc. Φ(·, ·) represents a group of functions that can be used to model the residue in specific situations. For example, Φ(T, R) = 0 in [23, 5, 17, 41, 36, 12], Φ(T, R) = (α−1)T+(β−1)R in [34, 39], Φ(T, R) = −( ¯W◦T+W◦R)
In an effort to rule these different cases, a in [37, 42]. learnable module is desired to be introduced to model the residue Φ(T, R). To clarify it, we provide a visual exam-ple in Fig. 1, where the first row shows a superimposed image I, its groundtruth transmission T (GT) and reflec-tion R (GT) layers collected by SIR2 dataset. According to the linear model, the guidance for reflection restoration is
˜R = I − T with incomplete signals rather than R (GT) that contains full information, which not only impairs the train-ing of networks but also hinders the downstream usages.
Therefore, as we point out in Eq. (1), a promising way out of this dilemma is to utilize ground-truth layers T and R as guiding signals and employ an extra residual term to han-dle the non-linearity (“Residue” in Fig. 1). As shown, the components that violate the linear assumption are separated from the layer predictions ˆT and ˆR, and thus more com-plete and precious layer separations than previous methods are obtained.
To further exploit the synergy between the components
T and R, we deliberate upon the facilitation of inter-component feature interaction. The efficiency of a dual-stream interactive network has been verified in SIRS prob-lem by [12]. Building upon their analysis, we subse-quently advance a more effective scheme. Inspired by the gated mechanisms [2, 32], we present a simple yet effec-tive mutually-gated interaction diagram (MuGI) serving as a better feature interaction candidate, by means of which we design the MuGI block to build our decomposition network.
Moreover, the hypercolumn [41], as a commonly used se-mantic information encoder in the SIRS task, tends to ag-gregate features in a lossy way. Therefore, we propose a dual-stream pyramid fusion network (DSFNet) to replace it, which hierarchically decomposes and fuses the multi-scale semantic information leveraging our proposed MuGI blocks and dual-stream fusion blocks (DSF Block). The roughly decomposed features of layers are further delivered into the dual-stream fine-grained decomposition phase (DS-DNet). The two sub-networks constitute the main branch of our Dual-stream Semantic-aware network with Residual correction, namely DSRNet.
In summary, our main contributions are as follows:
• We build a general form for SIRS by introducing a learnable residue term, which is more flexible to dif-ferent scenarios and boosts the separation of layers;
• We exploit the synergy of features via mutually-gated interaction block within a dual-stream semantic-aware network, which facilitates information usage;
• Extensive experiments are conducted to demonstrate the effectiveness of our design. Overall, it achieves state-of-the-art performance against the alternatives on multiple real-world benchmarks for SIRS. 2.