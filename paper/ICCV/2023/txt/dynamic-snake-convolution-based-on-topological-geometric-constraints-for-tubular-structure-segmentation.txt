Abstract
Accurate segmentation of topological tubular structures, is crucial in various such as blood vessels and roads, fields, ensuring accuracy and efficiency in downstream tasks. However, many factors complicate the task, includ-ing thin local structures and variable global morphologies.
In this work, we note the specificity of tubular structures and use this knowledge to guide our DSCNet to simultane-ously enhance perception in three stages: feature extrac-tion, feature fusion, and loss constraint. First, we propose a dynamic snake convolution to accurately capture the fea-tures of tubular structures by adaptively focusing on slen-der and tortuous local structures. Subsequently, we pro-pose a multi-view feature fusion strategy to complement the attention to features from multiple perspectives during fea-ture fusion, ensuring the retention of important information from different global morphologies. Finally, a continuity constraint loss function, based on persistent homology, is proposed to constrain the topological continuity of the seg-mentation better. Experiments on 2D and 3D datasets show that our DSCNet provides better accuracy and continuity on the tubular structure segmentation task compared with several methods. Our codes are publicly available1.
Figure 1. Challenges. The above figure shows a 3D heart vascular dataset and a 2D remote road dataset. Both datasets aim to extract tubular structures, but this task faces challenges due to fragile local structures and complex global morphology. Motivation. The stan-dard convolutional kernel is intended to extract local features. On this basis, deformable convolutional kernels have been designed to enrich their application and adapt to geometric deformations of different targets. However, due to the aforementioned challenges, it is difficult to focus efficiently on the thin tubular structures. 1.

Introduction
The accurate segmentation of topological tubular struc-tures is paramount in various fields to ensure the precision and efficiency of downstream tasks. In clinical applications, a well-delineated blood vessel is a crucial prerequisite for computational hemodynamics, and it assists radiologists in
*Corresponding author 1https://github.com/YaoleiQi/DSCNet locating and diagnosing lesions [13, 16]. In remote sensing applications, complete road segmentation provides a solid foundation for route planning. Regardless of the field, these structures share common features of being thin and tortu-ous, which make them challenging to capture due to their small proportion in images. Therefore, there is an urgent need to enhance the perception of thin tubular structures.
However, it remains challenging due to the following dif-ficulties: (1) Thin and fragile local structure. As shown
in Figure 1, thin structures account for only a small pro-portion of the overall image with limited pixel composi-tion. Moreover, these structures are susceptible to inter-ference from complex backgrounds, rendering it difficult to precisely discriminate subtle target variations by the model.
Consequently, the model may struggle to differentiate these structures, resulting in the fracture of the segmentation. (2) Complex and variable global morphology. Figure 1 shows the complex and variable morphology of thin tubu-lar structures, even within the same image. Morphologi-cal variations are observed in targets located in different re-gions, depending on the number of branches, the location of bifurcations, and the path length. The model may tend to overfit features that have already been seen, resulting in weak generalization when the data exhibits unprecedented morphological structures.
Recently, many studies have proposed incorporating do-main knowledge (e.g. geometric topology and tree struc-ture) to guide the model better to perceive the distinctive features of the tubular structures, thus focusing on improv-ing the accuracy of local segmentation and maintaining the continuity of global morphology. Existing methods can be broadly classified into three categories: (1) Network-based methods [7, 12, 31, 28, 14, 8] design specific net-work architectures according to the characteristics of the tubular structures that guide the model to focus on critical features. However, given the small proportion of tubular structures, the network may inevitably lose the perception of the corresponding structures. (2) Feature-based methods
[21, 33, 15, 35, 20] enhance the comprehension of the par-ticular geometric and topological features of tubular struc-tures by supplementing the model with additional feature representations. However, some redundant feature repre-sentations exacerbate the computational burden while not providing a positive influence on the model. (3) Loss-based methods [24, 29, 1, 30] incorporate measurement meth-ods to supplement constraints during the training process, typically through loss functions. These methods reinforce the stringent constraints on segmentation. Building on this foundation, structured losses combined with continuity con-straints from the topological perspective will potentially fur-ther improve the accuracy of the tubular segmentation.
To tackle the above obstacles, we propose a novel frame-work, DSCNet, involving a tubular-aware convolution ker-nel, multi-view feature fusion strategy, and topological con-tinuity constraint loss function. (1) To address the chal-lenge of the small proportion of thin and fragile local struc-tures that are difficult for the model to focus on, we propose
Dynamic Serpentine Convolution (DSConv) to enhance the perception of the geometric structure by adaptively focus-ing on the thin and curved local features of tubular struc-tures. Unlike deformable convolution [6], which leaves the network completely free to learn geometrical changes, thus causing perceptual regions to wander, especially on thin tubular structures, our DSConv considers the snake-like morphology of tubular structures and supplements the free learning process with constraints that allow for targeted en-hancement of the perception of tubular structures. (2) To address the challenge of complex and variable global mor-phology, we propose a multi-view feature fusion strategy.
In this method, we generate multiple morphological kernel templates based on DSConv for viewing the structural fea-tures of the target from various perspectives and achieve efficient feature fusion by summarizing typical vital fea-tures. (3) To address the problem that segmentation of tubu-lar structures is prone to fracture, we propose a Topologi-cal Continuity Constrained Loss Function (TCLoss) based on Persistent Homology (PH). PH[9, 19, 5] responds to the process of topological features from emergence to disap-pearance. It obtains adequate topological information from noisy high-dimensional data. The related Betti numbers are one way of describing connectivity in the topological space.
Unlike [30, 10], our TCLoss combines PH with point set similarity to pilot the network to focus on fracture regions with anomalous pixel/voxel distributions, achieving conti-nuity constraints from a topological perspective.
To summarize, our work proposes a novel framework of knowledge fusion addressing the difficulties of the thin tubular structures, and the specific contributions are three-fold. (1) We propose a dynamic snake convolution to adap-tively focus on the slender and tortuous local features and realize the accurate tubular structures segmentation on both 2D and 3D datasets. Our model is thoroughly verified us-ing both internal and external test data. (2) We propose a multi-perspective feature fusion strategy to supplement the attention to the vital features from multiple perspectives. (3)
We propose a topological continuity constraint loss function based on Persistent Homology, which better constrains the continuity of the segmentation. 2.