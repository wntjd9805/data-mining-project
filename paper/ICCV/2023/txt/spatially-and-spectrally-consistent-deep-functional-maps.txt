Abstract
Cycle consistency has long been exploited as a pow-erful prior for jointly optimizing maps within a collec-In this paper, we investigate its utility tion of shapes. in the approaches of Deep Functional Maps, which are considered state-of-the-art in non-rigid shape matching.
We first justify that under certain conditions, the learned maps, when represented in the spectral domain, are al-ready cycle consistent. Furthermore, we identify the dis-crepancy that spectrally consistent maps are not necessar-ily spatially, or point-wise, consistent. In light of this, we present a novel design of unsupervised Deep Functional
Maps, which effectively enforces the harmony of learned maps under the spectral and the point-wise representa-tion. By taking advantage of cycle consistency, our frame-work produces state-of-the-art results in mapping shapes even under significant distortions. Beyond that, by in-dependently estimating maps in both spectral and spatial domains, our method naturally alleviates over-fitting in network training, yielding superior generalization perfor-mance and accuracy within an array of challenging tests for both near-isometric and non-isometric datasets. Codes are available at https://github.com/rqhuang88/Spatially-and-Spectrally-Consistent-Deep-Functional-Maps. 1.

Introduction
Non-rigid shape matching is a fundamental task in shape analysis, playing a pivotal role in a wide spectrum of appli-cations including texture transfer [1], volume parameteriza-tion [31], statistical shape analysis [2, 6], to name a few. In order to establish correspondences between shapes under-going non-rigid deformations, early approaches [46, 4, 47] focus on designing hand-crafted features by exploiting ge-ometric invariance. Nowadays, data-driven techniques have been widely adopted to learn features in a more flexible way, leading to significant improvements regarding accu-*Corresponding author: ruqihuang@sz.tsinghua.edu.cn
Figure 1. We train unsupervised non-rigid shape matching pipelines on the challenging non-isometric dataset DT4D-H, which involves 8 categories of humanoid shapes undergoing sig-nificant distortions. Correspondences are visualized by texture transfer. Our method (bottom row) outperforms the state-of-the-art, AttentiveFMaps [28] (middle row) and UDMSM [9] (top row), by a large margin. racy, efficiency, and robustness [10].
A noticeable trend among the learning-based shape matching approaches is based on the formalism of Deep
Functional Maps (DFM), pioneered by the FMNet [30].
Functional maps [37], as a spectral map representation, al-lows to encode maps into compact matrices and to express desirable map priors (e.g., area-preservation, isometry, bi-jectivity) in simple algebraic forms. In particular, by learn-ing features that optimize functional map priors, several un-supervised DFM frameworks [19, 43, 18, 13, 9, 28] have been proposed and, remarkably, achieve even comparable results with respect to the supervised counterparts. On the other hand, while the majority of DFM works focus on ex-ploring local, pairwise-level map priors, there is relatively less attention (with the exception of [9]) paid to the problem of injecting global map priors into DFM pipelines.
As a global map prior, cycle consistency has long been used as a powerful regularizer for jointly optimizing maps among shapes, both under point-wise [22] and func-tional [21, 24] map representation. In this paper, we exploit the utility of cycle consistency within DFM frameworks and propose a novel two-branch unsupervised DFM framework, which promotes cycle consistency in both spectral and spa-tial domains. We first re-examine the generic DFM frame-work and outline a theoretical condition, based on the resid-uals of a linear solver used in functional map estimation, that guarantees spectrally cycle consistency in DFM over training shapes. Then we identify the discrepancy that spec-trally consistent maps are not necessarily spatially, or point-wise, consistent. In light of this, we leverage our theoreti-cal insight to construct a latent shape in DFM and employ this construction to formulate a novel two-branch design of unsupervised DFM. We align each shapeâ€™s spectral embed-ding, represented as the eigenbasis of the Laplace-Beltrami operator, to a canonical space given by the constructed uni-versal latent shape. We then compute point-wise maps in this canonical embedding domain, which promotes consis-In the end, the tency across computed point-wise maps. point-wise maps are converted to functional maps, which are expected to agree with the ones from the original spec-tral branch. Overall, our two-branch DFM takes advantage of the justified spectrally cycle consistency and further en-hances it to spatially cycle consistent.
We conduct extensive experiments on several non-rigid shape matching benchmarks, and demonstrate that our method achieves superior performance over existing meth-ods, especially in the presence of significant distortions among shapes (see, e.g., Fig. 1). We also observe that our method, by enforcing the harmony of spatial and spec-tral map representations, reduces over-fitting during train-ing, which leads to remarkable generalization performance within an array of challenging tests. Finally, our two-branch design can be easily plugged into any existing DFM frame-work, and we show evidence that it achieves significant performance gains upon both recent and early DFM ap-proaches [43] with marginal computational burden.
To summarize, our main contributions are as follows: (1)
We perform theoretical analysis on spectrally cycle consis-tency of DFM frameworks; (2) We formulate a simple yet effective two-branch design of unsupervised DFM based on our theoretical justification, which introduces spatially cycle consistency. (3) We prove the effectiveness of our method through an array of challenging non-rigid shape matching tasks, demonstrating improvements upon existing methods in terms of accuracy, consistency, and generaliza-tion performance. 2.