Abstract
Panoptic Scene Graph generation (PSG) is a recently proposed task in image scene understanding that aims to segment the image and extract triplets of subjects, objects and their relations to build a scene graph. This task is particularly challenging for two reasons. First, it suffers from a long-tail problem in its relation categories, making naive biased methods more inclined to high-frequency rela-tions. Existing unbiased methods tackle the long-tail prob-lem by data/loss rebalancing to favor low-frequency rela-tions. Second, a subject-object pair can have two or more semantically overlapping relations. While existing meth-ods favor one over the other, our proposed HiLo framework lets different network branches specialize on low and high frequency relations, enforce their consistency and fuse the results. To the best of our knowledge we are the first to propose an explicitly unbiased PSG method. In extensive experiments we show that our HiLo framework achieves state-of-the-art results on the PSG task. We also apply our method to the Scene Graph Generation task that predicts boxes instead of masks and see improvements over all base-line methods. Code is available at https://github. com/franciszzj/HiLo. 1.

Introduction
Scene Graph Generation (SGG) [49] is a crucial task in image scene understanding that extracts triplets in the form of subjects, objects and their relations to build a scene graph. Subjects and objects are represented with bound-ing boxes. Since this task links vision and text, it holds great potential for a variety of applications, including visual question answering [27], image captioning [21, 8], image retrieval [32, 53, 51] and visual reasoning [1, 55].
Recently a novel variant of SGG was proposed, which is Panoptic Scene Graph generation (PSG) [62]. Subjects (cid:66) Corresponding author.
Figure 1. An example of the PSG task. We compare the pre-dicted object relations of different approaches. a) An image and its panoptic segmentation. Two persons and a sports ball are shown in different colors. b) A biased method predicts mostly high fre-quency relations. c) An unbiased method predicts mostly low fre-quency relations. d) Our method predicts both low and high fre-quency relations, as well as more relations in total. and objects are represented with panoptic segmentation [35] masks. Unless stated otherwise, in this work we focus on
PSG, since it is pixel-level accurate and also covers back-ground classes and their relations with foreground objects.
The performance of the PSG model is affected by a long-tail problem in its relation categories. For instance, relations such as over, in front of and holding occur tens of thousands of times in the PSG dataset [62], while others like swing-ing and kissing occur only a few dozen times. This severe class imbalance in the relation categories can lead to model predictions that are more inclined to high-frequency rela-tions, which poses significant challenges to the application of panoptic scene graphs in real-world scenarios.
Previous methods [12, 18, 39, 17] have often treated the long-tail problem of the PSG task as equivalent to the long-tail problem in object-centric tasks such as classification
[15, 5, 29] or semantic segmentation [14, 2]. Consequently,
these methods have employed re-balancing techniques to address class imbalance, either through re-sampling the data
[39] or by using a class-balanced loss [33] that assigns dif-ferent weights to different relation categories.
In contrast, in the relation-centric PSG task, a subject-object pair can have multiple relations that exhibit rela-tional semantic overlap, such as being partially or fully overlapping. For example, in Fig. 1, there are multiple relations between the boy and the sports ball, such as be-side, looking at, playing and chasing. For regular biased models [61, 65, 60, 46], the results are dominated by high-frequency relations (beside, looking at). For specifically unbiased models [66, 62], the results are dominated by low-frequency relations (playing, chasing). However, since the low frequency relations can be more specific (e.g. on and standing on) or only partially overlapping with high fre-quency relations (e.g. looking at and chasing), it is crucial to include both to fully understand the image. We found that relational semantic overlap occurs in large numbers in the PSG dataset [62] and that current methods do not ef-fectively address it. This is reflected in the increase in the category-averaged mean recall metric of unbiased methods, at the cost of the decrease in global recall (see Sec. 4.4).
To address the long-tail problem of scene graphs under relational semantic overlap, we introduce the HiLo frame-work. This framework simultaneously learns the high and low frequency relations in different network branches and unifies their strengths with the help of two novel consis-tency loss functions. We apply our framework on top of a novel baseline. This baseline uses a recent transformer-based approach [10] for panoptic segmentation and adapts triplet queries [62] and masked attention [10] for the PSG task. In summary, we make the following contributions:
• We identify the long-tail problem with relational se-mantic overlap in the PSG task and propose the HiLo framework to address this problem. The framework is general and can be applied to any PSG method.
• We propose a powerful and efficient one-stage end-to-end baseline. This baseline enhances the interac-tion between mask and relation prediction in the trans-former decoder layer.
• We conduct extensive experiments to demonstrate the effectiveness of our framework and baseline. Our re-sults outperform the state-of-the-art in both recall and mean recall on the PSG dataset and show systematic improvements on the VG dataset. 2.