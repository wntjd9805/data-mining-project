Abstract
We consider low-shot counting of arbitrary semantic cat-egories in the image using only few annotated exemplars (few-shot) or no exemplars (no-shot). The standard few-shot pipeline follows extraction of appearance queries from exemplars and matching them with image features to infer the object counts. Existing methods extract queries by fea-ture pooling which neglects the shape information (e.g., size and aspect) and leads to a reduced object localization ac-curacy and count estimates.
We propose a Low-shot Object Counting network with iterative prototype Adaptation (LOCA). Our main contribu-tion is the new object prototype extraction module, which iteratively fuses the exemplar shape and appearance infor-mation with image features. The module is easily adapted to zero-shot scenarios, enabling LOCA to cover the en-tire spectrum of low-shot counting problems. LOCA out-performs all recent state-of-the-art methods on FSC147 benchmark by 20-30% in RMSE on one-shot and few-shot and achieves state-of-the-art on zero-shot scenarios, while demonstrating better generalization capabilities. The code and models are available here: https://github. com/djukicn/loca.
Figure 1. LOCA injects shape and appearance information into object queries to precisely count objects of various sizes in densely and sparsely populated scenarios.
It also extends to a zero-shot scenario and achieves excellent localization and count errors across the entire low-shot spectrum. 1.

Introduction
Object counting considers estimation of the number of speciﬁc objects in the image. Solutions based on object de-tectors have been extensively explored for categories such as people [1, 33], cars [20, 12] or animal species [2, 32].
However, these methods require huge annotated training datasets and are not applicable to counting new, previ-ously unobserved, classes with potentially only few anno-tations. The latter problem is explored by low-shot count-ing, which encompasses few-shot and zero-shot counting.
Few-shot counters count all present objects of some class with only few of them annotated by bounding boxes (exem-plars), while zero-shot counters consider counting the most frequent class without annotations.
Few-shot counters have recently gained momentum with the emergence of a challenging dataset [24] and follow a common pipeline [18, 24, 13, 26, 31].
Image and exem-plar features are extracted into object prototypes, which are matched to the image by correlation. Finally, the obtained intermediate image representation is regressed into a 2D ob-ject density map, whose values sum to the object count esti-mate. The methods primarily differ in the intermediate im-age representation construction method, which is based ei-ther on Siamese similarity [18, 24], cross-attention [16, 13] or feature and similarity fusion [26, 31]. While receiv-ing much less attention, zero-shot counters follow a similar principle, but either identify possible exemplars by major-ity vote from region proposals [22] or implicitly by attention modules [11].
All few-shot counters construct object prototypes by pooling image features extracted from the exemplars into
ﬁxed-sized correlation ﬁlters. The prototypes thus fail to encode the object shape information (i.e., width, height
and aspect), resulting in a reduced accuracy of the den-sity map. Recent works have shown that this information loss can be partially addressed by complex architectures for learning a nonlinear similarity function [26]. Nevertheless, we argue that a much simpler counting architecture can be used instead, by explicitly addressing the exemplar shape and by applying an appropriate object prototype adaptation method.
We propose a Low-shot Object Counting network with iterative prototype Adaptation (LOCA). Our main con-tribution is the new object prototype extraction module, which separately extracts the exemplar shape and appear-ance queries. The shape queries are gradually adapted into object prototypes by considering the exemplar appearance as well as the appearance of non-annotated objects, obtain-ing excellent localization properties and leading to highly accurate counts (Figure 1). To the best of our knowledge,
LOCA is the ﬁrst low-shot counting method that explicitly uses exemplars shape information for counting. In contrast to most works [26, 24, 30, 31], LOCA does not attempt to transfer exemplar appearance onto image features, but rather constructs strong prototypes that generalize across the image-level intra-class appearance.
LOCA outperforms all state-of-the-art (in many cases more complicated methods) on the recent FSC147 bench-mark [24]. On the standard few-shot setup it achieves
∼30% relative performance gains, on one-shot setup even outperforms methods speciﬁcally designed for this setup, achieves state-of-the-art on zero-shot counting. In addition,
LOCA demonstrates excellent cross-dataset generalization on the car counting dataset CARPK [12]. 2.