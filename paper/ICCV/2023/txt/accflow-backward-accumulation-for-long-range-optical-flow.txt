Abstract
Recent deep learning-based optical flow estimators have exhibited impressive performance in generating local flows between consecutive frames. However, the estimation of long-range flows between distant frames, particularly un-der complex object deformation and large motion occlu-sion, remains a challenging task. One promising solution is to accumulate local flows explicitly or implicitly to ob-tain the desired long-range flow. Nevertheless, the accumu-lation errors and flow misalignment can hinder the effec-tiveness of this approach. This paper proposes a novel re-current framework called AccFlow, which recursively back-ward accumulates local flows using a deformable module called as AccPlus. In addition, an adaptive blending mod-ule is designed along with AccPlus to alleviate the occlusion effect by backward accumulation and rectify the accumula-tion error. Notably, we demonstrate the superiority of back-ward accumulation over conventional forward accumula-tion, which to the best of our knowledge has not been explic-itly established before. To train and evaluate the proposed
AccFlow, we have constructed a large-scale high-quality dataset named CVO, which provides ground-truth optical flow labels between adjacent and distant frames. Extensive experiments validate the effectiveness of AccFlow in han-dling long-range optical flow estimation. Codes are avail-able at https://github.com/mulns/AccFlow. 1.

Introduction
Optical flow is ideally a dense field of motion vectors that depicts the pixel-wise correspondence of two video frames. Since a variety of downstream applications (e.g., video editing [3, 14, 54], action recognition [42], and object tracking [1]) significantly benefit from the accu-racy of flow estimation, optical flow estimation turns out
† Corresponding authors. ‡ Equal contribution. ∗ Work was partially finished at the University of Electronic Science and Technology of China.
Figure 1: Comparisons of our method with RAFT [48] and GMA [19] on HS-Sintel dataset [18]. Zoom-in regions are annotated in red boxes. Our method outperforms other methods especially for occluded area. to be a long-standing fundamental task in computer vi-sion [41, 39, 40, 27, 26, 55, 25, 13].
Recent advances [6, 47, 48] resort to deep learning to estimate optical flow and achieve promising accuracy. Al-though remarkable performance has been achieved in the lo-cal flow estimation between two adjacent frames, it is non-trivial to estimate the long-range flow that records the pixel correspondence between two distant frames.
The long-range optical flow is a grounded research topic that has plenty of practical applications. For instance, in video completion [8], long-range optical flow is benefi-cial to the detail compensation between distant frames; in video key-point propagation [11], since the long-range op-tical flow performs holistic pixel-tracking in nature, it frees the quantity limitation of tracked pixels; in video super-resolution [31], it enables better inter-frame alignment in one sliding window; and in segmentation mask propaga-tion [51], it provides an explicit approach to propagate masks to distant frames, improving the interpretability com-pared to the implicit matching. The above examples take a glance at the wide applications of long-range optical flow.
More significantly, the success of this task has the poten-tial to break through the performance bottleneck of relevant tasks.
Surprisingly, even though the long-range optical flow is significant and can benefit many related tasks, few works put effort on this research line. One possible reason is the lack of public datasets that provide ground-truth bidirec-tional cross-frame optical flows for training and validation.
In literature, the early attempt to address this long-range op-tical flow task is Lim et al. [22], which proposed a method based on the forward flow accumulation, in which the flows of adjacent frames are added successively along the mo-tion trajectories. The recent work [18] follows this idea and reasons the occlusion regions from high-frame-rate frames.
Apart from these, one can simply estimate the long-range flow by employing methods specified for local flow [19, 48].
As shown in Figure 1, since the influence of occlusion is positively related to the time interval between two frames, the accuracy of flow estimation from these methods would be deteriorated severely or even be unacceptable when the
In addition, one can time interval is beyond a threshold. also traverse all pixels in a frame and employ the pixel-tracking methods [38, 11] to produce the long-range dense flow, which has huge computational overheads and cannot be used in applications requiring dense flow. To sum up, a considerate long-range optical flow method should address the following challenging issues: 1) Occlusion As the time interval increases, the flow esti-mation of two distant frames suffers significant degra-dation owing to the inter-frame occlusion. Therefore, without a specific design, the common methods that aim
Janai et at dealing with local flows perform poorly. al. [18] formulate it as an energy minimization prob-lem and found it highly non-convex, so they exploit the linearity of small motions and reasons about occlusions from multiple frames. However, this strategy is based on 240 FPS) and not applicable high-frame-rate videos ( on regular videos.
≥ 2) Accumulation error Although flow accumulation is a promising solution to tackle long-range flow estimation, it also brings the accumulation error, resulting in inac-curate estimation in non-occluded regions. Therefore, the effectiveness of accumulation error compensation is critical. Lim et al. [22] and Janai et al. [18] constrained the photo consistency of warped frames to shrink ac-cumulated error. However, the photo consistency loss is not comprehensive for flow estimation as revealed in [17, 24]. 3) Efficiency The computational complexity of long-range optical flow should be controlled at an appropriate level to support the downstream tasks in practice. Therefore, the pixel-tracking methods [38, 11], which iterative esti-mate the per-pixel long-range displacement, do not sat-isfy this requirement.
To address the above issues, we propose a novel frame-work, named AccFlow, to estimate long-range optical flow by progressively backward accumulating local flows with effective corrections. More specifically, to alleviate the oc-clusion effect, we propose the backward accumulation, a new accumulation strategy distinct from the forward ac-cumulation pipeline, and elaborate a corresponding deep module, named AccPlus. More details about the differ-ence between backward and forward accumulation can be found in Section 3.1 and 3.2. The AccFlow framework con-sists of three components: an arbitrary optical flow estima-tor, the AccPlus module, and an adaptive blending mod-ule. The arbitrary optical flow estimator is used to estimate local flows and long-range initial flow. The AccPlus per-forms the backward accumulation in feature domain. The adaptive blending module rectifies the accumulated error.
Furthermore, to train and validate our AccFlow, we elab-orately build a large-scale synthetic dataset, named CVO (cross-frame video optical flows). Different from other syn-thetic flow datasets [5, 6], the CVO includes comprehensive cross-frame bidirectional flow annotations. The CVO also includes more challenging cases that have large pixel dis-placement and severe occlusion.
The contributions of this paper can be summarized as follows:
We propose a novel backward accumulation strategy
• to alleviate the long-range occlusion.
•
We build the CVO, a new large-scale synthetic dataset with comprehensive cross-frame optical flow annotations.
We propose the AccFlow framework which is sim-ple yet effective to predict the long-range optical flow and achieves the state-of-the-art results on several benchmarks.
• 2.