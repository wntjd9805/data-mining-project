Abstract
Recent studies on face forgery detection have shown satisfactory performance for methods involved in training datasets, but are not ideal enough for unknown domains.
This motivates many works to improve the generalization, but forgery-irrelevant information, such as image background and identity, still exists in different domain features and causes unexpected clustering, limiting the generalization.
In this paper, we propose a controllable guide-space (GS) method to enhance the discrimination of different forgery domains, so as to increase the forgery relevance of features and thereby improve the generalization. The well-designed guide-space can simultaneously achieve both the proper separation of forgery domains and the large distance be-tween real-forgery domains in an explicit and controllable manner. Moreover, for better discrimination, we use a decou-pling module to weaken the interference of forgery-irrelevant correlations between domains. Furthermore, we make ad-justments to the decision boundary manifold according to the clustering degree of the same domain features within the neighborhood. Extensive experiments in multiple in-domain and cross-domain settings confirm that our method can achieve state-of-the-art generalization. 1.

Introduction
Face forgery technology [1, 2, 13] has made vigorous development in recent years. However, these realistic forgery faces are sometimes abused to maliciously disguise identities, especially celebrities and politicians, causing serious social problems. Therefore, how to reduce this risk has attracted widespread attention from researchers.
Convolutional neural networks (CNNs) have shown excel-lent performance in face forgery detection [10, 49, 32, 12].
According to forgery or not, this task is often formalized as a binary classification problem, and some suitable classifica-tion networks [32, 30] are introduced to this task. Although they perform well in the training domain, the learned features may be method-specific for the forgery methods within the
*Equal Contribution. †Corresponding author.
Figure 1. Limitations of existing methods: features from different domains are still clustered by forgery-irrelevant similarities (image background, hair color, identity, etc.), proving that features still contain forgery-irrelevant information, limiting the generalization. training set [5], and cannot show satisfactory generalization in unknown forgery methods.
Forgery data generated from various methods corresponds to different forgery domains. To improve the generalization in unknown domains, some works [22, 34, 6] study the com-mon artifacts of various forgeries and use data augmentation to synthesize more training data. Several other works are de-voted to mining better discriminative features, and attention mechanisms [47], local relation [7], and frequency informa-tion [21, 31] are also introduced to capture better forgery traces. SRM [26] suppresses the acquisition of color and tex-ture via high-frequency noise, thereby solving the overfitting to the training data. In addition, RECCE [5] copes with the complexity of various forgery domains by learning compact real representations based on the reconstruction. Compared with previous methods, the exploration of common charac-teristics and discriminative information allows the model to learn relatively more generalized features.
Nevertheless, during training, the model tries to increase the discrimination between real and fake features, but treats different forgery domains (i.e. different forgery methods) as the unified “fake” category without distinction. In common training sets [33, 23], there are some similarities between massive data in forgery-irrelevant information, such as hair color, image background, and identity. Due to the uniform
Figure 2. Comparisons of the forgery-relevance for model focusing results at different feature purities. fake categorization, the goal of training is only to distinguish the fake from the real, without making further distinctions between forgery types. As a result, as shown in Figure 1, some features will present a clustering phenomenon based on above forgery-irrelevant similarities (hair color, background, identity, etc.) rather than forgery domain characteristics that are more relevant to the forgery detection task. This demonstrates that the learned features inevitably still contain some forgery-irrelevant information [16].
The mixing of irrelevant information in features (i.e. the feature purity is not high) may limit the generalization. As shown in Figure 2 (a), in the training domain, guided by the supervised information, the model will learn a pattern of which features are more relevant, and show good perfor-mance in the current domain. However, in unseen domains, the feature distribution has a deviation. Following the origi-nal pattern, the features that the model focuses on will con-tain a high proportion of irrelevant information, which may cause the model to make decisions based on the similarity of such irrelevant information. On the contrary, as shown in
Figure 2 (b), when the feature purity is high, the irrelevant information contained in the feature itself is less. Even if the distribution of the unseen domain is biased, the proportion of irrelevant information in the extracted features will be cor-respondingly less. So we believe that higher feature purity will help the generalization, and we also give a theoretical proof in Appendix 1.
Based on above considerations, in this paper, instead of treating all forgery types as a unified category, we pro-pose a novel guide-space (GS) based framework to increase a proper level of discrimination between different forgery domains. In this way, by learning the differences between forgery domains and the consistency of the same domain, the model can further pay more attention to forgery traces. And separating the features of different domains can reduce their correlation in irrelevant information. The learned features are more forgery-relevant, thus helping the generalization.
Specifically, the increase in forgery domain discrimina-tion needs to be controlled within a certain range, because a larger real-forgery distance should be preferably main-tained at the same time. In this way, in unseen domains, the forgery features will be located far away from real features with a higher probability. Thus in our guide-space, we con-struct the guide embeddings of the real and different forgery domains, and make the features approach their respective guide embeddings to actively control the compactness of the real domain and the separation degree between different forgery domains. Further, considering that the correlation between different domains in terms of forgery-irrelevant sim-ilarity will interfere with the domain distinction, we mine this potential correlation based on the clustering results of the self-supervised features of images, and decouple the ir-relevant information accordingly. In addition, we design a decision boundary manifold adjustment module (A-DBM) based on the degree of feature aggregation, to better realize the feature distribution defined by the guide-space.
In summary, this paper has the following contributions:
• We argue that a proper level of discrimination be-tween different forgery domains is also important to improve the generalization, so as to capture more forgery-relevant information and to weaken the impact of forgery-irrelevant information.
• We construct a guide-space to achieve the controllable separation of both real-forgery domains and forgery-forgery domains, and further decouple the forgery-irrelevant correlation between different domains to re-duce their interference on domain separation.
• We design an adjustment strategy for the decision boundary manifold to make the features of the same domain better clustered and compliant with the distri-bution of the guide-space.
• Extensive experiments in multiple cross-domain set-tings confirm that our method can realize the state-of-the-art generalization, and achieve the cross-domain
AUC of 84.97% and 81.65% on CelebDF and DFDC. 2.