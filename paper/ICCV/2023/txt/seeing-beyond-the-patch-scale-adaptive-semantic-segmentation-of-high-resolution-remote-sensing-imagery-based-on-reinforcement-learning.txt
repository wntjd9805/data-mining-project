Abstract
In remote sensing imagery analysis, patch-based meth-ods have limitations in capturing information beyond the
This shortcoming poses a significant sliding window. challenge in processing complex and variable geo-objects, which results in semantic inconsistency in segmentation re-sults. To address this challenge, we propose a dynamic scale perception framework, named GeoAgent, which adap-tively captures appropriate scale context information out-side the image patch based on the different geo-objects. In
GeoAgent, each image patch’s states are represented by a global thumbnail and a location mask. The global thumb-nail provides context beyond the patch, and the location mask guides the perceived spatial relationships. The scale-selection actions are performed through a Scale Control
Agent (SCA). A feature indexing module is proposed to en-hance the ability of the agent to distinguish the current im-age patch’s location. The action switches the patch scale and context branch of a dual-branch segmentation network that extracts and fuses the features of multi-scale patches.
The GeoAgent adjusts the network parameters to perform the appropriate scale-selection action based on the reward received for the selected scale. The experimental results, using two publicly available datasets and our newly con-structed dataset WUSU, demonstrate that GeoAgent out-performs previous segmentation methods, particularly for large-scale mapping applications. 1.

Introduction
The acquisition of high spatial resolution (HSR) remote sensing images has become possible with the advance-ment of sensors [4]. These images enable the extraction of geospatial objects, such as buildings, roads, and aircraft, through image interpretation [47, 45, 22, 53]. Furthermore,
HSR remote sensing images facilitate the determination of more semantic land use/ land cover (LULC) categories, in-cluding industrial land, cropland, and residential land [8].
Such LULC mapping is critical in urban management, plan-*corresponding author.
Figure 1: Illustration of the scale problem for HSR remote sensing image LULC segmentation. The sliding window is enlarged for a better view. Legend: lake, pond. river, ning, and ecological conservation [3, 16, 30].
The task of LULC mapping requires the semantic cate-gorization of each pixel, also known as semantic segmen-tation. Recently, Fully Convolutional Networks (FCNs)
[25] have achieved significant progress for natural images in computer vision [43, 49, 17, 33, 50, 5]. Deep learning tech-niques have also shown success in the automatic interpreta-tion of HSR remote sensing images [15, 10, 51, 21, 29].
In contrast to conventional ground-based images, HSR remote sensing images have a large length and width that can encompass thousands of objects in a single image.
However, distinguishing LULC (Land Use and Land Cover) geo-objects that vary greatly at different scales using a fixed, finite size image patch is challenging. Although Fully
Convolutional Networks (FCNs) can theoretically receive input of arbitrary size, when processing HSR remote sens-ing images, a sliding window (SW) of a specific size is of-In small ten used to generate image patches [41, 40, 9]. patches, different LULC classes may consist of the same objects with similar patterns, making them almost indistin-guishable [52, 48]. For instance, the same water may ap-pear in rivers, lakes, and ponds, and the same dense hous-ing may belong to rural or urban residential land. More-over, some cultivated land and meadows may have similar
soils [37, 38]. Regardless of the multi-scale module’s de-sign [5, 19, 23, 50, 13, 44, 24], the model’s receptive field cannot surpass the image patch’s size [1]. Consequently, the commonly used Deeplabv3+ [5] model’s mapping re-sults exhibit an apparent grid effect due to the gap between the sliding window’s limited size and the river’s enormous scale, as illustrated in Figure 1.
The accurate segmentation of land use and land cover (LULC) in high spatial resolution (HSR) remote sensing images poses a challenge due to the significant scale vari-ance and limited receptive field of the network by patch size. Various models aim to address this issue by tack-ling the multiscale problem from the perspective of input data [6, 11, 7]. While incorporating contextual information can effectively resolve the problem of identifying rivers and water bodies within limited image patches, different LULC geo-objects necessitate different scales of image patches.
For instance, local image patches or slightly larger scales may suffice for identifying a pit pond, whereas lakes and continuous rivers may require larger scales. An inappropri-ate scale of receptive field may have an adverse impact on the segmentation.
The supervised learning methods have difficulty in adap-tively determining the appropriate patch scales, as it re-quires manual labeling of images that correspond to the ap-propriate context scale. In contrast, reinforcement learning (RL) algorithms operate through interactions between the agent and the environment, receiving rewards for actions and using that information to update model parameters, without requiring labeled data [36]. RL techniques have achieved success in various areas, including board games, video games, and mathematics [27, 35, 14]. Thus, applying deep RL techniques to LULC segmentation networks may allow for the adaptive adjustment of the receptive field scale based on image features, dynamically controlling the data flow of HSR remote sensing images. Therefore, we pro-pose a scale-adaptive segmentation network, called GeoA-gent to dynamically select appropriate patch scale based on different geo-obejcts. A HSR remote sensing segmentation dataset WUSU is constructed for experiment. The main contributions include: (1) A RL-based HSR imagery segmentation method is proposed. In GeoAgent, the HSR remote sensing images are represented by different states. GeoAgent observes dif-ferent states and performs a series of scale-selection actions to control the area of each patch, obtaining the final global mapping reward based on the selected scales. (2) A Scale Control Agent (SCA) is proposed to dynami-cally controls the scale of the GeoAgent. The SCA contains two parts: an ’actor’ network that learns a policy to map the states to a probability distribution of actions and a ’critic’ network that evaluates the value of each action using an ad-vantage function. A feature indexing module is proposed to enhance the agent’s ability to distinguish the location of the current image patch. (3) GeoAgent use a dual-branch segmentation network for multi-scale image patches segmentation. The input scale and context branch are switched under the control of the actions selected by SCA. The network processes the multi-scale context patches and local scale patches separately, and the multi-scale features are aggregated based on the geo-location information to generate the final multi-scale seg-mentation result. 2.