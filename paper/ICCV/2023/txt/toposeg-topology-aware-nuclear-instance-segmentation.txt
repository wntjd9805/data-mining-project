Abstract
Nuclear instance segmentation has been critical for pathology image analysis in medical science, e.g., can-cer diagnosis. Current methods typically adopt pixel-wise optimization for nuclei boundary exploration, where rich structural information could be lost for subsequent quan-titative morphology assessment. To address this issue, we develop a topology-aware segmentation approach, termed
TopoSeg, which exploits topological structure information to keep the predictions rational, especially in common sit-uations with densely touching and overlapping nucleus in-stances. Concretely, TopoSeg builds on a topology-aware module (TAM), which encodes dynamic changes of different topology structures within the three-class probability maps (inside, boundary, and background) of the nuclei to persis-tence barcodes and makes the topology-aware loss func-tion. To efficiently focus on regions with high topological errors, we propose an adaptive topology-aware selection (ATS) strategy to enhance the topology-aware optimization procedure further. Experiments on three nuclear instance segmentation datasets justify the superiority of TopoSeg, which achieves state-of-the-art performance. The code is available at https://github.com/hhlisme/toposeg. 1.

Introduction
Pathological image analysis is considered the gold stan-dard for cancer diagnosis, treatment, and prevention, where nuclear instance segmentation serves as the core step.
It is because the morphology of nuclei including the shape, appearance, and distribution within pathology images pro-vides interpretable features of diagnostic and prognostic
*Equal contribution (cid:66) Corresponding Author
Figure 1. The schematic illustration of pixel-wise loss and topology-aware loss. (Left) A patch in the image and its corre-sponding boundary ground truth, as well as the original boundary segmentation probability map and its corresponding instance pre-diction. (Top-right) The gradient map was obtained by pixel-wise loss, the 3D map of the boundary probability map and the opti-mization trend, as well as the final instance prediction. (Bottom-right) The gradient map obtained from topology-aware loss, the 3D image of the boundary probability map and the optimization trend, as well as the final instance prediction. cancer indicators[22].
Compared to general image object segmentation, nu-clear instance segmentation faces with some particular chal-lenges: (i) the crowded nuclei distribution leads to clustered overlapping instances. (ii) The blurry boundaries between touching or overlapping nuclei increase the difficulty of dis-tinguishing individual instances. (iii) Large variability in size, shape, texture and intensity of nuclei between different images requires more robust annotation and prediction [18].
To cope with these challenges, several studies have fo-cused on exploring innovative network architectures [12, 23, 25] and incorporating distance maps [3, 9, 19, 21] to en-hance segmentation performance. However, existing works typically rely on pixel-wise losses, such as CE/Dice loss,
which enforce predictions to align with GT pixel-by-pixel yet ignore the crucial structure information of instances.
Since treat pixels independently, they lack sensitivity to-wards high-level structural characteristics, such as the con-nectivity of boundaries, which are essential for the ratio-nal segmentation of individual instances. This inability of pixel-wise loss often leads to unreasonable results such as broken boundaries, bringing about failure to distinguish touching or overlapping instances. This consequently re-sults in undesirable effects on the subsequent quantitative morphology analysis. As depicted in Fig. 1 (top-right), pixel-wise loss focuses on misaligned pixels thus reducing pixel errors. However, due to the lack of perception of struc-tural information, the boundaries between overlapping in-stances with smaller pixel proportions are not given enough consideration and result in incorrect instance predictions.
To capture structural information of nuclear instances, we propose a novel topology-aware nuclear instance seg-mentation approach, termed TopoSeg. Specifically, we in-troduce a topology encoding method to encode topologi-cal features of three-class maps which are utilized to sep-arate individual instances. Building upon this, we propose a topology-aware module (TAM), which encodes dynamic changes and persistence of different topology structures within the predicted three-class probability maps to persis-tence barcodes and develops a topology-aware loss func-tion, integrating topology information into model learn-ing. As shown in Fig. 1 (bottom-right), with topology con-straints, the critical boundaries are identified and optimized, resulting in a reasonable segmentation outcome. To further adapt to the task of dense and small instances like nuclei, we introduce an adaptive topology-aware selection mod-ule (ATS) to concentrate on images and regions requiring topological optimization. Notably, TopoSeg effectively pro-motes instance segmentation performance without requiring any changes to the original network structure.
The contributions can be summarized as follows:
• We propose TopoSeg, which provides a new perspec-tive that goes beyond the common pixel-wise opti-mization paradigm and incorporates meaningful topol-ogy constraints for nuclear instance segmentation.
• We present a TAM to encode the persistence of topol-ogy structures in probability maps and introduce a topology-aware loss as a further constraint.
• We develop an ATS to identify regions that most re-quire topology optimization, enabling the model to ef-ficiently accommodate segmentation tasks involving small and dense objects.
• We justify the superiority of our TopoSeg on three nu-clei datasets with state-of-the-art performance. 2.