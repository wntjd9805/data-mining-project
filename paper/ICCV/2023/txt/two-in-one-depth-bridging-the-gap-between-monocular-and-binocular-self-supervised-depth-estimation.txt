Abstract
Monocular and binocular self-supervised depth estima-tions are two important and related tasks in computer vi-sion, which aim to predict scene depths from single im-ages and stereo image pairs respectively. In literature, the two tasks are usually tackled separately by two different kinds of models, and binocular models generally fail to pre-dict depth from single images, while the prediction accu-racy of monocular models is generally inferior to binocu-lar models. In this paper, we propose a Two-in-One self-supervised depth estimation network, called TiO-Depth, which could not only compatibly handle the two tasks, but also improve the prediction accuracy. TiO-Depth employs a Siamese architecture and each sub-network of it could be used as a monocular depth estimation model. For binocu-lar depth estimation, a Monocular Feature Matching mod-ule is proposed for incorporating the stereo knowledge be-tween the two images, and the full TiO-Depth is used to predict depths. We also design a multi-stage joint-training strategy for improving the performances of TiO-Depth in both two tasks by combining the relative advantages of them. Experimental results on the KITTI, Cityscapes, and
DDAD datasets demonstrate that TiO-Depth outperforms both the monocular and binocular state-of-the-art methods in most cases, and further verify the feasibility of a two-in-one network for monocular and binocular depth estimation.
The code is available at https://github.com/ZM-Zhou/TiO-Depth pytorch. 1.

Introduction
With the development of deep learning techniques, deep-neural-network-based methods have shown their effective-ness for handling both the monocular and binocular depth estimation tasks, which pursue depths from single images and stereo image pairs respectively [5, 12, 14, 57]. Since (cid:0) corresponding author
Figure 1. Diagrams of three kinds of self-supervised depth esti-mation models trained with stereo pairs: (a) Monocular model is tested with a single image but needs stereo pairs during training. (b) Binocular model is trained and tested with stereo pairs, but could not predict depths from a single image; (c) TiO-Depth could be tested with both single images and stereo pairs. it is time-consuming and labor-intensive to obtain abun-dant high-quality ground truth scene depths, monocular and binocular self-supervised depth estimation methods, which do not require ground truth depths for training, have at-tracted increasing attention in recent years [15, 18, 51, 55].
It is noted that the above two tasks are closely related, as shown in Fig. 1: both the monocular and binocular meth-ods output the same type of results (i.e., depth maps), and some self-supervised monocular methods [7, 17, 53] use the same type of training data (i.e., stereo pairs) as the binoc-ular models. Their main difference is that the monocular task is to predict depths from a single image, while the binocular task is to predict depths from a stereo pair. Due to this difference, the two tasks have been handled sepa-rately by two different kinds of models (i.e., monocular and binocular models) in literature. Compared with the monoc-ular models that learn depths from single image features, the binocular models focus on learning depths from the ge-ometric features (e.g. cost volumes [55]) generated with stereo pairs, and consequently, they generally perform bet-ter than the monocular models but could not predict depth from a single image. Moreover, it is found in [7] that al-though the whole performances of the monocular models are poorer than the binocular ones, the monocular models still perform better on some special local regions, e.g., the occluded regions around objects which could only be seen at a single view. Inspired by this finding, some monocu-lar (or binocular) models employed a separate binocular (or monocular) model to boost their performances in their own task [1, 7, 9, 13, 36, 38, 45]. All the above issues natu-rally raise the following problem: Is it feasible to explore a general model that could not only compatibly handle the two tasks, but also improve the prediction accuracy?
Obviously, a general model has the following potential advantages in comparison to the separate models: (1) Flex-ibility: This model could compatibly deal with both the monocular and binocular tasks, and it would be of great ben-efit to the platforms with a binocular system in the real ap-plication, where one camera in the binocular system might be occasionally occluded or even broken down. (2) High
Efficiency: This model has the potential to perform better than both monocular and binocular models, while the num-ber of its parameters is less than that of two separate models.
Addressing the aforementioned problem and potential advantages of a general depth estimation model, in this paper, we propose a Two-in-One model for both monocu-lar and binocular self-supervised depth estimations, called
TiO-Depth. TiO-Depth employs a monocular model as a sub-network of a Siamese architecture, so that the whole ar-chitecture could take stereo images as input. Considering that the two sub-networks extract image features indepen-dently, we design a monocular feature matching module to fuse features from the two sub-networks for binocular pre-diction. Then, a multi-stage joint-training strategy is pro-posed for training TiO-Depth in a self-supervised manner and boosting its accuracy in the two tasks by combining their relative advantages and alleviating their disadvantages.
In sum, our main contributions include:
• We propose a novel self-supervised depth estimation model called TiO-Depth, which could handle both the monocular and binocular depth estimation tasks.
• We design a dual-path decoder with the monocular feature matching modules for aggregating the fea-tures from either single images or stereo pairs, which may provide new insights into the design of the self-supervised depth estimation network.
• We propose a multi-stage joint-training strategy for training TiO-Depth, which is helpful for improving the performances of TiO-Depth in the two tasks. 2.