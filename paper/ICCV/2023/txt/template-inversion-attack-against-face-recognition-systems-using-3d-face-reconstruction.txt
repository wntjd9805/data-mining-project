Abstract
Face recognition systems are increasingly being used in different applications. In such systems, some features (also known as embeddings or templates) are extracted from each face image. Then, the extracted templates are stored in the system’s database during the enrollment stage and are later used for recognition. In this paper, we focus on template inversion attacks against face recognition systems and in-troduce a novel method (dubbed GaFaR) to reconstruct 3D face from facial templates. To this end, we use a geometry-aware generator network based on generative neural ra-diance fields (GNeRF), and learn a mapping from facial templates to the intermediate latent space of the genera-tor network. We train our network with a semi-supervised learning approach using real and synthetic images simul-taneously. For the real training data, we use a Generative
Adversarial Network (GAN) based framework to learn the distribution of the latent space. For the synthetic training data, where we have the true latent code, we directly train in the latent space of the generator network. In addition, during the inference stage, we also propose optimization on the camera parameters to generate face images to im-prove the success attack rate (up to 17.14% in our exper-iments). We evaluate the performance of our method in the whitebox and blackbox attacks against state-of-the-art face recognition models on the LFW and MOBIO datasets.
To our knowledge, this paper is the first work on 3D face reconstruction from facial templates. The project page is available at: https://www.idiap.ch/paper/gafar
1.

Introduction
Automatic face recognition (FR) has become a well-known biometric authentication tool which has been widely used in different applications, including smartphone locks, border controls, etc. In such systems, generally, some fea-tures (also referred to as facial embeddings or facial tem-plates) are extracted from users and stored in the system’s database during the enrollment stage.
In the recognition stage, either verification or identification, similar features are extracted from the user and are compared with the fea-tures in the system’s database. Therefore, facial features play the main role in automatic face recognition systems and convey important information about users.
Template inversion (TI) attack against FR systems refers to an attempt by an adversary to reconstruct face images from the templates stored in the system’s database. Then, the adversary may find sensitive information about the en-rolled users and also can use the reconstructed face image to impersonate and enter the system. Therefore, compared to most attacks on FR systems which threaten the security of the system [19, 3, 22, 18, 35, 34, 10], TI attack jeopardizes both security and privacy of users, and thus requires further study. In this paper, we introduce a novel method (called geometry-aware face reconstruction, shortly GaFaR) for the
TI attack in FR systems to reconstruct a 3D face from facial features (extracted from 2D FR models). The 3D face re-construction provides further information than 2D face re-construction, and in particular can be used to generate face image from any pose to improve the attack to the FR sys-tem. To our knowledge, this is the first paper on 3D face reconstruction from facial templates.
Recently, neural radiance fields (NeRF) [38] absorbed considerable attention in computer vision society due to re-markable results in the novel-view synthesis problem. Built upon NeRF, generative NeRF (GNeRF) methods such as
[37, 44, 56, 6, 8, 41, 42, 20, 55, 7, 12, 48, 43] combine con-ditional NeRF with generative models for geometry-aware
In these methods, a generative image generation tasks. model, such as a generative adversarial network (GAN), is used to embed the shape and appearance of an object in a latent space. Then, the latent code of the GAN, along with the camera parameters, are fed to a NeRF for the rendering process. Among GNeRF methods, there are several works, such as [8, 41, 42, 20, 55, 7, 12, 48], for geometry-aware 3D face generation, which can generate face images from different views.
In our proposed TI method, we use a geometry-aware face generator network based on GNeRF, and learn a new mapping from facial templates to the intermediate latent space of the generator network. We train our network using real and synthesized images simultaneously with a semi-supervised learning approach. For real training data where we do not have the corresponding latent code (i.e., unsuper-vised), we use a GAN-based framework to learn the distri-bution of the latent space. For the synthetic training data where we have true values of latent codes (i.e., supervised), we directly learn the latent space. Because we have 3D re-constructed face, we can use any arbitrary pose to inject the the FR system for the attack. Therefore, during the in-ference stage, we also use optimization on the camera pa-rameters to improve the attack against the FR system. We evaluate the performance of our proposed method in the whitebox (i.e., where the adversary knows the internal func-tioning and parameters of the FR model) and blackbox (i.e., where the adversary does not have information about the internal functioning of the FR model) attacks against state-of-the-art (SOTA) FR systems. For evaluation, we consider
FR systems with the LFW [23] and MOBIO [36] datasets and evaluate our attack if the reconstructed face can be used to enter the system. Fig. 1 illustrates sample face images from FFHQ [26] dataset and their 3D reconstruction from
ArcFace [11] templates using our attack.
To elaborate on the contributions of this paper, we list them hereunder:
• We propose a novel template inversion method to re-construct 3D faces from the facial templates of a face recognition system. To our knowledge, this paper is the first work on 3D face reconstruction from facial templates.
• We use a geometry-aware generator network based on
GNeRF, and learn a mapping from facial templates to the intermediate latent space of the generator network.
We train our mapping network using a GAN-based framework and a semi-supervised learning approach using real and synthetic face images.
• We use optimization on the camera parameters in the geometry-aware generator network during the infer-ence stage. The optimization of camera parameters can find a pose that improves the success attack rate.
The remainder of the paper is organized as follows. First, we review the related works in the literature in Sec. 2. Then, we present our proposed method in Sec. 3. Next, we de-scribe our experiments in Sec. 4 and discuss limitations and ethical considerations in Sec. 5. Finally, the paper is con-cluded in Sec. 6. 2.