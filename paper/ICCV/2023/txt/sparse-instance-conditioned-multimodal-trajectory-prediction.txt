Abstract
Pedestrian trajectory prediction is critical in many vi-sion tasks but challenging due to the multimodality of the future trajectory. Most existing methods predict multi-modal trajectories conditioned by goals (future endpoints) or instances (all future points). However, goal-conditioned methods ignore the intermediate process and instance-conditioned methods ignore the stochasticity of pedestrian motions. In this paper, we propose a simple yet effective
Sparse Instance Conditioned Network (SICNet), which gives a balanced solution between goal-conditioned and instance-conditioned methods. Speciﬁcally, SICNet learns compre-hensive sparse instances, i.e., representative points of the future trajectory, through a mask generated by a long short-term memory encoder and uses the memory mechanism to store and retrieve such sparse instances. Hence SICNet can decode the observed trajectory into the future prediction con-ditioned on the stored sparse instance. Moreover, we design a memory reﬁnement module that reﬁnes the retrieved sparse instances from the memory to reduce memory recall errors.
Extensive experiments on ETH-UCY and SDD datasets show that our method outperforms existing state-of-the-art meth-ods. In addition, ablation studies demonstrate the superi-ority of our method compared with goal-conditioned and instance-conditioned approaches. 1.

Introduction
Pedestrian trajectory prediction aims to predict pedestri-ans’ future paths given their observed trajectories. It plays an important role in autonomous driving [22, 43, 5], human mo-tion prediction [6, 12, 19], video surveillance [57, 48, 18, 32], and visual recognition [38, 42, 46]. Despite the recent ad-vancement [30, 49, 8, 36, 10], pedestrian trajectory predic-tion is still challenging due to the multimodality of future trajectories. As the pedestrian’s motions are stochastic and
∗Corresponding author. (b) Goal-conditioned methods.
Figure 1. Illustration of different multimodal prediction methods. (a) Goals, instances and sparse-instances prepared for the predic-(c) Instance-conditioned tion. methods. (d) Sparse-instance-conditioned methods. The sparse-instance-conditioned method is more accurate in in-between states than the goal-conditioned method and more ﬂexible than the instance-conditioned method, thus making the better prediction. indeterminate [29], multiple future paths are possible given their current states.
To handle multimodality, many methods [27, 49, 55] transform the multimodal trajectories into multimodal goals.
They ﬁrst predict various goals as modality representations and then sample multiple goals to generate diverse future trajectories. However, they only focus on goals while ne-glecting the intermediate movement process. As illustrated in Figure 1(b), although with accurate goals, the intermedi-ate process could be far from the ground truth. Thus, the multimodal goals are not equal to the multimodal future tra-jectories. It is necessary to consider the in-between states to comprehensively describe the multimodality of trajec-tory. Moreover, some other work [27, 28] predicts multi-modal trajectories conditioned by instances. However, the instance-conditioned methods will lead to motion stochastic-ity loss and modality redundancy, resulting in performance degradation and computational resource waste. As shown in
Figure 1(c), due to the reduced randomness of the instance-conditioned approach, the prediction retains the same bias
when the instance deviates from the ground truth.
To close this gap, we present a Sparse Instance Condi-tioned Network (SICNet). In our model, a sparse instance, which can give a comprehensive and adaptive description of future modality, is constructed by element-wise multi-plication between the future trajectory and a learned mask.
Hence, SICNet can predict the future trajectory more pre-cisely guided by the sparse instance. To obtained the related sparse instancs during inference, we adopt the memory mech-anism to store non-redundant sparse instances corresponding to all observed trajectories. Therefore, SICNet can recall its modality’s most related sparse instance and jointly generate the prediction during inference. Moreover, when the mem-ory meets an unfamiliar observed trajectory, i.e., a trajectory quite different from stored items, the memory mechanism may recall false experiences. Hence we propose a memory reﬁnement module with a reﬁnement loss to reduce such recall errors by bridging the gap between the recall and the ground truth. For multimodal trajectories generation, we can retrieve a certain number of the most likely sparse instances from the external memory and then generate corresponding multimodal trajectories. In addition, to further remove the redundancy from the retrieved sparse instances, we use the cluster mechanism as a post-process to obtain succinct mul-timodal proposals for the prediction instead of the sparse instance during inference.
Extensive experiments and ablation studies on two pop-ular pedestrian trajectory prediction datasets, i.e., ETH-UCY [31, 21] and Stanford Drone Dataset (SDD) [33], demonstrate the superiority of our method over prior state-of-the-art methods. In summary, our contributions are four-fold: (1) We give a balanced solution, i.e., a novel sparse instance, between the goal and instance to guide the multimodal trajec-tory prediction. (2) We propose a simple yet effective sparse instance conditioned network for the multimodal trajectory prediction. (3) We propose a memory reﬁnement module for the external memory to reduce recall errors when meeting unfamiliar observed trajectories. (4) Extensive experiments and ablation studies demonstrate the superiority and ﬂexibil-ity of our method compared with the goal-conditioned and instance-conditioned approaches. 2.