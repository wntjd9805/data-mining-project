Abstract
Generalizable face anti-spoofing (FAS) based on domain generalization (DG) has gained growing attention due to its robustness in real-world applications. However, these DG methods rely heavily on labeled source data, which are usu-ally costly and hard to access. Comparably, unlabeled face data are far more accessible in various scenarios. In this paper, we propose the first Unsupervised Domain Gener-alization framework for Face Anti-Spoofing, namely UDG-FAS, which could exploit large amounts of easily accessible unlabeled data to learn generalizable features for enhanc-ing the low-data regime of FAS. Yet without supervision sig-nals, learning intrinsic live/spoof features from complicated facial information is challenging, which is even tougher in cross-domain scenarios due to domain shift. Existing un-supervised learning methods tend to learn identity-biased and domain-biased features as shortcuts, and fail to specify spoof cues. To this end, we propose a novel Split-Rotation-Merge module to build identity-agnostic local representa-tions for mining intrinsic spoof cues and search the nearest neighbors in the same domain as positives for mitigating the identity bias. Moreover, we propose to search cross-domain neighbors with domain-specific normalization and merged local features to learn a domain-invariant feature space. To our best knowledge, this is the first attempt to learn gener-alized FAS features in a fully unsupervised way. Extensive experiments show that UDG-FAS significantly outperforms state-of-the-art methods on six diverse practical protocols. 1.

Introduction
Face recognition (FR) systems [13, 39] have been widely deployed in real-world applications for person authentica-tion, such as access control and electronic payments. How-ever, FR systems are vulnerable to presentation attacks, e.g.,
*Corresponding author: Wenrui Dai. †Equal contribution. Qualcomm
AI Research is an initiative of Qualcomm Technologies, Inc.
Figure 1. Different from traditional DG methods that rely on la-beled data for supervised training, our unsupervised domain gen-eralization can learn live/spoof features with more accessible unla-beled data in various environments. Then, we can directly deploy the unsupervised model via kNN or further finetune it with few la-beled data. Our method significantly improves performance with various few labeled live (L) and spoof (S) data for I&C&M to O. print attack, video replay and 3D mask. To address this is-sue, face anti-spoofing (FAS) methods have been proposed, including hand-crafted descriptors [12, 22, 33] and deep learning based methods [3, 25, 28, 49]. Despite promising results in intra-dataset scenarios, these methods are dramat-ically degraded in cross-dataset tests due to the domain gap across datasets. To facilitate generalization on unseen target domains, domain generalization methods [9, 26, 37, 43, 55] have been introduced in FAS to alleviate domain shifts.
Despite the improved generalizability, existing DG methods rely heavily on supervised training using labeled source data. However, labeled data are laborious and costly to obtain, leading to the notorious problem of limited data in
FAS. On the contrary, large amounts of unlabeled face data can be easily collected in various environments (e.g., from
Figure 2. T-SNE visualization of unsupervised features learned by
SimSiam [8] on Replay, CASIA, OULU. Different colors for (a) different classes(live/spoof), (b) domains and (c) identities, respec-tively. We randomly select 4 identities in OULU for visualization. access control systems). Thus, we study a more practical unsupervised domain generalization (UDG) [52] problem that aims to exploit more accessible unlabeled data to learn discriminative representations that generalize well across domains, thus reducing the reliance on labeled data and improving the low data regime of FAS. Fig. 1 illustrates a practical application of UDG for FAS. A model is first pre-trained on (large-scale) unlabeled data collected from vari-ous domains, and then released for deployment. In the de-ployment phase, we can directly employ the frozen unsuper-vised model via kNN or further finetune it with few labeled data. Fig. 1 shows that our method achieves superior per-formance, especially for more challenging real-world appli-cations with no labeled data or few labeled data.
Besides, the prepositive unsupervised learning can be a way of pretraining. Existing DG methods neglect model ini-tialization. It is a common practice to pretrain on ImageNet due to limited training data. However, ImageNet pretraining is not reasonable in FAS, since facial images differ signifi-cantly from natural images in the sense of data distribution, e.g., texture and context. While unsupervised pretraining on heterogeneous unlabeled FAS data from various domains is a reasonable initialization for DG. But directly applying off-of-shelf unsupervised learning methods may not achieve desirable performance on the FAS task, as shown in Fig. 1.
Recent advances in unsupervised learning focus on con-trastive learning, which enforces invariances to various aug-mentations. To avoid trivial solutions, contrastive methods,
MoCo [18] and SimCLR [6], introduce negative samples for pushing away. However, they are inherently not applicable for FAS. Due to the limited number of classes (only two of live/spoof), there are many false negative samples from the same class, which leads to a lot of noise and impairs the training process. BYOL [15] and SimSiam [8] employ the asymmetric network to eliminate the need for negative samples and succeed on natural images. However, they fail in FAS data, since facial representations contain additional complicated irrelevant factors, i.e., identity-related features.
This problem exacerbates in cross-domain scenarios, where the model may learn domain-related features as shortcuts.
As depicted in Fig. 2, existing methods learn identity-biased and domain-biased features rather than inherent live/spoof features. Without the actual FAS labels, it is hardly possi-ble to regulate the model to learn live/spoof-related features under the inherent disturbances of identity and domain bias.
To solve these issues, we propose the first Unsupervised
Domain Generalization framework for FAS, namely UDG-FAS. To alleviate the identity bias, we propose a novel Split-Rotation-Merge module to generate identity-agnostic local representations for mining intrinsic local spoof pattern. An input image is first split into patches and then randomly ro-tated. Subsequently, we merge several local embeddings encoded by different facial patches by averaging to mitigate identity-biased information while retaining the task-related one, since different facial regions usually share the same spoof cues. Besides, we propose to search the nearest neigh-bors in the same domain as positive samples for contrastive learning. By pulling close the images of various persons po-tentially from the same class, we can further mitigate iden-tity bias across identities and learn intrinsic spoof features.
Regarding domain-related bias, we propose to search the cross-domain nearest neighbors as positive samples. By en-forcing similarity on cross domain samples that may belong to the same class, we can learn domain-invariant features that generalize well on the target domain. Due to the dis-tribution shifts, directly searching NN across domains may lead to many false matches. Thus, we normalize the features of each domain to the same reference Gaussian distribution and combine the merged local features for a more accurate search. The contributions of this paper are summarized as:
• We propose the first unsupervised domain generalization framework for face anti-spoofing, which could use more accessible unlabeled data to learn generalizable features for improving the low-data status of the FAS community.
• We design a novel Split-Rotation-Merge module to gen-erate identity-agnostic local representations for mining intrinsic spoof features, and propose to search the near-est neighbors in the same domain as positive samples for contrastive learning to mitigate identity-related bias.
• We propose to search the cross-domain neighbors as pos-itive samples to learn a generalized domain-invariant fea-ture space. Domain-specific normalization with merged local features are leveraged to find more accurate neigh-bors for boosting performance.
To our best knowledge, we are the first attempt to mit-igate identity and domain bias, and learn generalized task-aware features in a fully unsupervised manner for FAS. We build six diverse UDG FAS benchmarks for evaluation. Ex-tensive experiments show our method achieves state-of-the-art performance on various challenging cross-domain intra-type and cross-domain cross-type protocols. 2.