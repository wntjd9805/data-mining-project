Abstract
Safety-critical applications such as autonomous vehi-cles and social robots require fast computation and ac-curate probability density estimation on trajectory predic-tion. To address both requirements, this paper presents a new normalizing flow-based trajectory prediction model named FlowChain. FlowChain is a stack of conditional continuously-indexed flows (CIFs) that are expressive and allow analytical probability density computation. This an-alytical computation is faster than the generative models that need additional approximations such as kernel den-sity estimation. Moreover, FlowChain is more accurate than the Gaussian mixture-based models due to fewer as-sumptions on the estimated density. FlowChain also al-lows a rapid update of estimated probability densities. This update is achieved by adopting the newest observed posi-tion and reusing the flow transformations and its log-det-jacobians that represent the motion trend. This update is completed in less than one millisecond because this reuse greatly omits the computational cost. Experimental re-sults showed our FlowChain achieved state-of-the-art tra-jectory prediction accuracy compared to previous meth-ods. Furthermore, our FlowChain demonstrated superior-ity in the accuracy and speed of density estimation. Our code is available at https://github.com/meaten/
FlowChain-ICCV2023. 1.

Introduction
Human trajectory prediction is a challenging problem because human movements are not deterministic, unlike the billiard balls on a pool table. Starting from determin-istic approaches [26, 49], to tackle its indeterministic na-ture, many stochastic approaches are proposed, such as
Gaussian distribution-based [1,42,66], generative adversar-ial networks (GANs)-based [9, 10, 25, 57], variational au-toencoder (VAE)-based [58, 71, 73], diffusion-based [24], and normalizing flow-based [59] methods. These methods
Figure 1. Effects of our FlowChain. Our FlowChain can rapidly estimate accurate density than VAE-based methods as shown in green. Furthermore, we propose an update of estimated density that only requires an instant of time, as shown in blue. can be applied to human-interactive systems, including au-tonomous vehicles [8,11,38,55,69] and social robots [4,39].
In these safety-critical applications, autonomous sys-tems must infer the existence probability density distribu-tion (“density” for brevity) of other moving objects such as pedestrians around on all prediction steps for risk assess-ment (i.e., collision avoidance). However, most of the in-deterministic approaches mentioned above merely generate possible future trajectories and cannot estimate the density alone. We need to further apply kernel density estimation (KDE) to these future trajectories for density estimation.
Thus, trajectory prediction with density estimation usu-ally takes a larger computational cost than only generat-ing possible trajectories. This computational cost accumu-lates upon every single prediction update along with highly-frequent observations. This is unacceptable to autonomous systems that work in rapidly changing environments.
To address both computational cost and density esti-mation, we propose a new normalizing flow-based model named FlowChain (Fig. 1). This speed and accuracy are be-cause normalizing flows need no additional approximation such as Gaussian mixture modeling or KDE with limited samples. FlowChain can estimate a density on each predic-tion time step thanks to our stacked normalizing flow archi-tecture unlike Flomo [59], which is closest to FlowChain.
While Flomo uses one flow module that only estimates the spatial density of a trajectory, FlowChain further predicts its spatio-temporal density so that the spatial density of an agent position at each time step is also predicted. This stacking architecture also allows a rapid update of an es-timated density in an instant of time e.g. less than one mil-lisecond. This update is achieved by reusing the flow trans-formations and its log-det-jacobians that represent the mo-tion trend such as going straight or turning right. This up-date with the reuse significantly omits the computational cost while maintaining the accuracy of density estimation because the motion trend doesn’t change for several time steps.
Our contributions are three-fold as follows:
• We propose a normalizing flow-based trajectory pre-diction network named FlowChain that rapidly esti-mates the accurate density of future positions on each prediction time step.
• Our update procedure for the density requires less than one millisecond by adopting new observations and reusing the motion trend as the flow transformations.
• Our FlowChain achieved comparable prediction accu-racy to other computationally-intense state-of-the-art methods on several benchmarks. 2.