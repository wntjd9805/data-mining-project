Abstract
Unsupervised anomaly detection and localization in im-ages is a challenging problem, leading previous methods to attempt an easier supervised one-class classiﬁcation for-malization. Assuming training images to be realizations of the underlying image distribution, it follows that nomi-nal patches from these realizations will be well associated between and represented across realizations. From this, we propose Inter-Realization Channels (InReaCh), a fully unsupervised method of detecting and localizing anoma-InReaCh extracts high-conﬁdence nominal patches lies. from training data by associating them between realiza-tions into channels, only considering channels with high spans and low spread as nominal. We then create our nominal model from the patches of these channels to test new patches against.
InReaCh extracts nominal patches from the MVTec AD dataset with 99.9% precision, then archives 0.968 AUROC in localization and 0.923 AU-ROC in detection with corrupted training data, competitive with current state-of-the-art supervised one-class classiﬁ-cation methods. We test our model up to 40% of training data containing anomalies with negligibly affected perfor-mance. The shift to fully unsupervised training simpliﬁes dataset creation and broadens possible applications. Code: github.com/DeclanMcIntosh/InReaCh 1.

Introduction
As a general ﬁeld, beyond computer vision contexts, anomaly detection seeks to detect abnormal data points within a larger dataset [6, 26]. In this paper, we focus on anomaly detection and localization in images, which proves to be a highly challenging form of anomaly detection due in part to the high dimensionality of the data [13, 34]. In recent works, anomaly detection in images has solely fo-cused on one-class classiﬁcation, also known as cold-start anomaly detection [2, 13, 25, 33, 34, 37]. Unsupervised
Figure 1. Examples of qualitative results of InReaCh on the
MVTec AD dataset [4]. Ground truth anomaly contours are shown in red. Anomaly localization scores are shown using the Jet Col-ormap, increasing from blue to red. The upper row shows example object classes, and the bottom row shows textural classes. problems have been avoided due to the increased difﬁcultly from anomaly corruptions in the dataset. Our primary goal is to reverse this trend by presenting a fully unsupervised anomaly detection method with competitive results to exist-ing one-class classiﬁcation methods. Industrial defect de-tection is a natural application for image anomaly detection, with its expectation of entirely nominal outputs for qual-ity assurance, leading to any anomaly being considered a defect, referred to as defect detection [4]. This domain is challenging due to the subtlety of possible anomalies, such as thin cracks or minor cuts, and the variety of classes, such as textural classes like leather contrasted with com-plex but small object classes such as transistors both from the MVTec Anomaly Detection benchmark [4]. Figure 1 shows some examples of these challenges.
A wide assortment of methods has been proposed for the one-class classiﬁcation anomaly detection problem that generally work in two stages. First, from the corruption-free training dataset, generate a model of nominal features found therein, then test new images for outliers from this model, 1
which are then scored as anomalies based on the divergence.
Notably, for any methods using this methodology, anoma-lies existing in the training data would be expected to be classiﬁed as nominal if similar anomalies occur in testing data. This need for anomaly-free training data exists for all major categories of image anomaly detection, including
Density Estimation [12, 28, 44, 48], Explicit one-class clas-siﬁcation [8, 29, 31, 48], Image Reconstruction [21, 22, 49], and Self-Supervised Classiﬁcation [1, 16, 19, 39]. More speciﬁcally, some anomaly detection methods which use this model-test scheme include Variational Autoencoders
[2, 3, 5, 38, 42], Generative Adversarial Networks [17, 30, 37, 41, 50], Self-Supervision [16, 1, 19, 39, 40, 25, 53],
Pre-Trained Convolutional Neural Network Patch Features
[13, 34, 46], Attention Guided [43, 45, 23], Structural Mod-elling [51, 7, 14, 52, 9], and Normalized Flows [24, 35, 36].
This is even true for statistical methods based on Gaussian
Mixtures or other statistical models [33, 18, 32], which may be somewhat tolerant of anomalies but still incorporate their inﬂuence into the modelled nominal distribution. Similarly, the self-supervised methods listed above are not unsuper-vised and still require purely nominal data in the training set [16, 1, 19, 39, 40, 25, 53]. Any corruption would consti-tute label noise in their training data.
We present Inter-Realization Channels (InReaCh), a fully unsupervised image anomaly detection method to move past one-class classiﬁcation. InReaCh builds on pre-vious patch-based methods generating patch-based feature descriptors from a pre-trained CNN’s intermediate feature hierarchies. InReaCh associates patches based on these fea-ture descriptors across images (realizations of the underly-ing image distribution) into channels. Then using the as-sumption that channels which associate well across realiza-tion and span a sufﬁcient portion of the training set realiza-tions are nominal with high conﬁdence. This creates a high-precision ﬁlter for selecting nominal patches in the train-ing data with medium recall. Finally, these ﬁltered nom-inal patches can be used in a similar context to previous one-class classiﬁcation methods, where similar patch-based methods have been shown to be highly sample efﬁcient [34], mitigating the initial ﬁlter’s lower recall.
Our experiments on the MVTec AD dataset show that our fully unsupervised method has comparative results to state-of-the-art supervised one-class classiﬁcation methods
[4]. InReaCh’s competitive results exist while our method is trained on corrupted MVTec AD datasets as well as in direct comparisons using uncorrupted data. InReaCh’s precision enables these results on corrupted data by selecting nominal patches with an average precision of 0.999 on the MVTec
AD dataset. Further, the shift from one-class classiﬁca-tion garners signiﬁcant beneﬁts outside of raw performance.
Our unsupervised method allows for (1) unsupervised data collection allowing us to leverage larger amounts of data, (2) windowed or recomputed nominal features for non-stationary problems such as outdoor environmental moni-toring, (3) application to problems where expected nominal data is not known a priori and creating a curated one-class classiﬁcation dataset is impossible. InReaCh fundamentally broadens possible applications for image anomaly detection beyond well-controlled industrial applications. 2.