Abstract
This paper presents a new, provably-convergent algo-rithm for computing the flag-mean and flag-median of a set of points on a flag manifold under the chordal metric. The flag manifold is a mathematical space consisting of flags, which are sequences of nested subspaces of a vector space that increase in dimension. The flag manifold is a superset of a wide range of known matrix spaces, including Stiefel and Grassmanians, making it a general object that is useful in a wide variety computer vision problems.
To tackle the challenge of computing first order flag statistics, we first transform the problem into one that in-volves auxiliary variables constrained to the Stiefel mani-fold. The Stiefel manifold is a space of orthogonal frames, and leveraging the numerical stability and efficiency of
Stiefel-manifold optimization enables us to compute the flag-mean effectively. Through a series of experiments, we show the competence of our method in Grassmann and ro-tation averaging, as well as principal component analysis. 1.

Introduction
Subspace analysis is a key workhorse of machine learn-ing since various forms of data and parameter sets admit a compact representation as a subspace of a high-dimensional vector space. Diffusion imaging data [19] or appearance variations of objects (e.g. human faces) under variable light-ing can be effectively modeled by low dimensional linear spaces [10], while a video as a whole can be modeled as the subspace that spans the observed frames [34].
A large body of the aforementioned approaches lever-age the mathematical framework of Grassmanian manifolds thanks to the ease in dealing with the confounding variabil-ity in observations [21, 22, 23, 27]. As such, they rely on statistical analysis tools inherently requiring mean or vari-ance estimations on matrix manifolds [14, 15, 34]. Yet, (i) they have been found to be susceptible to outliers, and (ii) while Grassmanians were suitable for analyzing tall data where the ambient dimension is much larger than the number of data points, they become less effective when it
Figure 1: Chordal averaging on the flag manifold
FL(1, 2; 3). The average (shown in purple) of the input (red and blue) lines remain in the average of the input planes. comes to wide data where the data dimension is relatively small [29]. In such cases, the more structured flag manifolds have been found to be more effective [29].
A flag manifold is a nested series of subspaces geomet-rically generalizing Grassmanians. Any multilevel, mul-tiresolution, or multiscale phenomena is likely to involve flags, whether implicitly or explicitly. This makes flag man-ifolds instrumental in dimensionality reduction, clustering, learning deep feature embeddings, visual domain adapta-tion, deep neural network compression and dataset analy-sis [35, 29, 50]. Thus, computing statistics on flag man-ifolds becomes an essential prerequisite powering several downstream applications.
In this paper, we propose an approach for computing first order statistics on (oriented) flag manifolds (c.f . Fig. 1)1. In particular, endowing flag manifolds with the non-canonical chordal metric, we first transform the (weighted) flag-mean problem into an equiv-alent minimization on the Stiefel manifold, the space of or-thonormal frames, via the method of Lagrange multipliers.
We then leverage Riemannian Trust-Region (RTR) optimiz-ers [12, 11] to obtain the solution. Subsequently, we intro-duce an iteratively reweighted least squares (IRLS) scheme to estimate the more robust flag-median as an L1 flag-mean.
Finally, we show how several common problems in com-puter vision such as motion averaging, can be translated onto averages on flag manifolds using group contraction op-erators [43]. In particular, our contributions are:
• We introduce a new algorithm for computing flag-prototypes (e.g. flag-mean and -median) of a set of points lying on the flag-manifold.
• Analogous to our flag-mean, we introduce an IRLS mini-1While our averages are for general flag-manifolds, we do provide ori-ented averages for flag manifolds of type 1, 2, 3, . . . , d − 1 in d-D space.
mization to estimate the flag-median.
• We prove the convergence of the proposed IRLS algo-rithm for the flag-median.
• We show how rigid motions can be embedded into flags and thus provide a new way to robustly average motions.
Our diverse experiments reveal that flag averages are more robust, usually yield more reliable estimates, and are more general, i.e., generalize Grassmannian averages. We will release our implementations upon publication. 2.