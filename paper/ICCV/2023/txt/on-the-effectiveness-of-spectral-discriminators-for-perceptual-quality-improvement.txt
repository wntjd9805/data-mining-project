Abstract
Several recent studies advocate the use of spectral dis-criminators, which evaluate the Fourier spectra of images for generative modeling. However, the effectiveness of the spectral discriminators is not well interpreted yet. We tackle this issue by examining the spectral discriminators in the context of perceptual image super-resolution (i.e., GAN-based SR), as SR image quality is susceptible to spectral changes. Our analyses reveal that the spectral discrimina-tor indeed performs better than the ordinary (a.k.a. spa-tial) discriminator in identifying the differences in the high-frequency range; however, the spatial discriminator holds an advantage in the low-frequency range. Thus, we suggest that the spectral and spatial discriminators shall be used si-multaneously. Moreover, we improve the spectral discrimi-nators by first calculating the patch-wise Fourier spectrum and then aggregating the spectra by Transformer. We verify the effectiveness of the proposed method twofold. On the one hand, thanks to the additional spectral discriminator, our obtained SR images have their spectra better aligned to those of the real images, which leads to a better PD trade-off. On the other hand, our ensembled discriminator pre-dicts the perceptual quality more accurately, as evidenced in the no-reference image quality assessment task. 1.

Introduction
Generative Adversarial Networks (GANs) [19] have gained widespread adoption in low-level vision tasks, e.g., image super-resolution (SR) [31], which improves the per-ceptual quality of reconstructed images considerably. From
This work was supported by the Natural Science Foundation of China under Grants 62022075 and 62036005, and by the Fundamental Research
Funds for the Central Universities under Grant WK3490000006. This work was also supported by the advanced computing resources provided by the Supercomputing Center of USTC. (Corresponding author: Dong
Liu.) (a) Spectra Statistics (b) Ground Truth (d) Super-Resolved (c) Low-Quality
Figure 1: Denote the reduced spectrum ˜S (r) as the azimuthal av-erage over the spectrum in normalized polar coordinates r ∈ [0, 1]. (a) shows spectra statistics E[ ˜S (r)] of Real-ESRNet [56] and
Real-ESRGAN [56] on the DIV2K [1] dataset. It illustrates that
Real-ESRGAN improves perceptual quality by producing more high-frequency information. (b), (c) and (d) present the average scores of Real-ESRGAN’s discriminator w.r.t. three types of im-ages. Given second-order degradation model [56] to generate low-resolution input, (c) are bicubic upsampled from low-resolution input, and (d) are generated by the generator, which takes low-resolution images as input. The extremely high score on (c) indicates that spatial discriminators may excessively favor high-frequency information, even if it is noise or artifacts. the perspective of PD tradeoff [2], GANs improve percep-tual quality by measuring the difference between image dis-tributions (perception) rather than signal differences (distor-In addition, Zhu et al. [73] found that trained dis-tion). criminators can perform no-reference image quality assess-ment (NR-IQA). Therefore, the key to improving the per-ceptual quality in GAN-based SR is to enhance the discrim-inator’s ability to measure the differences in image distribu-tions, which can predict image quality more accurately.
Recently, many studies indicate that images produced by
GAN have difficulty matching the spectral distribution of real data, especially in the high-frequency range [11, 13, 28, 12, 55, 3, 51]. Spectral discriminators [5, 26, 51] that utilize the Fourier spectrum as input have been shown to alleviate this problem. Nevertheless, the superiority of spectral dis-criminators over spatial discriminators remains unclear. In essence, the spectral discriminator measures the difference between the spectral distribution of real images and gen-erated images. Thus, to understand the effectiveness of the spectral discriminator, a spectral viewpoint is indispensable.
In this paper, we investigate the spectral discrimina-tors in the framework of GAN-based SR, as the qual-ity of the super-resolved images is susceptible to spec-tral change1.
Before examining the spectral discrim-inator, we evaluate how the spatial discriminator be-haves in SR. Fig. 1a shows the spectra statistics of Real-ESRNet [56] (distortion-oriented) and Real-ESRGAN [56] on the DIV2K [1] dataset, which illustrates that the intro-duction of the discriminator encourages the generator to produce more high-frequency components. In other words, the generator improves the perceptual quality by matching the spectra of real images2. Moreover, we estimate the aver-age score of Real-ESRGAN’s spatial discriminator on real, low-quality, and generated images (see Fig. 1b-Fig. 1d); de-spite the presence of noise and artifacts, low-quality images obtained the highest scores, indicating that the spatial dis-criminator may favor high-frequency data, even if it is in-correct. A natural question is whether the spectral discrim-inator’s effectiveness is related to its ability to compensate for this high-frequency flaw.
In an effort to answer the question, we further analyzed the spectra and observed that the spectra could be divided into three ranges, as revealed in Fig. 1a. We establish that it is a common phenomenon in image super-resolution al-gorithms from the frequency perspective of the PD trade-off, which encourages us to analyze the spatial/spectral dis-criminator by examining its robustness [49, 54, 47, 52] un-der frequency perturbations [54, 47, 52] within these three ranges. We observe that the spectral discriminator indeed performs better than the spatial discriminator in identifying the differences in the high-frequency range; however, the spatial discriminator has an advantage in the low-frequency range. Therefore, the spatial and spectral discriminators are complementary and are better to be used in combination.
Moreover, taking into account that the previous spec-tral discriminator [5, 26, 51, 14, 30] is an MLP with 1D 1It is well known that downsampling leads to loss or aliasing of fre-quency components, so SR image quality is susceptible to spectral change. 2As the Fourier transform is linear and invertible, the difference be-tween the distributions in the spatial domain and frequency domain is equivalent. Therefore, the closer the distributions are in the frequency do-main, the closer they are in the spatial domain. reduced spectrum as input, resulting in a loss of input in-formation, we propose spectral Transformer, which calcu-late patch-wise Fourier transform and then aggregate spec-tra with Transformer [9]. Combined with spatial Trans-former, our Dual Transformer (DualFormer) encourage the results of generator achieve better spectra alignment to real images, leading to an improved PD tradeoff. Addition-ally, we conducted NR-IQA tasks to demonstrate the align-ment of our method with human perception. Our method achieved better performance on natural distortion datasets such as LIVE-itW [18] and KonIQ-10K [22], as well as on image-processing distortion datasets such as PIPAL [25], compared to the previous baseline [73]. 2.