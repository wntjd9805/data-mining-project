Abstract
Generating accurate pseudo-labels under the supervi-sion of image categories is a crucial step in Weakly Su-pervised Semantic Segmentation (WSSS). In this work, we propose a Mat-Label pipeline that provides a fresh way to treat WSSS pseudo-labels generation as an image matting task. By taking a trimap as input which specifies the fore-ground, background and unknown regions, the image mat-ting task outputs an object mask with fine edges. The in-tuition behind our Mat-Label is that generating trimap is much easier than generating pseudo-labels directly under weakly supervised setting. Although current CAM-based methods are off-the-shelf solutions for generating a trimap, they suffer from cross-category and foreground-background pixel prediction confusion. To solve this problem, we de-velop a Double Decoupled Class Activation Map (D2CAM) for Mat-Label to generate a high-quality trimap. By draw-ing on the idea of metric learning, we explicitly model class activation map with category decoupling and foreground-background decoupling. We also design two simple yet ef-fective refinement constraints for D2CAM to stabilize opti-mization and eliminate non-exclusive activation. Extensive experiments validate that our Mat-Label achieves substan-tial and consistent performance gains compared to current state-of-the-art WSSS approaches. 1.

Introduction
Semantic segmentation is a fundamental task in com-puter vision that aims to assign pixel-level semantic labels to objects in an image.
In the last decade, the boom in deep neural networks has facilitated the rapid development of deep learning based semantic segmentation methods [3].
* Equal Contribution and † Corresponding Authors.
Figure 1. The schematic diagram of the pseudo-labels genera-tion pipeline based on the common CAM and our Mat-Label. The black line is the training phase workflow, and the blue line is the inference phase workflow, and the red line is the loss calculation.
However, fully supervised semantic segmentation models rely on expensive and time-consuming pixel-level annota-tions. Therefore, weakly supervised semantic segmentation (WSSS) has attracted increasing attention, as it is trained only by inexpensive annotations (e.g. scribbles [31], bound-ing box [9], or image-level [47] labels). In this work, we focus on WSSS based on image-level labels, which aims to use only object category labeling supervision and is consid-ered to be the cheapest yet most challenging setting.
Most of existing image-level WSSS methods usually adopt a pipeline containing the following three sequential steps: i) generating pseudo-labels through class activation maps, e.g. CAM [47]; ii) refining the pseudo-labels as seg-mentation ground truth masks; iii) training the segmenta-tion network under pseudo ground truth masks supervision.
Since the quality of the generated pseudo-labels in the first step has a great impact on the final segmentation results, many CAM-based variants [47, 40, 23] have tried to gener-ate better pseudo-labels under the supervision of only im-age category labels. However, the generation of complete and edge-accurate pseudo-labels is still unsatisfactory and challenging for existing CAM-based methods.
As a technique ignored by the current WSSS approaches, image matting [29] aims to utilize the input priori informa-tion (i.e. trimap that specifies the foreground regions, back-ground regions, and unknown regions) to predict the prob-ability that each pixel belongs to the foreground object (i.e. alpha matte α). There are two reasons that motivate us to explore the use of image matting to generate WSSS pseudo-labels. First, the alpha matte derived from image matting gives high response to foreground objects and low response to backgrounds, so the region of the object can be easily de-termined. In addition, alpha matte has more complete ob-ject activation and accurate edge representation than com-mon CAM [47], as shown in Figure 1 and Figure 2. With the above attractive properties, alpha matte can be used as an available form of pseudo-labels. Second, it is difficult to obtain complete and accurate activation of objects through
CAM [47] by relying on image category labels alone, but it is much easier to construct the trimap priori required for im-age matting. Specifically, trimap only needs to distinguish the foreground from the background as much as possible and marks the uncertain regions as unknown.
Motivated by the above discussions, we propose a pseudo-labels generation pipeline called Mat-Label, which treats WSSS pseudo-labels generation as an image mat-ting task, as shown in Figure 1 (b). Since the quality of trimap has a great impact on the final alpha matte [29], how to obtain a high-quality trimap with good foreground-background division under image category supervision only becomes the most urgent challenge for our Mat-Label to solve. The off-the-shelf solution is to use the classical
CAM [47] or its variants to build the trimap. However, there are two common flaws often exist with these CAM-based works: 1) The foreground region is incompletely ac-tivated, or the background region is over-activated; 2) Some foreground object pixels are classified in the wrong cate-gory. The flaw 1) is caused by the lack of unawareness and modeling of foreground and background in existing
CAM-based methods, while the flaw 2) is due to the non-exclusive activation [7] of different classes during the train-ing of the multi-label classifier. These two flaws prevent existing CAM-based methods from constructing a trimap with good foreground-background division.
To alleviate the above two flaws, we can generate class activation maps by explicitly modeling the fore-ground and background, inspired by recent approaches [35, 27, 41, 42] to model background in weakly supervised learning. However, these previous methods are designed to model category-independent background regions (e.g. sky, grass, and sea) and are not competent to category-dependent WSSS pseudo-labels generation task. There-fore, we develop a Double Decoupled Class Activation
Map (D2CAM) to construct a high-quality trimap for our
Mat-Label pipeline, in which we design a new class ac-tivation map learning strategy with both category decou-pling and foreground-background decoupling to accommo-date the WSSS task. On the one hand, we set category-separated classification ground truth to optimize the class activation map for each category individually, as shown in Figure 1 (b). On the other hand, we design a special foreground-background decoupled learning that is different from previous approaches, drawing on the idea of triplet loss [10] in metric learning. Specifically, we encourage the classification vector obtained from the foreground region to be close to the ground truth, while the classification vector from the background region is far from the ground truth to obtain a better foreground-background division and thus al-leviate the flaw 1). In addition, we design two simple yet effective class activation map refinement constraints to sta-bilize the optimization process and mitigate the flaw 2) by suppress non-exclusive activation, respectively. The main contributions of this work are summarized as follows:
• We propose an interesting and promising WSSS pseudo-labels generation pipeline called Mat-Label, which is the first solid baseline to treat WSSS pseudo-labels generation as an image matting task;
• We develop a Double Decoupled Class Activation Map (D2CAM) to generate category-dependent trimap with good foreground-background division for Mat-Label;
• We explicitly model class activation map with category decoupling and foreground-background decoupling by constructing category-separated classification ground truth and drawing on the idea of metric learning;
• We design two simple but effective refinement con-straints for class activation map training to stabilize optimization and eliminate non-exclusive activation.
Extensive experiments validates that our Mat-Label pipeline substantially achieves the state-of-the-art perfor-mance of WSSS on both PASCAL VOC 2012 and MS
COCO 2014 datasets. 2.