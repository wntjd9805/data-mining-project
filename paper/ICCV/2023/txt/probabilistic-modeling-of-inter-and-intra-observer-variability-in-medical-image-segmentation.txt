Abstract
Medical image segmentation is a challenging task, par-ticularly due to inter- and intra-observer variability, even between medical experts.
In this paper, we propose a novel model, called Probabilistic Inter-Observer and iNtra-Observer variation NetwOrk (Pionono). It captures the la-beling behavior of each rater with a multidimensional prob-ability distribution and integrates this information with the feature maps of the image to produce probabilistic segmen-tation predictions. The model is optimized by variational inference and can be trained end-to-end.
It outperforms state-of-the-art models such as STAPLE, Probabilistic U-Net, and models based on confusion matrices. Additionally,
Pionono predicts multiple coherent segmentation maps that mimic the rater’s expert opinion, which provides additional valuable information for the diagnostic process. Experi-ments on real-world cancer segmentation datasets demon-strate the high accuracy and efficiency of Pionono, making it a powerful tool for medical image analysis. 1.

Introduction
Artificial Intelligence (AI) algorithms have shown re-markable progress in image analysis, holding great promise for faster and more accurate diagnostic procedures [13, 27, 26, 3]. Nevertheless, in medical practice, there exists a high degree of variability among the opinions of different medical experts, even when the same expert assesses the same data at different times. This inter- and intra-observer variability has been reported across various tasks, includ-ing MRI-based segmentation of HCC lesions [7], lung can-cer segmentation in CT scans [14], and multiple fields in pathology [21, 2, 5, 22]. It leads to uncertainties when ap-plying AI models because in contrast to other classification tasks, there is not a single ground truth.
Especially in the medical domain, the careful model-ing of uncertainties in its different forms has a high prior-ity to minimize the risk of relying on incorrect predictions
Figure 1. The proposed Pionono model. The labeling behavior of each rater r is represented by a multivariate Gaussian distri-bution q(z|r). The drawn samples ˜zj are concatenated with the extracted features v of fω and then fed into the segmentation head fθ. The output simulates the inter- and intra-observer variability of annotations and is optimized using the real annotations sr of each rater. The model is trained end-to-end with a combination of log-likelihood loss (LL) and Kulback Leibler (KL) divergence between posterior and prior, combined in the overall loss LELBO.
[17, 26, 15, 13, 10]. In recent years, probabilistic methods, such as Bayesian Neural Networks [8] and sparse Gaussian processes [10, 33] have gained more and more attention, be-cause they are able to account for uncertainties in a sound manner. They showed promising results when modeling un-certainty in the network weights [8], data ambiguities[15] or attention weights [26]. Although inter- and intra-observer variability is often mentioned as a key challenge when ap-plying AI to medical data [21, 16, 28, 18], to the best of our knowledge there is no method that explicitly models these two types of uncertainty for medical image segmentation.
To address this gap, we propose a novel approach called the Probabilistic Inter-Observer and iNtra-Observer varia-tion NetwOrk (Pionono), depicted in Figure 1. This model accurately accounts for inter- and intra-observer variability using probabilistic deep learning. Specifically, each rater’s labeling behavior is represented as a probability distribution in latent space, and optimized using the log Evidence Lower
BOund (ELBO) in an end-to-end training process. The vari-ance of each rater’s distribution models the intra-observer variability, while the differences between the distributions models the inter-observer variability. When two raters ex-hibit similar labeling behavior, their probability distribu-tions overlap substantially, while different labeling behavior results in a small overlap of distributions.
The approach is validated in extensive experiments of prostate and breast cancer segmentation, using ’gold’ labels.
They reflect the expert agreement to show that our proba-bilistic modeling improves the predictive performance and estimates the predictive uncertainty. Furthermore, we also test its capability to model each rater’s labeling behavior.
As shown in the experiments, it can simulate expert opin-ions for a given test image in a consistent manner, provid-ing a realistic estimation of “what expert X would say in this case”. Our contributions can be summarized as follows:
• We propose Pionono, a probabilistic deep learning model that uses probability distributions in latent space to represent inter- and intra-observer variability. It can be trained with labels of multiple raters.
• The model is able to provide accurate segmentation predictions (compared to the expert agreement and dif-ferent expert opinions), outperforming existing state-of-the-art algorithms such as STAPLE, Probabilistic
U-Net and models based on global or local confusion matrices.
• Pionono provides uncertainty estimations that indicate areas where the predictions are not conclusive.
• The proposed model can provide several coherent seg-mentation hypotheses, simulating different medical experts. 2.