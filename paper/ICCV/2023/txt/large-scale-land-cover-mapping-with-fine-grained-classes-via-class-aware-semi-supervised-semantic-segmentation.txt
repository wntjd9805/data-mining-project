Abstract
Semi-supervised learning has attracted increasing atten-tion in the large-scale land cover mapping task. How-ever, existing methods overlook the potential to alleviate the class imbalance problem by selecting a suitable set of un-labeled data. Besides, in class-imbalanced scenarios, ex-isting pseudo-labeling methods mostly only pick confident samples, failing to exploit the hard samples during train-ing. To tackle these issues, we propose a unified Class-Aware Semi-Supervised Semantic Segmentation framework.
The proposed framework consists of three key components.
To construct a better semi-supervised learning dataset, we propose a class-aware unlabeled data selection method that is more balanced towards the minority classes. Based on the built dataset with improved class balance, we propose a Class-Balanced Cross Entropy loss, jointly considering the annotation bias and the class bias to re-weight the loss in both sample and class levels to alleviate the class im-balance problem. Moreover, we propose the Class Cen-ter Contrast method to jointly utilize the labeled and un-labeled data. Specifically, we decompose the feature em-bedding space using the ground truth and pseudo-labels, and employ the embedding centers for hard and easy sam-ples of each class per image in the contrast loss to exploit the hard samples during training. Compared with state-of-the-art class-balanced pseudo-labeling methods, the pro-posed method improves the mean accuracy and mIoU by 4.28% and 1.70%, respectively, on the large-scale Sentinel-2 dataset with 24 land cover classes. 1.

Introduction
Land cover mapping provides pixel-level information for urban management, climate change research, ecosys-tem protection, and other sustainability-related applica-*Corresponding author
Figure 1. Examples of the labeled data. The top row shows
Sentinel-2 images containing 13 bands. The bottom row shows the corresponding labels. We use a fine-grained classification sys-tem with 24 land cover classes in this work. tions [21, 27]. With the rapid progress of computer vi-sion technology, it is desired to automatically gain large-scale and fine-grained land cover information from remote sensing images to support the demand of existing earth sys-tem science studies and bring new opportunities for intel-ligent city study [31]. However, fine-grained annotations for land cover mapping are high-cost and time-consuming, limiting labeled data collection for large-scale applications.
Semi-supervised learning (SSL) is a potential solution to this problem, as it utilizes both existing labeled data and a large number of unlabeled data [37].
Large-scale land cover mapping with fine-grained classes usually suffers from class imbalance, as shown in
Figure 1 and 3. The labeled data tends to be biased due to the difficulty of data collection and label annotation vary-ing by class. The class imbalance leads to suboptimal per-formance in the minority classes. Most SSL methods for large-scale land cover mapping are typically based on the assumption that labeled and unlabeled data have the same class distribution [41, 37]. However, this assumption does not hold in most scenarios, resulting in the bias of class esti-mation. As such, it is non-trivial to jointly utilize the labeled and unlabeled data to train the network for semi-supervised semantic segmentation. Although many pseudo-labeling methods aim to assign pseudo-labels more steadily and cor-rectly for different classes on the unlabeled data, e.g., dy-namically setting threshold or proportion [17, 44], they still rely on setting hyperparameters and empirical principles, resulting in a lack of flexibility and generalization ability in applications. Besides, pseudo-labeling methods mostly rely on easy samples with high confidence scores, thus failing to exploit the hard samples on the unlabeled data.
To alleviate the above issues, we propose a unified Class-Aware Semi-Supervised Semantic Segmentation frame-work. We exploit the potential of the unlabeled data and alleviate the class imbalance problem in large-scale land cover mapping with fine-grained classes. The proposed class-aware unlabeled data selection method constructs an
SSL dataset and compensates for the class imbalance on the labeled data. Based on the built SSL dataset, we propose a class-balanced learning method to remove the annotation bias and class bias on the SSL dataset. We dynamically es-timate the class prior information on the entire SSL dataset during training to re-weight both samples and classes of the loss function for the labeled data. Finally, we propose the
Class Center Contrast method to jointly use the labeled and unlabeled data for training. The ground truth and pseudo-labels are leveraged as the guide to decompose the feature embedding space. We estimate the hard, easy, and over-all embedding centers for each class per image and apply the contrastive loss to optimize the distances between class centers to utilize both easy and hard samples. The class im-balance issue is alleviated by utilizing the proposed method, and the performance of large-scale land cover mapping with fine-grained classes is effectively improved. 2.