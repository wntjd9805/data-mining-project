Abstract 3D instance segmentation aims to predict a set of ob-ject instances in a scene and represent them as binary fore-ground masks with corresponding semantic labels. How-ever, object instances are diverse in shape and category, and point clouds are usually sparse, unordered, and irreg-ular, which leads to a query sampling dilemma. Besides, noise background queries interfere with proper scene per-ception and accurate instance segmentation. To address the above issues, we propose the Query Reﬁnement Trans-former termed QueryFormer. The key to our approach is to exploit a query initialization module to optimize the initial-ization process for the query distribution with a high cov-erage and low repetition rate. Additionally, we design an afﬁliated transformer decoder that suppresses the interfer-ence of noise background queries and helps the foreground queries focus on instance discriminative parts to predict ﬁ-nal segmentation results. Extensive experiments on Scan-NetV2 and S3DIS datasets show that our QueryFormer can surpass state-of-the-art 3D instance segmentation methods. 1.

Introduction 3D instance segmentation is a fundamental task for 3D scene understanding, which aims to predict the semantic la-bels and the binary foreground masks for every object in the scene simultaneously. With the popularity of AR/VR [31], 3D indoor scanning [21], and autonomous driving [46], 3D instance segmentation has become a key technology facil-itating scene understanding. However, the complex layout of the scene and the variety of object categories pose se-vere challenges to 3D instance segmentation in segmenting similar objects and accurate point cloud masking.
To overcome the above challenges, a series of 3D in-stance segmentation methods [11, 24, 4, 23, 39, 36] have been proposed. Generally, these methods can be di-vided into three categories: proposal-based [45, 11, 24], grouping-based [17, 4, 23, 39], and query-based [36].
Proposal-based methods [45, 11, 24] extract 3D bound-∗Corresponding Author
Figure 1. The visualization of query distribution and segmen-tation results.
A. The query initialization module samples a query on each of the two chairs to distinguish the two instances precisely. B. Repeated queries incorrectly split the complete board into two pieces. C. The denoising module removes many noise background queries and optimizes the ﬁnal segmentation results. ing boxes and utilize a mask learning branch to predict the object mask inside each box. Grouping-based meth-ods [17, 4, 23, 39] rely on a bottom-up pipeline that gen-erates predictions for each point (e.g., semantic categories and geometric offsets) and then groups the points into instances. However, proposal-based and grouping-based methods strongly rely on high-quality proposals and require manual selection of geometric properties and tuning of hy-perparameters. These drawbacks and limitations prompt query-based methods to be proposed and receive extensive attention from researchers. Query-based methods are re-garded as a class of transformer query-based methods [2, 5] in which each object instance is represented as an instance query. Query-based methods require a large number of queries spread throughout the scene to cover a large part of foreground objects in the scene so that there are one or even more queries on each covered object instance. Then a transformer decoder learns the instance queries by itera-tively focusing on multi-level point cloud features. Eventu-ally, the instance queries aggregate point cloud features to produce all instance masks in parallel.
Based on the discussion of the above approaches, query-based methods show great promise for 3D instance segmen-tation tasks by offering superior performance while not re-objects, while 15% of the 52% of the background queries are distributed near the instances. The background queries distributed near the instances are called noise background queries because the closer the queries are to the instances, the more negatively they affect the accurate segmentation of the instances. As shown in Figure 1(C), the foreground queries(red) incorrectly segment a part of the background as a foreground instance due to the interference of the noise background queries(green). Therefore, in addition to ensur-ing that foreground queries accurately segment foreground instances, it is equally essential to suppress the interference of noise background queries on the segmentation task.
Inspired by the above discussion, we propose a Query
Reﬁnement Transformer for 3D Instance Segmentation, named QueryFormer, including a point encoder, a query ini-tialization module, and an afﬁliated transformer decoder.
We use a generic U-net point cloud representation net-In the work [7] as the point encoder of the method. query initialization module, we aggregate the superpoint features [20] and the multi-level features extracted by the point encoder to the seed points through the Aggregation
Module. The Set Grouping module (SG) is designed to achieve a high coverage rate and low repetition rate dis-tribution of seed points on instances. Speciﬁcally, the set grouping module shifts seed points to the centers of the ob-jects to ensure a high coverage rate and ﬁlters out dupli-cate seed points to decrease the repetition rate and mini-mize the computational cost. The afﬁliated transformer de-coder is dedicated to suppressing the impacts of noise back-ground queries on the instance segmentation. Speciﬁcally, we generate some perturbed ground-truth centers around the instance centers during training. The perturbed cen-ters are encoded in the same space as the query and input to the decoder for mapping to a consistent feature space.
For each foreground instance, a unique query is matched by the Hungarian matching [18]. This query forms positive pairs with perturbed centers, while unmatched queries form several negative pairs with perturbed centers. We design a denoising module with contrastive loss [30] to drive the un-matched noise background queries away from the instance to reduce interference with the instance mask prediction.
In summary, the main contributions of this work are as follows: (i) We design a query initialization module to optimize the initialization process for a high coverage and low repetition rate query distribution, which further helps the proposed afﬁliated transformer decoder to achieve (ii) The proposed afﬁliated trans-more accurate results. former decoder suppresses the interference of noise back-ground queries and helps the foreground queries focus on discriminative parts for more accurate instance segmenta-tion. (iii) Extensive experimental results on two standard benchmarks, ScanNetV2 [8] and S3DIS [1], demonstrate that the proposed model performs favorably against state-Statistics on coverage rate&repetition rate and
Figure 2. query distribution. For query distribution, our method has more foreground distribution and less noise background queries and FPS initialization exists many noise background queries. Besides, our method guarantees a high coverage rate of foreground object in-stances while maintaining a low repetition rate. quiring high-quality 3D proposals and reducing the need for extensive manual setup. By analyzing the query-based method, we summarize the following two core points of query-based 3D instance segmentation: 1) How to effec-tively initialize queries? For the query-based method, we conclude that coverage and repetition rates are two signiﬁ-cant factors affecting query initialization. The coverage rate is deﬁned as the proportion of foreground object instances with queries distributed to the total foreground object in-stances in the scene. As the statistical results in Figure 2, the coverage rate of FPS [35] is 74% (Ours is 89%), and the lower coverage rate causes some objects to be missed. For example, as shown in Figure 1(A), the two chairs are incor-rectly segmented into one whole object because one chair is not covered by queries. The repetition rate is deﬁned as the proportion of queries that have other queries coexisting in the same foreground object instance to the total number of foreground queries. The higher repetition rate (64% vs our 47%) results in low query utilization and unnecessary overlapping computation. Besides, repeated queries con-tradict one-to-one bipartite matching mechanism and will destroy the integrity of segmentation results. As shown in
Figure 1(B), multiple queries split the board into two parts.
In practice, a high coverage rate often leads to a high rep-etition rate, and a low repetition rate is accompanied by a low coverage rate, so it is necessary to design an initial-ization strategy that can guarantee a high coverage rate of foreground object instances while maintaining a low rep-etition rate. 2) How to suppress the interference of noise background queries on accurate segmentation? Query-based methods yield outstanding performance but sample more queries than object instances in the scene. For ex-ample, sampling results by the Mask3D [36] in Figure 2 show that 48% of the queries are distributed on foreground
of-the-art 3D instance segmentation methods. 2.