Abstract
Few-shot image generation is a challenging task since it aims to generate diverse new images for an unseen cat-egory with only a few images. Existing methods suffer from the trade-off between the quality and diversity of gen-erated images. To tackle this problem, we propose Hy-perbolic Attribute Editing (HAE), a simple yet effective method. Unlike other methods that work in Euclidean space, HAE captures the hierarchy among images using data from seen categories in hyperbolic space. Given a well-trained HAE, images of unseen categories can be gen-erated by moving the latent code of a given image toward any meaningful directions in the Poincar´e disk with a fix-ing radius. Most importantly, the hyperbolic space allows us to control the semantic diversity of the generated im-ages by setting different radii in the disk. Extensive exper-iments and visualizations demonstrate that HAE is capable of not only generating images with promising quality and diversity using limited data but achieving a highly control-lable and interpretable editing process. Code is available at https://github.com/lingxiao-li/HAE. 1.

Introduction
Due to the persistent development of deep learning, the task of image generation has received significant re-search attention in recent years. Specifically, the Gener-ative Adversarial Networks (GANs) [21] and its variants (e.g., StyleGANv2 [34]) have succeeded in generating high-fidelity and realistic images, requiring a large number of high-quality data for model training. However, consider-ing the long-tail distribution and data imbalance widely ex-ists among different image categories [30], it is difficult for
GANs to be trained on categories with sufficient training images to generate new realistic and diverse images for a
*Corresponding author
Figure 1: Illustration of hierarchical attribute editing in hy-perbolic space. Hyperbolic space can naturally and compactly encode semantic hierarchical structures within a large image data corpus. Changing the high-level, i.e., category-relevant attribute
∆wr changes the category of an image. While changing low-level or category-irrelevant attribute ∆wir varies images within categories. category with only a few images. This task is referred to as few-shot image generation [10, 26, 30, 28, 29, 27, 15]. A variety of tasks can benefit from improvements in few-shot image generation, for instance, low-data detection [17] and few-shot classification [54, 57].
In general, existing GAN-based few-shot image gener-ation mechanisms can be classified into three categories.
Transfer-based methods [10, 39] introduce meta-learning or domain adaptation on GANs to generate new images by enforcing knowledge transfer among categories. Fusion-based methods [2, 23, 30, 28] perform feature fusion of multiple input images in a feature space and generate im-ages via decoding the fused features back to image space.
However, the output is still highly similar to the source im-ages. Transformation-based methods [1, 29, 27, 15] find intra-category transformations or inject random perturba-tions to conditional unseen category samples to generate images without tedious fine-tuning. By representing the images in the Euclidean feature space, the above learning mechanisms tend to be over-complicated, and the generated
images are often collapsed due to limited diversity.
Similar to the ubiquity of hierarchies in language [44, 56, 13], the semantic hierarchy is also common in im-ages [35, 11]. As Fig. 1 shows, the semantic hierarchies constructed in the language domain can be instantiated with visual images. From the visual perspective, an image can be regarded as a collection of attributes of multiple levels.
High-level attributes, a.k.a. category-relevant attributes, de-fine the category of an image, such as the shape and color of an animal [15]. For instance, in the middle row of
Fig. 1, changing the high-level attributes of the given im-age of a Shih-Tzu dog, the category can be changed to a Rhodesian Ridgeback Dog. While the low-level or fine-grained attributes, including expressions, postures, etc., that vary within the category as shown at the bottom of
Fig. 1, are called category-irrelevant attributes. Therefore, an image can also be viewed as a descendant of another image with the same category-relevant attributes by adding fine-grained category-irrelevant attributes to its parent im-age. To edit the visual attributes for high-quality image gen-eration, it is crucial to capture the attribute hierarchy within the large image data corpus and find a good representation space. Ideally, we aim to construct a hierarchical visual rep-resentation in a latent space that allows us to change the cat-egory of an image by moving the latent code in a category-relevant direction, and perform few-shot image generation by moving the code in a category-irrelevant direction.
Unfortunately, the Euclidean space and its correspond-ing distance metrics used by existing GAN-based methods can not facilitate the hierarchical attribute representation, thus the design of complicated attribute disentangling and editing mechanisms seems to be crucial for the generation quality. Inspired by the application of hyperbolic space in images [35] and videos [55], we found that the metrics in-troduced in hyperbolic geometry can naturally and com-pactly encode hierarchical structures. Unlike the general affine spaces, e.g., the Euclidean space, hyperbolic spaces can be viewed as the continuous analog of a tree since tree-like graphs can be embedded in finite-dimension with min-imal distortion [44]. This property of hyperbolic space pro-vides continuous and up to infinite semantic levels for at-tribute editing, allowing us to robustly generate diverse im-ages with only a few images from unseen categories with simple operations.
Based on the above findings, we propose a simple but effective Hyperbolic Attribute Editing (HAE) method for few-shot image generation. Our method is based on the ob-servation that hierarchical latent code manipulation can be easily implemented in Hyperbolic space. The core of HAE is mapping the latent vectors from the Euclidean space Rn to a hyperbolic space Dn. We minimize a supervised clas-sification loss function to ensure the images are hierarchi-cally embedded in hyperbolic space. Once we capture the attribute hierarchy among images, we can generate new im-ages of unseen categories by moving the latent code from one leaf to another with the same parents by fixing the ra-dius. Most importantly, the hyperbolic space allows us to control the semantic diversity of generated images by set-ting different radii in the Poincar´e disk. Those operations can well facilitate continually hierarchical attribute editing in hyperbolic space for flexible few-shot image generation with both quality and diversity.
Our contributions can be summarized as follows:
• We propose a simple yet effective method for few-shot image generation, i.e., hyperbolic attribute editing. In order to capture the hierarchy among images, we use hyperbolic space as the latent space. To the best of our knowledge, HAE is the first attempt to use hyperbolic latent spaces for few-shot image generation.
• We show that in our designed hyperbolic latent space, the semantic hierarchical attribute relations among im-ages can be reflected by their distances to the center of the Poincar´e disk.
• Extensive experiments and visualization suggest that
HAE achieves stable few-shot image generation with state-of-the-art quality and diversity. Unlike other few-shot image generation methods, HAE allows us to gen-erate images with better control of diversity by chang-ing the semantic levels of attributes we want to edit. 2.