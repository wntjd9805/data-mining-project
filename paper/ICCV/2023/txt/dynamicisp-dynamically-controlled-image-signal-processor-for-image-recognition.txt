Abstract
Image Signal Processors (ISPs) play important roles in image recognition tasks as well as in the perceptual qual-ity of captured images.
In most cases, experts make a lot of effort to manually tune many parameters of ISPs, but the parameters are sub-optimal. In the literature, two types of techniques have been actively studied: a machine learning-based parameter tuning technique and a DNN-based ISP technique. The former is lightweight but lacks expressive power. The latter has expressive power, but the computational cost is too heavy on edge devices. To solve these problems, we propose “DynamicISP,” which consists of multiple classical ISP functions and dynamically controls the parameters of each frame according to the recognition result of the previous frame. We show our method success-fully controls the parameters of multiple ISP functions and achieves state-of-the-art accuracy with low computational cost in single and multi-category object detection tasks. 1.

Introduction
The image signal processor (ISP) is an important com-It converts raw out-ponent of modern digital cameras. puts of the sensors, RAW images, into commonly used standard RGB (sRGB) images, and is composed of many functions because of its multiple roles. For example, it calibrates the color sensitivity of each sensor with a color correction matrix, and improves image quality with demo-saicing, denoising, and sharpening. Auto-exposure, auto-white balance, and tone mapping are necessary to mimic the adaptive and responsive characteristics of the human eye to produce images that closely resemble the appearance per-ceived by humans. The human eye cancels out the envi-ronment’s luminance with dark or light adaptation and also cancels out the environment’s color with color adaptation.
As to the response characteristics, it is said that the human eye non-linearly responds to light intensity roughly obeying y = x1/3 [38]. These functions for human eye adaptation
Differentiable ISP
DNN
Raise the tone on the stairs.
Controller
The stairs are too dark to see.
Figure 1. The concept of proposed DynamicISP. The parameters of the ISP are controlled dynamically based on what the downstream recognition model felt. have another role. Optimizing these functions for compres-sion enables conversion from high dynamic range signals in the real world to 8-bit sRGB images with little information loss. The real world has the range from 0.0001 [cd/m2] (starlight) to 1.6 billion [cd/m2] [34] (direct sunlight). We don’t go any further, but ISPs have more functions, like lens shading correction, dehazer, and bad pixel correction.
ISPs are also needed for image recognition tasks. DNN-based image recognition, which has achieved excellent re-sults recently, shows even better performance with ISPs
[10, 3]. However, ISP hyperparameters commonly re-quire manual tuning by experts, which consumes consid-erable time [27]. The tuning is necessary for each sensor.
It is ineffective and might be sub-optimal, especially for image recognition tasks. Easy-to-see images for humans are not equal to easy-to-recognize images. In fact, recent works demonstrate that the hyperparameter tuning for im-age recognition improves the accuracy [27, 46, 35, 39].
To achieve a better ISP for image recognition, we believe it is important to improve the expressive power of the ISP since most ISP functions are classical static functions. One solution is a DNN encoder-decoder-based ISP; many works indeed achieved state-of-the-art accuracy in image recog-nition performance [8, 26] and perceptual quality [33, 20].
However, the computation costs are enormous, especially when high-resolution outputs were required. Devices such as smartphones have limited computational resources and require an efficient ISP.
Based on the above, we propose “DynamicISP,” which consists of multiple conventional ISP functions, but their parameters are controlled dynamically per image. Although they are classical functions, their dynamic control compen-sates for their expressive power. Our controller is based on what the downstream recognition model felt and desired at the previous time step as shown in Fig. 1. Specifically, our method predicts appropriate ISP parameters for the follow-ing frame based on intermediate features of the downstream recognition model.
In terms of dynamic control, dynamic neural networks have been actively studied [44, 6] and a similar method, named NeuralAE, that controls auto-exposure with DNNs has recently been published [30]. Our method success-fully controls the parameters of multiple ISP functions, which is difficult even with these successful dynamic con-trol methods.
In addition, despite its low computational cost, our method achieves state-of-the-art accuracy com-pared to encoder-decoder based DNN ISPs.
Our contributions are as follows:
• A novel ISP for image recognition that utilizes clas-sical functions but dynamically controls their parame-ters based on what the downstream image recognition model senses.
• A residual output format of parameters, which decom-poses the control into static tuning to average good pa-rameters for the entire data set and further pursuit of the best parameters per image. It eases the difficulty of controlling complex functions.
• A latent update style ISP controller that manages mul-tiple ISP functions. It generates shared latent variables which indicate how to change the RAW images with the entire ISP pipeline; then, after applying each ISP function, sequentially updates them to contain infor-mation on what the remaining functions should do con-sidering upstream functions.
• End-to-end optimization method from ISP to image recognition model. A proposed parameter initializer module enabled the control of complex functions.
• Diverse evaluations show the effectiveness of the pro-posed DynamicISP. It achieves state-of-the-art accu-racy despite the low computational cost. 2.