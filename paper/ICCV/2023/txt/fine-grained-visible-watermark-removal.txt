Abstract
Visible watermark removal aims to erase the watermark from watermarked image and recover the background im-age, which is a challenging task due to the diverse wa-termarks. Previous works have designed dynamic network to handle various types of watermarks adaptively, but they ignore that even the watermarked region in a single im-age can be divided into multiple local parts with distinct visual appearances.
In this work, we advance image-specific dynamic network towards part-specific dynamic network, which discovers multiple local parts within the wa-termarked region and handle them adaptively. Specifically, we propose a query-based multi-task framework, in which part query embeddings are jointly used in two branches to predict part masks and restore watermarked parts. Exten-sive experiments demonstrate the effectiveness of our fine-grained watermark removal network. 1.

Introduction
Overlaying visible watermark on a digital image has been a prevalent way to claim copyright and declare own-ership. As its reverse process, visual watermark removal
[33, 56] has attracted more and more research interest, which can verify and promote the resilience of overlaid watermarks. Specifically, visible watermark removal aims to erase the watermark and reconstruct the watermark-free (background) image. One major challenge of watermark removal task is that the watermarks are very diversified, in terms of different locations, patterns, transparencies, and so on. Recent works [33, 56] realize this issue and develop dy-namic networks to cope with diversified watermarks adap-tively. For example, [33] extracts the feature of water-marked region and appends it to original feature map as ex-tra guidance. [56] also extracts the feature of watermarked region, but uses it to generate dynamic convolution kernel to manipulate the original feature map. Although [33, 56] have
*Corresponding author.
Figure 1. Two examples of watermarked images associated with their background images, watermark masks, and watermarks. Vis-ible watermark removal aims to erase the watermark and recon-struct the background image. achieved significant improvement over previous methods by adaptively coping with various types of watermarks, they still treat the watermarked region in an image as a whole, disregarding the fact that even the watermarked region in a single image could be divided into multiple parts with vastly distinct appearances. For example, the watermarked region in Figure 1(a) consists of one pattern and two lines of texts, and the watermarked region in Figure 1(b) consists of one symbol, one line of text, and extra curves. Moreover, when a watermark is overlaid on a background image with certain transparency, one part (e.g., one line of text) in the water-marked region could also exhibit diverse colors due to the colorful background, which makes the appearance of water-marked region even more complicated.
In this work, inheriting the spirit of previous works
[33, 56], we take a further step along the path of dynamic network. Specifically, we not only cope with the water-marked regions in different images adaptively, but also cope with different watermarked parts in one image adaptively, which advances image-specific dynamic network towards part-specific dynamic network. We adopt the multi-task framework used in previous works [33, 56], which contains one encoder and two encoders. The mask decoder accounts
for localizing the watermark and the background decoder accounts for recovering the watermarked region. Follow-ing previous works [33, 56], we also add skip connections
[42] linking one encoder with two decoders. To cope with different watermarked parts adaptively, we need to localize them in the mask decoder and repair them in the background decoder. Inspired by query-based network structures in pre-vious works [3, 6], we introduce query embeddings into our multi-task framework, which establishes a connection be-tween mask decoder and background decoder.
In particular, assuming that there are in total K fine-grained categories of watermarked parts, K part query em-beddings and one watermark-free query embedding inter-act with the encoder feature map through a transformer [45] block to produce adapted query embeddings. K +1 adapted query embeddings are expected to contain the part-relevant information and watermark-free information of one specific image. Then, we apply K + 1 adapted query embeddings to mask decoder and background decoder. In the mask de-coder, similar to [6], we calculate the similarity between
K + 1 adapted query embeddings with the last feature map in the mask decoder to generate K part masks correspond-ing to K part categories and one watermark-free mask. Dif-ferent from [6], we do not have ground-truth masks for K part categories. Hence, we enforce the union of K pre-dicted part masks to approach the ground-truth watermark mask and employ low-entropy loss [17] to push apart K predicted part masks. In the background decoder, we use
K adapted part query embeddings to produce K modulated convolution kernels for K part categories, which act upon
K local parts specified by K predicted part masks. In this way, we can restore different watermarked parts adaptively and achieve better restoration effect.
We conduct experiments on two benchmark watermark removal datasets: CLWD [38] and LOGO30K [8], to verify the effectiveness of our proposed method. Our contributions can be summarized as follows. 1) We are the first to con-sider fine-grained part categories in the visible watermark removal task, which advances image-specific dynamic net-work towards part-specific dynamic network; 2) We design a query-based multi-task framework, in which the adapted query embeddings are jointly used to localize different part categories in the mask decoder and restore the correspond-ing local parts in the background decoder; 3) Extensive ex-periments on two benchmark datasets demonstrate the ef-fectiveness of our proposed network. 2.