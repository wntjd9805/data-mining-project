Abstract
Autonomous vehicles operating in complex real-world environments require accurate predictions of interactive be-haviors between trafﬁc participants. This paper tackles the interaction prediction problem by formulating it with hierarchical game theory and proposing the GameFormer model for its implementation. The model incorporates a
Transformer encoder, which effectively models the relation-ships between scene elements, alongside a novel hierarchi-cal Transformer decoder structure. At each decoding level, the decoder utilizes the prediction outcomes from the previ-ous level, in addition to the shared environmental context, to iteratively reﬁne the interaction process. Moreover, we propose a learning process that regulates an agent’s be-havior at the current level to respond to other agents’ be-haviors from the preceding level. Through comprehensive experiments on large-scale real-world driving datasets, we demonstrate the state-of-the-art accuracy of our model on the Waymo interaction prediction task. Additionally, we val-idate the model’s capacity to jointly reason about the mo-tion plan of the ego agent and the behaviors of multiple agents in both open-loop and closed-loop planning tests, outperforming various baseline methods. Furthermore, we evaluate the efﬁcacy of our model on the nuPlan planning benchmark, where it achieves leading performance. Project website: https://mczhi.github.io/GameFormer/ 1.

Introduction
Accurately predicting the future behaviors of surround-ing trafﬁc participants and making safe and socially-compatible decisions are crucial for modern autonomous driving systems. However, this task is highly challenging due to the complexities arising from road structures, trafﬁc norms, and interactions among road users [14, 23, 24]. In recent years, deep neural network-based approaches have shown remarkable advancements in prediction accuracy and scalability [7, 11, 15, 22, 40].
In particular, Transformers have gained prominence in motion prediction [25,31,32,35,
Figure 1. Hierarchical game theoretic modeling of agent interac-tions. The historical states of agents and maps are encoded as background information; a level-0 agent’s future is predicted in-dependently based on the initial modality query; a level-k agent responds to all other level-(k − 1) agents. 45, 47] because of their ﬂexibility and effectiveness in pro-cessing heterogeneous information from the driving scene, as well as their ability to capture interrelationships among the scene elements.
Despite the success of existing prediction models in encoding the driving scene and representing interactions through agents’ past trajectories, they often fail to explic-itly model agents’ future interactions and their interaction with the autonomous vehicle (AV). This limitation results in a passive reaction from the AV’s planning module to the prediction results. However, in critical situations such as merge, lane change, and unprotected left turn, the AV needs to proactively coordinate with other agents. Therefore, joint prediction and planning are necessary for achieving more interactive and human-like decision-making. To address this, a typical approach is the recently-proposed conditional prediction model [17,34,36,37,39], which utilizes the AV’s internal plans to forecast other agents’ responses to the AV.
Although the conditional prediction model mitigates the in-teraction issue, such a one-way interaction still neglects the dynamic mutual inﬂuences between the AV and other road users. From a game theory perspective, the current pre-diction/planning models can be regarded as leader-follower games with limited levels of interaction among agents.
In this study, we utilize a hierarchical game-theoretic framework (level-k game theory) [5, 42] to model the in-teractions among various agents [27, 28, 41] and introduce a novel Transformer-based prediction model named Game-Former. Stemming from insights in cognitive science, level-k game theory offers a structured approach to modeling in-teractions among agents. At its core, the theory introduces a hierarchy of reasoning depths denoted by k. A level-0 agent acts independently without considering the possible actions of other agents. As we move up the hierarchy, a level-1 agent considers interactions by assuming that other agents are level-0 and predicts their actions accordingly. This pro-cess continues iteratively, where a level-k agent predicts others’ actions assuming they are level-(k−1) and responds based on these predictions. Our model aligns with the spirit of level-k game theory by considering agents’ reasoning levels and explicit interactions.
As illustrated in Fig. 1, we initially encode the driving scene into background information, encompassing vector-ized maps and observed agent states, using Transformer en-coders. In the future decoding stage, we follow the level-k game theory to design the structure. Concretely, we set up a series of Transformer decoders to implement level-k rea-soning. The level-0 decoder employs only the initial modal-ity query and encoded scene context as key and value to predict the agent’s multi-modal future trajectories. Then, at each iteration k, the level-k decoder takes as input the pre-dicted trajectories from the level-(k−1) decoder, along with the background information, to predict the agent’s trajec-tories at the current level. Moreover, we design a learning process that regulates the agents’ trajectories to respond to the trajectories of other agents from the previous level while also staying close to human driving data. The main contri-butions of this paper are summarized as follows: 1. We propose GameFormer, a Transformer-based inter-active prediction and planning framework. The model employs a hierarchical decoding structure to capture agent interactions, iteratively reﬁne predictions, and is trained based on the level-k game formalism. 2. We demonstrate the state-of-the-art prediction perfor-mance of our GameFormer model on the Waymo in-teraction prediction benchmark. 3. We validate the planning performance of the Game-Former framework in open-loop driving scenes and closed-loop simulations using the Waymo open motion dataset and the nuPlan planning benchmark. 2.