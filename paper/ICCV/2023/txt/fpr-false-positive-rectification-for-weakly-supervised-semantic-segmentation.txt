Abstract
Many weakly supervised semantic segmentation (WSSS) methods employ the class activation map (CAM) to gen-erate the initial segmentation results. However, CAM of-ten fails to distinguish the foreground from its co-occurred background (e.g., train and railroad), resulting in inaccu-rate activation from the background. Previous endeavors address this co-occurrence issue by introducing external su-In this paper, we present a pervision and human priors.
False Positive Rectiﬁcation (FPR) approach to tackle the co-occurrence problem by leveraging the false positives of
CAM. Based on the observation that the CAM-activated re-gions of absent classes contain class-speciﬁc co-occurred background cues, we collect these false positives and utilize them to guide the training of CAM network by proposing a region-level contrast loss and a pixel-level rectiﬁcation loss. Without introducing any external supervision and hu-man priors, the proposed FPR effectively suppresses wrong activations from the background objects. Extensive exper-iments on the PASCAL VOC 2012 and MS COCO 2014 demonstrate that FPR brings signiﬁcant improvements for off-the-shelf methods and achieves state-of-the-art perfor-mance. Code is available at https://github.com/ mt-cly/FPR. 1.

Introduction
Semantic segmentation aims to assign a semantic label to each pixel of an input image. Beneﬁting from the strong ca-pability of deep neural network (DNN) to extract semantic features, tremendous progress [41, 42] has been made on semantic segmentation with successful applications in au-tonomous driving, image editing, medical image analysis, etc. However, the training of a fully supervised segmen-tation model demands a large number of pixel-level anno-tations, which is labor-intensive and time-consuming. To
*Corresponding author
Label: ‘train’
Label: ‘no train’
Label: ‘train’
CAM
FPR (a) Co-occurance (b) False Positives (c) Ours
Figure 1. The main idea of our approach. (a) Conventional
CAM often suffers from co-occurrence issue, e.g., railroad and (b) The false positives of CAM contain the cues of co-train. occurred background, (c) which are leveraged in our FPR to dis-tinguish foreground. reduce the cost, weakly supervised semantic segmentation (WSSS) has been proposed to employ weaker supervision, such as image labels [22, 5, 2, 54], bounding box [13, 46], scribbles [38] and points [3] to train the model. Among them, WSSS with image-level labels has attracted much at-tention since image labels can be easily obtained from pop-ular datasets [40, 14, 16] or the Internet. In this work, we focus on the image-level labels based WSSS.
Most existing WSSS methods follow a two-stage pipeline: estimating the semantic localization maps by training a CAM [63] classiﬁcation network with image-level labels, followed by a reﬁnement stage. Unfortunately,
CAM suffers from two critical problems, i.e., incomplete estimation and co-occurrence issue. Incomplete estimation is caused by the fact that CAM only activates the most dis-criminative parts of objects, which has been well studied
in past years [22, 62, 2, 1, 17].
In opposite to the un-derestimation of incomplete estimation, co-occurrence is-sue refers to the overestimation of the foreground regions.
Some background objects often appear together with fore-ground objects, which makes CAM confused to distinguish co-occurred pairs (e.g., train and railroad, boat and water), resulting in co-occurred background falsely activated.
Several methods have been proposed to address the co-occurrence issue, EPS [33] trains the CAM classiﬁer un-der the guidance of saliency maps, which helps to sepa-rate the foreground (e.g., train) from the co-occurred back-ground (e.g., railroad). CLIMS [56] introduces the pre-trained CLIP [43] to locate and suppress the co-occurred background by feeding the corresponding textual prompts into the text encoder. In W-OoD [31], out-of-distribution images are manually collected as supplement training data to improve the CAM localization ability. However, these methods heavily rely on external supervision or require hu-man priors to manually specify a list of classes suffering from co-occurrence issue [31, 56].
In this work, we propose a False Positive Rectiﬁcation (FPR) approach to address the co-occurrence issue with-out introducing any external supervision (e.g., saliency map
[33], CLIP [56], and supplement images [31]) and human priors. The key insight of FPR is illustrated in Figure 1, we observe that the co-occurred background sometimes solely occurs in an image and will be falsely recognized as fore-ground class with relatively high probability in CAM, e.g., the background railroad is recognized as train. Such wrong activation from CAM of absent class, termed false positives, are useful but neglected by previous methods. We argue that the WSSS co-occurrence issue can be alleviated by ad-equately leveraging false positives cues.
In FPR, false positives are fully exploited to guide net-work learning in a two-step manner: online prototype com-In the ﬁrst step, all puting and training with prototypes. training images are fed into a trained CAM network to gen-erate class-speciﬁc positive and negative prototypes accord-ing to given image-level labels. These dataset-level proto-types are able to comprehensively represent the semantics of foreground and the co-occurred background. In the sec-ond step, we propose a Region-level Contrast loss (LRC) and a Pixel-level Rectiﬁcation loss (LPR) to train the network with prototypes. Speciﬁcally, LRC pushes predicted region-level representations close to their positive prototypes and pulls them away from their negative prototypes. LPR re-moves the pixels in the CAM-activated regions if their dis-tances to negative prototypes are less than their distances to the positive prototypes in the representation space. These two loss functions work together to exclude co-occurred backgrounds without destroying the integrity of foreground objects. We perform the above two steps iteratively so that prototypes can be updated online and provide better guid-ance for training.
In summary, our main contributions:
• We experimentally demonstrate the co-occurrence is-sues of WSSS can be alleviated without introducing any additional external supervision and human priors.
• The design of FPR does not modify the architecture of CAM network, it can be seamlessly integrated into off-the-shelf WSSS methods to enhance performance.
• Extensive experiments on PASCAL VOC 2012 and
MS COCO 2014 benchmarks demonstrate that FPR brings signiﬁcation improvement and achieves state-of-the-art performance. 2.