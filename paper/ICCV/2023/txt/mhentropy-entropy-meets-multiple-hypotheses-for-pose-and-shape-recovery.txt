Abstract
For monocular RGB-based 3D pose and shape esti-mation, multiple solutions are often feasible due to fac-tors like occlusions and truncations. This work presents a multi-hypothesis probabilistic framework by optimizing the Kullback–Leibler divergence (KLD) between the data and model distribution. Our formulation reveals a connec-tion between the pose entropy and diversity in the multi-ple hypotheses that has been neglected by previous works.
For a comprehensive evaluation, besides the best hypoth-esis (BH) metric, we factor in visibility for evaluating di-versity. Additionally, our framework is label-friendly – it can be learned from only partial 2D keypoints, such as vis-ible keypoints. Experiments on both ambiguous and real-world benchmarks demonstrate that our method outper-forms other state-of-the-art multi-hypothesis methods. The project page is at https://gloryyrolg.github.io/MHEntropy. 1.

Introduction
Pose and shape estimation is a core component of aug-mented and virtual reality applications. The majority of monocular 3D pose and shape estimation approaches [28, 31, 7, 3, 15] are designed to predict only a single solu-tion, yet 3D recovery from a monocular input is an inverse problem. Multiple solutions are feasible, especially under settings with occlusions, truncations, low image quality, or other ambiguities. It is therefore meaningful and desirable to make multi-hypothesis predictions. Multiple hypotheses are also useful in downstream tasks such as 2D keypoint fitting [21] and multi-view fusion [21, 25].
Previous multi-hypothesis works use various 2D [2, 21, 37], 3D [39, 25, 2, 21, 37, 35], and mesh [2] reconstruction losses to facilitate kinematically feasible poses and shapes, while encouraging diversity in the solution set. Yet the learning and evaluation for multi-hypothesis works are un-derdeveloped. Learning-wise, many existing works are not label-friendly and often require one-to-many labeled data to
*Equal contribution. (a) Occluded Input (b) Visible versus Occluded (c) Multiple Hypotheses
Figure 1. Our method estimates diverse and feasible hypotheses for occluded joints while preserving accuracy for visible joints. achieve diversity [21, 2, 35, 25], i.e., similar ambiguous ob-servations with multiple distinct ground-truth poses. Such labels are challenging to obtain, especially under occlusion or out-of-view scenarios for which multi-hypothesis predic-tions are the most meaningful. While empirical efforts have been made to avoid mode collapse while encouraging diver-sity [26, 27], these methods often do not fully explore the solution space. It is, therefore, non-trivial to achieve feasi-ble and as diverse as possible solutions.
Evaluation-wise, multi-hypothesis works use the best hypothesis (BH) as the metric of choice [25, 2, 21, 37, 26].
BH measures the closest distance between a hypothesis set and the ground truth. It emphasizes the accuracy of the clos-est hypothesis while ignoring the set holistically. Few works explicitly and quantitatively evaluate the diversity of the predicted hypotheses. When they do so, diversity is evalu-ated independently from the input [26]. Yet joints under oc-clusion or a lack of evidence feature more uncertainty, and as such should correspond to more diversity, while joints should be less diverse on unambiguous parts. Current multi-hypothesis evaluation schemes do not make such distinc-tions. Unwanted diversity on unambiguous joints also con-tributes to the calculation of overall diversity.
This paper addresses these shortcomings and presents a new multi-hypothesis framework for estimating 3D poses and shapes. At the heart of our method is a simple yet essential underlying criterion - hypotheses should be di-verse, but meaningfully so, and correlate with an obser-vation’s ambiguity (see Fig. 1 (b)). To that end, we take a probabilistically principled approach and minimize the
Kullback-Leibler (KL) divergence between the model dis-tribution and the underlying data distribution. Our objec-tive results in three terms: a reconstruction accuracy, a pose prior, and most interestingly, a model entropy term. This additional entropy term echoes the principle of maximum entropy [10], where the probability distribution is designed to align with observations but otherwise be as unbiased as possible. For pose estimation, this means that visible and unambiguous keypoints should remain fixed across the hy-potheses, while occluded and ambiguous keypoints should be feasible yet diverse (see Fig. 1 (b) and (c)).
Unlike existing works [35, 25, 21], our formulation for diversity does not require one-to-many training data.
In-stead, our model is trained by explicitly encouraging it to explore the feasible solution space via entropy maximiza-tion while remaining consistent with the evidence. For the implementation of our framework, we learn a conditional distribution of parameters with a normalizing flow model.
The parameters modelled come from parametric 3D models like MANO [33] and SMPL [30].
To be label-friendly, we advocate using weak labels; specifically, we recommend 2D keypoints from only visi-ble joints. Using 2D keypoint labels is well established in the literature [3, 22]. However, considering only visible 2D keypoints is not well-studied, even though it is highly intu-itive from an annotation point of view and a natural fit for multiple hypotheses.
For a comprehensive evaluation beyond the best hypoth-esis we introduce a Per-Joint Diversity (PJD) to measure the diversity of visible and occluded keypoints. Based on PJD, we further propose a Relative Diversity (RD) ratio to mea-sure the reasonable diversity of the hypotheses. A low ra-tio indicates that observed keypoints are deterministic while occluded keypoints are diverse. In experiments, our method finds highly accurate BH and achieves the best RD ratio compared to other multi-hypothesis approaches. To sum-marize our contributions,
• We formulate multi-hypothesis estimation as a mini-mization of the KL divergence between the model dis-tribution and the data distribution. This formulation is probabilistically principled and naturally yields an en-tropy term that encourages diversity in the solution set.
• From our KL formulation, we propose a framework to estimate multiple hypotheses of 3D pose and shape that favours feasible and diverse solutions by design.
• We emphasize visibility in multi-hypothesis frame-works by exploring visible 2D keypoints, i.e. partial weak labels for estimating 3D pose and shape and fac-toring in visibility for evaluating diversity.
• Experiments on toy, ambiguous, and real-world data demonstrate that our method achieves excellent diver-sity and the best BH compared to other state-of-the-art multi-hypothesis methods. 2.