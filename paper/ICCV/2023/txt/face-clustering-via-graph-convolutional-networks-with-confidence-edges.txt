Abstract
Face clustering is a method for unlabeled image an-notation and has attracted increasing attention. Existing methods have made significant breakthroughs by introduc-ing Graph Convolutional Networks (GCNs) on the affinity graph. However, such graphs will contain many vertex pairs with inconsistent similarities and labels, thus degrading the model’s performance. There are already relevant efforts for this problem, but the information about features needs to be mined further.
In this paper, we define a new con-cept called confidence edge and guide the construction of graphs. Furthermore, a novel confidence-GCN is proposed to cluster face images by deriving more confidence edges.
Firstly, Local Information Fusion is advanced to obtain a more accurate similarity metric by considering the neigh-bors of vertices. Then Unsupervised Neighbor Determina-tion is used to discard low-quality edges based on similar-ity differences. Moreover, we elaborate that the remaining edges retain the most beneficial information to demonstrate the validity. At last, the confidence-GCN takes the graph as the input and fully uses the confidence edges to complete the clustering. Experiments show that our method outperforms existing methods on the face and person datasets to achieve state-of-the-art. At the same time, comparable results are obtained on the fashion dataset. 1.

Introduction
In recent years, and thanks to existing works[24, 25], face recognition has rapidly developed and is now widely used in face verification, security systems, and other daily applications. This development relies on high-quality an-notated data, but manual annotation is extremely expensive and time-consuming. Therefore, face clustering emerges and becomes a primary technology to address the problem.
*This work was done when Yang Wu was an intern at JD.COM
†Corresponding author
Face clustering has gained considerable developments recently. Existing face clustering methods can be di-vided into two categories: unsupervised and supervised
[14, 4, 32, 7, 28, 27]. K-means [14], and DBSCAN [4] are representative unsupervised methods but perform poorly due to their limited capacities. Recently, a new unsuper-vised method FaceMap[35] has achieved positive results by adjusting the relationships between images to fit traditional clustering methods. Although this is very effective, original features are not clustering-oriented, so the performance will undoubtedly be subject to certain limitations.
Supervised learning methods [7, 33, 32, 21, 27] are mainly based on graph convolution networks (GCNs) [30].
Such methods first build face graphs by deeming images as vertices and then linking them based on their deep features, which are extracted from a trained Convolutional Neural
Network (CNN) [11]. In existing research [33, 32], such graphs are often called affinity graphs. The most common affinity graphs are built based on kNN [3] (k-nearest neigh-bors) relations, where each vertex is connected to its top k neighbors. With affinity graphs as input, a GCN can be uti-lized to capture the structural information and embed it into the features. Due to its powerful feature propagation capa-bility, the clustering performance is significantly improved.
However, several unfavorable factors limit GCN-based models. First, since the training and inference of CNN mod-els treat each image as an individual without considering their associations, images of different identities may have high similarity. The opposite may also occur in the same identities. Hence, affinity graphs would inevitably contain many undesirable edges whose endpoints have incompati-ble labels and similarities. GCN will propagate harmful in-formation through such edges and obtain polluted features, hindering performance. Second, real datasets often contain inaccurate labels. Even if the graph is clean enough, un-trusted labels will lead the GCN to learn incorrect informa-tion, which is not conducive to clustering.
To amend these drawbacks, we combine labels with sim-ilarities to adjust face graphs and propose a novel GCN
Figure 1. The framework of our method. Given face images (a), We first build affinity graphs (where each vertex is connected to k nearest neighbors (b)) based on the cosine similarity of the features. There exist numerous non-confidence edges in the graph. To get more confidence edges, we first use LIF (c) to derive a more reliable similarity metric ϕLIF between vertices. Then, based on the new metric,
UND (d) is used to find suitable neighbors for each vertex and build a graph. As UND discards neighbors based on similarity, hard examples will remain that need further treatment. A novel GCN model confidence-GCN (e) takes the graph as input to get enhanced features (f) and promote confidence. In the end, the traditional clustering method Infomap[19] achieves the clustering results (g). model to alleviate the influence of label errors, thereby boosting the clustering performance. The underlying prin-ciple is the more consistent the labels and similarities of the vertices are (i.e., vertices of the same (different) labels have a high similarity (difference) score), the better the per-formance will be. To formalize it, we propose the con-cept of confidence edges to denote the highly consistent edges. Specifically, given an affinity graph G = (V, E), its adjacent matrix A = (aij), and a threshold τ , let
H = {(vi, vj) ∈ E|vi, vj ∈ V, aij ≥ τ } be the set of high similarity edges, and L = E \ H is the set of low sim-ilarity ones. Meanwhile, we can partition E into S and D based on labels, where S is the set of edges whose endpoints have the same labels and D is the others. Cross combines similarities and labels to get the following four types: HS,
LS, HD, and LD, where HS and LD form confidence edges.
As illustrated in Figures 1, many non-confidence edges ex-ist in affinity graphs (b) whose similarity of endpoints can not reflect their categories. Thus, increasing the number of confidence edges will advance clustering performance.
To obtain more confidence-edges, we first re-evaluate the tightness between vertex pairs. The local information fu-sion (LIF) is proposed to mine the local information of the vertices and provide a more precise metric. For every vertex pair, LIF exploits the quantity and similarity differences be-tween common neighbors to improve the cosine similarity.
The new metric will contain sufficient contextual informa-tion to compensate for the weakness of the features. Conse-quently, the closeness of vertices in the same class increase with similar neighborhood structures, while others reduce.
Next, we propose unsupervised neighbor determina-tion (UND) to adjust the face graphs and increase the ratio of confidence edges. Existing kNN method cannot meet the need of each vertex. Many valuable edges will be discarded when k is small . However, if k is large , there will un-doubtedly be numerous non-confidence edges. The UND exploits the neighborhood statistics of every vertex in the affinity graph to filter out the most similar parts and get rid of the rest. With UND, a graph containing many confidence edges is derived. Better yet, the impact of incorrect labels eliminates since UND avoids using labels.
Then, GCN takes the graphs as input to increase the similarity (difference) between positive (negative) pairs and outputs features beneficial for clustering. To further in-crease the quantity of the confidence edges, we propose confidence-GCN, which gives a higher level of attention to the non-confidence edges and accelerates to narrow the gap between the labels and similarities. During training, the intra-class similarities and inter-class differences increase, which yields more confidence edges and speeds up conver-gence, forming a virtuous circle. Under the dual guidance of labels and similarities, the model can effectively deal with label errors and output better features to finish clustering.
The contributions of our paper are as follows.
• We propose confidence edges to guide the building of face graphs. And a novel con-GCN is proposed to fully utilize confidence edges and raise their share, thus sig-nificantly improving the performance.
• LIF and UND are proposed to increase the ratio of con-fidence edges to yield an improved face graph. Fur-thermore, UND is detailed using information theory to prove its effectiveness.
• Our approach achieves state-of-the-art performances on faces and person re-identification. Besides, a com-parable result is obtained on closets. 2.