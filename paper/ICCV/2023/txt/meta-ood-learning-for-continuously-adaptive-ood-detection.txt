Abstract
Out-of-distribution (OOD) detection is crucial to mod-ern deep learning applications by identifying and alerting about the OOD samples that should not be tested or used for making predictions. Current OOD detection methods have made significant progress when in-distribution (ID) and
OOD samples are drawn from static distributions. How-ever, this can be unrealistic when applied to real-world sys-tems which often undergo continuous variations and shifts in ID and OOD distributions over time. Therefore, for an ef-fective application in real-world systems, the development of OOD detection methods that can adapt to these dynamic and evolving distributions is essential. In this paper, we pro-pose a novel and more realistic setting called continuously adaptive out-of-distribution (CAOOD) detection which tar-gets on developing an OOD detection model that enables dynamic and quick adaptation to a new arriving distribu-tion, with insufficient ID samples during deployment time.
To address CAOOD, we develop meta OOD learning (MOL) by designing a learning-to-adapt diagram such that a good initialized OOD detection model is learned during the train-ing process. In the testing process, MOL ensures OOD de-tection performance over shifting distributions by quickly adapting to new distributions with a few adaptations. Ex-tensive experiments on several OOD benchmarks endorse the effectiveness of our method in preserving both ID classi-fication accuracy and OOD detection performance on con-tinuously shifting distributions. 1.

Introduction
Out-of-distribution (OOD) detection is vital to modern deep learning (DL) applications in the real world, especially in safety-critical applications such as autonomous vehicle control [21], and medical areas [64]. This is because DL systems may make over-confident and incorrect predictions when encountering the out-of-distribution (OOD) samples, which possess semantic labels that are distinct from those
*Corresponding to Jie Lu and Zhen Fang. The work is supported by the
Australian Research Council under Discovery Grant DP200100700.
Figure 1: Difference between existing static OOD detec-tion and a more realistic scenario of Continuously Adaptive
OOD Detection (Problem 1) when test samples come from continuously shifting distribution, i.e., Definition 1. of in-distribution (ID) samples [63]. To mitigate this issue, an important problem out-of-distribution detection has been proposed and studied extensively [10, 17]. In OOD detec-tion, the classifier is required to perform accurate predic-tions on ID samples while simultaneously identifying OOD samples. Many representative methods either utilize out-puts [17, 34], feature representations [29, 45], or gradients
[19, 32] to enlarge the separations between ID and OOD samples, while others [18, 39] incorporate auxiliary OOD samples to regularize the deep models during training.
Although OOD detection has achieved great progress, existing methods only focus on a simple scenario where
ID and OOD samples are assumed to be drawn from static
ID and OOD distributions. However, many real-world sys-tems are changing dynamically and thus inherently exhibit continuous distribution shifts over time. Take a self-driving agent equipped with a scene recognition system as an ex-ample: in the real world, the surrounding environment (e.g., illumination, weather) may shift continuously on the road, such as from day to night, and from clean to foggy. Treating the arriving training and test samples as from static distribu-tions may potentially harm the effectiveness of OOD detec-tion, leading to the misclassification of distribution-shifted
ID and OOD samples. Such scenarios highlight the lim-itations of current OOD detection methods when applied to continuously shifting distributions. Figure 1 highlights the difference between OOD detection on static distribution and when applying to continuously shifting distributions.
To tackle the continuously shifting scenarios in OOD de-tection, we propose a novel and realistic setting termed con-tinuously adaptive out-of-distribution (CAOOD) detection, which targets on developing OOD detection method to 1) quickly adapt to the continuously shifting ID distributions and 2) detect the continuously shifting OOD samples over time. Note that during the deployment time, the ID samples may be insufficient during the adaptation process. There-fore, how to enable dynamic and quick adaptation with in-sufficient ID samples to achieve good OOD detection per-formance over time is core challenge of CAOOD detection.
Inspired by domain adaptation [14, 6] and meta-learning
[13], we develop a novel and effective CAOOD detection method called meta out-of-distribution learning (MOL) to address the challenge in CAOOD detection. To dynamically and quickly adapt to the continuously shifting ID samples, we leverage the learning-to-learn paradigm [52] of meta-learning which aims to learn an internal representation for quick adaptation to a new task. Specifically, by formulat-ing adaptations to the continuous shifting ID samples as a variety of inner tasks, we design a meta-training proce-dure for learning to adapt explicitly. Further, to facilitate quick adaptation with insufficient ID samples, we propose to learn a meta-representation during training, which allows us to only update the light-weighted classifier during testing while keeping the meta-representation fixed. Additionally, considering OOD samples are unavailable in training, we propose to generate OOD samples based on the shifting ID feature representations. Lastly, the classifier is trained dis-criminatively based on both ID and virtual OOD samples.
The contributions are summarized as follows:
• We propose a more realistic OOD detection setting called CAOOD detection to promote the applications of OOD detection techniques in real-world scenarios.
• We develop technologies based on meta-learning and domain adaptation to quickly adapt to the continu-ously shifting ID distributions. With these technolo-gies, MOL is proposed to address CAOOD detection.
• We conduct extensive experiments comparing MOL with competitive OOD detection methods using vari-ous fine-tuning/adaptation strategies on 114 CAOOD detection tasks. Experiments show that MOL achieves the best performance for both ID classification and
OOD detection in continuously shifting distributions. 2.