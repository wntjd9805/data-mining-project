Abstract
Hyperspectral Image (HSI) reconstruction has made gratifying progress with the deep unfolding framework by formulating the problem into a data module and a prior module. Nevertheless, existing methods still face the prob-lem of insufficient matching with HSI data. The issues lie in three aspects: 1) fixed gradient descent step in the data module while the degradation of HSI is agnostic in the pixel-level. 2) inadequate prior module for 3D HSI cube. 3) stage interaction ignoring the differences in fea-tures at different stages. To address these issues, in this work, we propose a Pixel Adaptive Deep Unfolding Trans-former (PADUT) for HSI reconstruction. In the data mod-ule, a pixel adaptive descent step is employed to focus on pixel-level agnostic degradation. In the prior module, we introduce the Non-local Spectral Transformer (NST) to em-phasize the 3D characteristics of HSI for recovering. More-over, inspired by the diverse expression of features in dif-ferent stages and depths, the stage interaction is improved by the Fast Fourier Transform (FFT). Experimental re-sults on both simulated and real scenes exhibit the supe-rior performance of our method compared to state-of-the-art HSI reconstruction methods. The code is released at: https://github.com/MyuLi/PADUT 1.

Introduction
Hyperspectral Images (HSIs) have been widely applied in multiple fields, e.g., material identification [16, 17], spec-tral unmixing [15], and medical analysis [46, 7]. Conven-tional hyperspectral imagers are time-consuming and in-flexible when scanning a scene to capture the target HSI. To overcome this limitation and capture the diverse reluctance of a real scene, coded aperture snapshot spectral imaging (CASSI) modulates 3D HSI into a compressed 2D mea-surement by a coded aperture and a disperser [30]. Since the image quality of desired 3D HSI is restricted by the per-*Corresponding Author
Figure 1: Performance vs. GFLOPs. Under different model sizes, PADUT outperforms the state-of-the-art methods. formance of reconstruction algorithms, exploring effective reconstruction algorithms is of much importance.
To address the ill-posed reverse problem of HSI recon-struction, traditional model-based methods explore various priors in different solution space with interpretability. The widely employed priors can be summarized as non-local similarity [9, 43], low-rank property [22], sparsity [41] and total variation [6, 37], etc. However, these hand-crafted pri-ors have limited generalization ability and often result in a mismatch between prior assumptions and the problem.
Consequently, such methods cannot characterize the fea-tures of HSI under various scenarios and typically require time-consuming numerical iteration.
Recently, deep convolutional neural networks [36, 26, 3, 24] have been applied for HSI reconstruction and achieved decent performance. According to different learning strate-gies, deep learning-based methods can be broadly cate-gorized into two groups, i.e., end-to-end learning meth-ods [36, 24] and model-aided methods [34, 4]. End-to-end learning methods recover the original HSI via brute-force mapping to learn the spatial and spectral information. Some of these typical works include λ-Net [26], TSA-Net [24], and MST [3]. Without the guidance of physical models, these end-to-end learning methods are black boxes and lack transparency.
In contrast, the model-aided methods [34] leverage the physical characteristics of HSI degradation into
Figure 2: The coded aperture snapshot spectral imaging (CASSI) system. Different positions in the coded measure-ment may suffer from different levels of degradation.
Figure 3: Visualization of inner features of deep un-folding networks in the frequency domain. The Ampli-tude/Phase image is extracted by the inner feature with
Phase/Amplitude component set to a constant. deep networks, resulting in inherent interpretability. The most well-known model-aided approaches include Plug-and-Play (PnP) [25] and Deep Unfolding [14, 32, 4]. Since
PnP-based methods generally exploit a fixed pretrained de-noiser and fail to learn a specific mapping for HSI, their reconstruction performance is hampered. Recently, deep unfolding-based methods [32, 14, 4] have achieved signifi-cant improvements in HSI reconstruction.
As deep unfolding framework unfolds the iterative op-timization algorithms with neural networks, it typically in-cludes a data module and a prior module. As illustrated in
Figure 2, pixels in the 3D cube at different positions are compressed agnostically in the measurement, while the ex-isting algorithm ignores such pixel-specific degradation in the data module. For the prior module, denoiser plays a critical role in the multi-stage optimization. Since HSIs are in 3D representation, it remains an issue for existing denois-iers to effective use of spatial-spectral information.
Besides, during the iterative recovery process, cross-stage fusion is necessary to prevent the loss of key infor-mation while gaining comprehensive features. We observe that the frequency information varies at different stages and depths (see Figure 3). The features from the previous en-coder layer have clearer amplitude information, while the features from the previous encoder layer have clearer phase information. However, in the former works [32, 44, 4], the underlining differences of cross-stage features in the fre-quency domain are ignored, which incurs inferior perfor-mance of the multi-stage framework.
Inspired by the above findings, we propose a Pixel
Adaptive Deep Unfolding Transformer (PADUT) frame-work for HSI reconstruction. First, we introduce the deep unfolding framework for the reconstruction process with the position-specific degradation information taken into consid-eration in the data module. Second, we propose a Non-local
Spectral reconstruction Transformer for HSI to utilize the two-dimensional data of HSI in each stage. Third, we em-ploy the frequency component analysis of HSI to fuse the features across iterative stages. With the observation that the encoder feature and the decoder feature have different emphases in the frequency domain, we propose Fast Fourier
Transform Stage Fusion (FFT-SF) module, which leads to more comprehensive features for superb performance. The specific contributions of our work are:
• We propose a pixel adaptive deep unfolding trans-former for HSI reconstruction. In the data module, we introduce pixel-level adaptive recovery at different lo-cations. In the prior module, we propose a Non-local
Spectral transformer for HSI processing.
• We introduce a novel frequency perspective for the cross-stage features in the iterative reconstruction pro-cess. Particularly, amplitude and phase representations are employed to establish interactions between differ-ent stages and depths.
• We carry out extensive experiments on both simulation scenes and real scenes to exhibit the effectiveness of our method for HSI reconstruction. 2.