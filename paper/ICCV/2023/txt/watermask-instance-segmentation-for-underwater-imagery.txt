Abstract
Underwater image instance segmentation is a fundamen-tal and critical step in underwater image analysis and un-derstanding. However, the paucity of general multiclass instance segmentation datasets has impeded the develop-ment of instance segmentation studies for underwater im-ages.
In this paper, we propose the first underwater im-age instance segmentation dataset (UIIS), which provides 4628 images for 7 categories with pixel-level annotations.
Meanwhile, we also design WaterMask for underwater im-age instance segmentation for the first time.
In Water-Mask, we first devise Difference Similarity Graph Atten-tion Module (DSGAT) to recover lost detailed information due to image quality degradation and downsampling to help the network prediction. Then, we propose Multi-level
Feature Refinement Module (MFRM) to predict foreground masks and boundary masks separately by features at differ-ent scales, and guide the network through Boundary Mask
Strategy (BMS) with boundary learning loss to provide finer prediction results. Extensive experimental results demon-strates that WaterMask can achieve significant gains of 2.9, 3.8 mAP over Mask R-CNN when using ResNet-50 and
ResNet-101. Code and Dataset are available at https:
//github.com/LiamLian0727/WaterMask. 1.

Introduction
The field of underwater image vision is dedicated to the analysis and understanding of underwater images, and thus to the exploration, exploitation and protection of marine resources [17]. And instance segmentation assigns each pixel in the image to a specific semantic category and dis-tinguishes different individual objects in the same category
[11, 12, 33]. Since it is valuable in estimating object interac-tions and inferring scene geometry, instance segmentation is of great use in many underwater vision scenarios, such as underwater robot vision, autonomous underwater vehicle
*Corresponding Author
Figure 1: A simple comparison of Mask R-CNN and Wa-terMask R-CNN on UIIS dataset. The first, second and third columns indicate the original image, results of Mask
R-CNN and our WaterMask R-CNN, respectively. autopilot and underwater target recognition detection.
However, image instance segmentation for general un-derwater scenes has not been explored thoroughly. On the one hand, there is no general underwater image instance segmentation dataset to promote training and evaluation of instance segmentation models. The existing annotated data is either related to the application of instance segmentation for a specific object, like fish [10] and buildings [34], or only applicable for certain tasks such as object detection
[27], semantic segmentation [14]. These datasets are not general for the task of multi-class instance segmentation of underwater images. On the other hand, quality degrada-tion of underwater images is inevitable due to wavelength and distance-related attenuation and scattering [1]. More-over, sea snow formed by plankton and other organisms in the ocean may also cause varying degrees of noise, which is harmful for imaging quality. This leads to the fact that directly transferring the existing instance segmentation al-gorithms for natural images to underwater images, it will have a certain degradation on the segmentation results. We illustrate a simple case of utilizing Mask RCNN [12] for un-derwater scenes in Figure 1. We can see that Mask R-CNN
Figure 2: The figure shows pixel-level instance segmentation of specific object classes: humans, robots, fish, coral reefs, undersea rocks, and undersea wrecks/ruins, and the segmented masks are superimposed on the image. incorrectly assumes that the detector is part of the diver, but our WaterMask specifically designed for underwater images not only infers the correct segmentation, the segmentation mask also fits the object boundary precisely.
To alleviate this issue, we propose the first underwater image instance segmentation (UIIS) dataset, aiming to pro-mote the development of instance segmentation for under-water tasks. UIIS dataset contains 4628 images for 7 cat-egories with pixel-level annotations, including fish, coral reef, aquatic plant, etc. Simultaneously, we propose Wa-terMask for multi-object underwater image instance seg-mentation according to the intrinsic characteristics of un-derwater imagery. As far as we know, this is the first model specifically designed for underwater images. Under-water instances (especially boundaries) are difficult to seg-ment due to occlusion of similar instance clusters (e.g., fish swarms and coral reefs), quality degradation, and sea snow.
Classical instance segmentation methods[7, 12, 4, 20] are unable to accurately localize underwater object regions due to too many downsampling operations. As a result, the shape and details of the objects may be lost and distorted after segmentation. WaterMask reconstructs the highest resolution feature maps in the feature pyramid network based on our proposed Difference Similarity Graph Atten-tion Module (DSGAT) and uses these features to comple-ment missing details, helping the model to align objects.
We then designed the Multi-level Feature Refinement Mod-ule (MFRM) for WaterMask, which infers different resolu-tion masks by supplementing the degradation information so that higher resolution features can be utilized to fully predict the boundaries. Additionally, we devise Boundary
Mask Strategy (BMS) with boundary learning loss to pre-vent network overfitting by emphasizing the boundaries of the high-resolution masks, which guides the network to out-put more accurate instance masks.
We conducted extensive experiments to evaluate the ef-fectiveness of our method. Firstly, we integrate Water-Mask into the Mask R-CNN [12] framework, called Wa-terMask R-CNN. which achieves 2.9, 3.8 mAP improve-ment on the UIIS in ResNet-50 and ResNet-101 backbones.
Moreover, It tends to gain more improvement on a more stringent evaluation mechanism due to the network’s precise localization of the mask boundary part, as shown in Table 2.
Secondly, we also demonstrate the generalization ability of our approach on another pixel-based instance segmentation frameworks, Cascade R-CNN [3]. In summary, the main contributions of this work are concluded as follows:
• We construct the first general underwater image in-stance segmentation(UIIS) dataset containing 4,628 images for 7 categories with pixel-level annotations for underwater instance segmentation task.
• We propose the first underwater instance segmentation model WaterMask, as far as we know. In WaterMask, we devise DSGAT and MFRM modules to reconstruct and refine the image features with underwater imaging degradation, and Boundary Mask Strategy with bound-ary learning loss to optimize the boundaries of under-water clustered instances.
• Extensive experiments on public evaluation criteria demonstrate the effectiveness of the proposed UIIS dataset and WaterMask. 2.