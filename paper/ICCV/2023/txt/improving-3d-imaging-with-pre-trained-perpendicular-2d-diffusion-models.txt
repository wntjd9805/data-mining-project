Abstract
Diffusion models have become a popular approach for image generation and reconstruction due to their numer-ous advantages. However, most diffusion-based inverse problem-solving methods only deal with 2D images, and even recently published 3D methods do not fully exploit the 3D distribution prior. To address this, we propose a novel approach using two perpendicular pre-trained 2D diffusion models to solve the 3D inverse problem. By modeling the 3D data distribution as a product of 2D distributions sliced in different directions, our method effectively addresses the curse of dimensionality. Our experimental results demon-strate that our method is highly effective for 3D medical image reconstruction tasks, including MRI Z-axis super-resolution, compressed sensing MRI, and sparse-view CT.
Our method can generate high-quality voxel volumes suit-able for medical applications. The code is available at https://github.com/hyn2028/tpdm 1.

Introduction
The diffusion probabilistic model (DPM) uses neural networks to learn the gradient of the log probability distri-bution, ∇x log pdata(x), also known as the score function.
Sampling is done by either using Langevin dynamics [38] or solving the reverse stochastic differential equation (SDE) using the learned score function [40].
DPM has emerged as a leading generative model in the image field since its introduction [37, 15, 40], surpassing other models like GAN in achieving state-of-the-art perfor-mance [10, 30]. The confluence of the diffusion model with conditioning training is a noteworthy synergy, constituting a foundational framework within the domain of text-guided image generation [30, 32, 29]. Furthermore, its versatile applicability extends to novel realms like brain vision de-coding [3, 41].
It is also being explored as a generative model in other various areas such as audio [28, 22, 18], video [2, 36, 26], radiance field [27, 35], and graph [43, 17].
*These authors contributed equally to this work
Despite the slow sampling speed due to sequential sam-pling over multiple time steps, diffusion models offer sig-nificant advantages over other generative models, includ-ing sampling-time scalability. The pre-trained score func-tion model can be used for conditional sampling without retraining, thanks to Bayes’ theorem [10, 16]. This condi-tional sampling-based inverse problem-solving method can be interpreted as posterior sampling with diffusion gener-ative priors. Thus, it effectively avoids bias and regres-sion to the mean phenomena from the supervised likeli-hood optimization methods. In due course, the paradigm of diffusion-based inverse problem-solving methodology
[40, 20, 7, 5, 4, 39, 6, 45] has risen to the forefront as a state-of-the-art technique within the realm of study.
Most contemporary diffusion-based inverse problem-solving methods are focused on 2D applications. However, a recent method called DiffusionMBIR [6] has been pro-posed to address 3D inverse problems in medical imaging.
In DiffusionMBIR, the diffusion model trained on the pri-mary XY-plane is used as the prior, and the generative prior is augmented with a model-based prior, namely total varia-tion (TV), to enforce smoothness to the adjacent slices (Z-axis). While this approach has been effective for various tasks, it still has limitations because it does not fully learn the 3D prior distribution of the data. More specifically, the
TV prior only imposes local dependencies that are derived from finite difference operators, whereas the true 3D prior should model global dependencies.
To overcome this limitation, we propose a new method called Two Perpendicular 2D Diffusion Models (TPDM) for 3D generation. TPDM fully leverages the 3D generative prior by modeling the 3D data distribution with a prod-uct distribution of 2D constituents, without relying on a model-based prior. This approach allows TPDM to effec-tively learn the 3D prior using only two 2D diffusion mod-els: the primary model that operates on the XY-plane and an auxiliary model that learns the YZ-plane. Unlike the previous DiffusionMBIR approach, TPDM can model the global dependencies of the 3D structure, and it eliminates the need for sub-optimization schemes required to impose the TV constraint. It is worth mentioning that, unlike Diffu-Figure 1. (Left) A visualization of our proposed method. (Right) We display the results of solving the 3D inverse problem using the proposed method, with MR-ZSR and CS-MRI techniques shown in the center and right panels, respectively. The first row shows the measurements, the second row displays the output from our proposed method, and the third row presents the ground truth. In the MR-ZSR approach, the slice thickness was improved from 5mm to 1mm using super-resolution techniques. In the CS-MRI approach, Poisson sub-sampling was used to accelerate the process by a factor of 48. sionMBIR which is designed specifically for inverse prob-lem solving, TDPM is a fully general 3D generative model, which can be used both for conditional and unconditional sampling.
In this paper, TPDM has been tested in various 3D med-ical imaging reconstruction problems such as MRI Z-axis (i.e. vertical axis) super-resolution (MR-ZSR), compressed sensing MRI (CS-MRI), and sparse view CT (SV-CT) and has produced the state-of-the-art results compared to ex-isting methods. Especially, to the best of our knowledge, we have achieved the first successful attempt at a diffu-sion model-based MR-ZSR both technically and clinically (Fig. 2). We also demonstrated that TPDM can generate a very high-quality, complete 3D voxels volume as a pure generative model (Fig. 7). Our contributions can be sum-marized as follows. 1. We developed a novel, simple, yet effective method to solve the 3D volume inverse problem with two perpen-dicular 2D diffusion models as a 3D prior, in a fully unsupervised manner, without the need for re-training. 2. We applied it to various medical imaging reconstruc-tion problems and achieved the best-known perfor-mance. In particular, TPDM succeeded in the first at-tempt at a diffusion model-based MR-ZSR. 2.