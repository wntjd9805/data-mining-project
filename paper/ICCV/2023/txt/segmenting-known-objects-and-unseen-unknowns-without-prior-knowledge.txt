Abstract
Panoptic segmentation methods assign a known class to each pixel given in input. Even for state-of-the-art ap-proaches, this inevitably enforces decisions that system-atically lead to wrong predictions for objects outside the training categories. However, robustness against out-of-distribution samples and corner cases is crucial in safety-critical settings to avoid dangerous consequences. Since real-world datasets cannot contain enough data points to adequately sample the long tail of the underlying distri-bution, models must be able to deal with unseen and un-known scenarios as well. Previous methods targeted this by re-identifying already-seen unlabeled objects.
In this work, we propose the necessary step to extend segmenta-tion with a new setting which we term holistic segmen-tation. Holistic segmentation aims to identify and sepa-rate objects of unseen, unknown categories into instances without any prior knowledge about them while performing panoptic segmentation of known classes. We tackle this new problem with U3HS, which finds unknowns as highly un-certain regions and clusters their corresponding instance-aware embeddings into individual objects. By doing so, for the first time in panoptic segmentation with unknown objects, our U3HS is trained without unknown categories, reducing assumptions and leaving the settings as uncon-strained as in real-life scenarios. Extensive experiments on public data from MS COCO, Cityscapes, and Lost&Found demonstrate the effectiveness of U3HS for this new, chal-lenging, and assumptions-free setting called holistic seg-mentation. Project page: https://holisticseg.github.io. 1.

Introduction
Since neural networks have achieved unprecedented per-formance in perception tasks (e.g., object detection and se-mantic segmentation), there has been a growing interest
◦ This work was conducted while working at BMW Group.
Contact author: Stefano Gasperini (stefano.gasperini@tum.de).
State-of-the-art panoptic segmentation methods [13]
Figure 1. cannot deal with unseen classes from [52] (top right). Instead, our
U3HS addresses the proposed holistic segmentation setting. U3HS finds unseen unknowns (bottom left) and separates them into in-stances (bottom right) without prior knowledge about unknowns. in ensuring their safe deployment, especially important for safety-critical scenarios, such as autonomous driving and robotics [25]. Recently, several works have been proposed to improve robustness and generalization by addressing cor-ner cases and out-of-distribution data [6, 65, 22], via do-main adaptation [70], adversarial augmentations [44], sim-ulations [1], and uncertainty estimation [54].
Due to the difficulty of collecting corner cases from the long tail of the underlying data distribution, current datasets cannot fully represent the diversity of the world, leaving its vast majority as difficult out-of-distribution (OOD) sam-In safety-critical applications, considering ples [32, 8]. them during development and deployment is of utmost im-portance [3, 44], or they could cause severe damage.
Furthermore, since the powerful and popular softmax highly promotes the probability of the highest logit, state-of-the-art methods tend to be overly confident even on wrong predictions [58, 25]. In safety-critical settings, re-liable confidence together with interpretability techniques
[20, 77] increases trust for downstream tasks [25], e.g., tra-jectory prediction and path planning. Towards this end, es-timating the uncertainty of a model’s output is commonly considered a key enabler for its safe applicability [39, 25].
While several works addressed some of these problems for image classification [58, 46, 54, 61] and object detec-tion [48, 21], they remain primarily unexplored for dense tasks such as semantic and panoptic segmentation [5, 66].
Compared to object detection, the problem is more severe for dense tasks, where a model needs to provide a predic-tion for every input unit (e.g., each pixel). So unseen ob-jects (i.e., of new, unseen categories) are systematically and wrongly assigned to one of the limited number of known classes (closed-set), as shown in Figure 1. This has led researchers towards designing new methods that work not only with the available data distribution but also with OOD samples that are not available (open-set), thereby improving robustness against unseen scenarios [38, 46, 5, 44].
Open-set panoptic segmentation [66] segments instances of unlabeled objects in addition to panoptic segmentation of known areas, i.e., the combination of semantic and in-stance segmentation [41]. Unlike OOD segmentation [38], segmenting unknown instances enables tracking and trajec-tory prediction. Prior works [66, 36, 72] tackled this prob-lem by relying on seeing unlabeled categories during train-ing. They learned these categories through the void class (i.e., unlabeled) and assumed unknowns to be within ground truth void regions at training time and inside void predic-tions at test time. By doing so, unknowns are transformed into learned unlabeled instances (i.e., essentially known ob-jects) [36], constraining the open-set task. Mainly intended to segment already-seen unlabeled objects [36, 72], current works cannot deal with the wide variability of unknowns and corner cases outside the training data.
In this paper, we propose the necessary next step for panoptic segmentation to include object categories outside the training data (i.e., unseen unknowns). We term the new setting holistic segmentation. The aim is to identify and segment unseen unknowns into instances while segmenting known classes in a panoptic fashion without any external nor prior knowledge about unknowns. Unseen categories pose new challenges compared to already-seen unlabeled ones [36], requiring new solutions. Estimating the uncer-tainty is a key step towards finding the knowledge bound-aries of a model, leaving the problem unconstrained and reducing assumptions on the training data. Therefore, we propose U3HS: UUUUUUUUUUUUUUUUUnseen UUUUUUUUUUUUUUUUUnknowns via UUUUUUUUUUUUUUUUUncertainty estima-tion for HHHHHHHHHHHHHHHHHolistic SSSSSSSSSSSSSSSSSegmentation. The main contributions of this paper can be summarized as follows:
• We introduce the setting of holistic segmentation, which highlights the importance of not using prior knowledge about unknown objects (e.g., text), and leaves the setup unconstrained as in real scenarios.
• We tackle this new setting with U3HS: the first panop-tic framework to deal with unseen, unknown object categories, able to segment and separate them.
• We provide uncertainty measures for the output of
U3HS to further improve its safe applicability. 2.