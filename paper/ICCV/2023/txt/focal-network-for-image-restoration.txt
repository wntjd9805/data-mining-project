Abstract
Image restoration aims to reconstruct a sharp image from its degraded counterpart, which plays an important role in many fields. Recently, Transformer models have achieved promising performance on various image restora-tion tasks. However, their quadratic complexity remains an intractable issue for practical applications. The aim of this study is to develop an efficient and effective framework for image restoration. Inspired by the fact that different regions in a corrupted image always undergo degradations in var-ious degrees, we propose to focus more on the important areas for reconstruction. To this end, we introduce a dual-domain selection mechanism to emphasize crucial informa-tion for restoration, such as edge signals and hard regions.
In addition, we split high-resolution features to insert multi-scale receptive fields into the network, which improves both efficiency and performance. Finally, the proposed network, dubbed FocalNet, is built by incorporating these designs into a U-shaped backbone. Extensive experiments demon-strate that our model achieves state-of-the-art performance on ten datasets for three tasks, including single-image defo-cus deblurring, image dehazing, and image desnowing. Our code is available at https://github.com/c-yn/FocalNet. 1.

Introduction
Bad weather or physical limitations of cameras will de-grade visibility of captured images and further exert a neg-ative impact on robustness of downstream tasks. In this re-gard, image restoration is immensely useful to remove those undesired degradations, e.g., haze, snowflake, and blur, thus playing an essential role in surveillance, autonomous vehi-cles, remote sensing, and medical imaging [48]. Due to its ill-posed property, many conventional methods have been proposed by resorting to assumptions and hand-crafted fea-tures to reduce the solution space. However, these methods are inapplicable to complicated real-world scenarios [66].
The rapid development of convolutional neural networks
*Corresponding Author
[59]
[54]
[21]
[17]
[18]
[49]
[41]
Figure 1. PSNR vs. FLOPs on the SOTS-Indoor [27] dataset. (CNNs) has alleviated the above issue to some extent by learning generalizable image priors from large-scale col-lected datasets [25, 44]. Recently, Transformer models have injected vitality into image restoration and have achieved promising performance by providing powerful ability of modeling long-range pixel interactions, which is useful for recovering large-scale degradations [7, 32, 61]. Despite a few remedies, the quadratic complexity of self-attention still remains a formidable issue for practical applications.
How to effectively capture critical information parsimo-niously has long been a key problem in the computer vision and pattern recognition community. Successful examples include attention mechanism [53], focal loss [34], and the recent advance of partial AUC optimization [58]. Inspired by this, in this study, instead of pursuing large receptive field or exploring modification for the Transformer archi-tecture, we aim to develop an efficient and effective CNN-based framework by paying more attention to informative signals for reconstruction, such as edge information or re-gions that are difficult to recover. In this direction, exist-ing approaches can be roughly divided into two categories: auxiliary training and attention based methods. The former mainly leverages auxiliary techniques or data, e.g., semantic segmentation [12], depth estimation [29], and optical flow estimation [60], to locate degradations or edge information.
Nonetheless, these algorithms always need additional com-Figure 2. Effects of our dual-domain selection mechanism (DSM). From left to right: blurry images obtained from DPDD [1], ground-truth images, input features of our DSM, results of spatial selection, and results of spatial&frequency selection. SSM helps focus on degradation regions while FSM emphasizes edge information. Zoom in for the best view. plicated branch and elaborately devised training strategies to generate supervisory information. The other line on this topic is to design attention mechanisms to attend to informa-tive regions or control information transmission [8, 41, 62].
These approaches mostly lie in the spatial domain while ig-noring the usage of spectral information, which can also provide useful information for reconstruction.
To prompt models to focus more on critical regions, we propose a novel dual-domain selection mechanism (DSM) by sufficiently leveraging discrepancies between sharp/degraded image pairs in both spatial and spectral do-mains. Concretely, our mechanism comprises two compo-nents: spatial selection module (SSM) and frequency selec-tion module (FSM). SSM takes features as input and de-termines general locations of degradations for each channel by deploying depthwise convolution layers. Then FSM is used to amplify high-frequency signals or hard regions by removing low frequency from features. The proposed net-work, FocalNet, is established by incorporating DSM into a
U-shaped CNN backbone. To save computation overhead, we only insert DSM into the bottleneck module of our Fo-calNet, which includes the lowest-resolution features.
Moreover, we split the high-resolution features into two parts over channel dimension. Half features are down-sampled to lower resolution, which can not only reduce complexity but also boost performance by providing multi-scale receptive fields for degradations of different sizes.
Based on the above designs, our FocalNet exhibits state-of-the-art performance on three image restoration tasks. For dehazing, FocalNet outperforms PMNet [59] on both syn-thetic and real-world benchmark datasets with lower com-putational complexity, as illustrated in Figure 1. For the desnowing task, FocalNet is superior to Transformer-based framework TransWeather [50] on three commonly used desnowing datasets. Our network also shows potential on defocus deblurring problem by producing a performance gain of 0.2 dB PSNR over Restormer [61] on the combined category of DPDD [1] dataset. Overall, the main contribu-tions of this study are summarized as follows:
• We propose a novel dual-domain selection mechanism (DSM) that amplifies the response of important regions to assist in recovering clean features.
• We develop an efficient and effective focal network that provides multi-scale representation learning for image restoration.
• Extensive experiments on ten datasets demonstrate that the proposed network, FocalNet, performs favorably against state-of-the-art algorithms on three representa-tive image restoration tasks. 2.