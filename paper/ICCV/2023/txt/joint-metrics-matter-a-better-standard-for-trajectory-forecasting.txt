Abstract
Multi-modal trajectory forecasting methods commonly evaluate using single-agent metrics (marginal metrics), such as minimum Average Displacement Error (ADE) and
Final Displacement Error (FDE), which fail to capture joint performance of multiple interacting agents. Only focusing on marginal metrics can lead to unnatural predictions, such as colliding trajectories or diverging trajectories for people who are clearly walking together as a group.
Consequently, methods optimized for marginal metrics lead to overly-optimistic estimations of performance, which is detrimental to progress in trajectory forecasting research.
In response to the limitations of marginal metrics, we present the first comprehensive evaluation of state-of-the-art (SOTA) trajectory forecasting methods with respect to multi-agent metrics (joint metrics): JADE, JFDE, and collision rate. We demonstrate the importance of joint metrics as opposed to marginal metrics with quantitative evidence and qualitative examples drawn from the ETH /
UCY and Stanford Drone datasets. We introduce a new loss function incorporating joint metrics that, when applied to a SOTA trajectory forecasting method, achieves a 7% improvement in JADE / JFDE on the ETH / UCY datasets with respect to the previous SOTA. Our results also indicate that optimizing for joint metrics naturally leads to an im-provement in interaction modeling, as evidenced by a 16% decrease in mean collision rate on the ETH / UCY datasets with respect to the previous SOTA. Code is available at github.com/ericaweng/joint-metrics-matter. 1.

Introduction
Because the future is inherently multi-modal, the trajec-tory forecasting community has adopted the use of top-K metrics, average displacement error (ADE) and final dis-placement error (FDE), to evaluate and optimize meth-ods. Under this evaluation, stochastic trajectory forecast-ing models generate a set of K different possible futures
*Correspondence to: eweng[at]cmu.edu
Figure 1: Multi-agent trajectory forecasting methods are optimized for single-agent metrics like ADE (left panel). As a result, within a single joint future, the method may predict very good trajectories for some agents (e.g. the green agent), but very bad predictions for others (e.g. the orange agent).
Our Joint AgentFormer, optimized for JADE (right panel), encourages the predictions of all agents within a joint future to be close to the ground-truth. for each target sequence of a certain time length. Each pos-sible future represents a set of x-y position predictions for all agents in the sequence; we call each set of predictions a “sample.” Min ADE / FDE is then calculated by find-ing, for each agent, the lowest-error prediction across the
K samples when compared to the ground-truth. Unfortu-nately, ADE / FDE do not explicitly account for interacting futures. The future is not only multi-modal but also inter-acting; the future trajectories of each agent depend on one another. For example, a car merging into a busy road may either choose to push its way in, or wait passively for an opening. If the car merges, other vehicles on the road will slow down to let it in. If the car waits, others will maintain their speed. A scenario where the car merges but the vehi-cles on the road maintain their speed and crash into the car would not be a likely future.
Most trajectory forecasting methods produce predictions for all agents in the sequence jointly, in order to better model these interactive scenarios. However, under standard top-K evaluation, the predictions are considered for each agent marginally, and thus the predictions used in evalua-tion need not come from the same sample. A method may
achieve good ADE / FDE simply by producing an accu-rate prediction for each agent in any one of its K samples, and then mixing-and-matching the best predictions for each agent; it need not accurately model the joint future within a single sample.
Only considering marginal metrics during evaluation can result in an overly optimistic estimation of performance.
A method may achieve excellent ADE / FDE yet still fail at joint interaction modeling, such as predicting collision-free trajectories, as seen in Figure 1. After crossing the crosswalk, it is reasonable that a pedestrian either continues straight down the sidewalk, turns left onto the sidewalk, or turns right to cross the other crosswalk. Supposing all three possibilities are equally likely and well-represented by the ground truth data, a model that has been trained relying on standard min ADE / FDE metrics (e.g. that shown in left panel of figure) may predict any one of these three futures.
However, since the method is optimized for each agent in-dividually, it may not enforce the correct group behavior; two pedestrians walking side-by-side are likely to choose the same mode.
A work from the vehicle forecasting community [49] in-troduced joint metrics, which they called “scene-level” ADE and FDE. These metrics, rather than mix-and-match the minimum ADE / FDE prediction per-agent, instead average over all agents within a sample before taking the minimum-error sample as the one that “counts.” Performing well with respect to joint metrics necessitates not only predicting ac-curate marginal futures, but also accurate joint futures. Joint metrics are also reported in the Waymo Motion Prediction challenge and several other vehicle forecasting works; how-ever, they have failed to gain traction in pedestrian fore-casting evaluation, and few if any methods that evaluate on pedestrian datasets report them.
Diverging from the names used by [49], we shall in-stead refer to “scene-level” ADE / FDE as “joint” ADE /
FDE (JADE / JFDE) in order to avoid confusion with the overloaded term “scene,” which is also used in trajectory forecasting literature to refer to environment information such as semantic maps or the location of a dataset. We de-fine these metrics and compare the differences with their marginal counterpart ADE / FDE in Section 3.
In theory, current forecasting architectures may already be capable of modeling joint futures and multi-agent inter-actions through the use of graph and attention-based archi-tectures such as GNNs and Transformers. These architec-tures are designed to explicitly model social interactions between agents so as to predict realistic joint futures, and have led to great improvements in ADE / FDE. However, increasing studies show that adversarial attacks can cause methods to produce unrealistic joint futures and poor re-sults [44, 5, 63]. For example, [44] showed that “socially-aware” models may not be as socially-aware as they claim to be, because well-placed attacks can cause predictions with colliding trajectories. To more realistically assess the performance of multi-agent forecasting, we advocate for the use of joint metrics over marginal metrics in method evalu-ation. Furthermore, we hypothesize that multi-agent archi-tectures fall short in modeling realistic agent interactions because they are optimized with respect to only marginal losses (that are driven by the field’s focus on marginal met-rics). To test this hypothesis, we modify the loss function on a popular SOTA method to include a joint loss term.
We show with this simple and straightforward modifica-tion, SOTA methods become far more accurate at modeling multi-agent interactions.
Our contribution is thus two-fold:
• We present the first comprehensive evaluation of
SOTA trajectory forecasting methods with respect to joint metrics: JADE, JFDE, and collision rate. We show that ADE / FDE are an overestimation of perfor-mance on joint agent behavior; JADE / JFDE is often 2x worse than the reported ADE / FDE across meth-ods for K = 20 samples. We illustrate the importance of joint metrics over marginal metrics with quantita-tive evidence as well as qualitative examples drawn from SOTA methods on the ETH [39] / UCY [28] and
SDD [43] datasets.
• We introduce a simple multi-agent joint loss function that, when used to optimize a SOTA trajectory fore-casting method, achieves a improvement of 7% over the previous SOTA with respect to the joint metrics
JADE / JFDE on the ETH / UCY datasets. We show that this lower JADE / JFDE is also linked with a 16% reduction in collision rate as compared with the previous SOTA, substantiating the hypothesis that op-timizing with respect to joint metrics also improves collision-avoidance modeling. 2.