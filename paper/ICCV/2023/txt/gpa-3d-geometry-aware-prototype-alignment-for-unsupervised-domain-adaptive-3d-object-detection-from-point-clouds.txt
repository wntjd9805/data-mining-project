Abstract
LiDAR-based 3D detection has made great progress in recent years. However, the performance of 3D detectors is considerably limited when deployed in unseen environ-ments, owing to the severe domain gap problem. Existing domain adaptive 3D detection methods do not adequately consider the problem of the distributional discrepancy in feature space, thereby hindering generalization of detec-tors across domains.
In this work, we propose a novel unsupervised domain adaptive 3D detection framework, namely Geometry-aware Prototype Alignment (GPA-3D), which explicitly leverages the intrinsic geometric relation-ship from point cloud objects to reduce the feature discrep-ancy, thus facilitating cross-domain transferring. Speciﬁ-cally, GPA-3D assigns a series of tailored and learnable prototypes to point cloud objects with distinct geometric structures. Each prototype aligns BEV (bird’s-eye-view) features derived from corresponding point cloud objects on source and target domains, reducing the distributional discrepancy and achieving better adaptation. The evalu-ation results obtained on various benchmarks, including
Waymo, nuScenes and KITTI, demonstrate the superiority of our GPA-3D over the state-of-the-art approaches for dif-ferent adaptation scenarios. The MindSpore version code will be publicly available at https://github.com/
Liz66666/GPA3D. 1.

Introduction
As a fundamental research in 3D scene understanding, 3D detection from point clouds has attracted increasing at-tention due to its essential role in intelligent robotics, aug-mented reality and autonomous driving [7, 21, 18, 8, 1]. De-spite signiﬁcant process, state-of-the-art 3D detectors still
*Work was jointly done when Ziyu was an intern at Huawei Noah’s Ark
Lab
†Corresponding Author
Figure 1. The performance comparison with previous works [33, 36, 37]. The detection architecture is SECOND-IoU [34, 36]. suffer from dramatic performance degradation when train-ing data and test data are from different environments, i.e., domain shift problem [33]. Various factors, such as di-verse weather conditions, object sizes, laser beams, and scanning patterns, lead to substantial discrepancies across different domains, hindering the transferability of existing
LiDAR-based 3D detectors. Intuitively, ﬁne-tuning the de-tectors with adequate data from the target domain could al-leviate this issue. However, manually annotating a large amount of point cloud scenes is a prohibitively expensive task. Therefore, the research on unsupervised domain adap-tation (UDA) for LiDAR-based 3D detection is essential.
Although many works have been proposed to deal with the UDA for image-based detection [42, 11, 24, 17, 10, 14, 13, 25, 3], directly applying these methods to 3D point cloud detection is insufﬁcient for tackling the domain shifts.
These approaches mainly concentrate on the gaps of light-ing and texture variations, which could not be obtained from point clouds. While there is only a limited number of liter-ature [33, 36, 26, 9, 39, 37, 20] dealing with the UDA on
LiDAR-based 3D detection. Prior work [33] utilizes the statistics from target annotation to perform data-level nor-malization. MLC-Net [20] designs a mean-teacher frame-work to provide reliable pseudo-labels to facilitate transfer-ring. ST3D [36] and ST3D++ [37] propose a self-training pipeline with a memory bank to collect and reﬁne pseudo-labels. Despite their great success, these methods do not ad-equately consider the problem of distributional discrepancy in feature space, hampering the adaptation performance.
ground truth visible parts object center  direction (a) (b) source target prototypes groups decision boundary (c) w/o alignment (d) vanilla alignment (e) w/ geometry-aware prototypes
Figure 2. (a) Point cloud scene on BEV (bird’s-eye-view). (b)
Distinct geometric structures of point cloud objects. (c-e) Illus-tration of the distributional discrepancy. With explicit geometric constraints, the features from different domains are better aligned.
To reduce this discrepancy in 2D UDA task, some ap-proaches utilize the class-wise prototypes align features from different domains [12, 31, 40, 19]. In these works, a universal prototype is employed to enforce high representa-tional similarity among features belonging to the same cat-egory. However, in the case of 3D scenes, such as vehicles on the road, diverse locations and directions can result in distinct geometric structures, i.e., distributional patterns of point clouds, as presented in Fig. 2 (a) and (b). If a uniform prototype is applied to objects with completely different ge-ometric structures, the efﬁcacy of feature alignment might be hindered, as illustrated in Fig. 2 (c-d). We argue that adopting different prototypes to point cloud objects with distinct geometric structures could deal with the problem of distributional discrepancy, but more attention should also be paid to model these geometric structures during adaptation.
Based on the considerations, we propose a novel
UDA framework for LiDAR-based 3D detectors, namely
Geometry-aware Prototype Alignment (GPA-3D). Con-cretely, we ﬁrst explore the potential relationships between the geometric structures of point cloud objects. During training, we randomly extract the BEV features of point clouds from both the source and target domains, and sub-sequently divide them into distinct groups based on their geometric structures. In this process, BEV features derived from point clouds with the similar geometric structures will be classiﬁed into the same group. Each group is then as-signed a unique prototype, which enforces high representa-tional similarity among the BEV features within that group, as illustrated in Fig. 2 (e). To this end, the soft contrast loss is devised to pull the intra-group feature-prototype pairs closer in the representational space and push the inter-group pairs farther away. Additionally, we develop the frame-work with two components, namely noise sample suppres-sion (NSS) and instance replacement augmentation (IRA).
NSS utilizes the similarities between foreground areas and the background prototype, to produce a mask for decreas-ing the impact of noise. IRA displaces pseudo-labels with high-quality samples that have similar geometric structures, enriching the diversity on the target domain.
The main contributions of this paper include:
• We propose a novel UDA framework for LiDAR-based 3D detectors, namely Geometry-aware Proto-type Alignment (GPA-3D). It explicitly integrates geo-metric associations into feature alignment, effectively decreasing the distributional discrepancy and facilitat-ing the adaptation of existing point cloud detectors.
• Noise sample suppression and instance replacement augmentation are designed to enhance pseudo-labels in terms of reliability and versatility, respectively.
• We conduct comprehensive experiments on Waymo, nuScenes, and KITTI. The encouraging results demon-strate the GPA-3D outperforms state-of-the-art meth-ods in various adaptation scenarios. More importantly, thanks to the architecture-agnostic design, GPA-3D is
ﬂexible to be applied to point cloud detectors. 2.