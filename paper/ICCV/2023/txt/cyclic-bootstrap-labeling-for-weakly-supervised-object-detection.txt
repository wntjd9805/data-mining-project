Abstract
Recent progress in weakly supervised object detection is featured by a combination of multiple instance detection networks (MIDN) and ordinal online refinement. However, with only image-level annotation, MIDN inevitably assigns high scores to some unexpected region proposals when gen-erating pseudo labels. These inaccurate high-scoring re-gion proposals will mislead the training of subsequent re-finement modules and thus hamper the detection perfor-mance. In this work, we explore how to ameliorate the qual-ity of pseudo-labeling in MIDN. Formally, we devise Cyclic-Bootstrap Labeling (CBL), a novel weakly supervised ob-ject detection pipeline, which optimizes MIDN with rank information from a reliable teacher network. Specifically, we obtain this teacher network by introducing a weighted exponential moving average strategy to take advantage of various refinement modules. A novel class-specific rank-ing distillation algorithm is proposed to leverage the out-put of weighted ensembled teacher network for distilling
MIDN with rank information. As a result, MIDN is guided to assign higher scores to accurate proposals among their neighboring ones, thus benefiting the subsequent pseudo la-beling. Extensive experiments on the prevalent PASCAL
VOC 2007 & 2012 and COCO datasets demonstrate the superior performance of our CBL framework. Code will be available at https://github.com/Yinyf0804/
WSOD-CBL/. 1.

Introduction
With the rapid advancements in deep neural networks, object detection has experienced significant progress. Nev-ertheless, state-of-the-art object detection methods are con-tingent upon accurate instance-level annotations obtained through fully-supervised learning settings. The process of collecting such annotations is both arduous and costly. Such
*Corresponding authors: Wengang Zhou and Houqiang Li
Figure 1. Comparison between the basic WSOD pipeline and our proposed CBL framework (feature extractor is omitted for simplic-ity). In the CBL framework, the subsequent refinement modules of MIDN are finally utilized to distill MIDN in turn, forming a cyclic-bootstrap procedure. facts motivate the exploration of weakly supervised object detection (WSOD) [2, 32, 44, 43, 48, 25], which achieves the object detection task using only image-level labels.
Most existing WSOD approaches in the literature [32, 44] generally follow the training pipeline of Fig. 1(a). First, a multiple instance detection network (MIDN) [2] is ob-tained by leveraging multiple instance learning scheme for optimization, which converts WSOD into a multi-class clas-sification problem over bottom-up generated region pro-posals [35]. The region proposals with high scores out of
MIDN are then exploited to generate pseudo ground-truth boxes, which are used for the training of refinement mod-ules, e.g., online instance classifiers (OICs), and regressors (R-CNN head). By introducing MIL to the training pro-cess, MIDN obtains the capability of estimating whether an object exists in the corresponding region. However, many high-scoring region proposals from MIDN only cover the discriminative part of an instance (e.g., the head of a bird), or contain some background regions [32, 48]. The improper scoring assignment of MIDN leads to the generation of in-accurate pseudo ground-truth boxes, which further hinder the training of subsequent refinement modules.
This problem has been recognized by the community, and several approaches have been proposed to address it. In the literature, C-MIDN [43] and P-MIDN [42] design com-plementary MIDN modules to find the remained discrimi-native parts other than the top-scoring ones. IM-CFB [46] develops a class feature bank to collect intra-class diversity information, and devises an FGIM algorithm to ameliorate the region proposal selection. These approaches primar-ily concentrate on the issue that the high-scoring proposals cover only the most discriminative parts, while struggling to address other inaccurate scoring-assignment issues. Be-sides, most of these attempts involve an auxiliary model, without offering assistance in the training of MIDN.
To this end, in this paper, we propose the Cyclic-Bootstrap Labeling (CBL) framework, which advances
WSOD from the one-way pipeline (see Fig. 1 (a)) to a cyclic-bootstrap procedure (see Fig. 1 (b)). As shown in
Figure, the subsequent modules of MIDN are eventually utilized to enhance itself.
In comparison to the prior ap-proaches, CBL exerts an additional rank-based supervision on MIDN, which is capable of handling a broader set of inaccurate scoring-assignment cases.
Specifically, following the common practice of WSOD, we first employ MIDN to generate pseudo labels, which serve as the initial supervision for subsequent refinement modules. To obtain more accurate classification results, we construct a weighted ensemble teacher (WET) model, in-spired by the success of mean teacher methods [34, 23].
The WET model is updated through the weighted exponen-tial moving average (W-EMA) strategy, which takes advan-tage of multiple student candidates in the refinement mod-ules. Subsequently, leveraging the WET results, we propose a class-specific ranking distillation (CRD) algorithm to su-pervise MIDN with rank-based labels in a distillation man-ner. This additional rank-based supervision allows MIDN to achieve an improved scoring (ranking) assignment, where accurate proposals will be assigned higher scores among their neighboring ones. Moreover, we observe that the WET model can also act as a reliable teacher for the R-CNN head in the basic WSOD pipeline [44]. To this end, we propose a multi-seed R-CNN (MSR) algorithm to mine multiple posi-tive seeds according to the WET results, calculate their con-fidence scores, and utilize them to generate pseudo labels for the supervision of the R-CNN head.
Our main contributions are summarized as follows:
• We propose a novel cyclic-bootstrap labeling (CBL) framework for weakly supervised object detection.
The proposed CBL contains a weighted ensemble teacher model to generate reliable detection results, a class-specific ranking distillation algorithm to distill the MIDN module with rank information, and a multi-seed R-CNN algorithm to mine accurate positive seeds for the training of the R-CNN head.
• We provide a new perspective that the subsequent modules of MIDN are finally utilized to distill MIDN in turn, forming a cyclic-bootstrap procedure, which is rarely explored in previous WSOD works.
• Extensive experiments on the prevalent PASCAL VOC 2007 & 2012 and COCO datasets demonstrate the su-perior performance of our CBL framework. 2.