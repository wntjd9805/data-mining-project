Abstract
Testing the full autonomy system in simulation is the safest and most scalable way to evaluate autonomous ve-hicle performance before deployment. This requires sim-ulating sensor inputs such as LiDAR. To be effective, it is essential that the simulation has low domain gap with the real world. That is, the autonomy system in simulation should perform exactly the same way it would in the real world for the same scenario. To date, there has been lim-ited analysis into what aspects of LiDAR phenomena af-fect autonomy performance. It is also difficult to evaluate the domain gap of existing LiDAR simulators, as they op-erate on fully synthetic scenes. In this paper, we propose a novel “paired-scenario” approach to evaluating the do-main gap of a LiDAR simulator by reconstructing digital twins of real world scenarios. We can then simulate LiDAR in the scene and compare it to the real LiDAR. We lever-age this setting to analyze what aspects of LiDAR simula-tion, such as pulse phenomena, scanning effects, and asset quality, affect the domain gap with respect to the auton-omy system, including perception, prediction, and motion planning, and analyze how modifications to the simulated
LiDAR influence each part. We identify key aspects that are important to model, such as motion blur, material re-flectance, and the accurate geometric reconstruction of traf-fic participants. This helps provide research directions for improving LiDAR simulation and autonomy robustness to these effects. For more information, please visit the project website: https://waabi.ai/lidar-dg 1.

Introduction
Accurately testing the behavior of robots such as self-driving vehicles (SDVs) is of paramount importance to en-sure their safe deployment in the real world. The safest, most scalable and sustainable way to test the autonomy system is through simulation. To assess the safety of the
*Indicates equal contribution.
Figure 1. Analysis Overview. We study the impact of pulse ef-fects, scanning effects, and asset quality on LiDAR simulation realism. We depict one example of a pulse effect domain gap: failure to model multiple echoes causes the object detector to fail, resulting in an unsafe autonomy plan. The bottom row depicts the front-camera view, for reference only, followed by the relevant
LiDAR: original simulation, added multi-echoes, and real. We de-note multi-echoes re-added by the middle method in orange. Sub-tle differences in the area highlighted with the arrow stem from weak returns on truck’s rear wheels, impacting the domain gap. full system, it is critical to evaluate the complete autonomy stack in such a simulator. This is a must, as small changes in one sub-component (e.g., a missed detection) can cause a chain reaction of downstream effects that significantly alter the outcome, and might result in a safety hazard. To evalu-ate the full autonomy, we must simulate all the inputs to the system. This requires high fidelity sensor simulation with low domain gap with respect to the real world. That is, the performance of the autonomy system in simulation on all scenarios should match the real world performance.
In the past few years, a wide range of LiDAR simulation systems have been developed, as LiDAR is the primary sen-sor in many modern autonomy stacks [11, 53, 37, 62]. Most
LiDAR simulation systems first perform virtual world cre-ation to build a 3D scene, either using CAD models [16, 23], data-driven assets [55, 35], or a combination [18]. They then perform sensor rendering, which simulates the LiDAR scanning process to generate point clouds, either through
physics and graphics [22, 16, 18, 23], data-driven mod-elling [72, 6, 55] or hybrid approaches [35, 24, 7]. Despite its importance, there has been little investigation into what aspects of LiDAR simulation matter for autonomy testing, i.e., what is important for drawing insights about real-world system performance from simulation.
In this paper, we propose a novel approach for evaluating the domain gap of a sensor simulator. Unlike standard sen-sor simulators [16, 50] that create fully synthetic worlds that cannot be directly compared with the real world, we devise a “paired-scenario” setting, where we recreate in simulation a digital twin of the exact same scenario observed in the real world during data collection. The digital twin occurs on the same map, with the same traffic participant (actor) place-ment and behaviors as observed in the real world. With this digital twin, we can then simulate the LiDAR data for this scenario according to the same platform and sensor config-uration it was observed with, and compare the simulated Li-DAR against the real LiDAR to evaluate their differences.
Through this “paired-scenario” setting, we can run auton-omy on both the simulated LiDAR and real LiDAR and compare autonomy outputs, such as differences in motion plans (see Fig.1). This unique setting allows us to directly measure the domain gap of a sensor simulator with respect to autonomy.
We then conduct the first analysis of what aspects of Li-DAR simulation are critical to simulate with high fidelity to ensure close matching performance of the autonomy sys-tem between the simulator and the real world. We investi-gate the effect of multiple sensor phenomena, including Li-DAR pulse effects such as multi-path reflections and mate-rial modelling, and scanning LiDAR effects such as realistic motion blur and rolling shutter. We also investigate different ways to build the virtual world, such as with CAD models or 3D reconstruction. Since each part of the autonomy may be affected differently by the simulator’s domain gap, we assess both the full stack as well as its subsystems, includ-ing perception, motion forecasting, and motion planning.
Our results show that LiDAR realism is strongly affected by phenomena like motion blur and multi-echo returns, which are often not simulated in standard LiDAR simulators. We also find that standard perception metrics typically used in the community to evaluate algorithm performance during sim-to-real and real-to-sim, such as detection precision and recall, are not strong indicators of the domain gap of the autonomy system on the end task of motion planning.
While proposing a specific novel simulator to address these challenges remains an open topic, we believe that our analysis sheds light into what directions are most important for the community to tackle in order to improve simulation realism and to develop robotic systems that are less suscep-tible to domain gap.
Figure 2. Given Base-LiDAR, we leverage an “oracle” real Li-DAR point cloud to make it more realistic, such as dropping points, adding multi-path returns, spurious returns, or correcting for inaccurate geometry in simulation. The orange points indi-cate points that are either modified in Base-LiDAR or points taken from the real LiDAR and added to Base-LiDAR. 2.