Abstraction via Neural Primitive Assembly
Ye Chen1 Bingbing Ni1,2∗ Xuanhong Chen1,2 Zhangli Hu1 1Shanghai Jiao Tong University, Shanghai 200240, China 2USC-SJTU Institute of Cultural and Creative Industry
{chenye123, nibingbing, chen19910528, tension-2019}@sjtu.edu.cn
Abstract
This work explores a novel image geometric abstrac-tion paradigm based on assembly out of a pool of pre-defined simple parametric primitives (i.e., triangle, rectan-gle, circle and semicircle), facilitating controllable shape editing in images. While cast as a mixed combinato-rial and continuous optimization problem, the above task is approximately reformulated within a token translation neural framework that simultaneously outputs primitive assignments and corresponding transformation and color parameters in an image-to-set manner, thus bypassing complex/non-differentiable graph-matching iterations. To relax the searching space and address the vanishing gra-dient issue, a novel Neural Soft Assignment scheme that well explores the quasi-equivalence between the assignment in Bipartite b-Matching and opacity-aware weighted mul-tiple rasterization combination is introduced, drastically reducing the optimization complexity. Without ground-truth image abstraction labeling (i.e., vectorized represen-tation), the whole pipeline is end-to-end trainable in a self-supervised manner, based on the linkage of differentiable rasterization techniques. Extensive experiments on several datasets well demonstrate that our framework is able to pre-dict highly compelling vectorized geometric abstraction re-sults with a combination of ONLY four simple primitives, also with VERY straightforward shape editing capability by simple replacement of primitive type, compared to previous image abstraction and image vectorization methods. 1.

Introduction
Image abstraction, as one of the fundamental tasks in computer vision, originally aims at decomposing a given image into a set of elementary primitives (e.g., basic shapes, curves) as well as their inter-relationship, for the purpose of visual understanding or object reconstruction [6, 14, 13].
Haeberli et al. [16] use texture maps as primitives for paint-∗Corresponding author: Bingbing Ni
Figure 1. This work explores abstracting images based on a combi-nation of simple geometric primitives (i.e., geometric abstraction).
Our method predicts highly compelling vectorized results to char-acterize the image geometric information efficiently. In addition, our method has straightforward shape editing capability by simply modifying primitives during inference. ing and anti-aliased text drawing; while Hu et al. [19] adopt statistical learning strategy for approximating Ghost Imag-ing (GI [30]) by a set of natural image patches. Contem-porary abstraction approaches [24, 41, 20, 28] delve to rep-resent image with parameterized sketches. These methods usually represent sketches based on B´ezier control points, and the input image is translated into a sequence of B´ezier curves in a recursive way, based on deep architectures such as transformers [34] or reinforcement learning [28].
Other than sketches, geometric shape primitive (triangle, circle, etc.) based image abstraction approaches [9, 39] are probably more favored by highly frequent applications such as graphic design, industrial design, cartoon production, ad-vertisement making and modern arts, given the following facts. 1. Simplicity and Expressibility: On one hand, ge-ometric primitive has very compact and explicit parameter format, thus facilitating compact representation and conve-nient manipulation. On the other hand, numerous combina-tions of geometric primitives imply rich expressive power compared with sketches. For example, the Bauhaus and
Cubism arts tend to adopt ONLY simplistic shapes like rect-angles and spheres, yet still with extremely rich artistic ex-pression. 2. Semantic Preservation: Human beings tend to
think of complex visual patterns abstracted into some primi-tives and their combinations. For example, a big circle, two small circles and two triangles sufficiently form a human face. These are two of the main reasons why modern logo design and animation especially favor the use of geometric primitives. This work is dedicated to geometric primitive learning for reassembling and editing artistic images.
Unfortunately, searching (or even approximating) the optimal solution of the above problem is considered as hard as it essentially invokes both combinatorial (one-to-many matching for best primitive type selection) and con-tinuous (inference of the best transformation parameter for a certain primitive) simultaneously. The following chal-lenges have to be addressed. 1.High Dimensionality: Com-pared to sketch-based methods that only need to predict control point locations, geometric abstraction requires se-lection of primitive types, leading to exponentially explod-In addition, more complicated ing combinatorial space. transformation parameters such as affine coefficients and colors need to be predicted simultaneously, which further expands the optimization space. 2.Non-Differentiability:
Note that the non-differentiable nature of primitive selection together with primitive-to-pixel rasterization double the dif-ficulty in employing any off-the-shelf deep learning frame-work. More seriously, the enclosed regions within primi-tives are usually flat and textureless, therefore popular dif-ferentiable rasterization techniques such as Diffvg [23] can hardly capture accurate gradient signal propagated back-ward for primitive type or transform parameter correction, i.e., known as vanishing gradient [18]. This issue makes training process highly unstable and difficult to generate 3.Weak Supervision: Al-meaningful abstract results. though steady progress in un-/self-supervised representa-tion learning has emerged with encouraging results on mul-tiple 2D/3D visual tasks [17, 8, 47, 26, 25], existing im-age abstraction methods [3, 28, 31] mostly rely on abun-dant datasets (e.g., Quickdraw [15]) and carefully designed loss metrics [41, 11], where vectorized sketch labeling is available for direct/strong pair-wise supervision. However, in this work we ONLY have rasterized images for train-ing without any image-to-vector or image-to-primitive la-beling, therefore the primitive assignment task is in an unsu-pervised (or self-supervised) setting since large-scale high-quality artistic images in parametric/vectorized format are extremely difficult to collect.
In pursuit of geometric abstraction and addressing the aforementioned difficulties, we propose a novel image ge-ometric abstraction paradigm based on assembly out of a pool of pre-defined simple parametric primitives (trian-gle, rectangle, circle and semicircle), facilitating control-lable shape editing in images. Our framework features the following designs. Architecturally, the above task is ap-proximately reformulated within a token translation neural framework (i.e., transformer architecture [40]) that simulta-neously outputs primitive assignments and the correspond-ing transformation parameters and colors in an image-to-set manner, thus bypassing complex/non-differentiable primi-tive assignment iterations. To avoid exhaustive combina-torial search, we introduce a novel Neural Soft Assign-ment scheme that well explores the quasi-equivalence be-tween the selection operation in Bipartite b-Matching and opacity-aware weighted multiple rasterization combination.
Namely, for each considered image location, a single ren-dering pattern is obtained by firstly fusing multiple prim-itive selections (with estimated transformations) and then softly inferring primitive matching weights serving as opac-ity values, in favor of differentiable learning of primitive assignment. In addition, to address vanishing gradient chal-lenge, we propose a Centroid Filtering mechanism to cal-ibrate gradients inside enclosed regions, in heart of which is a centroid smoothing kernel that creates an effective gra-dient propagation path for flat primitives. Without ground-truth image abstraction labeling (i.e., vectorized represen-tation), the whole pipeline is end-to-end trainable in an un-supervised manner, based on the linkage of a differentiable rasterization technique [23].
We extensively experiment with the proposed framework both qualitatively and quantitatively on various datasets in-cluding Emoji [2], Icon [1] and Bauhaus-style graphic de-signs.
It is demonstrated that our method is able to gen-erate highly compelling results given only a small number of simple geometric shape primitive prototypes. Compared with sketch-based methods that easily generate redundant and mismatched curves, our method realizes compact com-bination of several primitives with good approximation ac-curacy. Moreover, our method can generate novel vector-ized shapes with rich semantics by simply replacing/editing the primitive type during inference, which also indicates its great applicability for modern graphic design. 2.