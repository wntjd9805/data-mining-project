Abstract
Fingerprinting is a promising non-invasive method for protecting the intellectual property rights (IPR) of deep neu-ral network (DNN) models. It extracts a feature called a
ﬁngerprint from a DNN model to identify its ownership. Ex-isting ﬁngerprinting methods focus only on classiﬁcation-related models that map images to labels, while inapplica-ble to models for image restoration that map images to im-ages. This paper proposes a ﬁngerprinting framework for
DNN models of image restoration. The proposed framework deﬁnes the ﬁngerprint using a critical image, which exhibits strongly discriminative patterns and is robust to modest model modiﬁcations. Model ownership is then veriﬁed by comparing the distance of color histograms and local gra-dient pattern histograms of critical images between the sus-pect and source models. We apply the proposed framework to two representative tasks, denoising and super-resolution.
It outperforms the baselines of ﬁngerprinting and competes against existing invasive model watermarking methods. for adversaries to plagiarize/steal the models, using meth-ods such as malware infection or internal leaks, to bypass the expensive training process. Consequently, both the com-munity and companies have a strong motivation to protect the IPR of their DNN models.
One popular approach for protecting the IPR of DNN models is model watermarking (e.g. [44, 1, 10, 7, 53, 8, 39, 20, 54, 21]), which invasively embeds speciﬁc information called watermark into the source model and examines its existence in the suspect model for ownership veriﬁcation.
However, modifying model weights can potentially affect the model’s utility, making it less desirable in practice.
Recently, a non-invasive approach called model ﬁnger-printing has gained attention. Unlike watermarking, ﬁnger-printing keeps the model intact and creates a unique feature called ﬁngerprint from the model for identifying ownership.
The ownership of a model is veriﬁed by comparing the ﬁn-gerprint of the source model with that of the suspect model.
While ﬁngerprinting is still in its early stages with few ex-isting works [3, 24, 11, 60, 33], it is gaining popularity as a non-invasive alternative to model watermarking. 1.

Introduction 1.1. Motivation
Deep learning has become a prominent tool for solving problems in computer vision, ranging from high-level im-age classiﬁcation problems to low-level image restoration problems. However, the cost of designing and training a
DNN model for speciﬁc applications has grown exponen-tially, leading to expenses in many areas such as hardware resources, data collection and labeling, and paying for engi-neers and researchers. Although sharing pre-trained DNN models has become a common practice in the community, many companies and institutes charge for the commercial usage of pre-trained models. This creates a strong incentive
*Corresponding author: Ruotao Xu (xrt@scut.edu.cn). This work is supported by the Natural Science Foundation of Guangdong Province (Grant No. 2023A1515012841, 2022A1515011755, 2022A1515011087);
National Natural Science Foundation of China (Grant No. 62106077);
Postdoctoral Special Foundation of China (Grant No. 2022T150219); Post-doctoral Foundation of China (Grant No. 2020M682705); and Singapore
MOE AcRF Tier 1 (Grant No. A-8000981-00-00).
In this paper, we focus on protecting the IPR of DNN models used for low-level image restoration tasks. These types of models map degraded images or measurements to high-quality target images. Deep learning has proven to be a powerful tool for solving a variety of image restora-tion problems, e.g., image denoising [57, 35, 36, 32], super-resolution (SR) [22, 47, 59, 43, 15], deblurring [58, 29, 40, 17, 41], and bad weather removal [34, 45, 37, 50, 51, 38].
Most existing works on IPR protection for DNN models focus on high-level vision tasks such as image classiﬁca-tion, where the DNN outputs a label in a ﬁnite discrete set.
In contrast, DNN models for image restoration output an image in a very high-dimensional space. Though there are a few works on watermarking DNN models for various image restoration tasks (e.g.[53, 39, 54]), these image restoration models can be vulnerable to modiﬁcations of DNN weights required in watermarking, resulting in the loss of important
and X2 be a random matrix with entries randomly sampled from a normal distribution. Since adding two independent
Gaussian random variables results in a new Gaussian ran-dom variable [18], Y2 also corresponds to a constant image corrupted by larger Gaussian white noise. Suppose a de-noising model performs well on predicting X1 (a constant matrix) from its noisy version Y1. Then, the denoiser will consistently take Y2 as the noisy version of a constant ma-trix and output a constant matrix, which is far away from the ground-truth matrix X2 (a random matrix). In other words, a denoising model designed to work well for constant ma-trices may not work well for random matrices.
To summarize, just like the decision boundary in classi-ﬁcation, there exists a “performance border zone” that sep-arates the set of images that the restoration model can ac-curately restore and the set of images that it cannot. This zone encodes essential characteristics of the model, and the points close to it can be used for its characterization. Partic-ularly, these points can be the images in the complementary set D that are close to the set D of images that the DNN can restore accurately (i.e., their prediction errors by the DNN are small). See Figure 1 for an illustration of this concept.
In this paper, we deﬁne the term ”critical images” to re-fer to the points near the performance border zone. Suppose that the target images in D follow some prior, such as the sparsity prior of gradients. Then, a critical image for the model M is an image X that minimizes the prediction error 2 (i.e., X is close to D) while also max-(cid:107)X − M(D(X))(cid:107)2 imizing a penalty that reﬂects the prior on the images in D (i.e., X is close to ¯D). This ensures that X is simultaneously close to both D and ¯D, i.e., it lies near their border zone.
Empirical observations suggest that the critical images obtained from independently-trained DNNs using the pro-posed approach consist of strong spatial patterns that not only convey discriminative information, but are also ro-bust to moderate modiﬁcations in model weights. There-fore, these critical images can serve as the ﬁngerprints of a model. For model veriﬁcation, we measure the distances be-tween the ﬁngerprints using two standard image descriptors: color histograms and local gradient patterns (LGP) [13]. 1.3. Contributions
The construction of a critical image forms the foundation of our proposed ﬁngerprinting approach for image restora-tion models. Our approach is applied to two representative image restoration tasks: denoising and SR. Denoising is a core problem in many image restoration tasks, and SR is one of the most successful applications of deep learning in im-age restoration. Extensive experiments on these two tasks have demonstrated that our proposed approach is more ro-bust than the baseline ﬁngerprinting methods and competi-tive with recent intrusive watermarking methods. See below for a summary of the main contributions:
Figure 1: Main idea of our model ﬁngerprinting approach for an image recovery DNN. We aim to ﬁnd a critical image (blue point) around the DNN’s performance border zone. image details and the addition of undesired artifacts.
Fingerprinting is a more attractive option for image restoration DNNs, as it does not require any modiﬁcation to model weights. However, to the best of our knowledge, no existing study has explored ﬁngerprinting for DNN models used in image restoration tasks. The existing ﬁngerprinting methods are designed for classiﬁcation DNNs which can be fully characterized by their decision boundaries. These methods use adversarial examples to characterize the deci-sion boundaries and generate a ﬁngerprint for the model.
In contrast, image restoration generates an image in a high-dimensional space, and its accuracy is measured by a con-tinuous metric such as mean squared error to the ground truth. Therefore, the concept of ”decision boundary” is not well-deﬁned for image restoration models.
Due to the signiﬁcant differences between image restora-tion and image classiﬁcation, the existing ﬁngerprinting methods for classiﬁcation DNNs cannot be easily extended to image restoration DNNs. As a result, we were motivated to develop a new ﬁngerprinting framework speciﬁcally de-signed for image restoration DNN models. 1.2. Main Idea
An image restoration task (e.g. denoising and SR) is to predict a latent image X from its degraded or partial measurements Y = D(X), where D denotes the degrad-In deep learning, a DNN model ing/measuring process.
M : Rn×m → RN ×M is trained to accurately predict X from the input D(X) in some task-related domain D. While the prediction error for most images in D, measured by (cid:107)X − M(D(X))(cid:107)2 2, is small, there exists a complementary set D where the DNN has large prediction errors.
Indeed, an image restoration DNN usually works well only for target images that lie within a low-dimensional manifold in RN ×M . It is not expected that a DNN will per-form well for all points in RN ×M . For instance, consider image denoising where Y = D(X) = X + N, with N rep-resenting Gaussian white noise. Let X1 be a constant matrix
• A ﬁngerprinting framework is proposed for protecting the IPR of image restoration DNN models. To the best of our knowledge, this is the ﬁrst study on ﬁngerprinting
DNN models of image restoration. model plagiarism, He et al. [11] proposed a ﬁngerprinting method to examine model integrity. This method identiﬁes a small set of human-unnoticeable transformed inputs that make a model’s outputs sensitive to its parameters.
• Analogous to decision boundaries in classiﬁcation, the concept of performance border zone is introduced to characterize image restoration DNN models.
• The concept of critical images, points in proximity to the performance border zone, is introduced to showcase discriminative and robust patterns that can serve as ef-fective ﬁngerprints for image restoration DNN models. 2.