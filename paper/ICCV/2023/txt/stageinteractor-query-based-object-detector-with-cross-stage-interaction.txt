Abstract
Previous object detectors make predictions based on dense grid points or numerous preset anchors. Most of these detectors are trained with one-to-many label assign-ment strategies. On the contrary, recent query-based ob-ject detectors are based a sparse set of learnable queries refined by a series of decoder layers. The one-to-one la-bel assignment is independently applied on each layer for deep supervision during training. Despite the great success of query-based object detection, however, this vanilla one-to-one label assignment strategy requires the detectors to have strong fine-grained discrimination and modeling ca-pacity. In this paper, we propose a new query-based object detector with cross-stage interaction, coined as StageInter-actor. During the forward pass, we come up with an effi-cient way to improve this modeling ability by reusing dy-namic operators with lightweight adapters. As for the label assignment, a cross-stage label assigner is designed to im-prove the one-to-one label assignment. With this assigner, the training target class labels are gathered across stages and then reallocated to proper predictions at each decoder layer. On MS COCO benchmark, our model improves the baseline counterpart by 2.2 AP, and achieves a 44.8 AP with ResNet-50 as backbone, 100 queries and 12 training epochs. With longer training time and 300 queries, StageIn-teractor achieves 51.3 AP and 52.7 AP with ResNeXt-101-DCN and Swin-S, respectively. The code and models are made available at https://github.com/MCG-NJU/
StageInteractor. 1.

Introduction
Object detection is a fundamental task in computer vision and acts as a cornerstone for many downstream tasks [48, 9].
It aims to localize and categorize all ob-ject instances in an image. Over the past few decades, dense spatial prior has been widely applied in various de-tectors. These detectors make predictions based on either (cid:0): Corresponding author (lmwang@nju.edu.cn).
Figure 1: Convergence curves of our model and other query-based object detectors [4, 68, 46, 15] with ResNet-50 [21] on MS COCO [31] minival set. a large quantity of pre-defined anchors covering the whole image [18, 41, 3, 33, 30, 40] or dense grid points in the fea-ture map of this image [26, 13, 65, 49, 39, 57]. To deliver supervision signals to these detectors, most works employ the one-to-many label assignment strategy [62, 66, 25, 17, 16, 59] (i.e., the classification label and localization target of one ground-truth object could be assigned to multiple object predictions). Although this paradigm is widely used in ob-ject detection, it suffers from redundant and near-duplicate predictions due to such label assignment [45], and thus re-lies heavily on specific post-processing algorithms for du-plicate removal [2, 23, 22].
Recently, DETR [4] and its variants [68, 46, 15, 7, 32, 14, 37, 8] open a new area of object detection. These query-based object detectors get rid of the dense prior and view object detection as a set prediction problem. Specifically, they use a sparse set of queries (i.e., learnable embeddings) to progressively capture the characteristics and location of objects with the help of a series of decoder layers. In each layer, image features are sampled and fused into the in-put queries via attention-like operation [51, 68] or dynamic mixing [46, 15]. Then, the transformed queries are decoded into object predictions and also serve as the inputs of next layer. As for the training of this paradigm, a kind of one-to-tion of our method lies in two aspects: cross-stage label as-signment and cross-stage dynamic filter reuse. Specifically, during the label assignment, a cross-stage label assigner is applied subsequent to the vanilla bipartite matching in each decoder layer. This assigner collects the results of bipar-tite matching across stages, and then reallocate proper train-ing target labels for each object prediction according to the query index and a score. As for the forward pass, in each decoder layer, we reuse the heavy dynamic operators in pre-ceding stages and add lightweight modules to increase the modeling capacity at a relatively low cost.
Experiments show that our model with ResNet-50 [21] as backbone can achieve 44.8 AP on MS COCO validation set under the simple setting of 100 queries, with 27.5 APs, 48.0 APm and 61.3 APl on small, medium and large ob-ject detection, respectively. Equipped with 3Ã— training time, 300 queries and more data augmentation in line with other query-based detectors, our model can achieve 49.9
AP, 51.3 AP, and 52.7 AP with ResNet-101, ResNeXt-101-DCN [55, 67], and Swin-S [34] as backbones, under the setting of single scale and single model testing. Our model significantly outperforms the previous methods, as shown in Fig. 1, and it has become a new state-of-the-art query-based object detector. 2.