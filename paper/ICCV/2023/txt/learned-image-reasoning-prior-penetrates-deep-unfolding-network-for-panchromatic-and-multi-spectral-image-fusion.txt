Abstract
The success of deep neural networks for pan-sharpening is commonly in a form of black box, lacking transparency and interpretability. To alleviate this issue, we propose a novel model-driven deep unfolding framework with im-age reasoning prior tailored for the pan-sharpening task.
Different from existing unfolding solutions that deliver the proximal operator networks as the uncertain and vague pri-ors, our framework is motivated by the content reasoning ability of masked autoencoders (MAE) with insightful de-signs. Specifically, the pre-trained MAE with spatial mask-ing strategy, acting as intrinsic reasoning prior, is embed-ded into unfolding architecture. Meanwhile, the pre-trained
MAE with spatial-spectral masking strategy is treated as the regularization term within loss function to constrain the spatial-spectral consistency. Such designs penetrate the image reasoning prior into deep unfolding networks while improving its interpretability and representation capabil-ity. The uniqueness of our framework is that the holis-tic learning process is explicitly integrated with the in-herent physical mechanism underlying the pan-sharpening task. Extensive experiments on multiple satellite datasets demonstrate the superiority of our method over the exist-ing state-of-the-art approaches. Code will be released at https://manman1995.github.io/. 1.

Introduction
Pan-sharpening, a texture-rich panchromatic image-guided multi-spectral image super-resolution task, is to rea-son the unknown content at the pre-defined pixel posi-tions according to the context of low-resolution (LR) multi-spectral (MS) image and high-resolution (HR) panchro-matic (PAN) image. Owing to the physical constraints,
*Co-first authors contributed equally, † corresponding author. We also gratefully acknowledge the support of MindSpore, CANN, and Ascend AI
Processor used for this research.
Figure 1: Motivation. Pan-sharpening is to reason the un-known content at the pre-defined pixel positions according to the context of low-resolution multi-spectral image and high-resolution panchromatic image. satellites usually adopt both MS and PAN sensors to ob-serve scenes, providing the MS images with high spectral but limited spatial resolution and the PAN images with high spatial but low spectral resolution. To obtain observation with both high spectral and high spatial resolutions, the pan-sharpening technique has drawn increasing attention in both image processing and remote sensing communities.
Many research efforts have been devoted to solving the pan-sharpening problem, which can be categorized into two groups: traditional optimization methods and deep learning-based methods. Since an infinite number of HR-MS images can be downsampled to produce the same LR-MS image, reasoning the HR-MS images from the LR coun-terparts is highly ill-posed. To solve the ill-posedness, vari-ous natural images priors as regularization terms have been developed in traditional optimization methods, e.g., low-rank prior [29] and sparse image priors [44]. However, these priors are not easy to be devised. Moreover, it is challenging to optimize these methods, hampering the practical applica-tions. Besides, due to the hand-crafted designs, their limited representation ability results in unsatisfactory performance.
The powerful learning capability of deep neural net-function:
H(k) = proxλ,Ω,P(H(k−1) + δ(DK)T(L − DKH(k−1))), (2) where k and δ denote the iterative step and learning factor.
In terms of the function proxλ,Ω,P that in-Motivation. volves the embedded prior term Ω(·), existing works usu-ally heuristically employ diverse network architectures in a black box fashion and deliver the proximal operator net-works as the uncertain and vague priors, vislized in Figure 2. These methods thus lack clear physical meanings of the prior terms. In addition, most deep unfolding-based meth-ods [26, 27] cannot extract the pan-sharpening customized prior with clear physical patterns well, which is caused by weak interpretable prior operations. Hence, we argue that the deep unfolding framework with sufficient interpretabil-ity has the potential of improving performance.
Solution. The first function of pan-sharpening is to reason the unknown information at the pre-defined pixel positions using the context, detailed in Figure 1. In this work, we pro-pose a novel model-driven deep unfolding framework for pan-sharpening with interpretability. Inspired by the con-tent reasoning ability of masked autoencoders (MAE) [9], our framework endows the holistic learning process of deep unfolding with the explicitly integrated with inherent phys-ical mechanism underlying the pan-sharpening task. The key insights of our framework are (1) we embed the pre-trained MAE with spatial masking strategy into the unfold-ing architecture, acting as intrinsic reasoning prior and (2) we treat the pre-trained MAE with spatial-spectral masking as the regularization term within loss function to constrain the spatial-spectral consistency. Such new designs pene-trate the image reasoning prior into deep unfolding network while improving the interpretability and representation abil-ity. Besides, our framework also outperforms existing state-of-the-art approaches on multiple satellite datasets.
Our main contributions are summarized as follows:
• We propose to embed the pre-trained MAE into deep unfolding architecture, resorting to its image reason-ing ability for pan-sharpening. Such reasoning prior makes the framework transparent and interpretable.
• We creatively treat the pre-trained MAE with spatial-spectral masking strategy as regularization term within loss function to constrain the spatial-spectral consis-tency. The tailored regularization term with intrinsic knowledge of spatial-spectral reasoning empowers the unfolding framework.
• In contrast to previous works, our framework as the first attempt pushes the frontiers of pan-sharpening to-wards the designs of the deep prior term. It shows out-standing performance on three satellite datasets, out-performing the state-of-the-art algorithms.
Figure 2: Motivation. The comparison between prior un-folding frameworks and ours. works ignites renewed interest in this problem. As a pio-neering work, PNN [18] employs three-layer convolution neural networks to account for pan-sharpening learning.
Since then, more and more complicated and deeper archi-tectures have been proposed to improve the performance of pan-sharpening [25, 28, 30]. Despite the remarkable progress, most of them focus on heuristically constructing network architectures in a black box fashion without con-sidering the underlying rationality of pan-sharpening task, lacking transparency and interpretability.
To improve interpretability, model-driven deep unfold-ing methods have been proposed. Xu et al. [26] propose the first deep unfolding network for pan-sharpening. The basic idea behind it is to formulate pan-sharpening as an optimization problem and employ the proximal gradient de-scent algorithm to solve it. The optimization process can be reformulated as:
ˆH = min
H 1 2
||L − DKH||2 2 + λΩ(H|P), (1) where λ is a hyper-parameter to weight the first term (data fidelity term accords with the degradation) and the second term (regularization term Ω(·)). D, and K denote the down-sampling and blur operators, respectively. L, P, and H re-spectively represent the LR-MS image, PAN image, and
HR-MS image. Technically, the proximal gradient descent algorithm can be approximatively expressed as an itera-tive convergence problem by solving the following iterative
2.