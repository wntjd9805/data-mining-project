Abstract
This paper addresses the problem of ranking pre-trained models for object detection and image classiﬁcation. Select-ing the best pre-trained model by ﬁne-tuning is an expensive and time-consuming task. Previous works have proposed transferability estimation based on features extracted by the pre-trained models. We argue that quantifying whether the target dataset is in-distribution (IND) or out-of-distribution (OOD) for the pre-trained model is an important factor in the transferability estimation. To this end, we propose
ETran, an energy-based transferability assessment metric, which includes three scores: 1) energy score, 2) classiﬁca-tion score, and 3) regression score. We use energy-based models to determine whether the target dataset is OOD or
IND for the pre-trained model.
In contrast to the prior works, ETran is applicable to a wide range of tasks includ-ing classiﬁcation, regression, and object detection (classi-ﬁcation+regression). This is the ﬁrst work that proposes transferability estimation for object detection task. Our ex-tensive experiments on four benchmarks and two tasks show that ETran outperforms previous works on object detection and classiﬁcation benchmarks by an average of 21% and 12%, respectively, and achieves SOTA in transferability as-sessment. Code is available here1. 1.

Introduction
Pre-trained neural networks are widely available on plat-forms such as HuggingFace [50] and TensorFlowHub [35] for different tasks such as classiﬁcation, object detection, segmentation, and natural language processing. These pre-trained models, which have acquired the fundamen-tal knowledge in vision [25] or language [9] domains, are very important in transfer learning to downstream target tasks with limited training data. Since training these mod-els from scratch is computationally expensive, task-speciﬁc
ﬁne-tuning from the pre-trained checkpoints is commonly 1https://developer.huaweicloud.com/ develop/aigallery/notebook/detail?id= 56e6645a-8133-49f6-a7ef-d877ef608fa5
Figure 1: The overall framework of transferability assess-ment, given M pre-trained models and a target dataset. considered a time- and cost-efﬁcient alternative solution.
One of the major challenges in transfer learning is to se-lect the best pre-trained model for a target task (or dataset), given numerous pre-trained models. The trivial solution to this problem is brute-force ﬁne-tuning, where all the given pre-trained models need to be ﬁne-tuned on the given dataset and then the best-performing ﬁne-tuned model is chosen for the target task. However, this procedure is very time-consuming and computationally expensive although it is highly accurate. Recent studies have proposed fast trans-ferability assessment and ranking solutions to properly and quickly rank the models and select the best ones (Figure 1).
Most of the previous works extract features from the tar-get dataset using the pre-trained models and try to ﬁnd the model whose features can be more effectively mapped to the labels from the target dataset (e.g., N LEEP [29], LogME
[52], PACTran [10], and SFDA [43]). In other words, these methods try to mitigate the ﬁne-tuning process in order to
ﬁnd a model that is more compatible with the given data samples based on the extracted features.
One limitation of these approaches is that the extracted features are drastically different before and after ﬁne-tuning, which is due to the difference in source and target domains. As a result, the transferability assessment only based on the extracted features cannot lead to a reliable,
general, and task-agnostic solution for obtaining an optimal pre-trained model. This uncertainty arises when the pre-trained model sees the input that differs from its training data (called in-distribution data), which can result in unreli-able features and predictions [31]. In other words, if the tar-get dataset does not follow the data distribution with which the model has been trained, the extracted features cannot be reliable for transferability assessment. Thus, determining whether the target dataset is in-distribution (IND) or out-of-distribution (OOD) is an essential assessment factor in
ﬁnding the best pre-trained model.
In this work, we propose an energy-empowered trans-ferability estimation method (called ETran) that exploits energy-based models (EBM) [28] to detect whether a tar-get dataset is IND or OOD for a given pre-trained model.
To this end, the higher the energy score for a target dataset, the more IND this dataset is for the pre-trained model
[31, 2, 3, 4]. As a consequence, the corresponding model has a high likelihood to provide the best accuracy after
ﬁne-tuning (for the given target dataset) compared to the models with lower energy scores.
In contrast to the pre-vious transferability metrics, the energy score is label- and optimization-free, which makes it highly efﬁcient and easy to use.
Another major limitation of most of the previous works is that they are only applicable to classiﬁcation tasks. H-Score [6] and LogME [52] are the only works in the litera-ture that introduce a solution for regression as well. Unlike the previous works, our method can deal with all classiﬁca-tion, regression, and object detection tasks. To the best of our knowledge, ETran is the ﬁrst transferability assessment approach that is also applicable to object detection (i.e., a combination of classiﬁcation and regression tasks).
In addition to the energy score, we also propose to use classiﬁcation and regression scores to beneﬁt from the feature-based characteristics of general transferability met-rics as in the previous methods. For the classiﬁcation score, we use Linear Discriminate Analysis (LDA) [19] to project features to a discriminate space by maximizing the variance between class labels and minimizing the variance within the classes. Bayes’ theorem is then applied to measure the probability of class labels given the input features. For the regression score, we employ a solution based on Singular
Value Decomposition (SVD) [17] that has fewer assump-tions and better performance compared to LogME. Our ex-periments show that the regression score is crucial for an accurate transferability measurement on the object detec-tion tasks. Figure 2 shows the overall framework of ETran.
The major contributions of this work are as follows:
• An energy-based transferability assessment metric that is label- and optimization-free; and also applicable to both classiﬁcation and detection.
• Proposing two more scores based on LDA and SVD for transferability measurement on classiﬁcation and object detection.
• Proposing the ﬁrst transferability metric for object de-tection tasks, and introducing multiple corresponding benchmarks and baselines that avail future research studies.
• Achieving SOTA results in transferability assessment for image classiﬁcation and object detection. 2.