Abstract
Predicting diverse yet admissible trajectories that ad-here to the map constraints is challenging. Graph-based scene encoders have been proven effective for preserving local structures of maps by deﬁning lane-level connections.
However, such encoders do not capture more complex pat-terns emerging from long-range heterogeneous connections between nonadjacent interacting lanes. To this end, we shed new light on learning common driving patterns by in-troducing meTA ROad paTh (TAROT) to formulate com-binations of various relations between lanes on the road topology.
Intuitively, this can be viewed as ﬁnding feasi-ble routes. Furthermore, we propose MEta-road NeTwORk (MENTOR) that helps trajectory prediction by providing it with TAROT as navigation tips. More speciﬁcally, 1) we de-ﬁne TAROT prediction as a novel self-supervised proxy task to identify the complex heterogeneous structure of the map. 2) For typical driving actions, we establish several TAROTs that result in multiple Heterogeneous Structure Learning (HSL) tasks. These tasks are used in MENTOR, which per-forms meta-learning by simultaneously predicting trajecto-ries along with proxy tasks, identifying an optimal combina-tion of them, and automatically balancing them to improve the primary task. We show that our model achieves state-of-the-art performance on the Argoverse dataset, especially on diversity and admissibility metrics, achieving up to 20% im-provements in challenging scenarios. We further investigate the contribution of proposed modules in ablation studies. 1.

Introduction
Vehicle trajectory prediction is one of the main build-ing blocks of autonomous driving. Prediction demonstrates how the future might unfold based on the road structure and the behavior of road users. To operate safely, self-driving cars must accurately perceive the geometric and seman-tic information in the driving scene and predict diverse yet scene-compliant trajectories. High-deﬁnition maps provide useful cues since the behaviors of agents and the interac-tions among them are largely inﬂuenced by the road topol-ogy and governed by the map constraints. For example, a vehicle is unlikely to change to a lane that runs in the op-posite direction. In this light, learning the structure of the map efﬁciently is essential to predict a variety of feasible trajectories.
Inspired by the structural nature of the road, map vec-torization has become prevalent in recent works, in which lanes are converted into vectors [15, 56, 18]. Consequently, graph structures can be leveraged to learn the relationships between vectorized entities [28, 54, 11, 16]. In this way, connected lanes in various formations, e.g. successor, pre-decessor, right, and left, represent admissible ways to tra-verse the terrain. For example, two lanes positioned con-secutively in space and connected by a sequential link can be driven successively, whereas two lanes connected by a lateral link enable a lane change maneuver. Hence, the HD map lane graph has edges with different semantic meanings, indicating its heterogeneous nature.
Although existing lane graphs are shown to be effective in learning local structures through the adjacent lanes, they lack the ability to model more complex patterns imposed by long-range heterogeneous connections between nonadja-cent yet interacting lanes. These connections are important to capture high-level intentions, such as overtaking, merg-ing, and double turns, and can potentially represent the con-straints and rules of the road. To model such connections, some methods propose adopting self-supervised tasks on top of the lane graph [15, 4] to encourage the model to learn the semantics associated with lane connectivities. Since scene structure contains various semantics, having only one proxy task at a time is insufﬁcient to provide diverse traf-ﬁc patterns. Alternatively, anchor-based models incorporate prior knowledge by identifying candidate trajectories based on sampling or clustering of training data [6, 43]. However, these methods are less robust and generalizable due to their dependency on the distribution of data.
Motivated by this insight, we introduce a novel self-supervised task for trajectory prediction, termed Heteroge-neous Structure Learning (HSL), to formulate trafﬁc pat-terns imposed by road constraints. In particular, we formu-late the road structure by meTA ROad paTh (TAROT) as a composite relation of heterogeneous edges in the scene graph that can model diverse abstractions from the map without additional data and labels. Therefore, by predict-ing the presence of TAROT in the driving scene as an HSL task, the model gets a sense of feasible transitions on the map as navigation tips for traversing the road. Furthermore, we propose MEta-road NeTwORk (MENTOR), a novel tra-jectory prediction framework that provides insight into the structural perspective of the map by simultaneously predict-ing a set of HSL tasks.
In detail, inspired by the meta-learning concept, MENTOR is learning to learn road topol-ogy by automatically selecting the HSL tasks that assist the target trajectory prediction.
The contributions of this paper are as follows: (1) For the ﬁrst time, to the best of our knowledge, we investigate the idea of learning to learn in trajectory prediction through the proposed MEta-road NeTwORk (MENTOR), which de-termines an optimal combination of Heterogeneous Struc-ture Learning (HSL) tasks and automatically balances them to assist the primary task of predicting diverse and ad-missible trajectories. (2) We propose meTA ROad paTh (TAROT) prediction as a novel HSL task capable of mod-eling high-level semantics within the map structure. Thus, diverse semantic aspects of road conﬁguration can be cap-tured by deﬁning various TAROTs, resulting in multiple
HSL tasks that are learned simultaneously. (3) We conduct extensive experimental evaluations to show our model’s ef-fectiveness in predicting not only precise but also diverse and admissible trajectories. 2.