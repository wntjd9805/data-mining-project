Abstract
Q: “a woman wearing the cream color dress and cutting cake with a man”
Existing Referring Image Segmentation (RIS) methods typically require expensive pixel-level or box-level annota-tions for supervision.
In this paper, we observe that the referring texts used in RIS already provide sufficient in-formation to localize the target object. Hence, we pro-pose a novel weakly-supervised RIS framework to formu-late the target localization problem as a classification pro-cess to differentiate between positive and negative text ex-pressions. While the referring text expressions for an image are used as positive expressions, the referring text expres-sions from other images can be used as negative expressions for this image. Our framework has three main novelties.
First, we propose a bilateral prompt method to facilitate the classification process, by harmonizing the domain discrep-ancy between visual and linguistic features. Second, we propose a calibration method to reduce noisy background information and improve the correctness of the response maps for target object localization. Third, we propose a positive response map selection strategy to generate high-quality pseudo-labels from the enhanced response maps, for training a segmentation network for RIS inference. For evaluation, we propose a new metric to measure localiza-tion accuracy. Experiments on four benchmarks show that our framework achieves promising performances to existing fully-supervised RIS methods while outperforming state-of-the-art weakly-supervised methods adapted from related ar-eas. Code is available at https://github.com/fawnliu/TRIS. 1.

Introduction
Referring Image Segmentation (RIS) aims to segment a target object from an input image according to the input lin-guistic query. It has many applications such as text-based image editing [8, 10], human-computer interaction [58, 64],
E-commercial search engine [76, 71].
*Joint first authors. †Joint corresponding authors. (a) Image (b) WWbL [51] (c) LAVT [65] (f) GT (d) Ours (Step-1) (e) Ours (Step-2)
Figure 1. Given an input image and a query expression (a), our method leverages a text-to-image response optimization process to locate the target object in the first step (d), and then produce the final map using a segmentation network in the second step (e). Our method outperforms the weakly-supervised method [51] (b) and achieves competitive result compared to the state-of-the-art fully-supervised RIS method [65] (c). Note that our method is trained using only text expressions, which are already available.
Hu et al. [22] propose the first RIS method, which sepa-rately extracts visual and linguistic features and then con-catenates them to predict the segmentation map. Subse-quently, many methods are proposed to fuse multi-modal features for RIS in different ways, e.g., with unidirec-tional fusion [66, 37] and bidirectional fusion [23, 15] using
CNNs, and long-range cross-modal modeling [65, 28] us-ing transformers. However, almost all existing RIS methods rely on the fully-supervised learning scheme to produce ac-curate results, which requires time-consuming and labour-intensive pixel-level annotations. (For example, skilled an-notators may need an average of 79s [44] to label a polygon-based instance mask for an image in MS COCO [33].) Re-cently, Feng et al. [16] propose to use bounding box anno-tations for weakly-supervised RIS, but it is still costly for labeling large-scale RIS datasets (on average 7s to annotate a single bounding box). Hence, there is still a need to design
RIS models with cheaper supervision signals.
Besides using bounding boxes, there are also other kinds
of weak supervision signals studied in other computer vi-sion tasks, including scribbles [70, 69], points [18] and class labels [57, 47]. However, scribbles and points still require and are sensitive to human involvement. Although class la-bels work well for other visual tasks, e.g., salient object de-tection [57], they are unsuitable for RIS due to their lack of instance information.
We observe that the input referring texts used in the RIS task have already provided distinctive descriptions, which describe one or several properties, of the target object that can be used to locate the object.
Inspired by this, we propose a novel weakly-supervised RIS framework, which learns to locate the target objects by learning how to classify positive and negative texts, where the positive texts are the referring texts that are used to describe the corresponding objects of the input images while the negative texts are the referring texts that describe objects from other images. Our framework has three main technical novelties. First, to fa-cilitate classification process, we propose a bilateral prompt method to harmonize the modal discrepancy between visual and linguistic features. Second, we propose a calibration method that consists of a foreground enhancement process and a background suppression process to enhance the de-rived response maps for target object localization. Third, we propose a novel positive response map selection strat-egy to derive high-quality pseudo-labels from the enhanced response maps, which are used to train a segmentation net-work for RIS inference. In addition, we propose a new met-ric to evaluate localization accuracy, which can reduce in-box errors of the existing pointing-game accuracy metric.
As shown in Fig. 1, our method can locate the target ob-ject and produce the segmentation map accurately. Even though it is trained using only text expressions, it produces a comparable result to the fully-supervised method [65]. In summary, this paper has the following main contributions:
• We propose a novel weakly-supervised RIS framework that is supervised only by the readily available refer-ring texts and does not require any extra annotations.
• Our framework has three main technical novelties.
First, we propose a bilateral prompt method to har-monize the visual and linguistic modal discrepancy.
Second, we propose a calibration method to improve the correctness of the response maps for localization.
Third, we propose a response map selection strategy to generate high-quality pseudo labels for the segmenta-tion of the target objects.
• We propose a new metric for the evaluation of localiza-tion accuracy. Extensive experiments on four bench-marks show that our framework can produce promis-ing results compared to previous fully-supervised RIS methods and outperforms existing weakly-supervised baselines adapted from related tasks. 2.