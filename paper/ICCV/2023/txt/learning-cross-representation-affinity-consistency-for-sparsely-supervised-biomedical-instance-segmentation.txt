Abstract
Sparse instance-level supervision has recently been explored to address insufficient annotation in biomedi-cal instance segmentation, which is easier to annotate crowded instances and better preserves instance complete-ness for 3D volumetric datasets compared to common semi-supervision. In this paper, we propose a sparsely supervised biomedical instance segmentation framework via cross-representation affinity consistency regularization. Specif-ically, we adopt two individual networks to enforce the perturbation consistency between an explicit affinity map and an implicit affinity map to capture both feature-level instance discrimination and pixel-level instance boundary structure. We then select the highly confident region of each affinity map as the pseudo label to supervise the other one for affinity consistency learning. To obtain the highly confident region, we propose a pseudo-label noise filtering scheme by integrating two entropy-based decision strate-gies. Extensive experiments on four biomedical datasets with sparse instance annotations show the state-of-the-art performance of our proposed framework. For the first time, we demonstrate the superiority of sparse instance-level su-pervision on 3D volumetric datasets, compared to common semi-supervision under the same annotation cost. Code is available at https://github.com/liuxy1103/
CRAC. 1.

Introduction
Biomedical instance segmentation aims to assign each image pixel to an instance, which plays an essential role in biomedical instance morphology and distribution anal-ysis [36, 32]. Recently, deep-learning-based methods [22, 26, 48, 20, 15, 30, 6] have achieved state-of-the-art perfor-*This work was done during Xiaoyu Liu’s internship at Institute of Ar-tificial Intelligence, Hefei Comprehensive National Science Center.
†Corresponding author: zwxiong@ustc.edu.cn.
Figure 1. Comparison of instance annotation schemes in differ-ent supervision ways for the volumetric dataset. (a) Full supervi-sion, where the whole volume is annotated. (b) Semi-supervision, (c) where a subset of the whole volume is densely annotated. sparse instance-level supervision, where a subset of instances of the whole volume is annotated. mance on biomedical instance segmentation with densely annotated images for fully-supervised training. However, it is expensive and laborious to obtain accurate and dense annotations.
To alleviate the huge cost of manual annotations, many works [42, 13, 49, 37, 7] adopt the semi-supervised learn-ing strategy to train an effective segmentation model with a small set of densely annotated images and a large set of unannotated images. However, in the field of biomed-ical instance segmentation, dense annotation is difficult to apply due to the crowded instances. Especially, for the 3D volumetric datasets (e.g., electron microscopy datasets), dense annotation within a small sub-volume usually dam-ages the completeness of the instances along the axial di-rection. Meanwhile, in practice, domain experts tend to an-notate instances one by one sparsely, rather than annotating all instances densely within a small sub-volume.
In this paper, we aim to deal with the task of biomedi-cal instance segmentation with sparse instance annotations.
This task is of utmost importance, as annotating a small subset of instances in a biomedical dataset not only saves the annotation cost but also conforms to annotation habits in the practical scenario. We illustrate different annotation
schemes in Fig. 1 and focus on the comparison between common semi-supervision and sparse instance-level super-vision. For a volumetric dataset, a few consecutive images are densely annotated for the semi-supervision in Fig. 1 (b), which generates many incomplete instances along the ax-ial direction. Instead, a few instances are randomly anno-tated for the sparse instance-level supervision in Fig. 1 (c), which preserves complete 3D structure information of each instance under the same number of annotated voxels as the semi-supervision.
Actually, sparse instance-level supervision can be con-sidered a special kind of semi-supervision at the region level. Thus, existing semi-supervised methods [42, 13, 49, 37, 7] can be readily adapted to the sparse instance-level supervision. As a pioneer work, SPOCO [46] imposes a consistency regularization scheme [42] in the unannotated regions of two embedding maps predicted in different aug-mented views. However, SPOCO adopts a metric learn-ing [9]-based segmentation method to distinguish different instances in the feature space, whose performance heav-ily drops as the number of annotated instances decreases.
On the other hand, the perturbation consistency used in
SPOCO is relatively simple and cannot effectively exploit instance structure information in unannotated regions.
In other words, there remains a large room to release the po-tential of the sparse instance-level supervision.
Compared to metric learning, affinity-based instance segmentation methods [44, 43] are less sensitive to the number of annotated instances, since affinities encode in-stance boundary structure knowledge and are easier to be learned.
Inspired by this kind of methods, we pro-pose an effective biomedical instance segmentation frame-work with sparse instance annotations, which learns cross-representation affinity consistency. Specifically, our frame-work consists of two individual networks to predict two different representations, i.e., an embedding map and an implicit affinity map (IAM), respectively. We then calcu-late the similarity between pixel embeddings and convert the embedding map into an explicit affinity map (EAM).
The IAM exploits the spatial structure information of in-stances, while the EAM exploits the semantic information of instances in the feature space. By building the perturba-tion consistency between the IAM and the EAM, we com-bine the advantages of two kinds of affinity modeling to capture both feature-level instance discrimination and pixel-level instance boundary structure. This perturbation consis-tency is different from the existing perturbation consistency between the same kinds of representations widely used in semi-supervised learning.
In our framework, we use the groundtruth affinity map generated from sparse instance annotations to supervise the two affinity maps in the annotated regions. Inspired by the cross pseudo supervision [7], we further propose an affin-ity cross-supervision mechanism to facilitate affinity con-sistency learning on the unannotated regions. Specifically, we design a pseudo-label noise filtering scheme that inte-grates a heuristic decision strategy based on an adaptive threshold and a learning decision strategy based on a pre-trained confident pixel selection network (CPSN), to select highly confident regions as pseudo labels from one affinity map to supervise the other.
We evaluate our methods on four biomedical datasets with sparse instance annotations to demonstrate the state-of-the-art performance of our proposed framework, com-pared to three kinds of baselines: 1) the existing sparsely supervised method SPOCO, 2) advanced semi-supervised methods which are adapted to sparse instance-level supervi-sion, and 3) original semi-supervised methods trained with dense annotation under the same annotation cost.
The contributions of this paper are as follows:
• We propose a sparsely supervised biomedical instance segmentation framework by enforcing the perturbation consistency between two kinds of affinity modeling.
• We propose an affinity cross-supervision mechanism with a pseudo-label noise filtering scheme integrating two decision strategies to select highly confident re-gions to facilitate affinity consistency learning.
• We conduct extensive experiments on four biomedi-cal datasets with sparse instance annotations to demon-strate the state-of-the-art performance of our method.
• We demonstrate the general superiority of sparse instance-level supervision over semi-supervision on 3D volumetric datasets for the first time. 2.