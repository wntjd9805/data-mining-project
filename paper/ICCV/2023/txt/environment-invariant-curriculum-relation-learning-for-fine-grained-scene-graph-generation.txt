Abstract
The scene graph generation (SGG) task is designed to identify the predicates based on the subject-object pairs.
However, existing datasets generally include two imbalance cases: one is the class imbalance from the predicted pred-icates and another is the context imbalance from the given subject-object pairs, which presents significant challenges for SGG. Most existing methods focus on the imbalance of the predicted predicate while ignoring the imbalance of the subject-object pairs, which could not achieve satisfactory results. To address the two imbalance cases, we propose a novel Environment Invariant Curriculum Relation learning (EICR) method, which can be applied in a plug-and-play fashion to existing SGG methods. Concretely, to remove the imbalance of the subject-object pairs, we first construct dif-ferent distribution environments for the subject-object pairs and learn a model invariant to the environment changes.
Then, we construct a class-balanced curriculum learning strategy to balance the different environments to remove the predicate imbalance. Comprehensive experiments con-ducted on VG and GQA datasets demonstrate that our EICR framework can be taken as a general strategy for various
SGG models, and achieve significant improvements. 1.

Introduction
Scene graph generation [39] (SGG) aims to predict the corresponding predicate (e.g., riding) based on the given subject-object pairs (e.g., (man, bike)). As an intermedi-ate visual understanding task, it can serve as a fundamen-tal tool for high-level vision and language tasks, such as visual question answering [33, 1, 20], image captioning
[4, 13, 49], and cross-model retrieval [11, 30], which pro-motes the development of visual intelligence.
Though many advances have been achieved [45, 33],
SGG is still far from satisfactory for practical applications
*Corresponding author
Codes available at: https://github.com/myukzzz/EICR
Figure 1. For SGG datasets, besides the class imbalance from pred-icates, there exists another imbalance phenomenon, i.e., context imbalance from subject-object pairs, which is easily ignored. To this end, this paper delves into class and context imbalance. And a method of Environment-Invariant Curriculum Relation Learning is proposed to generate fine-grained scene graphs effectively. due to the imbalance phenomenon in the given datasets [32].
To this end, most existing methods focus on addressing the class imbalance from the predicted predicates to generate accurate relation words. Particularly, some works propose resampling [10, 19] and reweighting [38] strategies to bal-ance the head and tail predicate classes, which alleviates the imbalance and improves the performance of SGG.
Besides the class imbalance from the predicted predi-cate, there exists another context imbalance from the given subject-object pairs, which is prone to be ignored. As shown in Fig. 1, since the predicate prediction relies on the given subject-object context, the number imbalance of the given subject-object pairs easily incorrectly predicts the re-lation between subjects and objects. For example, there ex-ist a large number of relations between ‘(man, shirt)’ and
‘wearing’ in the dataset. When giving a rare subject-object pair, e.g., ‘(man, boots)’, the model is prone to generate an incorrect prediction. In Fig. 2 (a), we make an analysis of a popular SGG dataset VG [17]. We observe that the num-ber of context subject-object types will change significantly with the number of predicate categories. Moreover, Fig. 2
2.