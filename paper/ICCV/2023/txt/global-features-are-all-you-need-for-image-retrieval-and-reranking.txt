Abstract
Image retrieval systems conventionally use a two-stage paradigm, leveraging global features for initial retrieval and local features for reranking. However, the scalability of this method is often limited due to the significant storage and computation cost incurred by local feature matching in the reranking stage. In this paper, we present SuperGlobal, a novel approach that exclusively employs global features for both stages, improving efficiency without sacrificing ac-curacy. SuperGlobal introduces key enhancements to the retrieval system, specifically focusing on the global feature extraction and reranking processes. For extraction, we iden-tify sub-optimal performance when the widely-used ArcFace loss and Generalized Mean (GeM) pooling methods are com-bined and propose several new modules to improve GeM pooling. In the reranking stage, we introduce a novel method to update the global features of the query and top-ranked images by only considering feature refinement with a small set of images, thus being very compute and memory efficient.
Our experiments demonstrate substantial improvements com-pared to the state of the art in standard benchmarks. Notably, on the Revisited Oxford+1M Hard dataset, our single-stage results improve by 7.1%, while our two-stage gain reaches 3.7% with a strong 64, 865× speedup. Our two-stage system surpasses the current single-stage state-of-the-art by 16.3%, offering a scalable, accurate alternative for high-performing image retrieval systems with minimal time overhead.
Code: https:// github.com/ ShihaoShao-GH/ SuperGlobal. 1.

Introduction
Image retrieval systems are tasked with searching large databases for visual contents similar to a query image. Gen-erally, the search process consists of two stages. First, an efficient method sorts database images according to esti-mated high-level similarity to the query. Then, in the rerank-ing stage, the most relevant database images found in the
∗Both authors contributed equally to this paper.
†Co-corresponding authors. Emails: shaoshihao@pku.edu.cn, bingyi@google.com
Figure 1: We introduce SuperGlobal, a novel method for image retrieval and reranking which relies solely on global image features. SuperGlobal leverages several improvements to the Generalized Mean (GeM) pooling function, across regions and scales, as indicated in the purple box on the left. Our reranking process, illustrated on the right green box, refines the global feature representation based on the query and top retrieved images to produce a more relevant set of results. first stage undergo a more comprehensive matching process against the query, to return an improved ranked list of results.
In modern implementations, the first stage is instantiated with deep learning-based global features, which has received substantial attention in the past few years [35, 37, 26, 48].
The reranking stage is commonly executed via geometric matching of local image features [30, 32, 4, 8], which pro-vides information on the spatial consistency between the query and a given database image.
A recent trend in this area is on leveraging sophisticated matching processes at the reranking stage, e.g. transformers
[40] or 4D correlation networks [23], which have led to re-markable improvements in the quality of retrieved results.
However, this has come at a significant cost, where reranking latency takes several seconds per query and requires more 1
than 1MB of memory per database image – making these approaches challenging to scale to large repositories. Our work directly tackles this limitation by proposing the first method fully based on global image features for both stages.
In addition, we rethink pooling techniques and propose mod-ules to improve global feature extraction. An overview of our method, SuperGlobal, is presented in Figure 1. More specifically, we introduce the following contributions.
Contributions: (1) We propose improvements to the core global feature representation, based on enhanced pooling strategies. We point out undesired training behavior when learning global features combining GeM pooling [35] and ArcFace loss
[11], and introduce a simple and effective solution to this problem with new pooling modules, including regional and multi-scale techniques. (2) We introduce a very efficient and effective reranking process, based solely on global features, that is able to adapt the representation of the query and top-ranked database im-ages on the fly in order to better estimate their similarities.
This method does away with any need for expensive local features and is inherently very scalable since the features used in both search stages are the same. (3) Experiments on standard image retrieval benchmarks showcase the effectiveness of our methods, establishing new state-of-the-art results across the board. We boost single-stage results on Revisited Oxford+1M Hard [34] by 7.1%.
But even more impressively, our simple reranking mecha-nism outperforms previous complex methods by 3.7% on the same dataset, while being more than four orders of mag-nitude faster and requiring 170× less memory. 2.