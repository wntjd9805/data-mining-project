Abstract
Unsupervised anomaly detection is widely studied in in-dustrial applications where anomalous data is difficult to obtain. In particular, reconstruction-based anomaly detec-tion can be a feasible solution if there is no option to use external knowledge, such as extra datasets or pre-trained models. However, reconstruction-based methods have lim-ited utility due to poor detection performance. A score-based model, also known as a denoising diffusion model, recently has shown a high sample quality in the gener-ation task.
In this paper, we propose a novel unsuper-vised anomaly detection method leveraging the score-based model. The proposed method shows promising performance without requiring external knowledge. The score, a gradi-ent of the log-likelihood, has a property that is available for anomaly detection. The samples on the data manifold can be restored instantly by the score, even if they are ran-domly perturbed. We call this score-based perturbation re-silience. On the other hand, the samples that deviate from the manifold cannot be restored in the same way. The vari-ation of resilience depending on the sample position can be an indicator to discriminate anomalies. We derive this statement from a geometric perspective. Our method shows superior performance on three benchmark datasets for in-dustrial anomaly detection. Specifically, on MVTec AD, we achieve image-level AUROC of 97.7% and pixel-level AU-ROC of 97.4% outperforming previous works that do not use external knowledge. 1.

Introduction
Anomaly detection is an important task in the manufac-turing industry. It finds its usage in production lines, such as quality control through defect inspection. Consistent qual-∗
†
Equal Contribution
Corresponding author
Figure 1. Illustrations of the proposed method (Left) and the reconstruction-based method (Right) for unsupervised anomaly detection. The pink gradation solid line and dotted line denote the negative log-likelihood and the manifold estimated by the re-construction model, respectively. ity control can be ensured by an automated anomaly detec-tion system which reduces human labor and prevents the de-crease in attention spans. Supervised anomaly detection is a simple approach. However, sometimes, the supervised ap-proach is not feasible in practical applications due to various reasons. On real-world manufacturing lines, abnormal sam-ples are rare. As a result, only a few abnormal samples are available. Because abnormal samples are irregular and have a large diversity, identifying abnormal patterns with a small amount of data is difficult. Moreover, obtaining accurate ground truth is time-consuming and requires experts with domain knowledge. Thus, gathering an adequate dataset for training the supervised method is impractical. Therefore, an unsupervised approach that detects abnormal samples using only abundant normal samples is widely used. The unsu-pervised approach to anomaly detection encourages learn-ing useful features from only normal samples, with no prior
knowledge of abnormality. This approach is used not only in the manufacturing industry but also in medical diagnos-tics [53, 30, 10], video surveillance [36, 21, 13], and au-tonomous driving [18, 44, 15].
Recently, various unsupervised approaches have been introduced.
Embedding-based methods and synthetic anomaly-based methods utilize pre-trained models with large datasets, such as ImageNet, and artificially synthe-sized anomalous data, respectively, instead of specific su-pervision. These methods have shown remarkable detec-tion performance in industrial benchmarks. However, de-spite their superior performance, a limitation remains in that the transferability of leveraged external knowledge needs to be verified with some degree of priori. The reconstruction-based approach can be another good alternative. The right side of Figure 1 schematically shows this approach from a geometrical perspective. The reconstruction model, such as a variational auto-encoder, is trained to mimic the mapping function from latent space, also known as feature space, to the data manifold. A difference between the original sam-ple and the sample reconstructed by a reconstruction model, denoted by reconstruction error, is used as a discrimina-tive measure for anomaly detection. The latent space of the model can reflect only the representation of data used to train. Therefore, for unseen anomalous samples, the re-construction error will be larger than for normal samples.
Not only is this approach theoretically intuitive and reason-able, but it is also practically versatile in that it requires little external knowledge.
We propose an unsupervised anomaly detection method using a score-based model. Score-based models have at-tracted significant attention in the field of data generation because of their capability to produce high-quality sam-ples. There are previous studies utilizing this model for anomaly detection in the medical imaging field [47, 45].
They have shown impressive results. However, the denois-ing diffusion process involved in their proposed method is time-consuming, making it difficult to apply to manufac-turing industries that require real-time processing. Instead, we have found an inherent property of the score, a gradient of the log-likelihood, that is available to detect anomalies.
The score can immediately restore the samples on the data manifold, even if perturbed randomly. We call this score-based resilience to perturbations. On the other hand, it is impossible for the samples that deviate from the manifold to be restored through the score. The left side of Figure 1 shows this principle. The variation of resilience depending on the sample position can be a discriminator for anomaly detection. We introduce the stochastic measure, restoration error, to quantify the resilience of the observed sample. The restoration error is defined as an expectation of the distance between the restored sample after being perturbed and the original sample.
Our key contributions are summarized as follows:
• We propose a novel approach leveraging a score-based model for unsupervised anomaly detection. The pro-posed method requires no external knowledge, such as pre-trained models or extra datasets.
• Interpreting a score function from a geometric view, we support the theoretical reasonability that score-based resilience to perturbation can be available for anomaly detection.
In addition, we introduce a stochastic measure, restoration error, to quantify re-silience.
• Conducting on public experiments benchmark datasets, MVtec AD, BTAD, and MPDD, for indus-trial anomaly detection, we show that our method can achieve outperforming results in an unsupervised setting. 2.