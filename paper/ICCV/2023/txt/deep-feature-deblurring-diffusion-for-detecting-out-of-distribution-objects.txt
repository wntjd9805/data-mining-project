Abstract
To promote the safe application of detectors, a task of un-supervised out-of-distribution object detection (OOD-OD) is recently proposed, whose goal is to detect unseen OOD objects without accessing any auxiliary OOD data. For this task, the challenge mainly lies in how to only lever-age the known in-distribution (ID) data to detect OOD ob-jects accurately without affecting the detection of ID ob-jects, which can be framed as the diffusion problem for deep feature synthesis. Accordingly, such challenge could be addressed by the forward and reverse processes in the diffusion model. In this paper, we propose a new approach of Deep Feature Deblurring Diffusion (DFDD), consist-ing of forward blurring and reverse deblurring processes.
Specifically, the forward process gradually performs Gaus-sian Blur on the extracted features, which is instrumen-tal in retaining sufficient input-relevant information. By this way, the forward process could synthesize virtual OOD features that are close to the classification boundary be-tween ID and OOD objects, which improves the perfor-mance of detecting OOD objects. During the reverse pro-cess, based on the blurred features, a dedicated deblurring model is designed to continually recover the lost details in the forward process. Both the deblurred features and orig-inal features are taken as the input for training, strength-ening the discrimination ability.
In the experiments, our method is evaluated on OOD-OD, open-set object detec-tion, and incremental object detection. The significant per-formance gains over baselines demonstrate the superiori-ties of our method. The source code will be made available at: https://github.com/AmingWu/DFDD-OOD. 1.

Introduction
Discriminating known from unknown objects is indis-pensable for building reliable detection systems. Currently, most object detection models [38, 14, 53, 2] usually follow
*Corresponding author
Figure 1. Deep Feature Deblurring Diffusion (DFDD) for detect-ing OOD objects. The forward process aims to synthesize virtual
OOD features (as shown in the blue stars) by gradually perform-ing Gaussian Blur on the extracted feature maps, which reduces the impact of lacking OOD data and improves the ability of de-tecting OOD objects. Meanwhile, the reverse stage is to recover the deblurred results (as shown in dark orange) of the forward out-put. Finally, both the deblurred results and original feature maps (as shown in orange) are taken as the input for training, which en-hances the discrimination of the object classifier. a close-set assumption, i.e., the training and testing stages share the same category space. However, the real scenario is open and full of unknown objects, presenting significant challenges for close-set assumption based detectors. To pro-mote the safe deployment of detectors, a task of unsuper-vised out-of-distribution object detection (OOD-OD) [6] is proposed, aiming to detect OOD objects never-seen-before during training without using any auxiliary OOD data.
For unsupervised OOD-OD [6], there exist two essential challenges: one is to only leverage the given in-distribution (ID) data to improve the ability of discriminating OOD ob-jects. Another is to avoid the performance degradation of
ID object detection. One feasible solution [6, 37] is to syn-thesize a series of virtual OOD features based on the ID data, which promotes the detector to learn a clear boundary between ID and OOD objects. The work [6] first utilizes
ID data to estimate class-conditional distribution for each
category. Then, virtual OOD features are sampled from the region that slightly deviates from the estimated distribution.
However, to estimate the distributions accurately, it is criti-cal to use a large number of objects for each category, which limits its application in the case of few samples.
To reduce the impact of lacking OOD data, in this pa-per, we focus on synthesizing virtual OOD features that are close to the classification boundary of ID and OOD objects.
Here, we assume that the data points located on the bound-ary should own an important attribution, i.e., the boundary data is related to the ID data but can not be classified into
ID categories. One intuitive idea is to utilize GANs [10] for feature synthesis, which is difficult to optimize [6] and could not resolve the two challenges of OOD-OD effec-tively. To this end, as shown in Fig. 1, we explore han-dling the two key challenges from the diffusion perspective
[18, 39, 20]. In general, diffusion models [32, 24] contain a forward diffusion by adding noise and a reverse denois-ing process. For unsupervised OOD-OD, the forward pro-cess could be utilized to synthesize OOD features near the boundary, improving the capability of distinguishing OOD objects. The reverse process is exploited to recover the fea-tures involving rich object-related information, used to en-hance the discrimination of the object classifier.
Unfortunately, experimental results show that using the denoising diffusion [18, 44] for feature synthesis could not boost the performance of discriminating OOD objects. The reason may be that adding much noise destroys the seman-tic structure of the features, resulting in the synthesized fea-tures being far away from the classification boundary of ID and OOD objects and then attenuating the discrimination of the detector. To this end, we pay attention to exploiting
Gaussian Blur to replace adding noise and design a dedi-cated deblurring mechanism to generate expected features for addressing the two challenges of OOD-OD.
Specifically, as shown in Fig. 1, an approach of Deep
Feature Deblurring Diffusion (DFDD) is proposed, which consists of forward blurring and reverse deblurring. During the forward process, we gradually perform Gaussian Blur
[9] on the feature maps extracted by a backbone network.
Since Gaussian Blur is a weighted average of neighboring elements, compared with adding noise roughly, this oper-ation continually removes detail content and could retain plentiful input-related information. For example, in Fig. 1, we can see that after T iterations, compared with the origi-nal feature x0, xT contains much less detail information but still involves rich content related to x0. And based on xT , it is difficult to recognize the categories of ID objects. There-fore, xT is the expected virtual OOD feature that is close to the classification boundary of ID and OOD objects, which is instrumental in improving the performance of distinguish-ing OOD objects. Next, in the reverse stage, a U-Net model
[40] is designed to recover the deblurred features containing plentiful object-related information. Finally, both the de-blurred features and original features are taken as the input for training, which ameliorates the discrimination ability. In the experiments, our method is evaluated on three different tasks. Extensive experimental results on multiple datasets demonstrate the superiorities of our method.
The contributions are summarized as follows: (1) Though diffusion models have achieved impressive performance in image generation, it is under-explored for feature generation. In this paper, we convert the challenges of unsupervised OOD-OD to the diffusion problem for fea-ture synthesis and present a new solution to strengthen the ability of discriminating OOD objects. (2) We propose an approach of Deep Feature Deblurring
Diffusion (DFDD) for unsupervised OOD-OD. Particularly, the forward process is to synthesize virtual OOD features by gradually performing Gaussian Blur. Meanwhile, a ded-icated deblurring mechanism is designed to enhance the dis-crimination of the object classifier. (3) In the experiments, our method is evaluated on OOD-OD [6], open-set object detection [25, 43], and incremen-tal object detection [13]. Particularly, based on MS-COCO
[30], compared with the baseline method [6], our method significantly reduces FPR95 by around 13.56%. 2.