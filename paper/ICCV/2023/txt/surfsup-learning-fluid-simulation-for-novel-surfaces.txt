Abstract 1.

Introduction
Modeling the mechanics of ﬂuid in complex scenes is vital to applications in design, graphics, and robotics.
Learning-based methods provide fast and differentiable
ﬂuid simulators, however most prior work is unable to ac-curately model how ﬂuids interact with genuinely novel sur-faces not seen during training. We introduce SURFSUP, a framework that represents objects implicitly using signed distance functions (SDFs), rather than an explicit represen-tation of meshes or particles. This continuous representa-tion of geometry enables more accurate simulation of ﬂuid-object interactions over long time periods while simultane-ously making computation more efﬁcient. Moreover, SURF-SUP trained on simple shape primitives generalizes con-siderably out-of-distribution, even to complex real-world scenes and objects. Finally, we show we can invert our model to design simple objects to manipulate ﬂuid ﬂow.
∗Authors contributed equally.
Across engineering and science, the simulation of ﬂuid dynamics has become an invaluable tool, and it will be a crucial component for building visual systems that are capable of understanding and interacting with real-world environments. Recently, a new class of simulators has emerged that learn the dynamics of physical systems from data [13, 32, 25]. These simulators offer several advantages over classical simulators by increasing speed, reducing re-liance on hand-crafted dynamics models, and providing dif-ferentiable rollouts for solving inverse problems. Recent approaches based on graph neural networks (GNNs) have in particular shown impressive accuracy and generalization on a wide range of ﬂuids represented as particle or mesh-based systems [25, 23].
In a wide variety of applications areas, ﬂuid simula-tion must properly handle interaction with solid structures to attain practical relevance. Many problems involving
ﬂuid simulation are fundamentally about object design; for example, designing aerodynamic shapes for cars and air-planes. In robotics too, an intelligent robot would have to understand ﬂuid-surface interactions; for example, to carry a mug of hot coffee to a person without spilling the liq-uid from the container.
In both cases, the need to ac-curately model how ﬂuids interact with novel solid sur-faces1— with new shapes, conﬁgurations, orientations, and so on—motivates an challenging out-of-distribution (OOD) generalization subproblem for ﬂuid simulation.
In this paper, we tackle this problem by introducing
Surface implicit sUbstitution for particles (SURFSUP), a framework for simulating the interactions of ﬂuids and sur-faces by representing surfaces using implicit representa-tions [19]. Current GNN-based approaches represent sur-faces explicitly, discretizing them into particles and aug-menting the graph accordingly [25].
Implicit representa-tions, in particular signed distance functions which repre-sent surfaces as zero-level sets of functions, offer several compelling advantages. They can smoothly represent con-tinuous surfaces, provide rich geometric information (e.g. whether a point is in the interior/exterior of the object), and can scale easily to large objects and scenes. Due to these properties, many state-of-the-art generative models for 3D shapes learn shapes with signed distance functions. We ar-gue that these properties are useful not just for statics but also dynamics: in order to accurately model ﬂuid-surface interactions for potentially complex surfaces, smooth and informative representations of local surface geometry are
In turn, we posit that these locally informative needed. representations will enable ﬂuid simulators to appropriately model interaction with never-before-seen surfaces.
Concretely, we propose an approach that integrates signed distance representations of surfaces [22, 19] with graph neural network models [26, 25]. Our architecture fol-lows the encode-process-decode paradigm [25], where the particles in the physical system at time T are encoded into a graph, followed by several message-passing steps, and ﬁ-nally a decoder predicts the dynamics (accelerations). We represent the surface using its signed distance function, and exploit geometric properties of SDFs to model the distance and orientation of ﬂuid particles with respect to the surface.
Experiments show that our approach can model ﬂuid-surface interactions over long rollouts with a high degree of accuracy and visual realism. SURFSUP can model surfaces far beyond its training domain; when trained on simple primitive shapes (e.g. spheres, cones, toruses), we general-ize zero-shot to complex real-world objects and scenes rep-resented using neural implicit generative models (Fig. 1).
We compare to a method which represents the surface as particles inside the graph network simulator, and show that our model achieves better generalization and efﬁciency, and 1For brevity we refer to surfaces of solid objects simply as “surfaces”. can better handle complex surface geometry. Finally, we demonstrate the potential of SURFSUP to solve inverse problems across two object design tasks. Overall, our paper bridges learned physical models for dynamics and 3D im-plicit representations, and takes a step towards AI models which can understand and help design the physical world. 2.