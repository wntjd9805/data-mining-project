Abstract
Pseudo-labeling is significant for semi-supervised in-stance segmentation, which generates instance masks and classes from unannotated images for subsequent training.
However, in existing pipelines, pseudo-labels that contain valuable information may be directly filtered out due to mismatches in class and mask quality. To address this is-sue, we propose a novel framework, called pseudo-label aligning instance segmentation (PAIS), in this paper.
In
PAIS, we devise a dynamic aligning loss (DALoss) that ad-justs the weights of semi-supervised loss terms with vary-ing class and mask score pairs. Through extensive experi-ments conducted on the COCO and Cityscapes datasets, we demonstrate that PAIS is a promising framework for semi-supervised instance segmentation, particularly in cases where labeled data is severely limited. Notably, with just 1% labeled data, PAIS achieves 21.2 mAP (based on Mask-RCNN) and 19.9 mAP (based on K-Net) on the COCO dataset, outperforming the current state-of-the-art model, i.e., NoisyBoundary with 7.7 mAP, by a margin of over 12 points. Code is available at: https://github.com/ hujiecpp/PAIS. 1.

Introduction
Semi-supervised instance segmentation aims to allevi-ate the significant burden of human labeling by utilizing a small amount of labeled data in conjunction with abun-dant unlabeled data [35, 47, 50]. Existing semi-supervised instance segmentation pipelines typically generate pseudo-labels from unlabeled images, which are then used to train the models together with labeled images. There-fore, pseudo-labels play a crucial role in semi-supervised instance segmentation. The generation of pseudo-masks, pseudo-classes, and pseudo-boxes from unlabeled images improves the model training. However, current semi-*Corresponding author. †Equal contribution. supervised instance segmentation frameworks do not fully leverage the potential of such pseudo-labels. Specifically, pseudo-labels with mismatched class and mask scores are often filtered out by fixed thresholds, leading to the exclu-sion of valuable information that could aid the model train-ing. For instance, pseudo-labels with high-quality masks but low class scores would be filtered out by a class thresh-old, resulting in the loss of the pixel-level information.
In this paper, we present a new semi-supervised frame-work, termed pseudo-label aligning for instance segmen-tation (PAIS), aiming to improve the utilization of filtered pseudo-labels. As illustrated in Fig. 1, the main challenge of PAIS lies in the mismatched scores between pseudo-classes and pseudo-masks. The classification score and mask intersection over union (IoU) are misaligned in as-sessing the quality of pseudo-labels. As a result, masks with high IoUs would be filtered out due to low classi-fication scores, and vice versa.
In the mean time, low-ering the threshold of both scores introduces incorrect classes or low-quality masks into the semi-supervised train-ing. To overcome this dilemma, we propose a dynamic aligning loss (DALoss) that softly re-weights the classi-fication and the segmentation losses based on the quality of different pseudo-labels. Specifically, DALoss penalizes low-score pseudo-labels rather than filtering them and pro-motes high-score ones, to adjust their contribution to the final loss function. Our experiments on the COCO and
Cityscape datasets demonstrate the effectiveness of the pro-posed PAIS framework. Specifically, with only 1% labeled data, PAIS achieves 21.2 mAP and 19.9 mAP on the COCO dataset using Mask-RCNN [13] and K-Net [53], respec-tively. This outperforms the current state-of-the-art model,
NoisyBoundary [47], by more than 12 points.
Our contributions can be summarized as follows:
• We propose a novel pseudo-label aligning framework for semi-supervised instance segmentation, called
PAIS, which unleashes the potential of utilizing pixel-level pseudo-labels in semi-supervised instance seg-mentation. Furthermore, to the best of our knowledge,
Figure 1. Pseudo-label wasting in semi-supervised instance segmentation. To illustrate this issue, we employed the K-Net model [53] trained on 10% labeled images and randomly sampled 5k unlabeled images, from the COCO train2017 dataset, to plot the figures. In (a), we present the predicted classification score w.r.t. the ground truth mask intersection over union (IoU), revealing that the predicted classification score is inadequate in evaluating mask quality. In (b), we added a mask IoU prediction branch to the model and plotted the predicted mask IoU w.r.t. the ground truth mask IoU, demonstrating that the predicted mask IoU can represent the mask quality.
However, as shown in (c), a significant number of pseudo-labels with high-quality masks, i.e., mask IoU > 0.7, will be filtered out with high classification thresholds. Additionally, (d) shows that pseudo-labels with high-quality masks can also have correspondingly low classification scores. Therefore, the misalignment between the mask and class scores leads to a significant number of valuable pseudo-labels being excluded during semi-supervised training.
PAIS is the first framework that can be adapt to box-free instance segmentation models.
• We introduce a new loss function, named dynamic aligning loss (DALoss), which incorporates pseudo-labels with diverse class and mask qualities into the semi-supervised training process. DALoss consis-tently enhances the performance of box-free and box-dependent instance segmentation frameworks.
• We conduct comprehensive experiments on the COCO and Cityscapes datasets to evaluate PAIS. In particu-lar, PAIS achieves state-of-the-art results on the COCO dataset, i.e., 19.9, 27.6, and 31.1 mAP for the box-free pipeline K-Net [53], and 21.2, 29.3, and 31.1 mAP for the box-dependent pipeline Mask-RCNN [13], with 1%, 5%, and 10% labeled data, respectively. 2.