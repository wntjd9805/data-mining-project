Abstract
In industrial anomaly detection, data efficiency and the ability for fast migration across products become the main concerns when developing detection algorithms. Existing methods tend to be data-hungry and work in the one-model-one-category way, which hinders their effectiveness in real-world industrial scenarios. In this paper, we propose a few-shot anomaly detection strategy that works in a low-data regime and can generalize across products at no cost. Given a defective query sample, we propose to utilize a few nor-mal samples as a reference to reconstruct its normal ver-sion, where the final anomaly detection can be achieved by sample alignment. Specifically, we introduce a novel re-gression with distribution regularization to obtain the op-timal transformation from support to query features, which guarantees the reconstruction result shares visual similarity with the query sample and meanwhile maintains the prop-erty of normal samples. Experimental results show that our method significantly outperforms previous state-of-the-art at both image and pixel-level AUROC performances from 2 to 8-shot scenarios. Besides, with only a limited num-ber of training samples (less than 8 samples), our method reaches competitive performance with vanilla AD methods which are trained with extensive normal samples. The code is available at https://github.com/FzJun26th/
FastRecon. 1.

Introduction
Anomaly detection (AD) in computer vision aims to identify rare observations that deviate significantly from the majority of the data and do not conform to a well-defined notion of normal behavior [4]. In industrial settings, AD is widely used to detect the anomalies on the surface of the product, which has been attracting a lot of attention re-â€ Equal contribution.
*Corresponding author.
Figure 1: Comparison of our FastRecon with (a) Vanilla
Reconstruction-based method and (b) Vanilla Feature-Matching-based method. Compared with (a), our method needs no training session and requires less normal sam-ples for feature reconstruction. Compared with (b), our method applies direct pixel-to-pixel alignment between the test sample and reconstruction result for anomaly detection without an exhaustive feature searching process, thus being more efficient in inference. cently [31, 16, 9]. The difficulty of industrial AD lies in the diversity of the defects, which can take different forms, from subtle flaws like slight bruises, to obvious ones such as missing components [3]. This makes it difficult to detect and classify anomalies. Primal researches focus on utilizing supervised learning to tackle industrial AD [5, 17]. How-ever, such a learning paradigm often requires an exhaustive set of anomalous samples for each category, which can be
naturally rare to collect, making it inefficient for real-world industrial scenarios.
Recent works pay attention to learning with limited or even no supervision to overcome the problem caused by the lack of anomalous samples. As shown in Fig. 1 (a), reconstruction-based industrial AD [34, 10, 26, 14] utilizes generative models such as autoencoder to learn the distri-bution of normal samples through the cumbersome training process. As in Fig. 1 (b), recent researches favor feature-matching strategy [28, 7] that conducts feature compari-son between the test sample and memory bank of normal features, where the feature searching causes high computa-tional complexity. Both lines of work require massive nor-mal samples either for model training or memory construc-tion, only to achieve detection for a single product category, and fail to quickly generalize across products.
In this paper, we state that well-generalized industrial
AD can be achieved in an extremely data-efficient way. We propose a training-free, few-shot AD method named Fas-tRecon, to meet the demand for industrial scenarios, which works under the situation that only a limited number of nor-mal samples are available. Given a query sample to detect, we propose to construct its normal version at the feature level through a linear transformation based on features ex-tracted from limited normal samples. This constructed sam-ple shares low-frequency features with the original query image but differs in the defect regions, making the anomaly apparent when directly compared to the original. The com-parisons on the methodology of our method and previous mainstream works are shown in Fig. 1. The key lies in finding the optimal transformation. On the one hand, the transformation should bring the constructed sample some-where close to the query sample so they share visual fea-tures on the normal parts. On the other hand, the con-structed sample should maintain the property of a normal sample so the difference between the two samples can fully reveal the anomaly regions. With this goal, we proposed a distributional regularization term upon the classical ridge regression algorithm. We first utilize normal features to fit a Gaussian distribution. When finding the transformation from normal features to the query sample, we simultane-ously push the reconstructed sample toward the center of the built distribution to enhance its normality. Note that our proposed optimization process admits a closed-form solu-tion just as ridge regression, which allows fast computation with low cost, ensuring the adaptation and migration of our method from old products to novel ones.
Experiments on the benchmark datasets for industrial de-fection, MVTec [3] and MDPP [15], as well as comparisons with various existing state-of-the-art FSAD methods [19, 13], indicate the effectiveness of our model. Compared with previous state-of-the-art [13], our method achieves improvements of 5.27%, 6.04%, 3.99% on MVTec, and 10.25%, 11.55%, 10.60% on MPDD, at image-level AU-ROC under 2-shot, 4-shot and 8-shot scenarios, respec-tively. The contributions of this work are summarized be-low: 1. We propose a few-shot and category-agnostic indus-trial AD strategy which adopts sample alignment be-tween the original test sample and its reconstructed normal version. 2. We propose a regression algorithm with distribution regularization which has a closed-form solution for the transformation estimation, keeping the reconstructed result close to the query image while maintaining the property of normal samples. 3. Our proposed method achieves state-of-the-art few-shot AD performance under various datasets and set-tings. 2.