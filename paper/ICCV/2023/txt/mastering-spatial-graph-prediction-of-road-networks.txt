Abstract
Accurately predicting road networks from satellite im-ages requires a global understanding of the network topol-ogy. We propose to capture such high-level information by introducing a graph-based framework that given a par-tially generated graph, sequentially adds new edges. To deal with misalignment between the model predictions and the intended purpose, and to optimize over complex, non-continuous metrics of interest, we adopt a reinforcement learning (RL) approach that nominates modifications that maximize a cumulative reward. As opposed to standard su-pervised techniques that tend to be more restricted to com-monly used surrogate losses, our framework yields more power and flexibility to encode problem-dependent knowl-edge. Empirical results on several benchmark datasets demonstrate enhanced performance and increased high-level reasoning about the graph topology when using a tree-based search. We further demonstrate the superiority of our approach in handling examples with substantial occlusion and additionally provide evidence that our predictions bet-ter match the statistical properties of the ground dataset. 1.

Introduction
Road layout modelling from satellite images constitutes an important task of remote sensing, with applications in 1Correspondence sotirios.anagnostidis@inf.ethz.ch. everyday life, such as traffic flow prediction and navigation.
The vast amounts of data available from the commercializa-tion of geospatial data, in addition to the need for accurately establishing the connectivity of roads in remote areas, have led to an increased interest in the precise representation of existing road networks. By nature, these applications re-quire structured data types that provide efficient represen-tations to encode geometry, in this case, graphs, a de facto choice in domains such as computer graphics, virtual real-ity, gaming, and the film industry. These structured-graph representations are also commonly used to label recent road network datasets [60] and map repositories [40]. When dealing with complex predicted structures, however, how well the model optimizes a surrogate objective is not always the best indication of how well the model’s predictions are aligned with the required task risk, i.e. the targeted final utilization.
Problems of this nature have been recently extensively studied in the regime of natural language processing, where the misalignment between training objectives for tasks such as machine translation and summarization has garnered considerable attention among the academic community, who have devoted significant efforts to its analysis and elu-cidation. A popular emerging technique is to first learn to imitate some example outputs and then fix any misalign-ment issues by using reinforcement learning to adjust the predictions based on a reward function. The reward usually comes in the form of external human evaluation [41, 4].
Figure 2. Typical road network features (SpaceNet dataset). From left to right: (a) the distribution of angles between road segments leading to the same intersection is biased towards 0 and 90 degrees, i.e. parallel or perpendicular roads. The same also holds (b) for angles between random road pieces within a ground distance of 400 meters. (c) Most road vertices belong to a single road piece, with a degree of 2. (d)
The average number of intersections for areas of 400×400 meters by ground distance.
In this work we manifest how RL fine-tuning can greatly benefit and boost performance when producing intricate ge-ometric predictions. For the task of road layout detection, existing methods, in contrast, mostly rely on pixel-based segmentation models that are trained on masks produced by rasterizing ground truth graphs. Performing pixel-wise seg-mentation, though, ignores structural features and geomet-ric constraints inherent to the problem. As a result, mini-mum differences in the pixel-level output domain can have significant consequences in the proposed graph, in terms of connectivity and path distances, as manifested by the of-ten fragmented outputs obtained after running inference on
In order to address these significant draw-these models. backs, we propose a new paradigm where we (i) directly generate outputs as spatial graphs and (ii) formalize the problem as a game where we sequentially construct the out-put by adding edges between key points. These key points can in principle come from any off-the-shelf detector that identifies road pieces with sufficient accuracy. Our gener-ation process avoids having to resort to cumbersome post-processing steps [8, 32] or optimize some surrogate objec-tives [30, 34] whose relation to the desired qualities of the final prediction can be disputed. Concurrently, the sequen-tial decision-making strategy we propose enables us to fo-cus interactively on different parts of the image, introducing the notion of a current state and producing reward estimates for a succession of actions. In essence, our method can be considered as a generalization of previous refinement tech-niques [8, 26] with three major advantages: (i) removal of the requirement for greedy decoding, (ii) ability to attend globally to the current prediction and selectively target parts of the image, and (iii) capacity to train based on demanding task-specific metrics.
More precisely, our contributions are the following:
• We propose a novel generic strategy for tuning autore-gressive models that removes the requirement of de-coding according to a pre-defined order and refines ini-tial sampling probabilities via a tree search.
• We create a synthetic benchmark dataset of pixel-level accurate labels of overhead satellite images for the task of road network extraction. This gives us the ability to simulate complex scenarios with occluded regions, allowing us to demonstrate improved robustness.
• We confirm the wide applicability of our approach by improving the performance of existing methods on the popular SpaceNet and DeepGlobe datasets. 2.