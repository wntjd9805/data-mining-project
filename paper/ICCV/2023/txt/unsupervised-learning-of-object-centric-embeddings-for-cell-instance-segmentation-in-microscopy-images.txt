Abstract
Segmentation of objects in microscopy images is re-quired for many biomedical applications. We intro-duce object-centric embeddings (OCEs), which embed im-age patches such that the spatial offsets between patches cropped from the same object are preserved. Those learnt embeddings can be used to delineate individual objects and thus obtain instance segmentations. Here, we show theoretically that, under assumptions commonly found in microscopy images, OCEs can be learnt through a self-supervised task that predicts the spatial offset between im-age patches. Together, this forms an unsupervised cell in-stance segmentation method which we evaluate on nine di-verse large-scale microscopy datasets. Segmentations ob-tained with our method lead to substantially improved re-sults, compared to state-of-the-art baselines on six out of nine datasets, and perform on par on the remaining three datasets.
If ground-truth annotations are available, our method serves as an excellent starting point for super-vised training, reducing the required amount of ground-thus substan-truth needed by one order of magnitude, tially increasing the practical applicability of our method.
Source code is available at github.com/funkelab/ cellulus. 1.

Introduction
Determining whether two image regions belong to the same object is a fundamental challenge in instance segmen-tation, albeit a simple task for humans. A plausible hypoth-esis is that humans learn to recognize parts as belonging to a whole by repeatedly observing them in each other’s vicin-ity. We introduce object-centric embeddings (OCEs), which leverage this assumption for unsupervised instance segmen-tation. OCEs map image patches in such a way that the spa-tial offsets between patches cropped from the same object are preserved in embedding space. We investigate the us-*Corresponding Author, kmcdole@mrc-lmb.cam.ac.uk.
†Corresponding Author, funkej@janelia.hhmi.org. age of OCEs in the domain of microscopy imaging and in-troduce CELLULUS, a method that identifies and segments individual cells in microscopy images.
By relying on reasonable assumptions about microscopy images, namely that (i) the objects in these images have a similar appearance and (ii) the objects in these images are randomly distributed, we show that OCEs can be learnt in an unsupervised fashion. life science questions.
Cell instance segmentation is crucial for answering im-In recent years, deep portant learning-based segmentation approaches [23, 12] have achieved the best performance on standard benchmarking datasets, but these approaches rely on large amounts of an-notated training data. Our proposed unsupervised method
CELLULUS, in contrast, circumvents the problem of acquir-ing these manual annotations.
With CELLULUS, we provide an approach for employ-ing the learnt object-centric embedding locations per patch, identifying image patches that are part of the same cell and thus segmenting cell instances in a unsupervised way (see
Figure 1 for a few examples). We demonstrate that this un-supervised segmentation pipeline achieves competitive re-sults with respect to pre-trained baseline models on a di-verse set of nine microscopy image datasets (see Table 1).
Additionally, instance segmentations obtained through our proposed unsupervised pipeline are excellent starting points to support supervised training when very little man-ually generated ground truth annotations are available. We show that we obtain comparable performance to supervised segmentation methods, after fine-tuning on one order of magnitude less data (see Figure 5).
More generally, supervised training supported by unsu-pervised segmentation is at least as good as purely super-vised learning on all investigated datasets, demonstrating that our method dramatically reduces the amount of ground truth annotations needed, and at times not requiring any.
Reducing or eliminating the need for manual ground truth is of particular importance to biological research, as new light-microscopy methods are capable of generating terabytes of data in a single experiment. Manually annotat-ing even small regions of such datasets can take hundreds
3 3 1 2 1 2
Raw Image
Object-Centric Embeddings of Patches
Dense Prediction of OCEs
Instance Segmentation
FLUOHELA
IMMUNE
HSC
HU7
Figure 1. Method overview and example segmentations on diverse datasets. Top row: An unsupervised learning objective gives rise to object-centric embeddings (OCEs), such that patches extracted from the same object (green boxes) maintain their relative position to each other. Predicted densely, these OCEs allow instance segmentation of cells in microscopy images, by using a post-processing step such as mean-shift clustering. Bottom row: Example raw images and dense OCEs/instance segmentations on four datasets spanning different imaging modalities, cell sizes and shapes. or thousands of human hours. Thus, there is a tremen-dous need for self-supervised learning methods to help cope with the vast amount of data generated by modern microscopes. CELLULUS is available at github.com/ funkelab/cellulus. 2.