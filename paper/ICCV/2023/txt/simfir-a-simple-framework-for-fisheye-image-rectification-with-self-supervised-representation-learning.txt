Abstract
In fisheye images, rich distinct distortion patterns are regularly distributed in the image plane. These distortion patterns are independent of the visual content and pro-vide informative cues for rectification. To make the best of such rectification cues, we introduce SimFIR, a simple framework for fisheye image rectification based on self-supervised representation learning. Technically, we first split a fisheye image into multiple patches and extract their representations with a Vision Transformer (ViT). To learn fine-grained distortion representations, we then associate different image patches with their specific distortion pat-terns based on the fisheye model, and further subtly design an innovative unified distortion-aware pretext task for their learning. The transfer performance on the downstream rec-tification task is remarkably boosted, which verifies the ef-fectiveness of the learned representations. Extensive exper-iments are conducted, and the quantitative and qualitative results demonstrate the superiority of our method over the state-of-the-art algorithms as well as its strong generaliza-tion ability on real-world fisheye images. 1.

Introduction
Fisheye lenses have been widely used in systems for video surveillance [41, 40, 22], autonomous driving [25, 23] and robotic applications [11, 12], thanks to their extremely wide field of view (FoV). However, images captured by the fisheye lenses are inevitably distorted, which are not di-rectly applicable for the downstream analysis, such as ob-ject detection [43, 24], pose estimation [62, 1, 45] and scene segmentation [33, 13, 5]. Over the past few years, fisheye image rectification has become an emerging research topic.
In the literature, some classical methods [4, 30, 27, 32, 44, 26, 17] estimate epipolar geometry with images
*Corresponding authors: Wengang Zhou and Houqiang Li
Figure 1: An illustration of fisheye distortions. The distor-tions in fisheye images are radially distributed and centrally symmetrical. The distortion degree increases with distance from the optical axis/image center. from different viewpoints. However, multiview images are not always accessible, which limits the real applica-tions of these methods. To overcome this limitation, other classical methods are based on the detection of plumb lines [53, 55, 7, 14, 61, 2]. Nevertheless, taking the de-tected plumb lines as the basis of fisheye image rectification inevitably causes error accumulation. Recently, deep learn-ing based solutions [46, 6, 60, 38, 36, 58, 37, 39, 57] have become a promising alternative to the traditional methods.
There are two directions among deep learning based meth-ods. One direction [46, 6, 60, 57] attempts to predict the dis-tortion parameters to infer pixel-wise displacement for rec-tification. The other direction [38, 58, 37, 39] directly pre-dicts the rectified images with specifically designed archi-tectures. Although these methods are reported with state-of-the-art results, the intrinsic distortion characteristics of fisheye images are largely ignored, described next.
Generally, as illustrated in Fig. 1, the distortions in fish-eye images are radially distributed and centrally symmetri-cal. The distortion degree increases with distance from the
image center along the radial axis. It should be noted that here we follow the existing state-of-the-art rectification al-gorithms [46, 6, 60, 38, 36, 58, 37, 39, 57] to only consider the ideal fisheye images, in which the distortion center lo-cate at the image center. Furthermore, when dividing a fish-eye image into patches, the distortion patterns and degrees vary among patches at different distances from the image center. To improve fisheye image rectification, it is ben-eficial to model these fine-grained distortion patterns that provide cues for the rectification.
Formally, we present SimFIR, a new framework for fish-eye image rectification based on self-supervised represen-tation learning [59]. SimFIR introduces an effective way for encoding the fine-grained distortion patterns in fisheye images, by learning the associations between the local im-age region and their distinct distortion pattern. Specifically, we first split a fisheye image into multiple patches and label them with a position map (see Fig. 1) based on their specific distortion degrees. Then, these image patches are embedded as input tokens of Vision Transformer (ViT) [15] to abstract patch representations. Given these patch representations, we introduce a unified distortion-aware pretext task to opti-mize the network. On the one hand, we perform contrastive learning with InfoNCE loss [42] to narrow the representa-tion of patches with the same distortion pattern while en-larging the feature distance with others. On the other hand, we devise a classification supervision to predict the patch-wise quantified distortion degree, aiming to differentiate the distinct local distortion patterns. After pre-training, the net-work is capable of extracting the fine-grained distortion rep-resentations, regardless of the image textures. Thereafter, the learned distortion representations are transferred to the downstream rectification task.
Besides, we introduce a new pipeline for fisheye im-age rectification, which unwarps fisheye images with a dense flow field, i.e., the warping flow, aiming to pro-cess images of arbitrary resolution without complex post-processing [36]. Then, to facilitate training, we construct a well-annotated synthesized dataset that covers various scenes and distortion levels. To validate the learned rep-resentations, we conduct extensive experiments by pre-training the network with our self-supervised paradigm and then transferring it to the downstream rectification task. The results demonstrate the effectiveness of our method as well as its superiority over existing state-of-the-art algorithms.
In addition, we show the strong generalization ability of our method on processing real-world fisheye images.
In summary, we make three-fold contributions:
• We present SimFIR, a novel self-supervised based framework, to improve fisheye image rectification by extracting its fine-grained distortion patterns.
• We introduce a new pipeline for fisheye image recti-fication that unwarps images with backward warping flow, aiming to process images with any resolutions.
• We conduct extensive experiments to verify the merits of our method and report the state-of-the-art perfor-mance with our proposed method. 2.