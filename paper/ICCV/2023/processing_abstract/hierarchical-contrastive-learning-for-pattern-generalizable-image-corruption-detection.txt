Effective image restoration with large-size corruptions, such as blind image inpainting, entails precise detection of corruption region masks which remains extremely challeng-ing due to diverse shapes and patterns of corruptions. In this work, we present a novel method for automatic corrup-tion detection, which allows for blind corruption restoration without known corruption masks. Specifically, we develop a hierarchical contrastive learning framework to detect cor-rupted regions by capturing the intrinsic semantic distinc-tions between corrupted and uncorrupted regions. In par-ticular, our model detects the corrupted mask in a coarse-to-fine manner by first predicting a coarse mask by con-trastive learning in low-resolution feature space and then refines the uncertain area of the mask by high-resolution contrastive learning. A specialized hierarchical interaction mechanism is designed to facilitate the knowledge prop-agation of contrastive learning in different scales, boost-ing the modeling performance substantially. The detected multi-scale corruption masks are then leveraged to guide the corruption restoration. Detecting corrupted regions*These authors contributed equally to this work.â€ Corresponding authors. by learning the contrastive distinctions rather than the se-mantic patterns of corruptions, our model has well gener-alization ability across different corruption patterns. Ex-tensive experiments demonstrate following merits of our model: 1) the superior performance over other methods on both corruption detection and various image restora-tion tasks including blind inpainting and watermark re-moval, and 2) strong generalization across different cor-ruption patterns such as graffiti, random noise or other im-age content. Codes and trained weights are available at https://github.com/xyfJASON/HCL. 