Semi-Supervised Learning (SSL) under class distribu-tion mismatch aims to tackle a challenging problem wherein unlabeled data contain lots of unknown categories unseen in the labeled ones.In such mismatch scenarios, tradi-tional SSL suffers severe performance damage due to the harmful invasion of the instances with unknown categories into the target classifier. In this study, by strict mathemat-ical reasoning, we reveal that the SSL error under class distribution mismatch is composed of pseudo-labeling er-ror and invasion error, both of which jointly bound theSSL population risk. To alleviate the SSL error, we pro-pose a robust SSL framework called Weight-Aware Distil-lation (WAD) that, by weights, selectively transfers knowl-edge beneficial to the target task from unsupervised con-trastive representation to the target classifier. Specifically,WAD captures adaptive weights and high-quality pseudo-labels to target instances by exploring point mutual infor-mation (PMI) in representation space to maximize the role of unlabeled data and filter unknown categories. Theo-retically, we prove that WAD has a tight upper bound of population risk under class distribution mismatch. Exper-imentally, extensive results demonstrate that WAD outper-forms five state-of-the-art SSL approaches and one stan-dard baseline on two benchmark datasets, CIFAR10 andCIFAR100, and an artificial cross-dataset. The code is available at https://github.com/RUC-DWBI-ML/ research/tree/main/WAD-master. 