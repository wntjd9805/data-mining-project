Anomaly Detection (AD) is a crucial task in machine learning that aims to identify rare and unusual patterns in data. It is important in various domains such as finance, cybersecurity, industrial inspection, and medical diagnosis. However, current AD studies focus on unsupervised approaches due to the difficulty and high cost of collecting labeled anomaly data. While existing AD methods have shown promising performance, they assume that the training and test data are drawn from the same distribution, which is often unrealistic in real-world scenarios. Distribution shift, where the test data has significant variations from the training data, is a common problem that can degrade the performance of AD models. Although several out-of-distribution (OOD) generalization methods have been introduced to address this problem in other tasks, they are not directly applicable to the AD task due to the difference in data characteristics. In this paper, we specifically tackle the problem of anomaly detection under distribution shift. We present an extensive study of the distribution shift problem in AD and establish large performance benchmarks using widely-used datasets. Our results show that existing state-of-the-art AD and OOD generalization methods fail to effectively identify anomalies under distribution shift. To address this, we propose a novel approach called generalized normality learning (GNL) that minimizes the distribution gap between in-distribution (ID) and OOD normal samples. GNL learns distribution-invariant normality representations and utilizes a test time augmentation method to further reduce the distribution gap during inference. We conduct extensive experiments that demonstrate the superiority of GNL over existing methods, achieving over 10% improvement in AU-CROC on data with various distribution shifts while maintaining detection accuracy on ID test data. Overall, our work contributes to the understanding and improvement of AD under distribution shift, providing a valuable solution for real-world applications.