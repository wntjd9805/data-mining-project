Abstract
Supervised learning is dominant in person search, but it requires elaborate labeling of bounding boxes and iden-tities. Large-scale labeled training data is often difﬁcult to collect, especially for person identities. A natural ques-tion is whether a good person search model can be trained without the need of identity supervision.
In this paper, we present a weakly supervised setting where only bound-ing box annotations are available. Based on this new set-ting, we provide an effective baseline model termed Region
Siamese Networks (R-SiamNets). Towards learning use-ful representations for recognition in the absence of iden-tity labels, we supervise the R-SiamNet with instance-level consistency loss and cluster-level contrastive loss. For instance-level consistency learning, the R-SiamNet is con-strained to extract consistent features from each person re-gion with or without out-of-region context. For cluster-level contrastive learning, we enforce the aggregation of clos-est instances and the separation of dissimilar ones in fea-ture space. Extensive experiments validate the utility of our weakly supervised method. Our model achieves the rank-1 of 87.1% and mAP of 86.0% on CUHK-SYSU benchmark, which surpasses several fully supervised methods, such as
OIM [36] and MGTS [4], by a clear margin. More promis-ing performance can be reached by incorporating extra training data. We hope this work could encourage the fu-ture research in this ﬁeld. 1.

Introduction
Person search [36] aims to localize and recognize a query person from a gallery of unconstrained scene im-ages. Despite tremendous progress achieved by recent works [36, 35, 26, 37, 11, 10, 5, 44], the training process
*This work was done when Chuchu Han was an intern at ByteDance.
†Corresponding author
ID1
ID2
ID3
ID4
ID5
ID6 unlabeled (a) Fully supervised setting unlabeled (b) Proposed weakly supervised setting
Figure 1. Comparisons between two settings. (a) Fully supervised setting. The images are annotated with both bounding boxes and person identities. Note that some identity annotations have lacked in original person search datasets. (b) The proposed weakly super-vised setting. The images only have bounding box annotations. requires strong supervision in terms of bounding boxes and identity labels, shown in Fig. 1(a). However, obtaining such annotations at a large scale can be time-consuming and eco-nomically expensive. Even in the most widely used dataset,
CUHK-SYSU [36], almost 72.7% of pedestrian bounding boxes have no identity annotations. It indicates that label-ing identities is more difﬁcult than bounding boxes. The infeasible identity annotations largely restrict the scalabil-ity of supervised methods.
Instead of relying on the expensive labeling, a lot of re-searchers have been dedicated to training models with no labels [17, 7] or incomplete labels [27, 45] in the areas of image recognition, object detection, etc. Nevertheless, rel-evant explorations are missing in the ﬁeld of person search.
To ﬁll the gap, we investigate the person search modeling in
a weakly supervised setting, where only bounding box an-notations are required. As shown in Fig. 1(b), the proposed setting alleviates the burden of obtaining manually labeled identities. However, it is more challenging to pursue accu-rate person search using sole bounding box annotations.
In this paper, we setup a strong weakly supervised base-line called Region Siamese Networks (R-SiamNets). To-wards learning meaningful feature representations of each instance, our model minimizes the discrepancy between two encoded features transformed from the same pedestrian re-gion. Speciﬁcally, one branch is fed with the whole scene image and extracts the RoI features of the person instance.
The other branch extracts features from the cropped person image. The obtained features from the two weight-sharing branches are constrained to be consistent. The motivation of this design is that the context-free instance features ex-tracted from the cropped image regions could help the net-work to distinguish persons from the irrelevant background content. We formulate a self-instance consistency loss and an inter-instance similarity consistency loss to supervise the learning of context-invariant feature representations.
Further, a cluster-level contrastive learning method is in-troduced for striking a balance between separation and clus-tering. The clustering method aggregates the closest in-stances together and pushes instances from different clus-ters apart. It is assumed that the closest features have a high probability of being from the same individual. The gen-erated pseudo labels by clustering are used for contrastive learning. We iteratively apply this non-parametric cluster-ing for reﬁnement along with the training process. The cluster-level contrastive learning yields a signiﬁcant perfor-mance gain, with the 6.1% absolute improvement of mAP on the CUHK-SYSU dataset.
Our contributions can be summarized in three-folds:
• We introduce a weakly-supervised setting for person search. The new setting only requires bounding box annotations, relieving the burden of obtaining manu-ally labeled identities. With this setting, the developed algorithms could be readily utilized for large-scale per-son search in real-world scenarios.
• We propose the R-SiamNet as a baseline under the weakly supervised setting. With the Siamese net-work, instance-level consistency learning is applied to encourage context-invariant representations. Fur-ther, cluster-level contrastive learning is introduced for striking a balance between separation and clustering.
• Our R-SiamNet achieves the rank-1 of 87.1% and 75.2% on CUHK-SYSU and PRW datasets, respec-tively.
The results outperform several supervised methods by a clear margin, e.g., OIM [36] and
MGTS [4]. More promisingly, the performance is fur-ther promoted when incorporating more extra datasets. 2.