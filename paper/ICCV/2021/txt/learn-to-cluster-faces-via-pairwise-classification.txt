Abstract
Face clustering plays an essential role in exploiting mas-sive unlabeled face data. Recently, graph-based face clus-tering methods are getting popular for their satisfying per-formances. However, they usually suffer from excessive memory consumption especially on large-scale graphs, and rely on empirical thresholds to determine the connectivities between samples in inference, which restricts their appli-cations in various real-world scenes. To address such prob-lems, in this paper, we explore face clustering from the pair-wise angle. Specifically, we formulate the face clustering task as a pairwise relationship classification task, avoiding the memory-consuming learning on large-scale graphs. The classifier can directly determine the relationship between samples and is enhanced by taking advantage of the con-textual information. Moreover, to further facilitate the effi-ciency of our method, we propose a rank-weighted density to guide the selection of pairs sent to the classifier. Experi-mental results demonstrate that our method achieves state-of-the-art performances on several public clustering bench-marks at the fastest speed and shows a great advantage in comparison with graph-based clustering methods on mem-ory consumption.
Figure 1. An overview of the main differences between popular graph-based face clustering methods and ours. The nodes with dif-ferent colors represent different classes. (a) Graph-based methods focus on the learning of discriminative embeddings but need to set an empirical threshold to connect or disconnect samples. (b) Our method can directly determine the pairwise relationship through a classifier and generate the final clusters. Besides, by dealing with the face clustering task from graph-level to pair-level, our method largely reduces the memory consumption. 1.

Introduction
Massive face data are accessible on the Internet nowa-days, thus boosting the development of face analysis tech-nology [1, 13]. However, the large-scale unlabeled face data has resulted in quite high annotation prices, and human an-notations are not always reliable. Therefore, exploiting un-labeled face data has attracted great interest. Aiming at as-signing pseudo labels to unlabeled face images, face cluster-ing is a fundamental face analysis task and has wide appli-cations in real-world scenarios like the dataset preparation or cleaning for face recognition [22, 23] and photo albums management [19].
Traditional clustering methods suffer from impractical assumptions and their performances could be sensitive to
*Co-first authors.
â€ Corresponding author. yanpengfei03@meituan.com liujeff97@gmail.com, qiudi@meituan.com hyper-parameters. For instance, DBSCAN [2] assumes clusters to be in the same density, and the performance of
K-Means [3] highly depends on the original k. Recently, graph-based face clustering methods have drawn much at-tention for their satisfying performances by learning rep-resentative embeddings without making oversimplified as-sumptions [4, 5, 6]. But the computational costs and de-mands for memory usage stand out especially on large-scale face clustering scenes, due to the surprisingly high price of learning on large graphs [20, 26]. And some works have been proposed to alleviate such problems. In [7], Yang et al. designed a graph convolutional network-based confidence estimator to select nodes with large confidence, which re-duces the number of highly overlapped subgraphs and leads to promotions on efficiency. Although the confidence esti-mator contains only one single layer, an out-of-memory is-sue still occurs when dealing with large-scale graphs, as will
be revealed in Section 4. Guo et al. [8] exploited cluster-level feature distribution by defining a density-aware graph, which reduces memory consumption by avoiding learning on the whole graph, but this method can still fall on large-scale face clustering scenes when limited memory capacity is available. More importantly, like previous graph-based clustering methods, to generate the final clusters in the in-ference stage, it still requires a manual-setting threshold to determine the connectivities between samples. The fi-nal performance of these clustering methods is so sensitive to the empirical threshold that can drop heavily when the threshold is set improperly, which restricts the generaliza-tion of various real-world scenes.
To address the problems above, in this work, we focus on the fundamental concerns of face clustering tasks, i.e., the homogeneity of samples. Specifically, we explore a memory-friendly and threshold-free face clustering method from the pairwise angle, leading to promotions in both ef-ficiency and accuracy.
Instead of learning on the graph-level or cluster-level, we handle face clustering on the min-imum level, i.e., the pair-level, which largely reduces mem-ory consumption. We adopt a simple yet effective classifier network and the classifier directly gives the connection re-lationship of a pair of samples, which also frees us from the manual setting of thresholds. Besides, inspired by the graph learning-based methods where contextual informa-tion is emphasized, the classifier is trained on our designed weighted-neighbor features, which brings considerable per-formance gains to both the classifier and the overall clus-tering task. As Figure 1 illustrates, popular graph-based methods rely on an empirical threshold to determine the connectivities between samples after learning distinguish-able feature embeddings with high consumption on mem-ory. Contrastively, our method can directly give the pair-wise relationships and generate the final clusters efficiently with very limited memory usage.
Moreover, to enhance the efficiency of the whole pipeline, we propose a rank-weighted density. The rank-weighted density gives more attention to nearby neighbors, which eases the influences of outliers in the procedure of finding neighbors with higher density. The introduction of this more precise rank-weighted density not only reduces the time complexity via selecting fewer pairs sent to the classifier by an order of magnitude, but also makes a fur-ther contribution to the performance of our method.
Our main contributions are summarized as follows: (1)
Different from popular graph-based methods, we propose a face clustering method based on pairwise classification, which is much more memory-friendly and also threshold-free. (2) A rank-weighted density is proposed to instruct the pair selection sent to the classifier, resulting in further promotions in both efficiency and accuracy. (3) Our method improves the performance on public face clustering bench-marks, achieving Pairwise F-score at 90.67 and BCubed F-score at 89.54 on the MS-Celeb-1M dataset, surpassing pre-vious public state-of-the-art methods at 90.60 [8] and 86.09
[7] respectively.
The following Section 2 will give a brief review of the related work. Section 3 details our proposed method. Ex-perimental results and analysis are presented in Section 4 and we finally conclude the paper in Section 5. 2.