Abstract
Protein structure determination from cryo-EM data re-quires reconstructing a 3D volume (or distribution of vol-umes) from many noisy and randomly oriented 2D projec-tion images. While the standard homogeneous reconstruc-tion task aims to recover a single static structure, recently-proposed neural and non-neural methods can reconstruct distributions of structures, thereby enabling the study of protein complexes that possess intrinsic structural or confor-mational heterogeneity. These heterogeneous reconstruction methods, however, require ﬁxed image poses, which are typically estimated from an upstream homogeneous recon-struction and are not guaranteed to be accurate under highly heterogeneous conditions.
In this work we describe cryoDRGN2, an ab initio recon-struction algorithm, which can jointly estimate image poses and learn a neural model of a distribution of 3D structures on real heterogeneous cryo-EM data. To achieve this, we adapt search algorithms from the traditional cryo-EM literature, and describe the optimizations and design choices required to make such a search procedure computationally tractable in the neural model setting. We show that cryoDRGN2 is robust to the high noise levels of real cryo-EM images, trains faster than earlier neural methods, and achieves state-of-the-art performance on real cryo-EM datasets. 1.

Introduction
The last decade has seen explosive growth in the de-velopment and application of single particle cryo-electron microscopy (cryo-EM) for 3D structure determination of proteins and other biomolecules. Driven by parallel de-velopments in improved hardware and image processing algorithms, many challenging structures not amenable to crystallographic approaches have now been solved at atomic or near-atomic resolution with cryo-EM [20, 30, 37]. 3D electron scattering potential (i.e. volume) from an experimentally-derived dataset of microscopy images. In a cryo-EM experiment, a puriﬁed solution of the molecule of interest is frozen in a thin layer of vitreous ice and imaged at cryogenic temperatures using a transmission electron micro-scope. After initial pre-processing of the raw micrographs, the resulting imaging dataset contains thousands to millions of noisy and randomly oriented 2D projection images (Fig. 1a). The goal of the cryo-EM reconstruction task is to in-fer the underlying 3D structure or structures present in the recorded images.
The 3D reconstruction task is a challenging inverse prob-lem primarily due to the unknown image poses and the high amount of noise in the images. It is further complicated by the potential for each molecule to adopt variable conforma-tions. A major opportunity thus exists to use cryo-EM to visualize and study complex distributions of dynamic protein structures, and numerous algorithms have been proposed to extract multiple structures from the imaging dataset, termed heterogeneous reconstruction [44].
Recent neural methods have shown promise in instantiat-ing expressive continuous latent variable models for struc-tural variability in cryo-EM data. In particular, cryoDRGN performs heterogeneous reconstruction by learning a deep generative model for 3D cryo-EM volumes. The ﬁrst instan-tiation of cryoDRGN performed joint optimization of pose and heterogeneity with a branch and bound (BNB) algorithm for pose search (referred to as cryoDRGN-BNB here) [55]; however, this version scaled poorly and could not produce high-quality reconstructions of real cryo-EM datasets. In follow-up work, high-quality reconstructions on real data were achieved by modifying cryoDRGN to take previously estimated poses from a homogeneous reconstruction as input, hence eliding the difﬁcult pose search procedure [54]. By estimating the intrinsic structural heterogeneity separately from the extrinsic pose variables, these methods are limited to mildly heterogeneous conditions where pose inference remains accurate.
Central to structure determination with cryo-EM is the computational reconstruction of the target molecule’s
In this work, we revisit the problem of joint optimization of image pose and volumes in cryoDRGN. In particular, we
Figure 1: Overview of the cryoDRGN2 approach for ab initio reconstruction. (a) Example cryo-EM images of the RAG1-RAG2 complex
[EMPIAR-10049]. (b) A multi-resolution 5-D pose search procedure doubles the resolution of the search grid at each iteration. (c)
Coordinate-based MLP representation for volume (d) Volumes during ab initio training on the RAG dataset (e) A hypothetical training schedule interleaves pose search (expensive) and volume update (cheap) epochs. The model may also be reset after initial iterations to avoid vanishing gradients in training the neural volume. consider 5-D camera pose optimization in the context of a feed-forward MLP representation of volume, and propose search techniques to address the high render time of MLPs relative to voxel-based representations. We further identify a pathological case of vanishing gradients during training that we hypothesize originates from distributional shifts of the objective function during joint optimization. With these techniques, we improve upon both the speed and accuracy of cryoDRGN-BNB and demonstrate for the ﬁrst time that neural models can achieve state-of-the-art accuracy for fully unsupervised ab initio reconstruction on both homogeneous and heterogeneous real cryo-EM datasets. 2.