Abstract
Instance segmentation methods require large datasets with expensive and thus limited instance-level mask labels.
Partially supervised instance segmentation aims to improve mask prediction with limited mask labels by utilizing the
In this work, we show more abundant weak box labels. that a class agnostic mask head, commonly used in partially supervised instance segmentation, has difficulties learning a general concept of foreground for the weakly annotated classes using box supervision only. To resolve this problem, we introduce an object mask prior (OMP) that provides the mask head with the general concept of foreground implicitly learned by the box classification head under the supervision of all classes. This helps the class agnostic mask head to fo-cus on the primary object in a region of interest (RoI) and improves generalization to the weakly annotated classes.
We test our approach on the COCO dataset using different splits of strongly and weakly supervised classes. Our ap-proach significantly improves over the Mask R-CNN base-line and obtains competitive performance with the state-of-the-art, while offering a much simpler architecture. 1 1.

Introduction
Instance segmentation is an essential task in computer vision with applications ranging from autonomous vehi-cles to robotics and medical imaging [5, 6, 13, 22, 26, 30].
A major contributor to the success of recent instance seg-mentation methods is the availability of large-scale datasets with numerous instance-level mask labels [7, 8, 12, 24, 36].
A major problem with mask labels is that their acquisi-tion is rather time-consuming at ∼ 67 seconds per instance
[4]. Conversely, weak labels (w.r.t. instance masks) such as bounding boxes (∼ 10.5 seconds) allow for much more
*This paper is the product of work during an internship at TomTom. 1Code is available at: https://github.com/dbtmpl/OPMask
Figure 1. Our object mask prior (OMP) provides foreground cues to the mask head highlighting the primary instance in ambiguous
RoIs (yellow pixels indicate foreground). OPMask is able to re-solve ambiguous constellations and segment the correct instance, while our Mask R-CNN baseline fails to do so. efficient annotation [4]. Nonetheless, for classes without sufficient mask labels, conventional instance segmentation methods perform poorly and tend to generate mask predic-tions that are perforated, do not cover the entire object or are completely missing it [16, 20]. To improve mask pre-dictions for classes with no mask labels available, recent re-search has focused on addressing the problem in a partially supervised learning setting [9, 16, 20, 40], where all classes are annotated with box labels while only a subset of these classes also carry instance mask labels. The goal in partially supervised instance segmentation is to use the abundant but weak box labels in conjunction with the strong but limited mask labels to predict better instance masks for the weakly (box) annotated classes.
In current methods, the task of generalizing mask predic-tions for weak classes is either achieved with meta-learning
of class aware weights [16] or with a class agnostic mask head [9, 20, 40]. In the latter case, instead of predicting a mask per class, each pixel in the RoI is classified into either foreground or background. Thus, the class agnostic mask head faces the challenge of having to learn a general con-cept of foreground in order to generalize to unseen object classes. However, this often fails, even if abundant box la-bels are provided for the weak classes.
In this paper, we identify that the problem originates, on the one hand, from the ambiguous constellations between object instances, where pixels of one instance appear in the bounding box of the other. Thus, the actual foreground be-comes ambiguous to the mask head when the RoI contains multiple and possibly overlapping instances. See Figure 1 for examples. On the other hand, instances of weak classes that appear in the background of a RoI during training are actively learned as background. This hurts generalization to weak classes that frequently interact with other super-vised classes. To address these problems, we introduce an object mask prior (OMP) that highlights the correct fore-ground in each RoI. This helps the mask head to resolve ambiguous constellations, learn a more general concept of the foreground, and generalize it to weak classes.
Recent works have demonstrated that shape priors are beneficial inductive biases that steer models towards more stable mask predictions. For example, ShapeMask [20] cre-ates a knowledge base of shape priors by applying k-means to the ground-truth masks, whereas ShapeProp [40] cre-ates priors by using pixel-wise multiple instance learning on bounding boxes. Although these priors help to generalize to weak classes, they do not explicitly address the problems mentioned above.
Conversely, our prior is explicitly optimized to highlight the foreground in a RoI using the box supervision from all classes. This is achieved by exploiting the fact that the box classification head naturally learns to identify the primary class in a RoI. As the box head receives labels for all classes in the partially supervised setting, the box features capture a general concept of foreground. To reveal this foreground, we use class activation maps (CAMs) [39], which are coarse localization maps indicating the most discriminative image regions detected by the model. Therefore, given a correct classification, CAMs are expected to highlight foreground areas corresponding to the primary RoI class.
Unlike previous methods that introduce separate mod-ules for prior creation, we only rely on the features in the box head and embed the OMP into our model in an end-to-end manner. Besides using box supervision from all classes, our prior is able to use mask gradients from the limited mask labels to increase its spatial extent. We embed our OMP in the Mask R-CNN meta architecture and name our over-all model OPMask (Object Prior Mask R-CNN). Our main contributions are the following:
• We identify two fundamental problems in partially supervised instance segmentation: First, instances of weak classes appearing in the background of a mask supervised RoI during training are learned as back-ground by the model. Second, in ambiguous RoIs con-taining multiple and possibly overlapping instances, the mask head has difficulties finding the foreground.
• We introduce an object mask prior (OMP) in the mask head to solve the above identified problems. The prior highlights the foreground across all classes by leverag-ing the information from the box head.
• On the COCO dataset [24], OPMask significantly im-proves over our Mask R-CNN baseline by 13.0 AP.
Compared with the prior state-of-the-art, we improve over ShapeMask [20] and ShapeProp [40] and achieve competitive results against CPMask [9] while using a simpler architecture. 2.