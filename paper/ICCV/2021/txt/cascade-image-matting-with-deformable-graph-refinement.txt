Abstract
Image matting refers to the estimation of the opacity of foreground objects.
It requires correct contours and fine details of foreground objects for the matting results. To bet-ter accomplish human image matting tasks, we propose the
Cascade Image Matting Network with Deformable Graph
Refinement(CasDGR), which can automatically predict pre-cise alpha mattes from single human images without any additional inputs. We adopt a network cascade architecture to perform matting from low-to-high resolution, which cor-responds to coarse-to-fine optimization. We also introduce the Deformable Graph Refinement (DGR) module based on graph neural networks (GNNs) to overcome the limitations of convolutional neural networks (CNNs). The DGR mod-ule can effectively capture long-range relations and obtain more global and local information to help produce finer al-pha mattes. We also reduce the computation complexity of the DGR module by dynamically predicting the neigh-bors and apply DGR module to higher–resolution features.
Experimental results demonstrate the ability of our Cas-DGR to achieve state-of-the-art performance on synthetic datasets and produce good results on real human images. 1.

Introduction
Image matting refers to the problem of extracting high– quality alpha mattes (the opacity of foreground object at each pixel) from a set of given images. As a practical image processing technology, matting has a variety of applications for image and video editing. Generally, the composition of image I is expressed as a linear equation as follows:
Ii = αiFi + (1 − αi)Bi, αi ∈ [0, 1], (1) where Ii is the RGB color at pixel i, αi is the matte value at pixel i and Fi and Bi are the RGB colors of the fore-ground and background at pixel i. Matting is a highly ill-posed problem, i.e., there are seven unknown values and
*Joint first authors.
†The corresponding author is Li Chen. only three known values at each pixel, which increases the difficulty of solving matting problems. Although existing works have provided effective ways to perform matting, they still present limitations.
The first limitation is that most existing works [47, 1, 19, 12, 52] have predicted alpha mattes by using a one-pass encoder–decoder network, which may result in inac-curate contours and artifacts when foreground and back-ground have similar local features. This is mainly due to that those methods predict alpha mattes from single–scale features and cannot make full use of the global and local information contained in the image.
The second limitation is that existing CNN-based mat-ting methods cannot well handle certain slender objects (e.g., human hair). In addition to the basic use of CNN in the network architecture, some matting works have tried to refine the details of alpha mattes after the backbone network with CNN-based module. Xu et al. [47] used a lightweight fully convolutional neural network (CNN) to generate sharp boundaries for alpha mattes. Cai et al. [1] proposed a prop-agation unit that could refine alpha mattes with accurate de-tails and less artifacts. However, these CNN-based refine-ment methods are restricted by the fixed shape of convolu-tional kernels and a limited receptive field, leading to per-formance degradation when manipulating slender objects.
To overcome the first limitation, we simulate the matting logic of human. While meeting the matting tasks, people generally first determine the overall contour of the fore-ground object and then iteratively improve the details in boundary areas under the guidance of the contour. There-fore, we design a network cascade architecture for image matting to generate more accurate contours and details of foreground objects. Our method predicts coarse alpha mat-tes from low–resolution images as contours and then pro-gressively supplements the details from high–resolution im-ages under the guidance of the contours. Through this low-to-high, coarse-to-fine pipeline, our network can supple-ment local information with global information and esti-mate extremely finer alpha mattes with correct contours and precise details.
To overcome the limitations of CNN and produce bet-ter performance on slender objects, we apply a graph neu-ral network(GNN) to extract features with higher quality.
Compared with CNN, GNN has shown its ability to better capture long-range dependencies from data. Some existing works [33, 21, 51] used GNN to improve the performance of detection and segmentation. However, these GNN-based methods are limited by high computation complexity and time consumption, as GNN requires large number of nodes and thus can only be applied to low–resolution feature maps or superpoints set obtained by clustering.
Inspired by deformable convolutional networks [10] that can dynamically adjust kernel shapes according to objects, we propose the Deformable Graph Refinement (DGR) mod-ule to reduce the computation cost of graph construction and propagation. The DGR module uses the convolutional net-work to predict the coordinates of neighbors and performs information aggregation and transmission among pixels.
We combine two solutions above and propose a method called the Cascade Image Matting Network with De-formable Graph Refinement (CasDGR). First, the network cascade architecture is designed to enhance the simulation of the coarse-to-fine matting logic. Second, the DGR mod-ule is adopted to improve the obtaining of more appropriate features and the handling of slender objects.
The main contributions of this study are as follows:
• We propose an end-to-end automatic image matting approach to produce high-quality alpha mattes from single RGB images.
• We design a network cascade architecture to estimate alpha mattes in a coarse-to-fine manner.
• We present a Deformable Graph Refinement module based on GNN that can preserve more details of the matting results and be applied on higher–resolution features.
Some existing work [47, 31, 26] require trimaps as ad-ditional inputs. However, the construction of high–quality trimaps is complicated. Automatic matting methods [52, 38, 34, 30] whose inputs do not contain trimaps are more challenging, but more convenient and feasible for some applications, such as matting for human only. Our Cas-DGR is also automatic and can achieve good matting per-formance with single RGB images. Similar to [38], we test our method on Adobe human image dataset [47]. The ex-perimental results demonstrate that our method can achieve state-of-the-art performance and produce excellent visual results. What’s more, our automatic matting approach out-performs existing trimap-based methods both quantitatively and qualitatively. We also test the CasDGR on natural hu-man images. Our method shows good performance on real-world human images as well. 2.