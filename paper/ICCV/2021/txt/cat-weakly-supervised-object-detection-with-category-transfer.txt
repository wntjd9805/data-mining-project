Abstract
A large gap exists between fully-supervised object de-tection and weakly-supervised object detection. To nar-row this gap, some methods consider knowledge transfer from additional fully-supervised dataset. But these meth-ods do not fully exploit discriminative category informa-tion in the fully-supervised dataset, thus causing low mAP.
To solve this issue, we propose a novel category transfer framework for weakly supervised object detection. The in-tuition is to fully leverage both visually-discriminative and semantically-correlated category information in the fully-supervised dataset to enhance the object-classification abil-ity of a weakly-supervised detector. To handle overlap-ping category transfer, we propose a double-supervision mean teacher to gather common category information and bridge the domain gap between two datasets. To handle non-overlapping category transfer, we propose a semantic graph convolutional network to promote the aggregation of semantic features between correlated categories. Exper-iments are conducted with Pascal VOC 2007 as the tar-get weakly-supervised dataset and COCO as the source fully-supervised dataset. Our category transfer framework achieves 63.5% mAP and 80.3% CorLoc with 5 overlapping categories between two datasets, which outperforms the state-of-the-art methods. Codes are avaliable at https:
//github.com/MediaBrain-SJTU/CaT . 1.

Introduction
Object detection is one of the most fundamental tasks in
In the past decade, based on deep computer vision [44]. neural networks, many methods [16, 26, 27] have achieved great success. However, most methods follow the fully su-pervised setting, which requires a huge number of high-quality annotations, including the precise bounding boxes of objects and their corresponding category labels. This set-*Xiaoyun Zhang is the corresponding author.
This work was supported in part by Chinese National Key R&D Pro-gram (2019YFB1804304), National Natural Science Foundation of China (61771306),State Key Laboratory of UHD Video and Audio Production and Presentation, Shanghai Key Laboratory of Digital Media Processing and Transmissions(STCSM 18DZ2270700) and 111 plan(BP0719010).
Figure 1. The sketch map of our category transfer framework. We use the double-supervised mean teacher network to transfer over-lapping category and objectness knowledge; and use the semantic graph convolutional network to transfer non-overlapping category knowledge. The final prediction is generated by the teacher. ting usually costs extensive amount of time and resources to acquire such annotations. To reduce the annotation cost, weakly supervised object detection (WSOD) are pro-posed [2, 32, 33] to train detection models with only image-level category labels. However, the lack of bounding-box-level supervision leads to significant issues, such as instance ambiguity and low-quality proposals. Therefore, a large performance gap still exists between fully-supervised object detection (89.1% mAP, SOTA [10]) and weakly-supervised object detection (56.8% mAP, SOTA [13]).
To narrow this gap, some previous methods consider knowledge transfer from additional data. There are two main approaches: the objectness transfer approach and the semi-supervised approach. For example, [18, 29, 43] train a generic object detector on source data and apply it to tar-get data; however, this objectness transfer methods ignores the category information in the source dataset, causing the decline of classification.
[11, 37, 35, 15] follow the semi-supervised setting with partial fully annotated data, and transform an image classifier to an object detector. Such a semi-supervised method leverages both box and category information, but it usually can not solve the domain gap between datasets, especially the category inconsistency be-tween the source and target datasets. Moreover, the corre-lations between categories have not been exploited. There-fore, the lack of exploiting category information still limit the empirical performance of the target dataset. is, that
To solve those issues, this work specifically consid-ers category transfer; leverage both visually-discriminative and semantically-correlated category infor-mation in the fully-supervised dataset to enhance the dis-criminative ability of a weakly-supervised detector. Based on whether the categories are shared in both the fully-supervised and the weakly-supervised datasets, the category transfer includes overlapping category transfer, where the fully-supervised and the weakly-supervised datasets share the same categories, and non-overlapping category transfer, where two datasets have different, yet correlated categories.
To realize overlapping category transfer, we propose a double-supervision mean teacher network. The double-supervision mean teacher network adopts the similar struc-ture of mean teacher method [36], but works with two students, each of which is supervised by either fully-supervised or weakly-supervised datasets. Our teacher thus can gather overlapping category information from both fully-supervised and weakly-supervised students, leading to better discriminative ability. Moreover, the mean teacher structure could bridge the domain gap between two datasets, including differences in image and category distributions.
To achieve non-overlapping category transfer, we pro-pose a semantic graph to model the correlations among all the categories in both fully-supervised and weakly-supervised datasets. The intuition is that even two cat-egories are different, they may be highly-correlated and their corresponding category information can be strategi-cally transferred according to the correlation strength. Fig-ure 2 illustrates a toy example of a semantic graph. The category kid in the weakly-supervised dataset does not ex-actly match with the category person in the fully-supervised dataset, but they are semantically related. Based on this se-mantic graph, we use graph convolutional networks to ex-ploit non-overlapping category information and provide se-mantic guidance for object classification.
Overall, we propose an end-to-end framework; see Fig-It includes a Faster R-CNN [27] as the backbone ure 1. network, a double-supervised mean teacher network for overlapping category transfer, and a semantic graph con-volutional network for non-overlapping category transfer.
This framework can fill the domain gap by using a mean teacher structure, and fully exploit category information by aggregating semantic features over a semantic graph. Com-pared with objectness transfer approaches, we transfer cat-egory information from a fully-supervised dataset to im-prove the classifier. Compared with approaches under the semi-supervised setting [11, 37, 35, 15], our approach ap-plies a double supervised mean teacher to solve domain
Figure 2. An example of category label graph. Red, blue and yellow nodes represent fully-supervised, weakly-supervised and common categories separately.
The inter-dataset graph edges are built according to common categories (“car(fully)” ↔
“car(weakly)”) and category relationships. The relationships in-clude subclass relationship (“person(fully)” ↔ “kid(weakly)”), including relationship (“cyclist(weakly)” ↔ “person(fully)”), and similarity relationship (“bike(fully)” ↔ “wheelchair(weakly)”).
Each intra-dataset graph is a digraph, and the inter graph is a bi-graph with bi-directional edges. Best viewed in color. gap between datasets, and uses a semantic graph convolu-tional network to fully exploit the correlations between cat-egories, leading to semantic transfer of non-overlapping cat-egories. Our method outperforms the state-of-the-art meth-ods in WSOD, and achieves results competitive to FSOD baseline.
We summarize our main contributions as:
• We propose a novel category transfer framework for
WSOD, which specifically handles the issues on category transfer, including the domain gap problem in overlapping category transfer and information aggregation issue in non-overlapping category transfer.
• We propose a novel double-supervised mean teacher network to handle overlapping category transfer. This net-work gathers common category information and bridges the domain gap between two datasets.
• We propose a novel semantic graph convolutional net-work to tackle non-overlapping category transfer. This net-work promotes the aggregation of semantic features be-tween correlated categories.
• We conduct extensive experiments and show that the proposed method outperforms the state-of-the-art weakly-supervised object detection methods and is competitive to fully-supervised object detection baseline on benchmarks. 2.