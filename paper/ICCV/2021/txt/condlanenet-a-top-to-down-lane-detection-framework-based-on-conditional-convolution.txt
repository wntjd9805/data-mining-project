Abstract
Modern deep-learning-based lane detection methods are successful in most scenarios but struggling for lane lines with complex topologies. In this work, we propose Cond-LaneNet, a novel top-to-down lane detection framework that detects the lane instances ﬁrst and then dynamically predicts the line shape for each instance. Aiming to re-solve lane instance-level discrimination problem, we intro-duce a conditional lane detection strategy based on condi-tional convolution and row-wise formulation. Further, we design the Recurrent Instance Module(RIM) to overcome the problem of detecting lane lines with complex topolo-gies such as dense lines and fork lines. Beneﬁt from the end-to-end pipeline which requires little post-process, our method has real-time efﬁciency. We extensively evaluate our method on three benchmarks of lane detection. Re-sults show that our method achieves state-of-the-art per-formance on all three benchmark datasets. Moreover, our method has the coexistence of accuracy and efﬁciency, e.g. a 78.14 F1 score and 220 FPS on CULane. Our code is available at https://github.com/aliyun/ conditional-lane-detection. 1.

Introduction
Artiﬁcial intelligence technology is increasingly be-ing used in the driving ﬁeld, which is conducive to au-tonomous driving and the Advanced Driver Assistance Sys-tem(ADAS). As a basic problem in autonomous driving, lane detection plays a vital role in applications such as ve-hicle real-time positioning, driving route planning, lane-keeping assist, and adaptive cruise control.
Traditional lane detection methods usually rely on hand-crafted operators to extract features [24, 43, 13, 17, 15, 1, 16, 33], and then ﬁt the line shape through post-processing such as Hough transform [24, 43] and Random Sampling
Consensus (RANSAC) [17, 15]. However, traditional meth-ods faile in maintaining robustness in real scene since the hand-crafted models cannot cope with the diversity of lane lines in different scenarios [27]. Recently, most
Figure 1. Scenes of lane lines with complex topologies. It is chal-lenging to cope with the scenes such as the dense lines(the ﬁrst row) and the fork lines(the second row). Different instances are represented by different colors in this ﬁgure. studies about lane detection have focused on deep learn-ing [34]. Early deep-learning-based methods detect lane lines through segmentation [28, 27]. Recently, various methods such as anchor-based methods [32, 2, 39], row-wise detection methods [30, 29, 41], and parametric pre-diction methods [31, 25] have been proposed and continue to refresh the accuracy and efﬁciency. Although deep-learning-based lane detection methods have made great progress [42], there are still many challenges.
A common problem for lane detection is instance-level discrimination. Most lane detection methods [27, 28, 19, 32, 12, 21, 29, 2, 30, 41, 39] predict lane points ﬁrst and then aggregate the points into lines. But assigning differ-ent points to different lane instances [34] is still a common challenge. A simple solution is to label the lane lines into classes of a ﬁxed number (e.g. labeled as 0, 1, 2, 3 if the maximum lane number is 4) and make a multi-class clas-siﬁcation [28, 30, 41, 3]. But the limitation is that only a predeﬁned, ﬁxed number of lanes can be detected [27].
To overcome this limitation, the post-clustering strategy is investigated [27, 19]. However, this strategy is struggling for some cases such as dense lines. Another approach is anchor-based methods [25, 22, 39]. But it is not ﬂexible to predict the line shape due to the ﬁxed shape of the anchor.
Another challenge is the detection of lane lines with complex topologies, such as fork lines which have the same starting point, and dense lines which are parallel with close starting points. Such cases are common in driving scenar-ios, e.g. fork lines usually appear when the number of lanes
changes. Homayounfar et al.[10] proposed an ofﬂine lane detection method for HDMap (High Deﬁnition Map) which can deal with the fork lines. However, there are few studies on the perception of lane lines with complex topologies for real-time driving scenarios.
The lane detection task is similar to instance segmen-tation, which requires assigning different pixels to differ-ent instances. Recently, some studies [35, 38] have investi-gated the conditional instance segmentation strategy, which is also promising for lane detection tasks. However, it is inefﬁcient to directly apply this strategy to lane detection, since the constraint for the mask is not completely consis-tent with specifying the line shape [3, 34, 30].
In this work, we propose a novel lane detection frame-work called CondLaneNet. Aiming to resolve the lane instance-level discrimination problem, we propose the con-ditional lane detection strategy inspired by CondInst [35] and SOLOv2 [38]. Different from the instance segmen-tation tasks, we focus the optimization on specifying the lane line shape based on the row-wise formulation [30, 41].
Moreover, we design the Recurrent Instance Module(RIM) to deal with the detection of lane lines with complex topolo-gies such as the dense lines and fork lines. Besides, ben-eﬁt from the end-to-end pipeline that requires little post-process, our method achieves real-time efﬁciency. The con-tributions of this work are summarised as follows:
• We have greatly improved the ability of lane instance-level discrimination by the proposed conditional lane detection strategy and row-wise formulation.
• We solve the problem of detecting lane lines with com-plex topologies such as dense lines and fork lines by the proposed RIM.
• Our CondLaneNet framework achieves state-of-the-art performance on multiple datasets, e.g. an 86.10 F1 score (4.6% higher than SOTA) on CurveLanes and a 79.48 F1 score (3.2% higher than SOTA) on CULane.
Moreover, the small version of our CondLaneNet has high efﬁciency while ensuring high accuracy, e.g. a 78.14 F1 score and 220 FPS on CULane. 2.