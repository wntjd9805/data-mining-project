Abstract 1.

Introduction
Semi-supervised approaches for crowd counting attract attention, as the fully supervised paradigm is expensive and laborious due to its request for a large number of images of dense crowd scenarios and their annotations. This paper proposes a spatial uncertainty-aware semi-supervised ap-proach via regularized surrogate task (binary segmentation) for crowd counting problems. Different from existing semi-supervised learning-based crowd counting methods, to ex-ploit the unlabeled data, our proposed spatial uncertainty-aware teacher-student framework focuses on high confident regions’ information while addressing the noisy supervision from the unlabeled data in an end-to-end manner. Specif-ically, we estimate the spatial uncertainty maps from the teacher model’s surrogate task to guide the feature learn-ing of the main task (density regression) and the surrogate task of the student model at the same time. Besides, we introduce a simple yet effective differential transformation layer to enforce the inherent spatial consistency regular-ization between the main task and the surrogate task in the student model, which helps the surrogate task to yield more reliable predictions and generates high-quality uncer-tainty maps. Thus, our model can also address the task-level perturbation problems that occur spatial inconsistency be-tween the primary and surrogate tasks in the student model.
Experimental results on four challenging crowd counting datasets demonstrate that our method achieves superior performance to the state-of-the-art semi-supervised meth-ods. Code is available at : https://github.com/ smallmax00/SUA_crowd_counting
Yalin Zheng 1 is the corresponding author.
The task of crowd counting in computer vision is to in-fer the number of people in images or videos. There is an ever-increasing demand for automated crowd counting techniques in various applications such as public safety, se-curity alerts, transport management etc..
With the help of Convolutional Neural Network (CNN)’s feature learning ability, current state-of-the-art methods
[1, 56, 52, 63, 44, 41] gained excellent counting perfor-mance by regressing the corresponding density maps of the input images, where the summed value in a density map gives the total count numbers. To train a robust and accu-rate crowd counting estimator, most of the existing methods
[21, 39, 25, 20, 10, 38] relied on substantial labeled images, where head centres must be annotated for training. How-ever, the annotation process can be labour-intensive and time-consuming. For example, JHU-Crowd [47] dataset contains labels of 1.51 millions people whilst NWPU-Crowd [53] dataset contains annotations of 2.13 millions people, which takes 3000 human hours in total. Hence, re-ducing annotation efforts while maintaining good counting performance is our goal in this paper. More specifically, we study the counting estimator in a semi-supervised manner where limited labeled data is used; on the other hand, the unlabeled data is leveraged to improve our model’s robust-ness and performance.
Previous semi-supervised crowd counting methods tend to minimize the expensive label work through active learn-ing [67, 23], synthetic images [54, 55], or pseudo-ground truth [45, 24]. However, they did not consider the unlabeled data or synthetic data’s intrinsic noisy supervision due to the inherent data uncertainties [32]. Uncertainty estimation has been explored in other computer vision tasks, such as segmentation [13, 58, 2] or detection [62, 8], etc.. There are two significant types of uncertainty [12]: epistemic un-Figure 1. Overview of the very recent work [24], baseline model [49], and our proposed method. (a): [24] utilized surrogate task (binary segmentation) to boost the feature extractor with labeled and unlabeled data so as to enhance the performance of the density regressor. (b): Mean-Teacher [49] is a commonly used semi-supervised framework through exploiting the consistency learning on the student and the teacher models’ outputs under different input-level noise perturbations (ξ, ξ′) and model-level noise perturbation (Dropout [48] of the student and teacher models). We refer to it as the baseline model in this paper. (c): Our Mean-Teacher based semi-supervised framework.
Note that we only input the unlabeled data into the teacher model because this work aims to explore the unlabeled data’s uncertainty. The estimated ‘hard’ and ‘soft’ spatial uncertainty maps aim to assist the consistency learning (upon binary segmentation and density regression) between the student and teacher models; one can alleviate the unlabeled data’s inevitable noisy supervision. The student model’s binary segmentation is regularized by the inherent consistency regularization with approximated segmentation to address the spatial predictions’ perturbation issues between binary segmentation and density regression tasks in the student model. certainty, which accounts for the uncertainty in the model parameters and can be addressed when given enough data; aleatoric uncertainty corresponds to inevitable noisy pertur-bation existing in the data itself. Solving the aleatoric un-certainty is a crucial problem since crowd images contain inherent noises such as complex backgrounds, massive oc-clusions and illumination variations etc.. Few recent ap-proaches [32, 33] have considered the uncertainty quantifi-cation in the crowd counting task in a fully-supervised man-ner. They adopted [12] to estimate the mean and variance of the assumed Gaussian distribution of the density map, where the variance is served as a measure of uncertainty.
In this work, we exploit the aleatoric uncertainty in a semi-supervised manner to alleviate the noisy supervi-sion in uncertain spatial regions due to the complex back-grounds and massive occlusions challenges from the unla-beled crowd images [32]. Previous crowd counting methods
[65, 40, 7] prove that the spatial region information from the binary segmentation task is essential to tell the crowd and background locations, which will help the density map re-gressor to focus on the region of interest and improve the counting performance. In our work, the binary segmenta-tion provides spatial information and serves as a surrogate task to estimate the uncertain spatial regions (e.g. uncertain crowd locations). With the estimated spatial uncertainty, we assist the unsupervised consistency learning (upon binary segmentation and density regression) between the student model and the teacher model based on the Mean-Teacher
[49] semi-supervised learning framework. Fig. 1 (b & c) shows the overview structure of our method and the re-implemented Mean-Teacher framework [49] for the crowd counting task. Note that, in our work, the student model and the teacher model share a similar structure (Feature ex-tractor, binary segmentation module, density regressor). We update the teacher model’s parameters as an exponential moving average (EM A) of the student model’s parame-ters. Because ensembling the student model’s predictions at different training steps can enhance the performance of the teacher model’s predictions [14]; in which case, the teacher model can generate ‘targets’ for the student model to learn from. However, as mentioned above, those ‘targets’ con-tain spatial-wise uncertainty; thus, we purify the ‘targets’ with the estimated ‘hard’ and ‘soft’ uncertainty map during training.
Apart from the aforementioned novel components, we also study how to learn an excellent surrogate task (bi-nary segmentation) predictor to produce reliable and con-sistent spatial uncertainty that the main task (density re-gression) has in the student model. Note that, followed by
[49], only student model is used for the inference process.
Specifically, we introduce a simple yet effective differen-tiable transformation layer to approximate the binary seg-mentation maps from the density map predictions of the unlabeled input in the student model. We then employ an unsupervised inherent consistency loss between the pre-dicted segmentation maps and the approximated segmenta-tion maps to guarantee the consistent spatial feature learn-ing between two different tasks in the student model. The underlying motivations are twofold: (1) the surrogate and the main task may introduce an inherent prediction pertur-bation on spatial regions due to the domain gap of feature learning from multi-tasks [28]. Our ablation experiment re-sults prove that this perturbation will lead to noisy super-vision upon two tasks, thus reducing the performance. (2)
The proposed transformation layer itself is simple. How-ever, it brings several benefits with the inherent consistency loss. For example, the estimated uncertainty from a reg-ularized surrogate task can indicate more reasonable and
consistent spatial uncertain regions that the main task has, which further enhances the consistency between the surro-gate and the main task. In other words, with the proposed transformation layer, the estimated uncertainty and consis-tency regularization can benefit from each other to advance the counting performance. Our experiment results demon-strate that the proposed consistency regularization mecha-nism can boost the model’s performance in both supervised and semi-supervised manner.
In summary, this work makes the following contribu-tions: (1) We propose a surrogate task to estimate the un-certain spatial regions from the unlabeled data under the semi-supervised Teacher-Student framework, which can al-leviate the inevitable noisy supervision from the unlabeled data. (2) We propose a differentiable transformation layer that enables the inherent spatial consistency regularization between the surrogate task (binary segmentation) and the main task (density regression) in the student model, which can enhance the model to estimate high-quality uncertainty maps from the unlabeled data, thus improve our model’s counting performance. (3) We conduct extensive exper-iments on four well-known challenging counting bench-marks. Quantitative results demonstrate that our methods outperform existing semi-supervised crowd counting meth-ods. Besides, with less than half of the labeled data, our method can achieve comparable performance with the fully-supervised state-of-the-art methods. 2.