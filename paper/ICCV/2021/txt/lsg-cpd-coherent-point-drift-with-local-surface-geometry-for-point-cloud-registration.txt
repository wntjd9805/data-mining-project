Abstract
Probabilistic point cloud registration methods are becom-ing more popular because of their robustness. However, un-like point-to-plane variants of iterative closest point (ICP) which incorporate local surface geometric information such as surface normals, most probabilistic methods (e.g., coher-ent point drift (CPD)) ignore such information and build
Gaussian mixture models (GMMs) with isotropic Gaussian covariances. This results in sphere-like GMM components which only penalize the point-to-point distance between the two point clouds. In this paper, we propose a novel method called CPD with Local Surface Geometry (LSG-CPD) for rigid point cloud registration. Our method adaptively adds different levels of point-to-plane penalization on top of the point-to-point penalization based on the flatness of the local surface. This results in GMM components with anisotropic covariances. We formulate point cloud registration as a maximum likelihood estimation (MLE) problem and solve it with the Expectation-Maximization (EM) algorithm. In the
E step, we demonstrate that the computation can be recast into simple matrix manipulations and efficiently computed on a GPU. In the M step, we perform an unconstrained optimization on a matrix Lie group to efficiently update the rigid transformation of the registration. The proposed method outperforms state-of-the-art algorithms in terms of accuracy and robustness on various datasets captured with range scanners, RGBD cameras, and LiDARs. Also, it is significantly faster than modern implementations of CPD.
The source code is available at https://github.com/
ChirikjianLab/LSG-CPD.git. 1.

Introduction
Point cloud registration plays an important role in various computer vision tasks [7, 30, 34, 39].
It is a task of align-ing two point clouds and estimating the relative transforma-tion between them. When the correspondences between the points are known, methods have been proposed to solve it efficiently [5, 41]. Our paper focuses on the correspondence-free registration. The most popular method, ICP [2], iter-atively computes the alignment from point-to-point corre-*Corresponding author
Figure 1. CPD with Local Surface Geometry (LSG-CPD). Green denotes the source set; purple denotes the target set. Unlike CPD
[29] which constructs a sphere-like GMM component (c) for each point in the source set, the proposed method constructs GMM com-ponents on the target set. In the proposed method, plane-like GMM components (a) are created for points with small surface varia-tion [31], i.e., flat local surface; sphere-like GMM components (b) are created for points with large surface variation. spondence obtained via the closest point. Various point-to-plane ICP variants [7, 8, 35, 36] make use of surface normals and take advantage of the tendency that most point cloud data are locally planar. However, ICP and its variants require good initialization and are susceptible to outliers, noise, and missing points.
Probabilistic methods formulate point cloud registration as a probability density estimation problem [14,22,29,37]. In particular, methods such as CPD [29] and FilterReg [14] de-scribe the geometry of the first point cloud via a probability distribution over Euclidean space with a GMM. The GMM is constructed by placing a Gaussian component with isotropic covariance at every point in the set. The second set is fit-ted to it via MLE. The introduction of the outlier component in the GMM and the sphere-like isotropic covariance makes these methods robust. However, unlike point-to-plane ICP variants [7, 8, 35, 36] which take advantage of the local pla-nar geometry in point cloud data, these methods ignore such information. While these methods are robust, the isotropic covariance does not faithfully capture the local planar geom-etry of the point clouds, leading to inaccuracy in registration.
In this paper, we propose a novel method, CPD with Lo-cal Surface Geometry (LSG-CPD), which takes into account local surface geometry: surface normal and surface varia-tion. Surface variation [31] is closely related to curvature and surface flatness. Intuitively, the flatter the local surface,
the smaller the curvature, the smaller the surface variation.
We construct a GMM on the target set. The source set is fitted to it via MLE (Fig. 1). However, unlike previous methods [14, 29] which restrict covariances to be isotropic, we adaptively impose different levels of point-to-plane pe-nalization on top of the original point-to-point penalization,
If the lo-resulting in anisotropic covariances (Sec. 3.1). cal surface is flat, i.e., the surface variation is small, a large point-to-plane penalization is added. The GMM component will be plane-like and points will be mainly attracted towards the local plane instead of the centroid (Fig. 1(a)). If the lo-cal surface has large curvature or the normal estimation is noisy, i.e., the surface variation is large, the point-to-plane penalization will be small (Fig. 1(b)). In this case, the GMM component will be sphere-like and robustness is maintained – the registration will not be misled by those ineffectively es-timated surface normals. In addition, we propose a method to estimate the weight placed on the outlier component of the
GMM (Sec. 3.2). Furthermore, we introduce the idea of con-fidence filtering (CF) which allows flexibility in reallocating weights of GMM components and outlier weights based on measurement confidence of points (Sec. 3.3). The EM al-gorithm [4, 12] is used to solve the MLE problem. To make our method efficient, we reformulate the computation in the
E step into parallelizable matrix manipulations which can be efficiently computed on a GPU (Sec. 3.4). In the M step, we propose an unconstrained optimization method on a matrix
Lie group and find the optimum with the efficient Newton’s method (Sec. 3.5).
Our motivation is to make the GMM-based description of the point cloud geometry richer and more faithful to the
“true” probabilistic distribution by incorporating local sur-face geometry, afforded by the surface normal and variation, with the original point position. The optimum of the objec-tive function in the EM process will be closer to the “true” transformation compared to that using the isotropic covari-ances. Thus, our method is able to improve the registration accuracy while maintaining the robustness of probabilistic methods. Results show that the proposed method outper-forms state-of-the-art algorithms in terms of accuracy and robustness on a wide variety of dataset captured by range scanners, RGBD cameras, and LiDARs. 2.