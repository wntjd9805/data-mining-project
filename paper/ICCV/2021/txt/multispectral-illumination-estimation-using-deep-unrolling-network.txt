Abstract
This paper examines the problem of illumination spec-tra estimation in multispectral images. We cast the prob-lem into a constrained matrix factorization problem and present a method for both single-global and multiple illu-mination estimation in which a deep unrolling network is constructed from the alternating direction method of mul-tipliers(ADMM) optimization for solving the matrix factor-ization problem. To alleviate the lack of multispectral train-ing data, we build a large multispectral reﬂectance image dataset for generating synthesized data and use them for training and evaluating our model. The results of simula-tions and real experiments demonstrate that the proposed method is able to outperform state-of-the-art spectral illu-mination estimation methods, and that it generalizes well to a wide variety of scenes and spectra. 1.

Introduction
As an intrinsic physical property of materials, spectral reﬂectance is a rich information source for a wide range of vision tasks, including object recognition and material re-production, as well as man technical and scientiﬁc imaging problems. However, the acquisition of accurate spectral re-ﬂectance images requires an extra per-image calibration to compensate for the illumination conditions in the scene, for example with a known reference [21] or a dedicated mea-surement device [2]. Unfortunately this calibration is gen-erally cumbersome and frequently fails in complex lighting situations with multiple, different illumination sources.
A practical solution is estimating the illumination spec-tra from captured multispectral images and separating the reﬂectance and illumination spectral for further purpos-es. This illumination estimation problem is highly under-determined; thus, regularizations are required to constrain the solution to satisfy the image priors of multispectral re-ﬂectances and illumination. Recently, many approaches have been studied to estimate illumination spectra. Most of them either utilize the statistics of multispectral images or extract the specular reﬂection component to estimate illu-Compare
Multi-stage 
Estimation Network
Real spectral  reflectance
Estimated spectral  reflectance
Synthesized  multispectral Image
Illumination spectra
Compare
Estimated  illumination
Figure 1. The framework of our spectral reﬂectance and illumina-tion estimation method. mination spectra, but don’t sufﬁciently consider the image priors of multispectral reﬂectance and illumination. There are also some attempts applying convolutional neural net-works (CNN) to estimate illumination spectra. However, in our opinion, such methods are not ﬂexible to adapt to var-ious illumination spectra, and they are limited in the lack of large image datasets. Moreover, to the best of our knowl-edge, none of the existing methods can handle multiple illu-minants in multispectral images. These limitations motivate us to build a large image dataset of multispectral reﬂectance and put forward a ﬂexible illumination estimation method based on deep neural network (DNN).
Our method leverages a multispectral image dataset synthesized by using real spectral reﬂectance images and illumination spectra to train the network, as shown in
Fig. 1. We cast the illumination estimation problem as a constrained matrix factorization problem, and propose an optimization-inspired unrolling multi-stage network to solve the problem. Our network can achieve more accurate estimation than previous methods by training on the synthe-sized dataset and utilizing the non-local prior of reﬂectance images, and the low-rank and total-variation (TV) prior of illumination spectra. The contributions of this paper can be summarized as follows:
• We present a new take on constrained matrix factor-ization using a multi-stage loop-unrolled neural net-work to solve the multispectral illumination estimation problem. Our data-driven method explicitly learns the non-local prior from the real captured reﬂectance im-ages and improves the estimation accuracy with a low-rank and a TV regularization on illumination spectra.
The proposed method signiﬁcantly outperforms exist-ing approaches.
• We present the ﬁrst work to handle both single-global illumination and multiple illumination estimation for multispectral images. Both simulations on synthesized multispectral images and experiments on real images show the high ﬂexibility, effectiveness, and general-ization ability of our method.
• We build the largest existing spectral reﬂectance im-age dataset consisting of 400 high-quality multispec-tral images, providing a general-purpose benchmark for the illumination estimation model’s training and e-valuation. 2.