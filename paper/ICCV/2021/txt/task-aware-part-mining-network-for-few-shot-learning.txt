Abstract
Few-Shot Learning (FSL) aims at classifying samples into new unseen classes with only a handful of labeled sam-ples available. However, most of the existing methods are based on the image-level pooled representation, yet ignore considerable local clues that are transferable across tasks.
To address this issue, we propose an end-to-end Task-aware
Part Mining Network (TPMN) by integrating an automatic part mining process into the metric-based model for FSL.
The proposed TPMN model enjoys several merits. First, we design a meta filter learner to generate task-aware part fil-ters based on the task embedding in a meta-learning way.
The task-aware part filters can adapt to any individual task and automatically mine task-related local parts even for an unseen task. Second, an adaptive importance generator is proposed to identify key local parts and assign adaptive importance weights to different parts. To the best of our knowledge, this is the first work to automatically exploit the task-aware local parts in a meta-learning way for FSL. Ex-tensive experimental results on four standard benchmarks demonstrate that the proposed model performs favorably against state-of-the-art FSL methods. 1.

Introduction
Deep Convolutional Neural Networks (CNNs) have achieved tremendous success in a wide range of computer vision tasks [43, 14, 20, 37, 29, 54, 55]. However, the train-ing of CNNs requires large amounts of annotated images, which are prohibitively expensive to collect [2]. Few-Shot
Learning (FSL) [12, 11, 48, 44] is promising in reducing the need for human annotation, which aims at learning a model with good generalization capability such that it can classify unlabeled samples (query set) into new unseen classes with only one or a few examples (support set). Usually, a few-shot classifier is trained to solve N -way K-shot tasks that consist of N classes and K support samples per class.
To tackle the FSL problem, a series of previous work [44, 46, 13, 23, 22, 52] adopts a metric-based learning model, which firstly learns a good embedding space, and then se-∗Corresponding Author
Figure 1. Illustration of our motivation. (a) shows the comparison of different local representations. The first row presents the local patches derived by grid dividing in the previous methods. The sec-ond row shows the local parts learned in an automatic way. The lat-ter achieves better discriminability and contains fewer background noises. (b) shows the task-aware mechanism. For the same image of dog, the attended local parts change with different tasks. lects a distance metric to directly compute the distances between the query and support images for classification.
However, most of these methods utilize the image-level pooled representation for classification, which could lose considerable discriminative local clues that enjoy favorable transferability across classes [53]. Recently, several meth-ods [24, 25, 53, 9] consider taking advantage of the local representation for FSL. These methods decompose images into a set of local patches by grid dividing on the feature map. Then the image-level distance measurement between a pair of the query and the support images is achieved by aggregating the similarities between local patches.
By studying the previous FSL methods based on local representations [24, 25, 53, 9], we sum up three charac-teristics that are imperative for building a robust few-shot model. (1) Automaticity. In the previous methods, the lo-cal patches obtained by the pre-defined decomposition strat-egy suffer from large randomness. Some local patches have high possibilities to cover only a small part of the semantic regions of the object, or even completely the background regions (see the first row in Figure 1 (a)). This random-ness could cause misalignments when matching the local patches. However, the human can quickly recognize a new category by automatically segmenting the objects into mul-tiple local parts (see the second row in Figure 1 (a)) and comparing them to the similar object parts that have already been seen. The automaticity in the part mining process en-sures natural semantic correspondences between the local parts. (2) Task-Aware Mechanism. In previous methods, a common set of local regions is shared across tasks, which may not handle the diverse tasks with large distribution dif-ferences well. As each individual task consists of a unique set of categories, the local regions that are effective for the current task may not always satisfy the needs of other tasks.
For example, when differentiating dog from tiger, humans pay more attention on the texture of part face, while when recognizing dog and pig, the structure of part nose is obvi-ously more essential (see Figure 1 (b)). Even for the same image, the importance degrees of the local parts vary from task to task. Therefore, without a task-aware mechanism, it is challenging to make the learned model generalize to novel classes well. (3) Adaptive Weights. When making the final predictions, suppressing the importance of irrele-vant regions can avoid introducing noises, while more dis-criminative regions should enjoy higher weights. Therefore the importance weights of different local parts should be adaptively assigned.
Inspired by the above insights, we propose an end-to-end
Task-aware Part Mining Network (TPMN) to integrate the automatic local part mining process into the metric-based
FSL. To achieve the automaticity in discovering local part regions, we firstly introduce a set of Part Filters (PFs) to au-tomatically generate part-aware activation maps. The PFs are parameterized by multiple learnable 1 × 1 convolution kernels, which can activate the spatial attention that covers a certain local part on the feature map. The resulted activation maps are used as part masks to obtain multiple discrimina-tive part-aware features for both support and query images.
However, the above PFs, once are learned, are fixed and shared across tasks, which are incapable of handling var-ious tasks well. Therefore, to equip the network with the task-aware mechanism, we design a Meta Filter Learner (MFL) to flexibly generate the parameters of the PFs that are customized for an individual task, in a meta-learning way. This is achieved by incorporating the task embedding, which expresses the unique categorical information of the specific task. MFL establishes the connection between the task embedding and part filters.
Intuitively speaking, the parameters of the PFs will be derived by transforming the task embedding into the parameter space. In this way, the task-aware PFs are able to adapt from task to task and can provide the most desired information for any tasks, even the tasks with unseen classes. Then, to determine the image-level similarity for the given query and support image, we assign adaptive weights to local parts by an adaptive im-portance generator, such that the less relevant parts will be suppressed while the discriminative ones are highlighted.
Finally, the image-level similarity is derived as the weighted aggregation of local similarities between part-aware fea-tures from different images.
The contributions of our method could be summarized into three-fold: (1) We propose an end-to-end Task-aware
Part Mining Network by jointly exploiting the automatic local part mining process and the meta-learning strategy. (2) We design a meta filter learner to generate task-aware part filters, which can discover task-related local parts even for the unseen tasks. Also, an adaptive importance gen-erator is proposed to assign importance weights for local parts. To our best knowledge, this is the first work to ex-ploit discriminative local parts in a meta-learning way for
FSL. (3) Extensive experimental results on four challeng-ing benchmarks demonstrate that our method performs fa-vorably against state-of-the-art FSL methods. 2.