Abstract
The light transport matrix (LTM) is an instrumental tool in line-of-sight (LOS) imaging, describing how light interacts with the scene and enabling applications such as relighting or separation of illumination components.
We introduce a framework to estimate the LTM of non-line-of-sight (NLOS) scenarios, coupling recent virtual for-ward light propagation models for NLOS imaging with the
LOS light transport equation. We design computational projector-camera setups, and use these virtual imaging sys-tems to estimate the transport matrix of hidden scenes. We introduce the speciﬁc illumination functions to compute the different elements of the matrix, overcoming the challeng-ing wide-aperture conditions of NLOS setups. Our NLOS light transport matrix allows us to (re)illuminate speciﬁc locations of a hidden scene, and separate direct, ﬁrst-order indirect, and higher-order indirect illumination of complex cluttered hidden scenes, similar to existing LOS techniques. 1.

Introduction
The light transport matrix (LTM) [26] is a fundamen-tal tool to understand how a scene transports incident light, describing the linear response of the scene for a given illu-mination. It has become the cornerstone of many applica-tions such as dual photography [36], image-based relight-ing [30, 41], acquisition of material properties [5, 35], sep-aration of global illumination components [25, 32], or ro-bust depth estimation [29]. To acquire the LTM, a camera-projector setup is used, capturing the scene under varying coded illumination conditions.
On the other hand, recent works on non-line-of-sight (NLOS) imaging have shown the potential to signiﬁ-cantly advance many ﬁelds including medical imaging, au-tonomous driving, rescue operations, or defense and secu-rity, to name a few. The key idea is to leverage the scattered radiance on a secondary relay surface to infer information about the hidden scene [39, 10, 23]. However, NLOS imag-Figure 1: We introduce a framework to compute virtual light transport matrices (LTM) of NLOS scenes. Probing the virtual LTM of a hidden scene allows us to extract its di-rect illumination (ﬁrst row), the indirect components when illuminating a single point in the scene (second row, each point corresponds to a column in the LTM), or decompos-ing near-, middle-, and far-ﬁeld indirect components (third row) when illuminating speciﬁc points in the hidden scene.
The insets show the probed elements from the virtual LTM for each image. ing is still on its infancy, and many well-established capabil-ities of traditional line-of-sight (LOS) imaging modalities cannot yet be applied in NLOS conditions.
In this work we take steps towards bridging this gap be-tween LOS and NLOS imaging modalities, introducing a computational framework to obtain the LTM of a hidden
In particular, we build on the recent wave-based scene. phasor ﬁelds framework [21], which poses NLOS as a for-ward wave transport problem, creating virtual (computa-tional) light sources and cameras at the visible relay surface from time-resolved measurements of the hidden scene.
While this approach would in principle allow turning
NLOS imaging into a virtual LOS problem, working in the
NLOS domain introduces two main challenges which are not present in LOS settings: 1) the large baseline of capture setups on the visible surfaces results in a very large virtual aperture, creating a very shallow depth-of-ﬁeld and there-fore signiﬁcant out-of-focus contribution; and 2) the resolu-tion of the virtual projector-camera is limited, with poten-tially signiﬁcant cross-talk between neighbor (virtual) pix-els. As a consequence, directly applying LOS techniques to capture the LTM of hidden scenes would lead to suboptimal results.
We develop computational (virtual) illumination and imaging functions, leveraging the fact that undesired con-tributions of light transport in the hidden scene are coded in its NLOS virtual LTM. Then, inspired by existing works in light transport analysis in LOS settings [25, 32], we exploit the LTM and demonstrate illumination decomposition in
NLOS scenes (see Fig. 1). In particular, we probe different elements of the matrix, including direct and indirect illumi-nation, as well as near-, middle-, and far-ﬁeld indirect light decomposition. This has potential applications for relight-ing, material analysis, improved geometry reconstruction, or scene understanding in general beyond the third bounce.
In summary, our contributions are:
• We introduce a framework to obtain the light transport matrix (LTM) of a hidden scene, helping bridge the gap between LOS and NLOS imaging.
• We develop the computational methods to obtain the necessary virtual illumination and imaging functions, dealing with the main challenges on the NLOS imag-ing modality.
• We demonstrate how our formulation allows to probe the virtual LTM, allowing to separate NLOS direct and indirect illumination components in hidden scenes. 2.