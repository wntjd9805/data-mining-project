Abstract
In this paper, we present LOOKOUT, a novel autonomy system that perceives the environment, predicts a diverse set of futures of how the scene might unroll and estimates the trajectory of the SDV by optimizing a set of contingency plans over these future realizations. In particular, we learn a diverse joint distribution over multi-agent future trajec-tories in a trafﬁc scene that covers a wide range of future modes with high sample efﬁciency while leveraging the ex-pressive power of generative models. Unlike previous work in diverse motion forecasting, our diversity objective ex-plicitly rewards sampling future scenarios that require dis-tinct reactions from the self-driving vehicle for improved safety. Our contingency planner then ﬁnds comfortable and non-conservative trajectories that ensure safe reactions to a wide range of future scenarios. Through extensive evalu-ations, we show that our model demonstrates signiﬁcantly more diverse and sample-efﬁcient motion forecasting in a large-scale self-driving dataset as well as safer and less-conservative motion plans in long-term closed-loop simula-tions when compared to current state-of-the-art models. 1.

Introduction
Self-driving vehicles (SDVs) have the potential to en-hance considerably the safety of our roads as, unlike hu-mans, they can constantly scan the surrounding environ-ment without getting distracted or being impaired while driving. Key to the success of a self-driving vehicle is its ability to perceive its surroundings and predict the future trajectory of the trafﬁc participants, particularly those that might affect its decision making. These predictions are then exploited by the motion planning module to plan a safe and comfortable maneuver towards the goal.
Forecasting the behavior of trafﬁc participants is very challenging as humans do not always follow the rules of the road and sometimes exhibit erratic behaviors. Further-more, the scene might unroll in many possible ways in the
*Denotes equal contribution
†This work was done by all authors while at Uber ATG
Figure 1. We illustrate the fact that the future is highly uncertain and multimodal by showing 2 distinct futures at the scene-level.
In such scenario, LOOKOUT plans a short-term executable action that leads to 2 different contingent plans to stay safe in both cases. future, depending heavily on the interactions between ac-tors (e.g., at a merge, either actor A yields to actor B or vice versa). While most works predict each actor’s future independently [11, 10, 29, 8, 4], recent approaches model actor interactions and can produce samples that explain the full scene in a consistent manner [2, 33, 38, 5]. How-ever, they require prohibitively large numbers of samples to cover the long-tails of the distribution. This is problem-atic since these long tails are critical for safety, as failing to take them into account might result in an accident (e.g., an impaired driver running a red trafﬁc light perpendicularly to the SDV’s intended trajectory). Thus, there is a need to develop prediction systems that can efﬁciently sample the diverse set of possible futures. Unfortunately, existing ap-proaches [46, 47] are not sample efﬁcient as they trivially encourage diversity in euclidean space, thus utilizing sam-ples to cover irrelevant actors or actions that do not impact the SDV’s behavior.
Furthermore, existing motion planners cannot take ad-vantage of prediction systems that produce scene-consistent samples [53, 13, 1, 36]. Instead, they optimize the expected cost by sampling the marginal distribution of each actor in-dependently, thus ignoring the fact that some of these fu-tures cannot happen at the same time (e.g., either the hor-izontal or vertical trafﬁc can ﬂow at a 4-way stop, but not both). These planners also assume that the SDV must com-mit to a single long-term trajectory, when in practice it can execute a short-term action and re-plan as newer sensor ob-servations become available. As a consequence, they result in suboptimal and overly conservative trajectories [50, 39],
e.g., the SDV braking prematurely to react to an unlikely future instead of maintaining its speed as long as it is able to stop safely and comfortably later.
In this paper we propose LOOKOUT, a full end-to-end autonomy system that detects actors in the scene, predicts a diverse set of consistent futures with high sample efﬁciency, and plans an action that behaves defensively to potential hazards while not overreacting to low probability dangers far into the future. In particular, to address the sample in-efﬁciency and limited mode coverage in motion forecasting we formulate this task as a diverse set prediction problem, where each element in the set reﬂects one possible future at the scene level. To enable this set to cover the future modes that matter for our decision making, we directly op-timize the diversity of the downstream ego-vehicle motion plans. Then, a scenario scoring module estimates the prob-ability of each future in the set, enabling our planner to ac-count for unlikely but safety-critical scenarios without be-ing overly conservative. Finally, we propose a novel con-tingency planner that is able to leverage multiple consis-tent futures by planning separate long-term responses for each future, while sharing an initial short-term action that behaves non-conservatively with respect to the futures and avoids immediate collision. Fig. 1 shows an example of two diverse futures and the corresponding shared action and contingent plans.
We demonstrate the effectiveness of our approach in large-scale open-loop and closed-loop experiments that comprise a wide variety of complex scenarios. Our exten-sive experiments show that LOOKOUT’s driving is signiﬁ-cantly safer as well as less conservative than previous state-of-the-art approaches. Furthermore, there exists a trade-off between diversity and reconstruction quality of the fore-casts; our approach can produce much better reconstruction than other methods with similar diversity and higher diver-sity with similar reconstruction capability. 2.