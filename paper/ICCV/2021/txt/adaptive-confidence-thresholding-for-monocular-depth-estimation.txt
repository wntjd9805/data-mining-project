Abstract
Self-supervised monocular depth estimation has become an appealing solution to the lack of ground truth labels, but its reconstruction loss often produces over-smoothed results across object boundaries and is incapable of handling oc-clusion explicitly. In this paper, we propose a new approach to leverage pseudo ground truth depth maps of stereo im-ages generated from self-supervised stereo matching meth-ods. The conﬁdence map of the pseudo ground truth depth map is estimated to mitigate performance degeneration by inaccurate pseudo depth maps. To cope with the predic-tion error of the conﬁdence map itself, we also leverage the threshold network that learns the threshold dynami-cally conditioned on the pseudo depth maps. The pseudo depth labels ﬁltered out by the thresholded conﬁdence map are used to supervise the monocular depth network. Fur-thermore, we propose the probabilistic framework that re-ﬁnes the monocular depth map with the help of its uncer-tainty map through the pixel-adaptive convolution (PAC) layer. Experimental results demonstrate superior perfor-mance to state-of-the-art monocular depth estimation meth-ods. Lastly, we exhibit that the proposed threshold learn-ing can also be used to improve the performance of existing conﬁdence estimation approaches. 1.

Introduction
Monocular depth estimation, which predicts a dense depth map from a single image, plays an important role in various ﬁelds such as scene understanding and autonomous driving. Early works [8, 31, 4] are based on supervised learning in which the performance depends on a huge amount of training data with ground truth depth labels.
This work was supported by the Institute of Information & Commu-nications Technology Planning & Evaluation (IITP) grant funded by the
Korean government (MSIT) (No. 2020-0-00056) and the Mid-Career Re-searcher Program through the NRF of Korea (NRF-2021R1A2C2011624).
S. Kim4 was supported in part by the MSIT under the ICT Creative Con-silience Program (IITP-2021-2020-0-01819).
∗ Equal contribution. † Corresponding author.
Since establishing such a large-scale training data is very costly and labour-intensive, recent approaches rely on the self-supervised learning regime [11, 13, 32, 14, 36]. Instead of using ground truth labels for training the network, they attempt to leverage the self-supervision from a pair of stereo images or monocular video sequences, under the assump-tion that the geometric structure of a scene can be encoded with the reconstruction loss based on pixel-wise intensity similarities [11]. This loss function seems to be an appeal-ing alternative to the lack of large-scale ground truth labels, but it often leads to blurry results around depth boundaries and does not consider occluded pixels [13].
Instead of relying on the self-supervised reconstruction loss across stereo images, Cho et al. [6] attempted to train the monocular depth estimation network through pseudo depth labels of the stereo images generated from pre-trained stereo matching network [34]. To mitigate performance de-generation by inaccurate pseudo depth labels, they leverage stereo conﬁdence maps (∈ [0, 1]) indicating the reliability of the pseudo depth labels. The conﬁdence map is trun-cated with a threshold [6, 46] so that depth values with low conﬁdence are excluded. However, a ﬁxed threshold for all training dataset still has the risk of inaccurate pseudo depth values being used in the network training [6]. The method of [46] attempted to address this issue by learning the threshold with an additional regularization term, but the performance gain is rather limited due to its hard threshold-ing and the implicit constraint by the regularization term.
To overcome this limitation, we propose a novel ar-chitecture that adaptively learns the threshold dynamically conditioned on the pseudo depth map. For a given in-accurate pseudo depth map, the stereo conﬁdence map and its associated threshold are inferred in an end-to-end manner. The conﬁdence map is then thresholded through a differential soft-thresholding operator controlled by the learned threshold. The proposed threshold learning is ca-pable of dealing with the prediction errors of the conﬁ-dence map more effectively. Note that we leverage the soft-thresholding operator to make the network differentiable.
The thresholded conﬁdence map is then used together with
the pseudo depth labels for training the monocular depth estimation network. Additionally, we propose to enhance the monocular depth map in a probabilistic inference frame-work. Unreliable parts of the monocular depth map are identiﬁed using the uncertainty map, and these are reﬁned through the pixel-adaptive convolution (PAC) layer [45].
Experimental results validate that the monocular depth ac-curacy is signiﬁcantly improved by leveraging the proposed threshold learning and probabilistic depth reﬁnement mod-ules.
Interestingly, the threshold learning can also be beneﬁ-cial to improve the performance of existing stereo conﬁ-dence estimation approaches [38, 25]. The conﬁdence map obtained from the existing approaches [38, 25] is reﬁned through the soft-thresholding function controlled by the learned threshold. As shown in Fig. 2, the soft-thresholding function attenuates low conﬁdence values that are less than the learned threshold τ to become as close as 0 while am-plifying high conﬁdence values to converge to 1. We vali-date through experiments that this process improves the pre-diction accuracy of the existing conﬁdence estimation ap-proaches. To sum up, our contributions are as follows.
• We propose a novel framework of monocular depth estimation using pseudo depth labels generated from self-supervised stereo matching methods.
• We introduce the threshold network that adaptively learns the threshold of the conﬁdence map for bet-ter predicting the reliability of the inaccurate pseudo depth labels.
• The monocular depth map is further reﬁned through the probabilistic reﬁnement module based on the PAC layer.
• It is shown that the threshold network can also be used to enhance the prediction accuracy of existing conﬁ-dence estimation approaches. 2.