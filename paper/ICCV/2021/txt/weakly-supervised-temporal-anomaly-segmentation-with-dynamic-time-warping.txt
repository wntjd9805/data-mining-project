Abstract
Most recent studies on detecting and localizing tempo-ral anomalies have mainly employed deep neural networks to learn the normal patterns of temporal data in an unsu-pervised manner. Unlike them, the goal of our work is to fully utilize instance-level (or weak) anomaly labels, which only indicate whether any anomalous events occurred or not in each instance of temporal data.
In this paper, we present WETAS, a novel framework that effectively iden-tifies anomalous temporal segments (i.e., consecutive time points) in an input instance. WETAS learns discriminative features from the instance-level labels so that it infers the sequential order of normal and anomalous segments within each instance, which can be used as a rough segmentation mask. Based on the dynamic time warping (DTW) align-ment between the input instance and its segmentation mask,
WETAS obtains the result of temporal segmentation, and si-multaneously, it further enhances itself by using the mask as additional supervision. Our experiments show that WETAS considerably outperforms other baselines in terms of the lo-calization of temporal anomalies, and also it provides more informative results than point-level detection methods. 1.

Introduction
Anomaly detection, which refers to the task of identify-ing anomalous (or unusual) patterns in data, has been exten-sively researched in a wide range of domains, such as fraud detection [1], network intrusion detection [18], and medical diagnosis [38]. In particular, detecting the anomaly from temporal data (e.g., multivariate time-series and videos) has gained much attention in many real-world applications, for finding out anomalous events that resulted in unexpected changes of a temporal pattern or context.
Recently, several studies on anomaly detection started to
*This work was done when the author was at POSTECH.
†Corresponding author.
Figure 1: Two different strategies for localizing temporal anomalies. Given an input instance of length T , the point-level and segment-level anomaly detection produce the se-ries of binary labels of length T and length L, respectively. localize and segment the anomalies within an input instance based on deep neural networks [4, 5, 14], unlike conven-tional methods which simply classify each input instance as positive (i.e., anomalous) or negative (i.e., normal). In this work, we aim to precisely localize the anomalies in tempo-ral data by detecting anomalous temporal segments, defined as the group of consecutive time points relevant to anoma-lous events. Note that labeling every anomalous time point is neither practical nor precise, similarly to other segmen-tation problems [7, 21, 31]. In this sense, the main chal-lenge of temporal anomaly segmentation is to distinguish anomalous time points from normal time points without us-ing point-level anomaly labels for model training.
The most dominant approach to the localization of the temporal anomalies is point-level anomaly detection based on the reconstruction of input instances [3, 12, 15, 25, 26, 30, 35, 40]. To learn the point-level (or local) anomaly score in an unsupervised manner, they focus on modeling the nor-mal patterns (i.e., temporal context of each time point, usu-ally given in a form of its past inputs [6]) from normal data, while considering all unlabeled data as normal. Specifically, they mainly employ variational autoencoder (VAE) to learn normal latent vectors of temporal inputs, or train sequence models to predict the next input by using RNNs or CNNs.
Methods
Anomaly Prediction
Park et al. [30]
Su et al. [35]
Xu et al. [40]
Sultani et al. [36]
WETAS (ours) point-level point-level point-level (static) segment-level (dynamic) segment-level
Instance Label
✗
✗
✗
✓
✓
Table 1: Comparison of anomaly detection methods that are able to localize the temporal anomalies in each instance.
Then, they compute the anomaly score for each time point based on the magnitude of error between an actual input and the reconstructed (or predicted) one.
However, such unsupervised learning methods show lim-ited performance due to the absence of information about the target anomalies. They are not good at discovering spe-cific patterns caused by an anomalous event, especially in the case that such patterns reside in training data. As a solu-tion, we argue that instance-level labels are often easy to ac-quire by simply indicating the occurrence of any anomalous events, whereas acquiring point-level labels is hard in prac-tice. For example, given a time-series instance collected for a fixed period of time, a human annotator can easily figure out whether any anomalous events occurred or not during the period, then generate a binary label for the instance.
In this paper, we propose a novel deep learning frame-work, named as WETAS, which leverages WEak supervi-sion for Temporal Anomaly Segmentation. WETAS learns from labeled “instances” of temporal data in order to detect anomalous “segments” within the instance. The segment-level anomaly detection is more realistic than the point-level detection (Figure 1), because anomalous events usu-ally result in variable-length anomalous segments in tempo-ral data. The point-level detection cannot tell whether two nearby points detected as the anomaly come from a single anomalous event or not, and thus the continuity of detected points should be investigated for further interpretation of the results. Our problem setting is similar to the multiple-instance learning (MIL) [36] which learns from bag-level labels,1 but differs in that MIL makes predictions for static segments of the same length. Table 1 summarizes recent anomaly detection methods for temporal data.
WETAS fully exploits the instance-level (or weak) labels for training its model and also for inferring the sequential anomaly labels (i.e., pseudo-labeling) that can be used as rough segmentation masks. Based on dynamic time warp-ing (DTW) alignment [34] between an input instance and its sequential pseudo-label, WETAS effectively finds variable-length anomalous segments. To be specific, WETAS opti-mizes the model to accurately classify an input instance as its instance-level label, and simultaneously to best align the instance with its sequential pseudo-label based on the DTW. 1The term “multiple-instance” used in MIL refers to same-length tem-poral segments that compose a single bag. Thus, “instance” and “bag” in
MIL respectively correspond to “segment” and “instance” in our approach.
As the training progresses, the model generates more accu-rate pseudo-labels, and this eventually improves the model itself by the guidance for better alignment between inputs and their pseudo-labels.
Our extensive experiments on real-world datasets, in-cluding multivariate time-series and surveillance videos, demonstrate that WETAS successfully learns the nor-mal and anomalous patterns under the weak supervision.
Among various types of baselines, WETAS achieves the best performance in detecting anomalous points.
Fur-thermore, the qualitative comparison of the detection re-sults shows that point-level detection methods identify non-consecutive anomalous points even for a single event, whereas our framework obtains the smoothed detection re-sults which specify the starting and end points of each event. 2.