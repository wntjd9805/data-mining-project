Abstract
Domain adaptation for semantic segmentation enables to alleviate the need for large-scale pixel-wise annotations.
Recently, self-supervised learning (SSL) with a combina-tion of image-to-image translation shows great effectiveness in adaptive segmentation. The most common practice is to perform SSL along with image translation to well align a single domain (the source or target). However, in this single-domain paradigm, unavoidable visual inconsistency raised by image translation may affect subsequent learn-ing. In this paper, based on the observation that domain adaptation frameworks performed in the source and tar-get domain are almost complementary in terms of image translation and SSL, we propose a novel dual path learning (DPL) framework to alleviate visual inconsistency. Con-cretely, DPL contains two complementary and interactive single-domain adaptation pipelines aligned in source and target domain respectively. The inference of DPL is ex-tremely simple, only one segmentation model in the tar-get domain is employed. Novel technologies such as dual path image translation and dual path adaptive segmenta-tion are proposed to make two paths promote each other in an interactive manner. Experiments on GTA5→Cityscapes and SYNTHIA→Cityscapes scenarios demonstrate the su-periority of our DPL model over the state-of-the-art meth-ods. The code and models are available at: https:
//github.com/royee182/DPL. 1.

Introduction
In the past decades, significant progress [45, 4, 38, 35, 43, 31, 20] in semantic segmentation has been achieved with Deep Convolutional Neural Networks. The empirical observation [25, 39] demonstrates that the leading perfor-mance is partially attributed to a large volume of training data, thus dense pixel-level annotations are required in su-pervised learning, which is laborious and time-consuming.
To avoid this painstaking task, researchers resort to train
*Corresponding author (a) Illustration of adaptation in domain-T . (b) Illustration of adaptation in domain-S.
Figure 1: Illustration of single-domain adaptation pipelines. S is source image with ground-truth label YS , and T is target image. GS→T rep-resents image translation from domain-S to domain-T and vice versa.
S′ = GS→T (S) and T ′ = GT →S (T ) are translated images in the corresponding domain. MS and MT are semantic segmentation models in domain-S and domain-T , respectively. ˆYT and ˆYT ′ represent the cor-responding pseudo labels of T and T ′. Red dash rectangles denote that visual inconsistency raised by image translations disturbs domain adap-tation learning in either supervised part or SSL part. segmentation models on synthetic but photo-realistic large-scale datasets such as GTA5 [26] and SYNTHIA [27] with computer-generated annotations. However, due to the cross-domain differences, these well-trained models usually undergo significant performance drops when tested on re-alistic datasets (e.g., Cityscapes [6]). Therefore, unsuper-vised domain adaptation (UDA) methods have been widely adopted to align the domain shift between the rich-labeled source data (synthetic images) and the unlabeled target data (real images).
Two commonly used paradigms in unsupervised domain adaptive segmentation are image-to-image translation based methods [21, 9] and self-supervised learning (SSL) based methods [50, 49, 44, 12]. The most common practice for image-to-image translation based methods is to translate synthetic data from source domain (denote as domain-S) to target domain (denote as domain-T ) [9, 2] to reduce the visual gap between different domains. Then adaptive seg-mentation is trained on translated synthetic data. However, by only applying the image-to-image translation to domain adaptation task, the results are always unsatisfying. One of the leading factors is that image-to-image translation may change the image content involuntarily and introduce visual inconsistency between raw images and translated images.
Training on translated images with uncorrected ground-truth labels of source images introduces noise which dis-turbs the domain adaptation learning.
A combination of SSL and image-to-image transla-tion [16, 41, 15] has been demonstrated great effectiveness in the UDA field. SSL utilizes a well-trained segmentation model to generate a set of pseudo labels with high confi-dence for unlabeled target data, then the adaptive segmenta-tion training can be divided into two parallel parts, namely supervised part (training is performed on source data with ground-truth labels) and SSL part (training is performed on target data with pseudo labels). In this paradigm, the most prevalent practice is to perform adaptation to well align a single domain, i.e., either source domain (named domain-S adaptation) [16, 15] or target domain (named domain-T adaptation) [41]. However, both domain-S and domain-T adaptation heavily rely on the quality of image-to-image translation models, where visual inconsistency is always unavoidable. For domain-T adaptation (as shown in Fig-ure 1.(a)), visual inconsistency brings in misalignment be-tween translated source images and uncorrected ground-truth labels, which disturbs the supervised part. In contrast, domain-S adaptation (as shown in Figure 1.(b)) avoids im-age translation on source images, but simultaneously intro-duces visual inconsistency between target images and the corresponding translated images. Defective pseudo labels generated by unaligned images disturb the SSL part.
Notice the above single-domain adaptation pipelines are almost complementary in terms of the two training parts, i.e., visual inconsistency caused by image translation dis-turbs the training of supervised part in domain-T adapta-tion and SSL part in domain-S adaptation. In contrast, SSL part in domain-T adaptation and supervised part in domain-S adaptation are unaffected. It is natural to raise a ques-tion: could we combine these two complementary adapta-tion pipelines into a single framework to make good use of each strength and make them promote each other? Based on this idea, we propose the dual path learning framework which considers two pipelines from opposite domains to alleviate unavoidable visual inconsistency raised by image translations. We name two paths used in our framework as path-T (adaption is performed in domain-T ) and path-S (adaption is performed in domain-S), respectively. Path-S assists path-T to learn precise supervision from source data. Meanwhile, path-T guides path-S to generate high-quality pseudo labels which are important for SSL in re-turn. It is worth noting that path-S and path-T are not two separated pipelines in our framework, interactions between two paths are performed throughout the training, which is demonstrated to be effective in our experiments. The whole system forms a closed-loop learning. Once the training has finished, we only retain a single segmentation model well aligned in target domain for testing, no extra computation is required. The main contributions of this work are summa-rized as:
• We present a novel dual path learning (DPL) frame-work for domain adaptation of semantic segmenta-tion. DPL employs two complementary and interactive single-domain pipelines (namely path-T and path-S) in the training phase. In the testing, only a single seg-mentation model well aligned in target domain is used.
The proposed DPL framework surpasses state-of-the-art methods on representative scenarios.
• We present two interactive modules to make two paths promote each other, namely dual path image transla-tion and dual path adaptive segmentation.
• We introduce a novel warm-up strategy for the seg-mentation models which helps adaptive segmentation in the early training stage. 2.