Abstract
Dynamic inference networks, aimed at promoting com-putational efficiency, go along an adaptive executing path for a given sample. Prevalent methods typically assign a router for each convolutional block and sequentially make block-by-block executing decisions, without considering the relations during the dynamic inference. In this paper, we model the relations for dynamic inference from two aspects: the routers and the samples. We design a novel type of router called the relational router to model the relations among routers for a given sample.
In principle, the cur-rent relational router aggregates the contextual features of preceding routers by graph convolution and propagates its router features to subsequent ones, making the executing decision for the current block in a long-range manner. Fur-thermore, we model the relation between samples by intro-ducing a Sample Relation Module (SRM), encouraging cor-related samples to go along correlated executing paths. As a whole, we call our method the Relational Dynamic Infer-ence Network (RDI-Net). Extensive experiments on CIFAR-10/100 and ImageNet show that RDI-Net achieves state-of-the-art performance and computational cost reduction. 1.

Introduction
Recent years have witnessed a growing research inter-est in dynamic inference networks, which have been used in a wide range of applications, e.g., image classifica-tion [40, 51, 48, 1, 41], action recognition [21, 33], and object detection [55]. Dynamic inference networks, aimed at reducing computational redundancy, execute an adaptive path for a given sample at the inference time. A typical solution [40, 44, 51] is to assign a router to each convolu-tional block to decide whether the current block should be executed based on the output of the last block.
In essence, prevalent routers for dynamic inference make executing decisions in a short-range manner. Since a router
∗Corresponding author (a) Prevalent methods (b) Our proposed relational routers
Figure 1. Illustration of our relational routers. (a) The traditional router (circle) only considers the output features of the last block (rectangle). (b) With a relation graph, the proposed relational router aggregates the features of preceding routers and makes the executing decision in a long-range manner. In principle, the fur-ther the distance between routers, the less the effect from preced-ing routers to the current one. only takes the output of the last convolutional block as the input, an executing path is composed of a sequence of block-by-block executing decisions by individual routers.
In this way, the features of the preceding routers are ne-glected when a subsequent router makes executing decision.
Here arises a question: do the features of preceding routers benefit the decisions of subsequent ones? In this paper, we manage to explicitly model the relation between routers, en-abling routers to make decisions in a long-range manner.
We propose a novel relational router to relate the current router to others: a relational router aggregates the features of preceding routers and propagates its features to subse-quent ones. Specifically, the current relational router em-ploys a router-wise directed relation graph, taking a certain amount of preceding routers into account. In the relation graph, a node stands for a relational router, and a directed edge stands for the effect of a router on another router where the further the distance between routers, the less the effect.
Based on the relation graph, the current relational router
performs graph convolution [26] to aggregate the features of preceding routers and make an executing decision for the current convolutional block, as shown in Figure 1. In this way, routers make decisions in a long-range manner.
The relational routers mentioned above establish the re-lation between routers given a single sample. Furthermore, how about the relation between executing paths of different samples? It is intuitive that correlated samples should go along correlated executing paths. Therefore, we propose to introduce the correlation between samples to their executing paths, namely, making correlated samples go along corre-lated executing paths. However, because samples and their executing paths are distributed in distinct spaces [44], di-rectly regularizing on executing paths according to the dis-tance between samples is challenging. To address this prob-lem, we propose an alternative solution, making the ranking of executing paths consistent with that of the distance be-tween samples. Specifically, we present a Sample Relation
Module (SRM) that measures the distance between samples and regularizes their executing paths in triplets based on the ranking of the distance, i.e., the closer the distance, the more similar their executing paths.
As a whole, our proposed method, namely, the Rela-tional Dynamic Inference Network (RDI-Net), models the relation between routers and the relation between samples.
The main contributions are summarized as follows:
• We design a novel type of router called relational router for dynamic inference to aggregate and propagate fea-tures of historical routers so that executing decisions are made in a long-range manner.
• Considering different samples, we model their relation and regularize their executing paths to encourage corre-lated samples to go along correlated executing paths.
• Extensive experiments show that the proposed method obtains the state-of-the-art results w.r.t. performance and computational cost reduction. 2.