Abstract
Unsupervised domain adaptive person re-identification (UDA re-ID) aims at transferring the labeled source do-main’s knowledge to improve the model’s discriminability on the unlabeled target domain. From a novel perspective, we argue that the bridging between the source and target domains can be utilized to tackle the UDA re-ID task, and we focus on explicitly modeling appropriate intermediate domains to characterize this bridging. Specifically, we pro-pose an Intermediate Domain Module (IDM) to generate intermediate domains’ representations on-the-fly by mixing the source and target domains’ hidden representations us-ing two domain factors. Based on the “shortest geodesic path” definition, i.e., the intermediate domains along the shortest geodesic path between the two extreme domains can play a better bridging role, we propose two properties that these intermediate domains should satisfy. To ensure these two properties to better characterize appropriate in-termediate domains, we enforce the bridge losses on inter-mediate domains’ prediction space and feature space, and enforce a diversity loss on the two domain factors. The bridge losses aim at guiding the distribution of appropri-ate intermediate domains to keep the right distance to the source and target domains. The diversity loss serves as a regularization to prevent the generated intermediate do-mains from being over-fitting to either of the source and tar-get domains. Our proposed method outperforms the state-of-the-arts by a large margin in all the common UDA re-ID tasks, and the mAP gain is up to 7.7% on the challeng-ing MSMT17 benchmark. Code is available at https:
//github.com/SikaStar/IDM . 1.

Introduction
Person re-identification (re-ID) [1, 8, 53] aims to iden-tify the person across the non-overlapped cameras. Though fully supervised re-ID methods [41, 45, 3, 60] have achieved
*Corresponding Author.
Figure 1. Illustration of our main idea. Assuming that the source and target domains are located in a manifold, there can be some in-termediate domains along with the path between the two extreme domains. By utilizing appropriate intermediate domains to bridge the source and target, the source knowledge can be better trans-ferred to the target domain. Different colors and shapes represent different domains and different person identities respectively. great progress in recent years, it takes much time and effort to label the person images and thus can be difficult to be well applied to some practical scenarios. To overcome this problem, researchers have been focusing on studying unsu-pervised domain adaptive (UDA) re-ID [48, 13, 38, 2, 9], whose goal is to transfer the knowledge from the labeled source domain to improve the model’s discriminability on the unlabeled target domain. UDA re-ID is a challenging problem because the source and target domains can have two extreme distributions, and there can be no overlap be-tween the two domains’ label space. In this paper, we are devoted to studying the problem of UDA re-ID.
Though many existing methods [48, 13, 16] have made great progress in UDA re-ID, they have not explicitly con-sidered the bridging between the two extreme domains, i.e., what information about the similarity/dissimilarity of the two domains can be utilized to tackle the UDA re-ID task.
For example, GAN transferring methods [48, 10] use GANs to translate images’ style across domains and then focus on a single domain’s supervised feature learning. Fine-tuning methods [38, 13, 9] only use the source domain to obtain the pretrained model and then focus on the feature learning in the target domain. Joint training methods [70, 16] just com-bine the source and target data together for training. From
a novel perspective, we explicitly and comprehensively in-vestigate into the bridging between the source and target domains, and argue that using this bridging can help better adapt between two extreme domains in UDA re-ID.
In a spirit of the golden mean, we propose to use the deep model to learn intermediate domains which can bridge the source and target domains and thus ease the UDA re-ID task. The source domain’s knowledge is hard to be directly transferred to the target domain because there can be huge shift between the two extreme domains’ distributions. As shown in Figure 1, assuming the source and target domains are located in a manifold, an appropriate “path” may exist to bridge the two extreme domains along which the source domain’s knowledge can be smoothly transferred to guide the learning of the target domain. Specifically, the appro-priate intermediate domains should be located along with this “path” to help the gradual adaptation between the two extreme domains. For example, if an intermediate domain is closer to the source domain, the source reliable labels can be more leveraged. On the contrary, the target domain’s in-trinsic distribution can be more exploited.
To model the characteristics of appropriate intermediate domains, we propose a plug-and-play intermediate domain module (IDM). The IDM module can be plugged at any hid-den stage of a network, which will generate intermediate domains’ representations on-the-fly to gradually bridge the source and target domains in a joint training framework.
Specifically, the IDM module takes some hidden stage’s representations of the source and target domains as the in-put, and obtains two domain relevance variables that we call domain factors. We use these two domain factors to mix the hidden stage’s representations of both source and target do-mains, where the mixed representations can represent the characteristics of intermediate domains. All these represen-tations from the source, target and intermediate domains are fed into the network’s next stage on-the-fly.
However, there may be infinite intermediate domains when mixing the source and target domains, and only a part of these domains may be more helpful to smoothly adapt between the two extreme domains (the source and target domains).
Inspired by the traditional works [17, 19] that construct intermediate domains using kernel-based meth-ods in a manifold, we first propose the “shortest geodesic path” definition that the appropriate intermediate domains should lie on the shortest geodesic path connecting the source and target domains. From this definition, we fur-ther propose two properties where appropriate intermediate domains should satisfy: (1) Keep the right distance to the source and target domains. (2) Be diverse enough to balance the source and target domains’ learning and avoid being over-fitting to either of them. For the first property above, we enforce the bridge losses on both feature and prediction spaces of intermediate domains. For the second property, we propose a diversity loss by maximizing the standard de-viation of the domain factors generated by the IDM module.
By enforcing these losses on the learning of the IDM mod-ule, we can model the characteristics of appropriate inter-mediate domains to better transfer the source knowledge to improve the model’s discriminability on the target domain.
Our contributions can be summarized as follows. (1) To the best of our knowledge, we are the first to explicitly con-sider how to utilize the characteristics of intermediate do-mains as the bridge to better transfer the source knowledge to the target domain in UDA re-ID. Specifically, we pro-pose a plug-and-paly IDM module to generate intermediate domains on-the-fly, which will smoothly bridge the source and target domains to better adapt between the two extremes to ease the UDA re-ID task. (2) To make the IDM mod-ule learn more appropriate intermediate domains, we pro-pose two properties of these domains, and design the bridge losses and diversity loss to satisfy these properties. (3) Our method outperforms state-of-the-arts by a large margin on all the common UDA re-ID tasks. 2.