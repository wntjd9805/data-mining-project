Abstract
Real-world low-light images suffer from two main degra-dations, namely, inevitable noise and poor visibility. Since the noise exhibits different levels, its estimation has been implemented in recent works when enhancing low-light im-ages from raw Bayer space. When it comes to sRGB color space, the noise estimation becomes more complicated due to the effect of the image processing pipeline. Nevertheless, most existing enhancing algorithms in sRGB space only focus on the low visibility problem or suppress the noise under a hypothetical noise level, leading them impracti-cal due to the lack of robustness. To address this issue, we propose an adaptive unfolding total variation network (UTVNet), which approximates the noise level from the real sRGB low-light image by learning the balancing parame-ter in the model-based denoising method with total varia-tion regularization. Meanwhile, we learn the noise level map by unrolling the corresponding minimization process for providing the inferences of smoothness and fidelity con-straints. Guided by the noise level map, our UTVNet can recover finer details and is more capable to suppress noise in real captured low-light scenes. Extensive experiments on real-world low-light images clearly demonstrate the supe-rior performance of UTVNet over state-of-the-art methods. (a) Input (b) LIME [1] (c) LIME+NBNet [2] (d) NBNet+LIME (e) AGLLNet [3] (f) D&E [4] (g) MIRNet [5] (h) UTVNet (Ours) (i) Ground Truth
Figure 1. Performance in real captured low-light scene. (a) a sRGB image captured by a NikonD850 camera from ELD dataset [6]. (b-d) results of the luminance correction and denoising approaches. (f) and (g) are outputs of two recent methods without noise estima-tion. (e) the result of [3] trained on the synthetic low-light dataset (h) the result of proposed UTVNet. All to predict noise maps. images were cropped to make their details more visible. 1.

Introduction
The insufficient light provided by low-light scenarios is the main limitation of capturing high-quality photographs.
Besides enlarging the aperture and prolonging the exposure time to gather more light when taking images, another flex-ible solution is to increase the ISO setting of camera to ad-just the analog gain or both analog and digital gains as the compensation for the brightness. However, a higher ISO setting will decrease the signal-to-noise ratio (SNR). The
SNR should be carefully managed to control the noise for providing higher possibilities of post-processing [7]. Un-fortunately, such a manipulation is difficult for non-expert
*Corresponding author users who lack the appropriate photography skills.
Restoration of real-world low-light images is a challeng-ing process in computer vision, which focuses on recov-ering underlying clean images from observed noisy ones and correcting the luminance without amplifying the noise.
Most existing methods [1, 8, 9] focus on enhancing noise-free underexposed images. Such methods may solve the low visibility problem, but the noise will amplified when adjusting the exposure as shown in Fig. 1 (b). Meanwhile, existing denoising approaches [10, 11, 2] may fail to sup-press noise for low-light images, since most of them focus on images taken under normal luminance, the small mag-nitude between pixels in extremely low-light images hinder the detection of noise from details as shown in Fig. 1 (c, d).
As real-world low-light images exhibit different noise levels, recent low-light image restoration methods [4, 5] may lack of robustness without noise estimation as shown in Fig. 1 (f, g). In raw Bayer space, a physics-based noise formation model [6] has been proposed for low-light raw images. When converting raw data to sRGB, the distribu-tion of noise is affected by the image processing pipeline (ISP). Existing method [3] learned noise maps by synthetic low-light image dataset, but the efficiency is degraded by the inaccurate noise model and the gap between synthetic images and real photographs as shown in Fig. 1 (e).
In this paper, an adaptive unfolding total variation net-work (UTVNet) is presented to restore the extremely low-light images in sRGB space. To boost the robustness in real captured scenes, we approximate the noise level inspired by the relationship between the noise level and the balancing parameter in model-based image denoising method. Specif-ically, we formulate an adaptive total variation (TV) regu-larization by introducing a learnable noise level map that serves as the balancing parameters for each pixel to control the trade-off between noise reduction and detail preserva-tion. To learn the noise level map from the real low-light dataset, designing regularizers in loss function is infeasi-ble. Therefore, we unfold the TV minimization process via the Alternating Direction Method of Multiplier (ADMM)
[12] to separate the minimization problem into three sub-problems with closed-form solutions, which provides the inferences of fidelity and smoothness constraints for learn-ing the noise level map. Subsequently, a noise-free low-frequency layer is automatically generated along with the noise level map. Since the noise is smoothed out by the
TV regularization in the low-frequency layer, the luminance correction is applied in this layer to avoid noise amplifica-tion. Meanwhile, the noise suppression process is guided by the approximated noise level map in the high-frequency layer. The main contributions of this work are as follows:
• By integrating a learnable nois level map, we formu-late an adaptive TV regularization and propose a new noise level approximation method for real low-light photographs in sRGB color space.
• We propose an UTVNet that unfolds the total varia-tion minimization algorithms to provide fidelity and smoothness constraints to learn the noise level map without designing special loss function.
• UTVNet is robust in restoring the real captured low-light images with various noise levels. 2.