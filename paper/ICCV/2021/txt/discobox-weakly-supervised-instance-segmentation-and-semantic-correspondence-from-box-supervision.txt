Abstract
We introduce DiscoBox, a novel framework that jointly learns instance segmentation and semantic correspondence using bounding box supervision. Speciﬁcally, we propose a self-ensembling framework where instance segmentation and semantic correspondence are jointly guided by a struc-tured teacher in addition to the bounding box supervision.
The teacher is a structured energy model incorporating a pairwise potential and a cross-image potential to model the pairwise pixel relationships both within and across the box-es. Minimizing the teacher energy simultaneously yields reﬁned object masks and dense correspondences between intra-class objects, which are taken as pseudo-labels to su-pervise the task network and provide positive/negative cor-respondence pairs for dense contrastive learning. We show a symbiotic relationship where the two tasks mutually ben-eﬁt from each other. Our best model achieves 37.9% AP on
COCO instance segmentation, surpassing prior weakly su-pervised methods and is competitive to supervised methods.
We also obtain state of the art weakly supervised results on
PASCAL VOC12 and PF-PASCAL with real-time inference. 1.

Introduction
The ability to localize and recognize objects is at the core of human vision. This has motivated the vision community to study object detection [1] as a fundamental visual recog-nition task. Instance segmentation [2] is further introduced on top of detection to predict the foreground object masks, thus enabling localization with pixel-level accuracy. More recently, a growing number of works aim to lift the above tasks to the 3D space [3–7]. As a result, landmark [3,8] and (semantic) correspondence [9–30] have been widely stud-ied to associate object parts across different views. These methods have become critical components in pose estima-tion [31–34] and reconstruction [35–38] because they help
∗Work done during an internship at NVIDIA Research.
†Corresponding author: <zhidingy@nvidia.com>.
Figure 1. Task overview. Given a pair of images, DISCOBOX si-multaneously outputs detection, instance segmentation and seman-tic correspondence predictions. Best viewed in color. to reduce uncertainties through additional constraints, such as determining camera poses and viewpoints [31, 36].
Among various correspondence tasks, semantic corre-spondence aims to establish the associations across differ-ent scenes and object instances, and is arguably the most challenging one due to large variations in appearance and pose. The literature of semantic correspondence and in-stance segmentation have largely remained decoupled. For instance, the main semantic correspondence benchmark-s [19,39–43] have been focusing on object-centric scenarios which de-emphasizes the role of object localization, while the latest instance segmentation methods do not make use of intra-class correspondences. However, these seemingly separate problems can beneﬁt from each other because as-sociating object parts requires understanding the object of interest a priori. Similarly, knowing the semantic parts of an object requires understanding the geometry of functional parts and can improve object localization [44, 45].
Even though the advantage of learning correspondences and instance segmentation jointly is clear, many state of the art methods do not make use of this approach due to the lack of large scale datasets with both masks and cor-respondences. To overcome this challenge, weakly super-vised methods have been recently introduced to relax the need for costly supervision in both tasks [25–30, 46–49].
Our work is aligned with these efforts as we aim to address instance segmentation and semantic correspondence jointly with inexpensive bounding box supervision. This allows us to effectively push the boundaries with more data.
More importantly, box supervision presents a principled way to couple the above two tasks: First, instance segmen-tation greatly extends the capability of semantic correspon-dence to handle multi-object scenarios. This allows one to deﬁne a more generalized and challenging semantic corre-spondence task where the performance emphasizes both the quality of object-level correspondence and the accuracy of object localization. Second, multi-tasking provides the mu-tual constraints to overcome trivial solutions in box super-vision. Indeed, our study shows a symbiotic relation where localization beneﬁts correspondence via improved locality and representation, whereas correspondence in turn helps localization with additional cross-image information.
We propose DISCOBOX, a framework which instantiates the above targets as shown in Fig. 1. DISCOBOX leverages various levels of structured knowledge and self-supervision both within and across images to reduce the uncertainties.
Summary of contributions:
• Our work is the ﬁrst to propose a uniﬁed framework for joint weakly supervised instance segmentation and se-mantic correspondence using bounding box supervision.
• We propose a novel self-ensembling framework where a teacher is designed to promote structured inductive bias and establish correspondences across objects. We show that the proposed framework allows us to jointly exploit both intra- and cross-image self-supervisions and leads to signiﬁcantly improved task performance.
• We achieve state-of-the-art performance on weakly su-pervised instance segmentation. Our best model achieves 37.9% AP on COCO test-dev, surpassing competitive su-pervised methods such as YOLACT++ [50] (34.6% AP) and Mask R-CNN [51] (37.1% AP).
• We also achieve state-of-the-art performance on weakly supervised semantic correspondence, and are the ﬁrst to propose a multi-object benchmark for this task.
Task network. Our task network contains an instance segmentation backbone with a multiple instance learning head. The module is supervised by bounding boxes which contain rich object information. Through multiple instance learning, coarse object masks naturally emerge as network attention, and is taken by the teacher as initial predictions.
Teacher model. The teacher is deﬁned by a Gibbs en-ergy which comprises a unary potential, a pairwise poten-tial and a cross-image potential. The unary potential takes the initial output from the student whereas the pairwise and cross-image potentials model the pairwise pixel relation-ships both within and across bounding boxes. Minimizing the teacher energy promotes contrast-sensitive smoothness while establishing dense correspondence across the object-s. This allows one to consider cross-image self-supervision where correspondence provides positive and negative pairs for dense contrastive learning. We show that this in turn can improve the quality of instance segmentation.
Our promising results indicate the possibility to com-pletely remove mask labels in future instance segmentation problems. We also envisage the wide beneﬁt of DISCOBOX to many downstream applications, particularly 3D tasks. 2.