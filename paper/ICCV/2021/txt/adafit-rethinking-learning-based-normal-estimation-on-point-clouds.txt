Abstract
This paper presents a neural network for robust nor-mal estimation on point clouds, named AdaFit, that can deal with point clouds with noise and density variations.
Existing works use a network to learn point-wise weights for weighted least squares surface ﬁtting to estimate the normals, which has difﬁculty in ﬁnding accurate normals in complex regions or containing noisy points. By ana-lyzing the step of weighted least squares surface ﬁtting, we ﬁnd that it is hard to determine the polynomial order of the ﬁtting surface and the ﬁtting surface is sensitive to outliers. To address these problems, we propose a simple yet effective solution that adds an additional offset predic-tion to improve the quality of normal estimation. Further-more, in order to take advantage of points from different neighborhood sizes, a novel Cascaded Scale Aggregation layer is proposed to help the network predict more accu-rate point-wise offsets and weights. Extensive experiments demonstrate that AdaFit achieves state-of-the-art perfor-mance on both the synthetic PCPNet dataset and the real-word SceneNN dataset. The code is publicly available at https://github.com/Runsong123/AdaFit. 1.

Introduction
In point cloud processing, a fundamental task is to ro-bustly estimate surface normals from point clouds, which plays a key role in many practical applications, such as sur-face reconstruction [1], registration [2], segmentation [3], primitive ﬁtting [4], reverse engineering [5] and grasp-ing [6]. Due to the presence of noise, point density vari-ations, and missing structures, robust and accurate surface normal estimation on point clouds remains challenging.
The most direct way for normal estimation is to regress the normal vector from the feature extracted on neighbor-*Equal contribution
†Corresponding authors: [dongzhenwhu,bshyang]@whu.edu.cn
Figure 1. (a) Given the input point cloud (left), our target is to es-timate a normal for every point (right). (b) Current weighted least square surface ﬁtting is severely affected by underﬁtting (top), overﬁtting (middle) or outliers (bottom), which leads to inaccurate normal estimation. (c) The error maps of two normal estimation methods. The ﬁrst model only uses the weighted least square sur-face ﬁtting (left) while the second model adds additional offsets to adjust the distribution of neighboring points, which produces a more accurate normal estimation. (d) The reconstructed surfaces using normals from the model with weights only (left) and the model with weights and offsets (right). ing points [7, 8, 9, 10, 11, 12]. However, such brute-force regression only forces the network to memorize normal vec-tors, which leads to limited generalization ability. This generalization problem becomes more severe on real-world data due to the scarcity of training data.
Rather than direct regression, a more accurate approach to estimate the normal for a speciﬁc point is to ﬁt a geomet-ric surface (plane or polynomial surface) on its neighboring points and then compute the normal from the estimated sur-face. Since the estimated surface is usually sensitive to the noise or outliers present in the neighborhood, most exist-ing methods [13, 14, 15] use weighted surface ﬁtting which predicts point-wise weights to control the contribution of every neighboring point to the ﬁnal surface. The focus of these works is to obtain more accurate point-wise weights that can reduce the effects of noisy points and outliers as possible. Though substantial improvements on normal es-timation have been achieved by using a neural network to
learn a more accurate weight [13, 15] in a data-driven man-ner, the estimated normals are still not accurate in complex regions as shown in Fig. 1 (c).
In this paper, we conduct an analysis on the widely-used weighted surface ﬁtting for normal estimation and ﬁnd two inherent problems in this approach. The ﬁrst is brought by the inconsistent polynomial orders between the true surface and the ﬁtted surface. The underlying surfaces of different points usually have different polynomial orders while cur-rent methods always choose a constant order for all points, e.g. plane in [15] or 3-jet in [13]. Such inconsistency either results in an underﬁtting, which smooths out the ﬁne details in the neighborhood shown in the top of Fig. 1 (b), or over-ﬁtting to noise, which brings a large variance to the output normal shown in the middle of Fig. 1 (b). Both the over-ﬁtting and underﬁtting may result in an erroneous normal estimation. The other problem is that the weighted surface
ﬁtting is sensitive to outliers. By theoretically analyzing the relationship between point-wise weights and the ﬁnal esti-mated normal, we ﬁnd that the weight on a point far away from the ﬁtted surface will have a larger impact on the ﬁnal normal direction. In this case, since outliers are much far away from the ﬁtted surface than inlier points, even small weights on outliers will thoroughly mess up the estimated normals, as shown in the bottom of Fig. 1 (b).
To address the above two problems, we propose a sim-ple yet effective solution by predicting additional point-wise offsets to adjust the distribution of the neighboring points.
When the underlying surface has a different polynomial or-der from the predeﬁned one, the adjustment brings more
ﬂexibility to the network to project neighboring points onto a surface with the predeﬁned order. Though the resulted sur-face may not be precisely consistent with the ground truth one, the normal of the center point is much more accurate than the one estimated by the direct weighted surface ﬁtting.
Meanwhile, the outliers in the neighborhood can be offset to a position near the resulted surface such that all points will have similar distances to the surface. Thus, in com-parison with the weighted surface ﬁtting where the weights of outliers have larger impacts on the normal, points con-tribute more evenly after the adjustment, which leads to a more robust normal estimation.
Another challenge is the selection of optimal neighbor-hood size in the surface ﬁtting. Here, we call the neighbor-hood size as scale. A large scale containing more points will provide more information about the underlying surface but may include irrelevant points which easily leads to over-smoothing sharp edges. A small scale only contains a small set of most relevant points thus may improve the accuracy of the normal estimation but is unavoidably sensitive to noise.
The scale is a very sensitive hyperparameter that requires a carefully tuning for an accurate normal estimation [13, 15].
To address the problem of the scale selection, we use a novel architecture design called Cascaded Scale Aggrega-tion (CSA) layer. With several CSA layers, we can extract features from the large scale while only ﬁt the surface with neighboring points in a small scale. Thus, using CSA layer for feature extraction enjoys the beneﬁts from both the large scale, which brings more information about the surface, and the small scale, which results in a more accurate normal es-timation.
To this end, we implement our idea by designing a net-work called AdaFit, which takes a query point with its neighboring points as input and outputs the normal of the query point. AdaFit extracts features with CSA layers and simultaneously predicts point-wise weights and offsets.
Then, the predicted weights are used to ﬁt a polynomial sur-face of order 3 on these offset neighboring points. Finally, the output normal is computed from the ﬁtted surface.
To validate the proposed method, we conduct extensive experiments on the widely-used PCPNet dataset [7]. The results show that the proposed AdaFit achieves state-of-the-art performance on this benchmark. To show the generaliza-tion ability of our AdaFit, we evaluate it on two real-world datasets, the indoor SceneNN [16] dataset and the outdoor
Semantic 3D [17] dataset. Without any further training,
AdaFit signiﬁcantly outperforms baselines by a large mar-gin on these two datasets. Furthermore, we demonstrate the applications of the normals predicted by AdaFit on the point cloud denoising and the surface reconstruction.
Our contributions are summarized as follows:
• We provide a comprehensive analysis on the weighted surface ﬁtting and ﬁnd two critical problems of these methods in normal estimation.
• We propose to predict offsets to adjust the distribution of neighboring points which brings more robustness and accuracy in normal estimation.
• We design the network AdaFit with novel CSA lay-ers to enjoy beneﬁts from both small and large scales, which achieves improved performance in multiple standard datasets. 2.