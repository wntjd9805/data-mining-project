Abstract
Recently, the generalization behavior of Convolutional
Neural Networks (CNN) is gradually transparent through explanation techniques with the frequency components de-composition. However, the importance of the phase spec-trum of the image for a robust vision system is still ig-nored. In this paper, we notice that the CNN tends to con-verge at the local optimum which is closely related to the high-frequency components of the training images, while the amplitude spectrum is easily disturbed such as noises or common corruptions. In contrast, more empirical stud-ies found that humans rely on more phase components to achieve robust recognition. This observation leads to more explanations of the CNN’s generalization behaviors in both robustness to common perturbations and out-of-distribution detection, and motivates a new perspective on data aug-mentation designed by re-combing the phase spectrum of the current image and the amplitude spectrum of the dis-tracter image. That is, the generated samples force the
CNN to pay more attention to the structured information from phase components and keep robust to the variation of the amplitude. Experiments on several image datasets in-dicate that the proposed method achieves state-of-the-art performances on multiple generalizations and calibration tasks, including adaptability for common corruptions and surface variations, out-of-distribution detection, and adver-sarial attack. The code is released on github/iCGY96/APR. 1.

Introduction
In the past few years, deep learning has achieved even surpassed human-level performances in many image recog-nition/classification tasks [15]. However, the unintuitive generalization behaviors of neural networks, such as the vulnerability towards adversarial examples [11], common corruptions [20], the overconfidence for out-of-distribution
*Corresponding author
Figure 1. More empirical studies found that humans rely on more phase components to achieve robust recognition However, CNN without effective training restrictions tends to converge at the local optimum related to the amplitude spectrum of the image, leading to generalization behaviors counter-intuitive to humans. (OOD) [19, 22, 38, 3, 2], are still confused in the commu-nity. It also leads that current deep learning models depend on the ability of training data to faithfully represent the data encountered during deployment.
To explain the generalization behaviors of neural net-works, many theoretical breakthroughs have been made progressively by different model or algorithm perspectives
[49, 39, 41]. Several works [46, 24] investigate the general-ization behaviors of Convolutional Neural Network (CNN) from a data perspective in the frequency domain, and demonstrate that CNN benefits from the high-frequency im-age components which are not perceivable to humans. Fur-thermore, a quantitative study is provided in Figure 4 to in-dicate that the predictions of CNN are more sensitive to the variation of the amplitude spectrum. The above phenomena indicate that CNN tends to converge at the local optimum which is closely related to the high-frequency components of the training images. Although it is helpful when the test and training samples come from the identical distribution, yet the robustness of the CNN will be affected due of the amplitude spectrum is easily disturbed such as noises or common corruptions. On the other hand, earlier empirical
studies [32, 10, 13, 28] indicate that humans rely on more the components related to the phase to recognize an object.
As is known, the human eye is much more robust than CNN, and this fact encourages us to rethink the influence of am-plitude and phase on CNN’s generalizability. A visualized example is shown in Figure 2 to validate the importance of phase spectrum in [32] to explain one counter-intuitive be-havior of CNN. By replacing the amplitude spectrum of one
Revolver with the amplitude spectrum of one Jigsaw Puz-zle, the CNN classifies the fused image as Jigsaw Puzzle while humans could still recognize it as Revolver. In this example, the prediction outcomes of CNN are almost en-tirely determined by the amplitude spectrum of the image, which is barely perceivable to humans. On the other hand, even if the amplitude spectrum is replaced, the human is able to correctly recognize the identical object in the origi-nal picture. Moreover, we found that this phenomenon not only exists in training data (in-distribution) but also in OOD data as shown in Figure 3. In these images, after exchang-ing the amplitude spectrum, the prediction of CNN is also transformed with the label of the amplitude spectrum. How-ever, humans could still observe the object structure of the original images in the converted images.
Motivated by the powerful generalizability of the human, we argue that a robust CNN should be insensitive to the change of amplitude and pay more attention to the phase spectrum. To achieve this goal, a novel data augmentation method, called Amplitude-Phase Recombination (APR), is proposed. The core of APR is to re-combine the phase spectrum of the current image and the amplitude spectrum of the distracter image to generate a new training sample, whose label is set to the current image. That is, the gen-erated samples force the CNN to capture more structured information from phase components rather than amplitude.
Specifically, the distracter image of the current image comes in two ways: other images and its augmentations generated by existing data augmentation methods such as rotate and random crop, namely APR for the pair images (APR-P) and
APR for the single image (APR-S) respectively.
Extensive experiments on multiple generalizations and calibration tasks, including adaptability for common cor-ruptions and surface variations, OOD detection, and adver-sarial attack, demonstrate the proposed APR outperforms the baselines by a large margin. Meanwhile, it provides a uniform explanation to the texture bias hypothesis [9] and the behaviors of both robustness to common perturba-tions and the overconfidence of OOD by the CNN’s over-dependence on the amplitude spectrum. That is, the various common perturbations change the high-frequency ampli-tude components significantly, while has little influence on the components related to the phase spectrum. Hence, the attack sample could confuse the CNN but is easily recog-nized by humans. On the other hand, the OOD samples of-Figure 2. An example of the importance of phase spectrum to ex-plain the counter-intuitive behavior of CNN. The recombined im-age with the phase spectrum of Revolver and the amplitude spec-trum of Jigsaw Puzzle is recognized as Jigsaw Puzzle by CNN.
However, the human can still clearly recognize it as a Revolver. ten exhibit totally different image structures but may share some similarities in the high-frequency amplitude compo-nents, which makes the CNN hard to distinguish.
Our main contributions are summarized as follows: 1)
We propose that a robust CNN should be robust to the am-plitude variance and pay more attention to the components related to the phase spectrum by a series of quantitative and qualitative analysis, 2) a novel data augmentation method
APR is proposed to force the CNN pay more attention to the phase spectrum and achieves state-of-the-art performances on multiple generalizations and calibration tasks, including adaptability for common corruptions and surface variations,
OOD detection, and adversarial attack, and 3) a unified ex-planation is provided to the behaviors of both robustness to common perturbations and the overconfidence of OOD by the CNN’s over-dependence on the amplitude spectrum. 2.