Abstract
Few-shot object detection (FSOD) aims to detect never-seen objects using few examples. This ﬁeld sees recent im-provement owing to the meta-learning techniques by learn-ing how to match between the query image and few-shot class examples, such that the learned model can general-ize to few-shot novel classes. However, currently, most of the meta-learning-based methods perform parwise match-ing between query image regions (usually proposals) and novel classes separately, therefore failing to take into ac-count multiple relationships among them. In this paper, we propose a novel FSOD model using heterogeneous graph convolutional networks. Through efﬁcient message passing among all the proposal and class nodes with three differ-ent types of edges, we could obtain context-aware proposal features and query-adaptive, multiclass-enhanced prototype representations for each class, which could help promote the pairwise matching and improve ﬁnal FSOD accuracy. Ex-tensive experimental results show that our proposed model, denoted as QA-FewDet, outperforms the current state-of-the-art approaches on the PASCAL VOC and MSCOCO FSOD benchmarks under different shots and evaluation metrics. 1.

Introduction
Figure 1. Overview of our proposed few-shot object detection (FSOD) method. (a) Previous meta-learning-based FSOD method.
These methods aim to learn how to match between the regions (usually proposals) in the query image and few-shot class exam-ples. Note that the key module, the matching network, will be repeatedly applied on each proposal and class pair. (b) Built upon the meta-learning-based approach, our method proposes a novel heterogeneous GCNs module with three different types of edges, allowing efﬁcient message passing among all the nodes. (c) Three types of edges used in our model.
With abundant annotated training examples of objects, deep neural networks are tailored to extract commonalities and detect object instances accordingly. However, such meth-ods tend to over-ﬁt when there are only a few examples avail-able. On the other hand, having seen many similar objects, humans can recognize a novel object when shown only a few examples of it. Inspired by humans’ outstanding ability to generalize knowledge, few-shot object detection aims to detect novel object instances in an image given a few ex-amples of the novel object (a.k.a novel class) and abundant examples of other objects (a.k.a base classes).
Although object detection methods like Faster-RCNN
[31] work extremely well on data-abundant base classes, it is non-trivial to adapt the model to few-shot novel classes.
This is mainly because the softmax classiﬁer used in R-CNN is tasked to perform classiﬁcation among foreground classes and reject background regions at the same time. However, the notion of background changes when we adapt the model to novel classes. Typically, there are two approaches address-ing this problem. One approach [37, 40] is to use long-tailed learning methods for training on the unbalanced dataset, but the generalization ability of such model is still limited. The other approach [3, 29, 39, 14] is to use meta-learning method to learn a class-agnostic few-shot detector on base classes, which can be easily adapted to novel classes without addi-tional training. The simple framework and high detection
accuracy make the meta-learning-based approach a promis-ing choice for FSOD.
The key of these meta-learning approaches is to learn how to match between the regions (usually RPN proposals [31]) in the query image and few-shot class examples. This is achieved by learning a class-agnostic matching network with a binary classiﬁer. The two inputs are the proposal feature extracted from an image [6] and the prototype representation
[32] of a few-shot class. The matching network will then be repeatedly applied on every proposal and class pair. How-ever, there are three potential limits in this approach. Firstly, this kind of method turns out to be a ‘single-class’ detector, without modeling multi-class relations. This is important especially when there are base classes similar to the novel class as we could ‘borrow’ robust features from these classes.
Secondly, since the class prototype is extracted only from the few-shot examples, there could potentially be a huge dis-crepancy between the extracted prototype and the proposal feature, considering the wide variety of objects and their different image statistics. Thirdly, proposals could be noisy and may not contain complete objects. Current methods do not consider the contextual information in the image for matching.
To address these three challenges, we propose a novel
GCN-based FSOD model, denoted as QA-FewDet (Query-Adaptive Few-Shot Object Detection), which utilizes graph propagation to learn context-aware proposal features and query-adaptive, multiclass-enhanced class prototypes. As shown in Fig. 1, we construct a graph among the proposal and class nodes for efﬁcient class-class, class-proposal, and proposal-proposal communications. Firstly, by connecting different classes (including base classes) through the class-class edge, our method can model multi-class relations and enhance novel-class prototypes with prototypes from other similar classes. Secondly, the class-proposal edge provides mutual adaptation between class prototypes and proposal features and therefore reduces the distribution discrepancy between the two features. Meanwhile, it could provide addi-tional examples of the class from proposals belonging to that class. Thirdly, the proposal-proposal edge provides both local and global contextual information to help classiﬁcation and bounding box localization.
The naive way of graph construction is to include all pro-posals and classes in a single graph. However, such a graph is memory-expensive and inefﬁcient for message passing.
To better incorporate these three types of edges in our model, as shown in Fig. 1, we propose a novel heterogeneous graph consisting of a query-agnostic Inter-Class Subgraph, and multiple class-speciﬁc Intra-Class Subgraphs for each query image. The two subgraphs are processed sequentially for efﬁcient message passing among all the nodes.
The entire network can be learned end-to-end using episode-based training on the abundant base-class data. To show the effectiveness of our model, we conduct compre-hensive experiments on two widely-used FSOD benchmarks.
The results show that our QA-FewDet surpasses the current
SOTAs by a huge margin under different shots and metrics.
Our contributions are 1) To our knowledge, we are the
ﬁrst to propose a graph model that considers class-class, class-proposal, and proposal-proposal relations in few-shot object detection, 2) we propose a novel heterogeneous graph structure that allows efﬁcient message passing among all the nodes, 3) our model achieves signiﬁcantly better results than current state-of-the-art methods on the PASCAL VOC and
MSCOCO FSOD benchmarks across various settings. 2.