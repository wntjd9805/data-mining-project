Abstract
Although CNNs have achieved remarkable progress on the shadow detection task, they tend to make mistakes in dark non-shadow regions and relatively bright shadow re-gions. They are also susceptible to brightness change.
These two phenomenons reveal that deep shadow detec-tors heavily depend on the intensity cue, which we refer to
In this paper, we propose a novel fea-as intensity bias. ture decomposition and reweighting scheme to mitigate this intensity bias, in which multi-level integrated features are decomposed into intensity-variant and intensity-invariant components through self-supervision. By reweighting these two types of features, our method can reallocate the atten-tion to the corresponding latent semantics and achieves bal-anced exploitation of them. Extensive experiments on three popular datasets show that the proposed method outper-forms state-of-the-art shadow detectors. 1.

Introduction
Shadows may appear when lights cannot directly reach an object surface. While they provide cues on light source directions and scene illuminations, which facilitate scene understanding [20, 22], they may adversely affect the per-formance of computer vision tasks [7, 28]. Hence, shadow detection is crucial.
Earlier, many works were proposed to detect shadows using hand-crafted features. However, these methods are unreliable and may fail in complex scenes. Recently, deep learning based shadow detection methods have shown supe-rior performance over traditional methods by a large mar-gin. Being trained in an end-to-end manner, deep shadow detectors can automatically learn discriminative features for detection, without the efforts to specify which cues to use and how they should be represented. However, there is a cost to this convenience. There are signs that existing deep shadow detectors heavily rely on the intensity cue. While they may mis-recognize relatively bright shadow regions
†Ke Xu and Rynson Lau are joint corresponding authors. Rynson Lau leads this project. (a) Input Image (b) DSC [16] (c) DSD [50] (d) MTMT [5] (e) Ours (f) GT
Figure 1. Intensity bias in shadow detection. Rows 1 and 3 show two original images, while rows 2 and 4 show the two images with 20% increase in intensity. Existing methods [16, 50, 5] heavily rely on the intensity cue, and suffer from two problems. On the one hand, they mis-recognize a relatively brighter region inside the shadow as non-shadow (e.g., yellow lanes in row 1), and dark non-shadow region as shadow (e.g., the trafﬁc cone in row 3). On the other hand, their predictions change signiﬁcantly due to the brightness change (rows 2 and 4). Our method mitigates this in-tensity bias and produces more consistent and accurate results. as non-shadows (Fig. 1 row 1) or dark non-shadow regions as shadows (Fig. 1 row 3), with a small shift in brightness (which should not change the image semantics), the detec-tion results may change signiﬁcantly (Fig. 1 rows 2 and 4).
Although low intensity is a strong indication of shadows, other cues such as object-shadow correspondences, shadow edges, and region connectivity may also contribute to the shadow detection task [33]. However, deep models tend to be attracted by some dominant cues while leaving the less dominant ones underexplored. For example, Geirhos et al. [12] show that ImageNet-trained classiﬁers typically have a bias towards textures, and increasing the attention to shapes helps improve classiﬁcation accuracy and robust-ness. Choi et al. [6] also show that reducing scene bias improves the generalization of action recognition networks.
To mitigate such a bias towards the intensity cue in shadow detection, the most straightforward solution is to
ing scheme to mitigate the intensity bias in shadow de-tection, which allows our shadow detector to reallocate its attention between the intensity-variant and intensity-invariant features.
• We propose a novel self-supervised approach, which is tailored for shadow detection, to guide the decomposition of deep features.
• Extensive experiments on three public datasets demon-strate that the proposed method outperforms state-of-the-art shadow detection methods. 2.