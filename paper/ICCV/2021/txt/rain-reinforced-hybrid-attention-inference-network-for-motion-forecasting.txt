Abstract
Motion forecasting plays a signiﬁcant role in various do-mains (e.g., autonomous driving, human-robot interaction), which aims to predict future motion sequences given a set of historical observations. However, the observed elements may be of different levels of importance. Some informa-tion may be irrelevant or even distracting to the forecasting in certain situations. To address this issue, we propose a generic motion forecasting framework (named RAIN) with dynamic key information selection and ranking based on a hybrid attention mechanism. The general framework is in-stantiated to handle multi-agent trajectory prediction and human motion forecasting tasks, respectively. In the former task, the model learns to recognize the relations between agents with a graph representation and to determine their relative signiﬁcance.
In the latter task, the model learns to capture the temporal proximity and dependency in long-term human motions. We also propose an effective double-stage training pipeline with an alternating training strat-egy to optimize the parameters in different modules of the framework. We validate the framework on both synthetic simulations and motion forecasting benchmarks in different domains, demonstrating that our method not only achieves state-of-the-art forecasting performance, but also provides interpretable and reasonable hybrid attention weights. 1.

Introduction
Motion forecasting has been widely studied in various domains, such as physical systems, human skeletons, and multi-agent interacting systems (e.g., trafﬁc participants, sports players, etc). The problem is formulated as to pre-dict future states or trajectories based on historical spatio-temporal observations. However, the observed information may be of different levels of signiﬁcance and in some situ-ations not all the information is relevant for the forecasting.
*Work done during Jiachen’s internship at Honda Research Institute.
Figure 1. A high-level diagram of the proposed general prediction framework with key information/element selection and ranking, which consists of two major parts: an RL-based hard attention mechanism to discriminate key information from complete obser-vations and a soft attention mechanism to further ﬁgure out relative signiﬁcance of the key information. The whole procedure can be iteratively applied over time with a sliding window to enable dy-namic selection of key information to adapt to evolving situations.
Moreover, the key information may be varying as the situ-ation evolves, which motivates the forecasting approach to dynamically adjust its attention to different subsets of obser-vations. Here we provide two illustrative real-world exam-ples where key information is naturally selected based on ei-ther spatial relations or temporal dependencies. An on-road vehicle usually only needs to pay attention to the trafﬁc par-ticipants that are interacting or having a conﬂict with itself, so only a subset of observations are indeed relevant when predicting its future behavior. For human motion forecast-ing, it is observed that humans tend to repeat their motions, which motivates dynamic attention to different segments of previous motions given the current observation.
Attention mechanisms have been widely adopted to learn the relative importance of elements. There are two major types of attention mechanisms in literature: soft attention and hard attention [63]. The soft attention is usually per-formed by applying a score function to input features fol-lowed by a softmax function to obtain the attention weights in the range of [0, 1]. These operations are fully differen-tiable which can be trained by back-propagation with typi-cal gradient-based optimizers. However, the softmax func-tion tends to assign non-zero attention weights to irrele-vant or unimportant elements, which dilutes the attention given to the truly signiﬁcant information [47, 54]. In con-trast, the hard attention mechanism can force the model to only pay attention to the relevant information while discard the others entirely to reduce information redundancy. The hard attention weights can be only binary: 0 (discarded) or 1 (retained). However, the hard attention is not differ-entiable due to the argmax operation, which needs to be optimized by reinforcement learning (RL) algorithms (e.g., deep Q-learning [41], policy gradient [60]). Recently, some alternatives to the traditional hard attention have been pro-posed based on the approximation of evidence lower bound (ELBO) [38], which can be trained end-to-end.
The general idea of selecting the most important infor-mation/elements with hard attention has been applied to several different domains, such as computer vision and nat-ural language processing. Wu et al [62] introduced a key frame selection framework based on multi-agent reinforce-ment learning for video based human activity recognition.
Wang et al [55] presented a framework for informative view selection from multiple indoor cameras to recognize human actions. Gao et al [14] proposed a hard and channel-wise at-tention network for graph representation learning. Shen et al [47] illustrated a reinforced self-attention network to ﬁg-ure out sparse dependencies between tokens in a sentence.
However, the efﬁcacy of hard attention in motion fore-casting tasks, to the best of our knowledge, still remains largely unexplored so far. Besides, many existing works including the aforementioned ones, pre-deﬁne a ﬁxed num-ber of elements to pay attention to, which may be unsat-isfactory in the scenarios where the amount of key infor-mation/elements is varying. For example, the motion of a certain entity in an interacting system may be affected by a varying number of entities at different time, thus a ﬁxed number of selected elements may be redundant or insufﬁ-cient in different situations. To address this issue, we pro-pose a reinforcement learning based hard attention mech-anism for motion forecasting, which does not enforce any constraints on the amount of key elements. It is even possi-ble in some situations that no element or all the elements are selected based on their signiﬁcance. In the multi-agent set-ting with a graph representation, learning hard attention can also be treated and interpreted as graph structure/topology learning [12,32]. Since the selected key information may be still at different levels of importance, we propose to employ soft attention as a ranking mechanism to further discrimi-nate relative importance.
To the best of our knowledge, we are the ﬁrst to propose a hybrid attention based framework for motion forecasting, which is illustrated in Figure 1. The main contributions of this paper are summarized as:
We propose a general motion forecasting framework
• (named RAIN) with dynamic key information/element se-lection and ranking via a hybrid attention mechanism.
•
We propose an effective double-stage training pipeline with an alternating training strategy to improve different modules in the framework alternatively.
•
We instantiate the general framework and propose a novel graph-based model for multi-agent trajectory fore-casting. We also demonstrate the general idea on human skeleton motion forecasting, where a state-of-the-art model
[59] is employed as a part of our framework. We validate the proposed framework on both domains and our method achieves the state-of-the-art performance consistently. 2.