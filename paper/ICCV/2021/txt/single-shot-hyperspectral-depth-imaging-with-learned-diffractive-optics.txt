Abstract
Imaging depth and spectrum have been extensively stud-ied in isolation from each other for decades. Recently, hyperspectral-depth (HS-D) imaging emerges to capture both information simultaneously by combining two differ-ent imaging systems; one for depth, the other for spec-trum. While being accurate, this combinational approach induces increased form factor, cost, capture time, and align-ment/registration problems.
In this work, departing from the combinational principle, we propose a compact single-shot monocular HS-D imaging method. Our method uses a diffractive optical element (DOE), the point spread func-tion of which changes with respect to both depth and spec-trum. This enables us to reconstruct spectrum and depth from a single captured image. To this end, we develop a differentiable simulator and a neural-network-based recon-struction method that are jointly optimized via automatic differentiation. To facilitate learning the DOE, we present a first HS-D dataset by building a benchtop HS-D imager that acquires high-quality ground truth. We evaluate our method with synthetic and real experiments by building an experimental prototype and achieve state-of-the-art HS-D imaging results. 1.

Introduction
Spectral information is crucial for a plethora of applica-tions in the fields of remote sensing, food/agriculture, med-ical imaging, and defense [28, 11, 1, 26, 5].
In parallel, depth imaging also has been developed for decades and now serves as a critical functionality for robotics, autonomous driving, mobile photography, and augmented/mixed real-ity [17, 36, 15]. These two imaging modalities recently started to be merged as hyperspectral-depth (HS-D) imag-ing that has various applications in ornithology, geology, bi-ology, arts, and cultural heritage [22, 56, 23, 50, 12, 31, 35].
Specifically, single-shot HS-D imaging has applications such as analyzing living biological samples and geometric-spectral scene understanding from a moving camera on a vehicle or a hand-held camera.
To capture both spectrum and depth, existing HS-D
Figure 1. (a) Our compact single-shot HS-D imaging method uses an optimized DOE that creates (b) a PSF that varies with spec-trum and depth. (c) – (e) It encodes spectral-depth information in the captured image, from which we simultaneously reconstruct a depth map and a hyperspectral image from 420 nm to 680 nm with 10 nm bandwidth. imaging systems follow a combinational approach; they in-dependently capture spectral and depth information with separate imaging systems, and combine the results after the fact [22, 47, 12, 50]. This enables accurate acquisi-tion of both data by exploiting decade-long research in each regime. However, this combinational design fundamentally limits the potentials of HS-D imaging as it inevitably in-creases form factor, cost, capture time with additional align-ment/registration problems.
In this work, instead of relying on two different imaging systems and combining them, we propose a first compact single-shot HS-D imaging method that uses a single diffrac-tive optical element (DOE) in front of a conventional cam-era sensor. Our key intuition is that depth and spectrum are closely coupled in DOE-based imaging systems, thus allow-ing for single-shot capturing of an HS-D image. However, it is nontrivial to design a DOE that distinctively varies with scene depth and spectrum for HS-D imaging. To solve this problem, we implement a fully differentiable image simula-tor that synthesizes a sensor image for a given DOE height profile, building on recent advances in automatic differen-tiation and Fourier optics [38, 8, 51, 42, 41, 43, 49]. Com-bined with a convolutional neural network (CNN) that esti-mates depth and spectrum from a sensor image, we build an end-to-end differentiable pipeline from the DOE profile to
Figure 2. Our single-shot HS-D imaging is based on a differentiable pipeline that includes a wave-optics simulation and an HS-D image reconstruction part. For a DOE height map, we simulate its PSF at each depth and spectrum sample using a PSF simulator fpsf. Then, the HS-D image simulator fimg computes a sensor image with the aid of the ground-truth HS-D dataset. The CNN-based reconstructor frec estimates a hyperspectral image and a depth map. As the entire pipeline is differentiable, we optimize the DOE and the CNN by backpropagating the loss L. the reconstructed depth and spectrum, allowing us to jointly optimize DOE and CNN via backpropagation. The obtained
DOE exhibits distinct variations in its shape with respect to both depth and spectrum.
For such joint optimization, one key missing part is the ground-truth HS-D dataset to supervise the optimization.
As no such HS-D dataset exists, we build a benchtop HS-D imaging system that includes a structured light-based 3D scanning module and a bandpass filter-based hyperspectral imaging module. With this benchtop setup, we capture a first HS-D dataset that can be used for data-driven plenop-tic imaging researches. We will make the dataset publicly available.
Our HS-D imaging method trained on the HS-D dataset outperforms the state-of-the-art single-shot HS-D imaging methods and alternative optical designs both in terms of form factor and accuracy. Our specific contributions are as follows.
• First compact monocular HS-D imaging method with a learned DOE that captures a depth map and a hyper-spectral image from a single shot,
• First HS-D dataset of hyperspectral reflectance images and depth maps acquired by a benchtop HS-D imaging system that could fuel data-driven plenoptic imaging research, and
• Experimental verification in simulation and real exper-iments by fabricating an optimized DOE. 2.