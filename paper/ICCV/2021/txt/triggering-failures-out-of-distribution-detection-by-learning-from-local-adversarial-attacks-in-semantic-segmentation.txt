Abstract
In this paper, we tackle the detection of out-of-distribution (OOD) objects in semantic segmentation. By analyzing the literature, we found that current methods are either accu-rate or fast but not both which limits their usability in real world applications. To get the best of both aspects, we pro-pose to mitigate the common shortcomings by following four design principles: decoupling the OOD detection from the segmentation task, observing the entire segmentation net-work instead of just its output, generating training data for the OOD detector by leveraging blind spots in the segmenta-tion network and focusing the generated data on localized regions in the image to simulate OOD objects. Our main con-tribution is a new OOD detection architecture called ObsNet associated with a dedicated training scheme based on Local
Adversarial Attacks (LAA). We validate the soundness of our approach across numerous ablation studies. We also show it obtains top performances both in speed and accuracy when compared to ten recent methods of the literature on three different datasets. 1.

Introduction
For real-world decision systems such as autonomous ve-hicles, accuracy is not the only performance requirement and it often comes second to reliability, robustness, and safety concerns [40], as any failure carries serious conse-quences. Component modules of such systems frequently rely on Deep Neural Networks (DNNs) which have emerged as a dominating approach across numerous tasks and bench-marks [59, 21, 20]. Yet, a major source of concern is related to the data-driven nature of DNNs as they do not always generalize to objects unseen in the training data. Simple uncertainty estimation techniques, e.g., entropy of softmax predictions [11], are less effective since modern DNNs are consistently overconﬁdent on both in-domain [19] and out-of-distribution (OOD) data samples [46, 25, 23]. This hin-Figure 1: Evaluation of precision vs. test-time computational cost on CamVid OOD. Existing methods for OOD detection in semantic segmentation are either accurate but slow (e.g., MC
Dropout [17], Deep Ensemble [30]) or fast but inaccurate (e.g.,
Maximum Class Prediction [25]). In contrast, our method Ob-sNet+LAA is both accurate and fast. Additional baselines and evaluation datasets are available in §4.3. ders further the performance of downstream components relying on their predictions. Dealing successfully with the
“unknown unknown”, e.g., by launching an alert or failing gracefully, is crucial.
In this work we address OOD detection for semantic segmentation, an essential and common task for visual perception in autonomous vehicles. We consider “Out-of-distribution”, pixels from a region that has no training la-bels associated with. This encompasses unseen objects, but also noise or image alterations. The most effective methods for OOD detection task stem from two major categories of approaches: ensembles and auxiliary error prediction mod-ules. DeepEnsemble (DE) [30] is a prominent and simple ensemble method that exposes potentially unreliable pre-dictions by measuring the disagreement between individual
DNNs. In spite of the outstanding performance, DE is com-putationally demanding for both training and testing and prohibitive for real-time on-vehicle usage. For the latter cat-egory, given a trained main task network, a simple model is trained in a second stage to detect its errors or estimate its conﬁdence [10, 22, 4]. Such approaches are computationally lighter, yet, in the context of DNNs, an unexpected draw-back is related to the lack of sufﬁcient negative samples, i.e., failures, to properly train the error detector [10]. This is due to an accumulation of causes: reduced size of the training set for this module (essentially a mini validation set to with-hold a sufﬁcient amount for training the main predictor), few mistakes made by the main DNNs, hence few negatives.
In this work, we propose to revisit the two-stage approach with modern deep learning tools in a semantic segmentation context. Given the application context, i.e., limited hardware and high performance requirements, we aim for reliable
OOD detection (see Figure 1) without compromising on predictive accuracy and computational time. To that end we introduce four design principles aimed at mitigating the most common pitfalls and covering two main aspects, (i) architecture and (ii) training: (i.a) The pitfall of trading accuracy in the downstream segmentation task for robustness to OOD can be alleviated by decoupling OOD detection from segmentation. (i.b) Since the processing performed by the segmentation network aims to recognize known objects and is not adapted to OOD objects, the accuracy of the OOD detection can be improved signiﬁcantly by observing the entire segmentation network instead of just its output. (ii.a) Training an OOD detector requires additional data that can be generated by leveraging blind spots in the segmentation network. (ii.b) Generated data should focus on localized regions in the image to mimic unknown objects that are OOD.
Following these principles, we propose a new OOD de-tection architecture called ObsNet and its associated training scheme based on Local Adversarial Attacks (LAA). We ex-perimentally show that our ObsNet+LAA method achieves top performance in OOD detection on three semantic seg-mentation datasets (CamVid [9], StreetHazards [24] and
BDD-Anomaly [24]), compared to a large set of methods1.
Contributions. To summarize, our contributions are as follows: We propose a new OOD detection method for se-mantic segmentation based on four design principles: (i.a) decoupling OOD detection from the segmentation task; (i.b) observing the full segmentation network instead of just the output; (ii.a) generating training data for the OOD detector using blind spots of the segmentation network; (ii.b) focus-ing the adversarial attacks in localized region of the image to simulate unknown objects. We implement these four principles in a new architecture called ObsNet and its as-1Code and data available at https://github.com/valeoai/obsnet sociated training scheme using Local Adversarial Attacks (LAA). We perform extensive ablation studies on these principles to validate them empirically. We compare our method to 10 diverse methods from the literature on three datasets (CamVid OOD, StreetHazards, BDD Anomaly) and we show it obtains top performances both in accu-racy and in speed.
Strength and weakness. The strengths and weaknesses of our approach are: (cid:51) It can be used with any pre-trained segmentation net-work without altering their performances and without
ﬁne-tuning them (we train only the auxiliary module). (cid:51) It is fast since only one extra forward pass is required. (cid:51) It is very effective since we show it performs best com-pared to 10 very diverse methods from the literature on three different datasets. (cid:55) The pre-trained segmentation network has to allow for adversarial attacks, which is the case of commonly used deep neural networks. (cid:55) Our observer network has a memory/computation over-head equivalent to that of the segmentation network, which is not ideal for real time applications, but far less than that of MC Dropout or deep ensemble methods.
In the next section, we position our work with respect to the existing literature. 2.