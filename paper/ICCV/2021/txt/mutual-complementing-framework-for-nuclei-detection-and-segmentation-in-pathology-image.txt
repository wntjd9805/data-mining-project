Abstract
Detection and segmentation of nuclei are fundamental analysis operations in pathology images, the assessments derived from which serve as the gold standard for cancer diagnosis. Manual segmenting nuclei is expensive and time-consuming. What’s more, accurate segmentation detection of nuclei can be challenging due to the large appearance variation, conjoined and overlapping nuclei, and serious degeneration of histological structures. Supervised methods highly rely on massive annotated samples. The existing two unsupervised methods are prone to failure on degenerated samples. This paper proposes a Mutual-Complementing
Framework (MCF) for nuclei detection and segmentation in pathology images. Two branches of MCF are trained in the mutual-complementing manner, where the detection branch complements the pseudo mask of the segmentation branch, while the progressive trained segmentation branch comple-ments the missing nucleus templates through calculating the mask residual between the predicted mask and detected
In the detection branch, two response map fusion result. strategies and gradient direction based postprocessing are devised to obtain the optimal detection response. Further-more, the conﬁdence loss combined with the synthetic sam-ples and self-ﬁnetuning is adopted to train the segmentation network with only high conﬁdence areas. Extensive experi-ments demonstrate that MCF achieves comparable perfor-mance with only a few nucleus patches as supervision. Es-pecially, MCF possesses good robustness (only dropping by about 6%) on degenerated samples, which are critical and common cases in clinical diagnosis. 1.

Introduction
With the advent of whole slide imaging scanners, the histopathological analysis performed on these digital
*Corresponding author. #Equal contribution to this work. pathology images has been demonstrated as an effective and reliable tool for cancer diagnosis and prognosis [9]. The as-sessments derived from the pathology image serve as the gold standard for cancer diagnosis in many clinical proto-cols. The shape and distribution of cell nuclei in pathol-ogy images are used to determine cell, tissue, and cancer types, and are critical in cancer identiﬁcation, grading, and prognosis [9]. Accurate detection and segmentation of these nuclei from histology images is an essential prerequisite to obtain reliable morphological statistics for quantitative di-agnosis, prognosis, and analysis.
However, manual searching and segmenting nuclei from large-scale histopathology images in a conventional way can be expensive, error-prone, and time-consuming. Fur-thermore, it often suffers from a high inter and intra-observer variability [4, 15], which results in limited repro-ducibility. Therefore, automatic detection and segmenta-tion methods are highly demanded in clinical practice to improve the efﬁciency, reliability, and scalability of large-scale histopathological image analysis.
Automated detection and segmentation of histological nuclei from histology images can be quite challenging for several reasons. First, there is a huge variation of object ap-pearance depending on the histologic grade as well as the type of the disease. Second, there exist conjoined and over-lapping nuclei. Third, the structures of nuclei have seriously degenerated in the malignant cases£¬ which lead to weak boundaries. In addition, the variation of tissue preparation procedures such as sectioning and staining can cause de-formation, artifacts and inconsistency of tissue appearance, which can impede the segmentation process as well.
Recently, deep learning approaches have achieved promising results in the medical image analysis area [16].
Some CNN based method has been applied into nuclei de-tection [3, 10, 13, 24, 31] and segmentation [1, 3, 6, 16, 20, 33, 21, 22, 25, 29, 38] . However, those supervised methods highly rely on a large amount of annotation. Careful annota-tion of nucleus boundaries is time-consuming, error-prone, and may also suffer from subjective interpretation errors.
As shown in [4, 15], there is a larger interoberver disparity among pathologists identifying nuclei in pathology images.
To relieve the rely on the massive annotated samples, some weakly supervised methods [18, 31] are proposed.
However, the satisfactory performance of those methods still requires plenty of annotated samples. Furthermore, Le et al.
[13] proposed a crosswise sparse convolutional au-toencoder (CAE) for unsupervised nucleus detection based on the local sparsity assumption. What’s more, Hou et al.
[12] synthesized training samples image patches with some predeﬁned nuclei texture and color, reﬁned those samples with GAN, ﬁnally trained a segmentation CNN with those generated sample pairs. However, the above two unsuper-vised methods [12, 13] usually failed on complex and de-generated cases caused by canceration, which are critical and common cases in clinical diagnosis.
In this paper, we proposed a Mutual-Complementing
Framework (MCF) for nuclei detection and segmentation in pathology images. MCF can achieve good detection and segmentation results with only a few nucleus patches.
As described above, different pathology images have varia-tional appearances. However, those nuclei can also be dis-tributed into some similar templates according to structure and color. So, by initially selecting some general nucleus patches, a detection branch with the corresponding correla-tion ﬁlters can locate most nuclei. For obtaining the optimal response, Cropped Filter Fusion (CFF) and Multi-scale Fil-ter Fusion (MFF) are devised to fuse top T high responses, which can avoid disturbance of some unmatched correlation
ﬁlters. Gradient direction based postprocessing is also pro-posed to eliminate some incorrect responses, such as con-nected regions of nuclei. With a dynamic binarization tech-nique, those detected areas with high conﬁdence can serve as the pseudo mask of the segmentation branch. For the segmentation branch, a conﬁdence loss is devised to train the segmentation network with only high conﬁdence areas in the pseudo mask. What’s more, we synthesize some sam-ples with high conﬁdence areas to enhance the segmentation performance of the nucleus boundary. Finally, the trained segmentation network is ﬁnetuned with the high conﬁdence areas predicted by itself.
For the same input image, the mask residual between the detected and segmented results is calculated for ﬁnding the missing nuclei, which can be used to optimize the detec-tion branch. Based on the mutual-complementing mecha-nism, the detection and segmentation branches are trained iteratively. Extensive experiments show that MCF achieves promising results with only a few nuclei patch templates, and possesses good robustness on degenerated samples.
Our main contribution can be summarized as follows: 1)
We propose a Mutual-Complementing Framework (MCF) for nuclei detection and segmentation, where the mutual-complementing mechanism enables MCF to achieve iter-atively optimized segmentation and detection results with only a few nucleus patches. 2) Two response map fu-sion strategies and gradient direction postprocessing are de-vised to obtain the optimal responses and eliminate some incorrect responses. 3) The conﬁdence loss combined with synthetic samples and self-ﬁnetuning is designed to train the segmentation network with only high conﬁdence ar-eas to improve the overall segmentation performance. 4)
Extensive experiments show that, with only a few nucleus patches, MCF achieves comparable detection and segmen-tation performance on par with fully supervised methods, and possesses excellent robustness on degenerated samples. 1.1.