Abstract
Being able to infer 3D structures from 2D images with geometric principles, vanishing points have been a well-recognized concept in 3D vision research.
It has been widely used in autonomous driving, SLAM, and AR/VR for applications including road direction estimation, camera calibration, and camera pose estimation. Existing vanish-ing point detection methods often need to trade off between robustness, precision, and inference speed. In this paper, we introduce VaPiD, a novel neural network-based rapid
Vanishing Point Detector that achieves unprecedented efﬁ-ciency with learned vanishing point optimizers. The core of our method contains two components: a vanishing point proposal network that gives a set of vanishing point propos-als as coarse estimations; and a neural vanishing point op-timizer that iteratively optimizes the positions of the vanish-ing point proposals to achieve high-precision levels. Exten-sive experiments on both synthetic and real-world datasets show that our method provides competitive, if not better, performance as compared to the previous state-of-the-art vanishing point detection approaches, while being signiﬁ-cantly faster. 1.

Introduction
Vanishing points are deﬁned as the intersection points of 3D parallel lines when projected onto a 2D image. By pro-viding geometry-based cues to infer the 3D structures, they underpin a variety of applications, such as camera calibra-tion [21, 7], facade detection [25], 3D reconstruction [15], 3D scene structure analysis [16, 39], 3D lifting of lines [30],
SLAM [43], and autonomous driving [22].
Efforts have been made on vanishing point detection in the past decades. Traditionally, vanishing points are de-tected in two stages.
In the ﬁrst stage, a line detection algorithm, such as probabilistic hough transformation [18] or LSD [38], is used to extract a set of line segments. In the second stage, a line clustering algorithm [26] or a vot-Figure 1: We propose a novel vanishing point detection net-work VaPiD, which runs in real-time with high accuracy.
Speed-accuracy curves compare with state-of-the-art meth-ods on the SU3 dataset [46]. Dotted horizontal lines labeled with n(cid:15) represent the nth smallest angle errors that numer-ically can be represented by 32-bit ﬂoating point numbers when computing the angle between two normalized direc-tion vectors, i.e., arccos(cid:104)d1, d2(cid:105). ing procedure [3] is used to estimate the ﬁnal positions of vanishing points from detected line segments. The main weakness of this pipeline is that the extracted lines might be noisy, leading to spurious results after clustering or voting when there are too many outliers. To make algorithms more robust, priors of the underlying scenes can be used, such as Manhattan worlds [4] or Atlanta worlds [31], which are common in man-made environments. Nevertheless, addi-tional assumptions complicate the problem setting, and the algorithms might not work well when these hard assump-tions do not hold.
Recent CNN-based deep learning approaches [6, 5, 42, 41, 19, 45] have demonstrated the robustness of the data-driven approach.
In particular, NeurVPS [45] provides a framework to detect vanishing points in an end-to-end fash-ion without relying on external heuristic line detectors. It proposes conic convolution to exploit the geometric prop-erties of vanishing points by enforcing the feature extrac-tion and aggregation along the structural lines of vanishing point candidates. This approach achieves satisfactory per-formance, but it is inefﬁcient as it requires evaluating all possible vanishing points in an image (1FPS is reported in
[45]). In contrast, most vanishing point applications must be run online in order to be useful in a practical setting.
To this end, we introduce VaPiD, a novel end-to-end rapid vanishing point detector that signiﬁcantly boosts the model efﬁciency using learned optimizers. VaPiD consists of two components: (1) a vanishing point proposal network (VPPN) that takes an image and returns a set of vanishing point proposals. It harnesses a computation sharing scheme to efﬁciently process dense vanishing point anchors; (2) a neural vanishing point optimizer (NVPO) that takes each proposal as input and optimizes for its position with a neu-ral network in an iterative fashion. In each iteration, it re-ﬁnes the vanishing points by regressing the residuals and updating the estimates. Our approach can be considered as learning to optimize. Compared to the previous coarse-to-ﬁne method in [45], our optimizing scheme avoids enumer-ating all possible vanishing point candidate positions, which largely improves the inference speed.
We comprehensively evaluate our method on four pub-lic datasets including one synthetic dataset and three real-world datasets. VaPiD signiﬁcantly outperforms previous works in terms of the efﬁciency, while achieving compet-itive, if not better, accuracy compared with the baselines.
Remarkably, on the synthetic dataset, the cosine of the me-dian angle error (0.088°) is close to the machine epsilon of 32-bit ﬂoating-point numbers1, which indicates that Va-PiD pushes the detection accuracy to the limit of numerical numbers. With fewer reﬁnement iterations, VaPiD runs at 26 frames per second while maintaining a median angle er-ror of 0.145° for 512×512 images with 3 vanishing points. 2.