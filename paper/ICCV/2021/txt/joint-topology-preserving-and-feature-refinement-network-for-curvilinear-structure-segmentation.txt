Abstract
Curvilinear structure segmentation (CSS) is under se-mantic segmentation, whose applications include crack de-tection, aerial road extraction, and biomedical image seg-mentation. In general, geometric topology and pixel-wise features are two critical aspects of CSS. However, most se-mantic segmentation methods only focus on enhancing fea-ture representations while existing CSS techniques empha-size preserving topology alone. In this paper, we present a Joint Topology-preserving and Feature-reﬁnement Net-work (JTFN) that jointly models global topology and reﬁned features based on an iterative feedback learning strategy.
Speciﬁcally, we explore the structure of objects to help pre-serve corresponding topologies of predicted masks, thus de-sign a reciprocative two-stream module for CSS and bound-ary detection.
In addition, we introduce such topology-aware predictions as feedback guidance that reﬁnes atten-tive features by supplementing and enhancing saliencies. To the best of our knowledge, this is the ﬁrst work that jointly addresses topology preserving and feature reﬁnement for
CSS. We evaluate JTFN on four datasets of diverse appli-cations: Crack500, CrackTree200, Roads, and DRIVE. Re-sults show that JTFN performs best in comparison with al-ternative methods. Code is available.1 1.

Introduction
Curvilinear Structure Segmentation (CSS) [19, 37] is to segment binary masks of curvilinear objects such as con-crete cracks, aerial roadmaps, blood vessel, and neuron boundary, etc. An accurate CSS in computer vision can help automatically detect concrete cracks captured by unmanned aerial vehicle [53], extract road networks from aerial im-ages [4,38], assist doctors to recognize lesions from medical images [48]. While signiﬁcant progress has been made in
CSS and semantic segmentation communities, at least two critical problems remain: topology preserving and feature reﬁnement. Like human’s labeling process, topology pre-*These authors contributed equally. 1https://github.com/zkl20061823
Figure 1. Effects of Joint Topology-preserving and Feature-reﬁnement Network (JTFN) on road network extraction, blood
JTFN can preserve vessels segmentation, and crack detection. global connectivity and render details simultaneously. Red and blue rectangles mark effect regions of topology-preserving and feature reﬁnement separately. serving seeks to preserve overall geometric connectivity; feature-reﬁnement aims to render details.
Typically, general CSS methods [14, 26, 39] tend to em-phasize topology preserving. For instance, [14] explicitly deﬁnes connected components and holes as local topology, but only optimizes limited pixels for topology, thus leads to the method is sensitive to complex backgrounds. An-other work [26] implicitly assumes features produced by pre-trained VGG have natural topology, but such strong assumptions cause limited improvements. Hence, a ro-bust, loose assumption, and global topology-preserving
CSS method is demanding.
In contrast, general semantic segmentation works mostly focus on feature representations, which integrate additional contextual or spatial information [7, 8, 15, 42, 44, 59]. For context-aware methods, dilated convolutions or pyramid designs are applied to enhance receptive ﬁelds [7, 8, 44], and non-local modules are used to raise self-attentions
[15, 42, 59]. For spatial-aware methods, multi-scale or skip-connected architectures are introduced to aggregate differ-ent features to diversify representations [20, 21]. Though these methods improve representations relatively, reﬁning features for details is still problematic for CSS. Correspond-ingly, [9, 26, 33, 40, 41] directly bring predicted masks as additional input channels and update the predictions iter-atively. To sum up, to reﬁne features, it is inspiring to study how to utilize both context- and spatial-aware pre-dicted masks as feedback guidance.
To address the aforementioned problems, we propose a novel framework, Joint Topology-preserving and Feature-reﬁnement Network (JTFN), to tackle two problems with
JTFN aims to jointly model global topology one stone. and reﬁned features based on an iterative feedback learn-ing strategy. Speciﬁcally, JTFN explores object boundary as global-topology regularizations of predicted masks, and designs a Feature Interactive Module (FIM) to reciprocate features between CSS and boundary detection. The learned topology-aware predictions naturally facilitate both atten-tive context- and spatial-aware features. To utilize such at-tentive masks as feedback guidances during feature reﬁne-ment, JTFN proposes a Gated Attentive Unit (GAU) to sup-plement and enhance saliencies. Furthermore, JTFN em-beds FIM and GAU in a feedback loop from feature learn-ing to prediction updating, thus not only reﬁnes features but also rectiﬁes ﬁnal predictions accordingly.
Fig. 1 illustrates examples of JTFN’s effects on diverse
CSS applications, and obtains the results from Base-FIM,
Base-GAU, and JTFN respectively (will be illustrated in
Sec. 4). From the results, we can see that JTFN can preserve global topology and reﬁned features simultaneously. Com-prehensive experiments on Crack500 [55], CrackTree200
[60], Roads [25], and DRIVE [24] validate the effectiveness of JTFN in comparison with ablations and alternatives. 2.