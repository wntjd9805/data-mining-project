Abstract
Understanding complex social interactions among agents is a key challenge for trajectory prediction. Most existing methods consider the interactions between pairwise traffic agents or in a local area, while the nature of interactions is unlimited, involving an uncertain number of agents and non-local areas simultaneously. Besides, they treat heteroge-neous traffic agents the same, namely those among agents of different categories, while neglecting people’s diverse reac-tion patterns toward traffic agents in different categories. To address these problems, we propose a simple yet effective Un-limited Neighborhood Interaction Network (UNIN), which predicts trajectories of heterogeneous agents in multiple cat-egories. Specifically, the proposed unlimited neighborhood interaction module generates the fused-features of all agents involved in an interaction simultaneously, which is adap-tive to any number of agents and any range of interaction area. Meanwhile, a hierarchical graph attention module is proposed to obtain category-to-category interaction and agent-to-agent interaction. Finally, parameters of a Gaus-sian Mixture Model are estimated for generating the future trajectories. Extensive experimental results on benchmark datasets demonstrate a significant performance improvement of our method over the state-of-the-art methods. 1.

Introduction
The challenges hampering prediction accuracy largely stem from the complex interactions among agents [1, 12, 57].
Recent advances in this regard [1, 3, 23, 26, 27] mainly fall into two types: Graph-based methods [13, 32, 56] build a spa-tial graph at each time step and aggregate the features from adjacent nodes; RNN-based methods [4, 7, 57] model each agent’s trajectory with Recurrent Neural Networks (RNNs) and pool hidden states within a surrounding area.
∗Corresponding author.
Figure 1. Hierarchical Graph Attention & Unlimited Neighbor-hood Interaction. Different marked shapes are used to distinguish the agent and category. (A) Hierarchical Attention. The agents marked by the same color belong to the same category. (1) Cate-gory Attention. Every category interacts with each other and itself.
Attention of one category to all categories (including the attention to itself) is transferred to all agents of the category. (2) Agent At-tention. We compute one’s attention to the rest of the agents in the whole scenario, and the attention is directed. (B) Unlimited
Neighborhood. We consider the interaction as among a collective, rather than between two agents or in a small area. The behavior of any agent may influence a group of agents around the whole scenario.
However, these methods suffer from limitations. Graph-based methods [32] only exploit pairwise relation be-tween the nodes, while other nodes are mixed and relayed.
GCN with many layers suffers from over-smoothing prob-lem [9, 19]. In contrast, the interaction in real-world traffic is much more complex than previously assumed, such as multilateral relations (relation among three or more agents).
Namely, these methods are limited by inflexible numbers of interaction agents.
Moreover, RNN-based methods [4, 7, 57] merely consider the local relations among an agent’s manually defined sur-rounding area. As a result, potential interaction participants outside of such “surrounding area” will be simply discarded.
Namely, these methods are limited by such hand-crafted way for interaction agent selection.
To solve these problems, we propose the Unlimited Neigh-borhood on heterogeneous graph to predict the future tra-jectories of multi-categories (e.g., pedestrians, bikes, cars,
.etc), as shown in Figure 1. Unlimited Neighborhood means the interactions are not limited by the number of agents or the range of area. Namely, any agent in a scenario could be involved in an interaction, as illustrated in Figure 2. In addition, many related works [12, 56] treat different agents as the homogeneous ones (i.e., pedestrians), while a real traffic scenario usually involves heterogeneous agents (i.e., agents in diverse categories). Due to the difference in move-ment patterns (e.g., velocity, front and rear distance and the response to the interaction) for agents in different categories, trajectory prediction on heterogeneous agents is exactly more challenging compared to that on homogeneous ones.
Specifically, we present a simple yet effective Unlimited
Neighborhood Interaction Network for heterogeneous tra-jectory prediction, which models the hierarchical attention and fuses all agents involved in one interaction to predict the future trajectories for all agents with different categories simultaneously. Then, regarding the agents as nodes and the agents with the same category as a category node, we can construct a spatio-temporal-category graph combining spatial, temporal and category information together. The hierarchical graph attention module acquires the category-category attention and then the agent-agent attention on the constructed graph. Note that the edges in the constructed graph are directed. Namely the edges are represented as a weighted asymmetric adjacency matrix to measure the interactions.
Once obtained the hierarchical interactions, an unlimited neighborhood interaction module is employed to capture the global information of all agents involved in the same interac-tion by an asymmetric convolutional network. Based on the global information and the hierarchical attention, the final interaction is obtained and fed into a Graph Convolutional
Network (GCN) [32] which is followed by a Temporal Con-volutional Network (TCN) [2], to estimate the parameters of
Gaussian Mixed Model (GMM) [37].
Experimental results on multiple benchmark datasets demonstrate significant performance improvement of our method over the state-of-the-art methods. The visualiza-tion shows our method can learn the interaction among het-erogeneous agents well. The code will be published upon acceptance.
In summary, the key contributions of this paper include:
• We propose to model the interaction among heteroge-Figure 2. Comparison between Unlimited Neighborhood Interac-tion and Pairwise Neighborhood Interaction (e.g., GCN). Different agents are enclosed in differently colored boxes, corresponding to solid circles in the same color. The hollow circle denotes an interaction. As can be seen, an interaction involves a group of agents in our method. On the right side, we show the predicted trajectories with or without our Unlimited Neighborhood. neous agents to improve the trajectory prediction;
• We present an Unlimited Neighborhood Interaction for modeling the interaction among the agents involved in the same interaction simultaneously;
• We present a Hierarchical Graph Attention module for enhancing the agent-to-agent interaction based on category-to-category interaction. 2.