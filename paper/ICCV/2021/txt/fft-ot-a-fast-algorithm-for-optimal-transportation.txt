Abstract
An optimal transportation map finds the most economi-cal way to transport one probability measure to the other. It has been applied in a broad range of applications in vision, deep learning and medical images. By Brenier theory, com-puting the optimal transport map is equivalent to solving a Monge-Amp`ere equation. Due to the highly non-linear nature, the computation of optimal transportation maps in large scale is very challenging.
This work proposes a simple but powerful method, the
FFT-OT algorithm, to tackle this difficulty based on three key ideas. First, solving Monge-Amp`ere equation is con-verted to a fixed point problem; Second, the obliqueness property of optimal transportation maps are reformulated as Neumann boundary conditions on rectangular domains;
Third, FFT is applied in each iteration to solve a Poisson equation in order to improve the efficiency.
Experiments on surfaces captured from 3D scanning and reconstructed from medical imaging are conducted, and compared with other existing methods. Our experimental results show that the proposed FFT-OT algorithm is simple, general and scalable with high efficiency and accuracy. 1.

Introduction
Recent years have witnessed the rapid development of optimal transportation and its broad applications in vision
[32, 31, 41, 38], deep learning [1, 16, 28] and medical imag-ing [18, 17, 39, 29]. An optimal transportation map (OT map) finds the most economical way to transport one prob-ability measure to the other, the total transportation cost is treated as the Wasserstein distance between the two random distributions. Therefore, OT maps have been used for mea-suring the differences among probability distributions, and for registering images or 3D shapes.
Motivation Due to the highly non-linear nature, improv-ing the computational efficiency of OT maps becomes one of the central challenges. Researchers have developed
*Corresponding author many methods to tackle this difficult problem with dif-ferent emphasises. For examples, the Sinkhorn algorithm
[35, 7, 25, 12] greatly improves the optimization speed of the Kantorovich potential by adding an entropy regularizer terms, but sacrificing the accuracy; the convex geometric variational algorithms [39, 24, 27] find the precise solu-tion, but with complex dynamic geometric data structure and adaptive arithmetic precision. The fluid dynamic algo-rithms [2, 19, 18] find the optimal flow in space-time, there-fore increases the dimension and reduces the computational efficiency.Therefore, existing methods can hardly find the accurate solutions for large scale OT problems efficiently.
In order to handle the challenge, this work proposes a novel algorithm: FFT-OT, which computes large scale optimal transportation maps with high efficiency and accuracy using the fundamental and powerful tool: Fast Fourier Transfor-mation.
Key Ideas The proposed algorithm is based on three simple ideas. The goal is to find the OT map between two probabil-ity measures T : (Ω, f dx) → (Ω∗, gdy), based on Brenier’s theorem 3.1, this is reduced to finding the Brenier potential u : Ω → R by solving the Monge-Ampere equation (1). 1. Fixed point By improving the formulation in [10, 4], an operator in the Sobolev space is constructed P : H 2(Ω) →
H 2(Ω), such that the solution u∗ of the Monge-Ampere equation is the fixed point of P, P[u∗] = u∗. The fixed point can be achieved by iterations, u(n+1) ← P[u(n)], when n → ∞, u(n) converges to u∗, u(n) → u∗. The convergence of the iteration process and the convexity of the solution has theoretic guarantees. 2. Obliqueness Boundary Condition The boundary condi-tion Du(Ω) = Ω∗ is difficult to directly formulated. Our formulation is based on the obliqueness boundary condition in Eqn. (5). Suppose the domain Ω is a planar rectangle, the
Brenier potential is rewritten as u(x, y) = (x2 + y2)/2 + φ, where −φ is the well-known Kantorovich potential. The obliqueness condition is equivalent to the Neumann bound-ary conditon ∂φ/∂n = 0 of the Kantorovich potential φ. 3. Fast Fourier Transformation During the fixed point it-erations, the operator P[u(n)] is to solve a Poisson equa-tion Eqn. (4) and Eqn. (6). Since the domain has a natural regular grid structure, it is very convenient to use finite dif-ference method to solve the Poisson equation [36]. More crucially, since the discrete Laplace matrix has the fixed structure, the Poisson equation can be solved using the FFT method to reduces the complexity.
Contributions This work proposes a simple FFT-OT al-gorithm to solve the OT problem by the classical FFT method.
Advantages The simple FFT-OT algorithm greatly im-proves the computational efficiency, accuracy and scalabil-ity. It can be implemented on GPU or FPGAs to further im-prove the speed. Furthermore, it can be directly generalized to higher dimensional situations. So the proposed FFT-OT algorithm has great potential to handle large scale real time
OT problems.
Disadvantages The proposed FFT-OT algorithm requires the supports of the probability distributions to be rectangu-lar. Nevertheless, it is possible to generalize the algorithm to general convex domains. The proposed FFT-OT algo-rithm focuses on 2 dimensional cases only, but it can be generalized to higher dimensional situations. 2.