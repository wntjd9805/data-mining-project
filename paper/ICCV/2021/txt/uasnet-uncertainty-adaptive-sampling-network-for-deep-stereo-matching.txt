Abstract
Recent studies have shown that cascade cost volume can play a vital role in deep stereo matching to achieve high resolution depth map with efﬁcient hardware usage.
However, how to construct good cascade volume as well as effective sampling for them are still under in-depth study. Previous cascade-based methods usually perform uniform sampling in a predicted disparity range based on variance, which easily misses the ground truth disparity and decreases disparity map accuracy.
In this paper, we propose an uncertainty adaptive sampling network (UAS-Net) featuring two modules: an uncertainty distribution-guided range prediction (URP) model and an uncertainty-based disparity sampler (UDS) module. The URP explores the more discriminative uncertainty distribution to handle the complex matching ambiguities and to improve disparity range prediction. The UDS adaptively adjusts sampling interval to localize disparity with improved accuracy. With the proposed modules, our UASNet learns to construct cascade cost volume and predict full-resolution disparity map directly. Extensive experiments show that the proposed method achieves the highest ground truth covering ratio compared with other cascade cost volume based stereo matching methods. Our method also achieves top perfor-mance on both SceneFlow dataset and KITTI benchmark. 1.

Introduction
Inferring disparity (or depth) from stereo images is a fundamental task in many applications, such as robotics
[19], autonomous driving [20] and augmented reality [29].
State-of-the-art stereo matching algorithms can be divided into two categories according to their cost volume represen-tation. One is to construct 4D cost volume throughout the entire disparity search range [2][27][4][5][30][8], and the other is to construct cascade cost volume with a narrowed disparity range [7][24][3][12][13][17]. Nowadays, cascade cost volume methods are popular since they can achieve high resolution depth map with efﬁcient hardware usage.
Figure 1. Comparison of disparity estimation results between a recent method [7] (middle column) and our proposed UASNet (right column).
The baseline method [7] estimates wrong disparities in areas depicted by red boxes, where similar textures lead to stereo matching ambiguity. In comparison, our UASNet estimates correct disparities based on our novel design of URP to improve disparity range prediction and UDS to improve the disparity sampling (see text for details).
For cascade cost volume methods, an important compo-nent is the method to narrow the disparity range. Previous methods [7][24] narrow disparity range through simply adding a constant offset to the initial predicted disparity.
This assigns the same offset for all pixels and may miss the ground truth disparity when the predicted error is large as in
Figure 1. Recently, UCS-Net [3] predicts per-pixel disparity range based on variance. However, only using statistical variance and manually designed rules to predict the offset is not enough to handle the complex matching ambiguities.
For example, a number of different matching distributions may produce the same variance, which is insufﬁcient to predict disparity range. With the predicted disparity range, another key challenge is designing of disparity sampling.
Constrained by cost volume construction implementation, the number of samples of per-pixel disparity range has to be the same. Previous methods [3][6] utilize a uniform sampling, which easily misses the ground truth disparity in a large disparity range. As shown in Figure 2, the uniform sampling causes the sampling points (red circles) far away
Figure 2. Comparison of two disparity sampling methods. The black blue curve describes matching probability distribution along the disparity dimension. Subﬁgure (a) shows uniform disparity sampling. The sampling points (red circles) may fall far away from the true disparity (red dashed line). Subﬁgure (b) shows our proposed UDS. The sampling points are dense in intervals of high matching certainty, which signiﬁcantly increases opportunity to obtain the true disparity sample. from the true disparity (red dashed line).
In order to address the above issues, this paper proposes an uncertainty adaptive sampling network (UASNet) to construct cascade volume with improved disparity range prediction as well as effective sampling. The key to our method is that we propose a novel uncertainty distribution-guided range prediction (URP) to precisely estimate per-pixel disparity range and an uncertainty-based disparity sampler (UDS) to adaptively adjust sampling interval to localize disparity with improved accuracy. Speciﬁcally, the URP explores the more discriminative uncertainty dis-tribution to handle the complex matching ambiguities.
It utilizes a deep learning module to learn per-pixel disparity range from the uncertainty distribution. A disparity range supervision is added to the network to learn discriminative features to improve disparity range prediction. The UDS discretizes per-pixel predicted candidate range according to
In this way, samples are dense in matching uncertainty. high matching certainty range and it becomes easy to obtain the true disparity sample of the subsequent stage. With the proposed modules, cascade cost volume is constructed and the full resolution disparity map is obtained.
Figure 1 visualizes comparison between a recent cascade cost volume method [7] and our UASNet. It can be seen that some pixels on the top area of trafﬁc sign and a part of road curb denoted by red boxes can not ﬁnd the correct matches in [7]. In comparison, our UASNet in the right column can learn the correct disparities with improved range prediction and accurate uncertainty-based sampling.
To summarize, our network improves stereo matching accuracy by the proposed UASNet with a cascade cost volume representation. Our contributions are summarized as follows:
• We propose an URP module to explore the uncer-tainty distribution to handle the complex matching ambiguities and improve disparity ranges prediction.
It achieves the highest ground truth covering ratio in comparison with other range prediction methods
[7][3][6].
• We propose an UDS strategy to adaptively adjust per-pixel sampling interval according to the matching uncertainty which achieves dense sampling in high matching certainty range and thus is easy to obtain the true disparity sample for the subsequent stage.
• Our proposed method achieves top performance on both SceneFlow dataset [15] and KITTI benchmark
[16]. 2.