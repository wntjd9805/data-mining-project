Abstract
In multi-object detection using neural networks, the fundamental problem is, “How should the network learn a variable number of bounding boxes in different input images?”. Previous methods train a multi-object detec-tion network through a procedure that directly assigns the ground truth bounding boxes to the specific locations of the network’s output. However, this procedure makes the training of a multi-object detection network too heuristic and complicated. In this paper, we reformulate the multi-object detection task as a problem of density estimation of bounding boxes. Instead of assigning each ground truth to specific locations of network’s output, we train a network by estimating the probability density of bounding boxes in an input image using a mixture model. For this purpose, we propose a novel network for object detection called
Mixture Density Object Detector (MDOD), and the cor-responding objective function for the density-estimation-based training. We applied MDOD to MS COCO dataset.
Our proposed method not only deals with multi-object de-tection problems in a new approach, but also improves de-tection performances through MDOD. The code is avail-able: https://github.com/yoojy31/MDOD. 1.

Introduction
Multi-object detection is the task of finding multiple ob-jects through bounding boxes with class information. Since the breakthrough of the deep neural networks, multi-object detection has been extensively developed in terms of com-putational efficiency and performance, and is now at a level that can be used in real life and industry.
Unlike image classification and sementic segmentation tasks, multi-object detection has a variable number of
∗H. Lee and I. Chung equally contributed to this work.
This work was supported by NRF grant (2021R1A2C3006659) and IITP grant (No. 2021-0-01343), both funded by Korean Government. The au-thors are also funded by Samsung Electronics. bounding boxes as targets. In this aspect, the fundamen-tal problem in training a multi-object detection network is, “How should the network learn a variable number of bounding boxes in different input images?”
As an answer to this question, instead of directly mod-eling a variable number of bounding boxes, methods have been developed to learn a variable number of bounding boxes by discretizing the bounding box space and directly assigning the ground truth to the network’s output. These methods have become the mainstream of training multi-object detection networks.
Figure 1 shows the training procedure of these meth-ods. First, the matching algorithm compares each ground truth bounding box with each reference point such as an an-chor box or a center, and determines whether they match or not. Second, as a result of the matching algorithm, the net-work output corresponding to the reference point location matched with the ground truth bounding box is extracted as the assignment location. Third, targets (e.g. displacements, classes) for each assigned location of output are generated.
Finally, the assigned location is trained by the generated tar-get through the objective function. Here, the unassigned lo-cations are considered background areas, and are not trained by the coordinate of the ground truth bounding box.
However, in order to successfully train a multi-object de-tection network through this procedure, thoughtful consid-eration for each step is required. First, in both the localiza-tion and the classification, the steps to assign each ground truth to the network’s output are needed to learn the coor-dinates of the ground truth bounding box. In these steps, a matching algorithm and the reference points such as an-chor boxes are important, since the ground truth are only assigned to the locations determined by the matching result.
Second, in the classification, there exists a severe imbal-ance between foreground and background. By the match-ing result, assigned locations are trained as corresponding ground truth classes regarded as foreground, but unassigned locations are trained as the background class. Generally, unassigned locations outnumber the assigned ones. This foreground-background imbalance problem makes training
Figure 1: (a) The conventional training procedure that directly assigns the ground truths to specific locations of the network’s output.(b) Our proposed density estimation-based training that learns bounding box distribution. difficult. To alleviate this problem, separate process such as heuristic sampling [17, 25] or focal loss [15] is required.
Third, some hyper-parameters and hand-crafted compo-nents make the detection performance sensitive. For exam-ple, design of anchor boxes [24, 22], matching algorithm
[28], and hyper-parameters of the focal loss [15] sensitively affect the detection performance. This sensitivity increases the cost of training a multi-object detection network.
In this paper, our goal is to propose a novel method to reduce the complex processing and heuristics for training multi-object detection network. To this end, we reformu-late the multi-object detection task as a density estimation of bounding boxes (See Fig. 1). Our proposed multi-object detection network, Mixture-Density-based Object Detector (MDOD), predicts the distribution of bounding boxes for an input image using a mixture model of components con-sisting of continuous (Cauchy) and discrete (categorical) probability distribution. For each component of the mix-ture model, the continuous Cauchy distribution is used to represent the distribution of the bounding box coordinates (left, top, right and bottom) and the categorical distribu-tion is used to represent the class probability of that box.
For localization, the MDOD is trained to maximize the log-likelihood of the estimated parameters for the mixture of
Cauchy (MoC) given the ground truth bounding boxes of input images. For classification, to include the background class into the learning process, we propose to use region of interest (RoI) sampling for obtaining RoIs, but, the RoIs are stochastically sampled from the estimated MoC, and not ob-tained heuristically. The log-likelihood of the sampled RoIs is maximized instead of that of the ground truth. The con-tributions of the proposed method are threefold as the fol-lowing: 1. Unlike the previous methods, we reformulate the multi-object detection task as a density estimation of bounding boxes for an input image. Through this novel approach, the complex processings and heuristics in the training of multi-object detection can be reduced. 2. We estimate the density of bounding boxes using a mix-ture model consisting of continuous (for the location) and discrete (for the class) probability distribution. To this end, we propose a new network architecture, MDOD, and the objective function for it. 3. We measured the detection performance and speed of our proposed method on MS COCO. In some primary evalua-tion results, MDOD outperforms the previous detectors in both terms of detection performance and speed. 2.