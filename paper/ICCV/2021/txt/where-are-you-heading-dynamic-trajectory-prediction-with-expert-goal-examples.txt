Abstract
Goal-conditioned approaches recently have been found very useful to human trajectory prediction, when adequate goal estimates are provided. Yet, goal inference is difﬁcult in itself and often incurs extra learning effort. We propose to predict pedestrian trajectories via the guidance of goal ex-pertise, which can be obtained with modest expense through a novel goal-search mechanism on already seen training examples. There are three key contributions in our study.
First, we devise a framework that exploits nearest examples for high-quality goal position inquiry. This approach natu-rally considers multi-modality, physical constraints, com-patibility with existing methods and is nonparametric; it therefore does not require additional learning effort typical in goal inference. Second, we present an end-to-end trajec-tory predictor that can efﬁciently associate goal retrievals to past motion information and dynamically infer possible future trajectories. Third, with these two novel techniques in hand, we conduct a series of experiments on two broadly explored datasets (SDD and ETH/UCY) and show that our approach surpasses previous state-of-the-art performance by notable margins and reduces the need for additional pa-rameters. Code can be found at our project page1. 1.

Introduction
Video predictive understanding on motion patterns of human or robotic agents is essential to many real-world intelligent systems. Forecasting the future trajectories of pedestrians in crowded scenes is an example of such re-search and recently has received considerable attention
[1, 12, 51, 20, 25]. It studies the ability of artiﬁcial vision systems to anticipate the future motion of individuals from current observations and therefore is of importance to a va-riety of allied areas, including self-driving vehicles, service robots and surveillance systems [38].
Research on modeling pedestrian walking trajectories has evolved from relatively simple physical motion mod-els (e.g., social force [13] or constant velocity [42]) to more 1https://github.com/JoeHEZHAO/expert_traj
Figure 1: Overview of the Query-Retrieval based framework. A test trajec-tory with unknown future goal position is matched with expert examples that previously have been seen and stored in an expert repository. Com-parisons are based on same observation length test (query) and stored ex-pert example (shown as solid lines) trajectories. This step results in multi-modal nearest trajectories with high similarity being retrieved, i.e., those shown in purple, red and green, as well as their goal positions (denoted as colored ﬂags) as potential goals for subsequent full trajectory forecasting. sophisticated efforts that take into account social compli-ance [30, 52, 41], enviromental awareness [27, 39, 44, 26] as well as end-goal policies [29, 6]. Recent efforts have found notable performance improvements by encoding goal positions (also dubbed destinations or endpoints) together with historically observed trajectories, with special effec-tiveness noticed in long-term prediction horizons. These efforts operate essentially in two steps: (i) Inference of goal positions from estimators typically trained in parallel with trajectory estimators; (ii) subsequent trajectory prediction that forecasts unseen movement, conditioned on both the past motion history and the inferred goal information. In nature, this scheme implicitly converts trajectory extrapo-lation to interpolation (i.e., bridging the pathway between initial trajectories and goal positions).
Goal-based research has been seen in a variety of places, e.g., motion planning [16] and reinforcement learning [17, 32, 8, 9]. These efforts either pre-deﬁne the desired goal space with human supervision [7, 33] or leverage a learn-able module to obtain that information directly from input, e.g., preliminary states or raw images [32]. The latter is favored by the general trajectory prediction ﬁeld [29, 6],
because typically pedestrians walk through scenes that do not have a priori speciﬁed goal positions. However, this choice raises an additional need: Training side models to infer goal positions during testing, which demands extra learnable parameters and goal annotations, if not given by default. Moreover, the learned goals might not be of ideal quality, e.g. violating road boundaries or trafﬁc rules.
Contributions. In response to the above challenges, we make three contributions. First, we focus on developing an effective and low-budget approach that automatically ex-plores potential goal positions from a repository of candi-date trajectories, namely by making use of expertise based on previous examples, without incurring additional training procedures. Our approach leverages the power of recent ad-vances in data-efﬁcient machine learning, where unlabeled data are self-annotated via metric matching on nearest la-belled neighbors. Following this insight, we devise a goal-retrieval algorithm that performs similarity search between partially observed trajectories from a test set and expert ex-amples from a training set, to obtain a small, multi-modal set of candidate goal positions. No previous research has used goal retrieval from an expert repository for trajectory prediction. An overview of our approach to goal retrieval is provided in Fig. 1. Second, we develop a subsequent trajec-tory predictor that inputs the history of trajectory observa-tions and the queried goal results with a novel low overhead data-shift encoding to jointly infer a diverse, yet accurate set of future trajectories. Third, we conduct extensive ex-periments to show that our approach surpasses the previous best performance on the Stanford Drone Dataset (SDD) by 15% and the ETH/UCY dataset by 15%. Notably, our re-sults are achieved without involving any additional learning components for goal inference.