Abstract
Conventional face super-resolution methods usually as-sume testing low-resolution (LR) images lie in the same do-main as the training ones. Due to different lighting condi-tions and imaging hardware, domain gaps between train-ing and testing images inevitably occur in many real-world scenarios. Neglecting those domain gaps would lead to in-ferior face super-resolution (FSR) performance. However, how to transfer a trained FSR model to a target domain ef-ﬁciently and effectively has not been investigated. To tackle this problem, we develop a Domain-Aware Pyramid-based
Face Super-Resolution network, named DAP-FSR network.
Our DAP-FSR makes the ﬁrst attempt to super-resolve LR faces from a target domain by exploiting only a pair of high-resolution (HR) and LR exemplar in the target domain. To be speciﬁc, our DAP-FSR ﬁrstly employs its encoder to ex-tract the multi-scale latent representations of the input LR face. Considering only one target domain example is avail-able, we propose to augment the target domain data by mix-ing the latent representations of the target domain face and source domain ones, and then feed the mixed representa-tions to the decoder of our DAP-FSR. The decoder will gen-erate new face images resembling the target domain image style. The generated HR faces in turn are used to optimize our decoder to reduce the domain gap. By iteratively updat-ing the latent representations and our decoder, our DAP-FSR will be adapted to the target domain, thus achieving authentic and high-quality upsampled HR faces. Extensive experiments on three benchmarks validate the effectiveness and superior performance of our DAP-FSR compared to the state-of-the-art methods. 1.

Introduction
Face Super-Resolution (FSR), also known as face hallu-cination, aims at reconstructing high-resolution (HR) face images from input low-resolution (LR) ones. FSR pro-vides critical information for the downstream computer vi-sion and machine learning tasks, such as face detection [1], recognition [31] and photo-editing [22, 62, 27]. Thanks to the advance of generative adversarial networks [15], FSR has achieved great success in recent years [51, 53, 52, 48,
*Part of this work is done as an intern at Baidu Research
Figure 1. Conventional FSR methods achieve good performance on the source dataset, but are prone to fail on the target dataset due to the domain gap. Our proposed method effectively adapts the model by leveraging only one-shot example. 54, 49, 56, 5, 8, 61].
Previous FSR methods usually presume training and testing LR faces are captured from the same domain. When testing LR faces resemble the training ones, previous works achieve authentic upsampled HR faces. However, in prac-tice, the domain gap between testing images and training ones is inevitable due to different imaging equipment, illu-mination conditions, etc. As shown in the upper right of
Figure 1, previous state-of-the-art FSR methods fail to up-sample HR authentically due to the large domain gap be-tween the target domain (testing) and source domain (train-ing). Considering FSR models would be deployed in dif-ferent scenarios, it is very inefﬁcient to re-train every de-ployed FSR model by collecting large-scale data from the corresponding target domain. Therefore, only using a few samples, ideally one example, to efﬁciently update an FSR model is highly desirable.
In this paper, we aim to super-resolve LR faces that exhibit an obvious domain gap by only leveraging one-shot exemplar from the target domain. We name this task as One-Shot Domain Adaption for Face Super-Resolution (OSDA-FSR). Different from conventional FSR meth-ods [51, 8, 37], two challenges are naturally raised: (i) how to design a FSR network architecture that is intrinsically suitable for efﬁcient adaptation; and (ii) how to explore one
example to bridge the domain gap since simply ﬁne-tuning an FSR network with one example is ineffective.
To address these challenges, we present a novel Domain-Aware Pyramid based Face Super-Resolution network, namely DAP-FSR network. Our DAP-FSR contains two parts: a domain-aware pyramid encoder and an upsampling decoder. Our DAP-FSR encoder is designed to extract the latent representations by leveraging the multi-scale features from the input LR faces. Considering LR faces may be un-aligned, we propose an Instance Spatial Transformer Net-works (ISTN) to align LR faces inspired by [21]. In this way, we facilitate the latent representation learning and face upsampling processes by aligning the LR faces into the canonical view. Motivated by the powerful architecture of
StyleGAN [23, 24], an image generation network, we con-struct our upsampling decoder. Once we obtain the latent representations, we feed those representations to our DAP-FSR decoder to hallucinate high-quality HR face images.
To tackle the problem of super-resolving LR faces in a new domain without the need for tremendous data col-lection, we propose a Domain-Aware latent Mixing and
Model Adaptation algorithm (DAMMA). In a nutshell, our
DAMMA algorithm is able to adapt the model trained on the source domain to the target domain by exploring only the one-shot example. As illustrated in Figure 1, when a target domain example is given, DAP-FSR network ﬁrst ex-tracts its latent representations. Then, supervised by the given one-shot example, we learn a soft mixture weight to mix the target latent representations with random-sampled source latent ones.
In this fashion, the newly generated faces will resemble the target domain faces and we signif-icantly augment the target-style data. By constrained ﬁne-tuning our decoder with the augmented images, our network is gradually adapted from the source domain to the target domain. After iteratively updating the soft mixing weight and adapting our decoder, our DAP-FSR attains authentic target domain HR faces.
Our main contributions are summarized as follows,
• We propose a novel domain-aware pyramid-based face super-resolution network, named DAP-FSR network, to efﬁciently upsample cross-domain LR face images by peeking at one-shot target domain example.
• We present a simple yet effective domain-aware latent mixing and model adaptation algorithm (DAMMA) to adapt our DAP-FSR to the target domain. Our
DAMMA generates target-style alike faces to adapt the upsampling decoder in DAP-FSR by fully exploiting the one-shot example.
• To the best of our knowledge, our method is the ﬁrst attempt to super-resolve cross-domain LR face images, making our method more practical.
• Our proposed DAP-FSR can be adapted to a target do-main effectively and is also robust to unaligned LR faces. Experiments on three constructed cross-domain face super-resolution benchmarks validate the superior performance of our proposed approach compared to the state-of-the-art methods. 2.