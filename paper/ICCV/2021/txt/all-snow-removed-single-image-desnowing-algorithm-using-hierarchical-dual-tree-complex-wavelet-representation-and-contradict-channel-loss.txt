Abstract
Snow is a highly complicated atmospheric phenomenon that usually contains snowflake, snow streak, and veiling effect (similar to the haze or the mist). In this literature, we propose a single image desnowing algorithm to address the diversity of snow particles in shape and size. First, to better represent the complex snow shape, we apply the dual-tree wavelet transform and propose a complex wavelet loss in the network. Second, we propose a hierarchical decomposition paradigm in our network for better under-standing the different sizes of snow particles. Last, we propose a novel feature called the contradict channel (CC) for the snow scenes. We find that the regions containing the snow particles tend to have higher intensity in the
CC than that in the snow-free regions. We leverage this discriminative feature to construct the contradict channel loss for improving the performance of snow removal.
Moreover, due to the limitation of existing snow datasets, to simulate the snow scenarios comprehensively, we propose a large-scale dataset called Comprehensive Snow Dataset (CSD). Experimental results show that the proposed method can favorably outperform existing methods in three synthetic datasets and real-world datasets. The code and dataset are released in https:// github.com/ weitingchen83/
ICCV2021-Single-Image-Desnowing-HDCWNet. (a) Input (b) DesnowNet [1] (c) JSTASR [2] (d) Ours
Figure 1: Comparison between state-of-the-art snow re-moval algorithms. (a) Input; (b)-(d) Recovered results by the DesnowNet [1], the JSTASR [2], and our proposed method. One can see that the proposed method can achieve better performance on snow removal. 1.

Introduction
Snow is an atmospheric phenomenon that usually affects the performance of computer vision such as object detection and semantic segmentation [3, 2]. According to the previ-*Indicates equal contribution. ous work [2], the formation of snow can be modeled as:
I(ùë•) = K(ùë•)T(ùë•) + A(ùë•)(1 ‚àí T(ùë•)), (1) where K(ùë•) = J(ùë•)(1 ‚àí Z(ùë•)R(ùë•)) + C(ùë•)Z(ùë•)R(ùë•), I de-notes the image deteriorated by snow, K is the snowy image
without the veiling effect, A is the atmospheric light, and J is the scene radiance. T(x) = e‚àí ùõΩd (x) is the media transmis-sion where d(x) is the depth and ùõΩ is the scattering coeffi-cient. C and Z are the chromatic aberration map for snow images and the snow mask, respectively. R is a binary mask which presents the snow location information. Snow is a very complex atmospheric phenomenon because it contains snowflakes, snow streaks, and the veiling effect. Existing snow removal strategies can be categorized into two classes: hand crafted feature-based and learning-based strategies.
For hand crafted feature-based methods [4, 5, 6, 7, 8], Pei et al. [6] utilized the features based on the color informa-tion such as saturation and visibility for desnowing. Xu et al. [4] developed a guidance image based snow removal pipeline. Zheng et al. [5] extracted features by multi-guided filters to separate the snow part from the background. These methods are based on the features observed by a human.
However, they may not hold for diverse real-world scenar-ios. With the rising of deep learning, several CNN-based approaches have been proposed [3, 2, 1]. Liu et al. [1] de-veloped the first learning-based desnowing method called the Desnownet. They proposed the first snow dataset called
Snow-100K. Chen et al. [2] proposed an algorithm by im-age inpainting and veiling effect recovery to perform snow removal and developed a dataset called SRRS to make the snow removal process more robust. Although these meth-ods achieve good performance, there are still some issues to be noted: (i) Robustness to real-world scenarios: The real-world snow scenes are highly complicated. For existing snow removal strategies, the diversity of snow shape and size is often ignored. First, existing methods lack an effective mechanism to capture the shape of snow. Moreover, con-ventional algorithms only consider snowflakes but neglect snow streaks. Second, because large snow particles are not easy to be modeled for training, they are difficult to be re-moved under real-world scenarios. Due to these issues, as shown in Figure 1, existing methods may have limited per-formance in real-world scenarios. (ii) Existing snow datasets cannot reflect the complicated constitution of real-world snow scenarios: In the Snow-100K dataset [1], the snowflakes are in different size are synthesized, but snow streaks and the veiling effect are not considered. In the SRRS dataset [2], although the veiling effect is considered, it does not include the snow streaks.
The snow streak is similar to the rain streak, but it has stronger intensity and may be blurrier than other snow par-ticles. The lack of the dataset with comprehensive snow features may degrade the performance of the network when handling real-world snow scenes.
Therefore, in this paper, we propose a novel snow re-moval architecture which can handle the complicated snow scenes by embedding the hierarchical dual-tree complex wavelet transform [9] to the network. Based on this op-eration, the snow image is decomposed and recovered in each scale by the recurrent decomposition. Based on this operation, all subbands can be reconstructed at the small scales. Moreover, snow particles with large size which do not appear in the training data can be represented at small scale. Consequently, the snow particles in the decomposed subbands can be easier to be removed because the training set can cover and simulate their distribution. Besides, the snow streaks and snowflakes can be well represented with the multi-direction property of DTCWT. Thus, with this ar-chitecture, the size-free and more comprehensive snow re-moval can be achieved. Then, we design two sub networks for complex wavelet recovery, that is, the high-frequency re-construction network and the low-frequency reconstruction network. In addition, we investigate snow and snow-free images and find a new feature called the contradict channel (CC). Based on the CC, we construct the contradict channel loss to improve the performance of snow removal. More-over, we proposed a novel large-scaled snow dataset called
Comprehensive Snow Dataset (CSD) which can solve the limitations in existing datasets. The main contributions in this paper are summarized as follows:
‚Ä¢ A novel hierarchical DTCWT desnowing network is proposed. Benefiting from the multi-direction and multi-scale properties of the hierarchical DTCWT, the proposed network can achieve better adaptability on complicated snow scenarios. Experiments on all ex-isting synthetic datasets and real-world dataset show that the proposed method achieves the state-of-the-art performance on snow removal.
‚Ä¢ We propose a new feature called the contradict chan-nel (CC) based on investigating the difference of snow and clean images. With the discriminative feature, the contradict channel loss is proposed to benefit the opti-mization of the network. As far as we know, this is the first work proposing the CC.
‚Ä¢ In order to address the limitation in existing snow datasets, we proposed a large-scale snow image dataset called CSD to provide the training data. 2.