Abstract
Computing dense pixel-to-pixel image correspondences is a fundamental task of computer vision. Often, the objec-tive is to align image pairs from the same semantic cate-gory for manipulation or segmentation purposes. Despite achieving superior performance, existing deep learning alignment methods cannot cluster images; consequently, clustering and pairing images needed to be a separate la-borious and expensive step.
Given a dataset with diverse semantic categories, we that can directly propose a multi-task model, Jim-Net, learn to cluster and align images without any pixel-level or image-level annotations. We design a pair-matching alignment unsupervised training algorithm that selectively matches and aligns image pairs from the clustering branch.
Our unsupervised Jim-Net achieves comparable accuracy with state-of-the-art supervised methods on benchmark 2D image alignment dataset PF-PASCAL. Specifically, we ap-ply Jim-Net to cryo-electron tomography, a revolutionary 3D microscopy imaging technique of native subcellular structures. After extensive evaluation on seven datasets, we demonstrate that Jim-Net enables systematic discovery and recovery of representative macromolecular structures in situ, which is essential for revealing molecular mechanisms underlying cellular functions. To our knowledge, Jim-Net is the first end-to-end model that can simultaneously align and cluster images, which significantly improves the perfor-mance as compared to performing each task alone. 1.

Introduction
Image alignment that establishes dense pixel-to-pixel correspondences between images is a fundamental research area in computer vision [86]. Various algorithms have been widely applied to important fields such as face recogni-tion [25, 105], medical diagnosis [85, 21], remote sensing
[100, 60], and structural biology [74, 37]. These have suc-∗Corresponding author. †Equal contribution. cessfully led to technological advances including Google street view [5], and historic scientific discoveries including the first image of a black hole [13] and atomic resolution macromolecular structures [9, 106].
Since 2017, end-to-end deep learning methods emerged for image alignment tasks and achieved superior perfor-mance in terms of both accuracy and efficiency, especially for the common scenario of image pairs with large transfor-mation variations [91, 101]. In most cases, the objective of image alignment is to align image pairs of the same seman-tic category for feature localization [54, 90], image manip-ulation [34, 4] or image segmentation purposes [81, 94, 46].
Nevertheless, the majority of image datasets contain diverse semantic categories [35, 28, 87]. Existing supervised and unsupervised deep learning image alignment approaches only perform alignment and cannot predict the categorical class of input images. As a result, they still need to catego-rize the images as a separate step, either by manual group-ing, which is tedious and time-consuming, or by computa-tional methods, which may be prone to errors [44] due to the large pose variations of objects (Figure 1).
Unsupervised categorization (clustering) has been ex-tensively studied in machine learning settings where the ground-truth categorical labels needed for supervised train-ing are hard to acquire. The accuracy of traditional image clustering algorithms is usually low because of their lim-ited ability in learning representations of high-dimensional visual features [31]. Recently, end-to-end deep image clus-tering methods have achieved similar performance to super-vised classification [15, 39, 96, 72] and demonstrated their ability to extract meaningful semantic features. As men-tioned above, most image datasets contain multiple seman-tic categories but the majority of image alignment applica-tions require categorical information of images. Therefore, it is critical to have a model that can simultaneously cluster and align images. Such a model will enable learning from scratch the clustering and alignment of images from a com-pletely unlabeled dataset with diverse semantic categories.
In particular, we motivate the importance of this prob-Figure 1. Illustration of Jim-Net: a multi-task learning model that can align an image pair and predict the cluster assignment of the source image. The red arrows denote the alignment branch and the green arrows denote the clustering branch. lem for in situ cryo-electron tomography (cryo-ET) with the goal to subdivide heterogeneous macromolecular structures into homogeneous structural subsets and align their poses.
Cryo-ET (detailed background description in Supplemen-tary section S1) is a rapidly developing 3D variant of 2017
Nobel chemistry prize cryo-Electron Microscopy. Cryo-ET has revolutionized structural biology by enabling systematic 3D visualization of subcellular structures [83]. The data is collected in situ, meaning that the subcellular structures are imaged in their native cytoplasm environment. Therefore, the spatial organization of macromolecules and their inter-actions with organelles can be revealed, which cannot be done by any other imaging methods [11]. With this unique strength, cryo-ET has continually provided new insights into the structure and function of important biological pro-cesses including bacterial effector secretion [20, 18, 19, 17] and mammalian neural function [32, 10, 88, 7, 26].
More importantly, cryo-ET has been applied extensively
[65, 98, 50, 48, 45] to characterize the structure and repli-cation of SARS-CoV-2 in host cells by localizing individ-ual proteins with high precision, promoting both the scien-tific understanding and treatment development of COVID-19. However, cryo-ET data analysis is very challeng-ing. Because of the structural heterogeneity and high noise level, to recognize different structures, macromolecules im-aged (represented as subtomograms: cubic subvolumes ex-tracted from a tomogram) must be clustered into homoge-neous groups and aligned. High-throughput methods that can simultaneously align and cluster 3D cryo-ET macro-molecules will substantially benefit the discovery and re-covery of higher-resolution structures in situ [12].
Contributions: (i) We introduce the first end-to-end model,
Jim-Net 1 (Joint image alignment and clustering Network), to jointly perform image alignment and image clustering. (ii) To alleviate the requirement for annotated training data, we design loss functions and a pair-matching alignment 1https://github.com/xulabs/aitom training algorithm to make Jim-Net fully unsupervised. (iii)
We incorporate coarse-to-fine alignment techniques to im-prove the robustness to large geometric transformations.
This includes a novel layer for composing 3D transfor-mations, which leads to fewer deformities and less gra-dient vanishing/exploding as it acts as a residual connec-(iv) We incorporate spectral tion to the coarse module. pooling, stacked dilated convolution, and constrained cross-correlation techniques to improve the robustness to noise for both tasks. (v) Our unsupervised Jim-Net achieve compara-ble alignment accuracy with state-of-the-art weakly super-vised methods on benchmark dataset PF-PASCAL. (vi) Jim-Net significantly improves the performance as compared to baseline methods performing each task alone on cryo-ET datasets. 2.