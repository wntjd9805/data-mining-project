Abstract
Vessel segmentation is critically essential for diagnosing a series of diseases, e.g., coronary artery disease and reti-nal disease. However, annotating vessel segmentation maps of medical images is notoriously challenging due to the tiny and complex vessel structures, leading to insufﬁcient avail-able annotated datasets for existing supervised methods and domain adaptation methods. The subtle structures and con-fusing background of medical images further suppress the efﬁcacy of unsupervised methods. In this paper, we propose a self-supervised vessel segmentation method via adversar-ial learning. Our method learns vessel representations by training an attention-guided generator and a segmentation generator to simultaneously synthesize fake vessels and seg-ment vessels out of coronary angiograms. To support the research, we also build the ﬁrst X-ray angiography coro-nary vessel segmentation dataset, named XCAD. We evalu-ate our method extensively on multiple vessel segmentation datasets, including the XCAD dataset, the DRIVE dataset, and the STARE dataset. The experimental results show our method suppresses unsupervised methods signiﬁcantly and achieves competitive performance compared with su-pervised methods and traditional methods. 1.

Introduction
As the most common heart disease, coronary artery dis-ease is one of the leading causes of death in the world.
Atherosclerosis in the coronary artery hinders blood from normally ﬂowing into the heart, eventually leading to a heart attack. Among various imaging modalities, X-ray angiog-raphy is taken as a gold standard for coronary artery disease diagnosis. As X-ray angiography can quickly display small vessel branches with a high resolution, it has been widely utilized in medical diagnosis for determining the presence, location, degree, and scope of coronary artery stenosis. It is crucial but challenging to accurately estimate subtle vessel structures from coronary angiograms. To minimize the ion-izing radiation exposure of patients and medical personnel, low-power X-ray is used during X-ray coronary angiogra-phy, usually leading to noisy and low-contrast coronary an-giograms. As a result, it is difﬁcult to distinguish vessels from the background artifacts1 that share similar appear-ances with vessel structures.
During X-ray coronary angiogram acquisition, a special cardiac catheter is utilized to inject a contrast agent into the coronary artery. With the contrast agent taking effect, blood vessels gradually emerge, leaving a sequence of coronary angiography images under the X-ray. In such a coronary an-giography sequence, the ﬁrst frame with no contrast agent injected is the mask frame. No vessel is shown in the mask frame. On the contrary, the frame with a fully injected con-trast agent is known as the contrast frame. Note that in this paper, we use the coronary angiogram to indicate the contrast frame in particular. Vessels are shown in coronary angiograms. Our objective is to segment vessels out of the coronary angiograms.
Existing vessel segmentation methods can be classiﬁed into four main categories: traditional methods [17, 23], su-pervised methods [8, 25], domain adaptation methods [3, 31], and unsupervised methods [4, 15]. Traditional meth-ods are typically based on predeﬁned rules that require sig-niﬁcant expertise and manual model tuning, leading to lim-ited model expressiveness and generality. Supervised meth-ods require a massive amount of annotated data for train-ing, though public large-scale annotated vessel datasets are practically unavailable. The complex vessel structure con-sists of numerous tiny branches that easily fade into the image background artifacts, making the manual annotation process extremely laborious and time-consuming, even for professional medical experts. The effectiveness of domain adaptation methods is largely dependent on the quality of annotated source domain dataset and constrained by the gap between the source domain and target domain. Existing un-supervised segmentation methods for natural images, such 1Note that this paper uses artifacts to represent the factors (e.g., di-aphragm, catheter, and bones) making segmentation difﬁcult.
as animals and ﬂowers, can hardly work on medical images due to their thorny characteristics—numerous tiny branches and confusing background artifacts.
Existing self-supervised methods [6, 24] learn useful representations by solving other pretext tasks on large-scale unlabeled data. However, no existing self-supervised meth-ods are designed for segmentation tasks due to the com-plexity of semantic segmentation.
In this paper, we ex-ploit speciﬁc characteristics of the coronary angiography sequence and design a novel self-supervised vessel segmen-tation method.
Speciﬁcally, we propose to learn self-supervised vessel representations by simultaneously training two adversarial networks that synthesize fake vessels on mask frames and segment vessels out of coronary angiograms. These learned vessel representations can be applied to multiple vessel seg-mentation tasks by directly using the pretrained model.
Without labeled vessel segmentation maps, we design a fractal synthetic module for self-supervised learning. Frac-tals synthesized by the fractal synthetic module are then utilized to guide the generation of vessels and serve as segmentation maps of synthetic fake coronary angiograms.
We introduce an attention-guided generator to conﬁrm that vessels of synthetic fake coronary angiograms match input segmentation maps. We also apply the idea of cycle con-sistency in CycleGAN [39] to segmentation tasks. In our framework, the two adversarial networks for vessel synthe-sis and segmentation form a cycle to produce reconstructed coronary angiograms and reconstructed segmentation maps.
We further utilize segmentation loss to enforce the consis-tency between segmentation maps and reconstructed seg-mentation maps.
To support our research and facilitate the work of other researchers, we create an X-ray angiography coronary artery disease (XCAD) dataset. The XCAD dataset con-tains 1621 mask frames and 1621 coronary angiograms in the training set, and 126 coronary angiograms annotated by experienced radiologists in the testing set. Experimental re-sults on the XCAD dataset demonstrate the effectiveness of the proposed method on coronary vessel segmentation.
Moreover, our method shows competitive performance with other retinal vessel segmentation methods on the DRIVE dataset [34] and the STARE dataset [13].
The main contributions of this paper are summarized as follows:
• To our best knowledge, we are the ﬁrst to design a self-supervised method for vessel segmentation.
Our method solves vessel segmentation tasks of both coronary angiograms and retinal images, with self-supervised vessel representations learned from unan-notated coronary angiography images. nary artery disease (XCAD) dataset 2.
• Our method shows remarkably competitive perfor-mance on the XCAD dataset, the DRIVE dataset, and the STARE dataset. 2.