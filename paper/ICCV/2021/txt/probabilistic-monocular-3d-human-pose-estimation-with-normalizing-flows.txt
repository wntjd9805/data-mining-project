Abstract 3D human pose estimation from monocular images is a highly ill-posed problem due to depth ambiguities and oc-clusions. Nonetheless, most existing works ignore these am-biguities and only estimate a single solution. In contrast, we generate a diverse set of hypotheses that represents the full posterior distribution of feasible 3D poses. To this end, we propose a normalizing flow based method that exploits the deterministic 3D-to-2D mapping to solve the ambigu-ous inverse 2D-to-3D problem. Additionally, uncertain de-tections and occlusions are effectively modeled by incorpo-rating uncertainty information of the 2D detector as condi-tion. Further keys to success are a learned 3D pose prior and a generalization of the best-of-M loss. We evaluate our approach on the two benchmark datasets Human3.6M and
MPI-INF-3DHP, outperforming all comparable methods in most metrics. The implementation is available on GitHub1. 1.

Introduction
Estimating the 3D pose of a human from a single monoc-ular image is an active research field in computer vision. It has many applications e.g. in human computer interaction, animation, medicine and surveillance. A common approach is to decouple the problem into two stages. In the first stage, a 2D pose detector is used to estimate 2D keypoints which are then lifted to 3D joint locations in the second stage.
By utilizing a 2D pose detector pretrained on diverse and richly annotated data, the 3D pose estimator becomes in-variant to different scenes varying in lighting, background and clothing. However, reconstructing the correct 3D pose from 2D joint detections is a highly ill-posed problem be-cause of depth ambiguities and occluded body parts. While some ambiguities can be resolved by utilizing information from the image (e.g. difference in shading due to depth dis-parity) or by exploiting known proportions of the human body, such as joint angle and bone length constraints, there 1https://github.com/twehrbein/Probabilistic-Monocul ar-3D-Human-Pose-Estimation-with-Normalizing-Flows
Figure 1. Our model generates diverse 3D pose hypotheses that are consistent with the input image. Compared to [28, 40] we achieve a higher diversity mainly where 2D detections are uncertain, in this case for the occluded left arm. For visualization purposes, more than three hypotheses are shown only for the highly ambiguous left arm. still remain scenarios where multiple plausible 3D poses are consistent with the same image. Fig. 1 shows such a situa-tion where the left arm is occluded by the upper body and therefore its position cannot be determined unambiguously.
Nevertheless, most existing works ignore the ambiguities by assuming that only a single solution exists. In contrast, we model monocular 3D human pose estimation as an ambigu-ous inverse problem with multiple feasible solutions. Thus, in this work, we propose to estimate the full posterior dis-tribution of plausible 3D poses conditioned on a monocular image.
Recently, few methods [20, 28, 29, 35, 40] have been proposed that follow the line of research to explicitly gener-ate multiple 3D pose hypotheses from the 2D input. How-ever, they only consider 2D joint coordinates and ignore the uncertainty of the 2D detector. While it is reasonable to infer depth ambiguities based on 2D coordinates only, di-rectly modeling occlusions and uncertain detections is not meaningful. Fortunately, most 2D human joint detectors
encode valuable information about uncertainties of the lo-cation of human joints in the predicted heatmaps. Instead of discarding this information, we propose to explicitly ex-tract and utilize the uncertainties of the 2D detector from the estimated heatmaps. As shown in Fig. 1, this enables us to effectively model the uncertainties of the 2D detector together with the inherent depth ambiguities.
In this work, we propose a normalizing flow based method inspired by the framework for solving ambiguous inverse problems from Ardizzone et al. [3]. A normalizing flow [38, 46, 47] is a sequence of bijective transformations which allows evaluation in both directions. We propose to view 3D human pose estimation from a single image as an ambiguous inverse problem, since it is a deterministic for-ward process (i.e. projection of the 3D pose to 2D) with multiple different inverse mappings. Constructing a bijec-tion between a 3D pose and the combination of a 2D pose with a latent vector allows to utilize the 3D-to-2D mapping (forward process) during training. Intuitively, depth infor-mation that otherwise gets lost in the forward process is en-coded in the latent vector. Repeatedly sampling the latent vector and computing the inverse path of the normalizing flow generates arbitrary many 3D pose hypotheses that ap-proximate the true posterior distribution. To incorporate the uncertainty information from the heatmaps, we employ a conditional variant of normalizing flows [4, 52]. We ex-tract the uncertainty information by fitting 2D Gaussians to the heatmaps which are then used to form a condition-ing vector. We optimize the model in both directions. The forward path learns the 3D-to-2D mapping and to produce latent vectors following a predefined distribution. For the inverse path, we utilize the 3D pose discriminator of [49] to penalize anthropometrically unfeasible poses. Additionally, we apply a loss enforcing the 3D pose hypotheses to reflect the uncertainties of the 2D detector. Motivated by common practice in particle filters, we further propose a generaliza-tion of the best-of-M loss [16] that minimizes the distance between the mean of the k best hypotheses and the corre-sponding ground truth.
We evaluate our approach on the two benchmark datasets
Human3.6M [19] and MPI-INF-3DHP [33] and outperform all comparable methods in most metrics. Given the focus on ambiguous examples, we further evaluate on a subset of
Human3.6M containing only samples with a high degree of 2D detector uncertainty. On this subset, our method outper-forms the competitors by a large margin. To summarize, our contributions are:
• To the best of our knowledge, we are the first to em-ploy a normalizing flow based method for modeling the posterior distribution of 3D poses given a single image.
• Uncertainty information from the predicted heatmaps of the 2D detector is incorporated into our method, en-abling to effectively model occlusions and uncertain detections.
• We propose a generalization of the best-of-M loss that noticeably improves prediction performance. 2.