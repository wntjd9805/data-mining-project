Abstract
Automatic security inspection using computer vision technology is a challenging task in real-world scenarios due to various factors, including intra-class variance, class imbalance, and occlusion. Most of the previous methods rarely solve the cases that the prohibited items are deliber-ately hidden in messy objects due to the lack of large-scale datasets, restricted their applications in real-world scenar-ios. Towards real-world prohibited item detection, we col-lect a large-scale dataset, named as PIDray, which covers various cases in real-world scenarios for prohibited item detection, especially for deliberately hidden items. With an intensive amount of effort, our dataset contains 12 cat-egories of prohibited items in 47, 677 X-ray images with high-quality annotated segmentation masks and bounding boxes. To the best of our knowledge, it is the largest prohib-ited items detection dataset to date. Meanwhile, we design the selective dense attention network (SDANet) to construct a strong baseline, which consists of the dense attention module and the dependency reﬁnement module. The dense attention module formed by the spatial and channel-wise dense attentions, is designed to learn the discriminative fea-tures to boost the performance. The dependency reﬁnement module is used to exploit the dependencies of multi-scale features. Extensive experiments conducted on the collected
PIDray dataset demonstrate that the proposed method per-ZDBS-LY-JSC038,
∗Corresponding author (libo@iscas.ac.cn).
This work was sup-ported by the Key Research Program of Frontier Sciences, CAS, the National Natural Science Foun-Grant No. dation of China, Grant No. 61807033 and Tencent Youtu Lab.
Libo Zhang was supported by Youth Innovation Promotion Associa-tion, CAS (2020111), and Outstanding Youth Scientist Project of IS-CAS. The PIDray dataset are available at https://github.com/ bywang2018/security-dataset.
Figure 1. Comparisons between the natural image (left) and X-ray image (right). forms favorably against the state-of-the-art methods, espe-cially for detecting the deliberately hidden items. 1.

Introduction
Security inspection is a process of checking assets against set criteria and the evaluation of security systems and access controls to ensure safety, which is important to uncover any potential risks in various scenarios, such as public transportation and sensitive departments.
In prac-tice, the inspectors are required to monitor the scanned X-ray images acquired by the security inspection machine to uncover prohibited items, such as guns, ammunition, ex-plosives, corrosive substances, toxic and radioactive sub-stances. However, the inspectors struggle to localize pro-hibited items hidden in messy objects accurately and efﬁ-ciently, which poses a great threat to safety.
In recent years, due to the substantial development of deep learning and computer vision technologies[31, 24, 34, 14, 13, 16, 3], automatic security inspection of prohib-ited items becomes possible. The security inspectors can quickly identify the locations and categories of prohibited
items relying on computer vision technology. Most of the previous object detection algorithms in computer vision are designed to detect objects in natural images, which are not optimal for detection in X-ray images. In addition, X-rays have strong penetrating power, different materials in the ob-ject absorb X-rays to different degrees, resulting in different colors. Meanwhile, the contours of the occluder and the oc-cluded objects in the x-ray are mixed together. As shown in
Figure 1, compared with natural images, X-ray images have a quite different appearance and edges of objects and back-ground, which brings new challenges in appearance mod-eling for X-ray detection. To advance the developments of prohibited items detection in X-ray images, some recent at-tempts devote to construct security inspection benchmarks
[25, 1, 2, 26, 36]. However, most of them fail to meet the requirements in real-world applications for three reasons. (1) Existing datasets only contain a small number and very few categories of prohibited items (e.g., knife, gun and scis-sors). For example, some common prohibited items such as powerbank, lighter and sprayer are not included. (2) Some real-world scenarios require high security level based on accurate predictions of masks and categories of prohibited items. The image-level or bounding box-level annotations in previous datasets are not sufﬁcient to train algorithms in such scenarios. (3) Detecting prohibited items hidden in messy objects is one of the most signiﬁcant challenges in security inspection. Nevertheless, few studies are developed towards this goal due to the lack of comprehensive datasets covering such cases.
To that end, we collect a large-scale prohibited item de-tection dataset (PIDray) towards real-world applications.
Our PIDray dataset covers 12 common prohibited items in
X-ray images. Some example images with annotations are shown in Figure 2, where each image contains at least one prohibited item with both the bounding box and mask an-notations. Notably, for better usage, the test set is divided into three subsets, i.e., easy, hard and hidden. The hidden subset focuses on the prohibited items deliberately hidden in messy objects (e.g., change the item shape by wrapping wires). To the best of our knowledge, it is the largest dataset for the detection of prohibited items to date.
Meanwhile, we also present the selective dense attention network (SDANet) to construct a strong baseline, which consists of two modules, i.e., the dense attention module and the dependency reﬁnement module. The dense atten-tion module uses both the spatial and channel-wise attention mechanisms to exploit discriminative features, which is ef-fective to locate the deliberately prohibited items hidden in messy objects. The dependency reﬁnement module is con-structed to exploit the dependencies among multi-scale fea-tures. Extensive experiments on the proposed dataset show that our method performs favorably against the state-of-the-art methods. Especially, our SDANet achieves 1.5% and
Figure 2. Example images in the PIDray dataset with 12 categories of prohibited items. Each image is provided with image-level and instance-level annotation. For clarity, we show one category per image. 1.3% AP improvements over Cascade Mask R-CNN [5] for object detection and instance segmentation on the hidden subset, respectively.
The main contributions of this work are summarized as follows. (1) Towards the prohibited item detection in real-world scenarios, we present a large-scale benchmark, i.e.,
PIDray, formed by 47, 677 images in total. To the best of our knowledge, it is the largest X-ray prohibited item de-tection dataset to date. Meanwhile, it is the ﬁrst benchmark aiming at cases where the prohibited items are deliberately hidden in messy objects. (2) We propose the selective dense attention network, formed by the dense attention module and the dependency reﬁnement module. The dense atten-tion module is used to capture the discriminative features in both spatial and channel-wise, and the dependency re-ﬁnement module is constructed to exploit the dependencies among multi-scale features. (3) Extensive experiments are conducted on the proposed dataset to verify the effective-ness of the proposed method compared to the state-of-the-art methods. 2.