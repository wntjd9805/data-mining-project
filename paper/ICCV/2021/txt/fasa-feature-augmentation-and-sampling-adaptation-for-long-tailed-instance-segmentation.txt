Abstract
Recent methods for long-tailed instance segmentation still struggle on rare object classes with few training data.
We propose a simple yet effective method, Feature Augmen-tation and Sampling Adaptation (FASA), that addresses the data scarcity issue by augmenting the feature space espe-cially for rare classes. Both the Feature Augmentation (FA) and feature sampling components are adaptive to the ac-tual training status — FA is informed by the feature mean and variance of observed real samples from past itera-tions, and we sample the generated virtual features in a loss-adapted manner to avoid over-ﬁtting. FASA does not require any elaborate loss design, and removes the need for inter-class transfer learning that often involves large cost and manually-deﬁned head/tail class groups. We show
FASA is a fast, generic method that can be easily plugged into standard or long-tailed segmentation frameworks, with consistent performance gains and little added cost. FASA is also applicable to other tasks like long-tailed classiﬁcation with state-of-the-art performance. 1 2 1.

Introduction
A growing number of methods are proposed to learn from long-tailed data in vision tasks like face recogni-tion [17], image classiﬁcation [29] and instance segmenta-tion [13]. We focus on the problem of long-tailed instance segmentation, which is particularly challenging due to the class imbalance issue. State-of-the-art methods [1, 4, 14, 25] often fail to handle this issue and witness a large per-formance drop on rare object classes. Fig. 1 exempliﬁes the struggle of the competitive Mask R-CNN [14] baseline on highly imbalanced LVIS v1.0 dataset [13]. We can see that there are about 300 rare classes in the tail that have no more than 102 positive object instances. Such scarce training data result in poor performance for most of the tail classes, with 1GitHub: https://github.com/yuhangzang/FASA. 2Project page: https://www.mmlab-ntu.com/project/fasa/index.html. near-zero class probabilities predicted for them.
To address the data scarcity issue, one intuitive option is to over-sample images that contain the tail-class ob-jects [13]. But the downside is that the over-sampled im-ages will include more head-class objects at the same time due to the class co-occurrence within images. Hence for the instance segmentation task, re-sampling at the instance level is more desirable than at image level. Another option is data augmentation for considered objects, either in image space (e.g., random ﬂipping) or in feature space (i.e., feature augmentation, on object regional features). Along this line, many methods have proven effective by augmenting the im-age/feature space of rare classes. The feature augmentation methods already show beneﬁts for face recognition [44, 26], person Re-ID [26] and classiﬁcation [20, 6]. However, these methods require manual design of class groups, e.g., using heuristics like class size. And they often involve two stages of feature training and feature transfer, which induce addi-tional cost.
Feature augmentation remains little explored for long-tailed instance segmentation tasks. In this paper, we present an efﬁcient and effective method, called Feature Augmenta-tion and Sampling Adaptation (FASA). FASA does not re-quire any elaborate transfer learning or loss design [23, 34, 41]. As a result, FASA keeps its simplicity, has extremely low complexity, while remains highly adaptive during train-ing.
In the proposed method, we perform online Feature
Augmentation (FA) for each class. The FA module gener-ates class-wise virtual features using a distributional prior with its statistics calculated from previously observed real samples. This allows FA to capture class distributions and adapts to evolving feature space.
The augmented features can still be limiting for rare classes. This is because the observed feature variance is often small with few training examples. To overcome this problem, we adapt the sampling density of virtual features for each class. This way, our synthesized virtual features still live in the true feature manifold, just with different sampling probabilities to avoid under-ﬁtting or over-ﬁtting.
We propose an adaptive sampling method here: when aug-Figure 1: Class imbalance and the comparison of Mask R-CNN [14] baseline with and without FASA on LVIS v1.0 dataset. (a) By adaptive feature augmentation and sampling, our method FASA largely alleviates the imbalance issue, especially for rare classes. (b) Compare the prediction results of FASA vs Mask R-CNN baseline regarding average category probability scores. The baseline model predicts near-zero scores for rare classes. While with FASA, rare-class scores are signiﬁcantly boosted which merits ﬁnal performance. (c) FASA brings consistent improvements over different backbone models in mask APr deﬁned on rare classes. Such gains come at a very low cost (training time only increases by ∼ 3% on average). mented features improve the corresponding class perfor-mance in validation loss, the feature sampling probabilities get increased, otherwise decreased. Such a loss-optimized sampling method is effective to re-balance the model pre-dicting performance, see Fig 1(b).
It is noteworthy that our full FASA approach handles virtual features only, thus it can serve as a plug-and-play module applicable to existing methods that learn real data with any re-sampling schemes or loss functions (standard or tailored for class imbalance). Comprehensive experiments of instance segmentation on LVIS v1.0 [13] and COCO-LT [38] datasets demonstrate FASA as a generic component that can provide consistent improvement to other methods.
Take LVIS dataset as an example. FASA improves Mask
R-CNN [14] by 9.0% and 3.3% in mask AP metrics for rare and overall classes respectively, and improves a contempo-rary loss design [34] by 10.3% and 2.3%. Moreover, these gains come at the cost of merely a ∼ 3% increase in train-ing time, see Fig. 1(c). Furthermore, FASA can generalize beyond the instance segmentation task, achieving state-of-the-art performance on long-tailed image classiﬁcation as well.
To summarize, the main contributions of this work is a fast and effective feature augmentation and sampling ap-proach for long-tailed instance segmentation. The pro-posed FASA can be combined with existing methods in a plug-and-play manner. It achieves consistent gains and sur-passes more sophisticatedly designed state-of-the-art meth-ods. FASA also generalizes well to other long-tailed tasks. 2.