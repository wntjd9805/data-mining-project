Abstract
Single image deraining is important for many high-level computer vision tasks since the rain streaks can severely de-grade the visibility of images, thereby affecting the recogni-tion and analysis of the image. Recently, many CNN-based methods have been proposed for rain removal. Although these methods can remove part of the rain streaks, it is difﬁcult for them to adapt to real-world scenarios and re-store high-quality rain-free images with clear and accurate structures. To solve this problem, we propose a Structure-Preserving Deraining Network (SPDNet) with RCP guid-ance. SPDNet directly generates high-quality rain-free im-ages with clear and accurate structures under the guidance of RCP but does not rely on any rain-generating assump-tions. Speciﬁcally, we found that the RCP of images con-tains more accurate structural information than rainy im-ages. Therefore, we introduced it to our deraining net-work to protect structure information of the rain-free image.
Meanwhile, a Wavelet-based Multi-Level Module (WMLM) is proposed as the backbone for learning the background in-formation of rainy images and an Interactive Fusion Mod-ule (IFM) is designed to make full use of RCP informa-tion. In addition, an iterative guidance strategy is proposed to gradually improve the accuracy of RCP, reﬁning the re-sult in a progressive path. Extensive experimental results on both synthetic and real-world datasets demonstrate that the proposed model achieves new state-of-the-art results.
Code: https://github.com/Joyies/SPDNet 1.

Introduction
Single image deraining (SID) aims to reconstruct a vi-sually pleasing image from its corresponding rain-streaks-degraded image. In the past years, various methods have been proposed for SID. For traditional methods, many re-searchers [11, 1, 3, 4, 41, 24, 27, 12] focused on exploring the physical properties of the rain and background layers.
*Corresponding author
Figure 1: An example of image deraining results. Ob-viously, SPDNet can reconstruct high-quality image with clear and accurate structure.
Meanwhile, various priors have been proposed to regular-ize and separate them, such as layer priors with Gaussian mixture model (GMM) [24], discriminative sparse coding (DSC) [27], and joint convolutional analysis and synthesis sparse representation (JCAS) [12]. Although these methods can effectively remove the rain streaks, they require com-plex iterative optimization to ﬁnd the best solution.
Recently, convolutional neural networks (CNN) have achieved signiﬁcant success in many computer vision tasks [32, 13, 18, 29]. Moreover, many CNN-based meth-ods [7, 8, 43, 23, 49, 15, 38, 50, 31, 45, 6, 37, 16] have been proposed for rain removal, such as DDN [8], RES-CAN [23], PReNet [31], DRDNet [6], and RCDNet [37].
Albeit these methods have brought great performance im-provements, they are difﬁcult to remove all rain streaks and recover the structural information of images in complex sce-narios (Fig. 1). This is because: (1). Most of them di-rectly learn the mapping between the rainy image and the rain streaks layers. In other words, most methods predict
A. Rainy Image
B. RCP of A
Figure 2: B is the residue channel prior (RCP) extracted from the rainy image. Obviously, even the RCP is extracted from the rainy image, it still contains clear structures. rain streaks via the built CNN model and then subtract rain streaks from rainy images to get the ﬁnal output. How-ever, the density of rain streaks varies, which leads to ex-cessive or insufﬁcient removal of rain streaks, resulting in incomplete structural information of the reconstructed im-ages. (2) These methods focus on learning the structure of rain streaks, but they pay less attention to learning the struc-ture of objects and ignore the importance of image prior.
To address the aforementioned issues, we aim to explore an image prior that can protect the structure of the image, and introduce the prior into the model to guide high-quality image reconstruction. According to our investigation, we found that the Total Variation (TV) prior will smooth tex-ture details in the restored images, the sparse prior is usu-ally difﬁcult to model because it requires other domain knowledge, and the edge prior is difﬁcult to obtain from the rainy image since the off-the-shelf edge detectors are sensi-tive to the rain streaks. In contrast, residue channel prior (RCP [19, 21, 20]) show clear structures even extracted from the rainy image (Fig. 2). Moreover, compared with layer prior [27] and [15], RCP is the residual result of the maximum channel value and minimum channel value of the rainy image, calculated without any additional parameters.
Hence, we adopt RCP to the image deraining task and pro-pose a Structure-Preserving Deraining Network (SPDNet) with residue channel prior (RCP) guidance. SPDNet pays more attention to learning the background information and directly generates high-quality rain-free images with clear and accurate structures. To achieve this, an RCP guidance network and an iterative guidance strategy are proposed for structure-preserving deraining. Speciﬁcally, we design a wavelet-based multi-level module (WMLM) as the back-bone of SPDNet to fully learn the background information in the rainy image. Meanwhile, an RCP extraction mod-ule and an interactive fusion module (IFM) are designed for RCP extraction and guidance, respectively. This is also the most important step in the SPDNet, which can high-light the structure of objects in the rainy images and pro-mote generating high-quality rain-free images. In addition, we found that the RCP improves as image quality improves.
Therefore, we propose a progressive reconstruction method, which means that the model extracts more accurate RCPs in the intermediate reconstruction stage to further guide im-age reconstruction. Under the iterative guidance of RCP,
SPDNet can reconstruct high-quality rain-free images.
The main contributions of this paper are as follows:
• We explore the importance of residue channel prior (RCP) for rain removal and propose a Structure-Preserving Deraining Network (SPDNet) with RCP guidance. Extensive experimental results show that
SPDNet achieves new state-of-the-art results.
• We propose an RCP extraction module and an Inter-active Fusion Module (IFM) for RCP extraction and guidance, respectively. Meanwhile, an iterative guid-ance strategy is designed for progressive image recon-struction.
• We design a Wavelet-based Multi-Level Module (WMLM) as the backbone of SPDNet to learn the background of the area covered by the rain streak. 2.