Abstract
There has been a booming demand for integrating Con-volutional Neural Networks (CNNs) powered functionali-ties into Internet-of-Thing (IoT) devices to enable ubiqui-tous intelligent “IoT cameras”. However, more extensive applications of such IoT systems are still limited by two challenges. First, some applications, especially medicine-and wearable-related ones, impose stringent requirements on the camera form factor. Second, powerful CNNs of-ten require considerable storage and energy cost, whereas
IoT devices often suffer from limited resources. PhlatCam, with its form factor potentially reduced by orders of magni-tude, has emerged as a promising solution to the first afore-mentioned challenge, while the second one remains a bot-tleneck. Existing compression techniques, which can po-tentially tackle the second challenge, are far from realiz-ing the full potential in storage and energy reduction, be-cause they mostly focus on the CNN algorithm itself. To this end, this work proposes SACoD, a Sensor Algorithm Co-Design framework to develop more efficient CNN-powered
PhlatCam.
In particular, the mask coded in the Phlat-Cam sensor and the backend CNN model are jointly op-timized in terms of both model parameters and architec-tures via differential neural architecture search. Extensive experiments including both simulation and physical mea-surement on manufactured masks show that the proposed
SACoD framework achieves aggressive model compression and energy savings while maintaining or even boosting the task accuracy, when benchmarking over two state-of-the-art (SOTA) designs with six datasets across four different vision tasks including classification, segmentation, image translation, and face recognition. Our codes are available at: https://github.com/RICE-EIC/SACoD. 1.

Introduction
Recent CNN breakthroughs trigger a growing demand for intelligent IoT devices, such as wearables and biology devices (e.g., swallowed endoscopes). However, two ma-jor challenges are hampering more extensive applications of CNN-powered IoT devices. First, some applications, es-pecially medicine- and biology-related ones, impose strict requirements on the form factor, especially the thickness, which are often too stringent for existing lens-based imag-ing systems. Second, powerful CNNs often come at a con-siderable cost, whereas IoT devices are subject to limited resources [23, 21, 26, 43, 38].
For the first challenge, lensless imaging systems [3, 32, 1, 2, 4] have emerged as a promising rescue. For exam-ple, PhlatCam [4] replaces the focal lenses with a set of phase masks, which encodes the incoming light instead of directly focusing it. The encoded information can be either computationally decoded to reconstruct the images or pro-cessed specifically for different applications. Such lensless imaging systems can be made much smaller and thinner, be-cause the phase masks are smaller than the focal lens, and they can be placed much closer to the sensors and fabricated with much lower costs. For the second challenge, many re-cent works focus on designing CNNs with improved hard-ware efficiency, i.e., by applying generic neural architecture search (NAS) to find efficient CNNs.
As such, a naive way to address the two aforementioned challenges simultaneously is to introduce lensless cameras as the signal acquisition frontend and then apply NAS to op-timize the backend CNN. However, such approaches would result in disjoint optimization that can be far from optimal.
A generic NAS would treat the camera as given, and only optimize the CNN. Likewise, existing phase mask designs for lensless cameras treat the CNNs as given, and only opti-mize the masks. Such disjoint optimization fails to (1) take advantage of the masks’ potential computational capacity, with which the NAS optimization can be fundamentally im-proved, and (2) perform an end-to-end optimization.
[4] shows that, under some assumptions, the phase masks in PhlatCam essentially perform 2D convolutions on the incoming lights, and the convolution kernel is encoded in the masks. Moreover, unlike other convolutional layers,
the phase masks’ convolutions are almost free (i.e., do not consume additional energy, computation power, or storage), regardless of what value each mask takes. Therefore, we aim to incorporate the phase mask design into NAS to en-able an end-to-end optimization of the sensing-processing pipeline, while exempting a portion of the pipeline from the efficiency penalties. Such co-designs are expected to achieve better accuracy and efficiency tradeoffs.
To this end, we propose a Sensor Algorithm Co-Design (SACoD) framework to enable more energy-efficient CNN-powered IoT devices. While we develop and evaluate
SACoD in the context of PhlatCam [4] based imaging sys-tems, it is generally applicable to different sensing and intel-ligent processing systems. The successful proposal, design, and validation of SACoD is expected to positively impact many real-world applications by enabling CNNs to be more extensively deployed into IoT devices equipped with intel-ligent sensors. Our main contributions are:
• We propose SACoD, a novel co-design framework that jointly optimizes the sensor and neural networks to en-able more energy-efficient CNN-powered IoT devices.
To our best knowledge, SACoD is the first to propose sensor algorithm co-design for CNN inferences.
• We develop an effective design of the optical layer to (1) exploit its potential computation capability and (2) enable co-search of the optical layer and backend al-gorithm. We then characterize the trade-off between accuracy and the required area of the corresponding imaging systems to demonstrate its effectiveness un-der practical size constraints.
• Extensive experiments and ablation studies validate that SACoD consistently achieves reduced hardware costs/area while offering a comparable or even better task accuracy, when evaluated over two SOTA lensless imaging systems on four vision tasks (classification, segmentation, image translation, and face recognition) and six datasets. Experiments with fabricated masks are also provided to validate SACoD’s advantages un-der the physical measurements. 2.