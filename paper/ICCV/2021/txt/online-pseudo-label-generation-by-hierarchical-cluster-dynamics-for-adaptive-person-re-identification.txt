Abstract
Adaptive person re-identiﬁcation (adaptive ReID) tar-gets at transferring learned knowledge from the labeled source domain to the unlabeled target domain. Pseudo-label-based methods that alternatively generate pseudo la-bels and optimize the training model have demonstrated great effectiveness in this ﬁeld. However, the generated pseudo labels are inaccurate and cannot reﬂect the true se-mantic meaning of the unlabeled samples. We consider such inaccuracy stems from both the lagged update of the pseudo labels as well as the simple criterion of the employed clus-tering method. To tackle the problem, we propose an online pseudo label generation by hierarchical cluster dynamics for adaptive ReID. In particular, hierarchical label banks are constructed for all the samples in the dataset, and we update the pseudo labels of the sample in each coming mini-batch, performing the model optimization and the la-bel generation simultaneously. A new hierarchical clus-ter dynamics is built for the label update, where cluster merge and cluster split are driven by a possibility com-puted by the label propagation. Our method can achieve better pseudo labels and higher reid accuracy. Extensive experiments on Market-to-Duke, Duke-to-Market, MSMT-to-Market, MSMT-to-Duke, Market-to-MSMT, and Duke-to-MSMT verify the effectiveness of our proposed method. 1.

Introduction
Person re-identiﬁcation (ReID) aims at retrieving the same person’s images across different cameras [45, 13, 46, 22, 15, 17]. Despite the great advances of ReID with deep learning models [23, 34, 37, 44, 3], ReID still remains a challenge due to the various distributions of
∗ These authors contributed equally.
† Corresponding author.
Figure 1. Schematic representation of online pseudo label reﬁne-ment by hierarchical cluster dynamics. Different colors represent different clusters. Hierarchical labels are reﬁned from low level to high level. In each level, clusters undergo the split and merge process in sequence (from left to right). For cluster split in h-th level, the clusters in (h − 1)-th level serve as the indivisible split units. For cluster merge in h-th level, the cluster in (h+1)-th level provides a merge border which restricts the cluster candidates that can be merged. Label propagation is then leveraged to split and merge clusters in a uniﬁed framework. images captured by different camera systems, which is known as domain shift. Unsupervised Adaptive Person
Re-identiﬁcation (Adaptive ReID) is therefore proposed to transfer the learned knowledge from the labeled source do-main (dataset) to correctly measure the inter-instance afﬁni-ties in the unlabeled target domain (dataset).
Clustering-based methods [30, 54, 55, 14, 58] dominated the state-of-the-art performances for both adaptive and un-supervised ReID tasks. They adopted an iterative two-stage training scheme, where the pseudo labels are gener-ated ofﬂine by clustering the extracted features before each training epoch. Although the clustered pseudo labels can
roughly capture the global distributions, we argue that the supervision signals by these labels are sub-optimal, since the ofﬂine label generation scheme fails to capture the vary-ing feature distributions along with the network optimiza-tion on-the-ﬂy. Furthermore, existing methods treated all the data points equally with the same clustering criterion, ignoring the ﬁne-grained distributions of the complex real-world data. For example, person images captured by the same camera (domain) should be imposed a more strict cri-terion on clustering than those across cameras (domains).
To tackle the challenges above, we propose an online pseudo label generation strategy by exploring how to dy-namically and progressively update the pseudo labels un-der a bottom-up framework. With the bottom-up frame-work, we can capture the ﬁne-grained distributions of com-plex real-world data. With the well-designed dynamics for cluster split and merge, we can capture the instant semantic variation of the feature space. With the proposed method, the pseudo label generation and the feature learning can be conducted simultaneously in each training iteration.
Speciﬁcally, to enable the online pseudo label genera-tion, we build a feature bank together with a hierarchical label bank for storing and updating the features and pseudo labels of all the unlabeled data, respectively. Given the en-coded features of the samples in a mini-batch, the relevant sample features in the feature bank are momentum updated, and the corresponding labels are reﬁned by merging to an existing cluster or splitting into a new cluster. The merge-and-split operation is achieved by propagating the pseudo labels among a set of clusters in terms of cluster-to-sample or sample-to-sample afﬁnities, dubbed as “cluster dynam-ics” in our paper. Cluster dynamics is conducted iteratively to form a hierarchical pseudo label progression (as illus-trated in Figure 1). The hierarchical label reﬁnement struc-ture also proves to be effective for capturing complex fea-ture distribution of real images. Similar to mutualism in the ecosystem, the introduced cluster dynamics and the hi-erarchically progressed pseudo labels can properly capture the instant and diverse distribution variations in the feature space, leading to better performance of adaptive ReID.
The contributions of our work are summarized as three-folds. (1) We for the ﬁrst time introduce to generate and update the pseudo labels online for adaptive ReID, where feature learning and pseudo label generation proceed simul-taneously. (2) A novel cluster dynamics method is pro-posed to enable pseudo label progression and reﬁnement iteratively in a bottom-to-up hierarchical structure. (3) Ex-tensive experiments on multiple adaptive ReID benchmarks demonstrate the superiority of properly capturing the vary-ing and ﬁne-grained feature distributions by our method. 2.