Abstract
A medical imaging model is usually explored for the di-agnosis of a single disease. However, with the expanding demand for multi-disease diagnosis in clinical applications, multi-function solutions need to be investigated. Previous works proposed to either exploit different disease labels to conduct transfer learning through ﬁne-tuning, or transfer knowledge across different domains with similar diseases.
However, these methods still cannot address the real clini-cal challenge - a multi-disease model is required but anno-tations for each disease are not always available. In this paper, we introduce the task of transferring knowledge from single-disease diagnosis (source domain) to enhance multi-disease diagnosis (target domain). A category-invariant cross-domain transfer (CCT) method is proposed to address this single-to-multiple extension. First, for domain-speciﬁc task learning, we present a conﬁdence weighted pooling (CWP) to obtain coarse heatmaps for different disease cat-egories. Then, conditioned on these heatmaps, category-invariant feature reﬁnement (CIFR) blocks are proposed to better localize discriminative semantic regions related to the corresponding diseases. The category-invariant char-acteristic enables transferability from the source domain to the target domain. We validate our method in two popular areas: extending diabetic retinopathy to identifying multi-ple ocular diseases, and extending glioma identiﬁcation to the diagnosis of other brain tumors. 1.

Introduction
Over the past decades, increasingly more automatic dis-ease diagnosis systems have been developed for different medical imaging tasks [35, 51, 57, 59]. In some speciﬁc ap-∗Corresponding author: Yi Zhou (yizhou.szcn@gmail.com)
Figure 1. Motivation of the proposed CCT-Net. The knowledge learned from the well-explored single-disease diagnosis with ﬁne-grained annotations can be transferred to improve the diagnosis of multiple related diseases without annotations. plications, large data with ﬁne-grained annotations have fa-cilitated model development and led to signiﬁcant progress.
For example, diabetic retinopathy (DR) diagnosis, includ-ing DR grading [19, 21] and lesion segmentation [44, 56], has been well studied on fundus images. Glioma identiﬁ-cation, including tumor segmentation [20, 5, 9], has been successfully applied on brain MRI scans. Recently, many
COVID-19 detection models [54, 27, 40] have also been rapidly developed using the annotated lung CT data. How-ever, most of these works only focus on a single disease, which limits their transferability to other related diseases. In most clinical departments, multi-disease diagnosis (e.g. oc-ular diseases: DR, glaucoma, hypertension, myopia; brain tumors: glioma, meningioma, pituitary tumor; lung inﬂam-mation: community acquired, viral, bacteria pneumonia), has higher practical value and is preferred by clinicians.
Therefore, as illustrated in Fig. 1, this work aims to transfer the ability of learning discriminative features from the well-explored single-disease diagnosis with rich annotations to multi-disease diagnosis with limited annotations.
Previous works on transfer learning from one disease to another can be coarsely categorized into two types. The
ﬁrst type adopts models pre-trained on annotated natural images [29] or similar-domain data and then ﬁne-tune them for new diseases [26, 19]. The low-level features of similar-domain data can be shared so that the model only needs to transfer the high-level semantic disease category informa-tion. However, this approach usually requires extensive an-notation for new diseases. Since annotating medical data requires professional knowledge and is time-consuming, we cannot expect rich annotations to be available for all diseases. The second type focuses on domain adaptation
[49, 12, 4, 30, 15, 34] for different-domain data that have the same disease or lesion types. These works aim to transfer domain-invariant knowledge from labeled source domain data to unlabeled target domain data. For example, unsu-pervised lesion segmentation models for endoscopic data
[11] have been explored through domain adaptation using labeled gastroscope segmentation data. However, this trans-fer is only feasible when the disease categories of the two domains are the same: cancer, polyp, gastritis, ulcer and bleeding. In more general clinical scenarios, multi-disease diagnosis of diseases that do not share similar appearances is required, but annotations for each disease are not always available. Thus, it is difﬁcult to directly apply these existing models to address the practical problems.
In this paper, we focus on the problem where the two do-mains have different disease identiﬁcation tasks, with the source domain having pixel-level labels for a single dis-ease and the target domain involving more diseases, with-out ﬁne-grained annotations (only image-level disease cat-egories are known). We propose a category-invariant cross-domain transfer method to learn the knowledge from the source domain task and improve both the classiﬁcation and localization performance of the target domain task. The main contributions of this work are as follows: 1. A domain-speciﬁc task learning module is designed to learn domain-invariant features while preserving the disease discrepancy between two domains. A CWP global pooling method is proposed to obtain better class activation maps (CAMs) than other global pooling operations. 2. Conditioned on the coarse heatmaps of different cat-egories, we propose CIFR blocks to construct the CCT-Net for localizing more discriminative regions of the cor-responding diseases. The category-invariant characteristic enables the transferability from the source domain to target domain. Moreover, such reﬁned features can contribute to the ﬁnal classiﬁcation performance as well. 3. Experimental evaluations are conducted in two pop-ular medical imaging tasks. First, we extend DR diagnosis on fundus images to the diagnosis of multiple ocular dis-eases, such as glaucoma and hypertension. Second, glioma segmentation on brain MRI scans is exploited to improve the segmentation and classiﬁcation performance of other tu-mors, such as meningioma and pituitary tumors. Experi-mental results demonstrate the effectiveness of our method. 2.