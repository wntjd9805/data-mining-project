Abstract
Learning socially-aware motion representations is at the core of recent advances in multi-agent problems, such as human motion forecasting and robot navigation in crowds. Despite promising progress, existing representa-tions learned with neural networks still struggle to general-ize in closed-loop predictions (e.g., output colliding trajec-tories). This issue largely arises from the non-i.i.d. nature of sequential prediction in conjunction with ill-distributed training data. Intuitively, if the training data only comes from human behaviors in safe spaces, i.e., from “positive” examples, it is difficult for learning algorithms to capture the notion of “negative” examples like collisions. In this work, we aim to address this issue by explicitly modeling negative examples through self-supervision: (i) we intro-duce a social contrastive loss that regularizes the extracted motion representation by discerning the ground-truth posi-tive events from synthetic negative ones; (ii) we construct informative negative samples based on our prior knowl-edge of rare but dangerous circumstances. Our method substantially reduces the collision rates of recent trajectory forecasting, behavioral cloning and reinforcement learn-ing algorithms, outperforming state-of-the-art methods on several benchmarks. Our code is available at https:
//github.com/vita-epfl/social-nce. 1.

Introduction
Humans have an instinctive ability to anticipate the fu-ture motions of other people while navigating in crowded spaces. This ability allows us to not only keep a comfort-able distance from others but also identify potential dangers or discomforts ahead of time. However, building predictive models capable of doing so is challenging. Recent works have proposed a plethora of neural network-based models
[6, 27, 41, 43, 47, 57, 84, 90, 96] to learn socially-aware motion representations for multi-agent problems such as trajectory forecasting [3, 33, 54, 85] and robot navigation
[15, 18, 19]. Yet existing methods still output unaccept-able solutions (e.g., collisions) from time to time in closed-loop predictions, which raises significant safety concerns for real-world deployment.
Figure 1: Illustration of social contrastive learning. Our method promotes the robustness of neural motion models by means of con-trastive representation learning combined with negative data aug-mentation in the multi-agent context.
One key difficulty in learning robust motion representa-tion stems from the common shortage of critical data. Very often, the training data is only collected from human be-haviors in safe scenarios. The lack of near-accident exam-ples poses a significant challenge to the discovery of so-cial norms from data. As a consequence, prediction er-rors made by the learned model may accumulate over time, gradually create a discrepancy between the training and test state distributions, and eventually cause catastrophic errors
[22, 25, 81].
Previous methods attempt to mitigate this issue through interactive data collections, such as expert queries [26, 53, 60, 82, 92] and additional experiments [12, 40, 48, 77, 97].
Unfortunately, these methods are not only costly and te-dious but often impractical for forecasting problems, since human behaviors can hardly be intervened at scale for data collection. These shortcomings motivate us to explore an alternative approach: given a fixed training dataset, can we learn a robust motion representation by exploiting our prior knowledge through self-supervision?
To this end, we propose a social contrastive learning method built with negative data augmentation (Figure 1).
Our main idea is to promote robust representations by learn-ing from the opposites [74].
Intuitively, an effective way to elucidate the social norms that give rise to the “posi-tive” examples is to explicitly portray the opposite “nega-(a) Conventional supervised learning (b) Interactive data collection (c) Our contrastive approach
Figure 2: Illustration of different learning approaches to socially-aware sequential predictions. (a) The vanilla supervised learning ap-proach often suffers from covariate shift between the training (blue) and test (red) data due to the dependence of the state distribution (e.g., separation distance d between agents) on the learned model [25, 81]. (b) Interactive data collection methods [26, 40, 53, 82] expand the training distribution to a wider range (green) through additional experiments, which are however expensive and even infeasible for forecasting problems. (c) Our social contrastive learning approach augments negative data based on prior knowledge, explicitly informing the learned model about unfavorable states (gray) for improved robustness. tive” examples. We formulate this intuition into an auxil-iary contrastive loss, named Social-NCE. It encourages the extracted motion representation to preserve sufficient infor-mation for distinguishing a positive event from a set of neg-ative ones.
One crucial component of our method is the design of positive and negative events (states at a specific time step in the future). Existing contrastive methods in vision and lan-guage domains often rely on carefully designed data aug-mentation for positive pairs while using random samples to form negative pairs [16, 17, 32, 36, 65, 73, 98]. Despite its effectiveness for unsupervised pre-training, this common choice is not suitable for motion problems, since it does not bring any extra information than the main task about social norms. To more explicitly inject our prior knowledge, we introduce a social sampling strategy: construct the positive event from the ground-truth location of the primary agent and the negative events from the regions of other neigh-bors, given that one location cannot be occupied by mul-tiple agents at the same time. As illustrated in Figure 2, our method can be viewed as a form of negative data augmen-tation [88]. It intentionally informs the model about low-density states through self-supervision, as opposed to labo-riously collecting state-action pairs from dangerous scenar-ios.
We evaluate our method on three tasks: human trajectory forecasting, behavioral cloning, and reinforcement learning for robot navigation in crowds. Experimental results show that our proposed Social-NCE consistently reduces the col-lision rates and yields new state-of-the-art results on several benchmarks. Our method is model-agnostic and hence can be used as a generic component to promote the robustness of neural motion models. 2.