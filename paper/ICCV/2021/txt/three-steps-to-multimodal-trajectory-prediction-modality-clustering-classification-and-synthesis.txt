Abstract
Multimodal prediction results are essential for trajec-tory prediction task as there is no single correct answer for the future. Previous frameworks can be divided into three categories: regression, generation and classification frameworks. However, these frameworks have weaknesses in different aspects so that they cannot model the multi-modal prediction task comprehensively. In this paper, we present a novel insight along with a brand-new prediction framework by formulating multimodal prediction into three steps: modality clustering, classification and synthesis, and address the shortcomings of earlier frameworks. Ex-haustive experiments on popular benchmarks have demon-strated that our proposed method surpasses state-of-the-art works even without introducing social and map informa-tion. Specifically, we achieve 19.2% and 20.8% improve-ment on ADE and FDE respectively on ETH/UCY dataset. 1.

Introduction
Trajectory prediction is one of the cornerstones of au-tonomous driving and robot navigation [22, 9, 27, 28, 35, 37, 12], which investigates reasonable future states of traf-fic agents for the following decision-making process. Con-sidering the uncertainty of human behaviors and the mul-timodal nature of the future [8, 14], one great challenge of trajectory prediction lies in predicting all possible future tra-jectories of high probabilities.
To tackle this problem, previous research mainly fol-lows three lines. The first line adds extra randomness for regression frameworks [36, 18], while the second genera-tion line [8, 14, 21, 29] models the multimodal nature by learning a distribution of the future. But both lines have two defects as shown in Fig. 1: i) lack of probability cor-§Cewu Lu is corresponding author, member of Qing Yuan Research
Institute and MoE Key Lab of Artificial Intelligence, AI Institute, Shanghai
Jiao Tong University, China and Shanghai Qi Zhi institute. responding to each modality which may leave the decision process confusing, and ii) the prediction results are not de-terministic which may leave potential safety risks.
The third line of classification frameworks [4, 26] gets rid of the two defects by classifying the observation to predefined future trajectories, as the classification opera-tion can give probabilities and ensure determinacy. How-ever, the classification frameworks still face certain weak-nesses. First, the predefined trajectories are obtained by hand-crafted principles, thus it is difficult to capture com-prehensive representations for future behaviors. Second, the predicted deterministic trajectories will be the same for different inputs classified to a same class, which fails to explore fine-grained motions for traffic agents determinis-tically. Due to these weaknesses, the performance of a clas-sification framework lags behind state-of-the-art regression and generation models. Further, a highly annotated scene raster is required as the input of classifier which is difficult to access in many cases.
In this paper, we aim to explore a distinct formulation for trajectory prediction framework to address the short-comings discussed above. We present the insight of Pre-diction via modality Clustering, Classification and Syn-thesis (PCCSNet) by solving multimodal prediction with a classification-regression approach.
In our vision, the modalities of the future are usually centralized around a few different behaviors which can be revealed by a series of learned modality representations. We can apply a deep clustering process [3] on training samples and each center of clusters could represent a modality. Naturally, such a modality can be formulated into a class, and a classifica-tion network can be adopted to distinguish and score the modalities according to the observed trajectory in this man-ner. Finally, a synthesis process is used to regress prediction results for highly probable modalities with historical states and the modality representations.
We propose a modular designed framework to model this novel insight summarized in Fig. 2. States of agents are first fed into feature encoders to get deep historical and future representations for better clustering, classification and syn-system (meters) in real world in this paper.
Multimodal prediction task is non-trivial as a single input may map to multiple outputs. Early works [1, 22, 34, 12] ignore the multimodality of the future and only aim at pre-dicting the most possible future trajectory. Recently, a great number of research proposes various frameworks to formu-late this non-functional relationship. They mainly follow three common practices, regression, generation and classi-fication.
Regression Frameworks. Regression models [1, 19] are first proposed to solve unimodal prediction tasks and show great performance. However, these encode-decode struc-tures are not able to give multimodal predictions, and some methods address this defect by adding noise [36] or using random initialization [18]. Although multiple different pre-dictions can be obtained by imposing randomness on the model, it is difficult for randomness to accurately model the multimodal nature of future.
Generation Frameworks. Some research considers the multimodality of the future as a distribution, formulates trajectory prediction as a distribution fitting and sampling problem, and introduces generative models to solve it. DE-SIRE [14] first introduces stochastic model to learn the dis-tribution of future states, and generates diverse predictions by sampling plausible hypotheses from that distribution.
Following this formulation, plenty of research [8, 21, 29] aims at designing different generative structures to pursue more reasonable outcomes and achieve the state-of-the-art performance.
Classification Frameworks. Some research [4, 26] at-tempts to use a classification network to solve this problem by classifying on predefined artificial modalities. Multi-path [4] clusters a fixed set of anchor trajectories with mean square error distance, and classifies the input to these an-chors. CoverNet [26] revises Multipath by manually de-signing anchors. Approaches under this framework face three main weakness. First, the predefined trajectories are obtained by subjectively designated clustering distance or manually designed anchors, thus it is difficult to capture the full range of future behaviors. Second, it is hard for these predefined trajectories to capture fine-grained motions. Fur-ther, both methods require a highly annotated scene raster as input which is difficult to access in many cases.
Probability and Determinacy. The properties of probabil-ity and determinacy are important for a multimodal predic-tion approach. i) Probability. The probabilistic property of future [11] are extremely helpful to improve the effective-ness of the ensuing decision-making process. In Fig. 1 (a), a probabilistic prediction can tell that the pedestrian is most unlikely to take the left path (on the reader’s side). There-fore, the robot can follow the left path (on the reader’s side)
Figure 1. Examples of why probability and determinacy of a pre-diction algorithm is important. In figure (a), a probabilistic predic-tion (indicated by the thickness of the lines) will significantly re-duce the probability of collisions. Figure (b) illustrates a potential safety hazard of stochastic predictions, since the red path should always be predicted for safety purposes. A detailed discussion is in Sec. 2. thesis [2]. These deep features are clustered for modality representations and used to train a classifier where the clus-ter assignments are seen as pseudo-labels. The classifier will score the modalities according to historical representa-tions in test phase for probabilistic prediction. A synthesis module is then introduced to regress pseudo future repre-sentations for each modality, and finally both historical and synthesized future representations are decoded to get fine-grained deterministic predictions. Moreover, we newly pro-pose a Modality Loss to enhance the capability of the clas-sifier to identify multiple highly probable future modalities.
We conduct exhaustive experiments on multiple popular trajectory prediction benchmarks. In these experiments, our novel prediction framework exhibits high accuracy, great robustness and adequate projections for the future. Specif-ically, we achieve 19.2% and 20.8% improvement in aver-age on ADE and FDE respectively on ETH [25]/UCY [13] datasets comparing with state-of-the-art method [36]. 2.