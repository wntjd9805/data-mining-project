Abstract
Compressive imaging using coded apertures (CA) is a powerful technique that can be used to recover depth, light
ﬁelds, hyperspectral images and other quantities from a sin-gle snapshot. The performance of compressive imaging sys-tems based on CAs mostly depends on two factors: the prop-erties of the mask’s attenuation pattern, that we refer to as
“codiﬁcation”, and the computational techniques used to recover the quantity of interest from the coded snapshot. In this work, we introduce the idea of using time-varying CAs synchronized with spatially varying pixel shutters. We di-vide the exposure of a sensor into sub-exposures at the be-ginning of which the CA mask changes and at which the sen-sor’s pixels are simultaneously and individually switched
“on” or “off”. This is a practically appealing codiﬁcation as it does not introduce additional optical components other than the already present CA but uses a change in the pixel shutter that can be easily realized electronically. We show that our proposed time-multiplexed coded aperture (TMCA) can be optimized end to end and induces better coded snap-shots enabling superior reconstructions in two different ap-plications: compressive light ﬁeld imaging and hyperspec-tral imaging. We demonstrate both in simulation and with real captures (taken with prototypes we built) that this codi-ﬁcation outperforms the state-of-the-art compressive imag-ing systems by a large margin in those applications. 1.

Introduction
Computational imaging techniques combining the co-design of hardware and algorithms have successfully en-abled the development of novel cameras for several appli-cations such as spectral imaging [2], depth imaging [11], light-ﬁeld imaging [35], or computed tomography [25].
Among those, in particular compressive imaging [13] ap-proaches that aim at multiplexing visual information in a single snapshot have been popularized to reconstruct high dynamic range images, videos, spectral or depth informa-∗ denotes equal contributions.
Figure 1. An illustration of the proposed Time Multiplexed Coded
Aperture (TMCA) codiﬁcation in the proposed end-to-end differ-entiable pipeline. We also show coded snapshot and reconstruction examples for our compressive light ﬁeld and hyperspectral imag-ing applications. tion [36, 58, 12]. They use optical and electronic cod-ing strategies to encode light and use physics-based for-ward models along with optimization techniques to recon-struct the aforementioned visual quantities. Besides their ability to recover visual information not easily accessible with traditional cameras, another advantage of compressive imaging systems is they can realize sparse measurements, for instance capturing a single coded snapshot to recover a whole light ﬁeld. This typically yields ill-posed reconstruc-tion problems that can nevertheless be solved by leveraging knowledge about the signal’s sparsity and using other pri-ors about the visual quantity to reconstruct. For optimal re-construction, compressive sensing theory usually assumes dense uncorrelated measurement matrices. However, this is rarely the case, as those measurement matrices are induced by design constraints and the physical realization of the op-tical and electronic codiﬁcations. As a result, those matri-ces are almost always sparse and highly structured, thus im-peding the performance of compressive imaging systems.
Hence, the main lever to improve those systems is to im-prove their codiﬁcation.
In particular, many compressive imaging systems em-ploy coded aperture (CA) masks as codiﬁcation elements
[44, 29, 51, 45, 35, 3, 5]. CAs are physical components inserted in the optical system to spatially modulate light in-tensity. As an example, the coded aperture snapshot spec-tral imaging system (CASSI) presented in [52, 2] employs a dispersive element behind a CA used to select the spatial lo-cations that get spectrally dispersed. Those CAs can be fab-ricated using inexpensive technologies (such as chrome-on-quartz) for simple binary codes. However creating multi-valued color codes, yielding much better reconstructions, requires expensive microlithography and coating technolo-gies [3]. Yet another example illustrating the use of CA masks in compressive imaging is in the reconstruction of light ﬁelds, for instance by using a CA inserted between the sensor and the objective lens [35]. In this system, correla-tions in the measurement matrix are created by the similar-ity between the angular views and typically limit the quality of the light-ﬁeld reconstructions. These two examples illus-trate the need for CA systems that yield better codiﬁcations and that are still easy and inexpensive to implement.
This work addresses this challenge by proposing a new codiﬁcation we call Time-Multiplexed Coded Aperture (TMCA). It induces a better conditioning of those measure-ment matrices and can be realized using existing compo-nents that are widely used in compressive imaging systems.
The proposed TMCA consists of using a conventional am-plitude CA along with a coded exposure. Coded exposures are temporal modulations of the pixel of a sensor. In a coded exposure, a shutter function turns individual pixels “on” or
“off” during the exposure, thus modulating light integration.
Pixel-wise shutters can be realized electronically modifying the pixel architecture [34, 53, 32, 50] or using spatial light modulators (SLMs) [20]. More speciﬁcally, we generate a TMCA by synchronizing a CA that changes its pattern in time –dubbed as a time-varying CA– and a spatially varying shutter-function realizing a coded exposure. We show that this combination produces a new family of CAs with better codiﬁcation capabilities that we demonstrate in two speciﬁc compressive imaging applications: hyperspectral imaging and light-ﬁeld imaging.
Furthermore, we propose to learn the TMCA codiﬁca-tion, inspired by works in deep optics [34, 11, 36, 57, 40, 55]. We perform the joint optimization of the TMCA codes along with a neural network (NN) used to recover the light
ﬁelds or hyperspectral images. Our end-to-end (E2E) differ-entiable approach can be interpreted as an encoder–decoder framework in which the encoder performs the optical-electronic codiﬁcation and a digital decoder (the NN) is used for reconstruction. The CA and shutter functions are optimized for each application in simulation, considering the speciﬁc constraints of the spatial light modulators realiz-ing the CA and of the sensor realizing the coded exposures.
After training, the optimized TMCA codes can be deployed to physical devices that can be used to capture real-world scenes.
We summarize the contributions of our work as follows:
• We introduce a new codiﬁcation for compressive imaging systems called time-multiplexed coded aperture (TMCA).
• We develop new forward models based on the use of
TMCAs for two applications: hyperspectral imaging and compressive light ﬁeld imaging. In the ﬁrst case, we show
TMCA emulates an expensive color ﬁlter array, while in the second, the TMCA is an angular sensitive CA result-ing in less correlations in the coding of angular views.
• We learn, in simulation, differentiable optical electronic encoders realizing the TMCAs as well as a NN decoders solving the reconstruction problems. We demonstrate that the learned codes compare favorably against baselines that use traditional CA as well as against our own TMCA baselines using non-optimized codes.
• We build two prototypes: a compressive light ﬁeld imag-ing system and a hyperspectral imager. We translate the learned TMCA codes to hardware and conduct real exper-iments showing the better results of TMCA in simulation transposes to real-world systems. 2.