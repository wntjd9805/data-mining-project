In this paper, we propose a novel square root formulation for optimization-based sliding-window estimators in visual odometry (VO) and visual-inertial odometry (VIO). We demonstrate that our square root estimator achieves the same accuracy as the conventional baseline estimator, even in single precision computation. We introduce a specialized QR decomposition as one of the components of our square root formulation and prove its analytical equivalence with marginalization based on the Schur complement technique and Cholesky decomposition. Our QR marginalization method naturally handles the case of rank-deficient Jacobians. We show that our proposed square root formulation enables optimization-based VO and VIO to be performed with single-precision floating-point computations without sacrificing accuracy. Additionally, we analyze the effect of using nullspace projection combined with our specialized QR decomposition on runtime and accuracy, and our results show that the proposed square root estimator is faster than the baseline method by 23% and even faster (by 36%) when switching to single precision. Our implementation is released as open source.