We present a flexible deep image compression network that utilizes Spatial Feature Transform (SFT) as its foundation. The network takes an input source image and a corresponding quality map and generates a compressed image at variable rates. Our model is capable of covering a wide range of compression rates using a single model, with the compression rate controlled by pixel-wise quality maps. Additionally, our framework enables task-specific image compression for various tasks such as classification, without the need for separate models for each task. This capability is achieved by efficiently estimating optimized quality maps specific to the target tasks within our encoding network, even with a pretrained network. Our algorithm achieves exceptional trade-offs between rate and distortion compared to approaches that rely on multiple models optimized separately for different target rates. Furthermore, our proposed approach improves performance on image classification and preserves text region quality at the same compression level through task-aware quality map estimation, without requiring additional model training. The code for our approach is available on the project website1.