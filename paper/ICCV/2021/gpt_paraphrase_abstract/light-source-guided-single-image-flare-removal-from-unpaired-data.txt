Causally-taken images often contain flare artifacts caused by unintended reflections and scattering of light within the camera. Removing these flares is challenging because they can appear in various shapes, positions, and colors. Existing methods rely on predefined characteristics of flares, which can lead to difficulties distinguishing between flares and actual light sources. This research introduces a deep framework called Single-Image Flare Removal (SIFR) that takes into account the conditions of the light source in the image to effectively remove flares. The framework first detects the light source regions and flare regions separately, and then removes the flare artifacts based on the guidance provided by the light source. Instead of using paired training data, which is hard to collect, this study proposes the first unpaired flare removal dataset and utilizes new cycle-consistency constraints to obtain more diverse examples and avoid the need for manual annotations. Extensive experiments demonstrate that the proposed method outperforms existing methods both qualitatively and quantitatively. Furthermore, the model can also be applied to manipulate flare effects, such as adding or changing image flares.