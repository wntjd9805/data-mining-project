In this paper we present TruFor, a forensic framework that can be applied to a large variety of image manipula-tion methods, from classic cheapfakes to more recent ma-nipulations based on deep learning. We rely on the ex-traction of both high-level and low-level traces through a transformer-based fusion architecture that combines theRGB image and a learned noise-sensitive fingerprint. The latter learns to embed the artifacts related to the cam-era internal and external processing by training only on real data in a self-supervised manner. Forgeries are de-tected as deviations from the expected regular pattern that characterizes each pristine image. Looking for anomalies makes the approach able to robustly detect a variety of lo-cal manipulations, ensuring generalization. In addition to a pixel-level localization map and a whole-image integrity score, our approach outputs a reliability map that high-lights areas where localization predictions may be error-prone. This is particularly important in forensic applica-tions in order to reduce false alarms and allow for a large scale analysis. Extensive experiments on several datasets show that our method is able to reliably detect and local-ize both cheapfakes and deepfakes manipulations outper-forming state-of-the-art works. Code is publicly available at https://grip-unina.github.io/TruFor/. 