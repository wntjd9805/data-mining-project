Deep learning has been utilized in knowledge-based ra-diotherapy planning in which a system trained with a set of clinically approved plans is employed to infer a three-dimensional dose map for a given new patient. However, previous deep methods are primarily limited to simple sce-narios, e.g., a ﬁxed planning type or a consistent beam an-gle conﬁguration. This in fact limits the usability of such approaches and makes them not generalizable over a larger set of clinical scenarios. Herein, we propose a novel con-ditional generative model, Flexible-Cm GAN, utilizing ad-ditional information regarding planning types and various beam geometries. A miss-consistency loss is proposed to deal with the challenge of having a limited set of condi-tions on the input data, e.g., incomplete training samples.To address the challenges of including clinical preferences, we derive a differentiable shift-dose-volume loss to incor-porate the well-known dose-volume histogram constraints.During inference, users can ﬂexibly choose a speciﬁc plan-ning type and a set of beam angles to meet the clinical re-quirements. We conduct experiments on an illustrative face dataset to show the motivation of Flexible-Cm GAN and fur-ther validate our model’s potential clinical values with two radiotherapy datasets. The results demonstrate the supe-rior performance of the proposed method in a practical het-erogeneous radiotherapy planning application compared to existing deep learning-based approaches. 