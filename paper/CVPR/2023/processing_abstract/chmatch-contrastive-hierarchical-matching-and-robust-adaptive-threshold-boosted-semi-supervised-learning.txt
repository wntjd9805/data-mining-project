The recently proposed FixMatch and FlexMatch have achieved remarkable results in the ﬁeld of semi-supervised learning. But these two methods go to two extremes as Fix-Match and FlexMatch use a pre-deﬁned constant threshold for all classes and an adaptive threshold for each category, respectively. By only investigating consistency regulariza-tion, they also suffer from unstable results and indiscrim-inative feature representation, especially under the situa-In this paper, we propose a tion of few labeled samples. novel CHMatch method, which can learn robust adaptive thresholds for instance-level prediction matching as well as discriminative features by contrastive hierarchical match-ing. We ﬁrst present a memory-bank based robust thresh-old learning strategy to select highly-conﬁdent samples. In the meantime, we make full use of the structured informa-tion in the hierarchical labels to learn an accurate afﬁnity graph for contrastive learning. CHMatch achieves very sta-ble and superior results on several commonly-used bench-marks. For example, CHMatch achieves 8.44% and 9.02% error rate reduction over FlexMatch on CIFAR-100 underWRN-28-2 with only 4 and 25 labeled samples per class, respectively1. 