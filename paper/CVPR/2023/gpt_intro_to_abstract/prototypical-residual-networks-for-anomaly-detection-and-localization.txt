The human cognition and visual system have the ability to perceive anomalies and locate them accurately within images. Anomaly detection and localization techniques have been widely used in various fields such as industrial defect detection, medical image analysis, and video surveillance. However, addressing both detection and localization problems simultaneously remains a challenge. Real-world anomalous data poses three main challenges: imbalanced learning due to limited abnormal samples, difficulty in discerning subtle anomalies within predominantly normal images, and variations in the appearance of anomalies. To overcome these challenges, we propose a Prototypical Residual Network (PRN) that constructs normal patterns using prototypes of intermediate feature maps and learns relationships among patches from multiple receptive fields using a multi-size self-attention mechanism. Additionally, our model learns to reconstruct the anomaly segmentation map with pixel-level supervision and utilizes anomaly generation strategies to mitigate data imbalance and enrich anomaly appearance. Experimental results on four datasets demonstrate that our approach achieves state-of-the-art performance in anomaly detection and significantly outperforms existing methods in anomaly localization.