Raw images have unique advantages in computer vision tasks due to their unprocessed and uncompressed format obtained directly from camera sensors. They allow for easier modeling of real image noise, enabling generalized deep real denoising networks. Raw images also have a linear relationship with scene radiance, allowing for the recovery of shadows and highlights without introducing grainy noise. Additionally, the richer color information in raw images provides more flexibility for correction and artistic manipulation. However, the large file sizes and the need for additional post-processing steps have limited the widespread adoption of raw images by common users. To address this, raw image reconstruction methods aim to minimize the amount of metadata required for de-rendering sRGB images back to raw space. While existing sparse sampling-based methods have made significant progress, they still face limitations in coding efficiency and image reconstruction quality. The bit allocation needs to be adaptive and globally optimized for different image contents, considering the non-linear transformations and quantization steps in the image signal processing (ISP) pipeline. In this paper, we propose a novel end-to-end learned raw image reconstruction framework based on encoded latent features. Instead of using pre-defined sampling strategies or sampling losses, we optimize the use of stored metadata by minimizing the reconstruction loss and its bitstream cost simultaneously. We further introduce an sRGB-guided context model based on a learnable order prediction network to improve rate-distortion performance. Our method outperforms previous strategies in terms of reconstruction quality, metadata size, and computational speed. Our contributions include the proposal of the first end-to-end deep encoding framework for raw image reconstruction, the introduction of a novel sRGB-guided context model with improved entropy estimation strategies, and the evaluation of our method on popular raw image datasets, showing better reconstruction quality with less required metadata compared to state-of-the-art methods.