Uncalibrated photometric stereo (UPS) is a challenging problem due to the uncertainty caused by unknown lighting conditions. While the ambiguity can be reduced for non-Lambertian objects, it remains difficult to solve for more complex objects with irregular shadows and materials with anisotropic reflectance. In order to address this challenge and improve UPS performance on general materials, we propose DANI-Net, an inverse rendering framework that incorporates differentiable shadow handling and anisotropic reflectance modeling. Unlike previous methods that rely on non-differentiable shadow maps and assume isotropic materials, our network utilizes cues from both shadows and anisotropic reflectance through two differentiable paths. Our experiments on multiple real-world datasets demonstrate the superior and robust performance of our approach.