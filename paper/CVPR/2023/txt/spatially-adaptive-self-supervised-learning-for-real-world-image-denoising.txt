Abstract
Signiﬁcant progress has been made in self-supervised image denoising (SSID) in the recent few years. However, most methods focus on dealing with spatially independent noise, and they have little practicality on real-world sRGB images with spatially correlated noise. Although pixel-shufﬂe downsampling has been suggested for breaking the noise correlation, it breaks the original information of im-ages, which limits the denoising performance. In this paper, we propose a novel perspective to solve this problem, i.e., seeking for spatially adaptive supervision for real-world sRGB image denoising. Speciﬁcally, we take into account the respective characteristics of ﬂat and textured regions in noisy images, and construct supervisions for them sepa-rately. For ﬂat areas, the supervision can be safely derived from non-adjacent pixels, which are much far from the cur-rent pixel for excluding the inﬂuence of the noise-correlated ones. And we extend the blind-spot network to a blind-neighborhood network (BNN) for providing supervision on
ﬂat areas. For textured regions, the supervision has to be closely related to the content of adjacent pixels. And we present a locally aware network (LAN) to meet the require-ment, while LAN itself is selectively supervised with the out-put of BNN. Combining these two supervisions, a denoising network (e.g., U-Net) can be well-trained. Extensive exper-iments show that our method performs favorably against state-of-the-art SSID methods on real-world sRGB pho-tographs. The code is available at https://github. com/nagejacob/SpatiallyAdaptiveSSID. 1.

Introduction
Image denoising aims to restore clean images from noisy observations [5, 11, 14], and it has achieved noticeable im-provement with the advances in deep networks [2, 10, 21, 29–31, 33, 38, 40, 41, 46–48, 50, 51]. However, the mod-els trained with synthetic noise usually perform poorly in real-world scenarios in which noise is complex and change-(a) Noisy Input (b) CVF-SID [35] (c) AP-BSN+R3 [27] (d) Ours
Figure 1. Visual comparison between self-supervised denoising methods on the DND dataset [37]. PSNR (dB) and SSIM with respect to the ground-truth are marked on the result for quantitative comparison. Our method performs better in removing spatially correlated noise from real-world sRGB photographs. able. A feasible solution is to collect real-world clean-noisy image pairs [1, 37] and take them for model train-ing [2, 15, 21, 46, 47]. But building such datasets generally requires strictly controlled environment as well as compli-cated photographing and post-processing, which is time-consuming and labor-intensive. Moreover, the noise statis-tics vary under different cameras and illuminating condi-tions [43,54], and it is impractical to capture pairs for every device and scenario.
To circumvent the limitations of noisy-clean pairs collection, self-supervised image denoising (SSID) ap-proaches [3, 17, 19, 20, 24, 26–28, 34–36, 42, 45] have been proposed, which can be trained merely on noisy im-ages. However, the noise model assumptions of a large amount of SSID methods do not match the characteristics of real-world noise in sRGB space. For instance, HQ-SSL [26] improves the denoising performance with poste-rior inference, but requires explicit noise probability den-sity. Noise2Score [20] and its extension [19] propose a closed-form image denoising schema with score matching followed by noise model and noise level estimation, but the noise is bounded to Tweedie distribution. Although some methods [17,42] are designed for distribution agnostic noise, they can only deal with spatially independent noise.
Recently, a few attempts have been explored to remove spatially correlated noise in a self-supervised manner. CVF-SID [35] disentangles the image and noise components from noisy images, but the difﬁculty of optimization lim-its its performance. Some methods [44, 57] break the spa-tial noise correlation with pixel-shufﬂe downsampling (PD), then utilize spatially independent denoisers (e.g., blind-spot network [6,26,44]) to remove the uncorrelated noise. How-ever, PD breaks the original information of the images and leads to aliasing artifacts, which largely degrade the image quality. AP-BSN [27] applies asymmetric PD factors and post-reﬁnement processing to seek for a better trade-off be-tween noise removal and aliasing artifacts, but it is time-consuming during inference.
In this paper, we present a novel perspective for SSID by considering the respective characteristics of ﬂat and tex-tured regions in noisy images, resulting in a spatially adap-tive SSID method for real-world sRGB images.
Instead of utilizing pixel-shufﬂe downsampling and blind-spot net-work to learn denoising results directly, we seek for spa-tially adaptive supervision for a denoising network (e.g., U-Net [39]). Concretely, for ﬂat areas, the supervision can be safely derived from non-adjacent pixels, which are much far from the current pixel for excluding the inﬂuence of noise correlation. We achieve it by extending the blind-spot net-work (BSN) [26] to a blind-neighborhood network (BNN).
BNN modiﬁes the architecture of BSN to expand the size of blind region, and takes the same self-supervised train-ing schema as BSN. Note that it is difﬁcult to determine whether an area is ﬂat or not from the noisy images, so we directly apply BNN to the whole image and it has little ef-fect on the handling of ﬂat areas. Moreover, such an op-eration can give us a chance to detect textured areas from the output of BNN, whose variance is usually higher. For textured areas, neighboring pixels are essential for predict-ing the details and they can not be ignored. To this end, we present a locally aware network (LAN), which focuses on recovering the texture details solely from adjacent pix-els. LAN is supervised by ﬂat areas of BNN output. When training is done, LAN will be applied to textured areas to generate supervision information for these areas.
Combining the learned supervisions for ﬂat and textured areas, a denoising network can be readily trained. Dur-ing inference, BNN and LAN can be detached, only the ultimate denoising network is used to restore clean im-ages. Extensive experiments are conducted on SIDD [1] and
DND [37] datasets. The results demonstrate our method is not only effective but also efﬁcient. In comparison to state-of-the-art self-supervised denoising methods, our method behaves favorably in terms of both quantitative metrics and perceptual quality. The contributions of this paper can be summarized as follows:
• We propose a novel perspective for self-supervised real-world image denoising, learning spatially adaptive supervision for a denoising network accord-ing to the image characteristics. i.e.,
• For ﬂat areas, we extend the blind-spot network to a blind-neighborhood network (BNN) for providing su-pervision information. For texture areas, we present a locally aware network (LAN) to learn that from neigh-boring pixels.
• Extensive experiments show our method has superior performance and inference efﬁciency against state-of-the-art SSID methods on real-world sRGB noise re-moval. 2.