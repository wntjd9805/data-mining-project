Abstract
Feature matching is a challenging computer vision task that involves finding correspondences between two images of a 3D scene. In this paper we consider the dense approach instead of the more common sparse paradigm, thus striv-ing to find all correspondences. Perhaps counter-intuitively, dense methods have previously shown inferior performance to their sparse and semi-sparse counterparts for estimation of two-view geometry. This changes with our novel dense method, which outperforms both dense and sparse methods on geometry estimation. The novelty is threefold: First, we propose a kernel regression global matcher. Secondly, we propose warp refinement through stacked feature maps and depthwise convolution kernels. Thirdly, we propose learn-ing dense confidence through consistent depth and a bal-anced sampling approach for dense confidence maps.
Through extensive experiments we confirm that our pro-posed dense method, Dense Kernelized Feature Matching, sets a new state-of-the-art on multiple geometry estimation benchmarks. In particular, we achieve an improvement on
MegaDepth-1500 of +4.9 and +8.9 AUC@5◦ compared to the best previous sparse method and dense method respec-tively. Our code is provided at the following repository: https://github.com/Parskatt/DKM . 1.

Introduction
Two-view geometry estimation is a classical computer vision problem with numerous important applications, in-cluding 3D reconstruction [38], SLAM [30], and visual re-localisation [27]. The task can roughly be divided into two steps. First, a set of matching pixel pairs between the im-ages is produced. Then, using the matched pairs, two-view geometry, e.g., relative pose, is estimated. In this paper, we focus on the first step, i.e., feature matching. This task is challenging, as image pairs may exhibit extreme variations in illumination [1], viewpoint [22], time of day [37], and even season [46]. This stands in contrast to small baseline stereo and optical flow tasks, where the changes in view-Figure 1. Qualitative comparison. We compare our proposed approach DKM with the previous SotA method PDC-Net+ [48] on Milan Cathedral. Top row, image A and B. Middle row and bottom row, forward and reverse warps for PDC-Net+ and DKM weighted by certainty. DKM provides both superior match accu-racy and certainty estimation compared to previous methods. point and illumination are typically small.
Traditionally, feature matching has been performed by sparse keypoint and descriptor extraction, followed by matching [26,36]. The main issue with this approach is that accurate localization of reliable and repeatable keypoints is difficult in challenging scenes. This leads to errors in matching and estimation [13,23]. To tackle this issue, semi-sparse or detector-free methods such as LoFTR [41] and
Patch2Pix [53] were introduced. These methods do not de-tect keypoints directly but rather perform global matching at a coarse level, followed by mutual nearest neighbour extrac-tion and sparse match refinement. While those methods de-grade less in low-texture scenes, they are still limited by the fact that the sparse matches are produced at a coarse scale, leading to problems with, e.g., repeatability due to grid ar-tifacts [17]. By instead extracting all matches between the views, i.e., dense feature matching, we face no such issues.
Furthermore, dense warps provide affine matches for free, which yield smaller minimal problems for subsequent esti-mation [3, 4, 15]. While previous dense approaches [39, 47] have achieved good results, they have however failed to achieve performance rivaling that of sparse or semi-sparse methods on geometry estimation.
In this work, we propose a novel dense matching method that outperforms both dense and sparse methods in homog-raphy and two-view relative pose estimation. We achieve this by proposing a substantially improved model architec-ture, including both the global matching and warp refine-ment stage, and by a simple but strong approach to dense certainty estimation and a balanced dense warp sampling mechanism. We compare qualitatively our method with the previous best dense method in Figure 1.
Our contributions are as follows. Global Matcher: We propose a kernelized global matcher and embedding de-coder. This results in robust coarse matches. We describe our approach in Section 3.2 and ablate the performance gains in Table 5. Warp Refiners: We propose warp re-finement through large depthwise separable kernels using stacked feature maps as well as local correlation as input.
This gives our method superior precision and is described in detail in Section 3.3 with corresponding performance im-pact ablated in Table 6. Certainty and Sampling: We propose a simple method to predict dense certainty from consistent depth and propose a balanced sampling approach for dense matches. We describe our certainty and sampling approach in more detail in Section 3.4 and ablate the per-formance gains in Table 7. State-of-the-Art: Our exten-sive experiments in Section 4 show that our method sig-nificantly improves on the state-of-the-art.
In particular, we improve estimation results compared to the best previ-ous dense method by +8.9 AUC@5◦ on MegaDepth-1500.
These results pave the way for dense matching based 3D reconstruction. 2.