Abstract
Inverse rendering methods aim to estimate geometry, materials and illumination from multi-view RGB images. In order to achieve better decomposition, recent approaches attempt to model indirect illuminations reflected from dif-ferent materials via Spherical Gaussians (SG), which, how-ever, tends to blur the high-frequency reflection details. In this paper, we propose an end-to-end inverse rendering pipeline that decomposes materials and illumination from multi-view images, while considering near-field indirect il-In a nutshell, we introduce the Monte Carlo lumination. sampling based path tracing and cache the indirect illumi-nation as neural radiance, enabling a physics-faithful and easy-to-optimize inverse rendering method. To enhance ef-ficiency and practicality, we leverage SG to represent the smooth environment illuminations and apply importance sampling techniques. To supervise indirect illuminations from unobserved directions, we develop a novel radiance consistency constraint between implicit neural radiance and path tracing results of unobserved rays along with the joint optimization of materials and illuminations, thus sig-nificantly improving the decomposition performance. Ex-tensive experiments demonstrate that our method outper-forms the state-of-the-art on multiple synthetic and real datasets, especially in terms of inter-reflection decomposi-tion. 1.

Introduction
Inverse rendering, i.e., recovering geometry, material and lighting from images, is a long-standing problem in computer vision and graphics. It is important for digitiz-ing our real world and acquiring high quality 3D contents in many applications such as VR, AR and computer games.
Recent methods [7, 41, 44, 45] represent geometry and materials as neural implicit fields, and recover them in an
*Corresponding author.
Figure 1. Our method integrates lights through path tracing with
Monte Carlo sampling, while Invrender [45] uses Spherical Gaus-sians to approximate the overall illumination.
In this way, our method simultaneously optimizes indirect illuminations and ma-terials, and achieves better decomposition of inter-reflections. analysis-by-synthesis manner. However, how to decompose the indirect illumination from materials is still challenging.
Most methods [6, 7, 25, 41, 44] model the environment il-luminations but ignore indirect illuminations. As a result, the inter-reflections and shadows between objects are mis-takenly treated as materials.
Invrender [45] takes the in-direct illumination into consideration, and approximates it with Spherical Gaussian (SG) for computation efficiency.
Since SG approximation cannot model the high frequency details, the recovered inter-reflections tend to be blurry and contain artifacts. Besides, indirect illuminations estimated by an SG network cannot be jointly optimized with materi-als and environment illuminations.
In this paper, we propose an end-to-end inverse render-ing pipeline that decomposes materials and illumination, while considering near-field indirect illumination. In con-trast to the method [45], we represent the materials and the indirect illuminations as neural implicit fields, and jointly optimize them with the environment illuminations. Fur-thermore, we introduce a Monte Carlo sampling based path tracing to model the inter-reflections while leveraging SG to represent the smooth environment illuminations. In the for-ward rendering, incoming rays are sampled and integrated by Monte Carlo estimator instead of being approximated by a pretrained SG approximator, as shown in Fig. 1. To depict the radiance, the bounced secondary rays are further traced once and computed based on the cached neural indirect illu-mination. During the joint optimization, the gradients could be directly propagated to revise the indirect illuminations.
In this way, high frequency details of the inter-reflection can be preserved.
Specifically, to make our proposed framework work, we need to address two critical techniques: (i) The Monte Carlo estimator is computationally expen-sive due to the significant number of rays required for sam-pling. To overcome this, we use importance sampling to improve integral estimation efficiency. We also find that SG is a better representation of environment illuminations and adapt the corresponding importance sampling techniques to enhance efficiency and practicality. (ii) Neural implicit fields often suffer generalization problems when the view directions deviate from the training views, which is the common case of indirect illumination.
This would lead to erroneous decomposition between mate-rials and illuminations. It is hard to determine whether radi-ance comes from material albedos or indirect illuminations as the indirect illuminations from unobserved directions are unconstrained or could have any radiance. To learn indi-rect illuminations from unobserved directions, we introduce a radiance consistency constraint that enforces the implicit neural radiance produced by the neural implicit fields and path tracing results of unobserved directions. In this fash-ion, the ambiguity between materials and indirect illumina-tions has been significantly mitigated. Moreover, they can be jointly optimized with environment illuminations, lead-ing to better decomposition performance.
We evaluate our method on synthetic and real data. Ex-periments show that our approach achieves better perfor-mance than others. Our method can render sharp inter-reflection and recover accurate roughness as well as diffuse albedo. Our contributions are summarized as follows:
• We propose an end-to-end inverse rendering pipeline that decomposes materials and illumination, while considering near-field indirect illumination.
• We introduce the Monte Carlo sampling based path tracing and cache the indirect illumination as neural radiance, resulting in a physics-faithful and easy-to-optimize inverse rendering process.
• We employ SG to parameterize smooth environment il-lumination and apply importance sampling techniques to enhance efficiency and practicality of the pipeline.
• We introduce a new radiance consistency in learning indirect illuminations, which can significantly alleviate the decomposition ambiguity between materials and indirect illuminations. 2.