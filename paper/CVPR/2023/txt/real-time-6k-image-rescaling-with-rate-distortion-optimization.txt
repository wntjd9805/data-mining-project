Abstract
Contemporary image rescaling aims at embedding a high-resolution (HR) image into a low-resolution (LR) thumbnail image that contains embedded information for
HR image reconstruction. Unlike traditional image super-resolution, this enables high-fidelity HR image restoration faithful to the original one, given the embedded informa-tion in the LR thumbnail. However, state-of-the-art image rescaling methods do not optimize the LR image file size for efficient sharing and fall short of real-time performance for ultra-high-resolution (e.g., 6K) image reconstruction. To address these two challenges, we propose a novel frame-work (HyperThumbnail) for real-time 6K rate-distortion-aware image rescaling. Our framework first embeds an HR image into a JPEG LR thumbnail by an encoder with our proposed quantization prediction module, which minimizes the file size of the embedding LR JPEG thumbnail while maximizing HR reconstruction quality. Then, an efficient frequency-aware decoder reconstructs a high-fidelity HR image from the LR one in real time. Extensive experiments demonstrate that our framework outperforms previous im-age rescaling baselines in rate-distortion performance and can perform 6K image reconstruction in real time. 1.

Introduction
With an increasing number of high-resolution (HR) im-ages being produced and shared by users on the internet, a new challenge has arisen: how can we store and transfer
HR images efficiently? Storing HR images on the cloud, such as iCloud, is becoming a widely adopted solution that saves storage on a user’s mobile device (e.g., smartphones) as only their low-resolution (LR) counterparts are stored on the mobile device for an instant preview. However, when a user wants to obtain the full-resolution image, the entire
HR image must be downloaded on the fly from the cloud, which can result in a poor user experience when the internet connection is unstable or not available.
Real-time image rescaling can serve as a competitive so-lution to improving the user experience of cloud photo stor-*Equal contribution.
Figure 1. The application of 6K image rescaling in the con-text of cloud photo storage on smartphones (e.g., iCloud). As more high-resolution (HR) images are uploaded to cloud stor-age nowadays, challenges are brought to cloud service providers (CSPs) in fulfilling latency-sensitive image reading requests (e.g., zoom-in) through the internet. To facilitate faster transmission and high-quality visual content, our HyperThumbnail framework helps
CSPs to encode an HR image into an LR JPEG thumbnail, which users could cache locally. When the internet is unstable or un-available, our method can still reconstruct a high-fidelity HR im-age from the JPEG thumbnail in real time. age, as shown in Fig. 1. Such a solution can first embed an
HR image (on the cloud) into an LR JPEG thumbnail (on the mobile device) by an encoder, and the thumbnail pro-vides an instant preview with little storage. When the user wants to zoom in on the thumbnail, the HR image with fine details can be reconstructed locally in real time. In addition, image rescaling has other applications in image sharing, as it can “bypass” the resolution limitation of some platforms (e.g., WhatsApp) to reconstruct a high-quality HR image from an LR one [57]. While modern smartphones and cam-eras can capture ultra-high-resolution images in 4K (iPhone 13) or even 6K (Blackmagic camera), we are interested in designing a real-time image rescaling framework for ultra-high-resolution images (e.g., 4K or 6K), which minimizes
LR file size while maximizing HR and LR image quality.
However, existing image rescaling methods have their own flaws in practice, as shown in Table 1 where we compare different image rescaling methods in terms of their properties. One potential solution is to upsample the downsampled thumbnail with super-resolution (SR) meth-Method
Architecture (a) Downsampled JPEG + super-resolution [37] (b) Flow-based rescaling [36, 55] (c) Ours
Reconstruction fidelity
Rate-distortion optimization
Real-time 6K reconstruction (cid:37) (cid:37) – (cid:33) (cid:37) (cid:37) (cid:33) (cid:33) (cid:33)
Table 1. The comparison of different methods related to image rescaling. (a) Super-resolution from downsampled JPEG does not optimize rate-distortion performance and can hardly maintain high fidelity due to information lost in downsampling. (b) SOTA flow-based image rescaling methods also ignore the file size constraints and are not real-time for 6K reconstruction due to the limited speed of invertible networks. (c) Our framework optimizes rate-distortion performance while maintaining high-fidelity and real-time 6K image rescaling. ods [14, 17, 35, 37, 61, 62] (Table 1(a)). However, such a framework applies a simple downsampling strategy (e.g.,
Bilinear, Bicubic) to the HR image so that high-frequency details are basically lost in the LR thumbnail. Also, SR methods only focus on HR reconstruction, which leads to a sub-optimal image rescaling performance. Instead, ded-icated image rescaling approaches aim to embed informa-tion into a visually pleasing LR image and then recon-struct the HR image with an upsampling module. Recently, state-of-the-art image rescaling works utilize normalizing flow [25, 36, 55, 57] show impressive image embedding and reconstruction capability that outperforms SR approaches, in terms of the reconstructed HR image quality. However, there are still some great challenges to apply these flow-based rescaling frameworks in real-world applications, as shown in Table 1(b). First, the file size of the LR thumbnail is not optimized. Second, the reconstruction stage of these image rescaling methods is computationally expensive due to their invertible network architecture with extensive use of dense blocks [23]: IRN [55] costs about a second to re-construct a 4K image with 4x rescaling on a modern GPU, which is far from real time (Table 2).
In this work, we propose the HyperThumbnail, a rate-distortion-aware framework for 6K real-time image rescal-ing, as shown in Table 1(c). In this framework, we embed an HR image into a low-bitrate JPEG thumbnail by an en-coder and a quantization table predictor, as JPEG is a dom-inant image compression format today [3]. Then the JPEG thumbnail can be upscaled to its high-fidelity HR counter-part with our efficient decoder in real time. We leverage an asymmetric encoder-decoder architecture, where most computation is put in the encoder to keep the decoder lightweight. This makes it possible for our decoder to up-scale a thumbnail to 6K in real time, significantly faster than previous flow-based image rescaling methods [36, 55].
Meanwhile, the Rate-Distortion (RD) performance is an important and practical metric rarely studied in prior rescal-In this paper, we define the rate as the ratio ing works. between the thumbnail file size and the number of pixels in the HR image, also known as the bits-per-pixel (bpp).
The distortion consists of two parts: the perceptual qual-ity of the thumbnail (LR distortion) and the fidelity of the restored HR image (HR distortion). The rate-distortion per-formance evaluates an image rescaling framework in both storage cost and visual quality. Without explicit RD con-straints, recent works in image rescaling [36, 55] do not consider RD performance in their models. While some works [26, 47, 53, 54, 58] leverage the rate constraint by em-bedding extra information in JPEG, they simply utilize a fixed differentiable JPEG module, which we argue is sub-optimal for image rescaling. Because such a process dete-riorates the information in the embedding images without considering their local distribution. Moreover, the quanti-zation process of JPEG introduces noise in the frequency domain and introduces well-known JPEG artifacts, which brings great challenges to information restoration.
To remedy these issues, our image rescaling framework is designed to jointly optimize image quality and bpp with
Instead of using fixed quantization ta-entropy models. bles in conventional JPEG (Sec. 3.1), we propose a novel quantization prediction module (QPM) that predicts image-adaptive quantization tables, which can optimize RD perfor-mance. We further adopt a frequency-aware decoder which alleviates JPEG artifacts in the thumbnails and improves
HR reconstruction. Moreover, our asymmetric encoder-decoder framework can be extended to optimization-based compression.
Our contributions are summarized as follows:
• We propose a 6K real-time rescaling framework with an asymmetric encoder-decoder architecture, named
HyperThumbnail, which embeds a high-resolution im-age into a JPEG thumbnail that can be viewed in pop-ular browsers. The decoder utilizes both spatial and frequency information to reconstruct high-fidelity im-ages in real time for 6K image upsampling.
• We introduce a new quantization prediction module (QPM) that improves the RD performance in the en-coding stage of our framework. Furthermore, we adopt rate-distortion-aware loss functions along with QPM to optimize the RD performance.
• Experiments show that our framework outperforms state-of-the-art image rescaling methods with higher
LR and HR image quality and faster reconstruction speed at similar file size. 2.