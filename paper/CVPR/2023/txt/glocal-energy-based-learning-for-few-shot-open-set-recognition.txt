Abstract
Few-shot open-set recognition (FSOR) is a challenging task of great practical value. It aims to categorize a sam-ple to one of the pre-defined, closed-set classes illustrated by few examples while being able to reject the sample from unknown classes.
In this work, we approach the FSOR task by proposing a novel energy-based hybrid model. The model is composed of two branches, where a classification branch learns a metric to classify a sample to one of closed-set classes and the energy branch explicitly estimates the open-set probability. To achieve holistic detection of open-set samples, our model leverages both class-wise and pixel-wise features to learn a glocal energy-based score, in which a global energy score is learned using the class-wise fea-tures, while a local energy score is learned using the pixel-wise features. The model is enforced to assign large energy scores to samples that are deviated from the few-shot exam-ples in either the class-wise features or the pixel-wise fea-tures, and to assign small energy scores otherwise. Exper-iments on three standard FSOR datasets show the superior performance of our model.1 1.

Introduction
In recent years, deep learning has flourished in various fields with the ever-increasing scale of the training data un-der the closed-world learning settings, i.e., the training and test sets share exactly the same set of classes. However, such settings often do not hold in many real applications.
This is because 1) it is difficult or costly to obtain a large amount of labeled data, and 2) models deployed in open-world environments need to constantly deal with samples from unknown classes. For example, in the application of deep learning for diagnosing rare diseases, the number of samples is limited. In this case, the model is prone to over-fitting, resulting in a significant degradation in performance.
Further, there can be unknown variants of those diseases due
*H. Wang, G. Pang and P. Wang contributed equally in this work.
†Corresponding author. 1Code is available at https://github.com/00why00/Glocal
Figure 1. Two typical errors with existing methods. Our method can detect unknown open-set samples that are similar to the closed-set samples in either the global class level or the local fea-ture level. to our limited understanding of the diseases. Thus, the mod-els are required to perform the classification accurately for the classes illustrated by limited samples, while at the same time detecting the samples from unknown classes. The lat-ter ability is important, especially for healthcare or safety-critical applications, e.g., to alert the unknown cases for hu-man investigation in the disease diagnosis example, or to request human intervention for handling unknown objects in autonomous driving.
Few shot learning [16, 23, 28, 32, 35, 36] (FSL) and open set recognition [3, 7, 9, 22, 29, 30] (OSR) are two techniques
dedicated to solve these two problems, respectively. FSL methods are trained to achieve a good generalization abil-ity on the new task with only a few training samples. But
FSL approaches are developed under a closed-set setting.
It lacks the ability to distinguish the classes unseen during training. The goal of OSR is, on the other hand, to recognize open-set samples while maintaining the classification abil-ity of closed-set samples. However, its classification ability is often built upon the availability of a large number of train-ing samples. Thus, OSR approaches fail to work effectively when only a few training samples are available.
Few-shot open-set recognition (FSOR), which combines the FSL and OSR problems, is a largely under-explored area. FSOR requires the model to utilize only a few train-ing samples to effectively achieve the ability of both closed-set classification and open-set recognition. Existing FSOR methods [6,13,15] are based on the prototype network [32], which performs classification by measuring the distance be-tween the prototype of each class and the query embedding feature of a sample. They improve the original closed-set classifier in recognizing open-set samples by learning an additional open-set class using pseudo open-set samples.
However, only the class-wise information of the sample is considered, and the pixel-wise spatial information of the sample is ignored. As shown in Figure 1, these methods fail to distinguish open-set samples from closed-set class sam-ples that share similar global semantic appearances. Fur-ther, the optimization objectives of FSL and OSR are differ-ent from each other. Thus, training using only an open-set classifier can limit the performance of these models.
To solve the above problems, we propose a novel FSOR method, called Glocal Energy-based Learning (GEL). Dif-ferent from previous methods, GEL consists of two classi-fication components: one for closed-set classification and one for open-set recognition. Specifically, in addition to use the class-wise features to classify closed-set samples in the closed-set classifier, GEL leverages both class-wise and pixel-wise features to learn a new energy-based open-set classifier, in which a global energy score is learned using the class-wise features while a local energy score is learned using the pixel-wise features. GEL is enforced to assign large energy scores to samples that are deviated from the few-shot examples in either the class-wise features or the pixel-wise features, and to assign small energy scores oth-erwise. In doing so, GEL can detect unknown class samples that are deviated from the known classes in either high-level abstractions or fine-grained appearances, as shown in Fig-ure 1.
In summary, this work makes the following three main contributions:
• We further propose a novel energy-based FSOR model, dubbed GEL, that learns glocal energy-based open scores based on the class-wise and pixel-wise similarities of query samples to the support set.
• Through extensive experiments on three widely-used datasets, we show that GEL outperforms state-of-the-art competing methods and achieves state-of-the-art re-sults on these benchmarks. 2.