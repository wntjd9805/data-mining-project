Abstract
We consider the problem of solving LP relaxations of MAP-MRF inference problems, and in particular the method proposed recently in [16, 35]. As a key computa-tional subroutine, it uses a variant of the Frank-Wolfe (FW) method to minimize a smooth convex function over a combi-natorial polytope. We propose an efﬁcient implementation of this subroutine based on in-face Frank-Wolfe directions, introduced in [4] in a different context. More generally, we deﬁne an abstract data structure for a combinatorial sub-problem that enables in-face FW directions, and describe its specialization for tree-structured MAP-MRF inference subproblems. Experimental results indicate that the result-ing method is the current state-of-art LP solver for some classes of problems. Our code is available at pub.ist. ac.at/˜vnk/papers/IN-FACE-FW.html. 1.

Introduction
The main focus of this paper is on the problem of min-imizing a function of discrete variables z = (z1, . . . , zn) with unary and pairwise terms: min z∈D1×...×Dn (cid:88) v∈[n] fv(zv) + (cid:88) uv∈E fuv(zu, zv) (1)
Here G = ([n], E) is an undirected graph and D1, . . . , Dn are ﬁnite sets.
This problem is often referred to as
MAP-MRF inference (maximum a posteriori inference in a
Markov Random Field).
A prominent approach to tackle this NP-hard problem in practice is to solve its natural LP relaxation (see e.g. [39]), also called Basic LP relaxation [17]: fv(a)ξva + (cid:88) fuv(a, b)ξua;vb (2a) (cid:88) v∈[n] a∈Dv min
ξ≥0 (cid:88) b(cid:48)∈Dv (cid:88) a∈Dv
ξua;vb(cid:48) = ξua,
ξua = 1 ∀v uv∈E (a,b)∈Du×Dv (cid:88)
ξua(cid:48);vb = ξvb ∀uv, a, b (2b) a(cid:48)∈Du (2c)
Designing algorithms to (approximately) solve this relax-ation for large-scale problems has been a very active area of research. A popular approach is to use message passing techniques, which perform a block-coordinate ascent on the dual objective [5, 11, 13, 36, 38, 40] This strategy is very ef-fective for some problems, but for other problems it may get stuck in a suboptimal point. Many techniques have been developed that are guaranteed to converge to the optimal so-lution of the LP relaxation [8, 9, 16, 18, 20, 21, 25, 26, 28–32, 34, 35].
In this paper we revisit the approach in [16, 35]. Its key computational subroutine is to minimize a quadratic con-vex function over combinatorial polytope, which is done by invoking a variant of the Frank-Wolfe (FW) algorithm [3].
We study efﬁcient implementations of the latter in the con-text of MAP-MRF inference. Our main contribution is in-corporating in-face FW directions introduced in [4]. The idea is to speed-up computations by running FW algorithm on a smaller “contracted” subproblem obtained by taking a face of the polytope containing the current point. It has been used for applications such as low-rank matrix com-pletion [4], cluster detection in networks [1], and training sparse neural networks with (cid:96)1 regularization [6]. We inves-tigate the use of in-face FW directions for general combina-torial polytopes, and describe an abstract data structure that enables such directions. We then specialize it to subprob-lems corresponding to tree-structured MAP-MRF inference problems. Our approach has the following features:
• It may happen that the contracted subproblem splits into independent subproblems. These subproblems are han-dled by a block-coordinate version of FW.
• We store a cache of “atoms” for each contracted sub-problem. We describe how to efﬁciently transform these atoms when the current face is recomputed.
• For an edge uv ∈ E and ﬁxed fractional unary vectors for u, v we can compute an optimal fractional pairwise vec-tor for edge uv by solving a small-scale optimal trans-portation (OT) problems. Such computations were used in [27] for computing primal feasible solutions of relax-ation (2). We show how to use them for improving the performance of in-face FW directions.
To our knowledge, the issues above have not been discussed in the literature so far.
We remark that in-face FW directions effectively imple-ment the following rather natural idea: the optimization should be performed only over “active” pairs (v, a) that are likely to be present in the support of an optimal solution; the other pairs should be ﬁxed. A related idea appeared in the context of message passing algorithms in [37], where mes-sages are updated only in a subgraph in which the current best labels keep changing. The method in [37] works only with dual variables, and uses heuristic criteria for choosing the subgraph. We believe that in-face FW directions allow a more principled criterion for deciding which variables to
ﬁx and for how long. Note that Freund et al. [4] proved that their criterion retains the convergence rate of the basic FW algorithm. We use a different criterion that also takes into account the ratio of runtimes on the original and on con-tracted subproblems.
In Section 4 we test the algorithms on benchmark prob-lems in the evaluation [10], and compare them with LP solvers used in [10]. Results suggest that the method in [16, 35] with in-face FW directions is the current state-of-the-art LP solver for certain classes of problems. 2.