Abstract
Depth estimation from indoor panoramas is challenging due to the equirectangular distortions of panoramas and inaccurate matching.
In this paper, we propose a prac-tical framework to improve the accuracy and efficiency of depth estimation from multi-view indoor panoramic images with the Neural Radiance Field technology. Specifically, we develop two networks to implicitly learn the Signed
Distance Function for depth measurements and the radi-ance field from panoramas. We also introduce a novel spherical position embedding scheme to achieve high ac-curacy. For better convergence, we propose an initializa-tion method for the network weights based on the Manhat-tan World Assumption. Furthermore, we devise a geomet-ric consistency loss, leveraging the surface normal, to fur-ther refine the depth estimation. The experimental results demonstrate that our proposed method outperforms state-of-the-art works by a large margin in both quantitative and qualitative evaluations. Our source code is available at https://github.com/WJ-Chang-42/IndoorPanoDepth. 1.

Introduction
Panoramic imaging has emerged as an attractive imag-ing technique in many fields, such as computer vision and robotics. Different from traditional imaging devices, panoramic cameras capture a holistic scene and present it as a 2D image with equirectangular projection. Indoor panora-mas, captured in the interior scenes by panoramic cameras, have been widely used in interior design and decoration.
Recovering depth information aligned with RGB panoramic images benefits a line of down-streaming applications, such as augmented reality and indoor mapping.
Recent works on depth estimation from panoramas em-ploy Convolutional Neural Network (CNN) structures with prior knowledge learned from depth labels and achieve ex-cellent performance. Most of these works adopt a sin-gle panoramic image to predict the relative depth map
[7, 23, 29, 31, 37, 39]. These methods require lots of RGB and depth pairs while training and encounter the problem of domain adaptation in practice. There are a few works attempting to employ multiview panoramic images in the depth estimation task [32, 38]. They recover depth infor-mation by finding the correspondence of different views.
However, strict vertical or horizontal position relations are required for input images in these methods.
Panoramas show great distortions when presented as 2D images. Prior works adopt various technologies to over-come this problem, such as processing panoramas [7,26,27,
†Corresponding Author
31] with perspective projection and developing special con-volution kernels [8, 30, 37]. Recently, the Neural Radiance
Field (NeRF) [18] based on volume rendering has attracted great attention, which aims to synthesize novel views and recover the geometry of a complex scene. It considers im-age pixels as the rendering results of camera rays casting to the scene and learns geometric information from the corre-spondence among each ray, which eliminates affects from distortions while processing panoramic images. However, when applied to panoramas, the state-of-the-art scene rep-resentation methods still require a number of input images and take a long time to converge. It is a compelling research problem to explore how to leverage the omnidirectional in-formation in panoramas to achieve satisfying depth estima-tion results with fewer images and faster convergence.
To exploit the holistic spatial information in panoramas, we propose a framework to achieve holistic depth estima-tion with a few panoramic images. Our framework consists of two main networks with a novel positional embedding scheme for learning a better representation from panoramas.
The geometry network estimates the Signed Distance Func-tion (SDF) to represent the 3D information of the scene, and the color network reconstructs the color texture. With the assistance of the rendering equation, the expected color of a pixel in an image is rendered with radiance values of the sampled 3D coordinates along camera rays. Both net-works are optimized by minimizing the difference between the rendered colors. Inspired by [2], we propose a method to initialize the parameters of the geometry network based on the assumption that floors and ceilings are always ver-tical to the gravity direction in indoor panoramic images, which provides guidance to properly optimize the geome-try network. Experimental results show that the proposed initialization scheme facilitates the network converge faster and achieves better results. In addition, considering that the geometric information from the depth is supposed to be con-sistent with the geometry from the surface normal, we de-vise the geometric consistency loss, which further refines the depth measurements. Moreover, we construct a syn-thetic dataset that provides RGB-D image pairs from var-ious positions. We evaluate our method on our synthetic dataset and two real-world datasets. The experimental re-sults demonstrate that our method achieves superior perfor-mance among state-of-the-art approaches. Even with fewer image views and a short training period, our method works well and outputs promising depth measurements. Our con-tributions are summarized as follows:
• We propose an unsupervised method for depth estima-tion from multi-view indoor panoramic images by uti-lizing a neural network with a specially designed po-sitional embedding scheme to implicitly learn the SDF of the scene represented by panoramas.
• Inspired by the Manhattan World Assumption, we pro-pose an initialization method for the network weights for better convergence.
• We devise a loss item based on geometric consistency that the geometric information from depth is supposed to be consistent with the surface norm.
• We release a synthetic panoramic RGB-D dataset ren-dered from photorealistic indoor scenes. Experimen-tal results on our synthetic dataset and two realis-tic datasets demonstrate that our proposed method achieves superior performance in both quantitative and qualitative ways. 2.