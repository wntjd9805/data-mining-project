Abstract for low-light
The exclusive properties of RAW data have shown great image enhancement. Neverthe-potential less, the performance is bottlenecked by the inherent lim-itations of existing architectures in both single-stage and multi-stage methods. Mixed mapping across two differ-ent domains, noise-to-clean and RAW-to-sRGB, misleads the single-stage methods due to the domain ambiguity.
The multi-stage methods propagate the information merely through the resulting image of each stage, neglecting the abundant features in the lossy image-level dataflow. In this paper, we probe a generalized solution to these bottlenecks and propose a Decouple aNd Feedback framework, abbre-viated as DNF. To mitigate the domain ambiguity, domain-specific subtasks are decoupled, along with fully utilizing the unique properties in RAW and sRGB domains. The fea-ture propagation across stages with a feedback mechanism avoids the information loss caused by image-level dataflow.
The two key insights of our method resolve the inherent limitations of RAW data-based low-light image enhance-ment satisfactorily, empowering our method to outperform the previous state-of-the-art method by a large margin with only 19% parameters, achieving 0.97dB and 1.30dB PSNR improvements on the Sony and Fuji subsets of SID. 1.

Introduction
Imaging in low-light scenarios attracts increasing atten-tion, especially with the popularity of the night sight mode on smartphones and surveillance systems. However, low-light image enhancement (LLIE) is a challenging task due to the exceptionally low signal-to-noise ratio. Recently, deep learning solutions have been widely studied to tackle this task in diverse data domains, ranging from sRGB-based methods [14,15,21,40] to RAW-based methods [2,7,35,47].
Compared with sRGB data, RAW data with the unpro-*Equal contribution.
†C. L. Guo is the corresponding author.
Figure 1. Thumbnail of different RAW-based low-light image en-hancement methods. (b) Multi-stage method with intermediate supervision. (c) The proposed DNF. (a) Single-stage method. cessed signal is unique in three aspects that benefit LLIE: 1) the signal is linearly correlated with the photon counts in the RAW domain, 2) the noise distributions on RAW im-ages are tractable before the image signal processing (ISP) pipeline [33], and 3) the higher bit depth of RAW format records more distinguishable low-intensity signals.
The pioneering work SID [2] proposed a large-scale paired dataset for RAW-based LLIE, igniting a renewed interest in data-driven approaches. As shown in Fig. 1, one line of work [2, 5, 12, 13, 22, 42] focuses on designing single-stage network architectures, and another [4,7,35,47] exploits the multi-stage networks for progressive enhance-ment. Despite the great performance improvement, both architectures are still bottlenecked by inherent limitations.
First, current single-stage methods force neural networks to learn a direct mapping from noisy RAW domain to clean sRGB domain. The mixed mapping across two different domains, noisy-to-clean and RAW-to-sRGB, would mis-lead the holistic enhancement process, leading to the do-main ambiguity issue. For example, the tractable noise in
RAW images would be mapped to an unpredictable distri-bution during color space transformation. Therefore, shift-ing colors and unprocessed noises inevitably appear in the
final results. Second, existing multi-stage methods com-pose the pipeline by cascaded subnetworks, each of which is responsible for gradual enhancement based on the out-put image of the last stage. Under their designs with the image-level dataflow, only images are propagated forward across multiple stages, and the later stage only obtains in-formation from the result of the previous stage. Meanwhile, every subnetwork in each stage may incur information loss due to the downsampling operation or the separate objective function [41]. Consequently, the suboptimal performance is bound up with the lossy image-level dataflow. The error is propagated, accumulated, and magnified along with stages, finally failing to reconstruct the texture details.
To exploit the potential of RAW images for LLIE, a gen-eralized pipeline is expected, which transcends the above two limitations. Specifically, neural networks ought to uti-lize the aforementioned merits in different domains [7], rather than being confused by the domain ambiguity. Ac-cording to the unique properties of the RAW and sRGB domains, it is essential to decouple the enhancement into domain-specific subtasks. After exploring the linearity and tractable noise in the RAW domain, the color space trans-formation from RAW domain to sRGB domain can be per-formed deliberately without noise interference. Besides, the pipeline cannot hinder communication across stages, in-stead of the image-level dataflow that merely allows a small portion of lossy information to pass through. Due to the di-verse subtasks, the intermediate feature of each level tends to be complementary to each other [20, 46]. Meanwhile, multi-scale features preserve texture and context informa-tion, providing additional guidance for later stages [41].
Hence, the features in different stages are required to prop-agate across dataflow, aggregating the enriched features and sustaining the intact information. The domain-specific de-coupling, together with the feature-level dataflow, facilitates the learnability for better enhancement performance and re-tains the method’s interpretability.
Based on these principles, we propose a Decouple aNd
Feedback (DNF) framework, with the following designs tailored for RAW-based LLIE. The enhancement process is decoupled into two domain-specific subtasks: denoising in the RAW domain [30, 33, 45, 48] and the color restoration into the sRGB domain [8, 28, 39], as shown in Fig. 1(c).
Under the encoder-decoder architecture commonly used in previous works [27], each module in the subnetwork is de-rived from the exclusive properties of each domain: the
Channel Independent Denoising (CID) block for RAW de-noising, and the Matrixed Color Correction (MCC) block for color rendering. Besides, instead of using the inaccurate denoised RAW image, we resort to the multi-scale features from the RAW decoder as denoising prior. Then, the fea-tures are flowed into the shared RAW encoder by proposed
Gated Fusion Modules (GFM), adaptively distinguishing the texture details and remaining noise. After the Denois-ing Prior Feedback, signals are further distinguished from noises, yielding intact and enriched features in the RAW do-main. Benefiting from the feature-level dataflow, a decoder of MCC blocks could efficiently deal with the remaining enhancement and color transformation to sRGB domain.
The main contributions are summarized as follows:
• The domain-specific task decoupling extends the uti-lization of the unique properties in both RAW and sRGB domains, avoiding domain ambiguity.
• The feature-level dataflow empowered by the Denois-ing Prior Feedback reduces the error accumulation and aggregates complementary features across stages.
• Compared with the previous state-of-the-art method, the proposed method gains a significant margin improvement with only 19% parameters and 63%
FLOPs, e.g. 0.97dB PSNR improvement on the Sony dataset of SID and 1.30dB PSNR improvement on the
Fuji dataset of SID. 2.