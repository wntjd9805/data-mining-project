Abstract  item  detection 
Automatic  prohibited  in  security  inspection  X-ray  images  is  necessary  for  transportation(cid:2). 
The abundance and diversity of the X-ray security images  with prohibited item, termed as prohibited X-ray security  images, are essential for training the detection model. In  order to solve the data insufficiency, we propose a Region-Wise  Style-Controlled  Fusion  (RWSC-Fusion)  network,  which superimposes the prohibited items onto the normal 
X-ray security images, to synthesize the prohibited X-ray  security  images.  The  proposed  RWSC-Fusion  innovates  both network structure and loss functions to generate more  realistic  X-ray  security  images.  Specifically,  a  RWSC-Fusion module is designed to enable the region-wise fusion  by  controlling  the  appearance  of the  overlapping  region  with novel modulation parameters. In addition, an Edge-Attention (EA) module is proposed to effectively improve  the  sharpness  of  the  synthetic  images.  As  for  the  unsupervised loss function, we propose the Luminance loss  in  Logarithmic  form  (LL)  and  Correlation  loss  of 
Saturation Difference  (CSD), to optimize the fused X-ray  security images in terms of luminance and saturation. We  evaluate  the  authenticity  and  the  training  effect  of  the  synthetic  X-ray  security  images  on  private  and  public 
SIXray  dataset.  The  results  confirm  that  our  synthetic  images are reliable enough to augment the prohibited X-ray security images.  1.

Introduction 
X-ray imagery security inspection is a fundamental part  in station/airport, for detecting prohibited items in baggage  or suitcase images. 
Recently,  computer  vision  methods  particularly  deep  learning [15, 33] have brought benefits to prohibited item  detection  [1,  16,  18,  25,  37].  The  performance  of  these  automated  detection  models  relies  heavily  on  a  mass  of  annotated  images.  However,  real  X-ray  security  images  usually are arduous and time-consuming to collect, and the  occurrence rate of prohibited items is very low. Moreover,  very  few of  public  X-ray security  image datasets  contain  large  amounts  of  prohibited  items.  Existing  datasets  are
*Corresponding author: xilizju@zju.edu.cn, xiongjp362204@163.com 
Figure  1.  Our  RWSC-Fusion  allows to  superimpose prohibited  items  onto  baggage  images,  to  synthesize  prohibited  X-ray  images. The composite prohibited items are marked with red box.  mainly:  (1)  GDXray:  The  GDXray  dataset  [24]  contains  only three kinds of prohibited items: guns, shurikens, and  razor  blades.  Besides,  GDXray  only  involves  grayscale  images where backgrounds are too simple to conform with  the  real  color  X-ray  security  images;  (2)  OPIXray:  The 
OPIXray dataset [36], which is especially designed for the  cutter  detection,  contains  8885  synthetic  X-ray  security  images with five kinds of cutters, and most images contain  only  one  cutter;  (3)  SIXray:  The  SIXray  dataset  [26]  contains 1, 059, 231 X-ray security images, but only 8929  images include prohibited items:  guns, knives, wrenches,  pliers,  scissors,  and  hammers.  Given  the  above,  existing  public datasets haven't been up to the standard of training. 
To  overcome  the  lack  of  training  samples,  traditional  offline enhancement strategies such as rotation, re-scaling  and  mixing  are  applied  to  the  augmentation  of  training  samples  [32,  42].  However,  unlike  natural  images  and  other X-ray scans,  X-ray security images usually involve  randomly  stacked  objects  [6,  11,  12,  22].  In  addition,  according  to  the  imaging  principle  of  X-ray  security,  objects overlap with each other in a translucent state, and  appear  differently  for  different  materials  and  thickness. 
These  traditional  augmentation  methods  cannot  improve  the  diversity  and  complexity  for  the  inter-occlusion  between  prohibited  items  [31].  Therefore,  it  is  very  necessary to synthesize realistic X-ray security images, so  as to enrich the prohibited items in pose, scale and position. 
A few researchers studied to directly generate prohibited                                                                                    
X-ray security images by learning deep synthesis models. 
Inspired by the success of GANs in image synthesis [10,  34], Zhao et al. proposed X-ray Image- Synthesis-GAN [41]  to generate the prohibited items from a noise region on the  background  images.  Li  et  al.  [17]  synthesized  the  X-ray  security  images  from  the  semantic  label  maps  based  on 
GANs. Yang et al. [40] enhanced the training of GANs to  learn higher-quality X-ray security images. However, they  synthesized  only  one  prohibited  item  rather  than  stacked  and  overlapped  ones  in  one  image,  which  thus  are  not  realistic enough for the complex X-ray security images in  a  real-world  scenario.  Isaac-Medina  et  al.  [14]  used  the  paired X-ray energy maps (high, low, effective-Z maps) to  synthesize  the  pseudo-color  images  which  however  only  served as a small amount of testing samples. Bhowmik et  al.  [3]  developed  a  Synthetically  Composited  (SC)  data  augmentation  strategy  based  on  the  Threat  Image 
Projection (TIP)  method [8], to  fuse the prohibited items  with  the  baggage  images  for  generating  images  with  stacked  and  cluttered  prohibited  items.  However,  the  SC  need  adjust  the  parameters  for  each  image  to  meet  the  various  colors  of  different  materials,  and  thus  lacks  automation, robustness and versatility. 
In  order  to  synthesize  the  prohibited  X-ray  security  images  automatically,  we  propose  a  color  X-ray  security  images fusion model, to superimpose the prohibited items  onto baggage or suitcase images, as shown in Figure 1. In  this way, we synthesize prohibited X-ray security images  and  obtain  annotation  automatically,  thus  avoiding  the  collection  of  the  annotated  prohibited  X-ray  security  images for training the prohibited item detection model. 
The  experimental  results  prove  the  advantage  of  our  fusion model over other fusion methods in the field of X-ray  security  image.  In  addition,  we  also  compare  the  prohibited  item  detection  model  trained  with  real  and  synthetic  images.  The  results  verify  that  our  synthetic  images  are  efficient  to  supplement  the  prohibited  X-ray  security images in downstream detection task. 
The main contributions of our work are as follows:  1.  We  propose  an  unsupervised  color  X-ray  security  image  fusion  model.  Due  to  the  imaging  particularity,  existing  fusion  loss  functions  are  inapplicable  to  X-ray  security images. We design Luminance loss in Logarithmic  form  (LL)  and  Correlation  loss  of  Saturation  Difference  (CSD) based on the principle of X-ray imaging and Threat  image  projection  (TIP).  The  LL  and  CSD  optimize  the  comprehensive  luminance-saturation  fusion  between  the  foreground item and background image. Thus, we extend 
TIP to composite color X-ray security images.  2. We propose a Region-Wise Style-Controlled Fusion  module,  to  control  the  fused  appearance  by  learning  the  shifting  and  scaling  modulation  parameters  pertinently. 
Moreover,  the  RWSC-Fusion  module  can  adaptively  modulate the local region of interest, i.e., the overlapping  region of the prohibited items and baggage images.   3.  We  develop  an  Edge-Attention  module,  which  inhibits  irrelevant  information  and  enhances  texture  information, to improve the sharpness of generated images.   4. Our RWSC-Fusion and Edge-Attention modules are  both universal and plug-and-play to other image fusion or  synthesis models for generating high-quality images.  2.