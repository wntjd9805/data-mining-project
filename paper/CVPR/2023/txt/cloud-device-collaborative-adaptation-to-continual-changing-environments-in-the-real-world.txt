Abstract
When facing changing environments in the real world, the lightweight model on client devices suffers from se-vere performance drops under distribution shifts. The main limitations of the existing device model lie in (1) unable to update due to the computation limit of the device, (2) the limited generalization ability of the lightweight model.
Meanwhile, recent large models have shown strong gen-eralization capability on the cloud while they can not be deployed on client devices due to poor computation con-straints. To enable the device model to deal with chang-ing environments, we propose a new learning paradigm of
Cloud-Device Collaborative Continual Adaptation, which encourages collaboration between cloud and device and im-proves the generalization of the device model. Based on this paradigm, we further propose an Uncertainty-based
Visual Prompt Adapted (U-VPA) teacher-student model to transfer the generalization capability of the large model on the cloud to the device model. Specifically, we first de-*Equal contribution
†Corresponding author sign the Uncertainty Guided Sampling (UGS) to screen out challenging data continuously and transmit the most out-of-distribution samples from the device to the cloud. Then we propose a Visual Prompt Learning Strategy with Uncer-tainty guided updating (VPLU) to specifically deal with the selected samples with more distribution shifts. We trans-mit the visual prompts to the device and concatenate them with the incoming data to pull the device testing distribu-tion closer to the cloud training distribution. We conduct extensive experiments on two object detection datasets with continually changing environments. Our proposed U-VPA teacher-student framework outperforms previous state-of-the-art test time adaptation and device-cloud collaboration methods. The code and datasets will be released. 1.

Introduction
Real-world usually contains various environmental changes along with continual distribution shifts [35]. Peo-ple usually deploy economically lightweight models on devices to boost the scalability and practicability. The lightweight model can suffer severe performance degrada-1
tion under continual distribution shifts [25, 29, 33, 35]. The main challenges are: (1)The poor computational ability of devices. Due to the properties of device infrastructure, the deployed model can not be updated on time, thus lagging its performance for the real world under distribution shift. (2)
The limited generalization ability of the lightweight model.
Since lightweight models are of relatively small capacity, they can not handle continually changing environments. In contrast, recent large models that are trained on the cloud server show significant generalization ability [2, 39]. While in industry, these large models can not be directly applied due to the limited infrastructure.
Therefore, we enable the device model to tackle real-world environmental changing by proposing a Cloud-Device Collaborative Continual Adaptation paradigm, as shown in Fig .1 (a). Previous Cloud-Device Collaborative methods only focus on improving model representation on variance in video frames but neglect the model generaliza-tion ability for continually changing data distribution.
In our new paradigm, we fully exploit the sufficient knowledge of the large cloud model and transfer the continual general-ization ability to the device lightweight model.
In particular, we design an Uncertainty-based Visual
Prompt Adapted (U-VPA) teacher-student model, which consists of an Uncertainty Guided Sampling (UGS) strategy and a Visual Prompt Learning Strategy with Uncertainty
Guided Updating (VPLU). Due to the communication band-width constraint [11, 13, 19], different with some work tar-geting filtering the parameters [22, 26], we design the UGS to screen out the most environment-specific samples and de-crease the required bandwidth compared with transmitting the whole sequence. To leverage the strong generalization ability of large models, we introduce the VPLU to align source-target domain distribution and transfer the represen-tation of the large teacher model to the light student model.
The light student model and visual prompts are then deliv-ered to the device, thus alleviating the continuously chang-ing scenarios in the real world.
Experimental results show that our method outperforms the state-of-the-art methods on synthetic and real-world dis-tribution shift datasets, as shown in Fig .1 (b). Besides, we can achieve the same performance as the entire data with fewer reflowed data (42% of total data). As another bene-fit, fewer reflowed data reduce the bandwidth pressure of the uplink. As for the downlink, we can deliver the vi-sual prompts (0.43% of the model’s parameters) with al-most negligible bandwidth to the device and apply the vi-sual prompt to the input data to improve the performance of the device model by 3.9% in mAP.
Our contributions can be summarized as follows:
• We make the first attempt to deal with continually changing scenarios by proposing a Cloud-Device Col-laborative Continual Adaptation paradigm, which aims to transfer the generalization ability from the large cloud model to the lightweight device model. Our method is a general paradigm that can apply to real-world systems.
• We design an Uncertainty-based Visual Prompt
Adapted (U-VPA) teacher-student model, which con-sists of UGS and VPLU. We introduce UGS to screen out the most environment-specific samples and de-crease the required bandwidth compared with trans-mitting the whole sequence. We propose a VPLU to align source-target data distribution and transfer the representation of the large teacher model to the lightweight student model.
• Experiments show that our proposed framework and method surpass other state-of-the-art methods and can effectively improve the continuous domain adaptation capability of the device model. 2.