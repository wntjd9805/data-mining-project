Abstract
Reflective flare is a phenomenon that occurs when light reflects inside lenses, causing bright spots or a “ghosting effect” in photos, which can impact their quality. Elimi-nating reflective flare is highly desirable but challenging.
Many existing methods rely on manually designed features to detect these bright spots, but they often fail to identify reflective flares created by various types of light and may even mistakenly remove the light sources in scenarios with multiple light sources. To address these challenges, we pro-pose an optical center symmetry prior, which suggests that the reflective flare and light source are always symmetrical around the lens’s optical center. This prior helps to locate the reflective flare’s proposal region more accurately and can be applied to most smartphone cameras. Building on this prior, we create the first reflective flare removal dataset called BracketFlare, which contains diverse and realistic reflective flare patterns. We use continuous bracketing to capture the reflective flare pattern in the underexposed im-age and combine it with a normally exposed image to syn-thesize a pair of flare-corrupted and flare-free images. With the dataset, neural networks can be trained to remove the reflective flares effectively. Extensive experiments demon-strate the effectiveness of our method on both synthetic and real-world datasets. 1.

Introduction
Lens flare artifacts can occur when a strong light enters the camera’s field of view, causing scattering and reflection within the lenses. Unlike radial-shaped scattering flares, re-flective flares appear as groups of bright spots [5, 7] or a
“ghosting effect” like the examples in Fig. 1. With multi-ple reflections, the light source creates multiple projections at various positions behind the lens. If the projection is far from the focal plane, the defocused effect can brighten the whole sensor and degrade the photo’s quality as shown in
Fig. 2. In near-focus situations, images of the light source
*Corresponding author.
Figure 1. Reflective flare removal with our proposed dataset and prior. The network trained on our dataset can effectively separate the reflective flare and flare-free images from a flare-corrupted im-age. Our method can generalize well to different types of smart-phones and even cameras with specific types of lenses. can result in a line of unfocused, bright blobs on the cap-tured photo.
Applying anti-reflective (AR) coating is a common tech-nique for reducing internal reflections [22]. The coating is effective for unfocused spots with low luminance, but can-not mitigate a bright spot with high luminance at the focal plane. Even with a well-designed lens system, a bright re-flective spot may remain in the photo, known as the ghost-ing effect [10]. Reflective flare is common on all types of smartphone lenses, and certain types of smartphones (e.g., the iPhone series) can produce a large area of inverted re-flective flare from neon lights or large, luminous standing signs, as shown in Fig. 1. The phenomenon becomes more pronounced when capturing a photo at night with multiple lights in the scene. Numerous bright spots and inverted re-flections manifest and propagate in different directions with the lens orientation. Therefore, reflective flare removal al-gorithms are highly desirable.
Removing reflective flare is a difficult task due to the vast diversity of reflective flares that can be caused by differ-ent types of light sources and lenses. Reflective flares often appear as bright spots that can resemble streetlights from a distance, making it challenging to differentiate between reflective flares and other light sources. Current methods for removing flare spots mainly rely on feature detection techniques like Speeded-Up Robust Features [2] (SURF) or Scale-Invariant Feature Transform [12] (SIFT) to extract spot regions [1, 3, 19]. These methods, however, strug-gle to effectively detect blobs on complex backgrounds and only work for specific spot patterns. Moreover, these meth-ods are ineffective in removing reflective flares caused by lamp tubes and LED matrices. Many learning-based meth-ods and datasets for reflective flare removal have been pro-posed [5,15,18,22]. Although these datasets contain subsets of reflective flares, they are not sufficient for good general-ization. For instance, the reflective flare subset from Wu et al. [22] is captured using the same lens and light source, making it difficult to generalize to different flares in real-world scenarios. Dai et al. [5] propose a synthetic dataset with 10 types of reflective flares, but training on this dataset tends to mislead a network to erroneously remove other tiny bright spots like street lights and bright windows. As a re-sult, it remains challenging for existing algorithms to accu-rately detect and remove various types of reflective flares while preserving details in other regions.
To overcome the challenges of detecting and removing reflective flares, we propose a novel optical center symme-try prior, which suggests that the main spot of the reflective flare and the light source are always symmetrical around the lens’s optical center in captured images. This prior applies to most smartphone cameras and some professional cam-eras. With this prior, we can easily detect the possible loca-tions of reflective flares. We also found that the flare spots always have the same patterns as the brightest regions of the light source. Therefore, we can synthesize reflective flares by using the light source’s patterns at low exposure. Based on these characteristics of reflective flares, we develop the first reflective flare removal dataset, named BracketFlare.
Specifically, we use continuous bracketing to capture the light source’s pattern on an underexposed image and select the normally exposed image to create the light source and the natural image. Next, we rotate the light source pattern 180 degrees around the optical center, apply blur and color augmentation, and use it to create synthetic reflective flares.
We can add the reflective flare to the normally exposed im-age to produce paired flare-corrupted and flare-free images.
Thanks to the optical center symmetry prior, we fur-ther propose an end-to-end pipeline for reflective flare re-Figure 2. Schematic diagram of reflective flare formation. Re-flective flares are generated by multiple reflections inside the lens.
In (c), yellow lines show the generation principle of the aperture-shaped reflective flare. Red lines represent the formation of the bright spot. Since the unfocused reflective flare (yellow line, e.g., (a)) can be effectively alleviated by AR coating. In this work, we mainly focus on removing the focused reflective flare (red line, e.g., (b)) from night images. moval, which can easily apply standard neural networks de-signed for image restoration. Specifically, to demonstrate the effectiveness of our dataset and pipeline, we train two
CNN-based networks [4, 24] and two Transformer-based networks [21,23] as baselines. These models trained on our dataset effectively suppress the reflective flare and general-ize well to real-world scenarios. The contributions of our work are as follows:
• We propose a new optical center symmetry prior that uncovers crucial properties of reflective flares on smartphones’ cameras, including their locations of oc-currence and patterns.
• Based on this prior, we explore a new method for constructing a reflective flare removal dataset called
BracketFlare. This dataset includes various types of light sources and diverse indoor and outdoor scenes, providing a solid foundation for this task.
• We design an end-to-end reflective flare removal pipeline that incorporates the optical center symme-try prior to both training data generation and net-work structures. Extensive experiments demonstrate the essential role of our dataset and prior in reflective flare removal, which effectively generalizes to differ-ent night scenes
2.