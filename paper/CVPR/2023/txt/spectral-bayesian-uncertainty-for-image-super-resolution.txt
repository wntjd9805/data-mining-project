Abstract
Recently deep learning techniques have significantly ad-vanced image super-resolution (SR). Due to the black-box nature, quantifying reconstruction uncertainty is crucial when employing these deep SR networks. Previous ap-proaches for SR uncertainty estimation mostly focus on cap-turing pixel-wise uncertainty in the spatial domain. SR uncertainty in the frequency domain which is highly re-In this paper, we lated to image SR is seldom explored. propose to quantify spectral Bayesian uncertainty in im-age SR. To achieve this, a Dual-Domain Learning (DDL) framework is first proposed. Combined with Bayesian ap-proaches, the DDL model is able to estimate spectral un-certainty accurately, enabling a reliability assessment for high frequencies reasoning from the frequency domain per-spective. Extensive experiments under non-ideal premises are conducted and demonstrate the effectiveness of the pro-posed spectral uncertainty. Furthermore, we propose a novel Spectral Uncertainty based Decoupled Frequency (SUDF) training scheme for perceptual SR. Experimental results show the proposed SUDF can evidently boost per-ceptual quality of SR results without sacrificing much pixel accuracy. 1.

Introduction
Image super-resolution (SR) is a basic computer vision task that aims to recover an underlying high-resolution (HR) image from its degraded low-resolution (LR) obser-vation.
Image SR is widely used in many applications where high-frequency (HF) information is required, such as medical imaging [38], microscopy imaging [36], surveil-lance [46], etc. In recent years, learning-based approaches with convolutional neural networks (CNN) have become the primary workhorse for image SR. Starting from the pio-neering work SRCNN [9], various CNN-based SR mod-els [7,21,24,31,43,49] have been proposed and significantly pushed the frontier of image SR research.
*Corresponding author.
Despite the impressive success in image SR benchmarks, most of these CNN-based SR models tend to overfit the training data so that their reliability and generalizability may not be guaranteed in practice. A well-trained SR model often makes inaccurate reasoning for HF details when it receives LR images away from its training distri-bution, thereby making the downstream processing unreli-able. Therefore, it is quite crucial to quantify reconstruc-tion uncertainty when employing these SR models, espe-cially in some high risk applications (e.g. medical imaging) or when under some harmful adversarial attacks. Bayesian neural networks (BNNs) which combine deep neural net-works with Bayesian learning open up the possibility to capture model uncertainty, by placing distributions over the network weights and then obtaining the predictive distribu-tion through marginalization over posterior. Since the exact
Bayesian inference is usually intractable for deep networks, various stochastic techniques that are compatible with mod-ern deep learning are widely used for posterior approxima-tion, such as dropout [11], batch normalization [41], weight initialization [22], etc.
However, existing Bayesian models for image SR are mostly developed in the spatial domain to capture pixel-wise uncertainty [40, 41]. The uncertainty in the frequency domain which is highly related to image SR is seldom ex-plored. From the frequency domain perspective, image SR is essentially a task of recovering HF components given low-frequency (LF) ones. Thus the uncertainty of HF com-ponents directly characterizes the reliability of the SR re-sults. Besides, the common pixel-wise uncertainty is sensi-tive to local mismatch of spatial structures, where a slight pixel shift among Monte Carlo (MC) samples may result in high uncertainty. So it is also desirable to quantify the reconstruction uncertainty in a global way. Moreover, im-age HF components in the frequency domain usually play an important role in some specific areas. For instance, the calculation of imaging resolution in optical imaging heav-ily depends on the HF components of objects [8]. The un-certainty of HF components directly reveals the credibility of the imaging resolution. Therefore, estimating frequency spectral uncertainty for image SR is valuable.
To fill this research gap, we aims to quantify SR un-certainty not only in the spatial domain but also in the frequency domain. Concretely, we first propose a dual-domain learning (DDL) framework for image SR. The pro-posed DDL introduces explicit frequency learning within networks and learns to reconstruct SR images and spectra simultaneously. Then combined with Bayesian approaches (MC-dropout [11] in this paper), the DDL model is able to estimate both spatial and spectral uncertainty of SR re-sults. To the best of our knowledge, we are the first to quan-tify SR uncertainty in the frequency domain. Extensive ex-periments on different non-ideal premises are conducted to show the effectiveness of the spectral uncertainty. Lastly, we further propose a spectral uncertainty based decoupled frequency (SUDF) training scheme for perceptual SR. The
SUDF decouple the training of different image frequencies with the guidance of estimated spectral uncertainty map, thereby boosting perceptual quality of SR results signifi-cantly without sacrificing much pixel accuracy.
In summary, the contributions of this paper are:
• We propose to quantify the frequency spectral uncer-tainty for deep SR networks. Experiments under sev-eral non-ideal premises demonstrate the effectiveness.
To the best of our knowledge, it is the first work to estimate SR uncertainty in the frequency domain.
• A DDL method is proposed for image SR. By per-forming explicit frequency domain learning in feature space, DDL can restore more HF information and thus provide more accurate uncertainty estimation when combined with Bayesian approaches.
• Based on the estimated spectral uncertainty, a novel
SUDF training scheme is proposed, helping enhance perceptual quality of SR results while maintaining re-construction faithfulness. 2.