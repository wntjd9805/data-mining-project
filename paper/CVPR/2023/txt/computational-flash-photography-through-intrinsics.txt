Abstract
Flash is an essential tool as it often serves as the sole controllable light source in everyday photography. How-ever, the use of flash is a binary decision at the time a photograph is captured with limited control over its char-acteristics such as strength or color. In this work, we study the computational control of the flash light in photographs taken with or without flash. We present a physically moti-vated intrinsic formulation for flash photograph formation and develop flash decomposition and generation methods for flash and no-flash photographs, respectively. We demon-strate that our intrinsic formulation outperforms alterna-tives in the literature and allows us to computationally con-trol flash in in-the-wild images. 1.

Introduction
Flash is an essential tool as it often serves as the sole con-trollable light source in everyday photography available on a wide range of cameras. Although most cameras measure the environment light to adjust the flash strength, whether to use flash or not is a binary decision for the casual photog-rapher without any control over flash characteristics such as strength or color temperature. In addition to hardware constraints, this limitation also stems from the typical use case of flash in situations that do not allow lengthy experi-mentation with illumination. This makes the computational control of the flash a desirable application in photography.
Using the superposition of illumination principle, a flash photograph can be modeled as the summation of flash and ambient illuminations in linear RGB:
P = A + F, (1) where P , A, and F represent the flash photograph, the am-bient illumination, and the flash illumination respectively.
To computationally control the flash post-capture, the am-bient and flash illuminations need to be decomposed. Sim-ilarly, to add flash light to a no-flash photograph, the flash illumination needs to be generated. In this work, we tackle both flash illumination decomposition and generation prob-lems and show that regardless of the original photograph being captured with or without flash, we can generate and control the flash photograph computationally.
We start by modeling the flash photograph formation
Intrinsic image decomposition through image intrinsics. models the image in terms of reflectance and shading:
I = R 路 S, (2) where I, R, and S represent the input image, the re-flectance map, and the shading respectively. This repre-sentation separates the effects of lighting in the scene from the illumination-invariant surface properties. With lighting
Figure 2. We can model the flash photograph formation in terms of separate shading maps for flash and ambient lights with a shared albedo. being the only difference between the ambient and flash il-luminations, both the decomposition and generation prob-lems are more conveniently modeled on shading. Assum-ing a mono-color ambient illumination and a single-channel shading representation, we re-write Eq. 1 using Eq. 2:
P = R 路 cASA + R 路 SF = R 路 (cASA + SF ), (3) where cA is a 3-dimensional vector representing the color temperature of the ambient illumination assuming the flash photograph P is white-balanced for the flash light. Fig. 2 visualizes our representation.
We develop a system for flash decomposition where we estimate cA, SA, and SF from a flash photograph and com-bine them with the shared reflectance R to compute the final flash and ambient illumination estimations. We show that this physically-inspired modeling of the flash photograph allows us to generate high-quality decomposition results.
Flash decomposition is an under-constrained problem where both A and F are partially observed within the in-put P . Flash generation, on the other hand, is a more challenging problem that amounts to full scene relighting as, in this scenario, only A is given as input for estimat-ing F .
In addition to our intrinsic modeling, we formu-late a self-supervision strategy for the generation problem through the cyclic relationship between decomposition and generation. We show that with a combined supervised and self-supervised strategy, we can successfully simulate flash photographs from no-flash input. 2.