Abstract
The images captured under improper exposure condi-tions often suffer from contrast degradation and detail dis-tortion. Contrast degradation will destroy the statisti-cal properties of low-frequency components, while detail distortion will disturb the structural properties of high-frequency components, leading to the low-frequency and high-frequency components being mixed and inseparable.
This will limit the statistical and structural modeling ca-pacity for exposure correction. To address this issue, this paper proposes to decouple the contrast enhancement and
It is detail restoration within each convolution process. based on the observation that, in the local regions covered by convolution kernels, the feature response of low-/high-frequency can be decoupled by addition/difference opera-tion. To this end, we inject the addition/difference operation into the convolution process and devise a Contrast Aware (CA) unit and a Detail Aware (DA) unit to facilitate the statistical and structural regularities modeling. The pro-posed CA and DA can be plugged into existing CNN-based exposure correction networks to substitute the Traditional
Convolution (TConv) to improve the performance. Fur-thermore, to maintain the computational costs of the net-work without changing, we aggregate two units into a single
TConv kernel using structural re-parameterization. Evalu-ations of nine methods and five benchmark datasets demon-strate that our proposed method can comprehensively im-prove the performance of existing methods without intro-ducing extra computational costs compared with the origi-nal networks. The codes will be publicly available. 1.

Introduction
Images captured under improper exposure conditions of-ten suffer from under-exposure or over-exposure problems
Improper exposure will change the statistical
[2, 14, 16]. distribution of image brightness, resulting in contrast degra-*Co-first author. †Corresponding author.
Figure 1. (a, b) The PSNR and SSIM comparison of TConv and our DAConv on the ME dataset. (c, d) The PSNR and SSIM com-parison of TConv and our DAConv on the SICE dataset. Under the boosting of DAConv, the performance of existing methods has been comprehensively improved, reaching a new SOTA perfor-mance without introducing extra computational costs. Complete results can be found in Table 2. dation. Besides, improper exposure will also destroy the image’s structural property and result in detail distortion.
The contrast degradation and detail distortion will cause the low-frequency and high-frequency components to mix and inseparable across the image, making the image exposure correction extremely challenging [2, 4, 9, 31, 33, 39].
In practice, one solution for this problem is to design an end-to-end architecture for learning contrast enhancement and detail restoration in shared feature space [14,16]. How-ever, the contrast-relevant features are primarily distributed in low-frequency components, while the detail-relevant fea-tures are primarily distributed in high-frequency compo-nents. Since low-frequency components are statistically dominant over high-frequency components, these methods mainly focus on contrast enhancement and cannot guarantee that the high-frequency details can be efficiently restored.
To achieve better contrast enhancement and detail restoration, some researchers propose to decompose and re-store the input image’s lightness and structure components, respectively [2, 20, 41]. For example, some researchers de-compose images into illumination and reflectance compo-nents by utilizing Retinex theory and then design a spe-cific network for each component [19, 20, 24]. Other re-searchers propose to decompose the input image into multi-scale components and adopt the coarse-to-fine strategy to progressively recover the lightness and fine-scale structures
[2]. However, the decomposition operation inevitably de-stroys the relationship between brightness and detail and cannot balance the contrast and detail enhancement, leading to over-smooth problems or artifacts for enhanced results.
To address the above issues, this paper proposes to de-couple the contrast enhancement and detail restoration dur-ing the convolution process. This method is based on statistical observations that the feature response in local regions can be decomposed into low-frequency compo-nents and high-frequency components by a difference oper-ation. Based on this, we introduce a novel Contrast Aware (CA) unit in parallel with a Detail Aware (DA) unit to guide the contrast and detail modeling, termed Decoupling-and-Aggregating Convolution (DAConv). Different from
TConv, we inject the addition/difference operation into the convolution process, which can guide the contrast and detail modeling in an explicit manner. Furthermore, to balance the contrast enhancement and detail restoration, we introduce a dynamic coefficient for each branch to adjust the amplitude of the feature response. Our proposed DAConv can be used as a general unit to substitute the TConv kernel in existing
CNN-based exposure correction networks to facilitate con-trast enhancement and detail restoration.
To reduce the computational costs, the CA, DA, and dy-namic coefficients are aggregated into a single TConv ker-nel by structural re-parameterization in the inference phase.
The aggregation is conducted before the activation func-tion, and the linear superposition can reduce computational costs without changing the function of DAConv. After that, the performance of networks can be significantly im-proved without introducing extra computational costs com-pared with the original network. Evaluations of nine meth-ods and five benchmark datasets demonstrate the effective-ness of our proposed method, as shown in Fig. 1.
The contribution can be summarized as follows: (1) We propose a novel decoupling-and-aggregating scheme for image exposure correction, in which two par-allel convolution processes are decoupled for contrast en-hancement and detail restoration, respectively, and then ag-gregated into a single branch without additional computa-tion compared with the original convolution scheme. (2) To facilitate the contrast and detail relevant features extraction, a novel CA and DA unit are devised by injecting the addition and difference operation into the convolution process. Compared with traditional convolution kernels, our proposed CA and DA can explicitly model the contrast and detail relevant properties. (3) Evaluations on the five prevailing benchmark datasets and nine SOTA image exposure correction methods demon-strate our proposed DC can comprehensively improve the contrast enhancement and detail restoration performances without introducing extra computational costs. 2.