Abstract
Trajectory prediction is a crucial undertaking in under-standing entity movement or human behavior from observed sequences. However, current methods often assume that the observed sequences are complete while ignoring the potential for missing values caused by object occlusion, scope limitation, sensor failure, etc. This limitation in-evitably hinders the accuracy of trajectory prediction. To address this issue, our paper presents a unified framework, the Graph-based Conditional Variational Recurrent Neural
Network (GC-VRNN), which can perform trajectory impu-tation and prediction simultaneously. Specifically, we in-troduce a novel Multi-Space Graph Neural Network (MS-GNN) that can extract spatial features from incomplete ob-servations and leverage missing patterns. Additionally, we employ a Conditional VRNN with a specifically designed
Temporal Decay (TD) module to capture temporal depen-dencies and temporal missing patterns in incomplete trajec-tories. The inclusion of the TD module allows for valuable information to be conveyed through the temporal flow. We also curate and benchmark three practical datasets for the joint problem of trajectory imputation and prediction. Ex-tensive experiments verify the exceptional performance of our proposed method. As far as we know, this is the first work to address the lack of benchmarks and techniques for trajectory imputation and prediction in a unified manner. 1.

Introduction
Modeling and predicting future trajectories play an in-dispensable role in various applications, i.e., autonomous driving [23, 25, 65], motion capture [57, 59], behavior un-derstanding [20, 38], etc. However, accurately predicting movement patterns is challenging due to their complex and
*Work done during Yi’s internship at Honda Research Institute, under
Chiho Choi’s supervision.
Figure 1. A typical example of incomplete observed trajectory.
The black car (ego-vehicle) is waiting at the intersection at time step t0, and the yellow car is moving. At time step t1, the red car is occluded by the yellow car, and the blue car appears. The bottom right figure indicates the “visibility” of four cars, where dark means visible and light color means invisible. subtle nature. Despite significant attention and numerous proposed solutions [5, 34, 62, 67–69] to the trajectory pre-diction problem, existing methods often assume that agent observations are entirely complete, which is too strong an assumption to satisfy in practice.
For example, in sports games such as football or soccer, not all players are always visible in the live view due to the limitation of the camera view. In addition, the live camera always tracks and moves along the ball, resulting in some players appearing and disappearing throughout the view, depending on their relative locations to the ball. Fig. 2 illus-trates this common concept. Similar situations also arise in autonomous driving where occlusion or sensor failure can cause missing data. As illustrated in Fig. 1, at time step
Figure 2. Three continuous frames of a “throw-and-catch” sequence in a live football match, where the ball is being circled. During this attacking play, the camera follows and zooms in on the ball. Only a subset of players is visible within the camera’s field of view. t0, there is no observation of the blue car. At time step t1, the red car is occluded by the yellow car from the black car perspective, and the blue car appears at the intersection to turn right. Predicting future trajectories of entities under these circumstances will no doubt hinder the performance and negatively influence behavior understanding of moving agents or vehicle safety operations.
Although various recent works [15,17,37,53,73,74] have investigated the time series imputation problem, most are autoregressive models that impute current missing values from previous time steps, making them highly susceptible to compounding errors for long-range temporal modeling.
Additionally, commonly used benchmarks [29,50,54,82] do not contain interacting entities. Some recent works [36, 78] have studied the imputation problem in a multi-agent sce-nario. Although these methods have achieved promising imputation performance, they fail to explore the relevance between the trajectory imputation and the prediction task.
In fact, complete trajectory observation is essential for pre-diction, and accurate trajectory prediction can offer valu-able information about the temporal correlation between past and future, ultimately aiding in the imputation process.
In this paper, we present a unified framework, Graph-based Conditional Variational Recurrent Neural Network (GC-VRNN), that simultaneously handles the trajectory im-putation and prediction. Specifically, we introduce a novel
Multi-Space Graph Neural Network (MS-GNN) to extract compact spatial features of incomplete observations. Mean-while, we adopt a Conditional VRNN (C-VRNN) to model the temporal dependencies, where a Temporal Decay (TD) module is designed to learn the missing patterns of incom-plete observations. The critical idea behind our method is to acquire knowledge of the spatio-temporal features of miss-ing patterns, and then unite these two objectives through shared parameters. Sharing valuable information allows these two tasks to support and promote one another for bet-ter performance mutually. In addition, to support the joint evaluation of multi-agent trajectory imputation and pre-diction, we curate and benchmark three practical datasets from different domains, Basketball-TIP, Football-TIP, and
Vehicle-TIP, where the incomplete trajectories are gener-ated via reasonable and practical strategies. The main con-tributions of our work can be summarized as follows:
• We investigate the multi-agent trajectory imputation and prediction problem and develop a unified frame-work, GC-VRNN, for imputing missing observations and predicting future trajectories simultaneously.
• We propose a novel MS-GNN that can extract com-prehensive spatial features of incomplete observations and adopt a C-VRNN with a specifically designed TD module for better learning temporal missing patterns, and valuable information is shared via temporal flow.
• We curate and benchmark three datasets for the multi-agent trajectory imputation and prediction problem.
Strong baselines are set up for this joint problem.
• Thorough experiments verify the consistent and excep-tional performance of our proposed method. 2.