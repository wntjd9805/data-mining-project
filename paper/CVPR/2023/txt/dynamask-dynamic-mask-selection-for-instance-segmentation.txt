Abstract
The representative instance segmentation methods mostly segment different object instances with a mask of the ﬁxed resolution, e.g., 28 × 28 grid. However, a low-resolution mask loses rich details, while a high-resolution mask incurs quadratic computation overhead. It is a chal-lenging task to predict the optimal binary mask for each in-stance. In this paper, we propose to dynamically select suit-able masks for different object proposals. First, a dual-level
Feature Pyramid Network (FPN) with adaptive feature ag-gregation is developed to gradually increase the mask grid resolution, ensuring high-quality segmentation of objects.
Speciﬁcally, an efﬁcient region-level top-down path (r-FPN) is introduced to incorporate complementary contextual and detailed information from different stages of image-level
FPN (i-FPN). Then, to alleviate the increase of computa-tion and memory costs caused by using large masks, we de-velop a Mask Switch Module (MSM) with negligible compu-tational cost to select the most suitable mask resolution for each instance, achieving high efﬁciency while maintaining high segmentation accuracy. Without bells and whistles, the proposed method, namely DynaMask, brings consistent and noticeable performance improvements over other state-of-the-arts at a moderate computation overhead. The source code: https://github.com/lslrh/DynaMask. 1.

Introduction
Instance segmentation (IS) is an important computer vi-sion task, aiming at simultaneously predicting the class la-bel and the binary mask for each instance of interest in an image.
It works as the cornerstone of many downstream vision applications, such as autonomous driving, video surveillance, and robotics, to name a few. Recent years have witnessed the signiﬁcant advances of deep convolu-tional neural networks (CNNs) based IS methods with a rich amount of training data as the rocket fuel [1, 10, 17, 25, 26].
Existing IS methods can be roughly divided into two ma-*denotes the equal contribution, †denotes the corresponding author.
This work is supported by the Hong Kong RGC RIF grant (R5001-18).
Figure 1. Dynamic mask selection results. Some “hard” sam-ples with irregular shapes like “person” are assigned larger masks, while the “easy” ones like “frisbee” are assigned smaller ones. jor categories: two-stage [6, 10, 17] and single-stage meth-ods [1, 2, 26]. The former ﬁrst detect a sparse set of pro-posals and then performs mask predictions based on them, while the latter directly predict classiﬁcation scores and masks based on the pre-deﬁned anchors. Generally speak-ing, two-stage methods could produce higher segmenta-tion accuracy but cost more computational resources than single-stage methods.
Among the many recently developed IS methods, the proposal-based two-stage methods [6, 10, 17], which fol-low a detection-and-segmentation paradigm, are still the top performers. These methods need to predict a binary grid mask of uniform resolution for all proposals, e.g., 28 × 28, and then upsample it to the original image size. For in-stance, Mask R-CNN [10] ﬁrst generates a group of propos-als with an object detector and then performs per pixel fore-ground/background segmentation on the Regions of Inter-est (RoIs) [24]. Despite achieving promising performance, the low-resolution mask of Mask R-CNN is insufﬁcient to capture more detailed information, resulting in unsatisfac-tory predictions, especially over object boundaries. An in-tuitive solution to improve the segmentation quality is to adopt a larger mask. Nevertheless, high-resolution masks often generate excessive predictions on the smooth regions, resulting in high computational complexity.
It is difﬁcult to segment different objects in an image
with masks of the same resolution. Objects with irregu-lar shapes and complicated boundaries demand more ﬁne-grained masks to predict, referred to as “hard” samples, such as the “person” in Fig. 1. In comparison, the “easy” samples with regular shapes and fewer details can be efﬁ-ciently segmented using coarser masks, like the “frisbee” in Fig. 1. Inspired by the above observations, we propose to adaptively adjust the mask size for each instance for bet-ter IS performance. Speciﬁcally, instead of using a uniform resolution for all instances, we assign high-resolution masks to “hard” objects and low-resolution masks to “easy” ob-jects.
In this way, the redundant computation for “easy” samples can be reduced while the accuracy of “hard” sam-ples can be improved, achieving a balance between accu-racy and speed. As shown in Tab. 1, however, directly pre-dicting a high-resolution mask by Mask R-CNN [10] unex-pectedly degrades the mask average precision (AP). This at-tributes to two main reasons. First, the RoI features of larger objects are extracted from higher pyramid levels, which are very coarse due to the downsampling operations [20]. Thus simply increasing the mask size of these RoIs will not bring extra useful information. Second, the mask head of Mask
R-CNN is oversimpliﬁed, so it cannot make more precise predictions as the mask grid size increases.
To overcome the above mentioned problems, we propose a dual-level FPN framework to gradually enlarge the mask grid. Speciﬁcally, in addition to traditional image-level FPN (i-FPN), a region-level FPN (r-FPN) is designed to achieve coarse-to-ﬁne mask prediction. Wherein we construct infor-mation ﬂows between i-FPN and r-FPN at different pyra-mid levels, aiming to incorporate complementary contex-tual and detailed information from multiple feature levels for high-quality segmentation. With the dual-level FPN, we present a data-dependent Mask Switch Module (MSM) with negligible computational cost to adaptively select masks for each instance. The overall approach, namely DynaMask, is evaluated on benchmark instance segmentation datasets to demonstrate its superiority over state-of-the-arts. The major contributions of this work are summarized as follows:
• A dynamic mask selection method (DynaMask) is pro-posed to adaptively assign appropriate masks to dif-ferent instances. Speciﬁcally, it assigns low-resolution masks to “easy” samples for efﬁciency while assigning high-resolution masks to “hard” samples for accuracy.
• A dual-level FPN framework is developed for IS. We construct direct information ﬂows from i-FPN to r-FPN at multiple levels, facilitating complementary in-formation aggregation from multiple pyramid levels.
• Extensive experiments demonstrate that DynaMask achieves a good trade-off between IS accuracy and efﬁ-ciency, outperforming many state-of-the-art two-stage
IS methods at a moderate computation overhead.
Method
Mask R-CNN [10]
DynaMask
Resolution AP 32.9 34.7 33.8 32.5 32.9 36.1 37.1 37.6 14×14 28×28 56×56 112×112 14×14 28×28 56×56 112×112
FLOPs 0.2G 0.5G 2.0G 8.0G 0.2G 0.6G 1.0G 1.4G
Table 1. Mask AP and FLOPs with different mask resolutions.
For Mask R-CNN, directly increasing the mask resolution will de-crease the mask AP. While for our DynaMask, higher mask reso-lution results in better performance. 2.