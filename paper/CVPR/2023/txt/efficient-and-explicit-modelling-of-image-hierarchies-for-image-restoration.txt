Abstract
The aim of this paper is to propose a mechanism to efficiently and explicitly model image hierarchies in the global, regional, and local range for image restoration. To achieve that, we start by analyzing two important prop-erties of natural images including cross-scale similarity and anisotropic image features. Inspired by that, we pro-pose the anchored stripe self-attention which achieves a good balance between the space and time complexity of self-attention and the modelling capacity beyond the re-gional range. Then we propose a new network architec-ture dubbed GRL to explicitly model image hierarchies in the Global, Regional, and Local range via anchored stripe self-attention, window self-attention, and channel attention enhanced convolution. Finally, the proposed network is ap-plied to 7 image restoration types, covering both real and synthetic settings. The proposed method sets the new state-of-the-art for several of those. Code will be available at https://github.com/ofsoundof/GRL-Image-Restoration.git. 1.

Introduction
Image restoration aims at recovering high-quality images from low-quality ones, resulting from an image degrada-tion processes such as blurring, sub-sampling, noise cor-ruption, and JPEG compression. Image restoration is an ill-posed inverse problem since important content information about the image is missing during the image degradation processes. Thus, in order to recover a high-quality image, the rich information exhibited in the degraded image should be fully exploited.
Natural images contain a hierarchy of features at global, regional, and local ranges which could be used by deep neu-ral networks for image restoration. First, the local range covers a span of several pixels and typical features are edges and local colors. To model such local features, convo-lutional neural networks (CNNs) with small kernels (e.g. 3 × 3) are utilized. Second, the regional range is charac-terized by a window with tens of pixels. This range of pix-(b) 0848x4 from DIV2K, 1020 × 768 (c) 073 from Urban100, 1024 × 765 (a) bridge from ICB, 2749 × 4049
Figure 1. Natural images show a hierarchy of features in a global, regional, and local range. The local (edges, colors) and regional features (the pink squares) could be well modelled by CNNs and window self-attention. By contrast, it is difficult to efficiently and explicitly model the rich global features (cyan rectangles). els can cover small objects and components of large objects (pink squares in Fig. 1). Due to the larger range, modelling the regional features (consistency, similarity) explicitly with large-kernel CNNs would be inefficient in both parameters and computation. Instead, transformers with a window at-tention mechanism are well suited for this task. Third, be-yond local and regional, some features have a global span (cyan rectangles in Fig. 1), incl. but not limited to symme-try, multi-scale pattern repetition (Fig. 1a), same scale tex-ture similarity (Fig. 1b), and structural similarity and con-sistency in large objects and content (Fig. 1c). To model features at this range, global image understanding is needed.
Different from the local and regional range features, there are two major challenges to model the global range features. Firstly, existing image restoration networks based on convolutions and window attention could not capture long-range dependencies explicitly by using a single com-putational module. Although non-local operations are used in some works, they are either used sparsely in the network or applied to small image crops. Thus, global image under-Figure 2. The proposed GRL achieves state-of-the-art performances on various image restoration tasks. Details provided in Sec. 5. standing still mainly happens via progressive propagation of features through repeated computational modules. Sec-ondly, the increasing resolution of today’s images poses a challenge for long-range dependency modelling. High im-age resolution leads to a computational burden associated with pairwise pixel comparisons and similarity searches.
The aforementioned discussion leads to a series of re-search questions: 1) how to efficiently model global range features in high-dimensional images for image restora-tion; 2) how to model image hierarchies (local, regional, global) explicitly by a single computational module for high-dimensional image restoration; 3) and how can this joint modelling lead to a uniform performance improvement for different image restoration tasks. The paper tries to an-swer these questions in Sec. 3, Sec. 4, and Sec. 5, resp.
First, we propose anchored stripe self-attention for effi-cient dependency modelling beyond the regional range. The proposed self-attention is inspired by two properties of nat-ural images including cross-scale similarity and anisotropic image features. Cross-scale similarity means that struc-tures in a natural image are replicated at different scales.
Inspired by that, we propose to use anchors as an inter-mediate to approximate the exact attention map between queries and keys in self-attention. Since the anchors sum-marize image information into a lower-dimensional space, the space and time complexity of self-attention can be sig-In addition, based on the observation nificantly reduced. of anisotropic image features, we propose to conduct an-chored self-attention within vertical and horizontal stripes.
Due to the anisotropic shrinkage of the attention range, a further reduction of complexity is achieved. And the com-bination of axial stripes also ensures a global view of the image content. When equipped with the stripe shift oper-ation, the four stripe self-attention modes (horizontal, ver-tical, shifted horizontal, shifted vertical) achieves a good balance between computational complexity and the capac-ity of global range dependency modelling. Furthermore, the proposed anchored stripe self-attention is analyzed from the perspective of low-rankness and similarity propagation.
Secondly, a new transformer network is proposed to ex-plicitly model global, regional, and local range dependen-cies in a single computational module. The hierarchical modelling of images is achieved by the parallel computa-tion of the proposed anchored stripe self-attention, window self-attention, and channel-attention enhanced convolution.
And the transformer architecture is dubbed GRL.
Thirdly, the proposed GRL transformer is applied to var-ious image restoration tasks. Those tasks could be classi-fied into three settings based on the availability of data in-cluding real image restoration, synthetic image restoration, and data synthesis based real image restoration.
In total, seven tasks are explored for the proposed network includ-ing image super-resolution, image denoising, JPEG com-pression artifacts removal, demosaicking, real image super-resolution, single image motion deblurring, and defocus de-blurring. As shown in Fig. 2, the proposed network shows promising results on the investigated tasks. 2.