Abstract
Despite the remarkable achievement of recent underwa-ter image restoration techniques, the lack of labeled data has become a major hurdle for further progress.
In this work, we propose a mean-teacher based Semi-supervised
Underwater Image Restoration (Semi-UIR) framework to incorporate the unlabeled data into network training. How-ever, the naive mean-teacher method suffers from two main problems: (1) The consistency loss used in training might become ineffective when the teacher’s prediction is wrong. (2) Using L1 distance may cause the network to over-fit wrong labels, resulting in confirmation bias. To ad-dress the above problems, we first introduce a reliable bank to store the “best-ever” outputs as pseudo ground truth. To assess the quality of outputs, we conduct an empirical analysis based on the monotonicity property to select the most trustworthy NR-IQA method. Besides, in view of the confirmation bias problem, we incorporate con-trastive regularization to prevent the overfitting on wrong labels. Experimental results on both full-reference and non-reference underwater benchmarks demonstrate that our algorithm has obvious improvement over SOTA methods quantitatively and qualitatively. Code has been released at https://github.com/Huang-ShiRui/Semi-UIR. 1.

Introduction
Due to light refraction, absorption and scattering in un-derwater scenes, images taken in the water usually suffer severely from color distortion, low contrast and blur. Im-ages with these defects tend to be less visually appealing and can potentially hinder the well-functioning of underwa-ter robotic systems. Recently, many deep learning based methods [5–7, 24, 51] have been proposed to address im-age restoration problems. Numerous efforts have also been devoted to the specific domain of underwater image restora-1This work is supported by the Nature Science Foundation of Shaanxi
Province of China (2021JM-125).
Figure 1. Examples from different benchmarks. (a) shows real-world underwater images from UIEB [22] with degraded images (first and second row). (b) shows the UWCNN training set [21] (synthesized based on the image formation model) and (c) shows the EUVP dataset [17] (synthesized by GAN). The ambient light and color cast of (b) and (c) are quite different from that of (a). tion [11, 17, 20, 22, 49]. Compared with traditional methods that mostly rely on hand-crafted priors, deep learning based solutions are able to deliver superior restoration results due to their data-driven nature.
Despite their success, most of deep learning based meth-ods are designed to learn the restoration mapping on paired datasets in a supervised manner. As is known, it is ex-tremely hard, if not impossible, to acquire paired underwa-ter images in real scenes. The existing datasets for under-water image restoration have several non-negligible issues: (1) Lack of real data. A popular way to construct paired datasets is to synthesize underwater images using some physical model [21] or GAN [17, 48]. However, there is a significant discrepancy between synthesized and real data.
As is shown in Fig. 1, the ambient light and color cast of synthetic data are quite different from the real counterparts.
Due to domain shift, models trained on synthetic datasets often exhibit poor generalization in real scenes. Another way [22] is to manually construct pseudo labels by select-ing the best results among those produced by traditional al-gorithms. Inevitably, the quality of the pseudo ground truth is restricted by the restoration capability of traditional algo-rithms. (2) Limited data size. The current benchmarks only provide a very limited amount of paired data. For example, in UIEB [22], there are only 890 paired underwater images.
Models learned on such a small dataset may run the risk of overfitting. In comparison, the standard datasets for image classification, such as ImageNet [35], are several orders of magnitude larger in size.
On the other hand, unlabeled underwater images are rel-atively easy to collect. The challenge is how to make ef-fective use of these unlabeled data. Semi-supervised learn-ing, which capitalizes on both labeled and unlabeled data for model training, is best suited in this kind of scenarios.
This motivates us to propose a semi-supervised scheme with the goal of improving the generalization of the resulting model on real-world underwater images. To be specific, we adopt the mean teacher method [40] as the basis. The mean teacher method finds a way to obtain pseudo labels for un-labeled data and utilizes a consistency loss to improve the accuracy and robustness of the network. Specifically, it con-structs a teacher model with improved performance from a student model via the exponential moving average (EMA) strategy. The teacher’s prediction serves as the pseudo la-bel to guide the training of the student. However, it is a non-trivial task to tailor the mean teacher method to the un-derwater image restoration problem. The reasons are as fol-lows: (1) There is no guarantee that the teacher can con-sistently outperform the student. Wrong pseudo labels may jeopardize the training of the student network. (2) The com-monly used consistency loss is based on L1 distance. The
“strict” L1 loss can easily make the model overfit wrong predictions, resulting in confirmation bias.
To address the first issue, we construct a reliable bank to archive the best-ever outputs from the teacher as pseudo la-bels. The main challenge here is how to determine what are the “best-ever” outputs? Intuitively, non-reference image quality assessment (NR-IQA) can be leveraged to evaluate the quality of each output. However, as noted in [3, 10, 22], the current NR-IQA metrics for underwater images are, to some extent, inconsistent with human visual perception. To identify the right one for our purpose, we compare several
NR-IQA metrics using the monotonicity property as the re-liability criterion. Our empirical analysis suggests MUSIQ
[19] best meets the criterion. For the second issue, we in-troduce contrastive learning as a supplementary regulariza-tion to alleviate overfitting. Unlike those conventional loss functions that are only concerned with how close the out-puts and ground truths are, contrastive loss provides addi-tional supervision to prevent the degradation of the outputs.
In this sense, contrastive regularization is ideally suited to our semi-supervised learning framework since we only have access to the degraded images in the unlabeled dataset. It enables the model to take advantage of unlabeled data.
In summary, our main contributions are as follows: (1)
We propose a mean teacher based semi-supervised un-derwater image restoration framework named Semi-UIR, which effectively leverages the knowledge from unlabeled data to improve the generalization of the trained model on real-world data. (2) We evaluate teacher outputs by a judi-ciously chosen NR-IQA metric and build a reliable bank to store best-ever teacher outputs, which ensures the reliabil-ity of pseudo-labels. (3) We adopt contrastive loss as a form of regularization to alleviate confirmation bias. (4) Exten-sive experimental results demonstrate the effectiveness of our proposed methods. 2.