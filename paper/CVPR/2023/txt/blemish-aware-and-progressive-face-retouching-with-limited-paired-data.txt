Abstract
Face retouching aims to remove facial blemishes, while at the same time maintaining the textual details of a giv-en input image. The main challenge lies in distinguishing blemishes from the facial characteristics, such as moles.
Training an image-to-image translation network with pixel-wise supervision suffers from the problem of expensive paired training data, since professional retouching need-In this s specialized experience and is time-consuming. paper, we propose a Blemish-aware and Progressive Face
Retouching model, which is referred to as BPFRe. Our framework can be partitioned into two manageable stages to perform progressive blemish removal. Speciﬁcally, an encoder-decoder-based module learns to coarsely remove the blemishes at the ﬁrst stage, and the resulting interme-diate features are injected into a generator to enrich lo-cal detail at the second stage. We ﬁnd that explicitly sup-pressing the blemishes can contribute to an effective col-laboration among the components. Toward this end, we incorporate an attention module, which learns to infer a blemish-aware map and further determine the correspond-ing weights, which are then used to reﬁne the intermediate features transferred from the encoder to the decoder, and from the decoder to the generator. Therefore, BPFRe is able to deliver signiﬁcant performance gains on a wide range of face retouching tasks. It is worth noting that we reduce the dependence of BPFRe on paired training samples by impos-ing effective regularization on unpaired ones. 1.

Introduction
With the development of social media, there is an in-creased demand for facial image beautiﬁcation from selﬁes to portraits and beyond. Facial skin retouching aims to re-∗Corresponding author.
Figure 1. Visual comparison of the activation maps produced by a generic attention module [47] (second row) and the blemish-aware module used in BPFRe (third row), given a number of images of faces with blemishes (top row). BPFRe is capable of applying attention on the regions close to the manual retouching regions (bottom row). move any unexpected blemishes from facial images, while preserving the stable characteristics that associate with face identity [2, 38, 41]. The main challenge is due to the wide range of blemishes including from small spots to severe ac-ne. Conventional methods are based on blind smoothing, such that the facial characteristics, such as moles and freck-les, may be removed. Professional face retouching can be expensive and needs specialized experience, which impedes the collection of large-scale paired data for model training.
Deep neural networks have been widely used for image-to-image translation, especially based on Generative Adver-sarial Networks (GANs) [6, 12, 22]. The translation per-formance has witnessed rapid progress in style transfer [7], image restoration [45, 48], image inpainting [47], and so on. The existing models are typically based on an encoder-decoder architecture. The source image is encoded into a latent representation, based on which a task-speciﬁc trans-formation is performed by the decoder. Different from the above image enhancement tasks, the regions needed to be retouched may be small, and most of the pixels are un-changed in this case. Generic encoder-decoder-based trans-lation methods can preserve irrelevant content but tend to overlook large blemishes and produce over-smoothed im-ages. Considering that StyleGAN-based methods have the capability of rendering the complex textual details [1, 11], we design a two-stage progressive face retouching frame-work to make use of the advantage of these types of archi-tectures, and learn the blemish-aware attention (as shown in
Figure 1) to guide the image rendering process.
More speciﬁcally, we propose a Blemish-aware Progres-sive Face Retouching model (BPFRe), which consists of t-wo stages: An encoder-decoder architecture is applied at the
ﬁrst stage to perform coarse retouching. The intermediate features from the encoder are integrated into the decoder via skip connections for better reconstruction of image content.
At the second stage, we modify the generator architecture of StyleGAN [22] to operate on the multi-scale intermedi-ate features of the decoder and render an image with ﬁner details. We consider that blemish removal cannot be ef-fectively achieved by simply transferring the intermediate features between the components, since there is no mecha-nism to suppress the blemishes before being passed to the next components. To address this issue, we incorporate t-wo blemish-aware attention modules between the encoder and decoder, and between the decoder and generator, re-spectively. This design enables progressive retouching by leveraging and reﬁning the information from the previous components. In addition to the paired training images, we use the unpaired ones to optimize the discriminator, which in turn guides the generator to synthesize realistic detail-s. We perform extensive experiments to qualitatively and quantitatively assess BPFRe on both standard benchmarks and data in the wild.
The main contributions of this work are summarized as follows: (a) To deal with a wide range of facial blemishes, we exploit the merits of both encoder-decoder and genera-tor architectures by seamlessly integrating them into a uni-ﬁed framework to progressively remove blemishes. (b) A blemish-aware attention module is incorporated to enhance the collaboration between the components by reﬁning the intermediate features that are transferred among the com-ponents. (c) We leverage unpaired training data to regular-ize the proposed framework, which effectively reduces the dependence on paired training data. 2.