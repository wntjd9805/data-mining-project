Abstract
Automatic mitochondria segmentation enjoys great pop-ularity with the development of deep learning. However, existing methods rely heavily on the labor-intensive manual gathering by experienced domain experts. And naively ap-plying semi-supervised segmentation methods in the natural image field to mitigate the labeling cost is undesirable. In this work, we analyze the gap between mitochondrial im-ages and natural images and rethink how to achieve effec-tive semi-supervised mitochondria segmentation, from the perspective of reliable prototype-level supervision. We pro-pose a novel end-to-end dual-reliable (DualRel) network, including a reliable pixel aggregation module and a reliable prototype selection module. The proposed DualRel enjoys several merits. First, to learn the prototypes well without any explicit supervision, we carefully design the referential correlation to rectify the direct pairwise correlation. Sec-ond, the reliable prototype selection module is responsible for further evaluating the reliability of prototypes in con-structing prototype-level consistency regularization. Exten-sive experimental results on three challenging benchmarks demonstrate that our method performs favorably against state-of-the-art semi-supervised segmentation methods. Im-portantly, with extremely few samples used for training, Du-alRel is also on par with current state-of-the-art fully super-vised methods. 1.

Introduction
Mitochondria, as one of the crucial organelles, are the primary energy providers for cell activities and are essen-tial for metabolism. Quantification of mitochondrial mor-phology can not only promote basic scientific research (e.g., cellular physiology [1, 5]), but also provide new insight for clinical diagnosis (e.g., neurodegenerative diseases [20] and diabetes [24]). Recently, with the development of deep learning, semantic segmentation [2, 14, 18, 27, 30, 33] en-ables in-depth exploration of mitochondrial morphology
*Equal contribution
â€ Corresponding author
Figure 1. Illustration of our motivation. (a) shows the confusion map and density (i.e., the expected inverse confidence per pixel) of mitochondrial and natural images. (b) shows the unreliability caused by direct pairwise prototype-pixel correlation that is condi-tioned only on visual similarity. (c) shows how to construct pixel-reference correlation to rectify the direct pairwise correlation in a referential correlation manner. from high-resolution electron microscopy (EM) images and make conspicuous achievements. However, their flexibil-ity and scalability are limited in the actual deployment be-cause the numerous cluttered irrelevant organelles that re-quire labor-intensive manual discrimination and gathering by experienced domain experts [10, 21]. Therefore, we be-gin to turn attention to semi-supervised segmentation with the assumption that enormous unlabeled data is accessible, aiming to alleviate the data-hungry issue.
Semi-supervised segmentation enjoys great popularity in the field of natural images, and representative works such as
CPS [3], which imposes pixel-level consistency regulariza-tion and establishes state-of-the-art performance. It natu-rally comes into mind to directly apply a CPS-like method to semi-supervised mitochondria segmentation. However, there exist a large gap between mitochondrial and natu-ral images. As shown in Fig. 1 (a), we observe that the confusion density (i.e., the expected inverse confidence per pixel) in mitochondrial images significantly surpasses coun-terpart in natural images, implying that directly employing
pixel-level consistency regularization as supervision signals on mitochondrial images will inevitably increase the risk of unreliability. The most intuitive example is that there exist considerable boundary regions in mitochondrial im-ages, and the segmentation network is naturally equivocal for these regions, as proven in [15]. In this case, some rel-atively small mitochondria are easily overwhelmed by this ambiguity, leading to sub-optimal results.
In order to seek more reliable supervision signals to al-leviate the undependable problem caused by pixel-level su-pervision, we draw inspiration from the inbuilt resistance to noisy pixels of prototypes and construct more robust and reliable prototype-level supervision. To achieve this goal, two issues need to be considered. (1) Unreliable pixels. Considering the cluttered background caused by under/overexposure and out-of-focus problems during EM imaging, the prototype inevitably absorbs unreliable pixels (i.e., heterogeneous semantic clues) during the interaction of corresponding pixels with a suitable pattern. We ar-gue that directly forcing pairwise prototype-pixel correla-tion is primarily at blame. As shown in Fig. 1 (b), due to the foreground-background ambiguity, the foreground pro-totype f1 is erroneously closer to p2 located in the back-ground than counterpart point p1 with similar pattern situ-ated in the foreground. Therefore, it is highly desirable to suppress the unreliable pixels caused by the direct pairwise prototype-pixel correlation that is only conditioned on vi-sual similarity during prototype learning process. (2) Unre-liable prototypes. Intuitively, not all prototypes are equiva-lent for building prototype-level consistency regularization.
For example, for a prototype that focuses on mitochondrial boundary patterns, the inherent unreliability of the pixels belonging to these patterns, as discussed above, will also taint the purity of this prototype with equivocality. There-fore, the prototype-level supervision signals should be fur-ther optimized to guarantee that the true reliable prototypes enjoy higher weights.
To mitigate the above issues, we rethink how to achieve effective consistency regularization for semi-supervised mi-tochondria segmentation, from the perspective of reliable prototype-level supervision. We propose a Dual-Reliable (DualRel) network including a reliable pixel aggregation module and a reliable prototype selection module. In the reliable pixel aggregation module (RPiA), to learn the prototypes well without any explicit supervision, we care-fully design the referential correlation to rectify the direct pairwise correlation, enabling the prototype absorb counter-part reliable pixels with the same semantic pattern during the interaction with the pixels. The main idea is, for each pixel/prototype, we can obtain the referential correlation (i.e., a likehood vector) by comparing this pixel/prototype with a set of reliable reference points. In essence, the refer-ential correlation reflects the consensus among reliable ref-erence points with a broader receptive field and thus it en-codes the relative semantic comparability of the reference points that can be relied upon, which is from a different per-spective than the absolute pairwise prototype-pixel correla-tion. Intuitively, each pair of true prototype-pixel correla-tion (e.g., the f1-p1 pair in Fig. 1 (c) derived from the proto-types and mitochondria images should be not only visually similar to each other (i.e., high direct pairwise prototype-pixel correlation), but also similar to any other reference point (i.e., similar referential correlation pair). Moreover, we assemble referential correlation into the cross-attention mechanism with the ability to capture long-range dependen-cies. In this case, the relatively equivocal pixels (e.g., the f1-p2 pair in Fig. 1 (c) will be suppressed while the reliable ones are highlighted to reduce the correspondence noise. In the reliable prototype selection module (RPrS), in order to further evaluate the reliability of prototypes in construct-ing prototype-level consistency regularization, we draw in-spiration from bayesian deep learning [12] and devise a reliability-aware consistency loss to pursue implicitly learn the reliability about each prototype in a data-driven way. In this way, the equivocal prototypes will be suppressed while the reliable ones are highlighted in the supervision signals.
In this work, our contributions can be concluded as fol-lows: (1) To the best of our knowledge, this is the first work to rethink how to achieve effective consistency regulariza-tion for semi-supervised mitochondria segmentation, from the perspective of reliable prototype-level supervision. We analyze the gap between mitochondrial images and natu-ral images, hoping our work will provide some insight for researchers in this field. (2) We propose a dual-reliable (DualRel) network in a unified framework. Specifically, we design the reliable pixel aggregation module to rectify the direct pairwise correlation, the reliable prototype se-lection module to further evaluate the reliability of proto-types in constructing prototype-level consistency regular-ization. (3) Extensive experimental results on three chal-lenging benchmarks demonstrate that our method performs favorably against state-of-the-art semi-supervised segmen-tation methods. Importantly, with extremely few samples used for training, DualRel is also on par with current state-of-the-art fully supervised methods. 2.