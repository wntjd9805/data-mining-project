Abstract
We analyze the DETR-based framework on semi-supervised object detection (SSOD) and observe that (1) the one-to-one assignment strategy generates incorrect match-ing when the pseudo ground-truth bounding box is inaccu-rate, leading to training inefficiency; (2) DETR-based de-tectors lack deterministic correspondence between the in-put query and its prediction output, which hinders the ap-plicability of the consistency-based regularization widely used in current SSOD methods. We present Semi-DETR, the first transformer-based end-to-end semi-supervised ob-ject detector, to tackle these problems. Specifically, we propose a Stage-wise Hybrid Matching strategy that com-bines the one-to-many assignment and one-to-one assign-ment strategies to improve the training efficiency of the first stage and thus provide high-quality pseudo labels for the training of the second stage. Besides, we introduce a Cross-view Query Consistency method to learn the semantic fea-ture invariance of object queries from different views while avoiding the need to find deterministic query correspon-dence. Furthermore, we propose a Cost-based Pseudo La-bel Mining module to dynamically mine more pseudo boxes based on the matching cost of pseudo ground truth bound-ing boxes for consistency training. Extensive experiments on all SSOD settings of both COCO and Pascal VOC bench-mark datasets show that our Semi-DETR method outper-forms all state-of-the-art methods by clear margins. 1.

Introduction
Semi-supervised object detection (SSOD) aims to boost the performance of a fully-supervised object detector by ex-*Equally-contributed authors. Work done during an internship at
Baidu.
†Corresponding author.
Figure 1. Comparisons between the vanilla DETR-SSOD frame-work based on the Teacher-Student architecture and our proposed
Semi-DETR framework. Semi-DETR consists of Stage-wise Hy-brid Matching, Cross-view Query Consistency powered by a cost-based pseudo label mining strategy. ploiting a large amount of unlabeled data. Current state-of-the-art SSOD methods are primarily based on object detec-tors with many hand-crafted components, e.g., rule-based label assigner [9, 26, 27, 31] and non-maximum suppression (NMS) [1] post-processing. We term this type of object de-tector as a traditional object detector. Recently, DETR [2], a simple transformer-based end-to-end object detector, has received growing attention. Generally, the DETR-based framework builds upon transformer [32] encoder-decoder architecture and generates unique predictions by enforcing a set-based global loss via bipartite matching during training.
It eliminates the need for various hand-crafted components, achieving state-of-the-art performance in fully-supervised object detection. Although the performance is desirable, how to design a feasible DETR-based SSOD framework re-mains under-explored. There are still no systematic ways to fulfill this research gap.
Designing an SSOD framework for DETR-based de-tectors is non-trivial. Concretely, DETR-based detectors take a one-to-one assignment strategy where the bipartite-matching algorithm forces each ground-truth (GT) bound-to implement. However, this is not the case in DETR-based detectors. DETR-based detectors [2, 15, 20, 40, 44] use randomly initialized learnable object queries as inputs and constantly update the query features through the atten-tion mechanism. As the query features update, the corre-sponding prediction results constantly change, which has been verified in [15]. In other words, there is no determinis-tic correspondence between the input object queries and its output prediction results, which prevents consistency regu-larization from being applied to DETR-based detectors.
According to the above analysis, we propose a new
DETR-based SSOD framework based on the Teacher-Student architecture, which we term Semi-DETR presented in Fig. 1 (b). Concretely, we propose a Stage-wise Hybrid
Matching module that imposes two stages of training us-ing the one-to-many assignment and the one-to-one assign-ment, respectively. The first stage aims to improve the train-ing efficiency via the one-to-many assignment strategy and thus provide high-quality pseudo labels for the second stage of one-to-one assignment training. Besides, we introduce a Cross-view Query Consistency module that constructs cross-view object queries to eliminate the requirement of finding deterministic correspondence of object queries and aids the detector in learning semantically invariant charac-teristics of object queries between two augmented views.
Furthermore, we devise a Cost-based Pseudo Label Min-ing module based on the Gaussian Mixture Model (GMM) that dynamically mines reliable pseudo boxes for consis-tency learning according to their matching cost distribution.
Differently, Semi-DETR is tailored for DETR-based frame-work, which achieves new SOTA performance compared to the previous best SSOD methods as illustrated in Fig. 2.
To sum up, this paper has the following contributions:
• We present a new DETR-based SSOD method based on the Teacher-Student architecture, called Semi-DETR. To our best knowledge, we are the first to ex-amine the DETR-based detectors on SSOD, and we identify core issues in integrating DETR-based detec-tors with the SSOD framework.
• We propose a stage-wise hybrid matching method that combines the one-to-many assignment and one-to-one assignment strategies to address the training ineffi-ciency caused by the inherent one-to-one assignment within DETR-based detectors when applied to SSOD.
• We introduce a consistency-based regularization scheme and a cost-based pseudo-label mining algo-rithm for DETR-based detectors to help learn semantic feature invariance of object queries from different aug-mented views.
• Extensive experiments show that our Semi-DETR method outperforms all previous state-of-the-art meth-ods by clear margins under various SSOD settings on both MS COCO and Pascal VOC benchmark datasets.
Figure 2. Performance comparisons between the proposed Semi-DETR and other SSOD methods, including PseCo [16] and Dense-Teacher [42]. ing box to match a candidate proposal as positive, treating remains as negatives. It goes well when the ground-truth bounding boxes are accurate. However, directly integrat-ing DETR-based framework with SSOD is problematic, as illustrated in Fig. 1 (a) where a DETR-SSOD vanilla frame-work utilizes DETR-based detectors to perform pseudo la-beling on unlabeled images. In the Teacher-Student archi-tecture, the teacher model usually generates noisy pseudo bounding boxes on the unlabeled images. When the pseudo bounding box is inaccurate, the one-to-one assignment strategy is doomed to match a single inaccurate proposal as positive, leaving all other potential correct proposals as negative, thus causing learning inefficiency. As a compar-ison, the one-to-many assignment strategy adopted in the traditional object detectors maintains a set of positive pro-posals, having a higher chance of containing the correct positive proposal. On the one hand, the one-to-one assign-ment strategy enjoys the merits of NMS-free end-to-end detection but suffers the training inefficiency under semi-supervised scenarios; on the other hand, the one-to-many assignment strategy obtains candidate proposal set with bet-ter quality making the detector optimized more efficiently but inevitably resulted in duplicate predictions. Designing a DETR-based SSOD framework that embraces these two merits could bring the performance to the next level.
Additionally, the consistency-based regularization com-monly used in current SSOD methods becomes infeasible in DETR-based SSOD. Specifically, current SSOD meth-ods
[3, 10, 13, 16] utilize consistency-based regulariza-tion to help object detectors learn potential feature invari-ance by imposing consistency constraints on the outputs of pairs-wise inputs (such as scale consistency [3, 10, 16], weak-strong consistency [13], etc.). Since the input fea-tures are deterministic in traditional object detectors, there is a one-to-one correspondence between the inputs and out-puts, which makes the consistency constraint convenient
2.