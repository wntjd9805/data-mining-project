Abstract
Intersection-over-Union (IoU) is the most popular metric to evaluate regression performance in 3D object detection.
Recently, there are also some methods applying IoU to the optimization of 3D bounding box regression. However, we demonstrate through experiments and mathematical proof that the 3D IoU loss suffers from abnormal gradient w.r.t. angular error and object scale, which further leads to slow convergence and suboptimal regression process,
In this paper, we propose a Gradient-respectively.
Corrected IoU (GCIoU) loss to achieve fast and accurate 3D bounding box regression.
Specifically, a gradient correction strategy is designed to endow 3D IoU loss
It ensures that the model with a reasonable gradient. converges quickly in the early stage of training, and helps to achieve fine-grained refinement of bounding boxes in the later stage. To solve suboptimal regression of 3D IoU loss for objects at different scales, we introduce a gradient rescaling strategy to adaptively optimize the step size.
Finally, we integrate GCIoU Loss into multiple models to achieve stable performance gains and faster model convergence. Experiments on KITTI dataset demonstrate superiority of the proposed method. The code is available at https://github.com/ming71/GCIoU-loss. 1.

Introduction
Autonomous driving has received extensive attention in recent years due to its broad application scenarios. 3D ob-ject detection is a very important and promising topic of autonomous driving. Currently, LiDAR is the most com-monly used sensor to obtain representations of object in the real world for 3D object detection [4,21,33,35,40,44]. The
∗ Corresponding author.
† Contribute equally.
Figure 1. Visualization of some problems in current 3D IoU loss. (a) Gradient changes of 3D IoU loss w.r.t. angular error. Gradients are small under large angular errors. (b) Convergence of bounding boxes of different scales under supervision of 3D IoU loss. The optimization for multi-scale objects is different.
IoU Loss con-verges slower for large objects. sparse point cloud data from LiDAR scanners can provide depth information of objects, which is critical for accurate 3D object detection.
Intersection-over-Union (IoU) is the most popular metric used to measure the detection accuracy and evaluate per-formance of the model. But in the training phase, current detectors usually use the Lnorm-based loss function to op-timize the bounding box regression [6, 24, 34, 43, 50]. The inconsistency between training loss and evaluation metric would lead to a misaligned optimization process. Specifi-cally, a lower loss value does not guarantee better detection performance (higher IoU), which has also been discussed in some previous work [25,26,38,41,48,49]. For example, Yu
et al. [41] suggested out that IoU, as an evaluation metric in 2D object detection, can naturally be used in loss function to achieve consistency between training and testing. Zhou et al. [49] extended the case to 3D object detection and de-signed 3D IoU loss for autonomous driving.
IoU-based loss and its variants are studied and widely used in 2D object detection [9, 16–18, 25, 36, 48]. There are some work to introduce 3D IoU into 3D object detection and achieve performance improvement [12, 13, 15, 32, 49].
However, the IoU loss in 3D object detection is quite differ-ent from that in 2D object detection. Firstly, the 3D bound-ing boxes have higher degree of freedom than 2D horizontal bounding boxes, which makes the IoU calculation between two 3D bounding boxes very complicated. Secondly, the
IoU-based losses generally converges slowly. The larger search space and higher degrees-of-freedom of 3D bound-ing box parameters further increases the difficulty of model convergence. There are also some previous work devoted to the improvements on 3D IoU loss [26, 47]. For in-stance, Rotation-robust Intersection over Union (RIoU) [47] uses a projection operation to estimate the intersection area to simplify the calculation of 3D IoU, which is both ro-bust and feasible for back-propagation. Recently, Rotation-Decoupled IoU (RDIoU) [26] decouples the rotation vari-able to solve the negative coupling effect of rotation on the 3D IoU.
However, most of 3D IoU based losses directly apply 3D IoU or use its variants to supervise bounding box re-gression, and do not give an in-depth analyze to the loss gradient changes during training. As shown in Fig. 1(a), we found that the 3D IoU loss suffers from abnormal gra-dient changes during training. Firstly, when the angular er-ror between predicted box and the ground-truth (GT) box is large, 3D IoU loss produces small gradients for optimiza-tion, which leads to a very slow convergence. Secondly, as the model converges, the angular error decreases, but there is a period where the gradient increases abnormally. In this case, the angle prediction is difficult to be refined, and it even leads to the loss oscillation (see Fig. 1(a)). Further-more, IoU is generally considered to be scale-invariant, but we observed that the optimization of the 3D IoU loss per-forms differently for objects of different scales. As shown in Fig. 1(b), for large scale objects, more iterations are re-quired to make the bounding box regressed well.
In this paper, we give detailed discussion of gradient changes of 3D IoU loss from both experimental results and mathematical analysis. Then, we propose a gradient-correction IoU (GCIoU) loss to solve the mentioned prob-lems. GCIoU loss contains two parts, gradient correction strategy and gradient rescaling strategy. Gradient correction strategy corrects the gradient of 3D IoU loss w.r.t. angu-lar error to ensure smooth angle convergence. The GCIoU loss is then obtained by integrating the expected gradients.
Further, to optimize the convergence of objects of different scales, we use a gradient rescaling strategy to modify the gradient of IoU loss w.r.t. scale to adaptively update the variables. Experimental results on KITTI dataset demon-strate the superiority of our method.
The main contributions of this paper are summarized as follows:
• We found the abnormal gradient changes of 3D IoU loss w.r.t. angular error during the optimization pro-cess through experiments, and further gave analysis and proof for it.
• We observed different performances of the 3D IoU loss for the optimization of objects of different scales, and concluded that it is also caused by abnormal gradients via mathematical analysis.
• The gradient-correction IoU (GCIoU) loss is proposed to alleviate abnormal gradients and accelerate conver-gence of 3D IoU based loss. The parameter update strategy is then adjusted to adaptively optimize multi-scale objects with different steps. 2.