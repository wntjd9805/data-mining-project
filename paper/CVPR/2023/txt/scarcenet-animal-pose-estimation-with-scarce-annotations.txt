Abstract
Animal pose estimation is an important but under-explored task due to the lack of labeled data. In this paper, we tackle the task of animal pose estimation with scarce annotations, where only a small set of labeled data and un-labeled images are available. At the core of the solution to this problem setting is the use of the unlabeled data to com-pensate for the lack of well-labeled animal pose data. To this end, we propose the ScarceNet, a pseudo label-based approach to generate artificial labels for the unlabeled im-ages. The pseudo labels, which are generated with a model trained with the small set of labeled images, are generally noisy and can hurt the performance when directly used for training. To solve this problem, we first use a small-loss trick to select reliable pseudo labels. Although effective, the selection process is improvident since numerous high-loss samples are left unused. We further propose to identify reusable samples from the high-loss samples based on an agreement check. Pseudo labels are re-generated to provide supervision for those reusable samples. Lastly, we intro-duce a student-teacher framework to enforce a consistency constraint since there are still samples that are neither re-liable nor reusable. By combining the reliable pseudo la-bel selection with the reusable sample re-labeling and the consistency constraint, we can make full use of the unla-beled data. We evaluate our approach on the challenging
AP-10K dataset, where our approach outperforms existing semi-supervised approaches by a large margin. We also test on the TigDog dataset, where our approach can achieve bet-ter performance than domain adaptation based approaches when only very few annotations are available. Our code is available at the project website 1. 1.

Introduction
The ability to understand animal behavior is fundamen-tal to many applications, such as farming, ecology and surveillance. Animal pose estimation is a key step to un-1https://github.com/chaneyddtt/ScarceNet
Figure 1. An illustration of our task. We aim to achieve accurate animal pose estimation with a small set of labeled images as well as unlabeled images. derstand animal behavior and has attracted increasing atten-tion in recent years [5, 16, 20, 23, 33]. Although great suc-cess is achieved for human pose estimation with the devel-opment of sophisticated deep learning models, these tech-niques cannot be directly used for animals due to the lack of labeled animal pose data. Existing works overcome this problem by learning from human pose data [5] or synthetic animal images [16, 20, 23]. However, there is a large do-main gap between the real and synthetic (human) data. For example, the synthetic animal images in [20], which are generated from CAD models, only exhibit limited pose, ap-pearance and background variations. As a result, the model trained with the synthetic data may not adapt well to real images, especially for images with crowded scene or self-occlusion. Moreover, the generation of synthetic images is a tedious process that also requires expert knowledge. The above-mentioned problems lead us to ask whether we can achieve accurate animal pose estimation with minimal ef-fort for annotating? To answer this question, we focus on how to learn from scarce labeled data for animal pose es-timation. As shown in Fig. 1, we aim to achieve accurate animal pose estimation with only a small set of labeled im-ages and unlabeled images.
The data scarcity problem is solved by semi-supervised learning (SSL) for the classification task [3,25,28,34]. One powerful class of SSL is pseudo labeling (PL), where ar-tificial labels generated from a pretrained model are used
Impressive together with labeled data to train a model.
results have been achieved by applying PL [5, 16, 20] to domain adaptation based animal pose estimation. How-ever, the PL-based methods suffer from confirmation bias when the network starts to output incorrect predictions with high confidence, which we refer as noisy pseudo labels. To solve this noisy pseudo label problem, we use the small-loss trick [9, 16] to select reliable pseudo labels, i.e. sam-ples with small loss to update the network. This criteria is based on the memorization effect [2] of deep networks where the network learn from clean and easy instances first before eventually overfitting to noisy ones. Consequently, clean samples exhibit smaller loss compared to noisy ones at the beginning of training. Although the small-loss trick is effective in selecting reliable pseudo labels, it is wasteful because numerous high-loss samples are left unused.
In this paper, we propose the ScarceNet, a PL-based ap-proach to learn an animal pose network from scarce anno-tations. We first train an animal pose estimation network on the small set of labeled data, and then generate pseudo labels for the unlabeled images with the pretrained model.
The pseudo labels are often corrupted with noise due to the small size of the training data. We thus also select reliable pseudo labels using the small-loss trick, However, instead of ignoring or adding consistency regularization to the high-loss samples as done in previous works [16, 20], we pro-pose to identify reusable samples from those high-loss sam-ples based on an agreement check. The agreement check is to guarantee that the model predictions for the reusable samples are smooth and concurrently far from the decision boundary, and hence allow us to directly re-label reusable samples with the model predictions. Finally, we introduce a student-teacher network [28] and enforce a consistency constraint since there are still samples that are neither reli-able nor reusable. By combining the reliable pseudo label selection with the reusable sample re-labeling and the con-sistency constraint, we can fully exploit the unlabeled data.
In addition to the training scheme, we also modify the state-of-the-art human pose estimation network HRNet [27] and adapt it to the pseudo label-based learning framework.
The original HRNet regresses the heatmaps of different joints from a shared feature representation. However, the negative effect of noisy pseudo label for any joint is prop-agated to all other joints through this shared feature repre-sentation. To mitigate this problem, we introduce a multi-branch HRNet (MBHRNet) where a joint-specific feature representation is learned for regressing the corresponding joint location in each branch.
We validate our approach on the challenging AP-10K dataset [33], which includes animal images from more than 50 species. Our approach outperforms existing SSL meth-ods by a large margin, especially when the labeled data is very limited (for example, 5 labeled images per species).
We also test our approach under the inter-family transfer setting, where animal species from only one family are la-beled and the rest are unlabeled. Our approach improves the HRNet baseline significantly, and even outperform the supervised counterpart for some species. We further test on the TigDog dataset [20], where we can outperform exist-ing synthetic data based approaches when only 0.5% of the dataset is labeled. Our contribution can be summarized as follows:
• We propose a pseudo label based training scheme for the task of animal pose estimation from scarce labels.
• We introduce the MBHRNet to mitigate negative effect of noisy joints to other joints in the same image.
• We achieve state-of-the-art performance on several an-imal pose benchmarks under different settings. 2.