Abstract
Existing studies have empirically observed that the reso-lution of the low-frequency region is easier to enhance than that of the high-frequency one. Although plentiful works have been devoted to alleviating this problem, little under-standing is given to explain it. In this paper, we try to give a feasible answer from a machine learning perspective, i.e., the twin ﬁtting problem caused by the long-tailed pixel dis-tribution in natural images. With this explanation, we refor-mulate image super resolution (SR) as a long-tailed distri-bution learning problem and solve it by bridging the gaps of the problem between in low- and high-level vision tasks.
As a result, we design a long-tailed distribution learning so-lution, that rebalances the gradients from the pixels in the low- and high-frequency region, by introducing a static and a learnable structure prior. The learned SR model achieves better balance on the ﬁtting of the low- and high-frequency region so that the overall performance is improved. In the experiments, we evaluate the solution on four CNN- and one
Transformer-based SR models w.r.t. six datasets and three tasks, and experimental results demonstrate its superiority. 1.

Introduction
Image super resolution aims to restore a high-resolution (HR) image from a low-resolution (LR) one, which is an important technique in image processing [13,26,27,52] and computer vision [7,14,18,45,51]. In the past decades, plen-tiful SR methods have been proposed [19, 53], and applied to a wide range of real-world applications [21, 47, 49, 54].
Among existing studies, the learning-based methods that learn a mapping between LR and HR image spaces have achieved the state-of-the-art performance [17,39,43,58,59].
Nonetheless, they have empirically observed that the high-frequency regions are harder to be super-resolved than the
∗Corresponding author
BI and I SR
Figure 1. The long-tailed pixel distribution in the natural image.
For given a HR image I HR, we take ×4 LR version I LR as a showcase, and utilize Bicubic Interpolation (BI) and MSRRes-Net [25] (MSRRN) to super-resolve it, i.e., I SR
M SRRN , re-spectively. The top row shows the absolute difference (AD) in the luminance channel, and the bottom row shows the pixel number at different AD intervals. From the top row, one could observe that i) both BI and MSRRN achieve better results in the low- than high-frequency regions; ii) MSRRN performs signiﬁcantly better than
BI in the high-frequency regions while slightly better in the low ones. From the bottom row, one could see that iii) the pixel dis-tribution w.r.t. the low- and high-frequency region is long-tailed, i.e., the number of pixels in the low-frequency regions is far more than that in the high-frequency ones. Clearly, such an imbalanced pixel distribution necessarily results in the twin ﬁtting problem, i.e., overﬁtting majority pixels in the low-frequency region while underﬁtting minority pixels in the high-frequency one. low-frequency ones in the natural image. To alleviate that, various SR methods have been proposed following the be-low two paradigms, i.e., developing generalized models with larger capacities [31, 36] or speciﬁc models with high-frequency enhancements [37,48]. The former obtains better results in both the high- and low-frequency regions via con-stantly enlarging the capacities, while the latter enhances the high-frequency regions through speciﬁc auxiliary sub-networks, loss functions, training strategies, etc. Although the promising results have been obtained, they involve the following three limitations. First, the large capacity models take a lot of time and computations in the training and infer-ring, which is unavailable to mobile scenarios. Second, the speciﬁc models need ingenious designs about the architec-ture and training strategy, which is difﬁcult to training and prone to artifacts. Third, they don’t dive into the problem and give a reasonable explanation, thus alleviate the prob-lem not in the most cost-effective way.
In this paper, we dive into the problem and explain it from a machine learning perspective, i.e., the twin ﬁtting problem caused by the long-tailed pixel distribution in the natural images. Taking the Fig. 1 as an example, the num-ber of pixels in the low-frequency region is far more than that in the high-frequency one, i.e., the long-tailed pixel dis-tribution. Since majority pixels in the low-frequency region dominate minority pixels in the high-frequency one, the gra-dients of SR model are mainly from the former instead of the latter. As a result, the SR model is optimized to mainly
ﬁt the pixels in the low-frequency region, and thus over-ﬁtting them while underﬁtting those in the high-frequency region, i.e., the twin ﬁtting problem.
Motivated by the above explanation, we reformulate SR as the long-tailed distribution learning problem. With this reformulation, the twin ﬁtting problem could be alleviated during training in a model-agnostic way, and thus applicable to different SR models. However, although the long-tailed distribution learning problem has been extensively studied in high-level vision tasks, there are few works on it in low-level ones. Therefore, we bridge the gaps of the problem between in low- and high-level vision ones, and design a simple and effective solution to verify the feasibility of our reformulation. To be speciﬁc, we design a novel long-tailed distribution learning method for SR, termed as Focal Pixel
Learning (FPL), which adaptively re-weights the loss con-tribution of pixels by combining two complementary struc-ture priors. In this way, the gradients of SR model could be rebalanced, leading it to achieve better balance on the ﬁtting of the high- and low-frequency regions.
The contributions of this work are summarized below.
• For the ﬁrst time, this work dives into the observation that the high-frequency regions are harder to be super-resolved than the low-frequency ones, and gives a rea-sonable explanation, i.e., the long-tailed pixel distribu-tion and it caused twin ﬁtting problem.
• With our explanation, this work reformulates SR as a long-tailed distribution learning problem and designs a novel solution to verify its feasibility, which could be the ﬁrst long-tailed distribution learning solution for
SR, as far as we know.
• Extensive analyses and experiments are conducted to demonstrate the explanation, verify the reformulation, and validate the solution. The results demonstrate that our works could consistently improve the performance of SR models with different complexities. 2.