Abstract
Learning to predict agent motions with relationship rea-soning is important for many applications. In motion pre-diction tasks, maintaining motion equivariance under Eu-clidean geometric transformations and invariance of agent interaction is a critical and fundamental principle. However, such equivariance and invariance properties are overlooked by most existing methods. To fill this gap, we propose Eq-Motion, an efficient equivariant motion prediction model with invariant interaction reasoning. To achieve motion equivariance, we propose an equivariant geometric feature learning module to learn a Euclidean transformable feature through dedicated designs of equivariant operations. To reason agent’s interactions, we propose an invariant interac-tion reasoning module to achieve a more stable interaction modeling. To further promote more comprehensive motion features, we propose an invariant pattern feature learning module to learn an invariant pattern feature, which coop-erates with the equivariant geometric feature to enhance network expressiveness. We conduct experiments for the proposed model on four distinct scenarios: particle dynam-ics, molecule dynamics, human skeleton motion prediction and pedestrian trajectory prediction. Experimental results show that our method is not only generally applicable, but also achieves state-of-the-art prediction performances on all the four tasks, improving by 24.0/30.1/8.6/9.2%. Code is available at https://github.com/MediaBrain-SJTU/EqMotion. 1.

Introduction
Motion prediction aims to predict future trajectories of multiple interacting agents given their historical observations.
It is widely studied in many applications like physics [3, 28], molecule dynamics [7], autonomous driving [35] and human-robot interaction [38,68]. In the task of motion prediction, an
*Corresponding author.
Figure 1. Motion equivariance and interaction invariance under the Euclidean geometric transformation is a fundamental principle for a prediction model, but this principle is often overlooked by previous works. In this work, we propose EqMotion to fill this gap. often-overlooked yet fundamental principle is that a predic-tion model is required to be equivariant under the Euclidean geometric transformation (including translation, rotation and reflection), and at the same time maintain the interaction relationships invariant. Motion equivariance here means that if an input motion is transformed under a Euclidean trans-formation, the output motion must be equally transformed under the same transformation. Interaction invariance means that the way agents interact remains unchanged under the input’s transformation. Figure 1 shows real-world examples of motion equivariance and interaction invariance.
Employing this principle in a network design brings at least two benefits. First, the network will be robust to arbi-trary Euclidean transformations. Second, the network will have the capability of being generalizable over rotations and translations of the data. This capability makes the network more compact, reducing the network’s learning burden and contributing to a more accurate prediction.
Despite the motion equivariance property being important
and fundamental, it is often neglected and not guaranteed by most existing motion prediction methods. The main reason is that these methods transform the input motion sequence directly into abstract feature vectors, where the geometric transformations are not traceable, causing the geometric relationships between agents to be irretrievable. Random augmentation will ease the equivariance problem, but it is still unable to guarantee the equivariance property. [30] uses non-parametric pre and post coordinate processing to achieve equivariance, but its parametric network structures do not satisfy equivariance. Some methods propose equivariant parametric network structures utilizing the higher-order rep-resentations of spherical harmonics [14, 61] or proposing an equivariant message passing [58], but they focus on the state-to-state prediction. This means that they use only one historical timestamp to predict one future timestamp. Conse-quently, these methods have limitations on utilizing motion’s temporal information and modeling interaction relationships since a single-state observation is insufficient for both inter-action modeling and temporal dependency modeling.
In this paper, we propose EqMotion, the first motion pre-diction model that is theoretically equivariant to the input motion under Euclidean geometric transformations based on the parametric network. The proposed EqMotion has three novel designs: equivariant geometric feature learning, invariant pattern feature learning and invariant interaction reasoning. To ensure motion equivariance, we propose an equivariant geometric feature learning module to learn a Eu-clidean transformable geometric feature through dedicated designs of equivariant operations. The geometric feature preserves motion attributes that are relevant to Euclidean transformations. To promote more comprehensive repre-sentation power, we introduce an invariant pattern feature learning module to complement the network with motion attributes that are independent of Euclidean transformations.
The pattern features, cooperated into the geometric features, provide expressive motion representations by exploiting mo-tions’ spatial-temporal dependencies.
To further infer the interactions during motion prediction, we propose an invariant interaction reasoning module, which ensures that the captured interaction relationships are invari-ant to the input motion under Euclidean transformations.
The module infers an invariant interaction graph by utilizing invariant factors in motions. The edge weights in the inter-action graph categorize agents’ interactions into different types, leading to better interaction representation.
We conduct extensive experiments on four different sce-narios to evaluate our method’s effectiveness: particle dy-namics, molecule dynamics, 3D human skeleton motion and pedestrian trajectories. Comparing to many task-specific motion prediction methods, our method is generally appli-cable and achieves state-of-the-art performance in all these tasks by reducing the prediction error by 24.0/30.1/8.6/9.2% respectively. We also present that EqMotion is lightweight, and has a model size less than 30% of many other models’ sizes. We show that EqMotion using only 5 % data can achieve a comparable performance with other methods that take full data. As a summary, here are our contributions:
• We propose EqMotion, the first motion prediction model that theoretically ensures sequence-to-sequence mo-tion equivariance based on the parametric network. With equivariance, EqMotion promotes more generalization abil-ity of motion feature learning, leading to more robust and accurate prediction.
• We propose a novel invariant interaction reasoning mod-ule, in which the captured interactions between agents are invariant to the input motion under Euclidean geometric transformations. With this, EqMotion achieves more gener-alization ability and stability in the interaction reasoning.
• We conduct experiments on four types of scenarios and find that EqMotion is applicable to all these different tasks, and importantly outperforms existing state-of-the-art methods on all the tasks. 2.