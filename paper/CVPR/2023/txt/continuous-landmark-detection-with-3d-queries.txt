Abstract
Neural networks for facial landmark detection are noto-riously limited to a ﬁxed set of landmarks in a dedicated layout, which must be speciﬁed at training time. Dedi-cated datasets must also be hand-annotated with the cor-responding landmark conﬁguration for training. We pro-pose the ﬁrst facial landmark detection network that can predict continuous, unlimited landmarks, allowing to spec-ify the number and location of the desired landmarks at in-ference time. Our method combines a simple image feature extractor with a queried landmark predictor, and the user can specify any continuous query points relative to a 3D template face mesh as input. As it is not tied to a ﬁxed set of landmarks, our method is able to leverage all pre-existing 2D landmark datasets for training, even if they have incon-sistent landmark conﬁgurations. As a result, we present a very powerful facial landmark detector that can be trained once, and can be used readily for numerous applications like 3D face reconstruction, arbitrary face segmentation, and is even compatible with helmeted mounted cameras, and therefore could vastly simplify face tracking workﬂows for media and entertainment applications. 1.

Introduction
Facial landmark detection has become extremely popular in computer vision and graphics applications. In particular, many applications in visual effects such as 3D facial recon-struction, tracking, face swapping and re-enactment rely on 0Now at Google accurate facial landmark detection as one of the ﬁrst steps in the process. It is therefore a crucial task and has been stud-ied extensively for the past several decades, and the ﬁeld has seen immense progress thanks to advances in deep learning.
State-of-the-art solutions for facial landmark detection are based on neural networks, and they operate by train-ing the network to predict a ﬁxed set of landmarks, lever-aging large datasets of hand-annotated images. Most stan-dard algorithms predict a set of 68 sparse landmarks spread across the face (Fig. 1 (a)), in a very speciﬁc and prede-ﬁned layout [33]. However, recent work has shown that predicting denser landmarks on the face is better for tasks like face reconstruction [43]. This brings up the question of how many landmarks one has to predict for optimal perfor-mance (depending on the application), and what is the pre-ferred layout of these landmarks? One of the biggest issues with traditional facial landmark detectors is that you need to decide on the number and layout of the landmarks ahead of time, then obtain annotated data with the corresponding landmarks and ultimately train the detector. Later, at run-time, the landmark layout cannot be changed.
An ideal landmark detector would not be bound to a spe-ciﬁc ﬁxed landmark layout. Such a detector could be trained once and then used in several applications with different landmark conﬁgurations. For example, in face image seg-mentation you may want to track landmarks corresponding to segment boundaries, but then in 3D reconstruction you might want to track landmarks corresponding to the ver-tices of your 3D face mesh. For individuals with speciﬁc face details like freckles or moles, you might want a de-tector that can track these user-deﬁned points for the appli-cation of digital video touchup. For each application, with today’s detectors you would need to train separate landmark detection networks, one for each landmark layout.
In this work we aim to reformulate how landmarks have conventionally been predicted with neural networks. We propose novel architectures for continuous, unlimited land-mark detection at runtime. In other words, our method al-lows for an arbitrary number of landmarks to be predicted in any layout at inference time without retraining. As such, we propose the ideal landmark detector for multiple appli-cation use. The design of our method is simple, combining an image feature extractor with a queried landmark predic-tor; the latter takes the image descriptor together with a 3D query point relative to a template 3D face surface and pre-dicts the corresponding 2D landmark location in the image.
Since the 3D query points can be arbitrary, the result is con-tinuous and unlimited landmark detection (Fig. 1 (b)). As our approach is modular, we evaluate multiple architecture options for both the feature extractor and the queried pre-dictor, allowing different designs that tradeoff accuracy and runtime. Furthermore, we will show that the query points do not even need to lie on the surface of the template face, allowing to predict 2D landmarks for volumetric features on the skull, jaw, teeth or eyes (Fig. 1 (c) and (d)).
In addition, an important beneﬁt of our design is that we do not need to have training data with a single dedicated number of landmarks in a speciﬁed layout on the face. This means that our architecture can leverage multiple different pre-existing datasets at training time, even if they do not have consistent annotations. This fact, combined with the beauty of specifying any landmark layout at runtime makes our continuous landmark detector powerful, with applica-tions in several areas of face capture including reconstruc-tion, tracking, segmentation (Fig. 1 (e)-(g)) and many oth-ers. As a summary, we can enumerate the main beneﬁts of our new landmark predictor as follows:
• Our method offers the ability to predict any desired landmark on the face at inference time without retrain-ing the network.
• We can track non-standard landmarks like pores, moles or dots drawn on the face without training a spe-ciﬁc predictor.
• Our method is not restricted to the face surface, and al-lows to predict landmarks for volumetric features like the skull, jaw, teeth and eyes.
• The size of the neural network is agnostic to the num-ber of output landmarks. 2.