Abstract
With basic Semi-Supervised Object Detection (SSOD) techniques, one-stage detectors generally obtain limited promotions compared with two-stage clusters. We experi-mentally ﬁnd that the root lies in two kinds of ambiguities: (1) Selection ambiguity that selected pseudo labels are less accurate, since classiﬁcation scores cannot properly rep-resent the localization quality. (2) Assignment ambiguity that samples are matched with improper labels in pseudo-label assignment, as the strategy is misguided by missed objects and inaccurate pseudo boxes. To tackle these prob-lems, we propose a Ambiguity-Resistant Semi-supervised
Learning (ARSL) for one-stage detectors. Speciﬁcally, to alleviate the selection ambiguity, Joint-Conﬁdence Estima-tion (JCE) is proposed to jointly quantiﬁes the classiﬁcation and localization quality of pseudo labels. As for the as-signment ambiguity, Task-Separation Assignment (TSA) is introduced to assign labels based on pixel-level predictions rather than unreliable pseudo boxes. It employs a ’divide-and-conquer’ strategy and separately exploits positives for the classiﬁcation and localization task, which is more ro-bust to the assignment ambiguity. Comprehensive experi-ments demonstrate that ARSL effectively mitigates the am-biguities and achieves state-of-the-art SSOD performance on MS COCO and PASCAL VOC. Codes can be found at https://github.com/PaddlePaddle/PaddleDetection. 1.

Introduction
Abundant data plays an essential role in deep learning based object detection [18, 22, 23], yet labeling a large amount of annotations is labour-consuming and expensive.
To save labeling expenditure, Semi-Supervised Object De-tection (SSOD) attempts to leverage limited labeled data
∗Co-ﬁrst author (Equal Contribution).
†Corresponding author.
This work was done when Chang Liu was an intern at Baidu Inc.
Figure 1. Comparing FCOS, Faster RCNN, and our approach on
COCO train2017. Under the basic SSOD pipeline, FCOS obtains limited improvements compared with Faster RCNN. Our approach consistently promotes FCOS and achieves a state-of-the-art perfor-mance on SSOD. and easily accessible unlabeled data for detection tasks. Ad-vanced SSOD methods [19, 33] follow the Mean-Teacher
[29] paradigm and mainly apply the self-training [11, 32] technique to perform semi-supervised learning. Though this pipeline has successfully promoted two-stage detectors, it is less harmonious with one-stage methods which are also important due to their competitive accuracy and computa-tional efﬁciency. As veriﬁed in Fig. 1, compared with Faster
RCNN [23], FCOS [30] has a comparable supervised per-formance, but achieves a relatively limited improvement un-der the basic semi-supervised pipeline. To ﬁgure out this problem, we analyze the core components of SSOD, e.g., pseudo-label selection and assignment.
With comprehensive investigations in Sec. 3.2, we ﬁnd that there exist selection and assignment ambiguities, hin-dering the semi-supervised learning of one-stage detectors.
The selection ambiguity denotes that the selected pseudo labels for unlabeled images are less accurate. It is caused by the mismatch between classiﬁcation scores and local-ization quality. Speciﬁcally, compared with Faster RCNN,
FCOS has a much smaller Pearson correlation coefﬁcient between classiﬁcation and localization (0.279 vs. 0.439),
Figure 2. An overview of our Ambiguity-Resistant Semi-supervised Learning. Training batch contains both labeled and unlabeled images.
On unlabeled images, the teacher ﬁrst predicts the joint conﬁdence via JCE. Then, TSA assigns and generates the training targets for the student. PPM denotes the potential positive mining in TSA. The overall loss consists of supervised Ls and unsupervised loss Lu. which is adverse to the pseudo-label selection. The reason is that one-stage detectors like FCOS lack RPN [23] and
RoI Pooling/Align [6, 23] to extract accurate object infor-mation for localization quality estimation, meanwhile the predicted centerness of FCOS cannot properly represent the localization quality.
On the other hand, the assignment ambiguity indicates that samples on unlabeled images are assigned with im-proper labels. Our experiments show that 73.5% of posi-tives are wrongly matched with negative labels, and there also exist many false positives. In essence, the assignment strategy converts bounding boxes into pixel-level labels, but neglects the situations that many pseudo boxes are inaccu-rate and plenty of objects are missed due to the threshold ﬁl-tering. It causes the assignment ambiguity which misguides the detector. Compared with two-stage detectors, one-stage detectors which require pixel-level labels, are more sensi-tive to the assignment ambiguity.
Based on these observations and analysis, we pro-pose the Ambiguity-Resistant Semi-supervised Learn-ing (ARSL) for one-stage detectors. To mitigate the se-lection ambiguity, Joint-Conﬁdence Estimation (JCE) is proposed to select high-quality pseudo labels based on the joint quality of classiﬁcation and localization. Speciﬁcally,
JCE employs a double-branch structure to estimate the con-ﬁdence of the two tasks, then combines them to format
In training, the the joint conﬁdence of detection results. two branches are trained together in united supervision to avoid the sub-optimal state. Different from other task-consistent or IoU-estimation methods [5,9,15], JCE explic-itly integrates the classiﬁcation and localization quality, and does not need complicated structures and elaborate learn-ing strategies. Additionally, JCE is more capable of picking high-quality pseudo labels and achieves a better SSOD per-formance, as veriﬁed in Sec. 4.4.
As for the assignment ambiguity, Task-Separation As-signment (TSA) is proposed to assign labels based on pixel-level predictions rather than unreliable pseudo boxes. Con-cretely, based on the predicted joint conﬁdence, TSA parti-tions samples into negatives, positives, and ambiguous can-didates via the statistics-based thresholds. The conﬁdent positives are trained on both classiﬁcation and localization tasks, since they are relatively accurate and reliable. While for the ambiguous candidates, TSA employs a ’divide-and-conquer’ strategy and separately exploits potential posi-tives from them for the classiﬁcation and localization task.
Compared with other dense-guided assignments [12,28,36],
TSA adopts a more rational assignment metric and sepa-rately exploits positives for the two tasks, which can ef-fectively mitigate the assignment ambiguity as proved in
Sec. 4.4. The general structure of ARSL is illustrated in
Fig. 2, and our contributions are summarized as follows:
• Comprehensive experiments are conducted to analyze the semi-supervised learning of one-stage detectors, and reveal that the limitation lies in the selection and assignment ambiguities of pseudo labels.
• JCE is proposed to mitigate the selection ambiguity by jointly quantifying the classiﬁcation and localization quality. To alleviate the assignment ambiguity, TSA separately exploits positives for the classiﬁcation and localization task based on pixel-level predictions.
• ARSL exhibits remarkable improvement over the ba-sic SSOD baseline for one-stage detectors as shown in Fig. 1, and achieves state-of-the-art performance on
MS COCO and PASCAL VOC.
2.