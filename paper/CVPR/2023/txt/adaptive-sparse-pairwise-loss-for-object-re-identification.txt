Abstract
Object re-identification (ReID) aims to find instances with the same identity as the given probe from a large gallery. Pairwise losses play an important role in training a strong ReID network. Existing pairwise losses densely exploit each instance as an anchor and sample its triplets in a mini-batch. This dense sampling mechanism inevitably introduces positive pairs that share few visual similarities, which can be harmful to the training. To address this prob-lem, we propose a novel loss paradigm termed Sparse Pair-wise (SP) loss that only leverages few appropriate pairs for each class in a mini-batch, and empirically demon-strate that it is sufficient for the ReID tasks. Based on the proposed loss framework, we propose an adaptive pos-itive mining strategy that can dynamically adapt to diverse intra-class variations. Extensive experiments show that SP loss and its adaptive variant AdaSP loss outperform other pairwise losses, and achieve state-of-the-art performance across several ReID benchmarks. Code is available at https://github.com/Astaxanthin/AdaSP. 1.

Introduction
Object re-identification (ReID) is one of the most impor-tant vision tasks in visual surveillance. It aims at associat-ing person/vehicle images with the same identity captured by different cameras in diverse scenarios. Recently, with the prosperity of deep neural networks in computer vision community, ReID tasks have rapidly progressed towards more sophisticated feature extractors [8, 37, 40, 44, 60, 61] and more elaborate losses [43, 45, 57, 58]. Benefiting from quantifying the semantic similarity/distance of two images, metric losses are widely employed with the identity loss to improve ranking precision in the ReID task [35].
Generally, metric losses serve for metric learning that aims to map raw signals into a low-dimensional embedding space where instances of intra-class are clustered and that of inter-class are separated. The pairwise framework, such
†Corresponding author.
Figure 1. Difference between dense pairwise losses and our sparse pairwise (SP) loss. For simplicity, only two classes, marked by circles and triangles, are displayed. The red circles represent an-chors. Dense pairwise losses, such as triplet loss [19] and circle loss [45], treat each instance as an anchor and mine its positive and negative pairs to construct a loss item. SP loss treats each class as a unit and separately excavates the most informative positive and negative pairs without using anchors. as triplet loss [19] and circle loss [45], employs anchors to pull their positive pairs while pushing negatives apart. Most existing pairwise losses [14, 19, 38, 45] devote to exploiting all instances in a mini-batch, and densely anchoring each of them (which we term dense pairwise method) to sam-ple its triplets. Although some hard sample mining meth-ods [7, 45, 50, 51] are developed to accelerate convergence or improve performance, these losses are still computed in a dense manner (i.e. top rows in Fig. 1). This dense design in-evitably introduces harmful positive pairs [1, 43] that share few visual similarities and likely lead to bad local minima of optimization [54] for metric learning, due to large intra-class variations (Fig. 2a) caused by illumination changes, occlusion, different viewpoints, etc.
In this work, we anticipate that it is not necessary to em-ploy all instances within a mini-batch since most of them
sharing noticeable visual similarities (Fig. 2a). In addition, to handle classes with diverse intra-class variations (Fig. 2), we develop an adaptive mining approach that automatically reweights these two kinds of positive pairs, which shapes a dynamic intra-class hypersphere according to the particular situation of the class. The main contributions of this paper are summarized as follows:
• We propose a novel pairwise loss framework – Sparse
Pairwise loss – that only leverages few informative positive/negative pairs for each class in a mini-batch.
• We propose a least-hard positive mining strategy to ad-dress large intra-class variations and further endow it with an adaptive mechanism according to different lev-els of intra-class variations in each mini-batch.
• The proposed AdaSP loss is evaluated on various per-son/vehicle ReID datasets and outperforms existing dense pairwise losses across different benchmarks. 2.