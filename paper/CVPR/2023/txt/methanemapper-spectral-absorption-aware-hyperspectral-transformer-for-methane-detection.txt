Abstract
Methane (CH4) is the chief contributor to global cli-mate change. Recent Airborne Visible-Infrared Imaging
Spectrometer-Next Generation (AVIRIS-NG) has been very useful in quantitative mapping of methane emissions. Ex-isting methods for analyzing this data are sensitive to local terrain conditions, often require manual inspection from do-main experts, prone to significant error and hence are not scalable. To address these challenges, we propose a novel end-to-end spectral absorption wavelength aware trans-former network, MethaneMapper, to detect and quantify the emissions. MethaneMapper introduces two novel modules that help to locate the most relevant methane plume regions in the spectral domain and uses them to localize these ac-curately. Thorough evaluation shows that MethaneMapper achieves 0.63 mAP in detection and reduces the model size (by 5×) compared to the current state of the art.
In ad-dition, we also introduce a large-scale dataset of methane plume segmentation mask for over 1200 AVIRIS-NG flight lines from 2015-2022. It contains over 4000 methane plume sites. Our dataset will provide researchers the opportunity to develop and advance new methods for tackling this chal-lenging green-house gas detection problem with significant broader social impact. Dataset and source code link1. 1.

Introduction
We consider the problem of detecting and localizing methane (CH4) plumes from hyperspectral imaging data.
Detecting and localizing potential CH4 hot spots is a nec-essary first step in combating global warming due to green-house gas emissions. Methane gas is estimated to contribute 20% of global warming induced by greenhouse gasses [24] with a Global Warming Potential (GWP) 86 times higher than carbon dioxide (CO2) in a 20 year period [33]. To 1https://github.com/UCSB-VRL/MethaneMapper-Spectral-Absorption-aware-Hyperspectral-Transformer-for-Methane-Detection put into perspective, the amount of environmental damage that CO2 can do in 100 years, CH4 can do in 1.2 years.
Hence it is critical to monitor and curb the CH4 emissions.
While CH4 emission has many sources, of particular inter-est are those from oil and natural gas industries. According to the United States Environmental Protection Agency re-port, CH4 emissions from these industries accounts to 84 million tons per year [18]. These CH4 emissions emanate from specific locations, mainly from pipeline leakages, stor-age tank leak or leakage from oil extraction point.
Current efforts to detect these sources mostly depend on aerial imagery. The Jet Propulsion Laboratory (JPL) has conducted thousands of aerial surveys in the last decade to collect data using an airborne sensor AVIRIS-NG [21]. Sev-eral methods have been proposed to detect potential emis-sion sites from such imagery, for example, see [8, 9, 35, 38, 40, 41]. However, these methods are in general very sensi-tive to background context and land-cover types, resulting in a large number of false positives that often require sig-nificant domain expert time to correct the detections. The primary reason is that these pixel-based methods are solely dependent on spectral correlations for detection. Spatial in-formation can be very effective in reducing these false pos-itives as CH4 plumes exhibit a plume-like structure mor-phology. There has been recent efforts in utilizing spatial correlation using deep learning methods [22, 29], however, these works don’t leverage spectral properties to filter out confusers. For example, methane has similar spectral prop-erties as white-painted commercial roofs or paved surfaces such as airport asphalts [1]. This paper presents a novel deep-network based solution to minimize the effects of such confusers in accurately localizing methane plumes.
Our proposed approach, referred to as the MethaneMap-per (MM), adapts the DETR [4], a transformer model that combines the spectral and spatial correlations in the imag-ing data to generate a map of potential methane (CH4) plume candidates. These candidates reduce the search space for a hyperspectral decoder to detect CH4 plumes and re-move potential confusers. MM is a light-weight end-to-end single-stage CH4 detector and introduces two novel mod-ules: a Spectral Feature Generator and a Query Refiner.
The former generates spectral features from a linear filter that maximizes the CH4-to-noise ratio in the presence of additive background noise, while the latter integrates these features for decoding.
A major bottle neck for development of CH4 detection methods is the limited availability of public training data.
To address this, another significant contribution of this re-search is the introduction of a new Methane Hot Spots (MHS) dataset, largest of its kind available for computer vi-sion researchers. MHS is curated by systematically collect-ing information from different publicly available datasets (airborne sensor [6], Non-profits [3, 31] and satellites [34]) and generating the annotations as described in Section 4.1.1.
This curated dataset contains methane segmentation masks for over 1200 AVIRIS-NG flight lines from years 2015 to 2022. Each flight line contains anywhere from 3-4 CH4 plume sites for a total of 4000 in the MHS dataset.
Our contributions can be summarized as follows: 1. We introduce a novel single-stage end-to-end approach for methane plume detection using a hyperspectral transformer. The two modules, Spectral Feature Gen-erator and Query Refiner, work together to improve upon the traditional transformer design and enable lo-calization of potential methane hot spots in the hyper-spectral images using a Spectral-Aware Linear Filter and refine the query representation for better decoding. 2. A new Spectral Linear Filter (SLF) improves upon tra-ditional linear filters by strategically picking correlated pixels in spectal domain to better whiten background distribution and amplify methane signal. 3. A new benchmark dataset, MHS, provides the largest (∼ 35×) publicly available dataset of annotated
AVIRIS-NG flight lines from years 2015-2022. 2.