Abstract
Low-light Image Enhancement (LIE) aims at improving contrast and restoring details for images captured in low-light conditions. Most of the previous LIE algorithms ad-just illumination using a single input image with several handcrafted priors. Those solutions, however, often fail in revealing image details due to the limited information in a single image and the poor adaptability of handcrafted priors. To this end, we propose PairLIE, an unsupervised approach that learns adaptive priors from low-light im-age pairs. First, the network is expected to generate the same clean images as the two inputs share the same im-age content. To achieve this, we impose the network with the Retinex theory and make the two reflectance compo-nents consistent. Second, to assist the Retinex decompo-sition, we propose to remove inappropriate features in the raw image with a simple self-supervised mechanism. Ex-tensive experiments on public datasets show that the pro-posed PairLIE achieves comparable performance against the state-of-the-art approaches with a simpler network and fewer handcrafted priors. Code is available at: https:
//github.com/zhenqifu/PairLIE. 1.

Introduction
Images captured under low-light environments always suffer from multiple distortions, such as low contrast, poor visibility, and sensor noise. Those low-light images are un-satisfactory for information transmission because they incur challenges in human visualization and subsequent computer vision tasks [25]. To correct contrast, uncover textures, and remove sensor noise, great efforts have been made in devel-oping Low-light Image Enhancement (LIE) algorithms in the past decades [1, 5, 6, 8, 28, 35].
*Corresponding author.
Figure 1. Comparison between the previous solution (a) and the proposed method (b) from the aspect of Retinex theory. The key idea of our method is to learn adaptive priors from low-light image pairs. As a result, our solution needs fewer handcrafted priors and the network is more robust. Note that image pairs are only used in the training phase.
Histogram-based and Retinex-based approaches are two well-known LIE techniques. The former enhances the con-trast of an image by redistributing the luminous intensity on the histogram [3, 14]. The latter decomposes an observed image I into illumination L and reflectance R via I = L◦R, where ◦ denotes the element-wise multiplication [6, 13, 17].
Specifically, the reflectance component R is assumed to be consistent under different light conditions because R repre-sents the physical properties of the objects. As the Retinex theory can well model color perceptions of human vision,
Retinex-based methods have attracted relatively more atten-tion in the LIE community.
Recent years have witnessed great success in developing learning-based LIE algorithms. Among these approaches, most solutions rely on low-light and normal-light image
pairs [33, 38]. However, collecting high-quality reference maps in real-world scenarios is time-consuming and expen-sive [32]. To eliminate the requirement for normal-light im-ages, unsupervised and zero-shot LIE approaches are pro-posed. Concretely, the former trains a deep neural network using a set of collected low-light samples [7, 18], while the latter only employs the test image itself in the network op-timization [40, 41]. Due to the absence of reference im-ages, unsupervised and zero-shot LIE approaches depend on handcrafted priors to guide network training. Neverthe-less, due to the complex natural scenes and the limited in-formation in a single low-light image, it is difficult for those methods to attain a high-quality result.
To tackle the issues of limited information in a single low-light image and the poor adaptability of handcrafted priors, we propose to leverage paired low-light instances to train the LIE network. The main difference between our so-lution and previous approaches is illustrated in Fig. 1. Note that acquiring paired low-light images will complicate the imaging process since it needs to cope with the misalign-ment between the two images. Nevertheless, compared with collecting low-light and normal-light image pairs, our solu-tion is more practical. Additionally, twice-exposure images provide useful information for solving the LIE task. As a result, our solution can reduce the demand for handcrafted priors and improve the adaptability of the network.
With paired low-light instances, we propose a novel learning-based LIE method, termed PairLIE. The core in-sight of our approach is to sufficiently exploit priors from paired low-light images. Therefore, we consider employing the Retinex theory and deep learning to decompose low-light images into illumination and reflectance components.
First, since the two low-light inputs share the same content, the estimated reflectance components are expected to be consistent. Second, instead of directly imposing the Retinex decomposition on original low-light images, we adopt a simple self-supervised mechanism to remove inappropriate features and implement the Retinex decomposition on the optimized image. This can avoid sub-optimal estimations because the Retinex model has limitations in low-light mod-eling. As a result, with fewer prior constraints and a simpler network, the proposed PairLIE achieves competitive perfor-mance in public LIE datasets. In summary, the contributions of this paper are as follows:
• We propose a generic LIE solution using paired low-light images. The network is based on Retinex decom-position with several novel reference-free losses.
• To achieve an accurate decomposition, we first project the original image to remove inappropriate features.
• With fewer manually designed priors and a simpler network, the proposed solution achieves comparable performance against state-of-the-art methods. 2.