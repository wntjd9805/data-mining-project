Abstract
Labeling objects with pixel-wise segmentation requires a huge amount of human labor compared to bounding boxes.
Most existing methods for weakly supervised instance seg-mentation focus on designing heuristic losses with priors from bounding boxes. While, we find that box-supervised methods can produce some fine segmentation masks and we wonder whether the detectors could learn from these fine masks while ignoring low-quality masks. To answer this question, we present BoxTeacher, an efficient and end-to-end training framework for high-performance weakly su-pervised instance segmentation, which leverages a sophis-ticated teacher to generate high-quality masks as pseudo labels. Considering the massive noisy masks hurt the train-ing, we present a mask-aware confidence score to esti-mate the quality of pseudo masks, and propose the noise-aware pixel loss and noise-reduced affinity loss to adap-tively optimize the student with pseudo masks. Extensive experiments can demonstrate effectiveness of the proposed
BoxTeacher. Without bells and whistles, BoxTeacher re-markably achieves 35.0 mask AP and 36.5 mask AP with
ResNet-50 and ResNet-101 respectively on the challenging
COCO dataset, which outperforms the previous state-of-the-art methods by a significant margin and bridges the gap between box-supervised and mask-supervised methods. 1.

Introduction
Instance segmentation, aiming at recognizing and seg-menting objects in images, is a fairly challenging task in computer vision. Fortunately, the rapid development of object detection methods [7, 40, 50] has greatly advanced the emergence of numbers of successful methods [5, 6, 23, 49, 54, 55] for effective and efficient instance segmenta-⋆ This work was done when Tianheng Cheng and Shaoyu Chen were interns at Horizon Robotics. † Wenyu Liu is the corresponding author: liuwy@hust.edu.cn (a) Segmentation Masks from BoxInst. BoxInst
Figure 1. (ResNet-50 [24]) can produce some fine segmentation masks with (b) Self-weak supervisions from bounding boxes and images.
Training with Pseudo Masks on COCO val. We explore the self-training to train a CondInst [49] with the pseudo labels gener-ated by BoxInst. However, the improvements are limited tion. With the fine-grained human annotations, recent in-stance segmentation methods can achieve impressive re-sults on challenging the COCO dataset [34]. Nevertheless, labeling instance-level segmentation is much complicated and time-consuming, e.g., labeling an object with polygon-based masks requires 10.3× more time than that with a 4-point bounding box [11].
Recently, a few works [25,31–33,51,53] explore weakly supervised instance segmentation with box annotations or low-level colors. These weakly supervised methods can ef-fectively train instance segmentation methods [23, 49, 55] without pixel-wise or polygon-based annotations and ob-tain fine segmentation masks. As shown in Fig. 1(a), Box-Inst [51] can output a few high-quality segmentation masks and segment well on the object boundary, e.g., the person, even performs better than the ground-truth mask in details though other objects may be badly segmented. Naturally, we wonder if the generated masks of box-supervised meth-ods, especially the high-quality masks, could be qualified as pseudo segmentation labels to further improve the per-formance of weakly supervised instance segmentation.
To answer this question, we first employ the naive
self-training to evaluate the performance of using box-supervised pseudo masks. Given the generated instance masks from BoxInst, we propose a simple yet effective box-based pseudo mask assignment to assign pseudo masks to ground-truth boxes. And then we train the CondInst [49] with the pseudo masks, which has the same architecture with BoxInst and consists of a detector [50] and a dynamic mask head. Fig. 1(b) shows that using self-training brings minor improvements and fails to unleash the power of high-quality pseudo masks, which can be attributed to two obsta-cles, i.e., (1) the naive self-training fails to filter low-quality masks, and (2) the noisy pseudo masks hurt the training using fully-supervised pixel-wise loss. Besides, the multi-stage self-training is inefficient.
To address these problems, we present BoxTeacher, an end-to-end training framework, which takes advantage of high-quality pseudo masks produced by box supervision.
BoxTeacher is composed of a sophisticated Teacher and a perturbed Student, in which the teacher generates high-quality pseudo instance masks along with the mask-aware confidence scores to estimate the quality of masks. Then the proposed box-based pseudo mask assignment will assign the pseudo masks to the ground-truth boxes. The student is normally optimized with the ground-truth boxes and pseudo masks through box-based loss and noise-aware pseudo mask loss, and then progressively updates the teacher via
Exponential Moving Average (EMA). In contrast to the naive multi-stage self-training, BoxTeacher is more simple and efficient. The proposed mask-aware confidence score effectively reduces the impact of low-quality masks. More importantly, pseudo labeling can mutually improve the stu-dent and further enforce the teacher to generate higher-quality masks, hence pushing the limits of the box supervi-sion. BoxTeacher can serve as a general training paradigm and is agnostic to the methods for instance segmentation.
To benchmark the proposed BoxTeacher, we adopt
CondInst [49] as the basic segmentation method. On the challenging COCO dataset [34], BoxTeacher surprisingly achieves 35.0 and 36.5 mask AP based on ResNet-50 [24] and ResNet-101 respectively, which remarkably outper-forms the counterparts. We provide extensive experiments on PASCAL VOC and Cityscapes to demonstrate its ef-fectiveness and generalization ability. Furthermore, Box-Teacher with Swin Transformer [37] obtains 40.6 mask AP as a weakly approach for instance segmentation.
Overall, the contribution can be summarized as follows:
• We solve the box-supervised instance segmentation problem from a new perspective, i.e., self-training with pseudo masks, and illustrate its effectiveness.
• We present BoxTeacher, a simple yet effective frame-work, which leverages pseudo masks with the mask-aware confidence score and noise-aware pseudo masks loss. Besides, we propose a pseudo mask assignment to assign pseudo masks to ground-truth boxes.
• We improve the weakly supervised instance segmenta-tion by large margins and bridge the gap between box-supervised and mask-supervised methods, e.g., Box-Teacher achieves 36.5 mask AP on COCO compared to 39.1 AP obtained by CondInst. 2.