Abstract
Single-image super-resolution (SISR) networks trained with perceptual and adversarial losses provide high-contrast outputs compared to those of networks trained with distortion-oriented losses, such as L1 or L2. However, it has been shown that using a single perceptual loss is in-sufficient for accurately restoring locally varying diverse shapes in images, often generating undesirable artifacts or unnatural details. For this reason, combinations of vari-ous losses, such as perceptual, adversarial, and distortion losses, have been attempted, yet it remains challenging to find optimal combinations. Hence, in this paper, we pro-pose a new SISR framework that applies optimal objectives for each region to generate plausible results in overall areas of high-resolution outputs. Specifically, the framework com-prises two models: a predictive model that infers an optimal objective map for a given low-resolution (LR) input and a generative model that applies a target objective map to pro-duce the corresponding SR output. The generative model is trained over our proposed objective trajectory representing a set of essential objectives, which enables the single net-work to learn various SR results corresponding to combined losses on the trajectory. The predictive model is trained us-ing pairs of LR images and corresponding optimal objective maps searched from the objective trajectory. Experimental results on five benchmarks show that the proposed method outperforms state-of-the-art perception-driven SR methods in LPIPS, DISTS, PSNR, and SSIM metrics. The visual results also demonstrate the superiority of our method in perception-oriented reconstruction. The code is available at https://github.com/seungho-snu/SROOE. 1.

Introduction
The purpose of single image super-resolution (SISR) is to estimate a high-resolution (HR) image corresponding to a given low-resolution (LR) input. SISR has many applica-img 012 (Urban100)
HR (PSNR↑ / LPIPS↓)
SRGAN [23] (21.06 / 0.1521)
ESRGAN [46] (20.80 / 0.1182)
OOE Map
SROOE (Ours) (21.71 / 0.1030)
RankSRGAN [53] (21.05 / 0.1462)
SPSR [31] (21.27 / 0.1241)
Figure 1.
The pro-Visual and quantitative comparison. posed SROOE shows a higher PSNR, LR-PSNR [28] and lower
LPIPS [52] than other state-of-the-art methods, i.e., lower distor-tion and higher perceptual quality. tions, mainly as a pre-processing step of computer vision or image analysis tasks, such as medical [13, 34, 51], surveil-lance [11, 43], and satellite image analysis [30, 41]. How-ever, SISR is an ill-posed problem in that infinitely many
HR images correspond to a single LR image. Recently, the performance of SISR has been greatly improved by adopt-ing deep neural networks [7, 8, 15, 18, 21, 22, 26, 42, 54, 55].
Pixel-wise distortion-oriented losses (L1 and L2) were widely used in early research, which helped to obtain a high signal-to-noise ratio (PSNR). However, these losses lead the model to generate an average of possible HR solutions, which are usually blurry and thus visually not pleasing.
Subsequently, perception-oriented losses, such as per-ceptual loss [19] and generative adversarial loss [12], were
introduced to overcome this problem and produce realistic images with fine details [23]. Although these perception-oriented losses are used for various SR methods [38,46,50], they also bring undesirable side effects such as unnatural details and structural distortions. To alleviate these side ef-fects and improve perceptual quality, various methods, such as the ones employing specially designed losses [40,53] and conditional methods utilizing prior information and addi-tional network branches
[31, 44], have been introduced.
Meanwhile, different from the conventional SR methods, which optimize a single objective, some studies tried to ap-ply multiple objectives to generate more accurate HR out-puts. However, some of them [35, 45, 46] applied image-specific objectives without consideration for the regional characteristics, and the other [36] used region-specific ob-jectives for the regions obtained using semantic image seg-mentation with a limited number of pre-defined classes.
In this paper, we propose a new SR framework that finds a locally optimal combination of a set of objectives in the continuous sample space, resulting in regionally optimized
HR reconstruction. The upper part of Fig. 1 shows a vi-sual comparison of our results with those of state-of-the-art perception-oriented methods. We can see that our SR method using optimal objective estimation (OOE), called
SROOE, generates more accurate structures. The lower part of Fig. 1 shows that the SROOE is located on the far right and bottom, corresponding to the position where both
PSNR and LPIPS [52] are desirable.
For this purpose, our SR framework consists of two mod-els: a predictive model that infers the most appropriate ob-jectives for a given input, and a generative model that ap-plies locally varying objectives to generate the correspond-ing SR result. The main challenge is to train a single gen-erator to learn continuously varying objectives over the dif-ferent locations. For this, the objective is defined as the weighted sum of several losses, and we train the generator with various sets of weights. Meanwhile, the predictor is to estimate appropriate weights for a given image input.
For efficient training, we do not learn over the entire ob-jective space spanned by the weight vector, but find a set of several objectives that have high impacts on optimiza-tion at each vision level and are close to each other in the objective space. This is because proximity between objec-tives improves the efficiency of learning and increases the similarity of their results, which helps reduce side effects.
In addition, we train the generative model on a set of ob-jectives on our defined trajectory, which is formed by con-necting the selected objectives such that the trajectory starts with an objective suitable for a low-vision level and pro-gresses through objectives suitable for higher levels. This enables us to replace high-dimensional weight vector ma-nipulation with simple one-dimensional trajectory tracking, thereby simplifying the training process. The predictive model is trained using a dataset with pairs of LR images and corresponding optimal objective maps. We obtain these optimal training maps by using a grid search on the genera-tor’s objective trajectory.
Regarding the network structure, we employ spatial fea-ture transform (SFT) layers [44] in the generator to flexibly change the network’s behavior according to the objective.
Our flexible model trained in this way has three advantages.
First, the generalization capability to diversely structured images is improved since the network learns various cases.
Second, the SR results are consistent with respect to the tra-jectory and given input. Third, the high-dimensional weight vector for loss terms can be replaced with a vector func-tion with a one-dimensional input, and thus the optimal loss combinations can be easily found and controlled.
Our contributions are summarized as follows. (1) We propose an SISR framework that estimates and applies an optimal combination of objectives for each input region and thus produces perceptually accurate SR results. (2)
While this approach requires training with various weighted combinations of losses, which needs the search on a high-dimensional weight vector space, we introduce an efficient method for exploring and selecting objectives by defining the objective trajectory controlled by a one-dimensional variable. (3) We propose a method for obtaining optimal objective maps over the trajectory, which are then used to train the objective estimator. (4) Experiments show that our method provides both high PSNR and low LPIPS, which has been considered a trade-off relation. 2.