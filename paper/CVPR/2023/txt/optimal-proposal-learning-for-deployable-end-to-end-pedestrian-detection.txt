Abstract
End-to-end pedestrian detection focuses on training a pedestrian detection model via discarding the Non-Maximum Suppression (NMS) post-processing. Though a few methods have been explored, most of them still suffer from longer training time and more complex deployment, which cannot be deployed in the actual industrial applica-tions. In this paper, we intend to bridge this gap and pro-pose an Optimal Proposal Learning (OPL) framework for deployable end-to-end pedestrian detection. Specifically, we achieve this goal by using CNN-based light detector and introducing two novel modules, including a Coarse-to-Fine (C2F) learning strategy for proposing precise positive pro-posals for the Ground-Truth (GT) instances by reducing the ambiguity of sample assignment/output in training/testing respectively, and a Completed Proposal Network (CPN) for producing extra information compensation to further recall the hard pedestrian samples. Extensive experiments are conducted on CrowdHuman, TJU-Ped and Caltech, and the results show that our proposed OPL method significantly outperforms the competing methods. 1.

Introduction
Pedestrian detection is a popular computer vision task, which has been widely employed in many applications such as robotics [20], intelligent surveillance [39] and au-tonomous driving [21]. It follows the conventional object detection pipeline and focuses on the detection of pedes-trian. To improve the recall of pedestrians, the current popu-lar pedestrian detectors always generate multiple bounding-box (bbox) proposals for a Ground-Truth (GT) instance during testing. And then the Non-Maximum Suppression (NMS) post-processing technique is used to guarantee the final precision of detection by removing the duplicated bboxes.
However, the crowd density is usually high in some real-world pedestrian detection scenarios, e.g. city centers, rail-way stations, airports and so on. NMS often performs poorly in these crowd scenes due to the naive duplicate re-moval of NMS by a single Intersection-over-Union (IoU) threshold. For example, a lower threshold may cause the missed detection of some highly overlapped true positives while a higher threshold could result in more false positives.
Some existing works have attempted to make some im-provements, e.g. generating more compact bounding boxes
[62, 68], soft suppression strategy [1], learning NMS func-tion by extra modules [25] and dynamic suppression thresh-old [33]. However, these works still cannot achieve end-to-end training and easy deployment in actual industrial ap-plications. To this end, a straightforward solution is to es-tablish a fully end-to-end detection pipeline by discarding
NMS. PED [30] and [71] have made some attempts by im-plementing a NMS-free pipeline for pedestrian detection.
Both of them are query-based methods. Though achiev-ing higher performances, they still suffer from longer train-ing time, more complex deployment and larger computation costs and cannot be actually deployed on the resource lim-ited devices in industrial applications. Therefore, obtaining a ‘light and sweet’ end-to-end pedestrian detector remains important.
Considering the possibility of deployment in actual in-dustrial applications, performing NMS-free technique upon the one-stage anchor-free CNN-detector, e.g. FCOS [60], is more practical and attractive since it is much easier and ef-ficient to be deployed on resource limited devices with light computational cost and less pre/post-processing. To achieve this goal, the CNN-detector should learn to adaptively and precisely produce true-positive pedestrian proposals at the correct locations as well as avoiding the duplicates. In gen-eral object detection, some works [53, 55, 61] propose to replace the commonly used one-to-many label assignment strategy with one-to-one label assignment during training.
Specifically, for each GT instance, only one proposal will be assigned as positive sample while other candidate pro-posals are assigned as negatives.
However, this solution involves two challenges as fol-lows: 1) Problem of ambiguous positive proposals for a
larger instance. Specifically, the ideal produced positive proposal should get a much higher confidence score than other near-by candidate proposals for the same GT instance.
However, in fact, the extracted features of close-by propos-als are similar since they usually share some common pix-els of the same instance. It is difficult for the classification branch to find a compact classification decision-boundary to separate them apart. As a result, it confounds the further model optimization and reduces the precision of the output proposals; 2) Poor representation ability for tiny and oc-cluded instances. Specifically, various scales and occlusion patterns of pedestrians involve a wide range of appearance changes. It is difficult to guarantee the confidence outputs from different appearances to be consistent with each other.
Hard pedestrian samples with small scales or in heavy oc-clusion states are difficult to attain high confidence scores as those easy samples. Moreover, one-to-one label assignment only provides fewer positive training samples for learning these hard instances, further increasing the learning diffi-culty.
To tackle these issues, this paper proposes the Optimal
Proposal Learning (OPL) framework for deployable end-to-end pedestrian detection. In OPL, we establish the over-all framework upon CNN-based detector and then propose a Coarse-to-Fine (C2F) learning strategy for the classifica-tion branch so as to mitigate the issue of ambiguous positive proposals. Specifically, it is mainly achieved by progres-sively decreasing the average number of the positive sam-ples assigned to each GT instances. C2F gives the classifi-cation branch chances of exploring the best classification decision-boundary via progressive boundary refinements.
Moreover, to ease the problem of poor representation abil-ity for hard instances, we propose a Completed Proposal
Network (CPN). CPN is used to provide extra information compensation for the hard proposals and to give them more chances to be detected. Thus, we can get the reliable confi-dence scores for each proposal by combining the outputs of classification branch and CPN. The main contributions are summarized as follows:
• We propose Optimal Proposal Learning (OPL) frame-work for deployable end-to-end pedestrian detection.
• We design a Coarse-to-Fine (C2F) learning strategy, which progressively decreases the average number of positive samples assigned to each GT instance during training. C2F aims to give model chances of adaptively producing the precise positive samples without ambi-guity.
• We propose a Completed Proposal Network (CPN) that can automatically provide extra compensation for the hard samples with different appearances. CPN is mainly used to further refine the proposal scores such that all pedestrians can be successfully recalled.
Extensive experiments conducted on CrowdHuman [49],
TJU-Ped [45] and Caltech [16] demonstrate the superiority of the proposed OPL. 2.