Abstract 1.

Introduction
Learning-based outlier (mismatched correspondence) rejection for robust 3D registration generally formulates the outlier removal as an inlier/outlier classification prob-lem. The core for this to be successful is to learn the dis-criminative inlier/outlier feature representations.
In this paper, we develop a novel variational non-local network-based outlier rejection framework for robust alignment. By reformulating the non-local feature learning with varia-tional Bayesian inference, the Bayesian-driven long-range dependencies can be modeled to aggregate discriminative geometric context information for inlier/outlier distinction.
Specifically, to achieve such Bayesian-driven contextual de-pendencies, each query/key/value component in our non-local network predicts a prior feature distribution and a posterior one. Embedded with the inlier/outlier label, the posterior feature distribution is label-dependent and dis-criminative. Thus, pushing the prior to be close to the dis-criminative posterior in the training step enables the fea-tures sampled from this prior at test time to model high-quality long-range dependencies. Notably, to achieve ef-fective posterior feature guidance, a specific probabilis-tic graphical model is designed over our non-local model, which lets us derive a variational low bound as our op-timization objective for model training. Finally, we pro-pose a voting-based inlier searching strategy to cluster the high-quality hypothetical inliers for transformation estima-tion. Extensive experiments on 3DMatch, 3DLoMatch, and
KITTI datasets verify the effectiveness of our method. Code is available at https://github.com/Jiang-HB/VBReg.
∗Corresponding authors
Haobo Jiang, Jin Xie, and Jian Yang are with PCA Lab, Key Lab of
Intelligent Perception and Systems for High-Dimensional Information of
Ministry of Education, and Jiangsu Key Lab of Image and Video Under-standing for Social Security, School of Computer Science and Engineering,
Nanjing University of Science and Technology, China.
Point cloud registration is a fundamental but challenging 3D computer vision task, with many potential applications such as 3D scene reconstruction [1, 39], object pose estima-tion [13, 44], and Lidar SLAM [15, 51]. It aims to align two partially overlapping point clouds by estimating their relative rigid transformation, i.e., 3D rotation and 3D trans-lation. A popular approach to address the large-scale scene registration problem consists of extracting point descrip-tors [11,14,17,37,38,50] and establishing correspondences between the two point clouds, from which the transforma-tion can be obtained geometrically. In this context, much effort has been dedicated to designing traditional and deep learning-based descriptors [3, 11, 21, 41, 50]. However, the resulting correspondences inevitably still suffer from out-liers (wrong matchings), particularly in challenging cases, such as low-overlap, repetitive structures, or noisy point sets, leading to registration failure.
To address this, many outlier filtering strategies have been developed to robustify the registration process. These include traditional rejection methods using random sample consensus [16], point-wise descriptor similarity [7, 32] or group-wise spatial consistency [46]. Deep learning meth-ods have also been proposed, focusing on learning corre-spondence features used to estimate inlier confidence val-In particular, the current state-of-the-art ues [2, 10, 33]. method, PointDSC [2], relies on a spatial consistency-driven non-local network to capture long-range context in its learned correspondence features. While effective,
PointDSC still yields limited registration robustness, par-ticularly for scenes with a high outlier ratio, where the spa-tial consistency constraints may become ambiguous [36], thereby degrading the correspondence features’ quality.
In this paper, we propose to explicitly account for the ambiguities arising from high outlier ratios by developing a probabilistic feature learning framework. To this end, we introduce a variational non-local network based on an at-tention mechanism to learn discriminative inlier/outlier fea-ture representations for robust outlier rejection. Specifi-cally, to capture the ambiguous nature of long-range con-textual dependencies, we inject a random feature in each query, key, and value component in our non-local network.
The prior/posterior distributions of such random features are predicted by prior/posterior encoders. To encourage the resulting features to be discriminative, we make the pos-terior feature distribution label-dependent. During train-ing, we then push the prior distribution close to the label-dependent posterior, thus allowing the prior encoder to also learn discriminative query, key, and value features. This enables the features sampled from this prior at test time to model high-quality long-range dependencies.
To achieve effective variational inference, we customize a probabilistic graphical model over our variational non-local network to characterize the conditional dependencies of the random features. This lets us derive a variational lower bound as the optimization objective for network train-ing. Finally, we propose a voting-based deterministic inlier searching mechanism for transformation estimation, where the correspondence features learned from all non-local iter-ations jointly vote for high-confidence hypothetical inliers for SVD-based transformation estimation. We theoretically analyze the robustness of our deterministic inlier searching strategy compared to RANSAC, which also motivates us to design a conservative seed selection mechanism to improve robustness in sparse point clouds.
To summarize, our contributions are as follows:
• We propose a novel variational non-local network for outlier rejection, learning discriminative correspon-dence features with Bayesian-driven long-range con-textual dependencies.
• We customize the probabilistic graphical model over our variational non-local network and derive the varia-tional low bound for effective model optimization.
• We introduce a Wilson score-based voting mechanism to search high-quality hypothetical inliers, and theo-retically demonstrate its superiority over RANSAC.
Our experimental results on extensive benchmark datasets demonstrate that our framework outperforms the state-of-the-art registration methods. 2.