Abstract
Predicting the future trajectories of the traffic agents is a gordian technique in autonomous driving. However, tra-jectory prediction suffers from data imbalance in the preva-lent datasets, and the tailed data is often more complicated and safety-critical. In this paper, we focus on dealing with the long-tail phenomenon in trajectory prediction. Previ-ous methods dealing with long-tail data did not take into account the variety of motion patterns in the tailed data.
In this paper, we put forward a future enhanced contrastive learning framework to recognize tail trajectory patterns and form a feature space with separate pattern clusters. Fur-thermore, a distribution aware hyper predictor is brought up to better utilize the shaped feature space. Our method is a model-agnostic framework and can be plugged into many well-known baselines. Experimental results show that our framework outperforms the state-of-the-art long-tail pre-diction method on tailed samples by 9.5% on ADE and 8.5% on FDE, while maintaining or slightly improving the aver-aged performance. Our method also surpasses many long-tail techniques on trajectory prediction task. 1.

Introduction
Trajectory prediction is of great importance in au-tonomous driving scenarios [27]. It aims to predict a series of future positions for the agents on the road given the ob-served past tracks. There have been many recent methods in trajectory prediction, both unimodal [1, 48] and multi-modal [10, 37, 38, 49].
Despite the high accuracy those prediction methods have achieved, most of them treat the samples in the datasets equally in both training and evaluation phases. But there is a long-tailed phenomenon in prevalent datasets [28]. For
*Equal contributions.
†Corresponding author.
Figure 1. The long-tailed final displacement errors of the state-of-the-art prediction network: Trajectron++ EWTA [28] on ETH-UCY. The long-tail part of the dataset contains various compli-cated motion patterns, and predicting them is challenging. example, in real traffic scenes, most of the trajectories fol-low certain simple kinematic rules, while deviating and collision-avoiding circumstances are scarce. Therefore, the frequent cases are often simple and easy to predict, while the tail cases are often complicated with many motion pat-terns and suffer from large prediction errors, which makes them more safety-critical, as shown in Fig. 1 for the univ dataset. Despite of its significance, the long-tail prediction problem have been rarely discussed in literature.
It has been pointed out that the feature encoders largely suffer from long-tail data. In the training process, the head samples are encountered more often and dominate the la-tent space, while the tailed samples will be modeled insuf-ficiently, as discussed in [24, 28, 39]. Feature embeddings of the tailed data can even be mixed up with the ones of the head data as discussed in [28], therefore the performances of the tailed samples could be harmed.
In this paper, we pick up the general idea of using con-trastive learning to enhance the model ability on long-tailed data. A new framework is developed called FEND: Future
ENhanced Distribution-aware contrastive trajectory predic-tion, which is a pattern-based contrastive feature learning framework enhanced by future trajectory information. An offline trajectory clustering process and prototypical con-trastive learning are introduced for recognizing and sepa-rating different trajectory patterns to boost the tail samples modeling. To deal with the afore mentioned problem, the features of trajectories within the same pattern cluster are pulled together, while the features from different pattern clusters will be pushed apart. Moreover, a more flexible network structure of the decoder is introduced to exploit the shaped feature embedding space with different pattern clus-ters. Our contribution can be summarized as follows:
• We propose a future enhanced contrastive feature learning framework for long-tailed trajectory predic-tion, which can better distinguish tail patterns from head patterns, and the different patterns are repre-sented by different cluster prototypes to enhance the modeling of the tailed data.
• We propose a distribution-aware hyper predictor, aim-ing at providing separated decoder parameters for tra-jectory inputs with different patterns.
• Experimental results show that our proposed frame-work can outperform start-of-the-art methods. 2.