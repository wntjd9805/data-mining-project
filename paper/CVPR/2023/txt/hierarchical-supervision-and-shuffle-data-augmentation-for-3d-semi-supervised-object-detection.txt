Abstract
State-of-the-art 3D object detectors are usually trained on large-scale datasets with high-quality 3D annotations.
However, such 3D annotations are often expensive and time-consuming, which may not be practical for real ap-plications. A natural remedy is to adopt semi-supervised learning (SSL) by leveraging a limited amount of labeled samples and abundant unlabeled samples. Current pseudo-labeling-based SSL object detection methods mainly adopt a teacher-student framework, with a single ﬁxed threshold strategy to generate supervision signals, which inevitably brings confused supervision when guiding the student net-work training. Besides, the data augmentation of the point cloud in the typical teacher-student framework is too weak, and only contains basic down sampling and ﬂip-and-shift (i.e., rotate and scaling), which hinders the effective learn-ing of feature information. Hence, we address these is-sues by introducing a novel approach of Hierarchical Su-pervision and Shufﬂe Data Augmentation (HSSDA), which is a simple yet effective teacher-student framework. The teacher network generates more reasonable supervision for the student network by designing a dynamic dual-threshold strategy. Besides, the shufﬂe data augmentation strategy is designed to strengthen the feature representation ability of the student network. Extensive experiments show that
HSSDA consistently outperforms the recent state-of-the-art methods on different datasets. The code will be released at https://github.com/azhuantou/HSSDA. 1.

Introduction
Kinds of important applications, especially autonomous driving, have been motivating the rapid development of 3D
*Corresponding author.
Full labeled scene
RGB Image
Unlabeled scene
Unlabeled scene
Unlabeled scene
Unlabeled scene
Flip&Shift
Split&Shuffle
Teacher Network
Teacher Network
High threshold
OR
Low threshold
Dual-threshold  strategy
Pseudo-labeling scene
Vanilla Teacher
Pseudo-labeling scene
Ours Teacher
Augmented scene
Augmented scene
Student
Network
Student
Network
Vanilla Student
Ours Student (a) (b)
Figure 1. Illustration of (a) the previous teacher compared to our teacher framework and (b) the previous student compared to our student framework. The black dashed box includes the RGB im-age and the corresponding fully annotated 3D point cloud (green box). The left side of the yellow dotted line in (a) represents the pseudo-labeling scene generated by the single threshold of the vanilla teacher network, causing the student network may be severely misled due to missing mined objects (high threshold) or false positive objects (low threshold), while our proposed teacher network generates three groups of pseudo labels(shown as green, red, blue) to provide hierarchical supervision for the student net-work. (b) shows our student network adopts stronger shufﬂed data augmentation than the vanilla student network to learn the stronger ability of feature representation. object detection by the range sensor data (e.g., LiDAR point cloud). Up to now, many point-based and point-voxel-based methods [10,30,31,49] have been proposed. Despite the im-pressive progress, a large amount of accurate instance-level 3D annotations have to be provided for training, which is more time-consuming and expensive than 2D object annota-tion. This hinders the application and deployment of exist-ing advanced detection models. To this end, how to reduce the dependence on huge annotated datasets has achieved growing interest in the object detection community.
As one of the important machine learning schemes for reducing data annotation, semi-supervised learning (SSL) aims to improve the generalization ability of model train-ing with a small number of labeled data together with large-scale unlabeled samples. In the semi-supervised ob-ject detection community, most works focus on 2D object detection [13, 17, 34, 40, 43], among which the teacher-student model is the mainstream framework. Speciﬁcally, the teacher network with weakly augmented labeled data generates pseudo labels to train the student network with strong data augmentation. This pipeline has been widely veriﬁed to be effective, in which the quality of pseudo labels and the data augmentation strategy are the key and many works have been proposed to tackle them [2,6,33,34]. Ben-eﬁting from 2D semi-supervised object detection, several 3D semi-supervised object detection methods have been proposed [23, 39, 47, 52], which still mainly adopted the teacher-student model. These methods, as well as 2D semi-supervised object detection methods [21,34,55], mainly use a hard way, e.g., a score threshold, to get pseudo labels to train the student network. This kind of strategy is difﬁcult to guarantee the quality of pseudo labels. Taking the score threshold strategy as an example, if the threshold is too low, the pseudo labels will contain many false objects, while if it is too high, the pseudo labels will miss many real ob-jects which will be improperly used as background (see in
Fig. 1 (a)). As exhibited in [39], only about 30% of the ob-jects can be mined from the unlabeled scenes even at the end of the network training. Thus, both of those two cases will bring the student network confused supervision, which harms the performance of the teacher-student model. This would inevitably happen for the single threshold strategy, even adopting some optimal threshold search method [39].
Thus, how to produce reasonable pseudo labels from the teacher network output is an important issue to address for better training the student networks.
Besides the quality of pseudo labels, data augmentation is also the key to the teacher-student model as mentioned previously. Extensive works in 2D semi-supervised object detection have shown that strong data augmentation is very important to learn the strong feature representation ability of the student network. Thus, kinds of strong data aug-mentation strategies, e.g., Mixup [48], Cutout [6], and Mo-saic [4] have been widely adopted. However, current 3D semi-supervised object detection methods adopt some weak data augmentation strategies, e.g., ﬂip-and-shift. These kinds of data augmentations are not able to well drive the student network to learn strong feature representation abil-ity. Thus, the good effect of data augmentation in 2D semi-supervised object detection does not appear obviously in 3D semi-supervised object detection.
To tackle the above issues of the quality of pseudo labels and data augmentation, we propose a Hierarchical Super-vision and Shufﬂe Data Augmentation (HSSDA) method for 3D semi-supervised object detection. We still adopt the teacher-student model as our mainframe. For obtain-ing more reasonable pseudo labels for the student network, we design a dynamic dual-threshold strategy to divide the output of the teacher network into three groups: (1) high-conﬁdence level pseudo labels, (2) ambiguous level pseudo labels, and (3) low-conﬁdence level pseudo labels, as shown in Fig. 1 (a). This division provides hierarchical supervision signals for the student network. Speciﬁcally, the ﬁrst group is used as the strong labels to learn the student network, while the second join learning through a soft-weight way.
The higher the score is, the more it affects learning. The third group is much more likely to tend to be false objects.
We directly delete them from the point cloud to avoid con-fusing parts of the object point cloud into the background.
For strengthening the feature representation ability of the student network, we design a shufﬂe data augmentation strategy in this paper. As shown in Fig. 1 (b), we ﬁrst gener-ate shufﬂed scenes by splitting and shufﬂing the point cloud patches in BEV (bird-eye view) and use them as inputs to the student model. Next, the feature maps extracted from the detector backbone are unshufﬂed back to the original point cloud geometry location.
To summarize, our contributions are as follows:
• We propose a novel hierarchical supervision gener-ation and learning strategy for the teacher-student model. This strategy can provide the student network hierarchical supervision signal, which can fully utilize the output of the teacher network.
• We propose a shufﬂe data augmentation strategy that can strengthen the feature representation ability of the student network.
• Our proposed hierarchical supervision strategy and shufﬂe data augmentation strategy can be directly ap-plied to the off-the-shelf 3D semi-supervised point cloud object detector and extensive experiments demonstrate that our method has achieved state-of-the-art results. 2.