Abstract
Exposure correction task aims to correct the underex-posure and its adverse overexposure images to the normal exposure in a single network. As well recognized, the opti-mization ﬂow is the opposite. Despite great advancement, existing exposure correction methods are usually trained with a mini-batch of both underexposure and overexposure mixed samples and have not explored the relationship be-tween them to solve the optimization inconsistency.
In this paper, we introduce a new perspective to con-junct their optimization processes by correlating and con-straining the relationship of correction procedure in a mini-batch. The core designs of our framework consist of two steps: 1) formulating the exposure relationship of samples across the batch dimension via a context-irrelevant pre-text task. 2) delivering the above sample relationship de-sign as the regularization term within the loss function to promote optimization consistency. The proposed sample relationship design as a general term can be easily inte-grated into existing exposure correction methods without any computational burden in inference time. Extensive ex-periments over multiple representative exposure correction benchmarks demonstrate consistent performance gains by introducing our sample relationship design. 1.

Introduction
The images captured under non-ideal illumination con-ditions, i.e., underexposure or overexposure scenes, usually suffer from unpleasant visual effects and thus count against the down-streaming vision tasks. To this end, exposure correction techniques have been developed, which aim to correct both underexposure and overexposure images to the normal exposure automatically. It is recognized that a sin-gle algorithm is challenging to take for exposure correction since the mapping ﬂows of correcting underexposure and overexposure are quite different [12].
*Equal contributions.
†Corresponding authors.
Recent years have witnessed explosive advancement only on the single underexposure correction, including con-ventional methods that rely on manually designed strate-gies [2, 8, 10, 20, 28, 31], and deep-learning-driven methods that account for the powerful learning capability of com-plicated neural networks [32–34, 39], where deep-learning methods have achieved improvement in restoring corrup-tions [25, 35–37]. Seldom efforts have been devoted to both underexposure and overexposure scenes within a single al-gorithm for meeting the practical application. Very recently, some promising works [1, 12, 14, 24] attempt to solve the above issue. Both of them follow the common principle of alleviating the optimization process inconsistency by con-jugating their exposure representations in spatial domain
[12, 14, 24, 29] or in frequency transform domain [13].
In fact, most above exposure correction approaches are trained with a mini-batch that contains both underexposure and overexposure mixed samples (see Fig. 1). Within the mini-batch, the optimization process of a single network is the opposite. On the other hand, correlating the relationship of samples across the mini-batch could conjunct their opti-mization processes [11]. Therefore, by constraining the re-lationship across the batch dimension, the adverse effect of opposite optimization in the mini-batch could be relieved.
To this end, in this paper, we introduce a new per-spective that conjuncts the optimization processes across the batch dimension via sample relationship learning and further improves the optimization processes of exposure correction. To achieve this, we construct an exposure-relationship learning (ERL) framework consisting of two steps (see Fig. 2). In the ﬁrst step (see Fig. 3), we devise a batch-correlation module (BCM) that captures the rela-tionship of samples across the batch dimension. To enable such a relationship focusing on the exposure-related repre-sentations, we train BCM via a pretext task that excludes context information correlation. Then, in the second step (see Fig. 4), we deliver the above sample relationship as the additional training regularization term within the loss func-tion of exposure correction algorithms, where the relation-ship of corrected results is optimized on the trained BCM.
In this way, the optimization processes within a mini-batch
2.