Abstract
Previous efforts in vision community are mostly made on learning good representations from visual patterns. Beyond this, this paper emphasizes the high-level ability of causal reasoning. We thus present a case study of solving the chal-lenging task of Overall Survival (OS) time in primary liver cancers. Critically, the prediction of OS time at the early stage remains challenging, due to the unobvious image pat-terns of reflecting the OS. To this end, we propose a causal inference system by leveraging the intraoperative attributes and the correlation among them, as an intermediate super-vision to bridge the gap between the images and the final
OS. Particularly, we build a causal graph, and train the im-ages to estimate the intraoperative attributes for final OS prediction. We present a novel Causally-aware Intraop-erative Imputation Model (CAWIM) that can sequentially predict each attribute using its parent nodes in the esti-mated causal graph. To determine the causal directions,
*Equal contribution
†Corresponding author we propose a splitting-voting mechanism, which votes for the direction for each pair of adjacent nodes among multi-ple predictions obtained via causal discovery from hetero-geneity. The practicability and effectiveness of our method are demonstrated by the promising results on liver cancer dataset of 361 patients with long-term observations. 1.

Introduction
The success of recent deep learning model is largely at-tributed to learning the good representations for visual pat-terns. Such representations essentially facilitate various vi-sion task, such as recognition and synthesis [15, 25, 33].
Nevertheless, one important goal for the vision commu-nity is to model and summarize the relationships of ob-served variables of a system, in order to enable well pre-dictions on similar data. Essentially, it is desirable to un-derstand how the system is changed if one modifies these relationships under certain conditions, e.g., the effects of a treatment in healthcare. Thus this demands the high-level ability of causal reasoning beyond the previous ef-forts of only learning good representations for visual pat-terns [1, 5, 16, 21, 35, 37]. This naturally leads into our task of causal inference. ably deteriorate to cirrhosis [4], etc. By leveraging these relationships, we can better understand the causal inference concrete from both observed data modelling and medical expert-level knowledge of these variables.
This paper presents a case study of solving the challeng-ing task of Overall Survival (OS) time estimation in Pri-mary Liver Cancers (PLC). Generally, the liver cancer re-mains one of the most common malignancies worldwide in the 21st century, as there are about one million new cases every year [36]. The five-year survival rate for advanced
PLC is only about 5% [7]. Therefore, early and accurate prediction of OS time estimation can provide informative guidance for individualized treatment planning and reduc-ing burden of medical resources [6, 27, 32, 34]. On the other hand, one shall easily notice that with the renaissance of deep learning, great achievements have been made on medical imaging analysis, such as diagnosis, segmentation, and classification [16, 21, 35, 37]. Unfortunately, it still re-mains challenging for experienced clinicians to predict OS time at early stage, even with advanced modern diagnostic tools such as Magnetic Resonance Imaging (MRI) or tumor marker tests [3, 11], and the deep learning tools [1, 5].
Some studies propose to leverage deep neural networks for OS time prediction. They focus on fusion learning of multi-modal image features and some basic information (i.e., age and gender) [5, 8, 14, 22, 24, 30, 39]. Neverthe-less, the accurate prediction based on only preoperative in-formation (such as image and tumor marker indexes) is still challenging, possibly due to missing information from early diagnosis stage to the final stage. This missing informa-tion includes the texture and pathological attributes of the liver, health level of the patient, and post-operative treat-ment [9, 17, 20]. For example, as in Fig. 1, patient A and
B with different OS time have almost identical preopera-tive indicators cause, history of disease, etc,, making the preoperative-based model hard for discrimination.
To amend this problem, we present a causal inference system that can well utilize the intraoperative information, which is pretty easy to be accessed in training data. Accord-ing to medical priories, such information records patholog-ical attributes, which can be more reflective about the pa-tient’s health level and the postoperative recovery. Inspired by this, we propose to leverage this auxiliary information to help build our causal inference system. Again, we take the example in Fig. 1. Although preoperative information cannot differentiate patient A from B, their intraoperative index shows great difference in distribution, which can thus be employed for the discrimination. Additionally, there are many indicators from medical experts that the intraoperative indexes are related to each other. For instance, the clinico-pathologic hepatocirrhosis is dependent on the hepatocir-rhosis; the sum of tumor diameter is affected by the num-ber of tumors; the fibrosis (reflected on S-Score) can prob-To this end, we encapsulate these priors and the inspired proposals into a new method, dubbed as Causally-Aware In-traoperative Imputation Model (CAWIM). It incorporates causal discovery module to sequentially estimate intraop-erative indexes as an intermediate stage towards final OS time prediction. Specifically, our model is composed of two key steps: i) estimating the intraoperative indexes us-ing preoperative information, i.e., image and indexes; ii) followed by OS time prediction using estimated intraopera-tive indexes and preoperative information. To achieve more accurate prediction of intraoperative indexes that is determi-nant to the prediction power of the whole method, we pro-pose a Causally-aware Directed Acyclic Graph (CaDAG) module. It learns the causal structure represented as a DAG over intraoperative features. To identify the causal rela-tions beyond the traditional PC algorithm [26], we propose a splitting-voting mechanism, which is inspired by the re-cent work [18] that learn the causal structure with the as-sistance of an auxiliary domain index variable. Our pro-posed mechanism can not only identify the causal relations even when this domain index variable is not available, but also can be theoretically guaranteed that the learned graph is not acyclic. During test stage, we sequentially estimate each intraoperative index with preoperative information and additionally, its parent set among other intraoperative in-dexes. The utility of our method can be demonstrated by a significant improvement of OS time prediction on an in-house liver cancer dataset, as well as better interpretabil-ity of learned causal structure, more accurate estimation of intraoperative indexes and more interpretable visualization results.
In a nutshell, we for the first time present a case study of building a causally-aware intraoperative imputation sys-tem for the challenging task of overall survival time pre-diction. The proposed method of building the casual in-ference system, can be naturally extended to other similar medical tasks. Our key contributions are listed as follows. (1) New Paradigm for OS time Prediction. We propose to leverage intraoperative indexes as an intermediate stage during training. The leverage of this information can sig-nificantly alleviate the “missing information” issue. To the best of our knowledge, we are the first to leverage auxiliary information (in addition to preopearative features) for OS time prediction. (2) Causal Structure Learning. We pro-pose a novel splitting-voting mechanism that can identify the causal structure even when the domain index variable is missing. (3) Better Prediction Power. Our method can sig-nificantly improve the prediction power for liver cancer over the competitors. The methods are evaluated on the medical
dataset, which, to the best of our knowledge, is the largest primary live cancer dataset. 2.