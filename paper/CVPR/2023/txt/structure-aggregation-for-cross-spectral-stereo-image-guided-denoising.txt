Abstract
To obtain clean images with salient structures from noisy observations, a growing trend in current denoising studies is to seek the help of additional guidance images with high signal-to-noise ratios, which are often acquired in differ-ent spectral bands such as near infrared. Although previ-ous guided denoising methods basically require the input images to be well-aligned, a more common way to capture the paired noisy target and guidance images is to exploit a stereo camera system. However, current studies on cross-spectral stereo matching cannot fully guarantee the pixel-level registration accuracy, and rarely consider the case of noise contamination.
In this work, for the first time, we propose a guided denoising framework for cross-spectral stereo images. Instead of aligning the input images via con-ventional stereo matching, we aggregate structures from the guidance image to estimate a clean structure map for the noisy target image, which is then used to regress the final de-noising result with a spatially variant linear representation model. Based on this, we design a neural network, called as SANet, to complete the entire guided denoising process.
Experimental results show that, our SANet can effectively transfer structures from an unaligned guidance image to the restoration result, and outperforms state-of-the-art denois-ers on various stereo image datasets. Besides, our struc-ture aggregation strategy also shows its potential to han-dle other unaligned guided restoration tasks such as super-resolution and deblurring. The source code is available at https://github.com/lustrouselixir/SANet. 1.

Introduction
Due to the ill-posed nature of image denoising, even the state-of-the-art single-image denoisers still suffer from the problem of over-smoothing edges and details, especially at high noise levels [5, 26, 35, 41]. Recently, multi-modal im-*Corresponding author.
Figure 1. The overall framework of our SANet.
It consists of a structure aggregation module and a guided denoising module.
The structure aggregation module estimates a structure map for the target image, based on which the guided denoising module regresses the final denoising result. Compared with the state-of-the-art single image denoiser MPRNet [41], our SANet can restore salient structures according to the unaligned guidance image. age processing has attracted increasing attention in image restoration since it’s promising to recover salient structures based on a guidance image [8, 13, 27, 30, 37, 39]. To en-sure that the target image keeps the original ambience and the guidance image is nearly noise-free, the auxiliary guid-ance image is often captured in a different spectral band.
In actual applications, near-infrared (NIR) is a popular op-tion [15, 17, 23, 44]. Many smartphones and surveillance systems have already been equipped with NIR cameras. Ex-tra NIR light sources are usually required to capture clean
NIR images with salient structures in a short exposure time without affecting the imaging process of the visible light.
Current guided image restoration methods [8, 13, 27, 30, 37] basically assume the target and guidance images to be well-aligned at the pixel level. In [44], the authors apply a beam splitter to obtain registered images from two cameras, while the work [23] uses a motorized rotator with different
filters to separate the visible and NIR information from the mixed signals. However, these special designs are too com-plex to be directly deployed into portable devices. A more common way to record information from different spectra is to use a stereo camera system, making it essential to con-duct guided denoising for unaligned cross-spectral images.
One straightforward solution is to register the input im-age pairs through stereo matching. However, current cross-modal stereo matching methods rarely consider the case of noise contamination and precise disparity estimation is in-tractable. Obtaining a large number of ground-truth dispar-ities for supervised training is also a quite heavy work. In addition, as stated in [38], even an accurate pixel-level reg-istration result may be a sub-optimal representation for a vi-sion task due to the occlusion problem. Therefore, to handle guided denoising of unaligned images, we do not consider stereo matching as an essential step.
The guided image filtering theory [13, 27] actually intro-duces an inspirational idea, that the target image can be re-gressed by a spatially variant linear representation model of the guidance image as long as they are structurally aligned.
The pixel and gradient intensities of the guidance image are not crucial factors affecting the accuracy of guided denois-ing.
Inspired by this, in this work, we propose a guided denoising framework for cross-spectral stereo image pairs.
Instead of warping the guidance image based on the one-to-one pixel correspondence constructed by stereo matching, we estimate a structure map for the target image by aggre-gating non-local information from the guidance image.
Here, we assume that the input paired images have been rectified, so that they only have horizontal disparities. To re-store a target pixel, we extract features around pixels within the range of the maximum disparity in the guidance image.
Based on the structural correlation between these candidate pixels and the noisy target one, we further fuse them to esti-mate the structures around this target pixel. The restoration result can then be computed with a spatially variant linear model to adjust the pixel and structural intensities.
Based on the above analysis, we design a convolutional neural network, called as SANet, to handle guided denois-ing for cross-spectral stereo image pairs. Its overall frame-work is shown in Fig. 1. A structure aggregation module ex-tracts non-local features from the guidance image and com-putes their perceptual correlation with the noisy target ones to estimate a clean structure map. Then, a guided denoising module regresses the denoising result from the estimated structure map with a spatially variant linear representation model. In the training stage, we don’t require ground-truth disparity information to optimize the network. Due to the redundancy of image structures, the occluded contents can also be properly estimated with high probability according to their adjacent information.
In summary, the main contributions of this work are as follows: (1) For the first time, we propose a guided denois-ing framework for cross-spectral stereo image pairs, which aims to recover salient structures of the target noisy im-age from an unaligned guidance image. (2) We introduce a noise-robust structure aggregation strategy to estimate a clean structure map for the noisy target image without con-ventional stereo matching, based on which we restore the final denoising result. (3) Experimental results show that our algorithm outperforms state-of-the-art denoising meth-ods on various datasets, and our structural aggregation strat-egy also has the potential to handle other unaligned guided restoration tasks such as super-resolution and deblurring. 2.