Abstract
The task of Vision-Language Navigation (VLN) is for an embodied agent to reach the global goal according to the instruction. Essentially, during navigation, a series of sub-goals need to be adaptively set and achieved, which is nat-urally a hierarchical navigation process. However, previ-ous methods leverage a single-step planning scheme, i.e., directly performing navigation action at each step, which is unsuitable for such a hierarchical navigation process.
In this paper, we propose an Adaptive Zone-aware Hierar-chical Planner (AZHP) to explicitly divides the navigation process into two heterogeneous phases, i.e., sub-goal set-ting via zone partition/selection (high-level action) and sub-goal executing (low-level action), for hierarchical planning.
Specifically, AZHP asynchronously performs two levels of action via the designed State-Switcher Module (SSM). For high-level action, we devise a Scene-aware adaptive Zone
Partition (SZP) method to adaptively divide the whole nav-igation area into different zones on-the-fly. Then the Goal-oriented Zone Selection (GZS) method is proposed to select a proper zone for the current sub-goal. For low-level ac-tion, the agent conducts navigation-decision multi-steps in the selected zone. Moreover, we design a Hierarchical RL (HRL) strategy and auxiliary losses with curriculum learn-ing to train the AZHP framework, which provides effective supervision signals for each stage. Extensive experiments demonstrate the superiority of our proposed method, which achieves state-of-the-art performance on three VLN bench-marks (REVERIE, SOON, R2R). 1.

Introduction
In recent years, Embodied-AI (E-AI) research has at-tracted a surge of interest within the computer vision, nat-ural language processing and robotics communities since its interdisciplinary nature. The long-term goal of E-AI re-search is to build intelligent agents that can interact with humans to complete assigned tasks. In this paper, we fo-*Corresponding author
Figure 1. Given a goal-oriented/semantic-level instruction, (a) pre-vious methods essentially adopt a singel-step navigation paradigm, i.e., directly taking an action from the action space according to the global goal at each step; (b)(c) we instead propose a hierarchi-cal navigation paradigm, containing high- and low-level actions to adaptively set and achieve a series of sub-goals. cus on the Vision-Language Navigation (VLN) task, one of the most fundamental E-AI topics, where embodied agents need to navigate in a photorealistic 3D environment (gener-ally unseen) according to the natural language instruction.
The instruction given to the agent is mainly two types, i.e., step-by-step instruction (e.g. R2R) and goal-oriented instruction (e.g. REVERIE and SOON). The latter is more practical for the home assistant robot since people usually do not provide fine-grained commands, but also more chal-lenging. Firstly, the goal-oriented instruction contains po-tential hierarchical information. As shown in Figure 1, the global goal is “bring me the white pillow”, which indicates the agent needs to complete several potential sub-goals, e.g., leaving the current room, finding the bedroom, locating the white pillow. Thus it is essentially a hierarchical navigation process, where the high-level process is sub-goal setting and the low-level process is sub-goal executing. Secondly, sub-goal means reaching a sub-target in a sub-region, which requires the agent to divide the scene into several zones and
Impor-choose the proper zone for the current sub-goal. tantly, the sub-goal depends not only on the instruction, and an appropriate sub-goal needs to be set based on the agent’s current state, which means the agent needs to conduct zone partition and selection adaptively during navigation. For ex-ample, in Figure 1(b), when the agent is in the living room, the sub-goal is set as “finding the exit in the exit area (red zone)”. Thirdly, it is non-trivial to learn such a hierarchical navigation policy, especially given that there are no expert demonstrations for teaching the high-level process.
However, the dominant paradigm of current state-of-the-art VLN methods is essentially a singel-step planning paradigm as shown in Figure 1(a). It directly takes one step of navigation action at each time, according to the action space and the global goal. Such a paradigm does not ex-plicitly model the hierarchical planning nature of the VLN task, largely limiting the long-horizon decision ability.
To address the issues, we propose an Adaptive Zone-aware Hierarchical Planner (AZHP) based on our main idea, i.e., building a novel hierarchical planning framework for the VLN task. Firstly, AZHP models the navigation process as a hierarchical action-making process containing high-level and low-level actions. During navigation, the high-level action aims to set sub-goals, and the low-level action aims to complete the sub-goals accordingly. Specifically, the high-level action divides the whole scene into differ-ent zones and selects a proper zone for navigation based on the current state, e.g., the green zone (hallway) in Fig-ure 1(c). Then the low-level action is applied to execute specific navigation decision multi-steps in the selected zone until reaching the sub-target. Secondly, for the high-level action, we propose a Scene-aware adaptive Zone Partition (SZP) method to adaptively divide the global action map into several zones on-the-fly, according to the position and observations of each viewpoint. Note that the action map is a maintained topological map that records the historical tra-jectory and observations. Also, we design a Goal-oriented
Zone Selection (GZS) method to select a specific zone ac-cording to the instruction and zone attributes. Besides, a
State-Switcher Module (SSM) is placed to decide whether the current sub-goal is achieved and switch to the next sub-goal, supporting the asynchronous scheme. Thirdly, since there is no direct supervision signal for high-level action training, we propose a Hierarchical Reinforcement Learn-ing (HRL) strategy to provide cooperative rewards. Besides, we design auxiliary losses with a curriculum learning strat-egy to improve the learning robustness further.
In summary, we make the following contributions. (i)
We propose AZHP, which conducts a hierarchical naviga-tion paradigm via setting two-level actions, to solve the long-horizon planning VLN task. To the best of our knowl-edge, AZHP is the pioneering work investigating hierar-chical planning strategy for the VLN task. (ii) We devise
SZP and GZS for high-level action, where SZP adaptively divides scenes into several zones on-the-fly, and GZS se-lects the corresponding zone for a specific sub-goal. Also,
SSM is designed to support asynchronous switching be-tween high/low-level actions. (iii) To construct and learn the hierarchical planning policy, we design an HRL strat-egy and auxiliary losses with a curriculum learning man-ner. Superior performance on three datasets demonstrates the method’s effectiveness. Code is available at: https:
//github.com/chengaopro/AZHP. 2.