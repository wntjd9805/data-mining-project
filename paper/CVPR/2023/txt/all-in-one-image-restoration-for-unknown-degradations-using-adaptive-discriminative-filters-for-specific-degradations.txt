Abstract
Image restorations for single degradations have been widely studied, demonstrating excellent performance for each degradation, but can not reflect unpredictable realistic environments with unknown multiple degradations, which may change over time. To mitigate this issue, image restora-tions for known and unknown multiple degradations have recently been investigated, showing promising results, but require large networks or have sub-optimal architectures for potential interference among different degradations.
Here, inspired by the filter attribution integrated gradients (FAIG), we propose an adaptive discriminative filter-based model for specific degradations (ADMS) to restore images with unknown degradations. Our method allows the net-work to contain degradation-dedicated filters only for about 3% of all network parameters per each degradation and to apply them adaptively via degradation classification (DC) to explicitly disentangle the network for multiple degrada-tions. Our proposed method has demonstrated its effec-tiveness in comparison studies and achieved state-of-the-art performance in all-in-one image restoration benchmark datasets of both Rain-Noise-Blur and Rain-Snow-Haze. 1.

Introduction
Image restoration is a fundamental computer vision task that has been widely investigated especially for single degradation such as noise, blur, snow or rain in images.
Recently, deep learning-based approaches have demon-strated remarkable performance with fast computations, but a majority of them have been focusing on known single degradation such as denoising [2, 4, 20, 25, 65, 67, 68], de-raining [5, 16, 30, 51, 52, 59, 60], deblurring [19, 23, 24, 36, 38, 43, 46, 55], desnowing [11, 31, 33, 53] and dehaz-ing [9, 18, 27, 32, 40, 45, 56, 63, 66]. These prior works can
†Corresponding author. enhance the visual quality of deteriorated images as well as may improve the performance of down-stream tasks in-cluding classification [17, 22], object detection [41, 42] and autonomous driving [3, 34]. However, they are limited only to known single degradation cases, thus can not reflect un-predictable realistic environments with unknown multiple degradations, which may change over time.
Image restoration for real-world environments is a chal-lenging problem since it must deal with unknown multiple degradations. Since most prior works for single degrada-tion may not be optimal for multiple degradations, image restorations for known and unknown multiple degradations have recently been investigated, showing promising results, but require large networks and/or heavy computations. One approach to handle known multiple degradations is to de-velop a single network architecture and train it with dif-ferent degradation datasets to generate independent models (IMs) for various degradations as illustrated in Figure 1(a).
This approach has achieved state-of-the-art performance for known multiple degradations [7, 8, 13, 35, 39, 50, 54, 61, 62].
However, it requires a trained independent network for each degradation task and a proper IM should be selected to han-dle incoming images with known multiple degradations.
Thus, this approach can be applied only to the case of known multiple degradations and it still can not reflect real-istic environments with unknown degradations.
Recently, all-in-one image restoration for unknown mul-tiple degradations has been proposed [12,26,29] with differ-ent approaches. The first way to handle unknown multiple degradations is to use a shared decoder with multiple inde-pendent encoders for multiple degradations (will denote it as Model with independent Encoders or ME) [29] to take the advantage of using small network parameters as com-pared to IM as illustrated in Figure 1(b). However, this architecture requires more independent encoders to handle more degradations inefficiently while there may be interfer-ence among diverse degradations in the shared decoder. The second way is to use a unified model (UM) with a pair of shared encoder and decoder for multiple degradations [12]
Figure 1. Illustrations of 5 image restoration methods for multiple degradations. (a) Independent models (IM) where the models IM.1, IM.2 and IM.k are independent, (b) Model with independent Encoders (ME) whose encoders IM.1, IM.2 and IM.k are independent, (c) Adaptive
Model (AM), (d) Unified Model (UM) and (e) our proposed Adaptive Discriminant filter-based Model for Specific degradation (ADMS) where the sparse models ADS.1, ADS.2 and ADS.k are independent. (f) Number of parameters (Million) vs. PSNR (dB). Our proposed method (Ours) outperformed state-of-the-art all-in-one image restoration methods on both Rain-Noise-Blur and Rain-Snow-Hazy datasets. as illustrated in Figure 1(d). Training was done with knowl-edge distillation for multiple degradations. However, this
UM may not be ideal considering different restoration char-acteristics in processing multiple degradation tasks. For ex-ample, noise removal is mainly low-pass filtering, but de-blurring is close to high-pass filtering. The third way to restore unknown multiple degradations is to use the same
UM, but with an adaptive model (AM) using a contrastive degradation module (Contrastive Encoder or CE) [26] as illustrated in Figure 1(c). This CE was trained implicitly to represent multiple degradations so that UM can perform the restoration process given the corresponding degradation information. However, this architecture is still using the same unified model, which may not be the best for multi-ple restoration tasks in a single model.
In this work, we propose an all-in-one image restora-tion method for unknown multiple degradations by taking the advantages of both high-performing IMs and memory-efficient UMs. We designed our network to use a small number of independent parameters (usually 1-5%) for each degradation task additionally so that network parameters are partially, but explicitly disentangled for different tasks with-out increasing memory usage much as illustrated in Fig-ure 1(e). Additional sparse parameters can be located and used adaptively by leveraging the Filter Attribution method based on Integral Gradient (FAIG) [57], which was origi-nally used to find the most discriminative filters for degra-dation removal in super-resolution networks. A degrada-tion classifier (DC) for multiple degradations is designed to adaptively select the degradation type for incoming im-ages so that appropriate Adaptive Discriminant filters for
Specific degradations (ADS) can be used for inference.
We call the proposed method Adaptive Discriminant filter-based Models for Specific degradation (ADMS) using ADS and DC modules depicted in Figure 1(e).
We summarize four contributions of this work: (1) We propose an ADMS with “explicitly” separated, sparsely added discriminative network parameters (3%) for different degradations to ensure partial independence between differ-ent tasks. (2) By extending the FAIG [57] to diverse degra-dation cases, we leverage it to locate discriminative network parameters (3%) for specific degradation.(3) We propose the DC that leverages our ADS for handling unknown mul-tiple degradations. (4) Our proposed ADMS achieved state-of-the-art performance for diverse combinations of multi-ple degradations such as Rain-Noise-Blur and Rain-Snow-Haze, as shown in the Figure 1(f). 2.