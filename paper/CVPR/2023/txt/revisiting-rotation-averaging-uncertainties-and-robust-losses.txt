Abstract
In this paper, we revisit the rotation averaging problem applied in global Structure-from-Motion pipelines. We ar-gue that the main problem of current methods is the mini-mized cost function that is only weakly connected with the input data via the estimated epipolar geometries. We pro-pose to better model the underlying noise distributions by directly propagating the uncertainty from the point corre-spondences into the rotation averaging. Such uncertain-ties are obtained for free by considering the Jacobians of two-view refinements. Moreover, we explore integrat-ing a variant of the MAGSAC loss into the rotation av-eraging problem, instead of using classical robust losses employed in current frameworks. The proposed method leads to results superior to baselines, in terms of accu-racy, on large-scale public benchmarks. The code is public. https://github.com/zhangganlin/GlobalSfMpy 1.

Introduction
Building large 3D reconstructions from unordered im-age collections is an essential component in any system that relies on crowd-sourced mapping. The current paradigm is to perform this reconstruction via Structure-from-Motion
[29] which jointly estimates the camera parameters and the scene geometry represented with a 3D point cloud. Meth-ods for Structure-from-Motion can generally be categorized into two classes; Incremental methods [29, 32, 33, 38] that sequentially grows a seed reconstruction by alternating tri-angulation and registering new images, and Global meth-ods [8, 22, 24, 27] which first estimate pairwise geometries and then aggregate them in a bottom-up approach. Histor-ically, incremental methods are more robust and accurate, but the need for frequent bundle adjustment [35] comes with significant computational cost which limits their scalabil-ity. In contrast, global (or non-sequential) methods require much lower computational effort and can in principle scale to larger image collections. However, in practice, current methods are held back by the lack of accuracy and have not enjoyed the same level of success as incremental methods.
Global methods work by first estimating a set of pair-wise epipolar geometries between co-visible images. Next, via rotation averaging, a set of globally consistent rotations are estimated by ensuring they agree with the pairwise rel-ative rotations. Once the rotations are known, the camera positions and 3D structure are estimated, and refined jointly in a single final bundle adjustment.
Rotation averaging has a long history in computer vision (see e.g. [16,22] for early works) and is a well-studied prob-lem. Most methods formulate it as an optimization problem, finding the rotation assignment that minimizes some energy.
A common choice is the chordal distance, measuring the
discrepancy in the rotation matrices in the L2-sense min
{Ri}N i=1
N (cid:88) (cid:88) i=1 j∈N (i)
∥ ˆRijRi − Rj∥2
F (1) where ˆRij is the relative rotation estimated between image i and j. There are also other choices such as using angle-axis [34] or quaternion [16] as rotation representation, or optimising over a Lie algebra [17], however the overall idea (measuring some consistency with the relative estimates) remains the same. Many works have focused on the opti-mization problem itself, both theoretically [11, 36] and by providing new algorithms [9], but did not consider whether the cost itself is suitable for the task. In (1), each relative ro-tation measurement is given the same weight. However in practice, the quality of the epipolar geometries varies sig-nificantly. Figure 1 shows two images with wildly different uncertainties (and errors) in the rotation estimate. To ad-dress this problem, there is a line of work [6, 18, 31] which augment the cost in (1) with robust loss functions that give a lower weight to large residuals. However, the same loss function is generally applied to each residual, independent of the measurement uncertainty.
In this paper we revisit the rotation averaging problem.
We argue that the main problem in current methods is that the cost functions that are minimized are only weakly con-nected with the input data via the estimated epipolar ge-ometries. We propose to better model the underlying noise distributions (coming from the keypoint detection noise and spatial distribution) by directly propagating the uncertainty from the point correspondences into the rotation averaging problem, as shown in Figure 2. While the idea itself is sim-ple, we show that this allows us to get significantly more accurate estimates of the absolute rotations; reducing the gap between incremental and global methods. Note that the uncertainties we leverage are essentially obtained for free by considering the Jacobians of the two-view refinement.
As a second contribution, we explore integrating a vari-ant of the MAGSAC [3] loss into the rotation averaging problem, instead of using the classical robust losses em-ployed in current frameworks. MAGSAC [3] was originally proposed as a threshold-free estimator for two-view epipo-lar geometry, where the idea is to marginalize over an in-terval of acceptable thresholds, i.e., noise range. We show that this fits well into the context of rotation-averaging, as it is not obvious how to set the threshold for deciding on in-lier/outlier relative rotation measurements, especially in the uncertainty-reweighted cost that we propose. 2.