Abstract
Predicting the future motion of road agents is a criti-cal task in an autonomous driving pipeline. In this work, we address the problem of generating a set of scene-level, or joint, future trajectory predictions in multi-agent driv-ing scenarios. To this end, we propose FJMP, a Factorized
Joint Motion Prediction framework for multi-agent interac-tive driving scenarios. FJMP models the future scene in-teraction dynamics as a sparse directed interaction graph, where edges denote explicit interactions between agents.
We then prune the graph into a directed acyclic graph (DAG) and decompose the joint prediction task into a se-quence of marginal and conditional predictions according to the partial ordering of the DAG, where joint future tra-jectories are decoded using a directed acyclic graph neural network (DAGNN). We conduct experiments on the INTER-ACTION and Argoverse 2 datasets and demonstrate that
FJMP produces more accurate and scene-consistent joint trajectory predictions than non-factorized approaches, es-pecially on the most interactive and kinematically interest-ing agents. FJMP ranks 1st on the multi-agent test leader-board of the INTERACTION dataset. 1.

Introduction
Multi-agent motion prediction is an important task in a self-driving pipeline, and it involves forecasting the fu-ture positions of multiple agents in complex driving envi-ronments. Most existing works in multi-agent motion pre-diction predict a set of marginal trajectories for each agent
[14, 19, 21, 30, 32, 40, 46], and thus fail to explicitly account for agent interactions in the future. This results in trajec-tory predictions that are not consistent with each other. For example, the most likely marginal prediction for two inter-acting agents may collide with each other, when in reality a negotiation between agents to avoid collision is far more
*Corresponding author.
Figure 1. An illustration of the directed acyclic interaction graph, comprised of colored nodes and red arrows. The dotted black lines denote the ground-truth futures over a short time horizon. FJMP first produces marginal predictions for the green (dashed) nodes, followed by a conditional prediction for the yellow (dotted) node and a conditional prediction for the purple (solid) node, with con-ditioning on the predicted future of the parent nodes in the graph. likely. As scene-consistent future predictions are critical for downstream planning, recent work has shifted toward gen-erating a set of scene-level, or joint, future trajectory predic-tions [5, 7, 8, 17, 34, 38], whereby each mode consists of a future trajectory prediction for each agent and the predicted trajectories are consistent with each other.
In this work, we focus on the problem of generating a set of joint future trajectory predictions in multi-agent driving scenarios. Unlike marginal prediction, the joint trajectory prediction space grows exponentially with the number of agents in the scene, which makes this prediction setting par-ticularly challenging. A common approach for this setting is to simultaneously predict the joint futures for all agents in the scene [5, 8, 17, 18, 34]; however, this approach fails to explicitly reason about future interactions in the joint pre-dictions. To address this limitation, recent work has shown that decomposing the joint prediction task of two interact-ing agents into a marginal prediction for the influencer agent and a conditional prediction for the reactor agent, where the reactor’s prediction conditions on the predicted future of the influencer, can generate more accurate and scene-consistent joint predictions than methods that generate marginal pre-dictions or simultaneous joint predictions [28, 38]. How-ever, these methods are optimized for the joint prediction of only two interacting agents, and they do not efficiently scale to scenes with a large number of interacting agents.
To address these limitations of existing joint motion pre-dictors, in this work we propose FJMP – a Factorized
Joint Motion Prediction framework that efficiently gener-ates joint predictions for driving scenarios with an arbitrar-ily large number of agents by factorizing the joint predic-tion task into a sequence of marginal and conditional pre-dictions. FJMP models the future scene interaction dynam-ics as a sparse directed interaction graph, where an edge denotes an explicit interaction between a pair of agents, and the direction of the edge is determined by their influencer-reactor relationship [25, 27, 38], as can be seen in Fig. 1.
We propose a mechanism to efficiently prune the interac-tion graph into a directed acyclic graph (DAG). Joint fu-ture trajectory predictions are then decoded as a sequence of marginal and conditional predictions according to the partial ordering of the DAG, whereby marginal predictions are generated for the source node(s) in the DAG and condi-tional predictions are generated for non-source nodes that condition on the predicted future of their parents in the
DAG. To enable this sequential trajectory decoding, we adapt a lightweight directed acyclic graph neural network (DAGNN) [39] architecture for efficiently processing pre-dicted future information through the DAG and decoding the marginal and conditional trajectory predictions. Our main contributions can be summarized as follows:
• We propose FJMP, a novel joint motion prediction framework that generates factorized joint trajectory predictions over sparse directed acyclic interaction graphs. To our knowledge, FJMP is the first frame-work that enables scalable factorized joint prediction on scenes with arbitrarily many interacting agents.
• We validate our proposed method on both the multi-agent INTERACTION dataset and the Argoverse 2 dataset and demonstrate that FJMP produces scene-consistent joint predictions for scenes with up to 50 agents that outperform non-factorized approaches, es-pecially on the most interactive and kinematically complex agents. FJMP achieves state-of-the-art per-formance across several metrics on the challenging multi-agent prediction benchmark of the INTERAC-TION dataset and ranks 1st on the official leaderboard. 2.