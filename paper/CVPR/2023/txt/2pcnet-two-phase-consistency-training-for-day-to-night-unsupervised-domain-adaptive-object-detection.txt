Abstract
Object detection at night is a challenging problem due to the absence of night image annotations. Despite several domain adaptation methods, achieving high-precision re-sults remains an issue. False-positive error propagation is still observed in methods using the well-established student-teacher framework, particularly for small-scale and low-light objects. This paper proposes a two-phase consistency unsupervised domain adaptation network, 2PCNet, to ad-dress these issues. The network employs high-confidence bounding-box predictions from the teacher in the first phase and appends them to the student’s region proposals for the teacher to re-evaluate in the second phase, resulting in a combination of high and low confidence pseudo-labels. The night images and pseudo-labels are scaled-down before be-ing used as input to the student, providing stronger small-scale pseudo-labels. To address errors that arise from low-light regions and other night-related attributes in images, we propose a night-specific augmentation pipeline called
NightAug. This pipeline involves applying random aug-mentations, such as glare, blur, and noise, to daytime im-ages. Experiments on publicly available datasets demon-strate that our method achieves superior results to state-of-the-art methods by 20%, and to supervised models trained directly on the target data. 1 1.

Introduction
Nighttime object detection is critical in many applica-tions. However, the requirement of annotated data by su-pervised methods is impractical, since night data with anno-tations is few, and supervised methods are generally prone to overfitting to the training data. Among other reasons, this scarcity is due to poor lighting conditions which makes nighttime images hard to annotate. Hence, methods that 1www.github.com/mecarill/2pcnet
Figure 1. Qualitative results of state-of-the-art DA methods, DA
Faster-RCNN [3], UMT [7], Adaptive Teacher (AT) [15] and our method 2PCNet on the BDD100K [36] dataset. Unlike the SOTA methods, our method is able to detect dark and small scale objects with minimal additional false positive predictions. do not assume the availability of the annotations are more advantageous. Domain adaptation (DA) is an efficient solu-tion to this problem by allowing the use of readily available annotated source daytime datasets.
A few domain adaptation methods have been proposed, e.g., adversarial learning which uses image and instance level classifiers [3] and similar concepts [22, 32]. However, these methods isolate the domain adaptation task purely to-wards the feature extractor, and suppress features of the target data for the sake of domain invariance. Recent un-supervised domain adaptation methods exploit the student-teacher framework (e.g. [1,7,11,15]). Since the student ini-tially learns from the supervised loss, there is a bias towards the source data. Augmentation [7,11] and adversarial learn-ing [15] have been proposed to address this problem. Un-fortunately, particularly for day-to-night unsupervised do-main adaptation, these methods suffer from a large num-ber of inaccurate pseudo-labels produced by the teacher. In our investigation, the problem is notably due to insufficient knowledge of small scale features in the nighttime domain, which are then propagated through the learning process be-tween the teacher and student, resulting in poor object de-tection performance.
To address the problem, in this paper, we present 2PC-Net, a two-phase consistency unsupervised domain adapta-tion network for nighttime object detection. Our 2PCNet merges the bounding-boxes of highly-confident pseudo-labels, which are predicted in phase one, together with re-gions proposed by the student’s region proposal network (RPN). The merged proposals are then used by the teacher to generate a new set of pseudo-labels in phase two. This provides a combination of high and low confidence pseudo-labels. These pseudo-labels are then matched with pre-dictions generated by the student. We can then utilise a weighted consistency loss to ensure that a higher weightage of our unsupervised loss is based on stronger pseudo-labels, yet allow for weaker pseudo-labels to influence the training.
Equipped with this two-phase strategy, we address the problem of errors from small-scale objects. We devise a student-scaling technique, where night images and their pseudo-labels for the student are deliberately scaled down.
In order to generate accurate pseudo-labels, images to the teacher remain at their full scale. This results in the pseudo-labels of larger objects, which are easier to predict, to be scaled down to smaller objects, allowing for an increase in small scale performance of the student.
Nighttime images suffer from multiple complications not found in daytime scenes such as dark regions, glare, promi-nent noise, prominent blur, imbalanced lighting, etc. All these cause a problem, since the student, which was trained on daytime images, is much more biased towards the day-time domain’s characteristics. To mitigate this problem, we propose NightAug, a set of random nighttime specific augmentations. NightAug includes adding artificial glare, noise, blur, etc. that mimic the night conditions to day-time images. With NightAug we are able to reduce the bias of the student network towards the source data without re-sulting to adversarial learning or compute-intensive trans-lations. Overall, using 2PCNet, we can see the qualitative improvements of our result in Figure 1. In summary, the contributions of this paper are as follows:
• We present 2PCNet, a two-phase consistency approach for student-teacher learning. 2PCNet takes advantage of highly confident teacher labels augmented with less confident regions, which are proposed by the scaled student. This strategy produces a sharp reduction of the error propagation in the learning process.
• To address the bias of the student towards the source domain, we propose NightAug, a random night spe-cific augmentation pipeline to shift the characteristics of daytime images toward nighttime.
• The effectiveness of our approach has been verified by comparing it with the state-of-the-art domain adapta-tion approaches. An improvement of +7.9AP(+20%) and +10.2AP(26%) over the SOTA on BDD100K and
SHIFT has been achieved, respectively. 2.