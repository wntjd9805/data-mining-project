Abstract
For real applications, existing HSI-SR methods are not only limited to unstable performance under unknown sce-narios but also suffer from high computation consumption.
In this paper, we develop a new coordination optimiza-tion framework for stable, interpretable, and lightweight
HSI-SR. Specifically, we create a positive cycle between fu-sion and degradation estimation under a new probabilis-tic framework. The estimated degradation is applied to fu-sion as guidance for a degradation-aware HSI-SR. Under the framework, we establish an explicit degradation estima-tion method to tackle the indeterminacy and unstable per-formance caused by the black-box simulation in previous methods. Considering the interpretability in fusion, we in-tegrate spectral mixing prior into the fusion process, which can be easily realized by a tiny autoencoder, leading to a dramatic release of the computation burden. Based on the spectral mixing prior, we then develop a partial fine-tune strategy to reduce the computation cost further. Com-prehensive experiments demonstrate the superiority of our method against the state-of-the-arts under synthetic and real datasets. For instance, we achieve a 2.3 dB promo-tion on PSNR with 120× model size reduction and 4300×
FLOPs reduction under the CAVE dataset. Code is avail-able in https://github.com/WenjinGuo/DAEM . 1.

Introduction
Different from traditional optical images with a few channels, hyperspectral images (HSIs) with tens to hun-dreds of bands hold discriminative information about ma-terials, leading to a great advantage in a wide range of ap-plications, e.g., the monitoring and management of ecosys-tems, biodiversity, and disasters [1–8]. However, the physi-cal limitation in imaging causes a trade-off between spatial
*Equal contribution.
†Cooresponding author. (a) (b)
Figure 1. Comparison among recent state-of-the-art (SOTA) meth-ods and our method. We report the computational efficiency (Size,
FLOPs, and Time) in (a) and the distribution of two measurement metrics (PSNR, SAM) under various degradations in (b). Obvi-ously, our method is remarkably superior to others in lightweight, fidelity, and stability. and spectral resolution. HSIs are suffered from low spa-tial resolution in real applications. Therefore, hyperspectral super-resolution (HSI-SR), which aims to promote the spa-tial resolution of HSIs, has become a significant task, and always performs as a necessary pre-processing of HSI ap-plications, i.e. detection and classification [9–16].
Due to the common optical platforms which are equipped with both HSI sensor and multispectral sensor (such as satellites, airborne platforms), HSIs and multispec-tral images (MSIs) imaged in the same scene are easy to access. Fusion-based HSI-SR aims to estimate the desired high resolution HSI (HR-HSI) from the corresponding low resolution HSI (LR-HSI) and high resolution MSI (HR-MSI). Naturally, HSI-SR can be modeled as a maximum a posterior (MAP) estimation: p(Z|X , Y) ∝ p(X , Y|Z, θ)p(Z|ϕ), (1) where Z ∈ RH×W ×B is the target HR-HSI with H, W and
B as its height, width and number of bands, respectively.
X ∈ Rh×w×B is the observed LR-HSI with h and w as
its height and width (h < H, w < W ). Y ∈ RH×W ×b is the HR-MSI with b bands (b < B). θ and ϕ are pa-rameters in the likelihood and the prior, respectively. As a pre-processing task, HSI-SR faces two challenges, high fidelity recovery and efficient processing (i.e., low compu-tational burden and fast processing). Referred to Eq. (1), we analyse these two ingredients from three perspectives: the likelihood term, the prior term, and coordination between them.
Likelihood Term
The likelihood term reflects the degradation process, and the widely accepted degradation model can be formulated as:
X = (Z ∗ C) ↓s +NX ,
Y = Z ×3 R + NY , (2) where C ∈ Rs×s, R ∈ RB×b represent the PSF (point spread function) and SRF (spectral response function), re-↓s represents spatial downsampling with s spectively. times. ×3 is matrix multiple on the third dimension. Early methods demand precise degradation parameters to opti-mize the likelihood [17–19]. However, PSF and SRF are various and unknown in real scenarios, hence the high de-mand for blind HSI-SR. In [20], two convolution blocks are built to simulate the degradation process, which learn the degradation in training sets and apply it to testing samples.
Unsupervised blind HSI-SR methods estimate degradation in each image-pair individually [21–23]. Yao et al. [22] pro-pose a spatial-spectral consistency to further constrain the degradation estimation. Despite better applicability, recent blind HSI-SR methods are limited by the DL-based estima-tion. On one hand, the implicit modeling of degradation imports a black box in optimization and draws uncertainty, especially in volatile degradation. On the other hand, degra-dation estimation is an inverse problem with multiple candi-dates, the common over-fitting in neural networks will lead to inaccurate and unstable performance.
Prior Term
If only considering the likelihood term, HSI-SR is an ill-posed problem with infinite solutions. The prior term shrinks the solution space as a regularization. Earlier works make assumptions on prior through manual induction of data characteristics, such as low rank [24, 25], and spar-sity [26–30]. Recent supervised deep learning (DL)-based methods replace this process through data characterization by neural networks. These inductive methods will drop a lot on performance when testing samples differ training samples, hence a critical need for general prior assumption.
As an inherent feature in HSIs, spectral mixing prior sim-ulates the common spectral mixing phenomenon in imag-ing. Unmixing-based methods make a breakthrough in fi-delity [17, 18, 31, 32]. Moreover, to promote the generaliza-tion, coupled autoencoder is proposed to simulate the spec-tral mixing with deep learning toolkit [21, 22]. Despite su-perior fidelity, recent unsupervised DL-based methods over-focus on network architecture and underestimate the effort of prior knowledge in HSIs, resulted in two drawbacks. On one hand, the over-designed network structures weaken the role of the prior assumption, which harms the interpretabil-ity. On the other hand, the complicated network structures pose a heavy burden on power and memory.
Coordination between Likelihood and Prior
The most recent blind HSI-SR methods generally con-tain two modules, the fusion module and the degradation estimator [22,23,33]. From the viewpoint of MAP problem, the former aims to recover the HR-HSI through the obser-vations under the regularization of the prior. The later mini-mizes the likelihood term by estimating degradation param-eters. The unknown HR-HSI and degradation determine the observations. Naturally, the estimated degradation can be fed to the fusion module as a guidance. However, in recent methods, the degradation estimator and fusion module only interacts in backward stage. The learned degradation pa-rameters are not involved in the updating of fusion module or prior parameters, which brings two weaknesses. Firstly, the nearly independent optimization of likelihood and prior causes more updating steps and slows the convergence. Sec-ondly, optimization with less interaction inducts conflict op-timization directions and results in local optimum with un-real recovery.
In this paper, we develop a novel coordination optimiza-tion framework for stable, interpretable, and lightweight
HSI-SR. Through integrating the Wald protocol in the MAP problem, we construct a postive feedback loop between prior and likelihood. Based on the framework, we explore an explicit degradation estimation to remedy the unstable performance of black-box estimation. As for the prior, we establish a lightweight autoencoder to simulate the spectral mixing prior in HSIs for a interpretable fusion. Our contri-butions are summarized as follows: 1. We explore a coordination optimization framework for HSI-SR with fast convergence and stable performance.
Under the framework, the degradation estimation and fusion process promote each other concordantly. To the best of our knowledge, it is the first work to explore the cooperative relationship between prior and likelihood in HSI-SR. 2. An explicit estimation method is established in HSI-SR firstly. Through modeling PSF and SRF with anisotropic
Gaussian kernel and Gaussian mixture, tiny parameters re-alize stable and precise estimation. 3. We simulate the general spectral mixing prior with only one interpretable autoencoder. Compared with recent complicated models, the network makes a breakthrough in lightweight. Based on the fusion netwrok, we explore a par-tial optimization strategy in test stage, which only updates the decoder that handles the individual spectral feature of
images, reducing large computaion and time consumption. 3. The Proposed Method 2.