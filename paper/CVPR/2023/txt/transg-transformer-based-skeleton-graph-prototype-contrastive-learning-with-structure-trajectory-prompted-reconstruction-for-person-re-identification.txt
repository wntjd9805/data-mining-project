Abstract
Person re-identification (re-ID) via 3D skeleton data is an emerging topic with prominent advantages. Existing methods usually design skeleton descriptors with raw body joints or perform skeleton sequence representation learn-ing. However, they typically cannot concurrently model dif-ferent body-component relations, and rarely explore useful semantics from fine-grained representations of body joints.
In this paper, we propose a generic Transformer-based
Skeleton Graph prototype contrastive learning (TranSG) approach with structure-trajectory prompted reconstruc-tion to fully capture skeletal relations and valuable spatial-temporal semantics from skeleton graphs for person re-ID.
Specifically, we first devise the Skeleton Graph Transformer (SGT) to simultaneously learn body and motion relations within skeleton graphs, so as to aggregate key correlative node features into graph representations. Then, we propose the Graph Prototype Contrastive learning (GPC) to mine the most typical graph features (graph prototypes) of each identity, and contrast the inherent similarity between graph representations and different prototypes from both skeleton and sequence levels to learn discriminative graph repre-sentations. Last, a graph Structure-Trajectory Prompted
Reconstruction (STPR) mechanism is proposed to exploit the spatial and temporal contexts of graph nodes to prompt skeleton graph reconstruction, which facilitates capturing more valuable patterns and graph semantics for person re-ID. Empirical evaluations demonstrate that TranSG signif-icantly outperforms existing state-of-the-art methods. We further show its generality under different graph model-ing, RGB-estimated skeletons, and unsupervised scenar-ios. Our codes are available at https://github.com/Kali-Hac/TranSG.
*Corresponding author
Figure 1. TranSG temporally and spatially masks skeleton graphs to prompt their reconstruction, while integrating full skeletal rela-tions into contrastive learning of typical features for person re-ID. 1.

Introduction
Person re-identification (re-ID) is a challenging task of retrieving and matching a specific person across varying views or scenarios, which has empowered many vital ap-plications such as security authentication, human tracking, and robotics [1–4]. Recently driven by economical, non-obtrusive and accurate skeleton-tracking devices like Kinect
[5], person re-ID via 3D skeletons has attracted surging at-tention in both academia and industry [2, 6–14]. Unlike conventional methods that rely on visual appearance fea-tures (e.g., colors, silhouettes), skeleton-based person re-ID methods model unique body and motion representations with 3D positions of key body joints, which typically enjoy smaller data sizes, lighter models, and more robust perfor-mance under scale and view variations [2, 15].
Most existing methods manually extract anthropometric descriptors and gait attributes from body-joint coordinates
[7–10, 13], or leverage sequence learning paradigms such as Long Short-Term Memory (LSTM) [16] to model body and motion features with skeleton sequences [2, 6, 14, 17].
However, these methods rarely explore the inherent body relations within skeletons (e.g., inter-joint motion correla-tions), thus largely ignoring some valuable skeleton pat-terns. To fill this gap, a few recent works [11, 18] con-struct skeleton graphs to model body-component relations
in terms of structure and action. These methods typically re-quire multi-stage non-parallel relation modeling, e.g., [18] models collaborative relations conditioned on the structural relations, while they cannot simultaneously mine differ-ent underlying relations. On the other hand, they usu-ally leverage sequence-level instances such as averaged fea-tures of sequential graphs [11] for representation learning, which inherently limits their ability to exploit richer graph semantics from fine-grained (e.g., node-level) representa-tions. For example, there usually exist strong correlations between nearby body-joint nodes within a local spatial-temporal graph context, which can prompt learning unique and recognizable skeleton patterns for person re-ID.
To address the above challenges, we propose a general
Transformer-based Skeleton Graph prototype contrastive learning (TranSG) paradigm with structure-trajectory prompted reconstruction as shown in Fig. 1, which inte-grates different relational features of skeleton graphs and contrasts representative graph features to learn discrimina-tive representations for person re-ID. Specifically, we first model 3D skeletons as graphs, and propose the Skeleton
Graph Transformer (SGT) to perform full-relation learning of body-joint nodes, so as to simultaneously aggregate key relational features of body structure and motion into effec-tive graph representations. Second, a Graph Prototype Con-trastive learning (GPC) approach is proposed to contrast and learn the most representative skeleton graph features (defined as “graph prototypes”) of each identity. By pulling together both sequence-level and skeleton-level graph repre-sentations to their corresponding prototypes while pushing apart representations of different prototypes, we encourage the model to capture discriminative graph features and high-level skeleton semantics (e.g., identity-associated patterns) for person re-ID. Last, motivated by the inherent structural correlations and pattern continuity of body joints [2], we de-vise a graph Structure-Trajectory Prompted Reconstruction (STPR) mechanism to exploit the spatial-temporal context (i.e., graph structure and trajectory) of skeleton graphs to prompt the skeleton graph reconstruction, which facilitates learning richer graph semantics and more effective graph representations for the person re-ID task.
Our key contributions can be summarized as follows:
• We present a generic TranSG paradigm to learn ef-fective representations from skeleton graphs for per-son re-ID. To the best of our knowledge, TranSG is the first transformer paradigm that unifies skeletal re-lation learning and skeleton graph contrastive learning specifically for skeleton-based person re-ID.
• We devise a skeleton graph transformer (SGT) to fully capture relations in skeleton graphs and integrate key correlative node features into graph representations.
• We propose the graph prototype contrastive learn-ing (GPC) to contrast and learn the most representa-tive graph features and identity-related semantics from both skeleton and sequence levels for person re-ID.
• We devise the graph structure-trajectory prompted re-construction (STPR) to exploit spatial-temporal graph contexts for reconstruction, so as to capture more key graph semantics and unique features for person re-ID.
Extensive experiments on five public benchmarks show that TranSG prominently outperforms existing state-of-the-art methods and is highly scalable to be applied to different graph modeling, RGB-estimated or unlabeled skeleton data. 2.