Abstract
High-definition (HD) semantic maps are crucial for au-tonomous vehicles navigating urban environments. Tra-ditional offline HD maps, created through labor-intensive manual annotation processes, are both costly and incapable of accommodating timely updates. Recently, researchers have proposed inferring local maps based on online sensor observations; however, this approach is constrained by the sensor perception range and is susceptible to occlusions. In this work, we propose Neural Map Prior (NMP), a neu-ral representation of global maps that facilitates automatic global map updates and improves local map inference per-formance. To incorporate the strong map prior into local map inference, we employ cross-attention that dynamically captures correlations between current features and prior features. For updating the global neural map prior, we use a learning-based fusion module to guide the network in fusing features from previous traversals. This design allows the network to capture a global neural map prior during sequential online map predictions. Experimental re-sults on the nuScenes dataset demonstrate that our frame-work is highly compatible with various map segmentation and detection architectures and considerably strengthens map prediction performance, even under adverse weather conditions and across longer horizons. To the best of our knowledge, this represents the first learning-based system for constructing a global map prior. 1.

Introduction
Autonomous vehicles require high-definition (HD) se-mantic maps to accurately predict the future trajectories of other agents and safely navigate urban streets. How-ever, most autonomous vehicles depend on labor-intensive and costly pre-annotated offline HD maps, which are con-structed through a complex pipeline involving multi-trip
LiDAR scanning with survey vehicles, global point cloud alignment, and manual map element annotation. Despite their high precision, the scalability of these offline mapping
*Corresponding at: hangzhao@mail.tsinghua.edu.cn.
Figure 1. Comparison of semantic map construction methods.
Traditional offline semantic mapping pipelines (the first row) in-volve a complex manual annotation pipeline and do not support timely map updates. Online HD semantic map learning methods (the second row) rely entirely on onboard sensor observations and are susceptible to occlusions. We propose the Neural Map Prior (NMP, the third row), an innovative neural representation of global maps designed to aid onboard map prediction. NMP is incremen-tally updated as it continuously integrates new observations from a fleet of autonomous vehicles. solutions is limited, and they do not support timely updates when road conditions change. Consequently, autonomous vehicles may rely on out-of-date maps, negatively impact-ing driving safety. Recent research has explored alterna-tive methods for learning HD semantic maps using onboard sensor observations, such as camera images and LiDAR point clouds [11, 13, 15]. These methods typically use deep learning techniques to infer map elements in real-time, ad-dressing the map update issue associated with offline maps.
However, the quality of the inferred maps is generally infe-rior to pre-constructed global maps and may further deterio-rate under adverse weather conditions and occluded scenar-ios. The comparison of different semantic map construction methods is illustrated in Figure 1.
In this work, we propose Neural Map Prior (NMP), a novel hybrid mapping solution that combines the best of both worlds. NMP leverages neural representations to build and update a global map prior, thereby improving map in-ference performance for autonomous cars. The NMP pro-cess consists of two primary steps: global map prior up-date and local map inference. The global map prior is a sparsely tiled neural representation, with each tile corre-sponding to a specific real-world location.
It is automat-ically developed by aggregating data from a fleet of self-driving cars. Onboard sensor data and the global map prior are then integrated into the local map inference process, which subsequently refines the map prior. These procedures are interconnected in a feedback loop that grows stronger as more data is collected from the vast number of vehicles nav-igating the roads daily. One example is shown in Figure 2.
Technically, the global neural map prior is defined as sparse map tiles initialized from an empty state. For each online observation from an autonomous vehicle, a neural network encoder first extracts local Birds-Eye View (BEV) features. These features are then refined using the corre-sponding BEV prior feature derived from the global NMPâ€™s map tile. The improved BEV features enable us to infer the local semantic map and update the global NMP. As the ve-hicles traverse through the various scenes, the local map in-ference phase and the global map prior update step mutually reinforce each other, improving the quality of the predicted local semantic map and maintaining a more complete and up-to-date global NMP.
We demonstrate that NMP can be readily applied to var-ious state-of-the-art HD semantic map learning methods to enhance accuracy. Experiments on the public nuScenes dataset reveal that by integrating NMP with cutting-edge map learning techniques, our pipeline improves perfor-mance by +4.32 mIoU for HDMapNet, +5.02 mIoU for
LSS, +5.50 mIoU for BEVFormer, and +3.90 mAP for Vec-torMapNet.
To summarize, our contributions are as follows: 1. We propose a novel mapping paradigm named Neural
Map Prior that combines offline global map mainte-nance and online local map inference, while local in-ference demands similar computational and memory resources as previous single-frame systems. 2. We propose simple and efficient current-to-prior atten-tion and GRU modules adaptable to mainstream HD semantic map learning methods and boost their map prediction results. 3. We evaluate our method on the nuScenes dataset across different map elements and four map segmen-tation/detection architectures and demonstrate signif-icant and consistent improvements. Moreover, our findings show notable progress in challenging situ-ations involving adverse weather conditions and ex-tended perception ranges. 2.