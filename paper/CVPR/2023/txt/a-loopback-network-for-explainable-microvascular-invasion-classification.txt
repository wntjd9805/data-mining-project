Abstract
Microvascular invasion (MVI) is a critical factor for prog-nosis evaluation and cancer treatment. The current diagnosis of MVI relies on pathologists to manually find out cancer-ous cells from hundreds of blood vessels, which is time-consuming, tedious, and subjective. Recently, deep learning has achieved promising results in medical image analysis tasks. However, the unexplainability of black box models and the requirement of massive annotated samples limit the clini-cal application of deep learning based diagnostic methods.
In this paper, aiming to develop an accurate, objective, and explainable diagnosis tool for MVI, we propose a Loop-back Network (LoopNet) for classifying MVI efficiently. With the image-level category annotations of the collected Patho-logic Vessel Image Dataset (PVID), LoopNet is devised to be composed binary classification branch and cell locating branch. The latter is devised to locate the area of cancer-ous cells, regular non-cancerous cells, and background. For healthy samples, the pseudo masks of cells supervise the cell locating branch to distinguish the area of regular non-cancerous cells and background. For each MVI sample, the cell locating branch predicts the mask of cancerous cells.
Then the masked cancerous and non-cancerous areas of the same sample are input back to the binary classification branch separately. The loopback between two branches en-ables the category label to supervise the cell locating branch to learn the locating ability for cancerous areas. Experiment results show that the proposed LoopNet achieves 97.5% ac-curacy on MVI classification. Surprisingly, the proposed loopback mechanism not only enables LoopNet to predict the cancerous area but also facilitates the classification back-bone to achieve better classification performance.
*Corresponding author
Figure 1. Examples of MVI and healthy vessels extracted from a pathological image of liver cancer. (a) The super large sample contains numerous blood vessels of varied sizes. (b) The healthy vessels are composed of a variety of cells with similar appearances. (c) The cancerous cells have varied types and similar appearances to parts of healthy cells. 1.

Introduction
Microvascular invasion (MVI), referring to the appear-ance of cancerous cells within microscopic venules or veins, is a histological feature of cancer-related to aggressive biological behavior [27, 56]. In clinical, MVI is usually used as a reference standard for assessing cancer spread-ing, which is a critical factor for prognosis evaluation and treatment [8, 15, 43]. Accurate prognosis evaluation along with appropriate treatment can effectively improve patient’s life quality and prolong their life-span.
Currently, the diagnosis of MVI relies on pathologists to manually find out cancerous cells from hundreds of blood vessels, each of which usually contains dozens of cells. As shown in Fig.1, each pathological sample is an image of
about 100, 000×250, 000 px. These super-large pathological images have three characteristics. Firstly, each sample con-tains numerous blood vessels (Fig.1a). Secondly, each blood vessel usually has a variety of cells with similar appearances (Fig.1b). Thirdly, types of cancerous cells are also varied (Fig.1c). Therefore, diagnosis of MVI requires the profes-sional pathologist to discriminate cancerous/non-cancerous cells carefully, which is time-consuming and tedious. The discrimination relies on the individual pathologist’s prior knowledge, which is subjective and leads to misdiagnosis occasionally.
In recent years, deep learning has achieved promising results in many areas [28–30, 68–72], including medical image analysis. Many researchers focus on applying deep learning techniques to image-based tumor analysis tasks, such as tumor grading [3, 73], lesion area detection [14, 35], vessel segmentation [18,31], cell detection/segmentation [42, 54, 67, 75], etc. The successful application of deep learning relies on massive annotated samples. However, annotating cancerous cells of all MVI images is very time-consuming.
What’s more, the black-box characteristic of deep learning leads to unexplainable classification results, which limits the clinical application of deep learning based diagnostic methods.
In order to apply the deep learning technique to the MVI analysis task, we collect the first Pathologic Vessel Image
Dataset (PVID) containing healthy blood vessel samples and
MVI samples from the pathological image of liver cancer patients.
In this paper, we aim to develop an accurate, objective, and explainable method for MVI diagnosis with as few anno-tations as possible. As annotating the cell in each MVI vessel is time-consuming, we only adopt easily-obtained image-level category labels for developing the new approach.
For the explainable MVI classification, the developed ap-proach should provide credible evidence, such as cancerous areas and classification results. Therefore, the proposed ap-proach is devised to be composed of two branches: the binary classification branch and the cell locating branch. The binary classification branch is used to classify the healthy blood ves-sels and MVI vessels with corresponding vessel image-level category labels as supervision. The initial goal of the cell locating branch is to distinguish the cancerous cells. How-ever, the supervision information for the cell locating branch is insufficient, which requires exploring more supervision information from the characteristic of MVI itself.
Firstly, based on the characteristic of blood vessel sam-ples that most cells can be distributed into some similar templates according to structure and color, the correlation filter [9, 22], which is widely adopted in the object tracking area, can be used for locating most of the cells; hence the results of this filter can be interpreted as pseudo masks of cells for supervising the cell locating branch to distinguish cell area from the background. Secondly, the healthy vessel sample only containing non-cancerous cells and background is used for supervising the cell locating branch distinguishing healthy area (non-cancerous cells and background) from the cancerous cells. Lastly, we devise loopback strategy between the binary classification branch and cell locating branch to discover the cancerous area from each MVI sample.
For the loopback strategy, the cell locating branch first predicts the cancerous area of the MVI sample, then the can-cerous and non-cancerous areas of the same sample masked with the predicted results are input back into the classifi-cation branch separately. The devised a loopback strategy effectively achieves two goals: 1) utilizing the image-level category label to supervise the cell locating branch distin-guishing the cancerous area from other areas. 2) building the direct relation between the predicted cancerous areas and the final classification result.
Experiment results show that the loopback strategy not only enables the proposed framework to predict precious cancerous areas but also facilitate the classification branch achieve better classification performance. The two-branch framework with the loopback strategy, termed as Loopback
Network (LoopNet), achieves 97.5% accuracy on MVI clas-sification.
In conclusion, the main contributions of our work are summarized as follows:
• We propose the first deep learning based network, termed as LoopNet, for explainable MVI classifica-tion. LoopNet fully exploits the characteristics of MVI samples to achieve blood vessel classification and cell locating results simultaneously and can be extended to
MVI analysis tasks on various organs.
• The loopback strategy is devised for utilizing the cat-egory label to supervise LoopNet distinguishing the cancerous area from other regions, which effectively builds the direct relation between the located cancerous area and the final classification result.
• We collect the first Pathologic Vessel Image Dataset (PVID) containing 4130 healthy blood vessel samples and 857 MVI samples from the pathological image of 103 liver cancer patients.
• Experiment show that LoopNet achieves 97.5% accu-racy on PVID, which verifies the potential of deep learn-ing on MVI classification task. 2.