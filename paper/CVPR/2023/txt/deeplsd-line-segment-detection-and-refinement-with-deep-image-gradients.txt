Abstract
Line segments are ubiquitous in our human-made world and are increasingly used in vision tasks. They are com-plementary to feature points thanks to their spatial extent and the structural information they provide. Traditional line detectors based on the image gradient are extremely fast and accurate, but lack robustness in noisy images and chal-lenging conditions. Their learned counterparts are more repeatable and can handle challenging images, but at the cost of a lower accuracy and a bias towards wireframe lines.
We propose to combine traditional and learned approaches to get the best of both worlds: an accurate and robust line detector that can be trained in the wild without ground truth lines. Our new line segment detector, DeepLSD, processes images with a deep network to generate a line attraction field, before converting it to a surrogate image gradient magni-tude and angle, which is then fed to any existing handcrafted line detector. Additionally, we propose a new optimization tool to refine line segments based on the attraction field and vanishing points. This refinement improves the accuracy of current deep detectors by a large margin. We demonstrate the performance of our method on low-level line detection metrics, as well as on several downstream tasks using multi-ple challenging datasets. The source code and models are available at https://github.com/cvg/DeepLSD. 1.

Introduction
Line segments are ubiquitous in human-made environ-ments and encode the underlying scene structure in a com-pact way. As such, line features have been used in mul-tiple vision tasks: 3D reconstruction and Structure-from-Motion (SfM) [17, 32, 34], Simultaneous Localization and
Mapping [13, 15, 25, 37, 62], visual localization [14], track-ing [38], vanishing point estimation [49], etc. Thanks to their spatial extent and presence even in textureless areas, they offer a good complement to feature points [14, 15, 37].
All these applications require a robust and accurate de-tector to extract line features from images. Traditionally, line segments are extracted from the image gradient using
LSD [51]
HAWP [54]
Line distance field
Ours
Figure 1. Line detection in the wild. Top row: on challenging images, handcrafted methods such as LSD [51] suffer from noisy image gradients, while current learned methods like HAWP [54] were trained on wireframe images and generalize poorly. Bottom row: we combine deep learning to regress a line attraction field and a handcrafted detector to get both accurate and robust lines. handcrafted heuristics, such as in the Line Segment Detector (LSD) [51]. These methods are fast and very accurate since they rely on low-level details of the image. However, they can suffer from a lack of robustness in challenging condi-tions such as in low illumination, where the image gradient is noisy. They also miss global knowledge from the scene and will detect any set of pixels with the same gradient orientation, including uninteresting and noisy lines.
Recently, deep networks offer new possibilities to tackle these drawbacks. This resurgence of line detection methods was initiated by the deep wireframe methods aiming at in-ferring the line structure of indoor scenes [19, 30, 53, 54, 61].
Since then, more generic deep line segment detectors have been proposed [10, 16, 20, 28, 50], including joint line detec-tors and descriptors [1,36,56]. These methods can, in theory, be trained on challenging images and, thus, gain robustness where classical methods fail. As they require a large recep-tive field to be able to handle the extent of line segments in
an image, they can also encode some image context and can distinguish between noisy and relevant lines. On the other hand, most of these methods are fully supervised and there exists currently only a single dataset with ground truth lines, the Wireframe dataset [19]. Initially designed for wireframe parsing, this dataset is biased towards structural lines and is limited to indoor scenes. Therefore, it is not a suitable training set for generic line detectors, as illustrated in Fig-ure 1. Additionally, similarly as with feature points [31, 45], current deep detectors are lacking accuracy and are still out-performed by handcrafted methods on easy images. The exact localization of line endpoints is often hard to obtain, as lines can be fragmented and suffer from partial occlusion.
Many applications using lines consequently consider infinite lines and ignore the endpoints [34].
Based on this assessment, we propose in this work to keep the best of both worlds: use deep learning to process the image and discard unnecessary details, then use handcrafted methods to detect the line segments. We thus retain the benefits of deep learning, namely, to abstract the image and gain more robustness to illumination and noise, while at the same time retaining the accuracy of classical methods. We achieve this goal by following the tracks of two previous methods that used a dual representation of line segments with attraction fields [53, 54]. The latter are continuous representations that are well-suited for deep learning, and we show how to leverage them as input to the traditional line detectors. Contrary to these two previous methods, we do not rely on ground truth lines to train our line attraction field, but propose instead to bootstrap existing methods to create a high-quality pseudo ground truth. Thus, our network can be trained on any dataset and be specialized towards specific applications, which we show in our experiments.
We additionally propose a novel optimization procedure to refine the detected line segments. This refinement is based on the attraction field output by the proposed network, as well as on vanishing points, optimized together with the seg-ments. Not only can this optimization be used to effectively improve the accuracy of our prediction, but it can also be applied to other deep line detectors.
In summary, we propose the following contributions:
• We propose a method bootstrapping current detectors to create ground truth line attraction fields on any image.
• We introduce an optimization procedure that can simulta-neously refine line segments and vanishing points. This optimization can be used as a stand-alone refinement to improve the accuracy of any existing deep line detector.
• We set a new record in several downstream tasks requir-ing line segments by combining the robustness of deep learning approaches with the precision of handcrafted methods in a single pipeline. 2.