Abstract
Images taken in a low light condition with the pres-ence of camera shake suffer from motion blur and photon shot noise. While state-of-the-art image restoration net-works show promising results, they are largely limited to well-illuminated scenes and their performance drops sig-nificantly when photon shot noise is strong.
In this paper, we propose a new blur estimation tech-nique customized for photon-limited conditions. The pro-posed method employs a gradient-based backpropagation method to estimate the blur kernel. By modeling the blur kernel using a low-dimensional representation with the key points on the motion trajectory, we significantly re-duce the search space and improve the regularity of the kernel estimation problem. When plugged into an iter-ative framework, our novel low-dimensional representa-tion provides improved kernel estimates and hence signifi-cantly better deconvolution performance when compared to end-to-end trained neural networks. The source code and pretrained mdoels are available at https://github. com / sanghviyashiitb / structured - kernel -cvpr23 1.

Introduction
Photon-Limited Blind Deconvolution: This paper studies the photon-limited blind deconvolution problem.
Blind deconvolution refers to simultaneously recovering both the blur kernel and latent clean image from a blurred image and ”photon-limited” refers to presence of photon-shot noise in images taken in low-illumination / short expo-sure. The corresponding forward model is as follows: y = Poisson(αh ⊛ x). (1)
In this equation, y ∈ RN is the blurred-noisy image, x ∈
RN is the latent clean image, and h ∈ RM is the blur kernel.
We assume that x is normalized to [0, 1] and the entries of h are non-negative and sum up to 1. The constant α represents the average number of photons per pixel and is inversely proportional to the amount of Poisson noise.
Deep Iterative Kernel Estimation: Blind image de-convolution has been studied for decades with many suc-cessful algorithms including the latest deep neural networks
[8, 24, 34, 42, 43]. Arguably, the adaptation from the tradi-tional Gaussian noise model to the photon-limited Poisson noise model can be done by retraining the existing networks with appropriate data. However, the restoration is not guar-anteed to perform well because the end-to-end networks sel-dom explicitly take the forward image formation model into account.
Recently, people have started to recognize the impor-tance of blur kernel estimation for photon-limited condi-tions. One of these works is by Sanghvi et. al [30], where they propose an iterative kernel estimation method to back-propagate the gradient of an unsupervised reblurring func-tion, hence to update the blur kernel. However, as we can see in Figure 1, their performance is still limited when the photon shot noise is strong.
Structured Kernel Estimation: Inspired by [30], we believe that the iterative kernel estimation process and the unsupervised reblurring loss are useful. However, instead of searching for the kernel directly (which can easily lead to local minima because the search space is too big), we propose to search in a low-dimensional space by imposing structure to the motion blur kernel.
To construct such a low-dimensional space, we frame the blur kernel in terms of trajectory of the camera motion. Mo-tion trajectory is often a continuous but irregular path in the two-dimensional plane. To specify the trajectory, we intro-duce the concept of key point estimation where we identify a set of anchor points of the kernel. By interpolating the path along these anchor points, we can then reproduce the kernel. Since the number of anchor points is significantly lower than the number of pixels in a kernel, we can reduce the dimensionality of the kernel estimation problem.
The key contribution of this paper is as follows: We pro-pose a new kernel estimation method called Kernel Tra-jectory Network (KTN). KTN models the blur kernel in a low-dimensional and differentiable space by specifying key points of the motion trajectory. Plugging this low-dimensional representation in an iterative framework im-Blurred and Noisy
MPR-Net [42]
Sanghvi et. al [30]
Ours
Ground-Truth
Figure 1. The proposed Kernel Trajectory Network (KTN) on real noisy blurred image from Photon-Limited Deblurring Dataset (PLDD) [29] The result corresponding to MPR-Net was generated by retraining the network with GoPro dataset [24] corrupted by Poisson noise. The inset images for ”Sanghvi et. al” and ”Ours” represent the estimated kernel and the inset image for ”Ground-Truth” represents the kernel captured using a point source, as provided in PLDD. proves the regularity of the kernel estimation problem. This leads to substantially better blur kernel estimates in photon-limited regimes where existing methods fail. 2.