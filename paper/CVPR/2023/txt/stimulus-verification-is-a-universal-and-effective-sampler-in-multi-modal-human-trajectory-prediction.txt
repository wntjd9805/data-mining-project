Abstract
To comprehensively cover the uncertainty of the future, the common practice of multi-modal human trajectory pre-diction is to first generate a set/distribution of candidate fu-ture trajectories and then sample required numbers of tra-jectories from them as final predictions. Even though a large number of previous researches develop various strong models to predict candidate trajectories, how to effectively sample the final ones has not received much attention yet.
In this paper, we propose stimulus verification, serving as a universal and effective sampling process to improve the multi-modal prediction capability, where stimulus refers to the factor in the observation that may affect the future movements such as social interaction and scene context.
Stimulus verification introduces a probabilistic model, de-noted as stimulus verifier, to verify the coherence between a predicted future trajectory and its corresponding stimulus.
By highlighting prediction samples with better stimulus-coherence, stimulus verification ensures sampled trajecto-ries plausible from the stimulus’ point of view and there-fore aids in better multi-modal prediction performance. We implement stimulus verification on five representative pre-diction frameworks and conduct exhaustive experiments on three widely-used benchmarks. Superior results demon-strate the effectiveness of our approach. 1.

Introduction
Human trajectory prediction [3, 8, 9, 17, 35, 38, 39, 43] is a vital task towards autonomous driving systems and social robots, bridging the perception and decision mod-ules [4, 26, 27, 42]. Due to the fact that there is no single correct future, one of the most important aspects of trajec-tory prediction lies in multi-modal prediction, studying to
*contributed equally
§Cewu Lu is the corresponding author, the member of Qing Yuan Re-search Institute and MoE Key Lab of Artificial Intelligence, AI Institute,
Shanghai Jiao Tong University, China and Shanghai Qi Zhi institute.
Figure 1. (a) Multi-modal trajectory prediction pipeline, including two major components: base prediction model M and sampler Θ. (b) Examples of stimulus(context)-inconsistent trajectories sam-pled from a stimulus(context)-aware base prediction model, So-phie [33]. Predictions in red leads to impossible regions. cover multiple distinct future possibilities with finite pre-dictions. Specifically, for an observation, a set/distribution of candidate trajectories is first generated by a base predic-tion model, after which final ones of required number are sampled from the candidates, seeing Fig. 1-a.
To guarantee the performance of multi-modal trajectory prediction, countless efforts have been put into the design of prediction models in prior works using either gener-ative or classification frameworks. For generative ones, some popular architectures such as GAN [7], VAE [14] and Normalizing Flow [29] have been applied and im-proved in plenty of studies on multi-modal trajectory pre-diction [8, 23, 33, 34, 40]. In the meantime, impressive re-sults are also achieved with classification models such as
MultiPath [3] and PCCSNet [39]. Yet it is often neglected that an effective sampling strategy, which selects the ap-propriate trajectories from the collection of candidates, also has a great impact on the prediction performance. Typically, random or Monte-Carlo sampling is adopted as the default one. Only a handful of works [2, 22, 46] have studied on
sampling strategy, while they all seek to solve this prob-lem by searching better latent vectors for generative frame-works. Although they have achieved remarkable outcomes, the applications of such approaches are strongly limited as they are confined to generative frameworks only, ignoring the other mainstream frameworks, i.e. classification ones.
Besides, there are some factors in the observation that may influence the future movements. These factors, such as social interaction and scene context, are referred as stim-uli [32] and their significance of guiding accurate predic-tions has been proven in numerous researches [15, 25, 33, 34]. Although base frameworks can learn from stimu-lus information to generate candidate predictions, if such information is missing in the sampling process, out-of-distribution predictions are still highly probable to be sam-pled and harm the overall accuracy, as illustrated in Fig. 1-b.
To raise a universal sampler taking stimulus into con-sideration, in this paper, we propose an explicit sampling process called stimulus verification. It first verifies the co-herence between a candidate trajectory and its correspond-ing stimulus, and then samples highly stimulus-coherent ones as final results. Since the verification is an external process beyond the base prediction model, it can be uni-versally applied to any multi-modal prediction frameworks.
And meanwhile, stimulus information is successfully intro-duced, ensuring that the selected samples comply with the constrains of the involved stimuli.
Stimulus verification is built on a conditionally parame-terized probabilistic model optimized by Maximum Likeli-hood Estimation, namely stimulus verifier. By feeding the candidate trajectory along with its stimulus into the veri-fier, corresponding output likelihood reveals the trajectory-stimulus coherence, where a higher likelihood indicates bet-ter coherence. To this end, we can map the likelihood to a coherence score, which further serves as the basis to sample more stimulus-coherent predictions from a large group of trajectory candidates.
Our method is simple to implement for any base prediction framework in a plug-and-play manner. We implement our approach on five representative frame-works [8, 29, 33, 39, 43] and conduct exhaustive experi-ments on three widely-used trajectory prediction bench-marks, i.e. ETH [28]/UCY [16] Dataset, Grand Central Sta-tion Dataset [47] and NBA SportVU Dataset [20], to vali-date our approach. Superior results confirm the effective-ness of stimulus verification. 2.