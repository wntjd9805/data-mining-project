Abstract
Normalizing flows (NFs) provide a powerful tool to con-struct an expressive distribution by a sequence of trackable transformations of a base distribution and form a proba-bilistic model of underlying data. Rotation, as an important quantity in computer vision, graphics, and robotics, can ex-hibit many ambiguities when occlusion and symmetry oc-cur and thus demands such probabilistic models. Though much progress has been made for NFs in Euclidean space, there are no effective normalizing flows without discontinu-ity or many-to-one mapping tailored for SO(3) manifold.
Given the unique non-Euclidean properties of the rotation manifold, adapting the existing NFs to SO(3) manifold is non-trivial.
In this paper, we propose a novel normaliz-ing flow on SO(3) by combining a Mobius transformation-based coupling layer and a quaternion affine transforma-tion. With our proposed rotation normalizing flows, one can not only effectively express arbitrary distributions on
SO(3), but also conditionally build the target distribution given input observations. Extensive experiments show that our rotation normalizing flows significantly outperform the baselines on both unconditional and conditional tasks. 1.

Introduction
Endowing a neural network with the ability to express uncertainty along with the prediction is of crucial influence to safety and interpretability-critical systems and provides valuable information for downstream tasks [4, 19, 32]. As a widely used technique in computer vision and robotics, rotation regression can also benefit from such uncertainty-aware predictions and enable many applications [5, 14, 31].
To this end, recent years have witnessed much effort in modeling the uncertainty of rotation via probabilistic mod-eling of the SO(3) space, including von Mises distribu-tion for Euler angles [27], Bingham distribution for quater-*Equal contribution
â€ He Wang and Baoquan Chen are the corresponding authors ({hewang, baoquan}@pku.edu.cn). nions [6, 13], matrix Fisher distribution for rotation ma-trices [24], etc. Those distributions are all single-modal, which fall short on modeling objects with continuous sym-metry, which are ubiquitous in our daily life. Taking cup as an example, it exhibits rotational symmetry for which mod-eling with the unimodal or the mixture of distributions is clearly insufficient. How to model an arbitrary distribution on SO(3) manifold is still a challenging open problem.
Normalizing flows [28], which maps samples from a simple base distribution to the target distributions via in-vertible transformations, provides a flexible way to express complex distributions and has been widely used in express-ing arbitrary distributions in Euclidean space [1, 2, 7, 8, 16, 17]. However, developing normalizing flows on SO(3) manifold is still highly under-explored.
Some works rely on normalizing flows in Euclidean space and adapt them to handle rotations. ReLie [9] pro-poses normalizing flows for general Lie group via Lie alge-bra in Euclidean space. However, it suffers from discontin-uous rotation representations [37] and leads to inferior per-formance. ProHMR [18] considers rotations as 6D vectors in Euclidean space and leverages Glow [17] to model distri-butions, where a many-to-one Gram-Schmidt projection is needed to close the gap between the two spaces. Although composed of bijective transformations in Euclidean space, the many-to-one mapping from Euclidean space to SO(3) breaks the one-to-one regulation of normalizing flows [28].
Other works propose general normalizing flows for non-Euclidean spaces. Mathieu et al. [23], Lou et al. [21] and
Falorsi et al. [10] propose continuous normalizing flows for general Riemannian manifold, without considering any property of SO(3) space, which leads to unsatisfactory per-formance for probabilistic rotation modeling. Rezende et al.
[29] introduce normalizing flows on tori and spheres. Note that despite unit quaternions lying on S 3 space, [29] does not exhibit the antipodal symmetry property of quaternions and thus is not suitable for modeling rotations in SO(3).
In this work, we introduce novel discrete normalizing flows for rotations on the SO(3) manifold. The core build-ing block of our discrete rotation normalizing flow consists of a Mobius coupling layer with rotation matrix representa-tion and an affine transformation with quaternion represen-tation, linked by conversions between rotations and quater-nions. In the Mobius coupling layer, one column of the ro-tation matrix acts as the conditioner, remaining unchanged.
Another column serves as the transformer, undergoing Mo-bius transformation conditioned on the conditioner, while the remaining column is determined by the cross-product.
By combining multiple Mobius coupling layers, we en-hance the capacity of our vanilla design for rotation nor-malizing flows.
To further increase expressivity, we propose an affine transformation in quaternion space. This quaternion affine transformation complements the Mobius coupling layer, functioning as both a global rotation and a means for con-densing or dilating the local likelihood. Despite quaternions being a double coverage of the SO(3) manifold, this trans-formation remains bijective and diffeomorphic to SO(3).
We conduct extensive experiments to validate the ex-pressivity and stability of our proposed rotation normaliz-ing flows. The results show that our rotation normalizing flows are able to either effectively fit the target distributions on SO(3) with distinct shapes, or regress the target distri-bution given input image conditions. Our method achieves superior performance on both tasks over all the baselines. 2.