Abstract
In this work, we study few-shot domain adaptive ob-ject detection (FSDAOD), where only a few target labeled images are available for training in addition to sufficient source labeled images. Critically, in FSDAOD, the data scarcity in the target domain leads to an extreme data imbalance between the source and target domains, which potentially causes over-adaptation in traditional feature alignment. To address the data imbalance problem, we pro-pose an asymmetric adaptation paradigm, namely AsyFOD, which leverages the source and target instances from differ-ent perspectives. Specifically, by using target distribution estimation, the AsyFOD first identifies the target-similar source instances, which serves to augment the limited tar-get instances. Then, we conduct asynchronous alignment between target-dissimilar source instances and augmented target instances, which is simple yet effective for allevi-ating the over-adaptation. Extensive experiments demon-strate that the proposed AsyFOD outperforms all state-of-the-art methods on four FSDAOD benchmarks with var-ious environmental variances, e.g., 3.1% mAP improve-ment on Cityscapes-to-FoggyCityscapes and 2.9% mAP in-crease on Sim10k-to-Cityscapes. The code is available at https://github.com/Hlings/AsyFOD. 1.

Introduction
Object detection [4, 18, 47–50], which aims to localize and classify objects simultaneously, is widely used in real-world applications such as video surveillance [29,42,67,70] and autonomous driving [57, 69]. Unfortunately, detec-tors suffer a significant performance drop when deployed in an unseen domain due to the domain discrepancy between training and test data [36,37,43,63,66,68]. And usually, re-peatedly collecting a large amount of labeled data in new
* denotes the authors contributed equally to this work.
† denotes the corresponding author.
Figure 1. A few target instances are biased to represent the over-all target data distribution, i.e., many light orange target instances are not observed, as shown in the top left. And, the data scarcity in the target domain leads to a data imbalance between the source and target domains. Therefore, traditional symmetric adaptation (such as MMD [38, 40, 41, 56]) easily causes over-adaptation, i.e., the detector concentrates on a small area for observed target in-stances but ignores many other unobserved ones, as shown in the top right. By contrast, our proposed asymmetric adaptation alle-viates the over-adaptation via source instance division and asyn-chronous alignment. domains requires expensive labor and time cost.
In this work, we explore the Few-Shot Domain Adaptive Object
Detection (FSDAOD) [16, 61, 72], which attempts to gen-eralize detectors with minor cost. In addition to adequate labeled source images, the FSDAOD assumes that only a few (usually eight) labeled target images are available for adapting a detector in the target domain.
A critical challenge of the FSDAOD is the data scarcity in the target domain, which leads to an extreme data im-balance between the source and target domains. As shown in Figure 1, it is difficult to comprehensively describe the
overall target data distribution by only a few target in-stances. Usually, in standard unsupervised domain adap-tation [22, 24, 38, 53, 71, 73], alignment-based methods, e.g., Maximum Mean Discrepancy (MMD) [38, 40, 41, 56], conduct synchronous feature alignment to mitigate the do-main discrepancy, which is termed the symmetric adapta-tion paradigm in our work. However, without consideration of imbalanced distributions in FSDAOD, simply conduct-ing synchronous feature alignment easily causes the over-adaptation problem, i.e., the detector is prone to concentrate on limited observed target instances but hardly generalizes well on other unobserved ones [61]. Typically, existing FS-DAOD methods attempt to alleviate the imbalance problem by reusing the same target samples, which yet overlooks the leverage of source samples [61, 72].
To address the extreme data imbalance problem, in this work, we propose a novel asymmetric adaptation paradigm, named AsyFOD, which leverages the source and target in-stances from different perspectives. The AsyFOD first di-vides the source instance set into two parts, namely target-similar and target-dissimilar instance sets. Such a division strategy is inspired by an observation that, some source in-stances are visually similar to the target instances (see Fig-ure 5 for empirical verification). Accordingly, we identify the target-similar source instances by formulating a uni-fied discrepancy estimation function, which serves to aug-ment the limited target instances to alleviate the imbalanced amounts of data. The remaining source instances are re-garded as target-dissimilar after identifying target-similar source instances. To further alleviate the data imbalance between domains, we propose conducting asynchronous alignment between the target-dissimilar source instances and augmented target instances. Unlike traditional meth-ods, the AsyFOD aligns feature distributions in an asym-metric way, with a stop-gradient operation applied on target instance features when optimizing the detector. In this way, the proposed asynchronous alignment can better align the unobserved target samples.
The AsyFOD obtains the state-of-the-art performance on mitigating various types of domain discrepancy, such as background variations [9, 17], natural weather [54] and synthetic-to-real [1, 26, 35]. Also, the AsyFOD generalizes well on various few-shot settings of domain adaptive ob-ject detection, i.e., FSDAOD with weak or strong augmen-tation [16] and Few-Shot Unsupervised Domain Adaptive
Object Detection (FSUDAOD). 2.