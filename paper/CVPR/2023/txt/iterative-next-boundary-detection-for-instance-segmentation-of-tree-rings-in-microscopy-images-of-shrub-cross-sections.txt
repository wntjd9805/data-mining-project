Abstract
We address the problem of detecting tree rings in mi-croscopy images of shrub cross sections. This can be re-garded as a special case of the instance segmentation task with several unique challenges such as the concentric cir-cular ring shape of the objects and high precision require-ments that result in inadequate performance of existing methods.
We propose a new iterative method which we term Itera-tive Next Boundary Detection (INBD). It intuitively models the natural growth direction, starting from the center of the shrub cross section and detecting the next ring boundary in each iteration step. In our experiments, INBD shows supe-rior performance to generic instance segmentation methods and is the only one with a built-in notion of chronological order.
Our dataset and source code are available at http://github.com/alexander-g/INBD . 1.

Introduction
Dendrochronology is the science that provides method-ologies to date tree rings [4], i.e. measuring and assigning calendar years to the growth rings present in a wood stem.
By analyzing anatomical properties like ring widths or the cell sizes within the rings, dendrochronology can be ap-plied to dating archaeological manufactures, tracking tim-ber sources or reconstructing past climate conditions [11].
For climate reconstruction in the Arctic, shrubs consti-tute the most important source of dendrochronological in-formation, since they are the only woody plants able to thrive there [23]. As temperature is a limiting factor for shrub growth in the Arctic, it shows a strong relationship
Figure 1. Example microscopy images (left) of shrub cross sec-tions from our new dataset and the outputs (right) of our proposed method INBD for instance segmentation of tree rings with climate, making these plants a reliable proxy to recon-struct past climate events [24]. Dendrochronological analy-ses on shrubs are usually performed on thin cross sections of branches or roots and observed under the microscope with a magniﬁcation that allows ring identiﬁcation at a cellular level. As of now, ecological studies are limited in size by the amount of manual analysis work due to the lack of au-tomatic tree ring detection methods.
With this paper we want to introduce this problem to the
(a) High resolution and faint boundaries (b) High precision requirements (c) Wedging rings (d) Disconnected rings
Figure 2. Some of the challenges encountered in this task: (a) Boundaries inbetween tree rings are often hard to recognize. For example, this cross section contains 14 rings. (b) Crop of the previous image (indicated by the square) with overlayed annotation. A tree ring is only 65 pixels wide or ca 1.4% of the full cross section diameter. The cell wall that divides late summer cells and the next year’s early summer cells is only 5 pixels wide or 0.1%. (c) Wedging rings can complicate ﬁnding the chronologically correct next year ring. (d) Rings can grow in multiple disconnected parts from different sides. computer vision community and enhance the capabilities for ecological sciences. We release a new dataset containing high resolution microscopy images of shrub cross sections and propose a specialized method for growth ring identiﬁca-tion. Example images from our dataset and corresponding outputs of our method are shown in Figure 1. From a com-puter vision point of view, this can be regarded as a special case of the instance segmentation task, however it differs from previous generic datasets in several ways which makes existing methods underperform.
Figure 2 illustrates these differences. For one, the con-centric ring shape of the instances can pose a signiﬁcant obstacle, particularly for top-down methods because the ob-jects have almost identical bounding boxes. This gets com-plicated by the fact that year rings can also form incom-plete circles (wedging rings) and grow from only one side, or even in multiple disconnected parts from different sides (2d). Depending on the species, plant part and climatic con-ditions the amount of wedging rings can range from zero to being the majority. Assigning the correct order to wedging rings can be an issue where rings of more than 2 years touch each other (2c). Bottom-up methods on the other hand struggle with faint ring boundaries (2a) as the presence of the boundary pattern is not always constant throughout the whole stem circumference. They are prone to merging rings where no boundary can be detected or splitting them where the ring width is narrow. Next, the images are acquired at a high resolution (2a) to capture cellular information, yet a high degree of precision is required for the downstream task of assigning individual cells to the correct year. The thick-ness of a cell wall that is dividing the cells from one ring to another can be as low as 0.01% of the whole object (2b).
Finally, as the preparation of samples and annotation of the images is very costly, training has to be performed in a low data regime.
We argue that a specialized approach can help to over-come those challenges and propose a new iterative method which we term Iterative Next Boundary Detection (INBD).
In the ﬁrst step, it performs semantic segmentation to detect basic features such as the background, center and the ring boundary pixels. From this starting point, it iteratively de-tects the next year ring’s boundaries, following the natural growth of the plant. This process is augmented with a re-current wedging ring detection module to counteract issues with incomplete rings. We compare our method with both top-down and bottom-up generic instance segmentation in our experiments in which it shows better results. Moreover, it is the ﬁrst method that automatically assigns a chronolog-ical order to the detected objects.
The contributions of this paper can summarized as fol-lows:
• Publication of a new challenging dataset for a special case of instance segmentation.
• Development of the specialized method INBD for tree ring instance segmentation.
• Evaluation of previous generic instance segmentation methods and comparison with INBD 2.