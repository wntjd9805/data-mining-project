Abstract
Radiography imaging protocols focus on particular body therefore producing images of great similarity regions, and yielding recurrent anatomical structures across pa-tients. To exploit this structured information, we propose the use of Space-aware Memory Queues for In-painting and
Detecting anomalies from radiography images (abbreviated as SQUID). We show that SQUID can taxonomize the in-grained anatomical structures into recurrent patterns; and in the inference, it can identify anomalies (unseen/modiﬁed patterns) in the image. SQUID surpasses 13 state-of-the-art methods in unsupervised anomaly detection by at least 5 points on two chest X-ray benchmark datasets measured by the Area Under the Curve (AUC). Additionally, we have cre-ated a new dataset (DigitAnatomy), which synthesizes the spatial correlation and consistent shape in chest anatomy.
We hope DigitAnatomy can prompt the development, eval-uation, and interpretability of anomaly detection methods. 1.

Introduction
Vision tasks in photographic imaging and radiogra-phy imaging are different. For example, when identify-ing objects in photographic images, we assume translation invariance—a cat is a cat no matter if it appears on the left or right of the image. In radiography imaging, on the other hand, the relative location and orientation of a structure are important characteristics that allow the identiﬁcation of nor-mal anatomy and pathological conditions [20,83]. Since ra-diography imaging protocols assess patients in a fairly con-sistent orientation, the generated images have great similar-ity across various patients, equipment manufacturers, and facility locations (see examples in Figure 1d). The consis-tent and recurrent anatomy facilitates the analysis of numer-ous critical problems and should be considered a signiﬁcant advantage for radiography imaging [85]. Several investiga-*Corresponding author: Zongwei Zhou (zzhou82@jh.edu)
Figure 1. Anomaly detection in radiography images can be both easier and harder than in photographic images.
It is easier be-cause radiography images are spatially structured due to consistent imaging protocols. It is harder because anomalies in radiography images are subtle and require medical expertise to annotate. tions have demonstrated the value of this prior knowledge in enhancing Deep Nets’ performance by adding location fea-tures, modifying objective functions, and constraining co-ordinates relative to landmarks in images [3, 47, 49, 69, 86].
Our work seeks to answer this critical question: Can we exploit consistent anatomical patterns and their spatial in-formation to strengthen Deep Nets’ detection of anomalies from radiography images without manual annotation?
Unsupervised anomaly detection only uses healthy im-ages for model training and requires no other annotations such as disease diagnosis or localization [5]. As many as 80% of clinical errors occur when the radiologist misses the abnormality in the ﬁrst place [7]. The impact of anomaly detection is to reduce that 80% by clearly pointing out to ra-diologists that there exists a suspicious lesion and then hav-ing them look at the scan in depth. Unlike previous anomaly detection methods, we formulate the task as an in-painting task to exploit the anatomical consistency in appearance, position, and layout across radiography images. Specif-ically, we propose Space-aware Memory Queues for In-painting and Detecting anomalies from radiography images (abbreviated as SQUID). During training, our model can dynamically maintain a visual pattern dictionary by taxono-mizing recurrent anatomical patterns based on their spatial locations. Due to the consistency in anatomy, the same body region across healthy images is expected to express similar visual patterns, which makes the total number of unique pat-terns manageable. During inference, since anomaly patterns do not exist in the dictionary, the generated radiography im-age is expected to be unrealistic if an anomaly is present.
As a result, the model can identify the anomaly by discrim-inating the quality of the in-painting task. The success of anomaly detection has two basic assumptions [89]: ﬁrst, anomalies only occur rarely in the data; second, anomalies differ from the normal patterns signiﬁcantly.
We have conducted experiments on two large-scale, pub-licly available radiography imaging datasets. Our SQUID is signiﬁcantly superior to predominant methods in unsuper-vised anomaly detection by over 5 points on the ZhangLab dataset [32]; remarkably, we have demonstrated a 10-point improvement over 13 recent unsupervised anomaly detec-tion methods on the Stanford CheXpert dataset [29].
In addition, we have created a new dataset (DigitAnatomy) to elucidate spatial correlation and consistent shape of the chest anatomy in radiography (see Figure 1c). Digi-tAnatomy is dedicated to easing the development, eval-uation, and interpretability of anomaly detection methods.
The qualitative visualization clearly shows the superiority of our SQUID over the current state-of-the-art methods.
In summary, our contributions include: (I) the best per-forming unsupervised anomaly detection method for chest radiography imaging; (II) a synthetic dataset to promote anomaly detection research; (III) SQUID overcomes lim-itations in dominant unsupervised anomaly detection meth-ods [1, 17, 35, 61, 82] by inventing Space-aware Memory
Queue (§3.2), and Feature-level In-painting (§3.3). 2.