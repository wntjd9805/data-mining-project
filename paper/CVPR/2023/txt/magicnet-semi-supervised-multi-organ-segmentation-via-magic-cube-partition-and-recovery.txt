Abstract
We propose a novel teacher-student model for semi-supervised multi-organ segmentation.
In teacher-student model, data augmentation is usually adopted on unlabeled data to regularize the consistent training between teacher and student. We start from a key perspective that fixed rela-tive locations and variable sizes of different organs can pro-vide distribution information where a multi-organ CT scan is drawn. Thus, we treat the prior anatomy as a strong tool to guide the data augmentation and reduce the mismatch between labeled and unlabeled images for semi-supervised learning. More specifically, we propose a data augmen-tation strategy based on partition-and-recovery N3 cubes cross- and within- labeled and unlabeled images. Our strat-egy encourages unlabeled images to learn organ semantics in relative locations from the labeled images (cross-branch) and enhances the learning ability for small organs (within-branch). For within-branch, we further propose to refine the quality of pseudo labels by blending the learned representa-tions from small cubes to incorporate local attributes. Our method is termed as MagicNet, since it treats the CT vol-ume as a magic-cube and N3-cube partition-and-recovery process matches with the rule of playing a magic-cube. Ex-tensive experiments on two public CT multi-organ datasets demonstrate the effectiveness of MagicNet, and noticeably outperforms state-of-the-art semi-supervised medical im-age segmentation approaches, with +7% DSC improve-ment on MACT dataset with 10% labeled images. Code is avaiable at https://github.com/DeepMed-Lab-ECNU/MagicNet. 1.

Introduction
Abdominal multi-organ segmentation in CT images is an essential task in many clinical applications such as
*Corresponding Author.
Figure 1. Two data augmentation strategies in MagicNet. Left:
Although labeled and unlabeled images are not aligned, the lat-ter can be regarded as a shifted version of the former. Co-shift of cubes transfers organ semantics in relative locations from the labeled data to unlabeled data. Right: Segmenting small organs from original images are difficult due to the cluttered background.
Small cubes mitigate the impact from background and focus more on local attributes. computer-aided intervention [25, 33]. But, training an ac-curate multi-organ segmentation model usually requires a large amount of labeled data, whose acquisition process is time-consuming and expensive. Semi-supervised learn-ing (SSL) has shown great potential to handle the scarcity of data annotations, which attempts to transfer mass prior knowledge learned from the labeled to unlabeled images.
SSL attracts more and more attention in the field of medical image analysis in recent years.
Popular SSL medical image segmentation methods mainly focus on segmenting a single target or targets in a local region, such as segmenting pancreas or left atrium
[4, 9, 14, 15, 18, 23, 31, 35, 38, 39]. Multi-organ segmenta-tion is more challenging than single organ segmentation, due to the complex anatomical structures of the organs, e.g., the fixed relative locations (duodenum is always lo-cated at the head of the pancreas), the appearances of dif-ferent organs, and the large variations of the size. Transfer-ring current SSL medical segmentation methods to multi-organ segmentation encounters severe problems. Multiple organs introduce much more variance compared with a sin-gle organ. Although labeled and unlabeled images are al-ways drawn from the same distribution, due to the limited number of labeled images, it’s hard to estimate the precise distribution from them [32]. Thus, the estimated distribu-tion between labeled and unlabeled images always suffers from mismatch problems, and is even largely increased by multiple organs. Aforementioned SSL medical segmenta-tion methods lack the ability to handle such a large distri-bution gap, which requires sophisticated anatomical struc-ture modeling. A few semi-supervised multi-organ segmen-tation methods have been proposed, DMPCT [43] designs a co-training strategy to mine consensus information from multiple views of a CT scan. UMCT [36] further proposes an uncertainty estimation of each view to improve the qual-ity of the pseudo-label. Though these methods take the advantages of multi-view properties in a CT scan, they in-evitably ignore the internal anatomical structures of multi-ple organs, resulting in suboptimal results.
Teacher-student model is a widely adopted framework for semi-supervised medical image segmentation [28]. Stu-dent network takes labeled images and unlabeled strongly augmented images as input, which attempts to minimize the distribution mismatch between labeled and unlabeled images from the model level. That is, data augmentation is adopted on unlabeled data, whose role is to regularize the consistent training between teacher and student. As mentioned, semi-supervised multi-organ segmentation suf-fers from large distribution alignment mismatch between labeled and unlabeled images. Reducing the mismatch mainly from the model level is insufficient to solve the prob-lem. Thanks to the prior anatomical knowledge from CT scans, which provides the distribution information where a multi-organ CT scan is drawn, it is possible to largely alle-viate the mismatch problem from the data level.
To this end, we propose a novel teacher-student model, called MagicNet, matching with the rule of playing a magic-cube. More specifically, we propose a partition-and-recovery N 3 cubes learning paradigm: (1) We partition each CT scan, termed as magic-cube, into N 3 small cubes. (2) Two data augmentation strategies are then designed, as
I.e., First, to encourage unlabeled data shown in Fig. 1. to learn organ semantics in relative locations from the la-beled data, small cubes are mixed across labeled and un-labeled images while keeping their relative locations. Sec-ond, to enhance the learning ability for small organs, small cubes are shuffled and fed into the student network. (3)
We recover the magic-cube to form the original 3D geom-etry to map with the ground-truth or the supervisory signal from teacher. Furthermore, the quality of pseudo labels pre-dicted by teacher network is refined by blending with the learned representation of the small cubes. The cube-wise pseudo-label blending strategy incorporates local attributes e.g., texture, luster and boundary smoothness which miti-gates the inferior performance of small organs.
The main contributions can be summarized as follows:
• We propose a data augmentation strategy based on partition-and-recovery N 3 cubes cross- and within- la-beled and unlabeled images which encourages unla-beled images to learn organ semantics in relative loca-tions from the labeled images and enhances the learn-ing ability for small organs.
• We propose to correct the original pseudo-label by cube-wise pseudo-label blending via incorporating crucial local attributes for identifying targets especially small organs.
• We verify the effectiveness of our method on BTCV
[13] and MACT [11] datasets. The segmentation per-formance of our method exceeds all state-of-the-arts by a large margin, with 7.28% (10% labeled) and 6.94% (30% labeled) improvement on two datasets re-spectively (with V-Net as the backbone) in DSC. 2.