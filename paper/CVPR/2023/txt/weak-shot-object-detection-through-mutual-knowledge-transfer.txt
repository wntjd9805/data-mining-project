Abstract
Weak-shot Object Detection methods exploit a fully-annotated source dataset to facilitate the detection perfor-mance on the target dataset which only contains image-level labels for novel categories. To bridge the gap be-tween these two datasets, we aim to transfer the object knowledge between the source (S) and target (T) datasets in a bi-directional manner. We propose a novel Knowledge
Transfer (KT) loss which simultaneously distills the knowl-edge of objectness and class entropy from a proposal gen-erator trained on the S dataset to optimize a multiple in-stance learning module on the T dataset. By jointly opti-mizing the classification loss and the proposed KT loss, the multiple instance learning module effectively learns to clas-sify object proposals into novel categories in the T dataset with the transferred knowledge from base categories in the
S dataset. Noticing the predicted boxes on the T dataset can be regarded as an extension for the original annotations on the S dataset to refine the proposal generator in return, we further propose a novel Consistency Filtering (CF) method to reliably remove inaccurate pseudo labels by evaluating the stability of the multiple instance learning module upon noise injections. Via mutually transferring knowledge be-tween the S and T datasets in an iterative manner, the de-tection performance on the target dataset is significantly im-proved. Extensive experiments on public benchmarks vali-date that the proposed method performs favourably against the state-of-the-art methods without increasing the model parameters or inference computational complexity. 1.

Introduction
Recent rapid development of supervised object detection models [17, 20, 22, 23] largely relies on massive human-annotated bounding boxes and category labels. Since ob-taining these annotations, especially the bounding boxes, are expensive and time-consuming on large-scale datasets, it motivates the researches of alternative algorithms with
*Equal contribution.
â€ Corresponding author.
Figure 1. Overview of the proposed Mutual Knowledge Transfer scheme for the weak-shot object detection task. less annotation cost. Weakly Supervised Object Detection (WSOD) methods [1,8,12,13,24,26,34] only require image-level object category labels to train an object detector on a target dataset. Though the annotation cost is consider-ably reduced, a prominent performance gap exists between
WSOD and full-supervised models.
While noticing class-invariant visual evidence can be transferred from base categories to unseen ones [14, 30], researches [3, 15, 18, 32, 36] show that the WSOD perfor-mance can be further improved by utilizing an additional source dataset with fully annotated data. This learning paradigm is referred to as the Weak-shot Object Detection (WSHOD) [21], for which a widely adopted model archi-tecture is the combination of a proposal generator (PG) trained on the source (S) dataset and a multiple instance learning (MIL) module trained on the target (T) dataset.
The S dataset contains both object category and bounding box annotations, while the T dataset has only image-level category labels and the object categories are not overlapped with those in the S dataset.
Although a well-trained PG on a full-annotated S dataset can assist the training of the MIL module on the T dataset, it is still essential to bridge the gap between these two datasets for handling non-overlapping categories. Previous efforts to address this issue mainly focus on transferring the knowledge about base categories from the S dataset to the T dataset by post-processing the predicted boxes [15] or designing various transferring scores [18, 32]. Zhong et al. [36] constrain the training of the MIL module by an ob-jectness regularization loss. Unfortunately, this loss tends to exacerbate the classification ambiguity of novel cate-gories since it enlarges multiple class probabilities for the same proposal (see details in Sec. 3.2). Some researches also adopt the predicted boxes on the T dataset as pseudo labels to refine the training of the PG module. The pre-dicted boxes can be directly used as pseudo labels with con-fidence thresholding [36], adjusted by confidence maps [3], or softly weighted [21]. However, these practices are lim-ited in discriminating inaccurate pseudo labels in the T dataset. For example, the intra-class feature variance can be significant, especially for the novel categories, which makes weighting these pseudo labels upon feature similar-ity [21] fail in discriminating inliers from outliers. More-over, it is not exploited in previous works to incorporate the
MIL module into discriminating inaccurate pseudo labels, which enables the knowledge transfer from the T dataset to
S dataset.
To address the aforementioned issues in narrowing the gap between the S and T datasets, we design the Mutual
Knowledge Transfer scheme for the WSHOD task, as illus-trated in Fig. 1. Within this scheme, a novel Knowledge
Transfer (KT) loss performs knowledge transfer from the S dataset to T dataset by constraining the training of the MIL module. In contrast to the regularization loss in [36], our
KT loss enforces the predicted objectness score and class entropy of the MIL module to be consistent with the pre-dictions of the PG, which helps to transfer the knowledge from S dataset to facilitate the training of the MIL module.
Through mathematical analysis, we reveal that the formu-lation of KT loss intrinsically alleviates the class ambiguity issue of the regularization loss in [36].
Furthermore, we propose a novel and statistically robust
Consistency Filtering (CF) method to improve the quality of the pseudo labels and boost knowledge transfer from the T dataset to S dataset. The intuition is that, by inject-ing noises into random regions in the feature maps of the predicted boxes1, inaccurate boxes tend to be less stable in maintaining the original predictions than accurate ones. In-accurate boxes usually only cover the most discriminative object fragment, which is a commonly addressed challenge in previous works [18,21], so the corresponding probability distribution of novel categories probably becomes uncertain when the designed noises are injected into the features of the MIL module. In contrast, accurate boxes usually con-tain the entire object and tend to be more stable against the injected feature noises. A detailed statistical verification for this intuition can be found in Tab. 7. We thus discover the inaccurate pseudo labels by evaluating the stability of the
MIL outputs when varying noises are injected. The pro-posed CF method essentially takes advantage of the object knowledge of the MIL module regarding the discrimina-tion of novel categories and transfers it to the PG module through refinement training with filtered pseudo labels.
By using the mutual knowledge transfer scheme itera-tively, the detection performance on the T dataset with novel categories can be greatly improved. Through theoretical analysis and extensive experiments, we demonstrate that the proposed method significantly outperforms previous state-of-the-art WSHOD methods without increasing the model parameters or inference computational complexity. 2.