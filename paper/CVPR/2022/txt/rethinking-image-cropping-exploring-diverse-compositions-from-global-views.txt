Abstract
Existing image cropping works mainly use anchor evalu-ation methods or coordinate regression methods. However, it is difficult for pre-defined anchors to cover good crops globally, and the regression methods ignore the cropping diversity.
In this paper, we regard image cropping as a set prediction problem. A set of crops regressed from mul-tiple learnable anchors is matched with the labeled good crops, and a classifier is trained using the matching results to select a valid subset from all the predictions. This new perspective equips our model with globality and diversity, mitigating the shortcomings but inherit the strengthens of previous methods. Despite the advantages, the set predic-tion method causes inconsistency between the validity la-bels and the crops. To deal with this problem, we propose to smooth the validity labels with two different methods. The first method that uses crop qualities as direct guidance is designed for the datasets with nearly dense quality labels.
The second method based on the self distillation can be used in sparsely labeled datasets. Experimental results on the public datasets show the merits of our approach over state-of-the-art counterparts. 1.

Introduction
Image cropping has been widely used to improve im-age composition. Automatic image cropping is devel-oped to make the technique friendly to amateurs and non-specialists. Previous works [3, 7, 26, 31, 47] usually merge the expert knowledge such as the “Rule of Thirds” into the models to guide the cropping. Such methods enable inter-pretability of the cropping process but are weak in learning sophisticated features.
In recent years, many data-driven approaches built upon deep CNNs have been proposed.
These methods are roughly categorized into anchor evalu-ation methods [4, 17, 20, 37–40, 43, 44] and coordinate re-*corresponding author
Figure 1. A diagram of different image cropping models. The an-chor evaluation model (top left) can output diverse crops from pre-defined anchors, but these anchors cannot encompass good crops globally. The coordinate regression model (top right) crops from global image, but just outputs one good crop and ignores the others (e.g. the box with red dashed line). Our model (bottom) combines their strengths and overcomes their weaknesses, leading to diverse crops from global views. gression methods [8, 11, 14–16, 24]. The former assigns quality scores to the pre-defined anchors. The latter directly regresses the coordinates of one crop on the input images.
The anchor evaluation methods show the merits of generat-ing diverse good crops. As shown in the top-left of Fig. 1, users can select an arbitrary number of crops according to the evaluated scores. But most anchor generation rules can-not search the cropping spaces globally, resulting in the pos-sible omission of good crops. On the contrary, coordinate regression methods use a global view to cover all possibil-ities. But they only predict one crop from an image, which is insufficient for most images as shown in the top-right of
Fig. 1. Besides, learning one best crop may cause ambiguity
because it potentially assumes other crops are all bad.
In summary, cropping images is like picking fruits from a fruitful tree. Anchor evaluation methods give us many fruits to select (Diversity), but they only search part of the branches. Coordinate regression methods check every twigs (Globality) but only pick one fruit. Naturally, a question should be asked: Can we combine the different advantages of the two methods to achieve both the Diversity and the
Globality? Inspired by the recently developed object detec-tion models [2], we provide a new perspective by regard-ing image cropping as a set prediction problem. The core components of our set prediction model are the learnable anchors and the bipartite matching. Specifically, we ran-domly initialize a set of learnable anchors. After absorbing useful information from the input image features through a transformer model, these anchors are used to regress crops directly. To address the inequality between the pre-defined anchor number and the labeled good crop number, we em-ploy the Hungarian algorithm to perform bipartite match-ing. According to the matching results, a classifier is trained to judge whether an anchor is valid. In short, the direct co-ordinate regression enables Globality and the multiple an-chors with validity classification help to achieve Diversity.
This framework successfully combines the different advan-tages of the anchor-based models and the regression mod-els, as shown in the bottom of Fig. 1.
Despite the great advantages, a ghost of inconsistency hides between the regressed crops and the validity labels.
According to the bipartite matching results, we assign hard labels v = 0 for the unmatched crops. Such a hard va-lidity label forces the model to treat all the invalid crops equally, while these invalid crops fall into a wide qual-ity range. The contradiction between the hard labels and the complex crop qualities causes inconsistency, which is harmful to the model training. To cope with this problem, we employ two different label smoothing methods to make the validity labels better reflect the crop qualities. The first method uses quality scores to guide the smoothing. The qualities of the invalid crops are estimated according to the local redundancy property [43] in the nearly dense labeled dataset. The second method employs self distillation [10] when the dense labels are unavailable considering the model itself has the potentials to learn knowledge about crop qual-ity. The estimated validity probabilities are used to generate soft labels. We finally conduct sufficient experiments using various evaluation metrics on four datasets to validate the effectiveness of the proposed method. Our main contribu-tions are as summarized as follows.
• We rethink image cropping from the perspective of both globality and diversity: delving into all possibili-ties to find all good compositions.
• We regard image cropping as a set prediction problem, where multiple regressed crops with a validity classi-fier are used to match diverse good crops. This enables the globality and diversity.
• Two different label smoothing methods are developed into the set prediction method to deal with the incon-sistency problem between the crops and validity labels.
• Extensive experiments are conducted to evaluate our model. The comparative experiments and the ablation study results prove the effectiveness of our model. 2.