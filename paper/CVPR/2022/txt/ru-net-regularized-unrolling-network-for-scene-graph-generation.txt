Abstract
Scene graph generation (SGG) aims to detect objects and predict the relationships between each pair of objects.
Existing SGG methods usually suffer from several issues, including 1) ambiguous object representations, as graph neural network-based message passing (GMP) modules are typically sensitive to spurious inter-node correlations, and 2) low diversity in relationship predictions due to severe class imbalance and a large number of missing annotations.
To address both problems, in this paper, we propose a regu-larized unrolling network (RU-Net). We ﬁrst study the rela-tion between GMP and graph Laplacian denoising (GLD) from the perspective of the unrolling technique, determining that GMP can be formulated as a solver for GLD. Based on this observation, we propose an unrolled message pass-ing module and introduce an (cid:2)p-based graph regularization to suppress spurious connections between nodes. Second, we propose a group diversity enhancement module that pro-motes the prediction diversity of relationships via rank max-imization. Systematic experiments demonstrate that RU-Net is effective under a variety of settings and metrics. Fur-thermore, RU-Net achieves new state-of-the-arts on three popular databases: VG, VRD, and OI. Code is available at https://github.com/siml3/RU-Net. 1.

Introduction
Scene Graph Generation (SGG) aims to provide a graph-ical representation of objects and their relationships in an image. Recently, SGG has emerged as a promising ap-proach that bridges the gap between vision and natural lan-guage domains. It has been found to be useful for many vi-sion tasks, including 3D scene understanding [2, 40], visual question answering [8, 32], and image captioning [12, 58].
A scene graph comprises a collection of triplets in the
*Work done during ﬁrst author’s internship at JD Explore Academy.
†Corresponding author.
Message Passing man man beach surfboard 0 0.6 0.4 0.9 0 0.1 0.5 0.5 0 surfboard
Attention Map beach (a) Ambiguous node representations.    on non-rel. others 1 2 5 4 6 2 1 3 man1-on-street1 man2-standing on-street1 man3-sitting on-street1 man4-on-street2 man5-walking on-street2 man6-lying on-street2 0.2 0.6 0.4 0.6 0.5 0.3 0.4 0.7 0.3 0.4 0.1 0.2 0.1 0.1 0.1 0.2 0.5 0.3 (b) Lack of diversity in relationship prediction.
Figure 1. (a) Spurious correlation between nodes causes ambigu-ous representations through graph neural network-based message passing. (b) Relationship prediction for the same category of node pairs lacks diversity. Missing relationship annotations are under-lined and highlighted in gray. Best viewed in color. form subject-relationship-object. The objects and their pair-wise relationships are denoted as nodes and edges, respec-tively. Existing SGG models [6, 19, 22, 39, 46, 47, 60] typ-ically utilize context modeling strategies to learn discrimi-native representations for node and edge prediction; speciﬁ-cally, most of them adopt graph neural network-based mes-In GMP, node repre-sage passing (GMP) mechanisms. sentations are iteratively updated through the aggregation of neighboring information according to learnable attention weights, which are typically supervised by node labels.
However, current GMPs are negatively impacted by spu-rious correlations between nodes. Here, a spurious correla-tion refers to a relatively large attention weight between a pair of semantically disparate nodes. These spurious corre-lations frequently occur, as attention weights between spa-tially proximate nodes tend to be large regardless of whether their object categories are related. In Figure 1(a), it is evi-dent that the attention weights for the surfboard are domi-nated by those for the man (i.e., equal to 0.9). As a result, the quality of representations for some nodes may degrade after erroneous message passing. Moreover, relationship prediction diversity among existing SGG models tends to be low. This is mainly due to the long-tailed distribution of relationships and a large number of missing relationship
annotations. As shown in Figure 1(b), the two images con-tain six triplets related to the man-street pair; however, only two of them are annotated, and the relationship categories are both on. The trained SGG models, therefore, tend to make biased predictions for the majority classes and the non-relationship category.
To address the above issues, we propose a regularized unrolling network (RU-Net) for SGG. First, we study the re-lation between GMP and graph Laplacian denoising (GLD)
[33] from the perspective of the unrolling technique [29].
We show that 1) GMP can be formulated as the solver for
GLD, and 2) the quadratic penalty widely adopted in the formulation of GLD is sensitive to outliers (e.g., spurious correlations between nodes). As an alternative, we propose an unrolled message passing (U-MP) module and employ an (cid:2)p-based graph regularization term to suppress these spu-rious connections between nodes, thereby effectively reduc-ing the ambiguity in node representations. Moreover, we determine that the optimization of the (cid:2)p-based graph regu-larization can be efﬁciently achieved in an end-to-end man-ner by integrating a reweighting matrix into U-MP, which accounts for the semantic dissimilarity between nodes.
Second, we introduce a group diversity enhancement (GDE) module to promote the diversity of relationship pre-dictions for both labeled and unlabeled samples. More speciﬁcally, since score vectors for relationships tend to be linearly independent when predicted as different categories, we formulate the optimization of relationship prediction di-versity as a rank maximization problem. Because rank max-imization is NP-hard [36], we use the (cid:2)2,1-norm to approx-imate the matrix rank. We also divide the large matrix into several smaller ones, each of which contains relationship predictions for node pairs of the same object categories. By enlarging the (cid:2)2,1-norm of the smaller matrices, the rela-tionship prediction diversity is more effectively optimized, as demonstrated in Section 4.3.
In summary, the contributions of this study are three fold: (1) a novel unrolling framework that interprets GMP as a solver for the GLD problem; (2) the U-MP module for spuriousness-robust message passing via an (cid:2)p-based graph regularization, which enhances GMP’s robustness against spurious connections between nodes; and (3) the GDE mod-ule, which improves the diversity of relationship prediction via the group-wise (cid:2)2,1-based regularization term. The efﬁ-cacy of the proposed RU-Net is systematically evaluated on three popular SGG databases: Visual Genome (VG) [16],
OpenImages (OI) [17], and Visual Relationship Detection (VRD) [25]. Experimental results show that our RU-Net consistently outperforms state-of-the-art methods. 2.