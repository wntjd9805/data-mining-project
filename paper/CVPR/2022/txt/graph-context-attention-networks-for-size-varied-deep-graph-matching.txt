Abstract
Deep learning for graph matching has received growing interest and developed rapidly in the past decade. Although recent deep graph matching methods have shown excellent performance on matching between graphs of equal size in the computer vision area, the size-varied graph matching problem, where the number of keypoints in the images of the same category may vary due to occlusion, is still an open and challenging problem. To tackle this, we firstly propose to formulate the combinatorial problem of graph matching as an Integer Linear Programming (ILP) problem, which is more flexible and efficient to facilitate comparing graphs of varied sizes. A novel Graph-context Attention Network (GCAN), which jointly capture intrinsic graph structure and cross-graph information for improving the discrimination of node features, is then proposed and trained to resolve this ILP problem with node correspondence supervision.
We further show that the proposed GCAN model is efficient to resolve the graph-level matching problem and is able to automatically learn node-to-node similarity via graph-level matching. The proposed approach is evaluated on three public keypoint-matching datasets and one graph-matching dataset for blood vessel patterns, with experimental results showing its superior performance over existing state-of-the-art algorithms for keypoint and graph-level matching. 1.

Introduction
Graph matching, which involves establishing correspon-dences of nodes between graph-structured data, has a wide range of real-world applications, such as objective keypoint matching [1], vein pattern matching [2] and 2D/3D shape matching [3]. Graph matching is a well-known general NP-hard problem, and is often formulated as a quadratic assign-ment problem (QAP) [4].
Recently, deep learning based graph matching meth-ods have demonstrated superior performance over tradi-tional methods. Research in deep graph matching typi-cally focuses on two parts: developing graph embedding networks and resolving combinatorial problems. Generally, approaches to deep graph matching firstly involve extract-ing node features from a deep convolutional neural network (CNN). Since nodes with similar deep CNN features are dif-ficult to distinguish, a graph embedding network is designed to model and refine node features, which is expected to cap-ture intrinsic graph structure and cross-graph information for improving node differentiation. Driven by the popular graph convolutional neural networks (GCN) [5], GCNs and their variants are widely used as graph embedding methods
[6–9]. In recent years, transformer based model [10–13], which use the attention mechanism to capture the relation-ships between different words or between different image portions, has received more attention due to their superior performance over traditional CNN models. Inspired by this, we propose a novel Graph-context Attention Network to jointly capture the relationships of nodes inside a graph and node-to-node relationships between graphs.
In terms of the combinatorial problem, recent works formulate it as
Lawler’s quadratic assignment programming (QAP) prob-lem [7, 14] or Koopmans-Beckmann’s QAP problem [6, 9].
These approaches regard the node-to-node correspondence problem as a binary classification task. The combinato-rial problem is typically tackled by performing the Hungar-ian algorithm on a square matrix of predicted classification scores. However these methods assume that the nodes V2 in graph G2 include all nodes V1 in graph G1, i.e. V1 ⊆ V2.
If V2 contain some outliers that are invisible in V1, [7, 14] suggest adding dummy nodes to allow these outliers can be assigned in the Hungarian Algorithm. However, in a more general case, matching graphs may contain differ-ent numbers of nodes and the number of outliers in both graphs are unknown during testing. We observe that the
Hungarian algorithm has difficulty in handling such size-varied graphs matching problem. Furthermore, the above mentioned methods require node correspondence supervi-sion, in this paper we also explore graph matching without node-level labeling.
Our main contributions are summarized as follows: 1. To handle more general and more challenging graph
matching problems with sized-varied graphs, we propose to formulate the combinatorial problem as an Integer Linear
Programming problem. 2. To obtain more distinguishable node features, We present a novel Graph-context Attention Network with at-tention mechanism, to capture and model intrinsic graph structure and cross-graph information. 3. We demonstrate that our network can be trained in either a supervised way, which is the typical approach to such problems and requires ground-truth node-to-node cor-respondence, or in a novel unsupervised way.
In the su-pervised case, we show improved accuracy over the state-of-the-art using our ILP attention loss. In the unsupervised case, we avoid the typical requirement of manually-labelled node correspondence by enabling our network to learn the node-to-node similarity by reasoning on graph-level match-ing. 4. We evaluate the proposed approach on both size-equal and size-varied keypoint matching tasks with three public keypoint-matching datasets, and on a graph-level matching task with a vessel graph dataset. Our experimental results demonstrate that the proposed approach outperforms cur-rent state-of-the-art methods for all tasks. We also present an ablation study, which shows the effectiveness of each component of the proposed approach. 2.