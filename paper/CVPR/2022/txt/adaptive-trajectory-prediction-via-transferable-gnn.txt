Abstract
Pedestrian trajectory prediction is an essential compo-nent in a wide range of AI applications such as autonomous driving and robotics. Existing methods usually assume the training and testing motions follow the same pattern while ignoring the potential distribution differences (e.g., shop-ping mall and street). This issue results in inevitable per-formance decrease. To address this issue, we propose a novel Transferable Graph Neural Network (T-GNN) frame-work, which jointly conducts trajectory prediction as well as domain alignment in a uniﬁed framework. Speciﬁcally, a domain-invariant GNN is proposed to explore the structural motion knowledge where the domain-speciﬁc knowledge is reduced. Moreover, an attention-based adaptive knowl-edge learning module is further proposed to explore ﬁne-grained individual-level feature representations for knowl-edge transfer. By this way, disparities across different tra-jectory domains will be better alleviated. More challeng-ing while practical trajectory prediction experiments are designed, and the experimental results verify the superior performance of our proposed model. To the best of our knowledge, our work is the pioneer which ﬁlls the gap in benchmarks and techniques for practical pedestrian trajec-tory prediction across different domains.
Source Trajectory
Target Trajectory
Figure 1. An example that reveals the limitation of original learn-ing strategy. These two frames are extracted from two different scenes and there is a huge difference between these trajectories.
Metric
Trajectory Domains
E-D
S-D
ETH HOTEL UNIV ZARA1 ZARA2
NoS
NoP
AN
AV (m/s)
AA (m/s2) 70 181 2.586 0.437 0.131 301 1053 3.498 0.178 0.06 947 24334 25.696 0.205 0.035 602 2253 3.743 0.369 0.039 921 5833 6.333 0.206 0.026 877 24153 23.11 0.259 0.105 383.63 10073.07 9.78 0.11 0.04
Table 1. Statistics of ﬁve different scenes, ETH, HOTEL, UNIV,
ZARA1, and ZARA2. NoS denotes the number of sequences to be predicted, NoP denotes the number of pedestrians, AN denotes the average number of pedestrians in each sequence, AV denotes the average velocity of pedestrians in each sequence, and AA denotes the average acceleration of pedestrians in each sequence. E-D rep-resents Extreme Deviation and S-D represents Standard Deviation. 1.

Introduction
Trajectory prediction aims to predict the future trajec-tory seconds to even a minute prior from a given trajec-tory history. It plays an indispensable role in a large num-ber of real world applications such as autonomous driving, robotics, navigation, video surveillance, and so on. In self-driving scenario, accurate pedestrian trajectory prediction is essential for planning [3, 42], decision making [81], en-vironmental perception [52, 64], person identiﬁcation [40], and anomaly detection [50, 78]. Trajectory prediction is a challenging task. For instance, strangers tend to walk alone trying to avoid collisions but friends tend to walk as a group [49]. In addition, pedestrians can interact with sur-rounding objects or other pedestrians, while such interac-tion is too complex and subtle to quantify. To consider such interactions, a pooling layer is designed in work Social-LSTM [1] to pass the interaction information among pedes-trians, and then a long short-term memory (LSTM) network is applied to predict future trajectories. Following this pat-tern, many methods [24, 38, 75, 82, 86] have been proposed for sharing information via different mechanisms, i.e., at-tention mechanism or similarity measure. Instead of pre-dicting one determined future trajectory, some generative adversarial network-based (GAN) [11, 16, 21, 35, 56] and encoder-decoder-based methods [7–9, 47, 58, 59, 74] have been proposed to generate multiple feasible trajectories.
However, these existing methods usually focus on learn-ing a generic motion pattern while ignoring the potential distribution differences between the training and testing samples. We argue that this learning strategy has some lim-itations. Fig. 1 illustrates one basic concept. It is obvious that the trajectories of walking pedestrians in different tra-jectory domains are different, the trajectory in the left ﬁgure is stable but the trajectory in the right ﬁgure is much more tortuous. The original strategy is to learn these two samples together without considering distribution differences, which introduces domain-bias and disparities into the model.
In order to quantitatively and objectively evaluate the po-tential domain gaps, Tab. 1 gives ﬁve numerical statistics of
ﬁve commonly used trajectory domains. We can observe that the number of pedestrians in UNIV is much larger than that in ETH, and the differences among ﬁve trajectory do-mains are signiﬁcant. As for pedestrian moving pattern, pedestrians in ETH have the largest average moving veloc-ity, which is nearly three times larger than that in HOTEL.
In addition, pedestrians in ETH also have the largest aver-age moving acceleration, which is nearly ﬁve times larger than that in ZARA2. The E-D value and S-D value also reveal the huge differences among ﬁve different trajectory domains. This situation is general and always exists in prac-tical applications. For example, in vision applications, cam-eras located in different cities/corners could lead to signif-icant distribution gap. Similar situations are also common in robot navigation or autonomous driving-related applica-tions since the environments are constantly changing.
To further demonstrate this challenge, we apply three state-of-the-art methods, Social-STGCNN [48],
SGCN [60], Tra2Tra [74] to demonstrate the performance drop when it comes to different trajectory domains. We take ETH as the example, these models are trained on the validation set of ETH and evaluated on the standard testing set of ETH. Note that there is no overlap trajectory sam-ple between the training and testing set, but the distribu-tions of them can be regarded as consistent. We refer to this evaluation setting as “consistent setting” and the per-formance under this new protocol as “updated ADE” and
“updated FDE”. Fig. 2 shows the updated ADE/FDE as well as the original ADE/FDE reported in their papers. The performance drops are signiﬁcant which further reveal the domain-bias problem in the original leave-one-out setting.
Domain adaptation (DA) is a subcategory of transfer learning which aims to address the domain shift issue. The basic idea is to minimize the distance of distributions of source and target domains via some distance measures, such as maximum mean discrepancy (MMD) [39, 51], correla-tion alignment distance (CORAL) [61, 87], and adversarial loss [17, 71]. Among these methods, the feature dimension of one sample is ﬁxed in both source and target domain.
On the contrary, a “sample” in our task is a combination of multiple trajectories with different pedestrians, which has (cid:51)(cid:72)(cid:85)(cid:73)(cid:82)(cid:85)(cid:80)(cid:68)(cid:81)(cid:70)(cid:72)(cid:3)(cid:39)(cid:85)(cid:82)(cid:83)(cid:3)(cid:82)(cid:81)(cid:3)(cid:55)(cid:85)(cid:68)(cid:77)(cid:72)(cid:70)(cid:87)(cid:82)(cid:85)(cid:92)(cid:3)(cid:39)(cid:82)(cid:80)(cid:68)(cid:76)(cid:81)(cid:3)(cid:40)(cid:55)(cid:43)
Figure 2. Performance comparison of three state-of-the-art meth-ods under the original leave-one-out setting and the consistent set-ting. The performance drops of all three models are signiﬁcant. not only global domain shift but also internal correlations.
Therefore, directly utilizing the general feature representa-tion of one “sample” results in the lack of crucial individual-level ﬁne-grained features. Consequently, the most popular domain adaptation approaches are not applicable here.
In this work, we delve into the trajectory domain shift problem and propose a transferable graph neural network via adaptive knowledge learning. Speciﬁcally, we propose a novel attention-based adaptive knowledge learning mod-ule for trajectory-to-trajectory domain adaptation. In addi-tion, a novel trajectory graph neural network is presented.
It is able to extract comprehensive spatial-temporal features of pedestrians that enhance the domain-invariant knowledge learning. The contributions of our work are summarized as,
• We delve into the domain shift problem across differ-ent trajectory domains and propose a uniﬁed T-GNN method for jointly predicting future trajectories and adaptively learning domain-invariant knowledge.
• We propose a speciﬁcally designed graph neural net-work for extracting comprehensive spatial-temporal feature representations. We also develop an effec-tive attention-based adaptive knowledge learning mod-ule to explore ﬁne-grained individual-level transfer-able feature representations for domain adaptation.
• We introduce a brand new setting for pedestrian trajec-tory prediction problem, which is meaningful in real practice. We set up strong baselines for pedestrian tra-jectory prediction under this domain-shift setting.
• Experiments on ﬁve trajectory domains verify the con-sistent and superior performance of our method.
As it is natural to use a graph-based model to represent the topology of social networks, recent methods [26, 36, 48, 60, 62, 69] employ graph neural networks as their back-bones. Different from these methods, the graph neural net-work we employed is simple yet speciﬁcally designed not only to extract effective spatial-temporal features but also to be suitable for domain-invariant knowledge learning.
2.