Abstract
In this paper, we consider a highly general image recog-nition setting wherein, given a labelled and unlabelled set of images, the task is to categorize all images in the un-labelled set. Here, the unlabelled images may come from labelled classes or from novel ones. Existing recognition methods are not able to deal with this setting, because they make several restrictive assumptions, such as the un-labelled instances only coming from known – or unknown – classes, and the number of unknown classes being known a-priori. We address the more unconstrained setting, nam-ing it ‘Generalized Category Discovery’, and challenge all these assumptions. We ﬁrst establish strong baselines by taking state-of-the-art algorithms from novel category dis-covery and adapting them for this task. Next, we pro-pose the use of vision transformers with contrastive rep-resentation learning for this open-world setting. We then introduce a simple yet effective semi-supervised k-means method to cluster the unlabelled data into seen and un-seen classes automatically, substantially outperforming the baselines. Finally, we also propose a new approach to esti-mate the number of classes in the unlabelled data. We thor-oughly evaluate our approach on public datasets for generic object classiﬁcation and on ﬁne-grained datasets, lever-aging the recent Semantic Shift Benchmark suite. Code: https://www.robots.ox.ac.uk/⇠vgg/research/gcd 1.

Introduction
Consider an infant sitting in a car and observing the world. Object instances will pass the car and, for some of these, the infant may have been told their category (‘that is a dog’, ‘that is a car’) and be able to recognize them.
There will also be instances that the infant has not seen be-fore (cats and bicycles) and, having seen a number of these instances, we might expect the infant’s visual recognition system to cluster these into new categories.
This is the problem that we consider in this work: given an image dataset where only some images are labelled with their categories, assign a category label to each of the rest    
images, possibly using new categories not observed in the labelled set. We term this problem Generalized Category
Discovery (GCD), and suggest that this is a realistic use case for many machine vision applications: whether that is rec-ognizing products in a supermarket; pathologies in medical images; or vehicles in autonomous driving.
In these and other realistic vision settings, it is often impossible to know if new images come from labelled or novel categories.
In contrast, consider the limitations of existing image recognition settings.
In image classiﬁcation, one of the most widely studied problems, all of the training images come with class labels. Furthermore, all images at test time come from the same classes as the training set. Semi-supervised learning (SSL) [7] introduces the problem of learning from unlabelled data, but still assumes that all un-labelled images come from the same set of classes as the labelled ones. More recently, the tasks of open-set recogni-tion (OSR) [38] and novel-category discovery (NCD) [19] have tackled open-world settings in which the images at test time may belong to new classes. However, OSR aims only to detect test-time images which do not belong to one of the classes in the labelled set, but does not require any fur-ther classiﬁcation amongst these detected images. Mean-while, in NCD, the closest setting to the one tackled in this work, methods learn from labelled and unlabelled images, and aim to discover new classes in the unlabelled set. How-ever, NCD still makes the limiting assumption that all of the unlabelled images come from new categories, which is usually unrealistic.
In this paper, we tackle Generalized Category Discovery in a number of ways. Firstly, we establish strong baselines by taking representative methods from NCD and applying them to this task. To do this, we adapt their training and in-ference mechanisms to account for our more general setting, as well as retrain them with a more robust backbone archi-tecture. We show that existing NCD methods are prone to overﬁt the labelled classes in this generalized setting.
Next, observing the potential for NCD methods to over-ﬁt their classiﬁcation heads to the labelled classes, we pro-pose a simple but effective method for recognition by clus-tering. Our key insight is to leverage the strong ‘near-est neighbour’ classiﬁcation property of vision transform-ers along with contrastive learning. We propose the use of contrastive training and a semi-supervised k-means clus-tering algorithm to recognize images without a parametric classiﬁer. We show that these proposed methods substan-tially outperform the established baselines, both on generic object recognition datasets and, particularly, on more chal-lenging ﬁne-grained benchmarks. For the latter evaluations, we leverage the recently proposed Semantic Shift Bench-mark suite [45], which was designed for the task of identi-fying semantic novelty.
Finally, we propose a solution to a challenging and under-investigated problem in image recognition: estimat-ing the number of categories in unlabelled data. Almost all methods, including purely unsupervised ones, assume the knowledge of the number of categories, a highly unrealis-tic assumption in the real world. We propose an algorithm which leverages the labelled set to tackle this problem.
Our contributions can be summarized as follows: (i) the formalization of Generalized Category Discovery (GCD), a new and realistic setting for image recognition; (ii) the es-tablishment of strong baselines by adapting state-of-the-art techniques from standard novel category discovery to this task; (iii) a simple but effective method for GCD, which uses contrastive representation learning and clustering to di-rectly provide class labels, and outperforms the baselines substantially; (iv) a novel method for estimating the num-ber of categories in unlabelled data, a largely understud-ied problem; and (v) rigorous evaluation on standard im-age recognition datasets as well as the recent Semantic Shift
Benchmark suite [45]. 2.