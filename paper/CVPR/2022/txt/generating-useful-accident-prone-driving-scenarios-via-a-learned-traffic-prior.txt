Abstract
Evaluating and improving planning for autonomous ve-hicles requires scalable generation of long-tail traffic sce-narios. To be useful, these scenarios must be realistic and challenging, but not impossible to drive through safely. In this work, we introduce STRIVE, a method to automatically generate challenging scenarios that cause a given plan-ner to produce undesirable behavior, like collisions. To maintain scenario plausibility, the key idea is to leverage a learned model of traffic motion in the form of a graph-based conditional VAE. Scenario generation is formulated as an optimization in the latent space of this traffic model, per-turbing an initial real-world scene to produce trajectories that collide with a given planner. A subsequent optimization is used to find a “solution” to the scenario, ensuring it is useful to improve the given planner. Further analysis clus-ters generated scenarios based on collision type. We attack two planners and show that STRIVE successfully generates realistic, challenging scenarios in both cases. We addition-ally “close the loop” and use these scenarios to optimize hyperparameters of a rule-based planner. 1.

Introduction
The safety of contemporary autonomous vehicles (AVs) is defined by their ability to safely handle complicated near-collision scenarios. However, these kinds of scenarios are rare in real-world driving, posing a data-scarcity problem that is detrimental to both the development and testing of data-driven models for perception, prediction, and planning.
Moreover, the better models become, the more rare these events will be, making the models even harder to train.
A natural solution is to synthesize difficult scenarios in simulation, rather than relying on real-world data, making it easier and safer to evaluate and train AV systems. This ap-proach is especially appealing for planning, where the ap-pearance domain gap is not a concern. For example, one can manually design scenarios where the AV may fail by inserting adversarial actors or modifying trajectories, either from scratch or by perturbing a small set of real scenarios.
Unfortunately, the manual nature of this approach quickly
Figure 1. STRIVE generates challenging scenarios for a given planner.
An adversarial optimization perturbs a real-world scene in the latent space of a learned traffic model, causing an adversary (red) to collide with the planner (green). A subsequent solution optimization finds a planner tra-jectory to avoid collisions, verifying a scenario is useful for identifying planner improvements. becomes prohibitively expensive when a large set of scenar-ios is necessary for training or comprehensive evaluation.
Recent work looks to automatically generate challeng-ing scenarios [1, 11, 12, 26, 36, 50, 53]. Generally, these ap-proaches control a single or small group of “adversaries” in a scene, define an objective (e.g. cause a collision with the
AV), and then optimize the adversaries’ behavior or trajec-tories to meet the objective. While most methods demon-strate generation of only 1 or 2 scenarios [1, 8, 26, 36], re-cent work [53] has improved scalability by starting from real-world traffic scenes and perturbing a limited set of pre-chosen adversaries. However, these approaches lack expres-sive priors over plausible traffic motion, which limits the realism and diversity of scenarios. In particular, adversarial entities in a scenario are a small set of agents heuristically chosen ahead of time; surrounding traffic will not be re-active and therefore perturbations must be careful to avoid implausible situations (e.g. collisions with auxiliary agents).
Furthermore, less attention has been given to determining if
a scenario is “unsolvable” [18], i.e., if even an oracle AV is incapable of avoiding a collision. In this degenerate case, the scenario is not useful for evaluating/training a planner.
In this work, we introduce STRIVE – a method for gen-erating challenging scenarios to Stress-Test dRIVE a given
AV system. STRIVE attacks the prediction, planning, and control subset of the AV stack, which we collectively re-fer to as the planner. As shown in Fig. 1, our approach perturbs an initial real-world scene through an optimization procedure to cause a collision between an arbitrary adver-sary and a given planner. Our core idea is to measure the plausibility of a scenario during optimization by its likeli-hood under a learned generative model of traffic motion, which encourages scenarios to be challenging, yet realistic.
As a result, STRIVE does not choose specific adversaries ahead of time, rather it jointly optimizes all scene agents, enabling a diverse set of scenarios to arise. Moreover, in or-der to accommodate for non-differentiable (or inaccessible) planners, which are widely used in practice, the proposed optimization uses a differentiable proxy representation of the planner within the learned motion model, thus allowing standard gradient-based optimization to be used.
We propose to identify and characterize generated sce-narios that are useful for improving a given planner. We first search for a “solution” to generated scenarios to determine if they are degenerate, and then cluster solvable scenarios based on collision properties. We test STRIVE on two AV planners, including a new rule-based planner, and show that it generates plausible and diverse collision scenarios in both cases. We additionally use generated scenarios to improve the rule-based planner by identifying fundamental limita-tions of its design and tuning hyperparameters.
In short, our contributions are: (i) a method to automat-ically generate plausible challenging scenarios for a given planner, (ii) a solution optimization to ensure scenario util-ity, and (iii) an analysis method to cluster scenarios by colli-sion type. Supplementary videos and material for this work are available on the project webpage. 2.