Abstract
Deep image inpainting can inpaint a corrupted image using a feed-forward inference, but still fails to handle large missing area or complex semantics. Recently, GAN inver-sion based inpainting methods propose to leverage seman-tic information in pretrained generator (e.g., StyleGAN) to solve the above issues. Different from feed-forward meth-ods, they seek for a closest latent code to the corrupted image and feed it to a pretrained generator. However, in-ferring the latent code is either time-consuming or inaccu-rate. In this paper, we develop a dual-path inpainting net-work with inversion path and feed-forward path, in which inversion path provides auxiliary information to help feed-forward path. We also design a novel deformable fusion module to align the feature maps in two paths. Experiments on FFHQ and LSUN demonstrate that our method is effec-tive in solving the aforementioned problems while produc-ing more realistic results than state-of-the-art methods. 1.

Introduction
Image inpainting [3] aims to fill the semantically appro-priate and visually faithful contents in the missing regions of corrupted images. Numerous applications such as image editing, missing region repairing in image/video, and object removing benefit from the advance of image inpainting.
In recent years, deep neural networks have brought breakthroughs in image inpainting. Most deep inpainting methods [8,16,18,20,22,24,28–31] are single feed-forward methods. As shown in Figure 1 (a), they usually train a convolutional neural network with adversarial training and inpaint the corrupted image by feed-forward inference. Al-though great progress has been achieved in inpainting qual-ity and speed compared with conventional methods, they still fail to process images with large missing areas or gen-erate the results with good semantics [12,25]. As an alterna-*Corresponding author.
Illustration of four types of inpainting methods. (a)
Figure 1.
Feed-forward inpainting method. (b) Optimization-based GAN inversion inpainting method. [25] (c) Learning-based GAN inver-sion inpainting method. [12] (d) Ours. The modules marked in orange are optimized during training. tive, GAN inversion [23] inpainting methods [12,25], which are rarely studied, have shown promising results for solv-ing the above problems. They usually utilize a pretrained generative model (e.g., StyleGAN [9, 10] and BigGAN [4]) to provide semantic prior. Differing from feed-forward in-painting methods, they first seek for the closest latent code in the latent space (input to the pretrained generator) for the corrupted image and then invert the latent code back to a complete image using the pretrained generator. There are two strategies to obtain the latent code: optimization-based strategy [25] and learning-based strategy [12]. For optimization-based strategy (see Figure 1(b)), optimization algorithm is adopted to iteratively update the latent code z which minimizes the reconstruction loss between generated image Ig and ground truth Igt. For learning-based strat-egy (see Figure 1(c)), instead of directly optimizing the la-tent code z, an encoder network is used to infer the latent
code z based on the masked image Im. With extra semantic prior from the pretrained generative model, GAN inversion inpainting methods are not restricted to limited information when processing large missing scenarios. Nevertheless, two drawbacks of GAN inversion methods limit their applica-tions. Specifically, optimization-based strategy [25] suffers from long inference time. Learning-based strategy [12] has mediocre restoration results because a single inference can hardly find the accurate latent code compared with multiple inferences in optimization-based strategy.
Considering the advantages and drawbacks of feed-forward inpainting methods and GAN inversion inpainting methods, we attempt to apply GAN inversion inpainting to assist feed-forward inpainting. As shown in Figure 1 (d) and detailed in Figure 2, we propose a hybrid inpainting framework which consists of two paths: feed-forward path and inversion path. In the inversion path, we search in the latent space to find a latent code whose inverted image has the closest distance to the observed region in the corrupted image. To maintain the efficiency of inference, we adopt learning-based strategy to infer the latent code using an en-coder. To guarantee the inpainting quality, we do not di-rectly use the results from the inversion path. Instead, we transfer useful knowledge from pretrained GAN in the in-version path to the feed-forward path. In the feed-forward path, we use auto-encoder network to inpaint the corrupted image, during which multi-scale features from the inversion path are integrated into the decoder. Besides, there may ex-ist misalignment issue (shown in Figure 9) when fusing the features from two paths, so we propose a novel deformable fusion module in the generator to align the features from two paths. In this way, we alleviate the severe issues in in-version inpainting method and use its rich semantic knowl-edge to promote feed-forward inpainting method. Experi-ments on three datasets show that our method is superior to the state-of-the-art approaches. In summary, the main con-tributions of our work are summarized as follows,
• We propose a hybrid dual-path inpainting framework which assists in feed-forward inpainting with GAN in-version;
• We propose a novel deformable fusion module in the generator to solve the misalignment issue when fusing the features from two paths;
• Extensive experiments prove that our method can pro-duce more semantically reasonable and high-fidelity results than other state-of-the-art methods. 2.