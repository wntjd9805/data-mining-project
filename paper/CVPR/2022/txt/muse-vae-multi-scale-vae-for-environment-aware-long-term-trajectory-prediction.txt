Abstract
Accurate long-term trajectory prediction in complex scenes, where multiple agents (e.g., pedestrians or vehi-cles) interact with each other and the environment while at-tempting to accomplish diverse and often unknown goals, is a challenging stochastic forecasting problem.
In this work, we propose MUSE-VAE, a new probabilistic model-ing framework based on a cascade of Conditional VAEs, which tackles the long-term, uncertain trajectory prediction task using a coarse-to-ﬁne multi-factor forecasting archi-tecture. In its Macro stage, the model learns a joint pixel-space representation of two key factors, the underlying en-vironment and the agent movements, to predict the long and short term motion goals. Conditioned on them, the Micro stage learns a ﬁne-grained spatio-temporal representation for the prediction of individual agent trajectories. The VAE backbones across the two stages make it possible to nat-urally account for the joint uncertainty at both levels of granularity. As a result, MUSE-VAE offers diverse and si-multaneously more accurate predictions compared to the current state-of-the-art. We demonstrate these assertions through a comprehensive set of experiments on nuScenes and SDD benchmarks as well as PFSD, a new synthetic dataset, which challenges the forecasting ability of models on complex agent-environment interaction scenarios. 1.

Introduction
Human behavior forecasting is an essential problem studied in various research ﬁelds such as computer vi-sion [14], computer graphics [15], robotics [10], and cog-nitive science [44]. The fundamental problem with predict-ing human motion is the inherent stochasticity stemming from the fact that human beings use numerous sources of information to make a wide variety of different decisions at any given moment, which all impact their future movement. (a) Intermediate Short-term goals (b) Full trajectories
Figure 1. (a) The predicted trajectory heatmaps are overlaid in the semantic map. Ground Truth (GT) long-term goal (LG) and short-(b) Complete term goals (SG1 and SG2) are marked with ‘x’. trajectory forecasting based on the predicted LG and SG. Each sequence of trajectories is obtained from a different pair of LG and SG predictions.
This movement uncertainty translates beyond the motion of the humans alone to the movement of objects controlled by humans, such as vehicles [6].
To embrace the uncertainty, in this paper, we focus on developing computational models, learned from data, that can predict a realistic multi-modal distribution of the future agent (humans, vehicles, etc.) trajectories. The models are designed in the context of two main factors that drive this uncertainty: the environment the agents occupy and the task they are attempting to accomplish.
However, direct forecasting of long-term trajectories is a challenging task. A person typically plans one’s move-ment in a coarse-to-ﬁne fashion: with a ﬁnal destina-tion in mind, through a sequence of intermediate goals or way-points, the movement is executed to reach those sub-goals [8, 34]. State-of-the-Art (SOTA) methods [25, 43, 46] leverage this intuition to propose goal-conditioned predic-tion model. However, despite their effectiveness compared to traditional approaches [1,14,42], these models show lim-ited ability to deal with complex environments [43], par-ticularly as they affect the movement [46]. This often re-sults in physically implausible trajectory predictions that violate agent-environment collision constraints. Moreover, the models frequently struggle to account for the diversity of the forecast goals and trajectories [25], which are driven by the uncertain, multi-modal nature of the problem.
To address this, we propose MUSE-VAE: a multi-scale, environment-aware model for long-term trajectory predic-tion which (1) takes a stage-wise, coarse-to-ﬁne approach to trajectory prediction by predicting both the higher-level goals and the goal-conditioned trajectory, (2) avoids col-lision with obstacles without loss of spatial signal which can occur due to spatial reorganization when compressing 2D information into 1D features, and (3) learns a multi-modal predictive distribution across the stages, thus captur-ing the inherent uncertainty. MUSE-VAE embodies a three-step learning strategy across a Macro-stage and Micro-stage. The Macro-stage comprises of two steps for coarse predictions. We ﬁrst predict the long-term goal, i.e., the last step of the given sequence based on heatmap trajec-tory representation. Given the long-term goal, sequential short-term goals are predicted as shown in Fig. 1a. After getting the goal positions in the Macro-stages, ﬁnally, our model produces the full trajectories in the Micro-stage as in Fig. 1b. Our main contributions are as follows: (a) We introduce a novel multi-scale learning strategy for CVAE-based probabilistic models in order to make environment-aware collision-free trajectory predictions. (b) Unlike the prior works, we show that one can learn trajectory distribu-tions that can be well generalized in new scenes at test time, giving various reasonable predictions compliant to the en-vironment without needing extra steps for diversity. (c) The proposed coarse-to-ﬁne approach enables diverse and accu-rate trajectory predictions by forecasting the heading of the entire trajectories through goal prediction and then expand-ing it to granular and complete predictions.
We demonstrate these contributions through experiments on both real and synthetic dataset. With various grounded evaluation metrics, we show that MUSE-VAE can produce predictions similar to GT trajectories while achieving less collision with the environment than the SOTA methods. 2.