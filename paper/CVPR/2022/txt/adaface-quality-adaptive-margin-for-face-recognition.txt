Abstract
Recognition in low quality face datasets is challenging because facial attributes are obscured and degraded. Ad-vances in margin-based loss functions have resulted in en-hanced discriminability of faces in the embedding space.
Further, previous studies have studied the effect of adap-tive losses to assign more importance to misclassified (hard) examples.
In this work, we introduce another aspect of adaptiveness in the loss function, namely the image quality.
We argue that the strategy to emphasize misclassified sam-ples should be adjusted according to their image quality.
Specifically, the relative importance of easy or hard sam-ples should be based on the sample’s image quality. We propose a new loss function that emphasizes samples of dif-ferent difficulties based on their image quality. Our method achieves this in the form of an adaptive margin function by approximating the image quality with feature norms. Ex-tensive experiments show that our method, AdaFace, im-proves the face recognition performance over the state-of-the-art (SoTA) on four datasets (IJB-B, IJB-C, IJB-S and
TinyFace). Code and models are released in Supp. 1.

Introduction
Image quality is a combination of attributes that indicates how faithfully an image captures the original scene [28].
Factors that affect the image quality include brightness, contrast, sharpness, noise, color constancy, resolution, tone reproduction, etc. Face images, the focus of this paper, can be captured under a variety of settings for lighting, pose and facial expression, and sometimes under extreme visual changes such as a subject’s age or make-up. These param-eter settings make the recognition task difficult for learned face recognition (FR) models. Still, the task is achievable in the sense that humans or models can often recognize faces under these difficult settings [33]. However, when a face image is of low quality, depending on the degree, the recog-nition task becomes infeasible. Fig. 1 shows examples of both high quality and low quality face images. It is not pos-sible to recognize the subjects in the last column of Fig. 1.
Figure 1. Examples of face images with different qualities and recognizabilities. Both high and low quality images contain vari-ations in pose, occlusion and resolution that sometimes make the recognition task difficult, yet achievable. Depending on the degree of degradation, some images may become impossible to recognize.
By studying the different impacts these images have in training, this work aims to design a novel loss function that is adaptive to a sample’s recognizability, driven by its image quality.
Low quality images like the bottom row of Fig. 1 are increasingly becoming an important part of face recogni-tion datasets because they are encountered in surveillance videos and drone footage. Given that SoTA FR meth-ods [4, 5, 13, 17] are able to obtain over 98% verification accuracy in relatively high quality datasets such as LFW or
CFP-FP [11,27], recent FR challenges have moved to lower quality datasets such as IJB-B, IJB-C and IJB-S [14,22,37].
Although the challenge is to attain high accuracy on low quality datasets, most popular training datasets still remain comprised of high quality images [4, 8]. Since only a small portion of training data is low quality, it is important to properly leverage it during training.
One problem with low quality face images is that they tend to be unrecognizable. When the image degradation is too large, the relevant identity information vanishes from the image, resulting in unidentifiable images. These uniden-tifiable images are detrimental to the training procedure since a model will try to exploit other visual characteris-tics, such as clothing color or image resolution, to lower the training loss. If these images are dominant in the distribu-tion of low quality images, the model is likely to perform poorly on low quality datasets during testing.
Figure 2. Conventional margin based softmax loss vs our AdaFace. (a) A FR training pipeline with a margin based softmax loss. The loss function takes the margin function to induce smaller intra-class variations. Some examples are SphereFace, CosFace and ArcFace [4,20,35]. (b) Proposed adaptive margin function (AdaFace) that is adjusted based on the image quality indicator. If the image quality is indicated to be low, the loss function emphasizes easy samples (thereby avoiding unidentifiable images). Otherwise, the loss emphasizes hard samples.
Motivated by the presence of unidentifiable facial im-ages, we would like to design a loss function which assigns different importance to samples of different difficulties ac-cording to the image quality. We aim to emphasize hard samples for the high quality images and easy samples for low quality images. Typically, assigning different impor-tance to different difficulties of samples is done by look-ing at the training progression (curriculum learning) [1,13].
Yet, we show that the sample importance should be adjusted by looking at both the difficulty and the image quality.
The reason why importance should be set differently ac-cording to the image quality is that naively emphasizing hard samples always puts a strong emphasis on unidenti-fiable images. This is because one can only make a random guess about unidentifiable images and thus, they are always in the hard sample group. There are challenges in introduc-ing image quality into the objective. This is because image quality is a term that is hard to quantify due to its broad definition and scaling samples based on the difficulty often introduces ad-hoc procedures that are heuristic in nature.
In this work, we present a loss function to achieve the above goal in a seamless way. We find that 1) feature norm can be a good proxy for the image quality, and 2) various margin functions amount to assigning different importance to different difficulties of samples. These two findings are combined in a unified loss function, AdaFace, that adap-tively changes the margin function to assign different im-portance to different difficulties of samples, based on the image quality (see Fig. 2).
In summary, the contributions of this paper include:
• We propose a loss function, AdaFace, that assigns differ-ent importance to different difficulties of samples accord-ing to their image quality. By incorporating image qual-ity, we avoid emphasizing unidentifiable images while fo-cusing on hard yet recognizable samples.
• We show that the angular margin scales the learning sig-nal (gradient) based on the training sample’s difficulty.
This observation motivates us to change margin function adaptively to emphasize hard samples if the image qual-ity is high, and ignore very hard samples (unidentifiable images) if the image quality is low.
• We demonstrate that feature norms can serve as the proxy of image quality. It bypasses the need for an additional module to estimate image quality. Thus, adaptive margin function is achieved without additional complexity.
• We verify the efficacy of the proposed method by exten-sive evaluations on 9 datasets (LFW, CFP-FP, CPLFW,
AgeDB, CALFW, IJB-B, IJB-C, IJB-S and TinyFace) of various qualities. We show that the recognition perfor-mance on low quality datasets can be hugely increased while maintaining performance on high quality datasets. 2.