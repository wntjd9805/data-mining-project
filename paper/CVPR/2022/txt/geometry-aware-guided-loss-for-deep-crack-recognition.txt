Abstract
Despite the substantial progress of deep models for crack recognition, due to the inconsistent cracks in varying sizes, shapes, and noisy background textures, there still lacks the discriminative power of the deeply learned features when supervised by the cross-entropy loss. In this paper, we pro-pose the geometry-aware guided loss (GAGL) that enhances the discrimination ability and is only applied in the train-ing stage without extra computation and memory during in-ference. The GAGL consists of the feature-based geometry-aware projected gradient descent method (FGA-PGD) that approximates the geometric distances of the features to the class boundaries, and the geometry-aware update rule that learns an anchor of each class as the approximation of the feature expected to have the largest geometric distance to the corresponding class boundary. Then the discriminative power can be enhanced by minimizing the distances be-tween the features and their corresponding class anchors in the feature space. To address the limited availability of related benchmarks, we collect a fully annotated dataset, namely, NPP2021, which involves inconsistent cracks and noisy backgrounds in real-world nuclear power plants. Our proposed GAGL outperforms the state of the arts on various benchmark datasets including CRACK2019, SDNET2018, and our NPP2021. 1.

Introduction
Concrete structure health monitoring is of crucial impor-tance in various industries [2, 5, 7, 38, 39], of which crack damage classiﬁcation is the ﬁrst and critical stage. There is a great need for automated testing methods to recognize and repair cracks before the onset of serious deterioration so that the heavy maintenance costs could be reduced. How-ever, it is extremely challenging to realize crack recogni-tion in a real-world industrial environment. The cracks are commonly presented as dark curves on walls in inconsistent sizes and irregular shapes [13], moreover, mixed with vary-∗Corresponding Author ing surrounding backgrounds, resulting in different signal-to-noise ratios [44] [2].
Recently, the application of deep learning technology on crack recognition tasks has achieved great success [4, 14, 39]. These methods [14, 43] commonly train the convolu-tion neural network (CNN) on sub-images, then apply the trained model on the high-resolution images with a sliding window [6] to scan and classify the existence of cracks in each sub-image. However, the traditional CNN-based meth-ods for crack recognition have a crucial limitation: the in-ability of extracting discriminative features of cracks in a realistic environment. That is, due to the inconsistent cracks in varying sizes and shapes [43], the noisy texture patterns of the surrounding background, and the limited discrimina-tive ability of the cross-entropy (CE) loss [37], it is chal-lenging for deep models to extract the discriminate features that can be successfully classiﬁed. To verify this, Fig. 1(a) visualizes the crack and non-crack images in the feature space. It demonstrates that each class of images projected in the feature space spread in a wide area, and crack/non-crack features are mixed together and close to the class bound-ary. Therefore, the existing approaches are inappropriate for crack recognition in a realistic environment.
In this paper we propose a novel geometry-aware guided loss (GAGL) to enhance the discriminative power of the deeply learned features with the joint supervision of CE loss. GAGL enlarges the inter-class features separation and reduces the intra-class features variation by pulling the deep features of the same class to the feature that has the largest geometric distance to the class boundary. There are several challenges to realize such a loss as discussed in the below.
Due to the irregularity of the class boundaries [24], it is hard to detect the class boundaries and estimate the ge-ometric distances of features to them. To solve this issue, we propose a feature-based geometry-aware projected gra-dient descent method (FGA-PGD) to approximate the geo-metric distances of the features to class boundaries. Intu-itively, features which are close to the decision boundaries are vunerable to attacks. As shown in Fig. 1, to ﬁnd the mis-classiﬁed adversarial variants of input features, the features near the boundary require less rounds (i.e., lighter colors) of
(a) w/o GAGL (b) w/ GAGL (c) The illustration of GAGL
Figure 1. T-SNE feature visualizations of the crack and non-crack classes from the CRACK2019 dataset. The color gradient of the feature is calculated based on the least attack number κ that PGD needs to ﬁnd its misclassiﬁed adversarial variant. The features that need a large
κ (darker red and blue) are farther away from the decision boundary. Meanwhile, the features that need a small κ (lighter red and blue) are closer to the decision boundary. (a) CE supervision, (b) CE and GAGL supervision, (c) The illustration of GAGL. In each iteration,
GAGL ﬁrst relabels the features with a larger κ than their corresponding class anchors as the safe state features. Otherwise, the features are relabeled as the swing state features. Then, GAGL iteratively updates the anchor of each class as the alternative for the safest state feature by exploiting the anchor loss. Meanwhile, the object function of GAGL is deﬁned to enhance the discriminative power of the deeply learned features by making the swing state features close to their corresponding class anchors. (Best viewed in color) adversarial attacks than those faraway. In contrast, the fea-tures far away from class boundaries require a larger num-ber of attacks. By exploiting this effect, FGA-PGD gener-ates adversarial samples based on feature embeddings in-stead of images such that the geometric distances of crack and non-crack features could be approximated in an efﬁ-cient manner (see Sec. 3.2). Herein, FGA-PGD exploits the
κ-step Projected Gradient Descent (PGD-κ) method [21,22] as the adversarial attack method.
Since the entire training set is very large and contains tens of thousands of training samples, it is inefﬁcient and even impractical to select the feature that has the largest ge-ometric distance to the class boundary in each iteration. To address this problem, we exploit the aforementioned FGA-PGD method to measure the geometric distance and develop a geometry-aware update rule to learn an anchor (a vector with the same dimension as the feature) of each class as the approximation of the feature expected to have the largest geometric distance to the corresponding class boundary (see
Sec. 3.3).
Then, the objective function of GAGL can be deﬁned by optimizing the distances between the anchors and the fea-tures that are closer to the class boundaries than the cor-responding class anchors.(see Sec. 3.4). The optimization process of GAGL can be viewed as guiding the model to pull feature embeddings away from class boundaries and gather intra-class features together, which effectively help to separate crack and non-crack images in the feature space.
Hence, the goal of the GAGL can be realized by simulta-neously updating the anchors by the geometry-aware update rule and iteratively optimizing the features by the objective function of GAGL. The main contributions of this paper can be summarized as: (1) Propose the feature-based geometry-aware projected gradient descent (FGA-PGD) method to approximate the geometric distances of features to the class boundaries.
Moreover, FGA-PGD is highly efﬁcient as the adversarial attacks performed on the features instead of the images. (2) Propose the geometry-aware guided loss (GAGL) to enhance the discriminative power of the deeply learned features by penalizing the distances between the features and their corresponding class anchors in the feature space, where the anchor of each class is learned by the proposed geometry-aware update rule as the approximation of the fea-ture expected to have the largest geometric distance to the corresponding class boundary. (3) A labeled dataset has been constructed, namely,
NPP2021, which contains accurate annotations, to facili-tate the research about crack recognization tasks for the noisy backgrounds and the inconsistent cracks in varying size problems. 2.