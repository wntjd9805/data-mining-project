Abstract
Establishing superior-quality correspondences in an im-age pair is pivotal to many subsequent computer vision tasks. Using Euclidean distance between correspondences to ﬁnd neighbors and extract local information is a com-mon strategy in previous works. However, most such works ignore similar sparse semantics information between two given images and cannot capture local topology among cor-respondences well. Therefore, to deal with the above prob-lems, Multiple Sparse Semantics Dynamic Graph Network (MS2DG-Net) is proposed, in this paper, to predict proba-bilities of correspondences as inliers and recover camera poses. MS2DG-Net dynamically builds sparse semantics graphs based on sparse semantics similarity between two given images, to capture local topology among correspon-dences, while maintaining permutation-equivariant. Exten-sive experiments prove that MS2DG-Net outperforms state-of-the-art methods in outlier removal and camera pose es-timation tasks on the public datasets with heavy outliers.
Source code:https://github.com/changcaiyang/MS2DG-Net 1.

Introduction
Recently, ﬁnding high-quality correspondences has at-tracted broad attention in computer vision because of its wide applications, e.g., visual localization [30], image fu-sion [17], virtual reality [34], Simultaneous Location and
Mapping (SLAM) [21], Structure from Motion (SfM) [31], etc. However, the existing feature detection and descrip-tion methods (SIFT [14], SuperPoint [6], ContextDesc [15], etc.) cannot provide signiﬁcantly distinctive local features,
∗Corresponding author (a) Neighborhood based on Euclidean distance (b) Neighborhood based on sparse semantics similarity
Figure 1. The comparing illustration of (a) and (b), which are neighborhoods selected by Euclidean distance and sparse seman-tics similarity, respectively. The yellow, green and red lines repre-sent the selected correspondences, inliers and outliers. which will lead to matching results ambiguity. Hence, the initial correspondence set, based on the nearest neighbor matching strategy, will inevitably have numerous incorrect correspondences (i.e., outliers).
Outlier removal is an indispensable step to improve the correct correspondence (i.e., inlier) ratio of putative cor-respondences. Some traditional methods (RANSAC [7],
VFC [19] and LPM [18]) are applicable to special scenes, but they may be unsuitable for the explosive growth of gen-eral datasets with an extremely low inlier ratio.
The permutation-equivariant deep learning-based outlier removal methods are data-driven, emerging as the times require, so they can capture the rich potential relationship among correspondences. Speciﬁcally, CNe [20], motivated by Point-Net [26], has adopted PointNet-like architectures to process each correspondence independently and predict
the probabilities of correspondences as inliers. Although it is a pioneering work and has achieved good performance, the network performance is adversely affected by ignoring the relationship among correspondences. Hence, local in-formation has been introduced, in various ways, without losing permutation-equivariant, to capture the relationship among correspondences, in some networks, such as OA-Net [42], N3-Net [25], NM-Net [43], ACNe [33] and so on.
Although the above networks perform well, the seman-tics information between two given images’ sparse corre-spondences, which is called sparse semantics similarity in our paper, is not considered, and the local topology among correspondences can not capture well. Observing Figure 1, we can ﬁnd that, for an image pair of the same scene, there are numerous outliers in the neighborhood based on Eu-clidean distance, while the neighborhood according to se-mantic similarity is more likely to be correct. In real life, humans match two images with naked eyes, without con-sidering Euclidean distances of contents in images, but pay-ing attention to similarity of them, that is, somewhere with similar semantics information.
In Figure 1(a), neighbors are close to the selected correspondence in the Euclidean space, but without similar sparse semantics information, so they are more likely to be outliers. And in Figure 1(b), we can ﬁnd that semantics similar structures, such as colum-nar structures of building archs are brought close together, although they are distant in the Euclidean space. By com-parison, this phenomenon can be solved in Figure 1(b), but it will be ignored in Figure 1(a). Inspired by the hu-man matching process, in this work, we use a graph neu-ral network to construct dynamic graphs via sparse seman-tics similarity, to capture the local topology among corre-spondences. Speciﬁcally, we propose Multiple Sparse Se-mantics Dynamic Graph Network (MS2DG-Net) to remove outliers while preserving permutation-equivariant, which greatly improves the matching effectiveness.
In this paper, MS2DG-Net can dynamically adjust ad-jacency relationships between the selected correspondence feature map and residual ones in each graph. Meanwhile, it can also obtain multi-scale sparse semantics information, by concatenating sparse semantics information with differ-ent dimensions through a shortcut, which helps to prevent overﬁtting and capture richer contextual information.
Our contribution is twofold. Firstly, we ﬁnd sparse cor-respondences may have sparse semantics and introduce a novel fashion by graph neural network to dynamically con-struct graphs based on sparse semantics similarity in the im-age pair and capture the local topology among correspon-dences. Secondly, we design Multiple Sparse Semantics
Dynamic Graph Network (MS2DG-Net), while maintaining permutation-equivariant, to build different sparse semantics graphs in different layers and fuse multi-scale information to obtain richer contextual information. 2.