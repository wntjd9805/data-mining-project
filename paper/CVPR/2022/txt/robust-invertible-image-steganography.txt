Abstract
Image steganography aims to hide secret images into a container image, where the secret is hidden from human vi-sion and can be restored when necessary. Previous image steganography methods are limited in hiding capacity and robustness, commonly vulnerable to distortion on container images such as Gaussian noise, Poisson noise, and lossy compression. This paper presents a novel flow-based frame-work for robust invertible image steganography, dubbed as
RIIS. A conditional normalizing flow is introduced to model the distribution of the redundant high-frequency component with the condition of the container image. Moreover, a well-designed container enhancement module (CEM) also con-tributes to the robust reconstruction. To regulate the net-work parameters for different distortion levels, a distortion-guided modulation (DGM) is implemented over flow-based blocks to make it a one-size-fits-all model. In terms of both clean and distorted image steganography, extensive experi-ments reveal that the proposed RIIS efficiently improves the robustness while maintaining imperceptibility and capacity.
As far as we know, we are the first to propose a learning-based scheme to enhance the robustness of image steganog-raphy in the literature. The guarantee of steganography ro-bustness significantly broadens the application of steganog-raphy in real-world applications. 1.

Introduction
Steganography is a widely studied topic [12], which aims to hide messages like audio, image, and hyperlink into one container in an undetected way. In Fig. 1, image steganog-raphy takes the secret and host image as input to produce the container image. In its reverse process, it is only possible for the receivers with a specific revealing network to recon-struct secret information from the container image, which
This work was supported in part by Shenzhen Fundamental Research (Cor-Program (No.GXWD20201231165807007-20200807164903001). responding author: Jian Zhang.)
Figure 1. The upper row depicts the universal pipeline of im-age steganography. Previous steganography like ISN [35] gains poor revealed secret and revealed host image when the container is under slight distortion. On the contrary, our RIIS takes various distortion into consideration, which shows satisfactory robustness. is visually identical to the host image. Steganalysis tech-niques usually distinguish the container and host image by color, frequency, and other features. Thus the secret image should be hidden in the invisible domain of the container image. It is also valuable in applications to embed as much confidential data as possible into the host image, which is evaluated as payload capacity.
The image steganography is designed to keep the hid-ing capacity while considering security and imperceptibil-ity against steganalysis. Existing steganography schemes
[11, 43, 59] fail to strike a balance between imperceptibility and high payload capacity. Traditional methods transform the secret messages in the spatial or adaptive domains [29], achieving the capacities of 0.2∼4 bits per pixel (bpp). The secret data is usually embedded into fewer significance bits
[11] or indistinguishable parts, limiting the amount of secret information capacity. Recent learning-based steganography methods [7, 8] make an effort to exploit the potential capac-ity of secret. Most of them take the pre-processing, conceal-ing, and revealing as separate modules and design specific
networks with independent parameters to handle them.
Recent attempts [50] to introduce invertible neural net-works (INN) into low-level inverse problems like denoising, rescaling, and colorization show impressive potential over auto-encoder, GAN [2, 52], and other learning-based archi-tectures. The image steganography composed of concealing and revealing process can be considered as a pair of inverse problems. Thus flow-based INN is naturally suitable for this task. Besides, multiple secret images can be easily hidden into one container by increasing the number of channels of
INN branches. That incredibly improves steganography ca-pacity and makes ISN [35] the state-of-the-art image hiding technique in the literature.
Since the earlier image steganography works stress ca-pacity and invisibility rather than robustness and ignores the noise and compression interference in practice, they are usually sensitive to the interference during the media spread of container. Due to the dependence on inherent in-vertible bijective transformation property, flows tend to be more vulnerable to intermediate distortion [27, 31, 41]. In
Fig. 1, we take the state-off-the-art ISN [35] for example.
Once a slight noise or lossy compression is implemented on the container, the secret revealed is barely recognizable and also the host image at the receiver end. Even if the network is specifically finetuned against pre-defined noise or JPEG compression level, the reconstruction quality and general-ization are still limited.
In this paper, we design a conditional flow-based frame-work, dubbed as Robust Invertible Image Steganography (RIIS), to alleviate the distortion influence and improve ro-bustness. Inspired by conditional normalizing flow, we si-multaneously model container image distribution and dis-posable high-frequency information to keep valuable secret information implicitly. As the flow model is bijective, our corresponding enhancement module and optimization strat-egy handle irreversible processes like channel reduction and quantization. The main contributions are listed as follows:
• To solve the substantial performance drop under distor-tion in former learning-based steganography methods, we proposed a general and robust framework RIIS for image steganography under diverse distortion (Gaus-sian noise, Poisson noise, and JPEG compression).
• We introduce the conditional flow into the steganogra-phy framework by regulating the high-frequency dis-tribution conditional on the container image to implic-itly preserve essential information for the revealing.
• We propose a distortion-guided modulation (DGM) over flow-based blocks to modulate the parameters for different distortion levels. The modulation makes it a general, controllable model for various types and dis-tortion levels, with just one copy of parameters.
• Whether in a lossless or a distorted environment, abun-dant experiments demonstrate the superior robustness of our proposed RIIS while maintaining the impercep-tibility and capacity of steganography. The robustness of RIIS has been proved successful in broader applica-tions like real-world steganography, face-swap detec-tion, and grayscale colorization. 2.