Abstract
Although the Trajectory Prediction (TP) model has achieved great success in computer vision and robotics
ﬁelds, its architecture and training scheme design rely on heavy manual work and domain knowledge, which is not friendly to common users. Besides, the existing works ig-nore Federated Learning (FL) scenarios, failing to make full use of distributed multi-source datasets with rich ac-tual scenes to learn more a powerful TP model. In this pa-per, we make up for the above defects and propose ATPFL to help users federate multi-source trajectory datasets to automatically design and train a powerful TP model.
In
ATPFL, we build an effective TP search space by analyz-ing and summarizing the existing works. Then, based on the characters of this search space, we design a relation-sequence-aware search strategy, realizing the automatic de-sign of the TP model. Finally, we ﬁnd appropriate feder-ated training methods to respectively support the TP model search and ﬁnal model training under the FL framework, ensuring both the search efﬁciency and the ﬁnal model per-formance. Extensive experimental results show that ATPFL can help users gain well-performed TP models, achieving better results than the existing TP models trained on the single-source dataset. 1.

Introduction
Human Trajectory Prediction (TP) models aim to predict the movement of pedestrians [13, 20]. Their high perfor-mance greatly depends on abundant trajectory data. How-ever, in real applications, the TP data sources are generally monitor devices scattered across different regions. They contain trajectory data in a variety of scenarios but can not be shared due to privacy protection, which brings limita-tions to the existing TP works. In order to break the TP data island problem, Federated Learning (FL) framework needs
*Corresponding author.
Figure 1. ATPFL combines AutoML with FL techniques on TP area, aiming to utilize multi-source TP datasets to jointly design and train the powerful TP model. to be introduced to unite these multiple data sources jointly obtain a more robust and general TP model in a distributed and privacy-preserving manner. While this idea brings two major challenges.
On one hand, the design of TP models under the FL framework is difﬁcult. Speciﬁcally, the TP model de-sign process requires both heavy manual work and domain knowledge. However, FL users are generally non-experts.
They fail to realize the independent development without the domain knowledge, which brings great obstacles to the general application of TP models under the FL framework.
On the other hand, the FL method suitable for TP mod-els has not been studied or discussed yet. The existing FL works are mainly built around CNN [6,8,19] without paying attention to TP models. How to train TP models effectively under the FL framework remains to be further studied.
In this paper, we aim to tackle the above two challenges and propose ATPFL algorithm, which combines Automated
Machine Learning (AutoML) with FL (as is shown in Fig-ure 1), to federate multi-source trajectory datasets to auto-matically design and train powerful TP models.
For the ﬁrst challenge, in ATPFL, we design an AutoML algorithm suitable for the TP area, thus achieving the TP model’s automatic design. We summarize the design pro-cess of the TP model, collect available operations for each step and identify the limitation of each operation by analyz-ing the existing TP works. We integrate the above experi-ence and knowledge in a relation graph and thus construct an effective search space for the TP area.
Besides, considering the complex restrictive relations, temporal relations and technical connections among op-erations, we design a relation-sequence-aware strategy to effectively and efﬁciently explore the TP search space.
This strategy can utilize the constructed relation graph,
Graph Neural Network (GNN) [4] combined with Recurrent
Neural Network (RNN) to learn high-level features of the selected operation sequence, and thus provide an effective reference for designing subsequent steps. Also, it can avoid invalid model design schemes by consulting the relation graph at each step, thus greatly improving the search efﬁ-ciency. Compared with the traditional search strategy for
AutoML which ignores relations among operations during the model design [10, 12, 21], our strategy is more suitable for the TP area.
As for the second challenge, we ﬁnd appropriate feder-ated training methods for TP models, enabling ATPFL to perform effectively and efﬁciently under the FL framework.
We identify a method with fast convergence to support the fast evaluation of TP model candidates in AutoML, thus en-suring the search efﬁciency of ATPFL. Besides, we choose the most effective federated training method to train the op-timal TP model discovered by ATPFL, so as to further im-prove the ﬁnal performance of ATPFL.
Our major contributions are summarized as follows. 1. Knowledge: We construct a detailed knowledge graph for operations in the TP area. This graph can deepen our understanding of TP models and provide favorable help for further study. 2. Novelty: We simultaneously break the data island and professional restrictions, empower non-experts to combine multi-source trajectory datasets to design powerful TP models automatically. 3. Effectiveness: Extensive experiments show that our de-signed search strategy and selected federated training methods are well suited to the TP area, and helpful for obtaining more powerful TP models, which demon-strate the effectiveness of ATPFL. 2.