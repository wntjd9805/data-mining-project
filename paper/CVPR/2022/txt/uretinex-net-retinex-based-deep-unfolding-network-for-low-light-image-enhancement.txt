Abstract
Retinex model-based methods have shown to be effec-tive in layer-wise manipulation with well-designed priors for low-light image enhancement. However, the commonly used hand-crafted priors and optimization-driven solutions lead to the absence of adaptivity and efﬁciency. To ad-dress these issues, in this paper, we propose a Retinex-based deep unfolding network (URetinex-Net), which un-folds an optimization problem into a learnable network to decompose a low-light image into reﬂectance and illumi-nation layers. By formulating the decomposition problem as an implicit priors regularized model, three learning-based modules are carefully designed, responsible for data-dependent initialization, high-efﬁcient unfolding optimiza-tion, and user-speciﬁed illumination enhancement, respec-tively. Particularly, the proposed unfolding optimization module, introducing two networks to adaptively ﬁt implicit priors in data-driven manner, can realize noise suppres-sion and details preservation for the ﬁnal decomposition results. Extensive experiments on real-world low-light im-ages qualitatively and quantitatively demonstrate the ef-fectiveness and superiority of the proposed method over state-of-the-art methods. The code is available at https:
//github.com/AndersonYong/URetinex-Net. 1.

Introduction
Images captured in a poor light environment always suf-fer from low contrast and low visibility, which pose chal-lenges for both human visualization and numerous high-level vision tasks such as object detection [21, 23, 35]. To uncover the buried details in the low-light image and avoid degenerated performance of the subsequent vision tasks, researchers have made great efforts on contrast enhance-ment, texture recovering and noise removal for the low-*Corresponding author. wangxu@szu.edu.cn
Figure 1. Decomposition results in each unfolding stage, where decomposed components step-wise get rid of degradation. Gamma correction is applied for the decomposed illumination layer for better visual effect. light image. Especially for the low-light image enhance-ment (LLIE), many methods have been proposed, includ-ing histogram equalization [29], unsharp masking algo-rithms [7], Retinex-based methods [12, 27], multiple expo-sure fusion [5], and deep learning-based methods [11, 34].
Since Retinex theory well models color perception of hu-man vision, LLIE methods based on Retinex theory have attracted much attention. As stated in Retinex theory, an image can be decomposed into two components, i.e., re-ﬂectance and illumination. Mathematically, the observed image I can be expressed by
I = R
L,
· denote reﬂectance, (1)
· where R, L and illumination and element-wise multiplication, respectively.
In some early
Retinex-based methods [16, 17], illumination is ﬁrst esti-mated, and then reﬂectance is treated as the ﬁnal enhanced results. Although details can be largely recovered from the input, it often leads to an unnatural and over-exposed look.
Afterward, a number of model-based methods which have
good interpretability are proposed to solve the ill-posed de-composition problem in Eq. (1), where various hand-crafted priors are designed as the regularization terms introduced into models [12,13,22,27,30]. Then, to reveal the low-light image, illumination is further brightened up by Gamma cor-rection. Designing explicit prior to ﬁt data is the key to making models well-work, but it is challenging for model-based methods to be adaptive enough in various scenes.
Furthermore, most model-based methods adopting conven-tional iteration optimization schemes are costly for a single image adjustment, which will hinder their development in real-time applications.
Due to these limitations existing in model-based meth-ods, researchers take advantage of deep networks [3, 11, 15, 25, 34, 42] to restore low-light images in a data-driven man-ner. Among these learning-based methods, Retinex-based ones [34, 39, 41] use deep networks to estimate reﬂectance and illumination, and brighten up illumination. However, most of these methods perform denoising operations on re-ﬂectance after decomposition, resulting in the loss of de-tails. Furthermore, learning-based methods suffer from a lack of interpretability and ﬂexibility, which brings difﬁcul-ties in analyzing the potential limitations of the designed networks.
To this end, we propose a Retinex-based deep unfold-ing network (URetinex-Net) to reveal low-light images in
RGB color space. To integrate the strengths from model-based and learning-based methods, we formulate Retinex-based decomposition problem as an implicit priors regular-ized model, where robust regularization terms are inferred by learnable networks instead of using hand-crafted priors.
Speciﬁcally, the energy function of the formulated model is split into four univariate subproblems via alternating half-quadratic splitting algorithm, and this optimization problem can be solved by iteratively minimizing four subproblems.
Then, we unfold the optimization scheme into a deep net-work. For subproblems regarding to prior terms, two net-works are introduced to adaptively ﬁt implicit priors, while the others regarding to the ﬁdelity term are solved by corre-sponding close-form solutions. During unfolding optimiza-tion, the decomposed reﬂectance and illumination step-wise get rid of degradation (see Fig. 1). Meanwhile, the formu-lated model avoids designing explicit prior terms. Further-more, considering the important effect of initialization on optimization, we propose an initialization module to favor the optimization. Finally, we design an illumination adjust-ment module to ﬂexible brighten up illumination map ac-cording to use-speciﬁed light level.
In summary, the contributions of this paper lie threefold:
• Based on traditional model-based methods, we pro-pose a novel deep unfolding network for LLIE (URetinex-Net), consisting of three functionally clear modules corresponding to initialization, optimization, and illumination adjustment, respectively, which in-herits the ﬂexibility and interpretability from model-based methods.
• The optimization module in our proposed URetinex-Net unfolds optimization procedure into a deep net-work, which leverages the powerful model ability of learning-based methods to adaptively ﬁt data-dependent priors.
• Extensive experiments on real-world datasets are con-ducted to demonstrate high efﬁciency and superiority of our URetinex-Net, which can realize noise suppres-sion and details preservation for the ﬁnal enhanced re-sults. 2.