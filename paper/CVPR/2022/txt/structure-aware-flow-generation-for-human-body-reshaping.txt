Abstract
Body reshaping is an important procedure in portrait photo retouching. Due to the complicated structure and multifarious appearance of human bodies, existing meth-ods either fall back on the 3D domain via body morphable model or resort to keypoint-based image deformation, lead-ing to inefficiency and unsatisfied visual quality.
In this paper, we address these limitations by formulating an end-to-end flow generation architecture under the guidance of body structural priors, including skeletons and Part Affin-ity Fields, and achieve unprecedentedly controllable per-formance under arbitrary poses and garments. A composi-tional attention mechanism is introduced for capturing both visual perceptual correlations and structural associations of the human body to reinforce the manipulation consis-tency among related parts. For a comprehensive evaluation, we construct the first large-scale body reshaping dataset, namely BR-5K, which contains 5,000 portrait photos as well as professionally retouched targets. Extensive exper-iments demonstrate that our approach significantly outper-forms existing state-of-the-art methods in terms of visual performance, controllability, and efficiency. The dataset is available at our website: https://github.com/
JianqiangRen/FlowBasedBodyReshaping. 1.

Introduction
Portrait photography retouching is widely used in vari-ous fields, such as social media, weddings, and advertise-ments. While automatic face reshaping is well researched
[18, 24, 28, 33] and employed in many applications (e.g., In-stagram, Tictok), automatic body reshaping, which gener-ally aims to make figure looks more shapely and attractive, is still far from being settled due to the complicated struc-ture and appearance of human bodies. In fact, body reshap-ing is a troublesome task even for professional artists. The artists usually rely on Liquify tool in image editing soft-ware, adjust the distortion brush frequently, and manually edit through every single part of body areas. It takes con-siderable skill and time to achieve a visually pleasing result.
Traditional solutions for body reshaping task can be cat-Figure 1. Our approach provides an efficient and controllable solu-tion for human body reshaping, allowing figures to be more slen-der (top) or muscular (bottom). The corresponding deformation flows are showcased in the top-left corners. All of the images pre-sented in this paper are included in the proposed BR-5K dataset. egorized into either rule-based or 3D model-based methods.
The rule-based methods employ non-rigid image deforma-tion [12, 16] according to a set of body contour keypoints following some hand crafted rules, and 3D model-based ap-proaches [15, 30, 31, 39] try to reconstruct 3D morphable model from a single portrait image, and adjust body shape by manipulating a small set of parameters corresponding to body semantic attributes. Unfortunately, neither of them can satisfy the quality and efficiency requirements in prac-tice. Rule-based methods can only work under standard poses and garments, and body contour detection is not ro-bust enough for generating a reliable, quality-assured re-shaping result. 3D model-based methods are learned from a limited number of full-body scans so that cannot span the entire human shape space, especially for extreme camera di-rections and poses. Moreover, precisely recovering and reg-istering a 3D model to image is challenging as well, gener-ally needing considerable user assistance for pose and shape fitting [39], or extra depth information [15, 30].
Powered by deep generative technology [9, 25, 40], sev-eral methods [13, 41] propose to directly generate person images guided by pose information. Nevertheless, they are
still struggling for synthesizing photorealistic person im-ages to avoid visible misalignment artifacts. Recent meth-ods [14, 20, 24, 33] have revealed the effectiveness of flow field in spatial deformation tasks. However, feature-level flow-based methods [14, 20] can only afford to generate low-resolution person images, thus hardly satisfying the body retouching demands in practice. While pixel-level flow-based models [24,33] can conduct high-resolution face manipulation, their performance on body is far from our ex-pectation, resulting in unsatisfied or inconsistent reshaping results as we observed. We speculate the reason is that the regular physiological structure of the face dramatically re-duces the difficulty to learn face editing, but the body is much more complicated due to the flexible articulated struc-ture and multifarious garments.
To address the aforementioned challenges, we propose a structure-aware flow generation framework for body re-shaping. Given a portrait photo, we extract body skele-tons and Part Affinity Fields (PAFs) as important structural priors to guide flow generation. To encourage deforma-tion consistency among body parts, a Structure Affinity Self-Attention (SASA) mechanism is introduced to capture long-range perceptual correlations and structural associations si-multaneously. Finally, with the predicted flow field, which is both globally coherent and locally smooth, we generate the reshaped body using a warping operation. Moreover, our method can efficiently handle with high-resolution (4K) images by predicting flows on small images and applying the up-sampled flows to the original high-resolution images.
To facilitate the research on this important task, we cre-ate the first large-scale body retouching dataset BR-5K, which comprises 5,000 individual portrait photos as well as their retouched targets edited by professional artists. Exten-sive experiments demonstrate the effectiveness of the pro-posed method and dataset. The contributions of this paper are summarized as follows:
• We present the first 2D end-to-end structure-aware flow generation framework for body reshaping, which significantly exceeds state-of-the-art methods in terms of visual quality, controllability, and efficiency.
• We demonstrate that utilizing the skeletons and PAFs as structural priors can significantly alleviate the diffi-culty for body manipulation learning, leading to more accurate pixel-level flow prediction. A compositional attention mechanism SASA, which considers both per-ceptual correlations and structural associations, is fur-ther proposed to reinforce the manipulation consis-tency across related human parts.
• We create the first large-scale body retouching dataset
BR-5K, which contains 5,000 high-resolution individ-ual portrait photos as well as their retouched targets edited by professional artists. 2.