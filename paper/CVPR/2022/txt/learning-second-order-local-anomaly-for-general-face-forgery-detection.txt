Abstract
In this work, we propose a novel method to improve the generalization ability of CNN-based face forgery detectors.
Our method considers the feature anomalies of forged faces caused by the prevalent blending operations in face forgery algorithms. Specifically, we propose a weakly supervised
Second Order Local Anomaly (SOLA) learning module to mine anomalies in local regions using deep feature maps.
SOLA first decomposes the neighborhood of local features by different directions and distances and then calculates the first and second order local anomaly maps which provide more general forgery traces for the classifier. We also pro-pose a Local Enhancement Module (LEM) to improve the discrimination between local features of real and forged regions, so as to ensure accuracy in calculating anoma-lies. Besides, an improved Adaptive Spatial Rich Model (ASRM) is introduced to help mine subtle noise features via learnable high pass filters. With neither pixel level annota-tions nor external synthetic data, our method using a sim-ple ResNet18 backbone achieves competitive performances compared with state-of-the-art works when evaluated on unseen forgeries. 1.

Introduction
Recent progress in face synthesis technologies allows the low-entry production of sophisticated fake facial con-tent which causes severe trust issues. Concerns are growing over the nefarious use of such face forgery technologies.
To deal with this problem, many methods have been de-veloped to detect face forgeries using different traces, such as obvious visual artifacts [24, 29, 39], frequency domain cues [10, 12, 20, 33], temporal anomalies [3, 28, 37, 38, 47], or multimodality conflicts [1,5,30]. But these traces are not so generalizable that the detectors may fail when encoun-tering unseen forgeries. Thus recent works are looking for
*These authors contributed equally to this work.
†Corresponding author.
Figure 1. Second Order Local Anomaly (SOLA) learning module decomposes the neighborhood and predicts the first and second order anomaly maps. more universal forgery traces, so as to boost the generaliz-ability.
All the face forgery algorithms, whether face swapping or reenactment, need to blend the forged regions into the original background. The two parts inevitably hold differ-ent features, especially in high frequency regions, resulting in anomaly in forged images. On such observation, some methods are proposed to capture the feature inconsistency
[4, 22, 52]. [52] propose a patch wise consistency learning method to mine anomalies in forged face images and suc-ceed in generalizing to unseen forgeries. However, these works treat regions with various distances equally, which violates the fact that natural images hold different depen-dencies of short and long distances. Moreover, they usually require either pixel level annotations or external synthetic data. Although pixel level annotations can be created in lab environments, the need for them limits the usage of forged faces transmitted in the real world.
In this work, we focus on capturing forgery traces from the perspective of local anomaly. Specifically, given a face image, we extract its deep features with a CNN backbone, and divide the neighborhood of a local feature into 4 groups by different orientations and distances, thereby modeling more fine-grained local anomalies and generating 4 groups of anomaly maps. These anomaly maps are then decom-posed again to calculate the second order anomaly which
have a wide range of response to the first order anomaly.
The overview is shown in Fig. 1, and more details are in
Sec. 3.3. Our method requires neither pixel level annota-tions nor external data but achieves great cross-domain per-formance with a small backbone.
Our contributions can be summarized into four-fold:
• We propose a second order local anomaly (SOLA) learning module for isolating forgery faces. SOLA cal-culates anomalies of a local region in fine-grained fash-ion and magnifies the forgery traces via calculating the second order anomalies. Classifiers using the anomaly features are proved to have remarkable generalization on unseen forgeries.
• We propose a local enhancement module (LEM) that can be inserted after different stages of the backbone to ensure the discrimination between real and forged regions in deep local features.
• We design an adaptive spatial rich model (ASRM) which inherits the high pass peculiarity of SRM filters in forensics and is able to adaptively adjust the filters according to data.
• Our method requires neither pixel level annotations nor external synthetic data to improve the generaliza-tion of face forgery detectors. 2.