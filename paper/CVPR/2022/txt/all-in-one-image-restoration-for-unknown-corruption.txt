Abstract
In this paper, we study a challenging problem in image restoration, namely, how to develop an all-in-one method that could recover images from a variety of unknown cor-ruption types and levels. To this end, we propose an All-in-one Image Restoration Network (AirNet) consisting of two neural modules, named Contrastive-Based Degraded En-coder (CBDE) and Degradation-Guided Restoration Net-work (DGRN). The major advantages of AirNet are two-fold. First, it is an all-in-one solution which could recover various degraded images in one network. Second, AirNet is free from the prior of the corruption types and levels, which just uses the observed corrupted image to perform infer-ence. These two advantages enable AirNet to enjoy bet-ter ﬂexibility and higher economy in real world scenarios wherein the priors on the corruptions are hard to know and the degradation will change with space and time. Exten-sive experimental results show the proposed method outper-forms 17 image restoration baselines on four challenging datasets. The code is available at https://github. com/XLearning-SCU/2022-CVPR-AirNet. 1.

Introduction
Single image restoration aims to generate a visually pleasant high-quality image from a given degraded corre-spondence, e.g., noisy, rainy or hazy image. During past years, image restoration has been widely used in a number of real world applications, ranging from autopilot to medi-cal imaging and surveillance.
Although promising results have been achieved in a speciﬁc area, such as denosing [5, 27, 40, 53–55], deblur-ring [12, 32–34], deraining [10, 11, 17, 46, 50, 52] and de-hazing [1, 7, 9, 15, 19, 35, 37, 38], image restoration has en-countered the following obstacles in practice. On the one hand, it is necessary to know the correct corruption (i.e.,
∗Corresponding author
Figure 1. Illustrations of our basic idea. As shown, most of the existing multiple degradations methods handle each corruption by sending the input into a speciﬁcally designed head and using the output of the corresponding tail. Thus, they require the corruption information in advance to specify the corrected head and tail. Dif-ferently, our all-in-one image restoration network (AirNet) is free from the prior of corruption types and levels, thus enjoying better
ﬂexibility and higher economy in real world scenarios. degradation) for selecting a competitive model because al-most all existing approaches could handle a speciﬁc degra-dation only. Once the degradation type even corruption ratio changed, the model would achieve undesirable performance due to the inconsistency between the real case and the prior adopted for model construction or training. On the other hand, the degradation usually changes in complex environ-ment, e.g., self-driving cars may suffer from the rainy and hazy weather consecutively even simultaneously. In sum-mary, it is highly expected to develop an all-in-one method that is able to recover images from a variety of unknown1 corruption types and levels, as shown in Figure 1. To the best of our knowledge, such a unspeciﬁc image restoration 1Noticed, in this paper, the “unknown” refers to unspeciﬁc rather than unseen corruptions, and the “multiple degradations” refers to that a given image only contain a degradation but the data set will contain multiple degradations. 1
problem has been barely touched so far. paper, namely, image restoration and contrastive learning.
To tackle the aforementioned problem, we propose All-in-one Image Restoration Network (AirNet) which consists of two modules. To be speciﬁc, Contrastive-Based De-graded Encoder (CBDE) is designed to learn the degra-dation representation by leveraging the consistency of the images with the same degradation and the inconsistency existing into different degradations. Under the guid-ance of the degradation representations learned by CBDE,
Degradation-Guided Restoration Network (DGRN) aims to restore the images with various degradations. Thanks to the corporation of CBDE and DGRN, AirNet enjoys two highly expected merits, i.e., i) it provides an all-in-one so-lution to recover the images with different corruption types and ratios; ii) it is free from the prior of the corruption type and ratio. Notably, the referred all-in-one solution is differ-ent from existing so-called uniﬁed image restoration meth-ods [3, 8, 23] in given aspects. On the one hand, the meth-ods [3, 8, 23] have to specify the corruption type and ra-tio, whereas our method does not. On the other hand, they usually treat multiple degradations as a multi-task learning problem with multiple input and output heads, where each input and output head corresponds to a predetermined cor-ruption with a given corruption ratio. In contrast, AirNet is a single pass network which does not differentiate different corruption types and ratios, thus enjoying better ﬂexibility and higher economy.
To summarize, the contribution and novelty of this study are as below:
• As far as we know, AirNet could be one of the ﬁrst methods to recover images from multiple corruptions in an all-in-one fashion. As our method does not re-quire any degradation information for restoration in advance, it might be closer to the real world scenario.
• AirNet works in a dual manner, which contrastively learns the degradation representation from the ob-served images and then uses the learned degradation
It should representation to restore the clean image. be pointed out that the success of contrastive learning heavily relies on the construction of positive and neg-ative pairs. In this paper, we show a novel method that is effective to capture the inherited characteristics of multi-degradations.
• Without loss of generalizability, we conduct extensive experiments to verify the effectiveness of AirNet in de-noising, deraining and dehazing, comparing with 17 baselines. 2.