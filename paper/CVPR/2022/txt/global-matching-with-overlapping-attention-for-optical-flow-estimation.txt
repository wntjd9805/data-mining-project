Abstract
Optical flow estimation is a fundamental task in com-puter vision. Recent direct-regression methods using deep neural networks achieve remarkable performance improve-ment. However, they do not explicitly capture long-term motion correspondences and thus cannot handle large mo-tions effectively. In this paper, inspired by the traditional matching-optimization methods where matching is intro-duced to handle large displacements before energy-based optimizations, we introduce a simple but effective global matching step before the direct regression and develop a learning-based matching-optimization framework, namely
GMFlowNet. In GMFlowNet, global matching is efficiently calculated by applying argmax on 4D cost volumes. Ad-ditionally, to improve the matching quality, we propose patch-based overlapping attention to extract large con-text features. Extensive experiments demonstrate that GM-FlowNet outperforms RAFT, the most popular optimization-only method, by a large margin and achieves state-of-the-art performance on standard benchmarks. Thanks to the matching and overlapping attention, GMFlowNet ob-tains major improvements on the predictions for texture-less regions and large motions. Our code is made publicly available at https://github.com/xiaofeng94/
GMFlowNet. (a) Traditional Matching-Optimization (b) Learning-based Optimization (c) Learning-based Matching-Optimization
Figure 1. Main frameworks for optical flow estimation. (a) Tra-ditional matching-optimization methods first build a sparse match-ing to get a coarse flow and then exploit energy-based optimization to refine the flow. (b) Direct-regression methods mimic the energy-based optimization with learned parameters. They can be regarded as learning-based optimizations without matching. (c) Our frame-work introduces matching before the learning-based optimization and further improves the performance. 1.

Introduction
Optical flow estimation is a key computer vision task, which benefits various applications, including video inter-polation [24], deblurring [52], video segmentation [43] and action recognition [37]. Prevalent work in this area has been largely dominated by either matching-optimization or direct-regression methods. Previous energy-based op-timization methods [6, 17, 31] usually fail to handle large displacements due to their inability to capture long-term motion correspondences.
To remedy this, matching-optimization methods [2, 7, 47] introduce a matching step
*Correspondence to: Shiyu Zhao (sz553@rutgers.edu). before the optimization, which aims to find correspon-dences between pixels or patches across frames. How-ever, their matching process depends on complicated hand-crafted features and is time-consuming and inaccurate.
Recent direct-regression methods [20, 38, 41, 54] regard optical flow estimation as a regression task and achieve considerable improvements especially in predicting small changes in optical flow. These methods typically calculate 4D cost volumes representing the similarity between pixels and then directly regress flows from cost volumes by neu-ral networks. Similar to energy-based optimization, direct-regression methods cannot capture long-term motion corre-spondences in an explicit way and thus suffer from a perfor-mance drop in areas with large motions.
In this paper, we incorporate a matching step to explic-itly handle large displacements for direct-regression meth-ods, inspired by the improvement matching-optimization methods brought to energy-based optimization approaches.
Based on this idea, we develop a novel framework for op-tical flow estimation, namely Global Matching Flow Net-work (GMFlowNet), where global matching is introduced before the direct regression. Unlike traditional methods,
GMFlowNet provides an efficient and accurate matching step. For efficiency, we apply argmax to the typical 4D cost volume to build the global matching since it results in minor computational overhead. For accuracy, we pro-pose a Patch-based OverLapping Attention (POLA) block to extract large context features to diminish regional ambi-guities in matching, e.g., repeated patterns and textureless regions. Specifically, POLA divides input feature maps into patches and attends each patch with itself and its neighbor-ing patches. Since direct-regression methods mimic the tra-ditional energy-based optimizations in a data-driven man-ner [41], they can be interpreted as learning-based optimiza-tions. Thus, our method can be regarded as a learning-based matching-optimization framework. Fig. 1 illustrates differ-ences between previous related frameworks and ours.
We evaluate GMFlowNet on standard datasets for op-tical flow estimation. Extensive experiments demonstrate that GMFlowNet significantly outperforms the most popu-lar optimization-only model RAFT [41] and achieves state-of-the-art performance. As expected, GMFlowNet provides better flow estimations especially for large motion areas and textureless regions. Besides, we thoroughly investigate our global matching and POLA, showing that they are both ef-fective and efficient.
Our contributions are summarized as follows: 1) We in-troduce a global matching step to explicitly handle large displacement optical flow estimations for direct-regression methods. With typical 4D cost volumes, our global match-ing is effective and efficient. 2) We propose a well-designed Patch-based OverLapping Attention (POLA) to address local ambiguities in matching and demonstrate its effectiveness via extensive experiments. 3) Following tra-ditional matching-optimization frameworks, we propose a learning-based matching-optimization framework named
GMFlowNet that achieves state of the art performance on standard benchmarks. 2.