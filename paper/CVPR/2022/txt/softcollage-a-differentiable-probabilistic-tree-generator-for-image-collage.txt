Abstract
Image collage task aims to create an informative and visual-aesthetic visual summarization for an image collec-tion. While several recent works exploit tree-based algo-rithm to preserve image content better, all of them resort to hand-crafted adjustment rules to optimize the collage tree structure, leading to the failure of fully exploring the struc-ture space of collage tree. Our key idea is to soften the discrete tree structure space into a continuous probability space. We propose SoftCollage, a novel method that em-ploys a neural-based differentiable probabilistic tree gener-ator to produce the probability distribution of correlation-preserving collage tree conditioned on deep image feature, aspect ratio and canvas size. The differentiable character-istic allows us to formulate the tree-based collage gener-ation as a differentiable process and directly exploit gra-dient to optimize the collage layout in the level of proba-bility space in an end-to-end manner. To facilitate image collage research, we propose AIC, a large-scale public-available annotated dataset for image collage evaluation.
Extensive experiments on the introduced dataset demon-strate the superior performance of the proposed method.
Data and codes are available at https://github. com/ChineseYjh/SoftCollage. 1.

Introduction
Image collage aims to create a visual summarization with rich information and high aesthetic quality for a group of images. Because this task requires professional collage knowledge, amateurs have a huge demand for automatic image collage tools [16]. Therefore, many research efforts have tried to automate the process of image collage. While many works [4, 12, 18, 19, 25, 26, 33, 41] have achieved a certain level of success in improving visual perception of
*Corresponding author. This research was partially supported by the
National Natural Science Foundation of China (Grant Nos.61972221, 62021002, 61572274) and Tsinghua-Kuaishou Institute of Future Media
Data. We thank Xingjia Pan for preparing some comparison results.
Figure 1. The optimization paradigms of the conventional meth-ods and the proposed SoftCollage. We formulates the tree-based collage generation as a differentiable process via softening the dis-crete tree structure τ into a probability space for the ﬁrst time. In-stead of the hand-crafted adjustment scheme, we directly exploit the gradient of the criterion loss to optimize the tree probability distribution τθ, which facilitates the tree structure exploration. collage results, they brought about image artifacts [18, 25, 26, 41] and image overlapping [19, 33, 36, 40]. To tackle these defects, some tree-based algorithms [3,8,16,23,37,38] were developed to preserve image content better. A tree-based collage is encoded as a binary tree which leads to a recursive partition of the canvas as illustrated in Fig. 2. In the tree, each leaf node corresponds to an image and each interior node corresponds to a bounding box, whose des-ignation as a horizontal (“H”) or vertical (“V”) cut corre-sponds to dividing the box into two child boxes [3]. The existing tree-based methods design a two-stage procedure, where images are arranged in a standard collage tree in the
ﬁrst stage and the tree is mapped to the collage via a speciﬁc bijection mapping function in the second stage. Accord-ingly, the collage layout optimization is cast as an optimal tree structure search problem.
However, all the existing works only resort to heuristic hand-crafted adjustment rules when searching the optimal tree structure, leading to the failure of fully exploring the structure space of collage tree (Fig. 3). Deep learning pro-vides a promising way to learn a high-quality collage tree.
Unfortunately, the two-stage tree-based collage generation process is undifferentiable because both stages include dis-Figure 2. An example of the mapping from a standard collage tree to the tree-based collage. crete operations that prevent back propagation. Although recent tree-based advances [16, 23] utilized learning strate-gies, they only applied them to yield semantic feature in the
ﬁrst stage so that images with similar features clustered to-gether. These works achieve much improvement because placing correlated images together can facilitate collage in-formativeness [18, 38, 41]. However, these methods still employed hand-crafted scheme to reﬁne tree structure and failed to fully explore the solution space (Fig. 3). Recently, despite Pan et al. [23] introduced back propagation for the
ﬁrst time to ﬁne-tune aspect ratio and splitting ratio, they still failed to propagate the gradients back to optimize the collage tree structure due to the undifferentiable character-istic of the tree-based process.
In this paper, we attack the key problem of differen-tiating the overall two-stage tree-based collage generation process (Fig. 1). Speciﬁcally, ﬁrstly we propose a novel neural-based differentiable probabilistic tree generator to model the ﬁrst stage of tree-based procedure. Our tree generator exploits deep image feature and embedded infor-mation including aspect ratio and canvas size to construct a correlation-preserving probabilistic collage tree (PCtree), which builds a probability space via modeling the node type distribution (the cut type of the node is horizontal (“H”) or vertical (“V”)) and the edge connection distribution (the child node is on the left (“L”) or right (“R”)) (Fig. 5). Sec-ondly, we formulate the tree generator optimization as an end-to-end framework resorting to the policy gradient tech-nique [30], which naturally overcomes the differentiation difﬁculty in the second stage of tree-based procedure. In-stead of the hand-crafted adjustment scheme in instance level, our optimization paradigm directly utilizes the gradi-ent of collage criteria loss to optimize the collage tree struc-ture in the level of probability space, which facilitates the exploration of the optimal collage structure.
Furthermore, this ﬁeld lacks a benchmark dataset with sufﬁcient labels for quantitative evaluation. To facilitate im-age collage research, we propose AIC, a large-scale public-available annotated dataset for image collage evaluation.
The major contributions can be summarized as follows.
• We propose a novel neural-based probabilistic tree generator which constructs “soft” probabilistic tree structure to build a probability space of correlation-(a) VSM [23] (b) Ours
Figure 3. Due to the failure of fully exploring the structure space of collage tree, the collage generated by the state-of-the-art method (a) still contains images suffering severe aspect ratio distortion (red dotted rectangle) and fails to place similar images together (blue dotted ellipse). Our result (b) preserves aspect ratio and con-tent correlation better. preserving collage tree conditioned on the deep image feature, aspect ratio and canvas size.
• We formulate the tree-based collage generation proce-dure as a differentiable process for the ﬁrst time, and introduce an end-to-end learning strategy to perform gradient-based structure optimization.
• We provide a large-scale public-available annotated benchmark dataset for evaluation of image collage method.
• We conduct extensive experiments and user study, and show that our model outperforms the state-of-the-art methods. 2.