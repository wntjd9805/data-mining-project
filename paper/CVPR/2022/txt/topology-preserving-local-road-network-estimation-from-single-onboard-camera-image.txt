Abstract
Knowledge of the road network topology is crucial for autonomous planning and navigation. Yet, recovering such topology from a single image has only been explored in part. Furthermore, it needs to refer to the ground plane, where also the driving actions are taken. This paper aims at extracting the local road network topology, directly in the bird’s-eye-view (BEV), all in a complex urban set-ting. The only input consists of a single onboard, for-ward looking camera image. We represent the road topol-ogy using a set of directed lane curves and their interac-tions, which are captured using their intersection points.
To better capture topology, we introduce the concept of minimal cycles and their covers. A minimal cycle is the smallest cycle formed by the directed curve segments (be-tween two intersections). The cover is a set of curves whose segments are involved in forming a minimal cycle.
We first show that the covers suffice to uniquely represent the road topology. The covers are then used to supervise deep neural networks, along with the lane curve supervi-sion. These learn to predict the road topology from a sin-gle input image. The results on the NuScenes and Argo-verse benchmarks are significantly better than those ob-tained with baselines. Code: https://github.com/ ybarancan/TopologicalLaneGraph. 1.

Introduction
How would you give directions to a driver? One of the most intuitive ways is by stating turns, instead of distances.
For example, taking the third right turn is more intuitive and robust than going straight for 100 meters and turn right.
This observation motivates us to model road networks us-ing the involved lanes and their intersections. We model the lane intersections ordered in the direction of traffic. Given a reference centerline L and two lines I1, I2 intersecting L, we consider the set of all possible lines intersecting L be-tween the intersection points L − I1 and L − I2 as an equiv-alence class. Such modelling allows us to supervise the learning process explicitly using the topological structure of
Figure 1. GT (a), two estimates of base method [6] with similar loss(b), and two estimates of Ours with similar loss (c). Yellow dots refer to connections. Our formulation encourages the shaded (in cyan) region to exist in the prediction, which in turn, ensures preservation of order of intersections. the road network. In turn, the topological consistency dur-ing inference is improved. Consider a car moving from the green point P upwards in Fig 1, which needs to take the first left turn. In the two estimates of [6], the first left leads to different lanes. While the underlying directed graphs have the same connectivity in all estimates, they have very dif-ferent topological structures which play an important role in decision making.
For autonomous driving, the information contained in the local road network surrounding the car is vital for the decision making of the autonomous system. The local road network is both used to predict the motion of other agents
[15, 23, 36, 45] as well as to plan ego-motion [3, 12]. The most popular approach to represent the road network is in terms of lane graph based HD-maps, which contain both the information about the centerlines and their connectivity.
Most existing methods address the problem of road network extraction by using offline generated HD-maps in combi-nation with a modular perception stack [10, 24, 29, 35, 39].
However, offline HD-maps based solutions have two ma-jor issues: (i) dependency on the precise localization in the
HD-map [29, 43], (ii) requirement to construct and main-tain such maps. These requirements severely limit the scal-ability of autonomous driving to operate in geographically restricted areas. To avoid offline mapping [6] proposed to directly estimate the local road network online from just one onboard image. Inspired by this approach and given the im-portance of topological consistency for graph based maps we propose to directly supervise the map generation net-work to estimate topological consistent road networks.
Figure 2. The road networks and the resulting closed regions (minimal cycles, shown in different colors). In the road network, traffic flows from green to red dots and the yellow dots are connection points of two centerlines. Proposed formulation learns to preserve the identities of the centerlines enclosing the minimal cycles. Some interesting regions are shown by white circles on colored images.
Starting from [6], we represent the local road network using a set of Bezier curves. Each curve represents a driv-ing lane, which is directed along the traffic flow with the help of starting and end points. However, compared to [6] we also consider the topology of the road network, which is modelled by these directed curves and their intersections.
More precisely, we rely on the following statement: if the intersection order of every lane, with the other lanes, re-mains the same, the topology of the road network is pre-served. Directly estimating the order of intersections is a hard problem. Therefore, we introduce the concept of min-imal cycles and their covers. A minimal cycle is the small-est cycle formed by the directed curve segments (between two intersections). In Fig. 2, each minimal cycle is repre-sented by different colors. The cover is the set of curves whose segments are involved in forming a minimal cycle.
Given two sets of curves (one estimation and one ground truth), if all curves in both sets intersect in the same order, then the topology defined by both sets are equivalent. In this work, we show that such equivalence can be measured by comparing the covers of the minimal cycles. Based on our findings, we supervise deep neural networks that learn to predict topology preserving road networks from a single image. To our knowledge, this is the first work studying the problem of estimating topology of a road network, thus going beyond the traditional lane graphs.
Our model predicts lane curves and how they connect as well as the minimal cycles with their covers. During the learning process, both curves and cycles are jointly super-vised. The curve supervision is performed by matching pre-dicted curves to those of ground truth by means of the Hun-garian algorithm. Similarly, the cycle supervision matches the cover of the predicted cycles to those of the ground truth.
Such joint supervision encourages our model to predict ac-curate and topology preserving road networks during infer-ence, without requiring the branch for cycle supervision.
For online mapping in autonomous driving and other robotic applications, it is crucial to directly predict the road network in the Birds-Eye-View (BEV) since the ac-tion space of the autonomous vehicles is the ground. This stands in contrast to traditional scene understanding which mainly takes place in the image plane.
It was recently shown that performing BEV scene understanding in the image plane, and then project it to the ground plane is inferior to directly predicting the output on the ground plane [7, 9, 33, 34, 38, 42, 43]. Compared to our approach these methods do not provide the local road network, but a segmentation on the BEV. Note that the road regions alone do not provide the desired topological information. Similar methods that perform lane detection are limited to highway like roads where the topology of the lanes is trivial, and are not able to predict road networks in urban scenarios with in-tersections which is the setting we are interested. As said [6] is able to predict such road networks but does not consider the topology, and we will show that our topological reason-ing can improve the methods proposed in [6].
Our predicted connected curves provide us a full lane graph HD map. To this end, our major contributions can be summarized as follows. 1. We propose a novel formulation for the topology of a road network, which is complementary to the classic lane graph approach 2. We show that a neural network can be trained end-to-end to produce topologically accurate lane graphs from a single onboard image 3. We propose novel metrics to evaluate the topological accuracy of an estimated lane graph 4. The results obtained by our method are superior to the compared methods in both traditional and topological structure metrics 2.