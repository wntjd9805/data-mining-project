Abstract
Current non-rigid object keypoint detectors perform well on a chosen kind of species and body parts, and require a large amount of labelled keypoints for training. Moreover, their heatmaps, tailored to speciﬁc body parts, cannot rec-ognize novel keypoints (keypoints not labelled for training) on unseen species. We raise an interesting yet challeng-ing question: how to detect both base (annotated for train-ing) and novel keypoints for unseen species given a few an-notated samples? Thus, we propose a versatile Few-shot
Keypoint Detection (FSKD) pipeline, which can detect a varying number of keypoints of different kinds. Our FSKD provides the uncertainty estimation of predicted keypoints.
Speciﬁcally, FSKD involves main and auxiliary keypoint representation learning, similarity learning, and keypoint localization with uncertainty modeling to tackle the local-ization noise. Moreover, we model the uncertainty across groups of keypoints by multivariate Gaussian distribution to exploit implicit correlations between neighboring keypoints.
We show the effectiveness of our FSKD on (i) novel keypoint detection for unseen species, (ii) few-shot Fine-Grained Vi-sual Recognition (FGVR) and (iii) Semantic Alignment (SA) downstream tasks. For FGVR, detected keypoints improve the classiﬁcation accuracy. For SA, we showcase a novel thin-plate-spline warping that uses estimated keypoint un-certainty under imperfect keypoint corespondences. 1.

Introduction
Deep fully-supervised pose estimation has proven its ex-cellence in detecting keypoints on humans [6,14,18,35,47].
However, these keypoint detectors are dedicated to speciﬁc species and body parts on which they are trained. They are not reusable for unseen species, and consume large amounts of annotated data. In contrast, given a few samples, a child can adequately recognize and generalize a keypoint on a paw of rabbit, cat, dog, kangaroo under varying poses e.g., jumping, crouching, or walking. By comparison, machine
*The corresponding author.
Figure 1. Illustration of few-shot keypoint detection (4-way, 2-shot protocol) with uncertainty learning. Our FSKD model success-fully detects four novel keypoints and estimates the localization uncertainty given two annotated instances in unseen species. perception is inferior to biological perception [51]. Inspired by the progress in few-shot learning [25, 26, 41, 45, 49, 58], we propose Few-shot Keypoint Detection (FSKD) which can learn from few keypoints and recognise previously un-seen keypoint types even for species unseen during training (Fig. 1).
As keypoints provide crucial structural and semantic information, FSKD has numerous promising applications such as semi-automatic labelling, face alignment [27, 44],
Fine-Grained Visual Recognition (FGVR) [46], animal be-havior analysis [37], etc. The use of keypoints can also sim-plify the labor-intensive surveillance of wildlife [34, 56].
In this paper, we propose a versatile FSKD approach which copes with various levels of domain shift. Fig. 2 shows that the categories of species used for training and testing may be the same or different (top branches), and also the keypoint types of speciﬁc body parts may be the same or disjoint (bottom branches). The easiest problem setting assumes the same kind of species and the same types of keypoints throughout training and testing. However, if the species as well as keypoint types used for training and test-ing are both disjoint, the problem is challenging due to high levels of domain shift.
We note that learning and generalizing based on a few of samples is hard due to the limited number of annotations and a large variability of samples. Moreover, there exist
Figure 2. Different settings of FSKD lead to different levels of domain shift.
Figure 3. Downstream tasks on which we evaluate the proposed FSKD. (a) Few-shot Fine-Grained Visual Recognition (FGVR); (b) Semantic Alignment (SA). large amounts of interfering noise and similar local patterns in an image, which can challenge FSKD and deem it ar-guably a much harder problem than Few-shot Object Detec-tion (FSOD) [13, 22, 55]. In contrast to objects which usu-ally have well-deﬁned boundaries, keypoints lack the clear boundary and correspond to some local regions rather than exact coordinates. Consequently, keypoints inherently ex-hibit ambiguity and location uncertainty, which are reﬂected in both groundtruth keypoints and predictions. Thus, we de-velop an FSKD approach which can deal with domain shifts and model the uncertainty of localization.
Our FSKD ﬁrstly extracts the deep representations of support keypoints to build the keypoint prototypes (one per keypoint type), which are correlated against the query fea-ture map to yield keypoint-speciﬁc attentive features. Af-ter descriptor extraction, attentive features are transformed into descriptors which will be used for subsequent keypoint localization. To address the limited types of base training keypoints, we introduce the generated auxiliary keypoints into learning. Though these keypoints show poor matching between support and query images, they boost the keypoint diversity and signiﬁcantly help infer novel keypoints. The difﬁculty of FSKD results in imperfect keypoint predictions over novel keypoints. To compensate for this effect and deal with inherent ambiguity and noise of keypoints, we propose to model the localization uncertainty by learning the covari-ance for individual or multiple keyoints, which allows larger tolerance of those noisy keypoints by the loss function. Our contributions are summarized as follows: i. We propose a ﬂexible few-shot keypoint detection (FSKD) model that can detect varying types and num-bers of keypoints given one or more annotated samples. ii. Both localization and semantic uncertainty are modeled within our localization networks, where an uncertainty-aided grid-based locator (UC-GBL) is proposed. More-over, we propose the multi-scale UC-GBL in order to reduce the risk of mislocalization. iii. We employ the low-quality auxiliary keypoints during learning, and model the covariance for coupled main and auxiliary keypoints to improve generalization. iv. Convincing experiments show that our FSKD can de-tect novel keypoints on unseen species. With a simple modiﬁcation, we extend our FSKD to act as a simple keypoint detector applied to few-shot ﬁne-grained vi-sual recognition and semantic alignment (Fig. 3).
To our best knowledge, our work is the ﬁrst attempt to model keypoint detection as few-shot learning. 2.