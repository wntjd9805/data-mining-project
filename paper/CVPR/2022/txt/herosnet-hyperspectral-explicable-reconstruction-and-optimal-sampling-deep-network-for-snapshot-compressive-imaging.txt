Abstract
Hyperspectral imaging is an essential imaging modal-ity for a wide range of applications, especially in remote sensing, agriculture, and medicine.
Inspired by existing hyperspectral cameras that are either slow, expensive, or bulky, reconstructing hyperspectral images (HSIs) from a low-budget snapshot measurement has drawn wide atten-tion. By mapping a truncated numerical optimization al-gorithm into a network with a ﬁxed number of phases, re-cent deep unfolding networks (DUNs) for spectral snapshot compressive sensing (SCI) have achieved remarkable suc-cess. However, DUNs are far from reaching the scope of industrial applications limited by the lack of cross-phase feature interaction and adaptive parameter adjustment. In this paper, we propose a novel Hyperspectral Explicable
Reconstruction and Optimal Sampling deep Network for
SCI, dubbed HerosNet, which includes several phases un-der the ISTA-unfolding framework. Each phase can ﬂexibly simulate the sensing matrix and contextually adjust the step size in the gradient descent step, and hierarchically fuse and interact the hidden states of previous phases to effec-tively recover current HSI frames in the proximal mapping step. Simultaneously, a hardware-friendly optimal binary mask is learned end-to-end to further improve the recon-struction performance. Finally, our HerosNet is validated to outperform the state-of-the-art methods on both simula-tion and real datasets by large margins. The source code is available at https://github.com/jianzhangcs/HerosNet. 1.

Introduction
With the development of artiﬁcial intelligence and the demand for capturing and sensing hyper-robotics,
This work was supported in part by Shenzhen Fundamental Research
Program (No.GXWD20201231165807007-20200807164903001) and Na-tional Natural Science Foundation of China (61902009). (Corresponding author: Jian Zhang.)
Figure 1. The schematic of CASSI system and some visual results of the proposed HerosNet and DGSM [13] on the real dataset. Our reconstructed HSIs have clearer edges and more detailed textures, while the results of DGSM have more noise and artifacts. spectral images has dramatically increased in recent years
[3, 6, 12, 47]. Based on the traditional compressive sens-ing (CS) [51, 54], spectral snapshot compressive sensing (SCI) system aims to record 3D scenes via a 2D detector.
It has the advantages of low bandwidth, low cost, and high data throughput, which has played an increasingly pivotal role in a wide range of applications, such as remote sens-ing, object detection, super-resolution, and medical diagno-sis [2, 8, 14, 18, 25, 36, 38, 55]. In this paper, we focus on a typical imaging system named coded aperture snapshot spectral imager (CASSI) [11,21,30], which modulates spec-tral frames via a coded aperture (i.e. physical mask) and shifts them across the spectral dimension via a disperser.
In the past few years, there have been a great amount of reconstruction methods for HSIs compressed by CASSI, including model-based methods and deep learning-based methods. Traditional model-based methods [5, 15, 16, 29, 34, 40, 41, 46] often search for the optimal solution it-eratively and reﬁne the results to the desired signal do-main via the image priors. Although these methods are highly interpretable, they are limited by the hand-crafted priors and slow reconstruction speed. Owing to the de-velopment of deep learning, several learning-based meth-ods [20, 22–24, 26, 39, 43, 56, 57] have been used to re-construct HSIs, which directly learn an end-to-end inverse mapping from the 2D measurement to the 3D hyperspec-tral cube. Compared to model-based methods, they tend to drastically reduce time complexity and achieve better per-formance. However, they do not explicitly embody the sys-tem imaging model and are just trained as a black box.
Most recently, some researchers have introduced the
DUNs to the HSI reconstruction task, which merge the ad-vantages of both model-based and learning-based methods
[13, 17, 19, 31, 32, 53]. DUNs perform the iterative process via a gradient descent module and reﬁne the intermediate result via a deep prior module. Although existing DUNs al-leviate some drawbacks of model-based and learning-based methods to some extent, there are still several bottlenecks to be solved. Firstly, how to effectively interact and fuse the features between phases is the key to the enhancement of the reconstruction quality. Most existing DUNs do not es-tablish the connections between the proceeding and follow-ing phases. As the number of phases increases, beneﬁcial information tends to be lost in the process of information transmission. Furthermore, inspired by the memory mecha-nism in the CS [28], the hidden states of the previous phases can provide complementary information for the computa-tion of the current phase. Therefore, it is essential to in-troduce a feature interaction mechanism between different phases to obtain enhanced feature representation. Secondly, how to dynamically learn the parameters in the gradient de-scent module has been ignored in the past. Previous re-searchers usually treat these parameters as ﬁxed constants to compress HSIs. However, the ﬁxed parameters can not be adjusted adaptively and contextually in different scenes, which will lead to sub-optimal reconstruction and restrict the ﬂexibility of DUNs. Thirdly, targeted at HSIs, the exist-ing DUN does not combine mask optimization and image reconstruction into a united framework, which can not re-tain the structure and information of HSIs completely.
Inspired by the ISTA, a novel Hyperspectral Explicable
Reconsturction and Optimal Sampling deep Network for
SCI, dubbed HerosNet, is proposed for joint mask opti-mization and HSI reconstruction. Particularly, the network consists of a sampling subnet, an initialization subnet, and a recovery subnet. Fueled by the success of ISTA-Net and its variant [37, 44, 49], the recovery phase updates the current estimate via a dynamic gradient descent module (DGDM) and reﬁne the rough estimate via a hierarchical feature in-teraction module (HFIM). Since each recovery phase cor-responds to an ISTA iteration and all the parameters are learned end-to-end, the network enjoys the merits of high-quality reconstruction with strong interpretability. For ex-ample, in Fig. 1, the results of the proposed HerosNet have clearer detailed textures than those of DGSM [13]. Overall, our contributions are summarized as follows.
• A novel
ISTA inspired deep unfolding network, dubbed HerosNet, is proposed for jointly learning bi-nary optimal masks and recovering high-quality HSIs.
• A dynamic gradient descent module (DGDM) is intro-duced to ﬂexibly simulate the sensing matrix and con-textually adjust the step size in gradient descent step.
• A hierarchical feature interaction module (HFIM) is designed, which fuses and interacts the hidden states of previous phases to recover the HSI frames of the current phase in proximal mapping step.
• Our HerosNet outperforms the state-of-the-art meth-ods on simulation and real datasets by large margins. 2.