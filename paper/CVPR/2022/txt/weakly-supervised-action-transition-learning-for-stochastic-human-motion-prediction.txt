Abstract
We introduce the task of action-driven stochastic human motion prediction, which aims to predict multiple plausi-ble future motions given a sequence of action labels and a short motion history. This differs from existing works, which predict motions that either do not respect any specific ac-tion category, or follow a single action label. In particular, addressing this task requires tackling two challenges: The transitions between the different actions must be smooth; the length of the predicted motion depends on the action sequence and varies significantly across samples. As we cannot realistically expect training data to cover sufficiently diverse action transitions and motion lengths, we propose an effective training strategy consisting of combining mul-tiple motions from different actions and introducing a weak form of supervision to encourage smooth transitions. We then design a VAE-based model conditioned on both the observed motion and the action label sequence, allowing us to generate multiple plausible future motions of varying length. We illustrate the generality of our approach by ex-ploring its use with two different temporal encoding mod-els, namely RNNs and Transformers. Our approach out-performs baseline models constructed by adapting state-of-the-art single action-conditioned motion generation meth-ods and stochastic human motion prediction approaches to our new task of action-driven stochastic motion prediction.
Our code is available at https://github.com/wei-mao-2019/WAT. 1.

Introduction
Modeling human motion has broad applications in human-robot interaction [26], virtual/augmented real-ity (AR/VR) [46] and animation [49]. As such, it has been an active research problem for many years [8]. In particular, recently, great progress has been made in predicting future motion given an observed past motion sequence [5,56]. Ad-dressing this could have a significant impact on autonomous systems, allowing them to forecast potential dangers and plan their actions accordingly. Nevertheless, except for a few early methods that predict motions of a single action category [13, 21], recent methods [36, 56] mostly focus on action-agnostic predictions. Thus, they cannot be used by an autonomous system to generate specific potential future scenarios encoded by a sequence of action labels, for ex-ample to evaluate the consequences of a person on a side-walk either walking to the crossing, waiting for the green light, and crossing the road, or instead running on the street and stopping in front of the car. By contrast, recent works on human motion synthesis can generate action-specific se-quences [17, 42]. However, these methods neither lever-age past motion observations, nor synthesize transitions be-tween different actions. In this work, we therefore introduce the task of action-driven stochastic human motion predic-tion, which aims to predict a set of future motions given a sequence of action labels and past motion observations.
One of the key challenges of this task arises from the fact that humans can perform motions with all kinds of ac-tion transitions. For example, when one walks to a table, they can then either grab a drink, or sit on a chair, or place something on the table, or perform any combination of the above. Constructing a dataset that covers this huge space of possible action transitions is therefore virtually impossible, significantly complicating training a model for this task. As a matter of fact, to the best of our knowledge, almost all hu-man motion datasets contain sequences that depict a single action. While the recent BABEL dataset [43] constitutes the only exception with multiple actions per sequence, it contains only a small subset of action transitions, which, as evidenced by our experiments, does not suffice to learn to generalize to arbitrary ones.
To tackle the diversity of human action transitions with such limited data, we develop a weakly-supervised train-ing strategy that only relies on a motion smoothness prior.
Specifically, we generate multi-action sequences by com-bining historical and future motions from different action categories, and account for the lack of supervision during the transition between two actions by simply encouraging the predicted motion to be temporally smooth. As will be shown by our experiments, such a simple prior suffices to model natural action transitions.
The second main challenge of our task arises from the stochastic nature of human motion: Several ways to per-form one action sequence are equally plausible. To han-dle this stochasticity, we design a model based on a vari-ational autoencoder (VAE) [24], conditioning the VAE on the observed past motion and on the action label sequence.
We demonstrate the generality of this model by exploit-ing it with two different temporal encoding architectures, an RNN-based one and a Transformer-based one. Further-more, to reflect the fact that some action sequences require more time to be executed than others, we introduce a sim-ple yet effective strategy based on the prediction variance to produce multi-action motions of different lengths. This con-trasts with most of the motion prediction literature, which predicts fixed-length motions, and, as illustrated by Fig. 1, allows us to generate realistic, diverse future motions de-picting the given actions in order and with varying length.
We believe that our approach can also be beneficial for other tasks, e.g., music generation of variable length.
Our contribution can therefore be summarized as fol-lows: (i) We introduce a new task, action-driven stochastic human motion prediction, which bridges the gap between motion synthesis and stochastic human motion prediction; (ii) We propose a weakly-supervised training strategy to learn the action transitions without requiring an unrealis-tic amount of annotated data; (iii) We develop a simple yet effective way of predicting motions of varying length.
Our experiments on 3 human motion modeling bench-marks demonstrate the effectiveness of our approach, out-performing baseline models constructed by extending state-of-the-art action-conditioned motion synthesis methods and stochastic human motion prediction ones to our new task. 2.