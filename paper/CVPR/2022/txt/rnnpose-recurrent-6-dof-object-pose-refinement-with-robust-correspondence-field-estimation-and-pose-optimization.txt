Abstract 6-DoF object pose estimation from a monocular image is challenging, and a post-refinement procedure is gener-ally needed for high-precision estimation. In this paper, we propose a framework based on a recurrent neural network (RNN) for object pose refinement, which is robust to erro-neous initial poses and occlusions. During the recurrent iterations, object pose refinement is formulated as a non-linear least squares problem based on the estimated cor-respondence field (between a rendered image and the ob-served image). The problem is then solved by a differen-tiable Levenberg-Marquardt (LM) algorithm enabling end-to-end training. The correspondence field estimation and pose refinement are conducted alternatively in each itera-tion to recover the object poses. Furthermore, to improve the robustness to occlusion, we introduce a consistency-check mechanism based on the learned descriptors of the 3D model and observed 2D images, which downweights the unreliable correspondences during pose optimization. Ex-tensive experiments on LINEMOD, Occlusion-LINEMOD, and YCB-Video datasets validate the effectiveness of our method and demonstrate state-of-the-art performance. 1.

Introduction 6-DoF object pose estimation is of crucial importance in various applications, including augmented reality, robotic manipulation, and autonomous driving. Influenced by vary-ing illuminations and occlusions, appearances of the differ-ently posed objects may vary significantly from different views, which poses great challenges for 6-DOF object pose estimation from a single color image.
The recent top-performing methods [23,27,41,52,58] ad-ditionally include a pose refinement procedure which sub-stantially improves the performance. Some of these frame-works [41, 52] rely on depth sensors and refine the poses with the ICP algorithm [2]. To avoid the expensive depth sensor, Li et al. [23] and Manhardt et al. [27] pioneered the RGB-based pose refinement. During refinement, these methods first render a reference color image according to the coarse pose estimate. This rendered image along with
K. Lin and H. Li are the co-corresponding authors.
Figure 1. The basic idea. (a) Before refinement, a reference image is rendered according to the object initial pose (shown in a fused view). (b) Our RNN-based framework recurrently refines the ob-ject pose based on the estimated correspondence field between the reference and target images. The pose is optimized to be consis-tent with the reliable correspondence estimations highlighted by the similarity score map (built from learned 3D-2D descriptors) via differentiable LM optimization. (c) The output refined pose. the observed image is then fed to a CNN to directly predict the residual pose for refining the coarse pose [23, 27, 58].
While these methods perform well in ideal scenarios based on massive training data, the pose regression becomes less stable in practice. More recently, Iwase et al. [20] formu-lated the object pose refinement as an optimization problem based on feature alignment, and reported significant perfor-mance improvements. In their work, the encoded features of a 3D model by a neural network are projected to the 2D image plane according to the pose parameters. There-after, the pose optimization is conducted by aligning the projected features with the observed target image features.
As the pose optimization depends on the gradients from the pixel-level feature differences, the feature alignment based methods are only applicable to small inter-frame pose vari-ations [57] and are not quite robust with erroneous initial poses. Moreover, Iwase et al. [20] still have a limited de-sign for occlusion handling, which might limit the deploy-ment scope.
In this work, we propose a recurrent object pose refine-ment framework, dubbed RNNPose, which is robust to er-roneous initial poses and occlusions. The overall pipeline
is illustrated in Fig. 1. Before refinement, a reference im-age of the object is rendered according to the initial pose estimation. Our refinement module refines the initial pose based on this rendered image and the observed image. To increase the tolerance to erroneous initial poses, our refine-ment is conducted within a recurrent framework, where the pose optimization is formulated as a non-linear least squares problem based on estimated correspondence fields. In each recurrent iteration, the dense correspondences between the rendered image and observed image are estimated, and the object pose is then optimized to be consistent with the cor-respondence field estimation. The architecture of our corre-spondence estimation is inspired by the recent optical flow estimation techniques [39, 44], which is integrated with our pose optimization recurrently. To suit our task where un-patterned objects and illumination variations are ubiquitous, we further include a correspondence field rectification step in each recurrent iteration based on the currently optimized pose. The inconsistent correspondences are rectified by en-forcing rigid-transformation constraints. The rectified cor-respondence field is also used to initialize the next recurrent iteration to improve the robustness further.
For occlusion handling, we introduce a 3D-2D hybrid network trained with a contrastive loss, which generates dis-tinctive point-wise descriptors for the 3D object model and observed 2D images. A similarity score is constructed for each estimated correspondence pair based on the learned descriptors, with which to downweight the unreliable corre-spondences during pose optimization. The pose optimiza-tion is conducted by a differentiable Levenberg-Marquardt (LM) algorithm (sharing the ideas of [42, 43]) for end-to-end training.
Our contributions are three-fold: 1) We propose an
RNN-based 6-DoF pose refinement framework that is ro-bust to large initial pose errors and occlusions. During re-current iterations, the pose optimization is formulated as a non-linear least squares problem based on the estimated correspondence field. Meanwhile, the correspondence field is also being rectified and improved by the optimized pose for robustness. 2) To handle the occlusions, a 3D-2D hy-brid network is introduced to learn point-wise descriptors which are used to downweight unreliable correspondence estimations during pose optimization. 3) We achieve new state-of-the-art performances on LINEMOD, Occlusion
LINEMOD, and YCB-Video datasets. Our code is public at https://github.com/DecaYale/RNNPose. 2.