Abstract
Color image stitching is a challenging task in real-world applications. This paper first proposes a quaternion rank-1 alignment (QR1A) model for high-precision color image alignment. To solve the optimization problem of QR1A, we develop a nested iterative algorithm under the framework of complex-valued alternating direction method of multipliers.
To quantitatively evaluate image stitching performance, we propose a perceptual seam quality (PSQ) measure to calcu-late misalignments of local regions along the seamline. Us-ing QR1A and PSQ, we further propose an automatic color
In this frame-image stitching (ACIS-QR1A) framework. work, the automatic strategy and iterative learning strategy are developed to simultaneously learn the optimal seamline and local alignment. Extensive experiments on challenging datasets demonstrate that the proposed ACIS-QR1A is able to obtain high-quality stitched images under several diffi-cult scenarios including large parallax, low textures, mov-ing objects, large occlusions or/and their combinations. 1.

Introduction
Color image stitching refers to the generation of a large image with a broader field of view from multiple partial overlapped color images. As a fundamental task of image processing, it plays a crucial role in diverse applications such as photogrammetry in remote sensing [17], stereo-scopic stitching in virtual reality [6] and panoramic stitch-ing in autonomous driving [28]. However, generating high-quality stitched images remains a challenging problem, es-pecially in presence of large parallax, low textures, moving objects, large occlusions or/and their combinations.
Conventionally, the image stitching process contains three steps: first, estimate alignment models to warp in-put images onto a common coordinate system; second, de-tect an invisible seam in the overlapping area; third, uti-lize an image blending technique along this seam to splice
*Corresponding author. aligned images into a larger image. According to the align-ment methods in the first step, image stitching works can be broadly classified into feature-based and pixel-based.
In the feature-based methods, the development of image stitching technologies follows two mainstreams: to devise an optimal global alignment, and to search a local align-ment enabling an optimal seamline. In the first mainstream, spatially-varying warping methods were proposed to im-prove the global alignment accuracy [8, 12, 22, 30]. They calculated multiple local adaptive transformations over the whole overlapping area to align images as much as possi-ble. To maintain image naturalness, shape-preserving meth-ods were developed by integrating homography with the similarity transformation [3, 15, 20]. Inspired by content-preserving warping (CPW) [23], the mesh-warping methods were as well as adopted for local adjustments to the align-ment accuracy and image naturalness [5, 6, 11, 32]. How-ever, their underlying assumption is that the spatial relations among the neighboring objects should be consistent in dif-ferent input images. Their estimated local transformations are varied continuously, and hence they perform very well only in presence of small or moderate parallax.
To handle large parallax, the seam-driven strategy was introduced in the second mainstream. The seam-driven methods first estimated local alignment proposals and then selected the optimal one with the best seam quality to cre-ate the final stitching result [9, 21, 32]. Itâ€™s noteworthy that given the same aligned area, different seam calculations usually produce various seamlines such that the stitched im-ages are diverse as well [14]. And the evaluation of seam qualities directly decides the final stitched image. However, these methods put major efforts into generating local align-ment proposals while limited considerations on their seam-line proposals. Therefore, the simple methods for seamline calculation and evaluation could degrade their final stitching performances implicitly. Additionally, most of them em-ploy the seam quality as a metric to select ready alignment models, instead of guiding the process of alignment model estimation. As a result, the generated best seam from these local alignment proposals cannot guarantee to achieve an
optimal stitching performance.
Interestingly, we further observe a contradictory fact that a plausible seam is usually encouraged to go through the flat regions (e.g., sky, walls and roads) whereas the feature-based alignment methods cannot provide the pixel-level ac-curacy accordingly. In low-textured environments, insuffi-cient features probably lead to the biased estimation of their alignment models, and hence misaligned errors are gener-ated. Such biased estimations may also occur in dynamic scenes where features are distributed non-uniformly due to the moving objects or occlusions. To alleviate this problem, some works explored line features to complement point-feature correspondences [11, 16]. However, the estimated models still perform well in the limited scenes where suffi-cient line segments should be captured.
To fully utilize image information, pixel-based image alignment methods were developed [18, 19, 26]. They aligned image backgrounds using a low-rank matrix and modeled the misaligned differences among the foregrounds as a sparse matrix. Benefited from this decomposition way, these methods are robust to moving objects and occlusions.
Compared with using feature correspondences, they achieve higher alignment accuracy when fitting the same alignment model, especially in low-textured environments. However, when aligning color images, they directly convert color im-ages into grayscale images that ignores the relationship be-tween color channels, resulting in performance degradation.
Motivated by the above limitations, in this paper we in-troduce an automatic color image stitching method to create high-quality stitched images under kinds of difficult scenar-ios. Our main contributions are summarized as follows: 1. We propose a quaternion rank-1 alignment (QR1A) model for color image alignment in the quaternion do-main. Using the quaternion representation, QR1A is able to fully utilize color image information and ob-tain high-precision color image alignment results. 2. To solve the optimization problem of QR1A, we de-velop a nested iterative algorithm under the frame-work of complex-valued alternating direction method of multipliers. 3. To quantitatively evaluate image stitching perfor-mance, we propose a perceptual seam quality (PSQ) measure to calculate misalignments of local regions along the seamline. 4. Using QR1A and PSQ, we further propose an auto-matic color image stitching (ACIS-QR1A) framework.
In this framework, the automatic strategy and itera-tive learning strategy are developed to simultaneously learn the optimal seamline and local alignment. This offers our ACIS-QR1A the capability of performing high-quality color image stitching automatically. 5. Extensive challenging experiments on different datasets demonstrate that ACIS-QR1A is able to create high-quality stitched images when facing large parallax, large occlusions or/and their combinations. low textures, moving objects,
The rest of this paper is organized as follows: Section 2 reviews the related work. Section 3 proposes the QR1A model and deduces its optimal solution. Section 4 proposes the PSQ measure. Section 5 proposes the ACIS-QR1A framework in detail. Section 6 presents the experiments and comparisons. Finally, Section 7 gives the conclusions. 2.