Abstract
Unsupervised domain adaptive person re-identification (ReID) has been extensively investigated to mitigate the ad-verse effects of domain gaps. Those works assume the tar-get domain data can be accessible all at once. However, for the real-world streaming data, this hinders the timely adap-tation to changing data statistics and sufficient exploita-tion of increasing samples. In this paper, to address more practical scenarios, we propose a new task, Lifelong Un-supervised Domain Adaptive (LUDA) person ReID. This is challenging because it requires the model to continuously adapt to unlabeled data in the target environments while alleviating catastrophic forgetting for such a fine-grained person retrieval task. We design an effective scheme for this task, dubbed CLUDA-ReID, where the anti-forgetting is harmoniously coordinated with the adaptation. Specif-ically, a meta-based Coordinated Data Replay strategy is proposed to replay old data and update the network with a coordinated optimization direction for both adaptation and memorization. Moreover, we propose Relational Con-sistency Learning for old knowledge distillation/inheritance in line with the objective of retrieval-based tasks. We set up two evaluation settings to simulate the practical application scenarios. Extensive experiments demonstrate the effective-ness of our CLUDA-ReID for both scenarios with stationary target streams and scenarios with dynamic target streams. 1.

Introduction
Person re-identification (ReID) aims to identify the same person across different locations, time instances and cam-eras. It is of high value in a wide range of applications [36]
*This work was done when Zhipeng Huang was an intern at MSRA.
†Equal contribution.
‡Corresponding authors.
Figure 1. Illustration of the regular UDA (a), the lifelong UDA in the stationary target scenario (b) and dynamic target scenario (c). in diverse environments, such as customer activity analy-sis, missing children finding. In practice, a trained ReID model usually suffers from severe performance drops when deployed in new environments due to the domain gaps be-tween the training data and the data in new environments.
Unsupervised domain adaptive (UDA) person ReID has been widely studied to help deployed person ReID models better adapt to new environments, by transferring learned knowledge from labeled source domain to unlabeled target domain [1, 9, 10, 31, 45, 46].
Existing UDA person ReID methods [1, 9, 10, 31, 45, 46] assume that the data in the target domain can be accessible all at once, which does not accord well with practical sce-narios. In deployment environments, new people are often showing up constantly and the data statistics may vary over time. This imposes strong demands in developing a practi-cal person ReID model/system that can support 1) flexible adaptation to data statistics on the fly so that we can timely obtain adapted performance without waiting for a long time to collect massive data and 2) continuous knowledge acqui-sition from increasing data. Recent works begin to look into lifelong (supervised) person ReID [27,39]. They greatly ad-vance practical applications by supporting continuous su-pervised domain adaptation, but still leave much explo-ration room in the following aspects. First, these works require costly annotations in the target domain. Besides hu-man labour efforts, data labelling is time consuming, which is not conductive to quick adaptation and privacy protection.
Second, they all aim to balance anti-forgetting and adapta-tion, lacking explicit consideration for their coordination.
In fact, anti-forgetting can facilitate flexible/quick adapta-tion when harnessed in the right manner. In this paper, we propose and study a more practical task, i.e., Lifelong Un-supervised Domain Adaptive (LUDA) person ReID, which does not require annotations in the target domain.
LUDA person ReID enables deployed models to achieve continuous domain adaptation using unlabeled target stream. To the best of our knowledge, we are the first to define this task. Different from conventional life-long learn-ing [15,20,34], our proposed task is challenging attributable to two reasons. First, person ReID is a fine-grained retrieval task. Critical to this task is to capture the inter-instance relations for accurately ranking instances. Second, in the context of lifelong learning, person ReID requires higher generalization ability on unseen identities/categories since there are constantly new people showing up, beyond the re-quirements for remembering how to classify seen categories as in classification tasks. Thus, for LUDA person ReID, we expect that anti-forgetting can promote adaptation by avoid-ing over-fitting new data and facilitating learning more gen-eralizable features so that we can achieve fast adaptation especially when the target domain changes or reappears.
In this paper, we design an effective scheme for LUDA person ReID in which anti-forgetting and adaptation are coordinated, dubbed CLUDA-ReID. In previous studies
[2,5,25,40], anti-forgetting is commonly placed into a joint learning framework together with the training for adapta-tion, lacking explicit considerations on their coordination.
We propose Coordinated Data Replay (CDR) to solve this problem. Particularly, we store old data with a modified
ID-wise reservoir sampling algorithm, and design a meta-based optimization strategy to align the objective of anti-forgetting with that of adaptation when replaying stored old data. Moreover, we maintain a model that is timely updated and a momentum-updated model that accumulates learned knowledge over time. We further introduce Relational Con-sistency Learning (RCL) to promote knowledge distilla-tion/inheritance from the historical model to the current model when performing adaptation. Different from other knowledge distillation strategies [39] in conventional life-long learning, RCL is carefully designed to match the task characteristics of person ReID. We introduce two scenarios with stationary or dynamic target streams as illustrated in
Fig.1, and evaluate our CLUDA-ReID on these settings.
Besides, we build a new dataset named MMP-Retrieval upon the MMPTRACK dataset for unseen-domain gener-alization evaluation, released at https://iccv2021-mmp.github.io/subpage/dataset.html.
Our contributions can be summarized in three aspects:
• We propose a novel yet realistic task, Lifelong Unsuper-vised Domain Adaptive (LUDA) person re-identification, to endow person ReID models with automatic adaptation using continuously collected unlabeled data.
• We design an effective LUDA person ReID scheme, i.e.,
CLUDA-ReID, wherein Coordinated Data Replay (CDR) and Relational Consistency Learning (RCL) are proposed to explicitly coordinate anti-forgetting and adaptation.
• We set up two practical evaluation schemes to simulate real application scenarios. Extensive experiments demon-strate that our proposed method is effective in achieving
LUDA for scenarios with stationary or dynamic target streams and enhancing unseen-domain generalization. 2.