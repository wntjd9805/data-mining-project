Abstract
The increasing abuse of image editing softwares, such as Photoshop and Meitu, causes the authenticity of digi-tal images questionable. Meanwhile, the widespread avail-ability of online social networks (OSNs) makes them the dominant channels for transmitting forged images to re-port fake news, propagate rumors, etc. Unfortunately, various lossy operations adopted by OSNs, e.g., compres-sion and resizing, impose great challenges for implement-ing the robust image forgery detection. To ﬁght against the
OSN-shared forgeries, in this work, a novel robust train-ing scheme is proposed. We ﬁrst conduct a thorough anal-ysis of the noise introduced by OSNs, and decouple it into two parts, i.e., predictable noise and unseen noise, which are modelled separately. The former simulates the noise introduced by the disclosed (known) operations of OSNs, while the latter is designed to not only complete the pre-vious one, but also take into account the defects of the detector itself. We then incorporate the modelled noise into a robust training framework, signiﬁcantly improving the robustness of the image forgery detector. Extensive ex-perimental results are presented to validate the superior-ity of the proposed scheme compared with several state-of-the-art competitors. Finally, to promote the future de-velopment of the image forgery detection, we build a pub-lic forgeries dataset based on four existing datasets and three most popular OSNs. The designed detector recently won the top ranking in a certiﬁcate forgery detection com-petition1. The source code and dataset are available at https://github.com/HighwayWu/ImageForensicsOSN. 1.

Introduction
The ever-increasing popularity of powerful image edit-ing softwares has made the manipulation of images an ex-tremely easy task. The manipulated or forged images are becoming increasingly dangerous in various ﬁelds such as
Figure 1. The detection results of DFCN [42] and ours by using an original forgery and the one transmitted through an OSN. The left girl is spliced (forged). removing copyright watermarks, producing fake news, and being forged evidence in court. Meanwhile, with the vig-orous development of the Internet, online social networks (OSNs) have become dominant platforms for information transmission, where images occupy a large portion. Many forged images are transmitted over various OSNs, inﬂu-encing people’s opinion towards e.g., important documents (certiﬁcates), commercial products, political issues, etc.
A large number of methods [4, 5, 8, 11, 12, 18, 20–23, 26, 27, 36, 37, 39, 42] have been proposed to detect and local-ize image forgery. Some of them are designed to detect speciﬁc forms of tampering, such as splicing [18,26], copy-move [23, 39] and inpainting [21, 22, 36], while the others aim to identify more complex or compound forgeries. How-ever, few research has been done to explicitly address the design of the robust forgery detection against the lossy op-erations in the ubiquitous OSN platforms. Such a topic is very important because these lossy operations can severely degrade the detection performance. As shown in Fig. 1, the state-of-the-art algorithm [42] can accurately detect the forged regions from the original forgery; but the detection performance would be severely degraded when handling the forgery transmitted through Facebook. 1https://tianchi.aliyun.com/competition/entrance/531812/introduction
For mitigating the negative impacts of OSNs, the ﬁrst
critical issue is to analyze and model the noise introduced by the OSN lossy channels. However, this is a rather difﬁ-cult problem mainly because current platforms do not dis-close the process for manipulating the transmitted images.
Although some works [33, 34] revealed part of the opera-tions adopted by OSNs, there are still many unknown ones, e.g., the enhancement ﬁltering in Facebook. More impor-tantly, OSNs often adjust their image processing pipelines, making the modeling even more challenging.
To deal with the aforementioned challenges, in this pa-per, we aim to design a robust image forgery detection method to defeat the lossy operations in OSNs. Speciﬁcally, for dealing with the OSN degradations, we propose a noise modeling scheme and integrate the mimetic noises into a ro-bust training framework. We decouple the OSN noises into two components: 1) predictable noise and 2) unseen noise.
The former is designed to simulate the predictable loss brought by known operations, (e.g., JPEG compression), whose modeling relies on a deep neural network (DNN) with the residual learning and an embedded differentiable
JPEG layer. While the latter is mainly in response to the unknowable actions conducted by OSNs and/or the discrep-ancy between the training and testing of various OSNs. Ap-parently, it is unrealistic to build a suitable model for the unseen noise from the perspective of the signal itself. To address this difﬁculty, we transfer our observations from the noise perspective to the forgery detector, only focusing on the noise that may cause deterioration of the detection per-formance. Such a strategy naturally incubates a new algo-rithm to model the unseen noise by utilizing the core idea of adversarial noise [35], which is essentially impercepti-ble perturbation that can severely degrade the model perfor-mance. It is shown that our robust image forgery detection method demonstrates superior robustness and outperforms several state-of-the-art algorithms. An example of the de-tection result of our scheme is shown in Fig. 1. Finally, we build a public forgeries dataset with more than 5000 items based on four existing datasets [1, 6, 14, 17] and three OSN platforms (Facebook, Weibo, and Wechat). Our major con-tributions can be summarized as follows:
• We propose a novel training scheme for robust image forgery detection against transmission over OSNs. The training scheme not only models the predictable noise introduced by OSNs, but also incorporates the unseen noise to further promote the robustness.
• Our model achieves better detection performance in comparison with several state-of-the-art methods [12, 27,37,42], especially in the scenario of ﬁghting against the transmission over OSNs.
• We build a public forgeries dataset based on four ex-isting datasets [1, 6, 14, 17] and three platforms (Face-book, Weibo, and Wechat).
The rest of this paper is organized as follows. Sec. 2 reviews the related works. Sec. 3 presents the details on the robust image forgery detection through the proposed robust training strategy. Experimental results are given in Sec. 4 and Sec. 5 concludes. 2.