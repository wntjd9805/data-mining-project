Abstract
Many ﬂagship smartphone cameras now use a dedicated neural image signal processor (ISP) to render noisy raw sensor images to the ﬁnal processed output. Training night-mode ISP networks relies on large-scale datasets of image pairs with: (1) a noisy raw image captured with a short exposure and a high ISO gain; and (2) a ground truth low-noise raw image captured with a long exposure and low ISO that has been rendered through the ISP. Capturing such im-age pairs is tedious and time-consuming, requiring careful setup to ensure alignment between the image pairs. In ad-dition, ground truth images are often prone to motion blur due to the long exposure. To address this problem, we pro-pose a method that synthesizes nighttime images from day-time images. Daytime images are easy to capture, exhibit low-noise (even on smartphone cameras) and rarely suffer from motion blur. We outline a processing framework to convert daytime raw images to have the appearance of re-alistic nighttime raw images with different levels of noise.
Our procedure allows us to easily produce aligned noisy and clean nighttime image pairs. We show the effective-ness of our synthesis framework by training neural ISPs for nightmode rendering. Furthermore, we demonstrate that using our synthetic nighttime images together with small amounts of real data (e.g., 5% to 10%) yields performance almost on par with training exclusively on real nighttime images. Our dataset and code are available at https:
//github.com/SamsungLabs/day-to-night.
Figure 1.
Top row: A high-quality daytime image and a noisy/clean nighttime image pair. While high-quality day images are easy to capture, paired nighttime data, needed for training nightmode neural ISPs, is challenging to acquire. We propose a day-to-night image synthesis framework that converts the daytime images to appear as noisy/clean paired nighttime images suitable for training DNNs. Middle row: Different day-to-night image syn-thesis methods. Bottom row: A neural nightmode ISP trained by our synthetic night images produces more accurate results com-pared to models trained on dimmed day images, or night images synthesized by CycleGAN [37]. Inset shows PSNR in dB. 1.

Introduction
Capturing images at night and in low-light environments is challenging due to the low photon count hitting the cam-era sensor. Because of the weak signal, the image must be gained (i.e., high ISO), which further ampliﬁes the sensor noise. This is particularly troublesome for smartphone cam-eras, where the sensor’s small form factor limits the amount
*Work done while an intern at the Samsung AI Center – Toronto. of light per pixel photosite, resulting in signiﬁcant noise lev-els in low-light and night environments. When noisy sensor images are processed by the camera’s image signal proces-sor (ISP), the noise is often ampliﬁed, resulting in noisy and aesthetically unappealing ﬁnal standard RGB (sRGB) output images. One solution is to capture the scene us-ing a long exposure (e.g., several seconds), but this often is not viable as it requires the camera to be placed on a tri-pod to avoid camera shake and the scene needs to remain static to avoid motion blur. Recent advancements in deep
networks designed to render noisy raw nighttime images to the processed sRGB outputs have shown impressive results.
These networks are trained on aligned noisy/clean image pairs captured in low-light and nighttime environments.
Several recent works have undertaken the effort to cap-ture high-quality ground-truth images of low-light scenes at night, such as [2, 8, 9, 30]. These training images are col-lected using two strategies. The ﬁrst is to capture a noisy short-exposure high-ISO gain image as input, together with a long-exposure low-ISO gain image to serve as the target ground truth (e.g., [8,9]). Images must be carefully captured on a tripod to ensure alignment. This approach is prone to blurring in the ground truth image due to the long exposure, especially when capturing outdoor scenes, where it is harder to control motion in the environment. The second strategy is to capture multiple short-exposure images with high ISO.
The ground truth image is computed by averaging the im-age sequence to reduce noise (e.g., [2]). This method has its own challenges in terms of alignment and image sequence fusion. In addition, any motion in the scene will result in motion blur in the averaged ground truth image. Further confounding data collection is the fact that data capture and network training are required per sensor, as the raw images are sensor speciﬁc [3, 4].
From a practical standpoint, capturing data for night mode represents a signiﬁcant burden. This is especially true for smartphone cameras, where sensors are being continu-ally updated and many devices now have multiple cameras per device with different underlying sensors [3]. Recent ap-proaches have tried to overcome the need for nighttime data collection by using deep neural networks (DNNs) to synthe-size them, such as [6, 15, 29, 34]. However, such methods require large datasets for training and tend to produce arti-facts and sometimes unrealistic image content.
Contribution We present a method to reduce the reliance on carefully captured paired nighttime images. Speciﬁcally, we propose a procedure that processes daytime images to produce pairs of high-quality and low-quality nighttime im-ages as shown in Fig. 1. Our approach incurs minimal loss in image details and structure and does not require large datasets of nighttime images. Unlike capturing nighttime images under low-light conditions, capturing daytime im-ages with proper exposure is straightforward and does not require careful camera or scene setup. We show that our proposed framework is useful for nighttime image process-ing and enhancement through training neural ISPs to render noisy night raw-RGB images to their ﬁnal clean sRGB out-puts. We demonstrate that training on our synthetic night-time images mixed with a small amount of real data (e.g., 5% to 10%) produces performance almost on par with train-ing exclusively on real nighttime images. Our method sig-niﬁcantly reduces the time and effort needed to deploy neu-ral ISPs targeting nighttime imaging. 2.