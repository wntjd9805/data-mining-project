Abstract
Previous works on vanishing point detection usually use geometric prior for line segment clustering. We find that im-age context can also contribute to accurate line classifica-tion. Based on this observation, we propose to classify line segments into three groups according to three unknown-but-sought vanishing points with Manhattan world assumption, using both geometric information and image context in this work. To achieve this goal, we propose a novel Transformer based Line segment Classifier (TLC) that can group line segments in images and estimate the corresponding van-ishing points. In TLC, we design a line segment descrip-tor to represent line segments using their positions, direc-tions and local image contexts. Transformer based feature fusion module is used to capture global features from all line segments, which is proved to improve the classification performance significantly in our experiments. By using a network to score line segments for outlier rejection, van-ishing points can be got by Singular Value Decomposition (SVD) from the classified lines. The proposed method runs at 25 fps on one NVIDIA 2080Ti card for vanishing point detection. Experimental results on synthetic and real-world datasets demonstrate that our method is superior to other state-of-the-art methods on the balance between accuracy and efficiency, while keeping stronger generalization capa-bility when trained and evaluated on different datasets. 1.

Introduction
Under the pinhole camera model, parallel world lines in 3D are projected into 2D image lines that converge on an image point, which is called the vanishing point (VP).
Vanishing point detection is one of the most fundamental problems in computer vision. A fast and accurate vanishing point detection algorithm enables and enhances applications
*Corresponding Author
Figure 1. (a) Classical vanishing point detection methods usually depend on geometric prior for line segment clustering. However, it is not easy to determine which group the line segment (colored purple) should belong to only based on the geometric prior, since the line segment is close to both candidate horizontal vanishing points. (b) On the contrary, one can easily categorize the line seg-ment when the image context is given. The example is from [12].
Combining image context, it may become easier and faster to clus-ter a line segment to a certain group. Motivated by this obser-vation, we use both image context and geometric information in learning based line segment clustering for vanishing point detec-tion in this work. such as camera calibration, 3D reconstruction, object detec-tion, wireframe parsing, and autonomous driving.
Classical vanishing point detection methods usually fol-low three steps including line detection, line clustering and vanishing point regression. With Manhattan world assump-tion, line segments are supposed to be clustered into three groups according to the three orthogonal vanishing points.
Previous methods often consider the geometric prior that line segments in the same group should intersect at the same point (the vanishing point). Therefore, the image is often no longer used after the lines are extracted. However, as shown in Fig. 1, it is not easy to determine which group the line segment should belong to only based on the geometric prior, since the line segment is close to both candidate hori-zontal vanishing points. This ambiguity is eliminated when the image contexts are given, which shows the potential of the image contexts in improving the line clustering perfor-mance. Motivated by this observation, we employ image
contexts with geometric features in learning based line seg-ment clustering for vanishing point detection.
Recent learning based methods usually estimate vanish-ing points, horizon or score candidate vanishing points from the image contexts directly. In this work, we use networks to group line segments and remove outliers for vanishing point detection, which is demonstrated to be less likely to overfit on a certain dataset in our experiments. We present each detected line segment in the given image as a 1D fea-ture vector. For accurately classifying the line segments, it is important to propagate and gather global information from all line segments. Inspired by the good performance of
Transformers in many computer vision tasks, we use Trans-former encoder architecture to efficiently capture non-local correlation over all line segments. By considering the fea-ture vectors of line segments as a sequence of tokens, the
Transformer based feature fusion module can be easily ap-plied in our algorithm.
In this paper, we propose a novel method named Trans-former based line segment classifier (TLC) for real-time vanishing point detection in Manhattan world. Our method is composed of two modules including a line segment de-scriptor and a feature fusion module. Given an image and line segments in it, TLC first represents each line segment as a 1D feature vector consisting of both local image con-texts and geometric features with the line segment descrip-tor. The local image contexts are extracted from a Convo-lutional Neural Network (CNN) model followed by a novel line pooling operation. The geometric features are repre-sented by one-hot encoding of the direction and positions of points uniformly sampled from the line segment. Then the feature vectors are processed with a clustering network and a scoring network, respectively. These networks are designed based on Transformer encoder architecture for ef-ficient feature fusion. For each line segment, the clustering branch predicts the probability of each group it may belong to, and the scoring branch predicts a score meaning its con-fidence in detecting the corresponding vanishing point. Fi-nally the locations of the vanishing points can be calculated using Singular Value Decomposition (SVD) based on the clustered line segments and the predicted scores. The pro-posed TLC can classify line segments for vanishing point detection in a non-iterative manner and be end-to-end train-able. Therefore, the inferring speed of the proposed method is very fast and further post-processing can be applied on the clustered line segments easily.
The contributions of our work can be summarized be-low: (1) This work is the first one that uses learning based method to classify line segments for vanishing point detec-tion with both image contexts and geometric information. (2) For this goal, we propose a novel Transformer based
Line segment Classifier (TLC). In TLC, we present a novel line segment descriptor to represent a line segment with a 1-D feature vector, and use a Transformer based module to fuse features of different line segments. Our method can group line segments according to the vanishing points and predict their confidence score to be inliers in a non-iterative manner. (3) The proposed method runs at 25 FPS on one
NVIDIA 2080Ti card for vanishing point detection. Exper-imental results on synthetic and real-world datasets show that our method is superior to other state-of-the-art meth-ods on the balance between accuracy and efficiency, while keeping stronger generalization capability when trained and evaluated on different datasets. We also construct a real-world street view vanishing point (SVVP) dataset1 for fur-ther evaluating the proposed method. 2.