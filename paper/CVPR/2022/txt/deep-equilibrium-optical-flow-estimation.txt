Abstract 1.

Introduction
Many recent state-of-the-art (SOTA) optical flow mod-els use finite-step recurrent update operations to emulate traditional algorithms by encouraging iterative refinements toward a stable flow estimation. However, these RNNs im-pose large computation and memory overheads, and are not directly trained to model such “stable estimation”. They can converge poorly and thereby suffer from performance degra-dation. To combat these drawbacks, we propose deep equilib-rium (DEQ) flow estimators, an approach that directly solves for the flow as the infinite-level fixed point of an implicit layer (using any black-box solver) [3], and differentiates through this fixed point analytically (thus requiring O(1) training memory). This implicit-depth approach is not predicated on any specific model, and thus can be applied to a wide range of SOTA flow estimation model designs (e.g., RAFT [1] and
GMA [2]). The use of these DEQ flow estimators allows us to compute the flow faster using, e.g., fixed-point reuse and less training memory inexact gradients, consumes 4 than the recurrent counterpart, and achieves better results with the same computation budget. In addition, we propose a novel, sparse fixed-point correction scheme to stabilize our DEQ flow estimators, which addresses a longstanding challenge for DEQ models in general. We test our approach in various realistic settings and show that it improves SOTA methods on Sintel and KITTI datasets with substantially better computational and memory efficiency. 6
×
∼
*Equal contribution. Our code is available here.
Optical flow estimation is the classic computer vision task of predicting the pixel-level motions between video frames [1, 4–7]. Learning-based approaches to this problem, which outperformed classical approaches, proposed the use of conventional deep convolutional networks to learn a flow estimate [6–8]. Recent progress has shown that finite-step, unrolled and recurrent update operations significantly im-prove the estimation performance, exemplified by the emer-gence of the RAFT [1] method. Contemporary optical flow models that employ this approach typically rely on a Gated
Recurrent Unit (GRU) [9] to iteratively refine the optical flow estimate. This approach was motivated to emulate tradi-tional optimization-based methods, and the update operators defined accordingly have become the standard design for state-of-the-art flow models [1, 2, 10–12].
Despite their superior performance, these rolled-out re-current networks suffer from a few drawbacks. First, training these models involves tracking a long hidden-state history in the backpropagation-through-time (BPTT) algorithm [13], which yields a significant computational and memory bur-den. Therefore, these models tend to scale poorly with larger images and more iterations. Second, although these mod-els were designed to emulate traditional optimization ap-proaches which solve for a “stable estimate" with as many steps as needed, the recurrent networks do not directly model such a minimum-energy optima state. Rather, they stop after a predefined L update steps, and are still trained in a path-dependent way using BPTT. We also show later in Fig. 3 that the GRUs frequently oscillate instead of converging.
In this work, we introduce deep equilibrium (DEQ) flow estimators based on recent progresses in implicit deep learn-ing, represented by DEQ models [3, 14–17]. Our method functions as a superior and natural framework to replace the existing recurrent, unrolling-based flow estimation approach.
There are multiple reasons why this approach is preferable.
First, instead of relying on the naïve iterative layer stacking,
DEQ models define their outputs as the fixed points of a single layer fθ using the input x, i.e., z∗ = fθ (z∗, x), mod-eling an “infinite-layer” equilibrium representation. We can directly solve for the fixed point using specialized black-box solvers, e.g., quasi-Newton methods [18, 19], in a spirit much more consistent with the traditional optimization-based per-spective [5, 20]. This approach expedites the stable flow es-timation process while often yielding better results. Second, we no longer need to perform BPTT. Instead, DEQ models can directly differentiate through the final fixed point z∗ with-out having to store intermediary states during the forward computation, considerably lowering the training memory cost. Third, this fixed-point formulation justifies numerous implicit network enhancements such as 1) fixed-point reuse from adjacent video frames; and 2) inexact gradients [21–23].
The former helps avoid redundant computations, thus sub-stantially accelerating flow estimations; and the latter makes the backward pass computationally almost free! Fourth, the
DEQ approach is not predicated on any specific structure for fθ. Therefore, DEQ is a framework that applies to a wide range of these SOTA flow estimation model designs (e.g., RAFT [1], GMA [2], and Depthstillation [24]), and we can obtain the aforementioned computational and mem-ory benefits with even additional gain based on the specific structure of fθ.
In addition to suggesting DEQ flow estimators as a supe-rior replacement to the existing recurrent approach, we also tackle the longstanding instability challenge of training DEQ networks [3, 15, 25, 26]. Inspired by the RAFT model, we propose a novel, sparse fixed-point correction scheme that substantially stabilizes our DEQ flow estimators.
The contributions of this paper are as follows. First, we propose the deep equilibrium (DEQ) approach as a new nat-ural starting point for formulating optical flow methods. A
DEQ approach directly models and substantially accelerates the fixed-point convergence of the flow estimation process, avoids redundant computations across video frames, and comes with an almost-free backward pass. Second, we show that the DEQ approach is orthogonal to, and thus compat-ible with, the prior modeling efforts (which focus on the model design and feature extraction) [1, 2] and data-related efforts [10]. With DEQ, these prior arts are now more com-putationally and memory efficient as well as more accurate.
For instance, on KITTI-15 [27] (train) a zero-shot DEQ-based RAFT model further reduces the state-of-the-art F1-all measure by 14.0% while using the same underlying RAFT operator. Third, we introduce a sparse fixed-point correction scheme that significantly stabilizes DEQ models on optical flow problems while only adding minimal cost, and show that on flow estimation tasks this approach is superior to the recently proposed Jacobian-based regularization [26]. 2.