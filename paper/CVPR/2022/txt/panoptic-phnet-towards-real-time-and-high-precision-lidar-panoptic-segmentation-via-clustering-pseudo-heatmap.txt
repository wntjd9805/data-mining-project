Abstract
As a rising task, panoptic segmentation is faced with challenges in both semantic segmentation and instance seg-mentation. However, in terms of speed and accuracy, ex-isting LiDAR methods in the field are still limited. In this paper, we propose a fast and high-performance LiDAR-based framework, referred to as Panoptic-PHNet, with three attractive aspects: 1) We introduce a clustering pseudo heatmap as a new paradigm, which, followed by a cen-ter grouping module, yields instance centers for efficient clustering without object-level learning tasks. 2) A knn-transformer module is proposed to model the interaction among foreground points for accurate offset regression. 3)
For backbone design, we fuse the fine-grained voxel features and the 2D Bird’s Eye View (BEV) features with different receptive fields to utilize both detailed and global informa-tion. Extensive experiments on both SemanticKITTI dataset and nuScenes dataset show that our Panoptic-PHNet sur-passes state-of-the-art methods by remarkable margins with a real-time speed. We achieve the 1st place on the public leaderboard of SemanticKITTI and leading performance on the recently released leaderboard of nuScenes. 1.

Introduction
In recent years, there has been a rapid development of autonomous driving, and as an essential perception task of its key technologies, scene understanding has attracted con-siderable attention from researchers. Panoptic segmenta-tion is a recently introduced task in the image domain [18] that aims to unify semantic segmentation and instance seg-mentation in a single framework. With the release of Li-DAR point cloud benchmarks, e.g., SemanticKITTI [1] and nuScenes [10], related works in the 3D field have also been extensively promoted.
The purpose of LiDAR panoptic segmentation is not only to predict class labels for all points, including fore-ground points (thing) and background points (stuff ), but
Figure 1. Panoptic quality vs. single frame inference latency on
SemanticKITTI [1]. Green area indicates real-time zone, which meets 10 frame-per-second frequency. The 2D CNN based ap-proaches [22, 40], the 3D CNN based approach [14] and the com-bined methods [1] are shown in blue, red and gray respectively.
Our proposed Panoptic-PHNet outperforms all other methods in
PQ by a large margin and still maintains a real-time speed. also the instance IDs for thing points. According to the im-plementation of instance segmentation, panoptic segmenta-tion can be categorized into proposal-based and proposal-free approaches.
Proposal-based methods require an independent network or branch to predict proposals [1, 17], a drawback of which is that the capability of instance segmentation heavily de-pends on the performance of object detection.
In contrast, proposal-free ones [14, 19, 24] explore clustering-based methods for instance segmentation. Since such methods are not bothered with the inconsistency is-sue based on a cascade design, they are relatively elegant in respect of implementation. Yet the commonly used heuris-tic clustering algorithms, such as Mean Shift [7] and HDB-SCAN [4], are time-consuming and difficult to be acceler-ated with GPU. Although Panoptic-PolarNet [40] attempts to use a lightweight instance head from Panoptic-DeepLab
[5] to predict a center heatmap and offsets, the centers pre-dicted by the heatmap branch may not match the clustered locations from the offset branch. The possible inconsis-tency between these two independent branches limits such a method.
In general, the proposal-free methods learn the offset for each thing point, with which the point can be shifted to be near its instance center. Projecting all the shifted points onto a BEV pseudo image, we find that it shares a similar pattern with a learned center heatmap as Panoptic-PolarNet [40]. In other words, the projected image can be a natural heatmap to determine the existence of instances.
Specifically, given shifted thing points, we propose to create a clustering pseudo heatmap by projecting these points onto a BEV image directly, the number of points in each pixel, which we call the quantitative density, repre-sents the corresponding score. Thus, through the proposed pseudo heatmap, instance centers can be easily yielded by a window-based max-pooling and used to cluster all the thing points as [5].
In this way, we remove the separate heatmap learning branch and the inconsistency issue men-tioned above are hence eliminated. What you see is what you get, an object-level center is generated as long as there is a cluster of points.
Nevertheless, there are also such cases where multiple centers belonging to one instance may be generated due to inaccurate point offset regression. We further propose a center grouping module, which integrates such redundant centers, to maintains the completeness of instances.
Moreover, it is obvious that high-quality offset regres-sion leads to better shifted points for our clustering pseudo heatmap. Thus, inspired by Transformer [31], which is pop-ular in the natural language processing and computer vision fields, we introduce a knn-transformer module to model the interaction of thing points efficiently. Focusing on the re-lationship of spatial distance among local points, our knn-transformer promotes the offset regression with low com-putational consumption.
Regarding the design of backbone, we aggregate features at different scales more flexibly considering both accuracy and inference speed. We first extract fine-grained voxel fea-tures, which are then encoded in 2D BEV space with differ-ent receptive fields via a Unet-like network as PolarNet [37] for real-time purpose. The 2D BEV features are further mapped back to each voxel with the height dimension. By concatenating, the obtained voxel-wise features contain not only the 2D encoded features at different BEV scales, but also the fine-grained voxel features.
We evaluate our Panoptic-PHNet on SemanticKITTI and nuScenes datasets. Extensive experiments show that our ap-proach outperforms all the state-of-the-art methods on both of the two benchmarks (1st place on the public leaderboard of SemanticKITTI) with a real-time latency.
Our contributions are summarized as below:
• We propose a clustering pseudo heatmap generated from the shifted thing points directly without extra learning tasks, which allows us to avoid the incon-sistency issue between two independent branches and accelerate the clustering process. A center grouping module is further introduced to maintain the integrity of instances.
• We propose a knn-transformer module to efficiently model the interaction among thing points for accurate offset regression.
• We present a backbone network fusing the fine-grained voxel features and the BEV features at different scales, which, compared with the networks utilizing pure
BEV features, improves the final accuracy signifi-cantly at the cost of only a little time consumption.
• Experiments show that our approach achieves state-of-the-art performance on both SemanticKITTI and nuScenes datasets in real time, as shown in Fig. 1. 2.