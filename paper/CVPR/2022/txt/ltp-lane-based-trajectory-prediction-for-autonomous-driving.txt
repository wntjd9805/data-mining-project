Abstract
The reasonable trajectory prediction of surrounding traf-fic participants is crucial for autonomous driving. Espe-cially, how to predict multiple plausible trajectories is still a challenging problem because of the multiple possibilities of the future. Proposal-based prediction methods address the multi-modality issues with a two-stage approach, com-monly using intention classification followed by motion re-gression. This paper proposes a two-stage proposal-based motion forecasting method that exploits the sliced lane seg-ments as fine-grained, shareable, and interpretable propos-als. We use Graph neural network and Transformer to en-code the shape and interaction information among the map sub-graphs and the agents sub-graphs. In addition, we pro-pose a variance-based non-maximum suppression strategy to select representative trajectories that ensure the diversity of the final output. Experiments on the Argoverse dataset show that the proposed method outperforms state-of-the-art methods, and the lane segments-based proposals as well as the variance-based non-maximum suppression strategy both contribute to the performance improvement. More-over, we demonstrate that the proposed method can achieve reliable performance with a lower collision rate and fewer off-road scenarios in the closed-loop simulation. 1.

Introduction
Forecasting possible trajectories of surrounding agents is a crucial as well as challenging problem for autonomous driving, especially for multi-mode traffic scenes with uncer-tain future possibilities.
Early methods [11, 16] only learn a deterministic trajec-tory, resulting in output averaging in multi-mode scenes, also called the mode collapse issue.
Probabilistic ap-proaches [2, 4] are proposed to generate multi-modal out-puts by modeling diverse trajectories with a probability dis-*These authors contributed equally to this work.
†Corresponding author. tribution (e.g., GMM). However, the predicted trajectories of these methods are poor in interpretability and depend heavily on the predefined distribution.
To address the aforementioned multi-modality problem, proposal-based methods [8, 14, 24] decouple the trajec-tory prediction problem into classification-based intention prediction and regression-based motion prediction. Some works [8, 24] artificially sample target points, unique for each predictable agent, as proposals, which could not be reused for other predictable agents. Lapred [10] utilizes en-tire lanes as proposals, making it hard to model fine-grained intentions. Therefore, it is crucial to choose proposals that can (i) model the intention accurately, and (ii) be shared among all agents.
Furthermore, how to select representative trajectories is also a vital issue. The proposal-based methods generate a cluster of candidate trajectories based on the proposals. It is defective to output top-k trajectories merely ordered by the probability of the predicted proposals, since some inten-tions, though slightly lower in probability, are very critical for safety. Traditional methods utilize the Non-Maximum
Suppression (NMS) algorithm, given a fixed threshold, to select the trajectories outside the threshold area into the out-put set greedily and successively. However, a fixed thresh-old cannot balance accuracy and variety. Therefore, some methods [7, 8] try to output multiple trajectories through optimization-based methods, causing complicated work-flow and increased computation cost.
In this paper, we propose a novel Lane-based Trajectory
Prediction (LTP) method for autonomous driving. We ar-gue that there is no need for any complicated hand-craft proposals because the lane segments in the map are suit-able proposals for intention modeling by nature. There are three advantages of using lane segments as proposals: (i)
Each lane segment explicitly represents a fine-grained intention. Lane segments can represent tactical-level in-tentions, such as “change right for overtaking” or “change right for parking.” While the method using the entire road lanes as proposals can only learn the road-level intention like “change left” or “change right.” [10] (ii) The interac-tion between the lane segments and the agents can be well captured. When learning interaction with the map, the representation of the lane segments will naturally pass through the network. Thereby, it will generate a more infor-mative embedding, unlike the TNT [24] which directly con-catenates the unlearned point-level proposals to the agents embedding. (iii) The lane segments-based proposals can be shared among agents. The lane segments are indepen-dent of the agents, which means that once learned through the backbone, the embedding of the lane segments is fixed, no matter how many agents to predict. Just by concatenat-ing the embedding of the agents and the lane segments, the different agents in the same scene can be predicted in par-allel, unlike the DenseTNT [8] which needs to learn unique proposals embedding for different agents.
Based on these proposals, our method predicts which lane segment will be the future destination and regresses the corresponding trajectory. Furthermore, we found that the variance of the learned lane segments probability scores represents the uncertainty of the model to the current situa-tion. Therefore, we propose a variance-based NMS method, which dynamically adjusts the NMS threshold according to the variance of the top-k prediction scores and achieves the balance of accuracy and variety.
The contributions of this paper are summarized as fol-lows:
• A lane-based trajectory prediction method with ex-plicit intention modeling is proposed, which uses lane segments as proposals to predict all agents in one shot.
• A novel variance-based NMS algorithm is proposed, which achieves the balance of accuracy and diversity by dynamically adjusting the NMS threshold accord-ing to the uncertainty of the prediction output.
• We outperform all published methods on the Argov-erse forecasting benchmark. We also show that the proposed LTP could achieve reliable performance as a planner in closed-loop simulation. 2.