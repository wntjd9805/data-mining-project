Abstract
Accurate prediction of future human positions is an es-sential task for modern video-surveillance systems. Current state-of-the-art models usually rely on a “history” of past tracked locations (e.g., 3 to 5 seconds) to predict a plausible sequence of future locations (e.g., up to the next 5 seconds).
We feel that this common schema neglects critical traits of realistic applications: as the collection of input trajectories involves machine perception (i.e., detection and tracking), incorrect detection and fragmentation errors may accumu-late in crowded scenes, leading to tracking drifts. On this account, the model would be fed with corrupted and noisy input data, thus fatally affecting its prediction performance.
In this regard, we focus on delivering accurate predic-tions when only few input observations are used, thus poten-tially lowering the risks associated with automatic percep-tion. To this end, we conceive a novel distillation strategy that allows a knowledge transfer from a teacher network to a student one, the latter fed with fewer observations (just two ones). We show that a properly defined teacher super-vision allows a student network to perform comparably to state-of-the-art approaches that demand more observations.
Besides, extensive experiments on common trajectory fore-casting datasets highlight that our student network better generalizes to unseen scenarios. 1.

Introduction
Pedestrian trajectory forecasting deals with predicting future paths through the exploitation of individual trajectory information and mutual influence between pedestrians. This task has several practical applications in advanced surveil-lance systems [24], behavioral analysis [32], intrusion de-tection [39], smart vehicles and autonomous systems [4,37].
While several recent works focused on novel deep-network architectures tailored for this task [14, 15, 20, 35, 49, 52], we believe the inference phase of a trajectory pre-dictor has not been thoroughly addressed and investigated yet. Typically, data-driven models are trained and evalu-ated on large public datasets of tracked trajectories refined with a human intervention to correct missed detections and identity switches. However, this process is unfeasible at in-ference time: therefore, the input trajectories required to condition the prediction have to be automatically extracted by a tracking system.
In this regard, the widely adopted 8-12 protocol [1,15,20, 22,34,48,52] (i.e., 8 input time steps and 12 ones for predic-tion), which require data collected at 2.5 FPS, does not pro-vide a large margin of correction for the above situations. In real-time applications, a visual tracking system may provide inaccurate observations for sequences of such length [12]: occlusions, false detections and non-rigid shape deforma-tions pose non-trivial issues.
To overcome the aforementioned limitations, one poten-tial solution is to reduce the length of the input trajecto-ries to the extent we can minimize the tracking associa-tions errors. Based on this intuition, this work proposes an approach based on Knowledge Distillation [18], which recovers a reliable proxy of the same information obtained with more input observations. We show that it allows for an effective inference schema, requiring fewer samples than the training one. We also demonstrate that properly condi-tioning a model on shorter input trajectories provides more room to generalize across different experimental settings.
From a technical perspective, this work implements our idea by deploying a teacher-student paradigm [18]: a stu-dent network is trained to mimic a teacher’s behaviour using less input observations. Each network devises a transformer-based architecture that accounts for both spa-tial and temporal interactions through an attention mecha-nism. To deal with a limited number of observations, we propose a distillation procedure that acts on both encoder and decoder stacks of the transformer architecture. Finally, our objective function takes into account ground-truth data and distillation losses to conveniently match teacher and student internal representations.
We remark the following contributions: i) to the best of our knowledge, this is the first attempt to in-depth analyze the effectiveness (at inference time) of the evaluation pro-tocol commonly employed by current trajectory prediction models; ii) we introduce a novel distillation strategy to re-duce the length of the input trajectories while keeping the prediction accurate; iii) we explore the student’s capabili-ties in adapting and transferring its knowledge to scenar-ios exhibiting different levels of complexity in terms of hu-man dynamics and scene interactions. Indeed the experi-ments highlights that is possible to construct a solid trajec-tory forecasting system that at inference time is fed only with just 2 observation (i.e. last two) per-pedestrian. This is possible only through the thoughtful exploitation of the global knowledge that can be inferred from training data and distilled into the inference model. 2.