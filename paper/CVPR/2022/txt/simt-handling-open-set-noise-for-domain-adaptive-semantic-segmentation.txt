Abstract
This paper studies a practical domain adaptive (DA) se-mantic segmentation problem where only pseudo-labeled target data is accessible through a black-box model. Due to the domain gap and label shift between two domains, pseudo-labeled target data contains mixed closed-set and open-set label noises. In this paper, we propose a simplex noise transition matrix (SimT) to model the mixed noise distributions in DA semantic segmentation and formulate the problem as estimation of SimT. By exploiting computa-tional geometry analysis and properties of segmentation, we design three complementary regularizers, i.e. volume regu-larization, anchor guidance, convex guarantee, to approxi-mate the true SimT. Specifically, volume regularization min-imizes the volume of simplex formed by rows of the non-square SimT, which ensures outputs of segmentation model to fit into the ground truth label distribution. To compen-sate for the lack of open-set knowledge, anchor guidance and convex guarantee are devised to facilitate the modeling of open-set noise distribution and enhance the discrimina-tive feature learning among closed-set and open-set classes.
The estimated SimT is further utilized to correct noise is-sues in pseudo labels and promote the generalization abil-ity of segmentation model on target domain data. Extensive experimental results demonstrate that the proposed SimT can be flexibly plugged into existing DA methods to boost the performance. The source code is available at https:
//github.com/CityU-AIM-Group/SimT. 1.

Introduction
DA semantic segmentation aims to adapt a segmentation model for the target domain through transferring knowl-edge from a source domain [22]. Considering the inef-ficient transmission and privacy issues in source domain knowledge, effective adaptation with only pseudo-labeled target data obtained through a black-box model is practi-cal in real-world deployments [19]. This paper mainly fo-cuses on this realistic scenario, and the challenge of this DA
∗Yixuan Yuan is the corresponding author. semantic segmentation problem lies in noisy pseudo labels generated for target domain data. To mitigate noisy adap-tation, some methods leverage confidence score [13, 25, 50] or uncertainty [17, 46] to select reliable pseudo labels. For example, prior work [50] defines a threshold to eliminate low-confidence pseudo-labeled pixels. However, simply dropping confusing pixels with highly potential noise la-bels might lead to learn from a biased data distribution
[48]. In fact, confusing pixels are more prone to be mis-labeled and critical for accurate predictions, hence need to be carefully addressed.
Instead of discarding unreliable pseudo-labeled target data, other methods denoise pseudo labels based on prototypes [42] or correct supervision signal through noise transition matrix (NTM) [11]. Nevertheless, these approaches heavily rely on the assumption of a shared label set between two domains and only consider the closed-set noisy pseudo labels. In real-world scenarios, the label space of target domain may not be consistent with that of source domain, and open-set class instances are commonly encountered in target domain. Hence, enhancing the seg-mentation performance on target domain needs to carefully address confusing pixels and open-set label noises.
With the aforementioned aims, we model the closed-set and open-set noise distributions in target pseudo labels through a SimT, which is a class-dependent and instance-independent transition matrixa. Then the modeled noise distribution is leveraged to rectify supervision signals (i.e. loss) derived from noisy labels, thus all target samples are fully utilized. Therefore, the problem of alleviating closed-set and open-set noise issues can be treated as the prob-lem of estimating SimT. To give an intuitive explanation of
SimT, we interpret SimT through a geometric analysis on a toy example in Figure 1. In this toy example, SimT is de-fined as a matrix T ∈ [0, 1]5×3, as illustrated in Figure 1 (a). Each row, i.e. T c,:, indicates the probability of label c flipping to three classes, which can be regarded as a three-dimensional point within the blue triangle of Figure 1 (b) since coordinates of this point add up to 1. The first three rows [T 1,:, T 2,:, T 3,:] of SimT model closed-set noise dis-This work was supported by Hong Kong Research Grants Council (RGC) General Research Fund 11211221(CityU 9043152). aThe complex instance-dependent label noise in real-world can be well approximated by class-dependent label noise when the noise rate is low [4].
which can detect open-set noises from pseudo-labeled tar-get data and approximate the true SimT.
To this end, we propose three regularizers, i.e. volume regularization, anchor guidance and convex guarantee, for the estimation of SimT. Specifically, volume regularization for non-square SimT estimation is designed to approximate the true SimT, which is the one with minimum volume (Sim{T }) among all simplices enclosing p((cid:101)y | x) (e.g.,
Sim{T ′}) in Figure 1 (c). The minimum volume of SimT ensures outputs of segmentation model to fit into clean class posteriors. To prevent the trivial solution of open-set part in
SimT, we devise anchor guidance regularization.
In par-ticular, we first define anchor point as the most representa-tive pixel of each class with the largest clean class poste-rior probability as in Figure 1 (c). Sim{T ′′} formed by all anchor points is an approximation to the true SimT, hence we leverage anchor points to guide the estimation of SimT.
To further facilitate the detection of anchor points in open-set classes, an auxiliary loss enhancing the discriminative feature learning among closed-set and open-set data is de-signed. Moreover, the trivial solution of open-set part may lead to non-convex Sim{T ′′′}. Hence, we advance convex guarantee to preserve the convex property of SimT, and the convex SimT can implicitly push the learned feature distri-bution of open-set classes away from closed-set classes.
We summarize our contributions in three aspects.
• We present a general and practical DA semantic seg-mentation framework to robustly learn from noisy pseudo-labeled target data, including closed-set and open-set label noises. To our best knowledge, it repre-sents the first attempt to address the problem of open-set noisy label in DA.
• We, for the first time, model the closed-set and open-set noise distributions of target pseudo labels through
SimT, and utilize computational geometry analysis to estimate it. The optimized SimT is used to benefit loss correction for noisy pseudo-labeled target data.
• Extensive experiments are conducted to verify the ef-fect of the proposed SimT and demonstrate that it can be plugged into existing DA methods, such as UDA or
SFDA, to boost the performance. 2.