Abstract
Advection-diffusion equations describe a large family of natural transport processes, e.g., fluid flow, heat transfer, and wind transport. They are also used for optical flow and perfusion imaging computations. We develop a ma-chine learning model, D2-SONATA, built upon a stochas-tic advection-diffusion equation, which predicts the velocity and diffusion fields that drive 2D/3D image time-series of transport. In particular, our proposed model incorporates a model of transport atypicality, which isolates abnormal dif-ferences between expected normal transport behavior and the observed transport. In a medical context such a normal-abnormal decomposition can be used, for example, to quan-tify pathologies. Specifically, our model identifies the ad-vection and diffusion contributions from the transport time-series and simultaneously predicts an anomaly value field to provide a decomposition into normal and abnormal ad-vection and diffusion behavior. To achieve improved estima-tion performance for the velocity and diffusion-tensor fields underlying the advection-diffusion process and for the esti-mation of the anomaly fields, we create a 2D/3D anomaly-encoded advection-diffusion simulator, which allows for su-pervised learning. We further apply our model on a brain perfusion dataset from ischemic stroke patients via trans-fer learning. Extensive comparisons demonstrate that our model successfully distinguishes stroke lesions (abnormal) from normal brain regions, while reconstructing the under-lying velocity and diffusion tensor fields. 1.

Introduction
Partial differential equations (PDEs) are used to describe many transport phenomena, e.g., fluid dynamics, heat con-duction, and wind dynamics [12]. However, it is expensive to numerically solve PDEs especially in high spatial dimen-sions and across large timescales [6]. Recent deep learning
This work was supported by the National Institutes of Health (NIH) under award number NIH 2R42NS086295 and NIH R21NS125369. approaches have made data-driven solutions to PDEs possi-ble [8, 16, 33, 38, 46, 51, 55, 56].
While the aforementioned deep learning approaches help to speed-up PDE solutions, we are instead interested in in-verse PDE problems [34, 59]. Specifically, our goal is to estimate the spatially varying velocity and diffusion ten-sor fields (referred to as advection-diffusion parameters throughout this manuscript) for general advection-diffusion
PDEs. Limited work on estimating the parameter fields of advection-diffusion equations exists. Tartakovsky et al. [59] use a deep neural network (DNN) to estimate 2D diffusion fields from diffusion PDEs. B´ezenac et al. [12] learn ve-locity and diffusion fields of advection-diffusion PDEs by
DNNs in 2D. Koundal et al. [29] use optimal mass trans-port combined with a spatially constant diffusion. Op-timization approaches were proposed [35, 36, 63] to esti-mate the advection-diffusion parameters of an advection-diffusion equation in 3D. Though promising, the numerical optimization approach is time-consuming, especially when dealing with large datasets. Moreover, the methods above assume isotropic diffusion (i.e., they do not estimate more general diffusion tensors), which may be insufficient to ac-curately model complex materials (e.g., anisotropic porous media, brain tissue) where diffusion is mostly anisotropic.
The YETI approach by Liu et al. [37] is a deep learn-ing framework to estimate advection-diffusion parameters
It addresses some key from transport image time-series. challenges regarding identifiability (i.e., whether the result-ing transport should be attributed to advection or diffu-sion) and physical constraints (e.g., vector fields should be divergence-free for fluid flow, diffusion tensors should be positive semi-definite (PSD)). Applied on brain perfusion images for stroke lesion detection, YETI achieved clear im-provements over existing approaches. However, there is still room for improvement. First, while YETI estimates the advection-diffusion parameters well, it would be useful to quantify the inherent uncertainty in the resulting solutions instead of interpreting the results deterministically. This
could be especially important when estimating advection-diffusion parameters from abnormal transport processes, e.g., brain perfusion processes for a stroke patient. Sec-ond, YETI predicts advection-diffusion parameters without knowledge of regional anomalies. Hence, additional post-processing is required for lesion detection in real perfusion analysis applications. Furthermore, YETI uses pre-training based on a simulation dataset which only considers normal transport; fine-tuning is then performed using real perfu-sion data including stroke lesions. This simulation and fine-tuning approach may result in pre-training biased toward normal parameterizations, as abnormal transport data is not simulated. (See the comparisons in Sec. 4.1-4.2.)
We introduce, D2-SONATA (Deep Decomposition for
Stochastic Normal-Abnormal Transport), a new deep-learning-based stochastic model designed to predict the underlying advection-diffusion parameters from observed transport time-series with potential anomalies, in both 2D and 3D.1 Our main contributions are threefold: 1) A learning-based stochastic advection-diffusion
D2-SONATA models advection-diffusion model. processes as a stochastic system. Given a transport process, this stochastic model permits not only recon-structing the transport dynamics with its underlying advection-diffusion parameters, but also captures the epistemic uncertainties with Brownian motion. 2) Representation theorems for anomaly-decomposed divergence-free vector fields and symmetric PSD ten-sor fields. Our estimates are grounded in theorems en-suring realistic constraints on the learned advection-diffusion parameter fields by construction. The esti-mation automatically provides a decomposition based on an anomaly value field and the “anomaly-free” advection-diffusion parameters. This provides insights into both the anomaly patterns and what should locally be considered normal advection-diffusion parameters. 3) 2D/3D normal-abnormal advection-diffusion dataset.
We develop a simulator for quasi-realistic advection-diffusion that can be used for supervised model pre-training based on the advection-diffusion parameters.
Importantly, the simulator is able to generate velocity vector and diffusion tensor fields and applies artificial anomalies. We show that such simulated data boosts model performance for advection-diffusion parameter prediction, in particular for abnormal transport. 2.