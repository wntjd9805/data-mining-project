Abstract
Demystifying the interactions among multiple agents from their past trajectories is fundamental to precise and inter-pretable trajectory prediction. However, previous works only consider pair-wise interactions with limited relational reasoning. To promote more comprehensive interaction mod-eling for relational reasoning, we propose GroupNet, a mul-tiscale hypergraph neural network, which is novel in terms of both interaction capturing and representation learning.
From the aspect of interaction capturing, we propose a train-able multiscale hypergraph to capture both pair-wise and group-wise interactions at multiple group sizes. From the aspect of interaction representation learning, we propose a three-element format that can be learnt end-to-end and explicitly reason some relational factors including the inter-action strength and category. We apply GroupNet into both
CVAE-based prediction system and previous state-of-the-art prediction systems for predicting socially plausible trajec-tories with relational reasoning. To validate the ability of relational reasoning, we experiment with synthetic physics simulations to reflect the ability to capture group behaviors, reason interaction strength and interaction category. To validate the effectiveness of prediction, we conduct exten-sive experiments on three real-world trajectory prediction datasets, including NBA, SDD and ETH-UCY; and we show that with GroupNet, the CVAE-based prediction system out-performs state-of-the-art methods. We also show that adding
GroupNet will further improve the performance of previous state-of-the-art prediction systems. 1.

Introduction
Multi-agent trajectory prediction aims to predict future trajectories of agents conditioned on past movements. This task is not only critical to numerous real-world applications, such as autonomous driving and human behavior understand-*Corresponding author.
Code is available at: https://github.com/MediaBrain-SJTU/GroupNet
Figure 1. GroupNet captures both pair-wise and group-wise inter-actions among multiple agents from their trajectories and infers the interaction category and strength for each interaction group. ing, but also serves as a foundation to bridge the knowledge of the past and the action for the future. At least three factors would affect each agent’s dynamics: ego momentum, instan-taneous intent, and social influence from the other agents.
The first factor has been well studied [36]; the second factor is unpredictable; and the third factor is an emerging research topic and the focus of this work. To demystify the social in-fluence, we need to model and reason the interactions among agents based on their past spatio-temporal states, potentially leading to precise and interpretable trajectory prediction.
Many works have tried to model the interactions through social operations [1, 13, 43], graph-based modeling [14, 15, 18, 23] and attention mechanism [27, 33, 38]. Although these methods have greatly improved the empirical performances of trajectory prediction, they underestimate the significance of relational reasoning. Some previous works, such as
NRI [17] and Evolvegraph [23], took a step forward towards explicit relational reasoning; however, they still have limita-tion from two aspects. First, only pair-wise interactions are modeled. In many scenarios, such as on a basketball court, a group of players execute a defensive strategy cooperatively; in the ocean, a school of fish coordinate their movements to evade predators, reflecting collective behaviors. While this kind of group-wise interaction is common, they have rarely been modeled. Second, only interaction categories are explicitly reasoned by the current methods, while the intensity level of the agent interaction cannot be reflected.
To further promote more comprehensive relational rea-soning in trajectory prediction, this work puts efforts on two aspects: interaction capturing and interaction representation
learning. To capture more interactions, we propose a multi-scale hypergraph, which consists of a series of hypergraphs to model group-wise interactions with multiple group sizes.
Instead of using handcrafted designs, we learn such a mul-tiscale hypergraph topology in a data-driven manner. To learn the interaction embedding, we propose a three-element representation format: the neural interaction strength, the neural interaction category and the per-category function, which can reflect the interaction strength and category in an interactive group. Based on neural message passing over the multiscale hypergraph, we merge this three-element interac-tion embedding in the representation learning process.
Overall, we integrate these two designs and propose
GroupNet, a multiscale hypergraph neural network, to cap-ture social interactions for better trajectory prediction. The proposed GroupNet has two significant advantages: 1) strong ability of relational reasoning. Through extensive synthetic physics experiments, we validate that GroupNet is able to capture group behaviors, infer interaction strength and in-teraction category during trajectory prediction without any relation supervision; and 2) strong ability of plug-and-play.
As a general and comprehensive social modeling module,
GroupNet can be easily plugged in a prediction framework and improve its previous performance. For example, based on a straightforward CVAE-based framework, GroupNet significantly improves the prediction performance, leading to competitive or leading results on three real-world pre-diction benchmarks. Furthermore, for those current state-of-the-art prediction models, NMMP [14] on NBA dataset,
PECNet [27] on SDD dataset and Trajectron++ [34] on ETH-UCY datasets, GroupNet brings significant benefit and lifts their results to even better performances on each dataset. The main contributions of this paper are summarized as follow:
• We propose GroupNet, a novel multiscale hypergraph neural network to model complex social influences for better trajectory prediction. GroupNet can capture both pair-wise and group-wise interactions at various group sizes and reflect interaction strength and interaction category.
• We validate the relational-reasoning ability of GroupNet via extensive synthetic simulations and show that GroupNet can capture group behaviors, interaction strength and inter-action category in an unsupervised setting; see Section 6.2.
• With GroupNet, a simple CVAE-based framework achieves competitive performances on three real-world pre-diction benchmarks. We also show many state-of-the-art prediction systems can be significantly improved by replac-ing their social modules with GroupNet; see Section 6.3. 2.