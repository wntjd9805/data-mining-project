Abstract
Instance-level feature matching is significantly impor-tant to the success of modern one-shot object detectors. Re-cently, the methods based on the metric-learning paradigm have achieved an impressive process. Most of these works only measure the relations between query and target ob-jects on a single level, resulting in suboptimal performance overall. In this paper, we introduce the balanced and hi-erarchical learning for our detector. The contributions are two-fold: firstly, a novel Instance-level Hierarchical Rela-tion (IHR) module is proposed to encode the contrastive-level, salient-level, and attention-level relations simultane-ously to enhance the query-relevant similarity representa-tion. Secondly, we notice that the batch training of the IHR module is substantially hindered by the positive-negative sample imbalance in the one-shot scenario. We then in-troduce a simple but effective Ratio-Preserving Loss (RPL) to protect the learning of rare positive samples and sup-press the effects of negative samples. Our loss can ad-just the weight for each sample adaptively, ensuring the desired positive-negative ratio consistency and boosting query-related IHR learning. Extensive experiments show that our method outperforms the state-of-the-art method by 1.6% and 1.3% on PASCAL VOC and MS COCO datasets for unseen classes, respectively. The code will be available at https://github.com/hero-y/BHRL. 1.

Introduction
Development of modern deep learning architectures gives rise to great advances in general object detection
*Corresponding author.
[10, 19, 24, 33]. However, deep detectors necessitate mas-sive, high-quality yet expensive annotated data to reach per-formance saturation, which is extremely difficult for prac-tical applications. Inspired by the human ability of learn-ing new concepts with very little supervision, some recent works [23, 25, 29, 30, 34] attempt to apply few-shot learn-ing techniques to detect novel-class objects from extremely few novel-class data. Yet, the majority focus on finetune-based strategies by adapting pre-trained detectors to limited unseen-class samples. Such deep detectors usually suffer from generalization limitations, such as the catastrophic for-getting of base classes, the underutilization of novel data, and the severe shift in data distribution.
The One-Shot Object Detection (OSOD) [2,12,22] with-out finetuning aims to detect all interesting objects in the target image with the same novel class of single query im-age patch. A noteworthy effort has been made to exploit the instance matching techniques and build semantic relations for the query-target region proposals. Some early develop-ments [12, 22] integrate effective metric-learning solutions with the general object detectors (e.g., Faster R-CNN [24]) to learn a similarity metric. For example, SiamMask [22] uses the matching module to correlate the query image and target image. CoAE [12] proposes to apply non-local scheme [28] for exploring the relation feature. Although such methods are capable of achieving fast and effective adaption to novel classes through a single query image patch, they lack accurate modeling of multi-level seman-tic relations for the query-target pairs. Intuitively, the single relation measure may lead to a certain similarity deviation, thus reducing the generalization ability of the learned de-tector. Some modern approaches [2, 8, 30] propose to cap-ture seen-unseen semantic structure via more fine-grained relation learning. For example, [8] introduces three relation
heads to exploit different matching relationships. However, it ignores the importance of the fusion of different relation features and adopts the global relation features that leads to spatial information loss of relation features. AIT [2] deploys the transformer architecture to explore the visual characteristics in each proposal-query pair, but it does not explicitly tie visual semantics for query and target repre-sentations in a compositional way.
To this end, we first introduce a novel Instance-level
Hierarchical Relation (IHR) module that can infer multi-level semantic relations for generating query-target simi-larity features. Specifically, we initially use region pro-posal network to extract instance-level feature maps. Then, the IHR module decomposes query-target feature matching into three hierarchical semantic levels, which are respon-sible to capture the global difference, local salient region, and local discriminative part, respectively. The global dif-ference reveals that the target object should be described by using its contrastive characteristics when being compared with the query object. The local salient region is extracted by depthwise convolution architecture to better contain dif-ferent activation patterns and infer instance-level saliency semantics. The local discriminative part is learned by the attention mechanism to capture the distinct features that af-fect the matching. Different levels of semantic coverage can guide the learning of diverse and hierarchical features for query-target matching to aggregate both global and local details. For each relation branch, we maintain the resolution consistency of the output relation feature and the input re-gion feature to avoid the loss of context information. Subse-quently, these three kinds of relation features are integrated to promote the discriminative and localization ability.
Additionally, we claim that the prevailing wisdom such as random sampling scheme [24] in general two-stage de-tectors for dealing with sample imbalance is not efficient due to a small positive-negative ratio in the OSOD task.
This leads to the unbalanced training and suboptimal per-formance of the above IHR module. Accordingly, we pro-pose a simple but effective Ratio-Preserving Loss (RPL) to reweight the samples in the training process for achieving balanced IHR learning. We adaptively adjust the sample weights to maintain a suitable and stable positive-negative sampling ratio. With such a one-shot sample reweight-ing scheme, the rare positive-pair relations for seen classes would be identified and contribute more to the final discrim-inative detection. Thus, our learned detector offers great po-tential to detect novel classes with complex semantic simi-larities and differences.
Our key contributions are summarized as follows:
• We design a powerful multi-level relation module named IHR for the OSOD task. It exploits the semantic similarities on the contrastive-level, salient-level, and attention-level simultaneously, aiming to find more comprehensive relations between query image patch and target image.
• We propose a simple but effective RPL to solve the im-balance issue of positive-negative samples for achiev-ing balanced and effective learning of the IHR module.
• Extensive experiments show that our detector outper-forms the state-of-the-art method by 1.6% and 1.3% on
PASCAL VOC and MS COCO datasets, respectively, which validates its effectiveness. 2.