Abstract
Stitched images provide a wide ﬁeld-of-view (FoV) but suffer from unpleasant irregular boundaries. To deal with this problem, existing image rectangling methods devote to searching an initial mesh and optimizing a target mesh to form the mesh deformation in two stages. Then rectangu-lar images can be generated by warping stitched images.
However, these solutions only work for images with rich linear structures, leading to noticeable distortions for por-traits and landscapes with non-linear objects.
In this paper, we address these issues by proposing the
ﬁrst deep learning solution to image rectangling. Con-cretely, we predeﬁne a rigid target mesh and only estimate an initial mesh to form the mesh deformation, contribut-ing to a compact one-stage solution. The initial mesh is predicted using a fully convolutional network with a resid-ual progressive regression strategy. To obtain results with high content ﬁdelity, a comprehensive objective function is proposed to simultaneously encourage the boundary rect-angular, mesh shape-preserving, and content perceptually natural. Besides, we build the ﬁrst image stitching rectan-gling dataset with a large diversity in irregular boundaries and scenes. Experiments demonstrate our superiority over traditional methods both quantitatively and qualitatively. 1.

Introduction
Image stitching algorithm [3, 12, 20, 29] can gener-ate a wide FoV image (Fig.1b) from normal FoV images (Fig.1a). These methods optimize a global or local warp to align the overlapping regions of different images. Neverthe-less, non-overlapping regions always suffer from irregular boundaries [2]. People who use image stitching technology have to be tolerant of unpleasant boundaries.
To deal with the irregular boundaries, one of the solu-tions is to crop a stitched image with a rectangle. However,
∗Corresponding author cropping inevitably reduces the FoV of the stitched image, which contradicts the original intention of image stitching.
Fig.1c demonstrates an example, where the dark regions in-dicate the discarded areas by cropping. On the other hand, image completion can synthesize the missing regions to form a rectangular image. Nevertheless, there is currently no work to design a mask for irregular boundaries in im-age stitching, and even SOTA completion works [25, 27] show unsatisfying performance (Fig.1d) when processing the stitched images. Moreover, the completion methods may add some contents that seem to be harmonious but dif-ferent from reality, making them unreliable in high-security applications such as autonomous driving [11].
To obtain a rectangular image with high content ﬁ-delity, image rectangling methods [6, 7, 13] are proposed to warp a stitched image to a rectangle via mesh deformation.
However, these solutions can only preserve structures with straight/geodesic lines such as buildings, boxes, pillars, etc.
For non-linear structures such as portraits [26], distortions are usually generated. Actually, the capability to preserve linear structures is limited by line detection, thus distortions also occur in linear structures sometimes (Fig.1e). More-over, these traditional methods are two-stage solutions that search an initial mesh and optimize a target mesh succes-sively, making it challenging to be parallelly accelerated.
To address the above problems, we propose the ﬁrst one-stage learning baseline, in which we predeﬁne a rigid target mesh and only predict an initial mesh. Speciﬁcally, we de-sign a simple but effective fully convolutional network to estimate a content-aware initial mesh from a stitched im-age with a residual progressive regression strategy. Besides, a comprehensive objective function consisting of a bound-ary term, a mesh term, and a content term is proposed to simultaneously encourage the boundary rectangular, mesh shape-preserving, and content perceptually natural. Com-pared with the existing methods, our content-preserving ca-pability is more general (not limited to linear structures) and more robust (Fig.1f) due to the effective semantic percep-tion in our content constraint.
Figure 1. Different solutions to irregular boundaries in image stitching. (a) A classic image stitching dataset that is not included in the proposed dataset (APAP-conssite [29]). (c) Cropping the boundaries to get a rectangular image. (d) Completing the missing regions using LaMa [25]. (e) He et al.’s rectangling [7] with noticeable distortions. (f) Our rectangling with high content ﬁdelity. (b) Stitching images using UDIS [23] with inevitable irregular boundaries.
As there is no proper dataset readily available, we build a deep image rectangling dataset (DIR-D) to supervise our training. First, we apply He et al.’s rectangling [7] to real stitched images to generate synthetic rectangular images.
Then we utilize the inverse of rectangling transformations to warp real rectangular images to synthetic stitched images.
Finally, we manually ﬁlter out images without distortions from tens of thousands synthetic images for several epochs strictly, yielding a dataset with 6,358 samples.
Experimental results show that our approach can gen-erate content-preserving rectangular images efﬁciently and effectively, outperforming the existing solutions both quan-titatively and qualitatively. To sum up, we conclude our contributions as follows:
• We propose the ﬁrst deep rectangling solution for im-age stitching, which can effectively generate rectangu-lar images in a residual progressive manner.
• Existing methods are two-stage solutions while ours is a one-stage solution, enabling efﬁcient parallel com-putation with a predeﬁned rigid target mesh. Besides, ours can preserve both linear and non-linear structures. 2.