Abstract
Transformer-based methods have achieved great success in the ﬁeld of human-object interaction (HOI) detection.
However, these models tend to adopt semantically ambigu-ous queries, which lowers the transformer’s representation learning power. Moreover, there are a very limited num-ber of labeled human-object pairs for most images in ex-isting datasets, which constrains the transformer’s set pre-diction power. To handle the ﬁrst problem, we propose an efﬁcient knowledge distillation model, named Distillation using Oracle Queries (DOQ), which shares parameters be-tween teacher and student networks. The teacher network adopts oracle queries that are semantically clear and gener-ates high-quality decoder embeddings. By mimicking both the attention maps and decoder embeddings of the teacher network, the representation learning power of the student network is signiﬁcantly promoted. To address the sec-ond problem, we introduce an efﬁcient data augmentation method, named Context-Consistent Stitching (CCS), which generates complicated images online. Each new image is obtained by stitching labeled human-object pairs cropped from multiple training images. By selecting source images with similar context, the new synthesized image is made visually realistic. Our methods signiﬁcantly promote both the accuracy and training efﬁciency of transformer-based
HOI detection models. Experimental results show that our proposed approach consistently outperforms state-of-the-art methods on three benchmarks: HICO-DET, HOI-A, and
V-COCO. Code is available at https://github.com/
SherlockHolmes221/DOQ. 1.

Introduction
Human-Object Interaction (HOI) detection aims to iden-tify a set of meaningful (cid:2)human, interaction, object(cid:3) triplets in an image. HOI is fundamental for scene and action un-derstanding, with applications including action prediction
[1, 2], scene graph generation [3, 4], and visual question an-*Corresponding author.
Figure 1. The mAP and convergence curves for QPIC [23] and our model on HICO-DET [48]. Our model achieves better mAP accuracy with a considerably faster convergence rate. swering [5, 6]. It is also a very challenging task. One rea-son for this degree of difﬁculty is that the task in question is composite: for each triplet, it is necessary to determine the location of the human and object instances involved, the object category, and the interactions between the human-object pair. Another major reason lies in HOI’s reliance on reasoning, which indicates that visual context is important in determining the interaction categories [23].
In view of its strong ability to leverage contextual cues, recent methods have applied transformer to HOI detection.
For example, QPIC [23] and HOI-Trans [25] deﬁned a set of learnable HOI queries, each of which denotes a possible human-object pair in an image. AS-Net [24] and HOTR
[26] deﬁned a set of learnable object and interaction queries to infer object and interaction categories, respectively. Their common ground lies in their utilization of a cross-attention mechanism to mine image-wide contextual information in order to improve HOI detection.
However, the representation learning ability and set pre-diction power of existing transformer-based HOI detection methods may be underexplored. The ﬁrst problem lies
in the semantic ambiguity of HOI queries. Each query contains only the rough location of one possible human-object pair [11,25]; thus, the cross-attention operation in the transformer decoder cannot produce precise attention maps, which are essential in acquiring cues from discriminative re-gions. The representation learning ability is therefore con-strained and the convergence rate accordingly slows. The second problem is caused by the limited number of la-beled human-object pairs in most training images of exist-ing datasets. Therefore, the transformer may exhibit per-formance degradation for complicated images with many human-object pairs.
Herein, we propose an efﬁcient knowledge distillation model, named Distillation using Oracle Queries (DOQ), to overcome the ﬁrst problem. This model adopts one existing transformer-based model, e.g., QPIC [23], as the student network. It shares transformer parameters between teacher and student networks. The differences between the two net-works lie in their HOI queries and initial decoder embed-dings. For the student network, the HOI queries and ini-tial decoder embeddings are deﬁned as a set of learnable embeddings and zero vectors, respectively. For the teacher network, we construct a set of oracle HOI queries using the ground-truth positions of labeled human-object pairs. We further generate the initial decoder embedding according to the word embedding of the ground-truth object category in-volved in each labeled human-object pair. In this way, the teacher network acquires both precise semantic and posi-tion information for each labeled human-object pair, which enables it to produce high-quality representations and pre-cise attention maps. The representation learning power of the student network is thus signiﬁcantly promoted due to its mimicking both the attention maps and representations of the teacher network. In terms of inference stage, moreover, the teacher network is abandoned and therefore introduces no additional computational cost.
To address the second problem, we introduce an efﬁ-cient data augmentation method, named Context-Consistent
Stitching (CCS), which creates images online that contain more human-object pairs. In more detail, each new image is obtained by stitching together labeled human-object pairs that are cropped from multiple training images with similar visual context. There are two key advantages of this strat-egy. First, each synthesized image contains more human-object pairs and does not require manual labeling. Second, by cropping patches from images with similar scenes, the newly created new image is made visually realistic, which is proven to be essential in our experiments. Finally, through the inclusion of the synthesized images, the set prediction power of the transformer is sufﬁciently optimized.
To the best of our knowledge, our proposed method is the ﬁrst approach to explicitly handle the semantic ambigu-ity problem of queries for transformers in HOI detection.
We creatively introduce knowledge distillation to address this problem. We demonstrate the effectiveness of our pro-posed approaches through comprehensive experiments on three HOI detection benchmarks: HICO-DET [48], HOI-A [29], and V-COCO [49], and ﬁnd that our method con-sistently achieves state-of-the-art performance. Moreover, beneﬁting from the knowledge distillation based on oracle queries, our approach achieves a signiﬁcantly faster conver-gence rate than existing methods, as illustrated in Figure 1. 2.