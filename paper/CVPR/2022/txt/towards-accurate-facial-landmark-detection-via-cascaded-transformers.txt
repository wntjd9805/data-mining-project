Abstract
Accurate facial landmarks are essential prerequisites for many tasks related to human faces. In this paper, an accu-rate facial landmark detector is proposed based on cascad-ed transformers. We formulate facial landmark detection as a coordinate regression task such that the model can be trained end-to-end. With self-attention in transformers, our model can inherently exploit the structured relationships be-tween landmarks, which would beneﬁt landmark detection under challenging conditions such as large pose and oc-clusion. During cascaded reﬁnement, our model is able to extract the most relevant image features around the target landmark for coordinate prediction, based on deformable attention mechanism, thus bringing more accurate align-ment.
In addition, we propose a novel decoder that re-ﬁnes image features and landmark positions simultaneous-ly. With few parameter increasing, the detection perfor-mance improves further. Our model achieves new state-of-the-art performance on several standard facial landmark detection benchmarks, and shows good generalization abil-ity in cross-dataset evaluation. 1.

Introduction
Facial landmark detection aims to automatically localize
ﬁducial facial landmark points on human faces. It serves as an essential step for several facial analysis tasks, such as face recognition, facial expression analysis, face frontaliza-tion and 3D face reconstruction [29].
Facial landmark detection has received signiﬁcant im-provement in recent years. Existing approaches mainly fall into two categories, i.e., coordinate regression-based meth-ods and heatmap-based methods. Coordinate regression-based methods [7, 31] map the input image to landmark coordinates via fully connected prediction layers. To im-prove accuracy, coordinate regression is usually cascad-ed as a coarse-to-ﬁne manner [4, 15] or integrated with
∗The ﬁrst two authors equally contributed to this work. H.Li is the corresponding author. backbone
Initial Query 1st decoder  layer 2nd decoder  layer
···
···
Figure 1. Illustration of our entire framework. The initial query and landmark locations are generated based on the image features, and are continuously updated along with the decoding process. heatmap regression module [17, 28]. Heatmap-based meth-ods [23, 27, 34] usually predict heatmaps by fully convo-lutional networks and then obtain the landmarks according to the peak probability locations on the heatmaps. Since heatmap-based models can preserve the spatial structure of image features, they have better performance than coordi-nate regression-based models generally.
Although heatmap-based methods have relatively high-er detection accuracy, they suffer from three major issues. 1) The required post-processing step is non-differentiable, which disables the end-to-end training. 2) Considering the computational complexity, the resolution of heatmaps is usually lower than that of the input images, resulting in a quantization error inevitably and limiting the performance. 3) They concern more on local texture information and ne-glect global sensing on face shape, making them vulnerable to large appearance variation such as occlusions.
In contrast, coordinate regression based methods can by-pass the aforementioned drawbacks and enable end-to-end model training. However, the fully connected layers destroy the spatial structure of local image features, which deterio-rates the localization performance greatly [10].
In this work, we propose a coordinate regression-based model, Deformable Transformer Landmark Detector (DTLD), for accurate facial landmark detection. On one hand, our model avoids the aforementioned shortcomings of heatmap-based methods, and can be well-trained end-to-end, without heuristical post-processing. On the other hand, the model is capable of extracting the most relevan-t features from multi-level feature maps around the target landmark for coordinate prediction, which preserves the lo-cal spatial structure and improves the localization accuracy to a large extent. Moreover, our method helps to exploit the underlying relationship among landmarks and incorporate rich structure knowledge, which enables a robust model to tackle various scenarios such as expression or occlusion.
Inspired by the great success of DEtection TRansformer (DETR) in object detection [2, 33], we formulate the land-mark detection as a gradually reﬁned N-coordinate pre-diction task, where N is the number of facial landmark-s. Self-attention block is adopted to learn potential struc-tural dependencies. Then multi-scale image feature based deformable attention [33] is employed, where landmark re-lated information is used as the guidance to adaptively ex-tract the most relevant features and reﬁne the coordinates.
Different from [2, 33] that deﬁne redundant object queries (signiﬁcantly larger than the typical number of objects in an image) and use bipartite matching to classify object-s, here we set the number of queries to be the number of landmarks exactly, which simpliﬁes the training process largely. Instead of using randomly initialized query embed-ding, we design a more meaningful image-related query-initialization method, which provides coarse landmark lo-cations rather than a ﬁducial landmark template. Moreover, we explore a parallel decoder where both image features and landmark coordinates are reﬁned simultaneously in the decoding process.
It improves the detection performance further. The entire framework is illustrated in Figure 1.
The main contributions can be summarized as follows. 1) We propose a coordinate regression-based facial land-mark detector DTLD by cascaded deformable transformers, based on Deformable DETR [33]. DTLD could iteratively capture structural relationships among landmarks and the most relevant visual contextual information to achieve efﬁ-cient and effective detection. 2) A parallel decoder is further explored to enhance the detection accuracy, with few model parameter increasing. 3) We conduct extensive experiments to analyze the ef-fectiveness of the proposed method, by both quantitative e-valuations and qualitative visualizations. Our model con-tributes to tackle landmark detection under various scenar-It achieves new state-of-the-art (SOTA) accuracy on ios. several landmark detection benchmarks, and shows good generalization ability in cross-dataset evaluation. 2.