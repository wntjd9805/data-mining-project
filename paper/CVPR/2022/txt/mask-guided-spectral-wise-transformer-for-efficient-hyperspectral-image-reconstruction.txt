Abstract in the coded aperture snapshot spectral
Hyperspectral image (HSI) reconstruction aims to re-cover the 3D spatial-spectral signal from a 2D measure-ment imaging (CASSI) system. The HSI representations are highly similar and correlated across the spectral dimension. Modeling the inter-spectra interactions is beneficial for HSI reconstruc-tion. However, existing CNN-based methods show limita-tions in capturing spectral-wise similarity and long-range dependencies. Besides, the HSI information is modulated by a coded aperture (physical mask) in CASSI. Nonetheless, current algorithms have not fully explored the guidance ef-fect of the mask for HSI restoration. In this paper, we pro-pose a novel framework, Mask-guided Spectral-wise Trans-Specifically, we former (MST), for HSI reconstruction. present a Spectral-wise Multi-head Self-Attention (S-MSA) that treats each spectral feature as a token and calculates self-attention along the spectral dimension. In addition, we customize a Mask-guided Mechanism (MM) that directs S-MSA to pay attention to spatial regions with high-fidelity spectral representations. Extensive experiments show that our MST significantly outperforms state-of-the-art (SOTA) methods on simulation and real HSI datasets while requir-ing dramatically cheaper computational and memory costs. https://github.com/caiyuanhao1998/MST/ 1.

Introduction
Hyperspectral imaging refers to multi-channel imaging where each channel captures the information at a specific spectral wavelength for a real-world scene. Generally, hy-perspectral images (HSIs) have more spectral bands than normal RGB images to store richer information and de-lineate more detailed characteristics of the imaged scene.
Relying on this property, HSIs have been widely applied to many computer vision related tasks, e.g., remote sens-ing [5, 34, 59], object tracking [21, 40], medical image pro-*Equal Contribution, † Corresponding Author
Figure 1. PSNR-Params-FLOPS comparisons with CNN-based
HSI reconstruction methods. The vertical axis is PSNR (in dB per-formance), the horizontal axis is FLOPS (computational cost), and the circle radius is Params (memory cost). Our proposed Mask-guided Spectral-wise Transformers (MSTs) outperform previous methods while requiring significantly cheaper FLOPS and Params. cessing [3, 33, 37], etc. To collect HSIs, conventional imag-ing systems with spectrometers scan the scenes along the spatial or spectral dimension, usually requiring a long time.
Therefore, these traditional imaging systems are unsuitable for capturing and measuring dynamic scenes. Recently, re-searchers have used snapshot compressive imaging (SCI) systems to capture HSIs. These SCI systems compress in-formation of snapshots along the spectral dimension into one single 2D measurement [58]. Among current existing
SCI systems [10,16,32,45,47], the coded aperture snapshot spectral imaging (CASSI) [36,45] stands out and forms one promising mainstream research direction.
Based on CASSI, a large number of reconstruction algo-rithms have been proposed to recover the 3D HSI cube from the 2D measurement. Conventional model-based methods adopt hand-crafted priors such as sparsity [23, 29, 46], total variation [24, 51, 57], and non-local similarity [30, 52, 61] to regularize the reconstruction procedure. However, these
methods need to tweak parameters manually, resulting in poor generalization ability, unsatisfactory reconstruction quality, and slow restoration speed. With the development of deep learning, HSI reconstruction has witnessed signif-icant progress. Deep convolutional neural network (CNN) applies a powerful model to learn the end-to-end mapping function from the 2D measurement to the 3D HSI cube. Al-though impressive results have been achieved, CNN-based methods [20, 35, 36, 39] show limitations in modeling the inter-spectra similarity and long-range dependencies. Be-sides, the HSIs are modulated by a physical mask in CASSI.
Nonetheless, previous CNN-based methods [35, 36, 38, 48] mainly adopt the inner product between the mask and the shifted measurement as the input. This scheme corrupts the input HSI information and does not fully explore the guid-ance effect of the mask, leading to limited improvement.
In recent years, the natural language processing (NLP) model, Transformer [44], has been introduced into com-puter vision and outperformed CNN methods in many tasks.
The Multi-head Self-Attention (MSA) module in Trans-former excels at capturing non-local similarity and long-range dependencies. This advantage provides a possibil-ity to address the aforementioned limitations of CNN-based methods in HSI reconstruction. However, directly apply-ing the original Transformer may be unsuitable for HSI restoration due to the following reasons. Firstly, original
Transformers learn to capture the long-range dependencies in spatial wise but the representations of HSIs are spectrally highly self-similar. In this case, the inter-spectra similar-ity and correlations are not well modeled. Meanwhile, the spectral information is spatially sparse. Capturing spatial interactions may be less cost-effective than modeling spec-tral correlations with the same resources. Secondly, the HSI representations are modulated by the mask in the CASSI system. The original Transformer without sufficient guid-ance may easily attend to many low-fidelity and less infor-mative image regions when calculating self-attention. This may degrade the model efficiency. Thirdly, when using the original global Transformer [15], the computational com-plexity is quadratic to the spatial size. This burden is non-trivial and sometimes unaffordable. When using the local window-based Transformer [31], the receptive fields of the
MSA module are limited within the position-specific win-dows and some highly related tokens may be neglected.
To cope with the above problems, we propose a novel method, Mask-guided Spectral-wise Transformer (MST), for HSI reconstruction. Firstly, in Fig. 2 (a), we observe that each spectral channel of HSIs captures an incomplete part of the same scene due to the constraints of the spe-cific wavelength. This indicates that the HSI representations are similar and complementary along the spectral dimen-sion. Hence, we propose a Spectral-wise MSA (S-MSA) to capture the long-range inter-spectra dependencies. Specifi-cally, S-MSA treats each spectral channel feature as a token and calculates the self-attention along the spectral dimen-sion. Secondly, in Fig. 2 (b), a mask is used in the CASSI system to modulate HSIs. The light transmittance of dif-ferent positions on the mask varies significantly. This in-dicates that the fidelity of the modulated spectral informa-tion is position-sensitive. Therefore, we exploit the mask as a key clue and present a novel Mask-guided Mechanism (MM) that directs the S-MSA module to pay attention to the regions with high-fidelity spectral representations. Mean-while, MM also alleviates the limitation of S-MSA in mod-eling the spatial correlations of HSI representations. Fi-nally, with our proposed techniques, we establish a series of extremely efficient MST models that surpass state-of-the-art (SOTA) methods by a large margin, as illustrated in Fig. 1.
Our contributions can be summarized as follows:
• We propose a new method, MST, for HSI reconstruc-tion. To the best of our knowledge, it is the first attempt to explore the potential of Transformer in this task.
• We present a novel self-attention, S-MSA, to capture the inter-spectra similarity and dependencies of HSIs.
• We customize an MM that directs S-MSA to pay atten-tion to regions with high-fidelity HSI representations.
• Our MST dramatically outperforms SOTA methods on all scenes in simulation while requiring much cheaper
Params and FLOPS. Besides, MST yields more visu-ally pleasant results in real-world HSI reconstruction. 2.