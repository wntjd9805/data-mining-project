Abstract
We propose Iterative Homography Network, namely
IHN, a new deep homography estimation architecture. Dif-ferent from previous works that achieve iterative reﬁnement by network cascading or untrainable IC-LK iterator, the iterator of IHN has tied weights and is completely train-able.
IHN achieves state-of-the-art accuracy on several datasets including challenging scenes. We propose 2 ver-sions of IHN: (1) IHN for static scenes, (2) IHN-mov for dynamic scenes with moving objects. Both versions can be arranged in 1-scale for efﬁciency or 2-scale for accuracy.
We show that the basic 1-scale IHN already outperforms most of the existing methods. On a variety of datasets, the 2-scale IHN outperforms all competitors by a large gap. We introduce IHN-mov by producing an inlier mask to further improve the estimation accuracy of moving-objects scenes.
We experimentally show that the iterative framework of IHN can achieve 95% error reduction while considerably sav-ing network parameters. When processing sequential im-age pairs, IHN can achieve 32.7 fps, which is about 8× the speed of IC-LK iterator. Source code is available at https://github.com/imdumpl78/IHN . 1.

Introduction
Homography estimation aims to ﬁnd the global perspec-tive transform between two images.
It serves as a cru-cial step in a widely range of computer vision tasks such as image/video stitching [13, 32], video stabilization [16],
SLAM [9, 24], augmented reality [29], GPS denied naviga-tion [12, 40], and multimodal image fusion [37, 42].
The approaches in the literature can be roughly catego-rized into photometric-based and feature-based ones [32].
Photometric-based approaches aim to estimate homogra-phy from pixel intensities. The Lucas-Kanade (LK) algo-rithm [2, 19] is the most widely adopted photometric-based approach, which iteratively estimates the residual homog-raphy using a pre-computed iterator. Feature-based ap-proaches usually consist of three steps: feature extraction, feature matching, and homography estimation [32]. The (a) Homography estimation on Google Earth. (b) Homography estimation on Google Map & Satellite.
Figure 1. Visualization of homography estimation with average corner error (ACE) at each iteration of our IHN and DLKFM [40] im-(which use the traditional IC-LK iterator). Left 2 images: age pair for homography estimation with the source image IS on the left and the target image IT on the right. Green polygons de-note the ground-truth position of IS on IT. Blue polygons denote the estimated position using MHN+DLKFM. Red polygons de-note the estimated position using our IHN. Right plot: ACEs dur-ing ﬁrst 12 iterations. IHN stops at iteration 6 while DLKFM has a dynamic stop criterion which iterates 21 times averagely. well-known feature extractors are SIFT [18], SURF [4], and ORB [4]. Homography estimation methods include
RANSAC [11], DLT [8], and MAGSAC [3].
Recently, deep homography methods have attracted in-creasing interest due to their superior performance. The
VGG-style network, ﬁrst proposed by DeTone et al. [6], is adopted to directly estimate homography. Based on this work, many recent methods have been introduced to boost the estimation accuracy by cascading multiple VGG-style networks [10, 14, 41]. The cascading is actually a way of it-eration that can signiﬁcantly improve the estimation perfor-mance. However, this way of iteration is limited to a ﬁxed number of cascading, and more network cascading does not necessarily lead to better performance [14].
To further improve the homography estimation accuracy, some works [5, 40] take the Lucas-Kanade (LK) algorithm
as an untrainable iterator and combine it with CNNs. How-ever, the approximation of the Hessian matrix in the LK algorithm fails when the Jacobian matrix is rank-deﬁcient
[26]. Even worse, the training of the network is limited to the feature extractor, which means the above drawback is theoretically unavoidable.
To cope with these issues, we propose iterative homog-raphy network (IHN), which is completely trainable. We introduce 2 versions of IHN: (1) IHN for static scenes, (2)
IHN-mov for dynamic scenes with moving objects. Both versions can be arranged in 1-scale for efﬁciency or 2-scale for accuracy. We show that the basic 1-scale IHN already outperforms most of the existing methods. On
MSCOCO [15], the 2-scale IHN outperforms all competi-tors by a large gap, with more than 90% of the average cor-ner errors (ACEs) lower than 0.1 pixels. On cross-modal datasets [40], IHN outperforms the state-of-the-art method
MHN+DLKFM [40] that uses the traditional LK iterator in reﬁning the deep homography estimation of MHN [14]. On moving-objects data [35], IHN and IHN-mov both surpass the competitors. IHN-mov gains further accuracy improve-ment by producing an inlier mask mimicking the essence of
RANSAC [11].
The motivation of IHN comes from the traditional IC-LK iterator [2]. Different from IC-LK, IHN is completely train-able and thus can learn prior information for the residual homography prediction directly from data. Fig. 1 illustrates the homography estimation results and average corner er-rors (ACEs) at each iteration for our IHN and DLKFM [40] that use the IC-LK iterator. The initial ACEs at iteration 0 differs because DLKFM uses the preliminary estimation from MHN. It is observed that our basic 1-scale IHN can produce an accurate homography estimation within 6 it-erations, while DLKFM using the traditional IC-LK fails.
Furthermore, IHN can process image pairs in sequence at 32.7 fps, which is about 8× the speed of the IC-LK it-erator. We further explore the effectiveness of our itera-tive framework by replacing our global motion aggregator (GMA, which directly estimate the residual homography) with the network architectures in [6, 14, 39]. Experimen-tal results show that compared to feature/image concatena-tion strategy in [6, 14, 25, 39, 41], our iterative framework achieves about 95% error reduction. Thanks to the iterative framework, our global motion aggregator can achieve com-parable accuracy with much fewer parameters than previ-ous architectures, e.g., 36.4% of the architecture in [14] and 3.6% in [39]. The same deep iterative concept that signif-icantly improves optical ﬂow estimation accuracy has been proposed in RAFT [33], which inspires us to construct a completely trainable deep homography estimation network.
To summarize, the main contributions of this work are as follows:
• We propose an iterative homography network, namely
IHN achieves
IHN, which is completely trainable. state-of-the-art accuracy on several datasets including challenging scenes. The iteration of IHN is stable and doesn’t require extra parameters.
• We show that the proposed iterative framework is vi-tal for an accurate homography estimation, which can achieve 95% error reduction regardless of a speciﬁc network architecture design. The iterative framework also enables considerable parameter saving.
• We specially design a network architecture IHN-mov for the moving-objects scenes where homography as-sumption is violated. The network produces an inlier mask mimicking the essence of RANSAC that can fur-ther beneﬁt the homography estimation. 2.