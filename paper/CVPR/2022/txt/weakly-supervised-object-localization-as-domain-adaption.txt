Abstract
Weakly supervised object localization (WSOL) focuses on localizing objects only with the supervision of image-level classification masks. Most previous WSOL methods follow the classification activation map (CAM) that local-izes objects based on the classification structure with the multi-instance learning (MIL) mechanism. However, the
MIL mechanism makes CAM only activate discriminative object parts rather than the whole object, weakening its performance for localizing objects. To avoid this problem, this work provides a novel perspective that models WSOL as a domain adaption (DA) task, where the score estimator trained on the source/image domain is tested on the tar-get/pixel domain to locate objects. Under this perspective, a DA-WSOL pipeline is designed to better engage DA ap-proaches into WSOL to enhance localization performance.
It utilizes a proposed target sampling strategy to select dif-ferent types of target samples. Based on these types of tar-get samples, domain adaption localization (DAL) loss is elaborated.
It aligns the feature distribution between the two domains by DA and makes the estimator perceive tar-get domain cues by Universum regularization. Experiments show that our pipeline outperforms SOTA methods on multi benchmarks. Code are released at https://github. com/zh460045050/DA-WSOL_CVPR2022. 1.

Introduction
Weakly supervised object localization (WSOL), learning the location of objects in images using only the image-level classification mask to supervise, relaxes the requirement for the dense annotation such as pixel-level segmentation masks or bounding boxes for the training process, which saves much manual labor for annotation and attract exten-sive attention in recent years [33, 4, 28, 1, 31, 2, 13].
The most well-known WSOL method is the classifica-tion activation map (CAM) [33], which utilizes the classi-Figure 1. The comparison of DA-WSOL and other mechanisms. fication structure to generate the localization score. As in-dicated in Fig. 1 B, it theoretically serves as classification under multi-instance learning (MIL) [6], where each image represents a bag whose label is determined by instances it contains [29], i.e. the pixels/patches. However, MIL fo-cuses more on the accuracy of bags (images) rather than the instances (pixels), which makes CAM only discern the most discriminative parts but not the whole object. For activat-ing more objects parts, different technics are adopted to en-hance CAM, e.g. data augmentations [27, 14, 29, 4], novel network structures [4, 30, 1, 31], or post-processes [2, 13].
Though these methods somewhat alleviate this problem, they still follow MIL that basically causes the incomplete activation of objects and weakens the performance.
From another perspective, CAM is also the same as train-ing an estimator to classify the image-level feature under the supervision of image-level masks. This well-trained es-timator is then projected onto the pixel-level feature to gen-erate the pixel-level localization scores in the test process-ing [33]. By viewing image-level and pixel-level features 1
as the features respectively extracted from source and target domain, the goal of WSOL is consistent with the domain adaption (DA) task, i.e. forcing the estimator trained on the source (image) domain to perform well on the target (pixel) domain. Thus, if DA methods can assist WSOL in align-ing the distribution of these two domains, the estimator can avoid overfitting the source domain, i.e. only activating the discriminative parts of objects.
Inspired by this, our paper elaborates a DA-WSOL pipeline that helps to better engage the DA approaches into
WSOL to enhance the performance. Fig. 1 visually gen-eralizes our novel DA-WSOL pipeline and its difference from other mechanisms of WSOL. Compared with the MIL mechanism, our method adopts DA to align the feature dis-tribution between source and target domain, enhancing the accuracy of the estimator when projected onto the pixel fea-tures. Moreover, both classification and localization scores can be obtained with a single end-to-end trained structure.
This trait makes our method more concise than another type of WSOL mechanism [28, 18] shown in Fig. 1 C, which requires training multi additional stages to generate class-agnostic region-of-interests (ROI) when localizing objects. the specificities of domain adaption in
WSOL are also considered by the proposed DA-WSOL pipeline. Specifically, the target domain of WSOL is more complex constructed, which has a much larger scale than the source domain and contains samples with the source-unseen label, i.e. the background locations. Thus, a target sampling strategy is also proposed for our DA-WSOL pipeline to ef-fectively select the source-related target samples and the un-seen target samples. The two types of samples are then fed into a proposed domain adaption localization (DAL) loss, where the former type is utilized to solve the sample imbal-ance between two domains, and the latter is viewed as the
Universum [25] to perceive target cues.
In addition,
In a nutshell, our contributions are fourfold:
• Our work is the first to model WSOL as a DA task and designs a pipeline to assist WSOL by DA methods. proposed the CAM, which utilizes the classification struc-ture to localize objects by projecting the classifier onto the pixel-level feature. Zhang et al. [29] proved its mechanism is equal to the MIL and improved it by utilizing two adver-sarial classifiers to catch complementary object parts. For a similar purpose, Singh et al. [14] randomly hid the patches of images to force the classification structure to focus more parts of objects. Junsk et al. [4] then enhanced it by directly erasing discriminative spatial positions on the feature map.
Yun et al. [27] replace patches of an image by its of other images to augment the training samples. Except for the data augmentations, novel network structures were also explored to enhance the CAM. Typically, Zhang et al. [30] generated coarse pixel-wise masks based on different stages of the ex-tractor and used them as additional supervision to force the later stages. Zhang et al. [31] also adopted the siamese net-work to ensure stochastic consistency for images with the same class in a batch. Unlike these methods that follow
MIL mechanism, our method align pixel-level and image-level features with DA approches to assist WSOL task. 2.2. Separated-structure based WSOL
Instead of viewing WSOL as the image classification in the MIL manner, Zhang et al. [28] suggested split-ting WSOL into two independent tasks: the class-agnostic object localization and the object classification. They proposed a pseudo-supervised object localization (PSOL) method with three stages respectively for region proposal, bounding box regression, and object classification. Lu et al. [18] attempted to generate ROI with different geome-try and adopted a generator to produce class-agnostic bi-nary masks rather than only bounding boxes. Zhang et al. [32] used the classification stage to obtain both classi-fication results and localization seeds, which are then used by the localization stage to generate class-agnostic localiza-tion maps. More recently, Meng et al. [19] explored jointly optimizing localization and classification to pursue better results. Compared with them, our method can obtain both classification and localization results with only one stage.
• A DAL loss is proposed to align the feature distribution of source and target domain in the WSOL scenario. 2.3. Domain Adaption
• A target sampling strategy is proposed to select differ-ent types of representative target samples.
• Extensive experiments show our DA-WSOL outper-forms SOTA methods on multiply WSOL benchmarks. 2.