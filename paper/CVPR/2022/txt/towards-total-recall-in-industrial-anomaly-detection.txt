Abstract
Being able to spot defective parts is a critical component in large-scale industrial manufacturing. A particular chal-lenge that we address in this work is the cold-start problem:
ﬁt a model using nominal (non-defective) example images only. While handcrafted solutions per class are possible, the goal is to build systems that work well simultaneously on many different tasks automatically. The best peform-ing approaches combine embeddings from ImageNet mod-els with an outlier detection model. In this paper, we extend on this line of work and propose PatchCore, which uses a maximally representative memory bank of nominal patch-features. PatchCore offers competitive inference times while achieving state-of-the-art performance for both detection and localization. On the challenging, widely used MVTec
AD benchmark PatchCore achieves an image-level anomaly detection AUROC score of up to 99.6%, more than halving the error compared to the next best competitor. We fur-ther report competitive results on two additional datasets and also ﬁnd competitive results in the few samples regime.
Code: github.com/amazon-research/patchcore-inspection. 1.

Introduction
The ability to detect unusual patterns in images is a fea-ture deeply ingrained in human cognition. Humans can dif-ferentiate between expected variance in the data and outliers after having only seen a small number of normal instances.
In this work we address the computational version of this problem, cold-start1 anomaly detection for visual inspec-tion of industrial image data. It arises in many industrial scenarios where it is easy to acquire imagery of normal ex-amples but costly and complicated to specify the expected defect variations in full. This task is naturally cast as a out-of-distribution detection problem where a model needs to distinguish between samples being drawn from the training data distribution and those outside its support.
Industrial visual defect classiﬁcation is especially hard, as errors can
∗ Work done during a research internship at Amazon AWS. 1Commonly also dubbed one-class classiﬁcation (OCC).
Figure 1. Examples from the MVTec benchmark datasets. Super-imposed on the images are the segmentation results from Patch-Core. The orange boundary denotes anomaly contours of actual segmentation maps for anomalies such as broken glass, scratches, burns or structural changes in blue-orange color gradients. vary from subtle changes such as thin scratches to larger structural defects like missing components [5]. Some ex-amples from the MVTec AD benchmark along with results from our proposed method are shown in Figure 1. Existing work on cold-start, industrial visual anomaly detection re-lies on learning a model of the nominal distribution via auto-encoding methods [12, 36, 44], GANs [2, 39, 43], or other unsupervised adaptation methods [42, 56]. Recently, [4, 10] proposed to leverage common deep representations from
ImageNet classiﬁcation without adaptation to the target dis-tribution. Despite the missing adaptation, these models of-fer strong anomaly detection performance and even solid spatial localization of the defects. The key principle be-hind these techniques is a feature matching between the test sample and the nominal samples while exploiting the multi-scale nature of deep feature representations. Subtle, ﬁne-grained defect segmentation is covered by high-resolution features, whereas structural deviations and full image-level anomaly detection are supposed to be covered by features at much higher abstraction levels. The inherent downside of this approach, since it is non-adaptive, is the limited match-ing conﬁdence at the higher abstraction levels: high-level abstract features from ImageNet training coincide little with
the abstract features required in an industrial environment.
In addition, nominal context usable by these methods at test time is effectively limited by the small number of ex-tractable high-level feature representations.
In this paper, we present PatchCore as an effective rem-edy by (1) maximizing nominal information available at test time, (2) reducing biases towards ImageNet classes and (3) retaining high inference speeds. Relying on the fact that an image can be already classiﬁed as anomalous as soon as a single patch is anomalous [14, 56], Patch-Core achieves this by utilizing locally aggregated, mid-level features patches. The usage of mid-level network patch features allows PatchCore to operate with minimal bias to-wards ImageNet classes on a high resolution, while a fea-ture aggregation over a local neighbourhood ensures reten-tion of sufﬁcient spatial context. This results in an exten-sive memory bank allowing PatchCore to optimally lever-age available nominal context at test time. Finally, for practical applicability, PatchCore additionally introduces greedy coreset subsampling [1] for nominal feature banks as a key element to both reduce redundancy in the extracted, patch-level memory bank as well as signiﬁcantly bringing down storage memory and inference time, making Patch-Core very attractive for realistic industrial use cases.
Thorough experiments on the diverse MVTec AD [5] as well as the specialized Magnetic Tile Defects (MTD) [26] industrial anomaly detection benchmarks showcase the power of PatchCore for industrial anomaly detection.
It achieves state-of-the-art image-level detection scores on
MVTec AD and MTD, with nearly perfect scores on MVTec
AD (up to AUROC 99.6%), reducing detection error of previous methods by more than half, as well as state-of-the-art industrial anomaly localization performance. Patch-Core achieves this while retaining fast inference times with-out requiring training on the dataset at hand. This makes
PatchCore very attractive for practical use in industrial anomaly detection. In addition, further experiments show-case the high sample efﬁciency of PatchCore, matching ex-isting anomaly detection methods in performance while us-ing only a fraction of the nominal training data. 2.