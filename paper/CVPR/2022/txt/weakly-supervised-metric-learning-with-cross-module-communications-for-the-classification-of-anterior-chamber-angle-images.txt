Abstract
As the basis for developing glaucoma treatment strate-gies, Anterior Chamber Angle (ACA) evaluation is usu-ally dependent on experts’ judgements. However, experi-enced ophthalmologists needed for these judgements are not widely available. Thus, computer-aided ACA evalua-tions become a pressing and efficient solution for this is-sue. In this paper, we propose a novel end-to-end frame-work GCNet for automated Glaucoma Classification based on ACA images or other Glaucoma-related medical images.
We first collect and label an ACA image dataset with some pixel-level annotations. Next, we introduce a segmenta-tion module and an embedding module to enhance the per-formance of classifying ACA images. Within GCNet , we design a Cross-Module Aggregation Net (CMANet) which is a weakly-supervised metric learning network to capture contextual information exchanging across these modules.
We conduct experiments on the ACA dataset and two pub-lic datasets REFUGE and SIGF. Our experimental results demonstrate that GCNet outperforms several state-of-the-art deep models in the tasks of glaucoma medical image classifications. The source code of GCNet can be found at https://github.com/Jingqi-H/GCNet. 1.

Introduction
Glaucoma is a leading cause of irreversible blindness in the world [44]. The main basis for determining clinical treatment protocols when glaucoma is diagnosed is using
Anterior Chamber Angle (ACA) images and gonioscopy is widely regarded as the “Gold Standard” in ACA evalua-tion. There are five ACA levels that correspond to different glaucoma treatments. In order to determine these ACA lev-els, ophthalmologists examine four local structures in ACA images: Schwalbe Line (SL), Trabecular Meshwork (TM),
Scleral Spur (SS), and Ciliary Body Band (CBB), with the help of microgonioscopy [8,11] as shown in Figure 1. How-*Now at Alibaba Inc.
Figure 1. The main structures in ACA consist of Schwalbe line (SL), pigmentation of trabecular meshwork (TM), scleral spur (SS), and ciliary body band (CBB). The bottom figure shows the color annotations of these four structures. ever, ACA evaluation needs expert ophthalmologists, while the availability of experienced ophthalmologists is severely sparse given the large number of glaucoma patients. There-fore, computer-aided systems are urgently needed for effi-cient ACA evaluation.
Recently, Deep Neural Networks (DNNs) have be-come a default choice given its successful applications in
Glaucoma-related medical image analysis. For instance,
DNNs have been used to segment optic cup (OC) regions and optic disk (OD) regions [9], and to detect glaucoma-tous optic neuropathy [25]. Li et al. [21] apply a ResNet-18 model for automatic measurement of trabecular-iris angle (TIA). Peroni et al. [36] exploit a dense U-Net architecture to segment irido-corneal interface images. However, di-rectly applying traditional DNN models for ACA level clas-sification is suboptimal and the following challenges need to be overcome: (1) In ACA images, the four spatial structures (SL, TM,
SS, and CBB) are the main basis for ophthalmologists in their ACA level evaluations. However, these four structures concentrate in a small area of a full ACA picture as shown in
Figure 1. This leads to great challenges for machine learn-Figure 2. The illustration of GCNet. We introduce a weakly-supervised metric learning network for capturing pixel-level de-tails of spatial features and a cross-module communication strat-egy (two type of pipes in red) for augmenting information across three sub-modules. ing models to distinguish this important information from background noise. (2) The appearance of SL, TM, SS, and CBB corre-sponds to different levels of glaucoma diseases. In ACA im-ages, these four structures are adjacent with blurred bound-aries between each other. Recognizing each feature and learning their hidden representations are crucial in ACA classification. However, pixel-level annotations of these structures are rare for supervised learning. (3) With sparse pixel-level labels of the four structures, deep learning models often suffer from capturing inter-class similarities and intra-class variations of these structures.
Fusing the knowledge of these four structures in the task of image classification is another obstacle.
To overcome the above challenges, we propose a deep neural network with weakly-supervised metric learning and interactive module communications on glaucoma image classification. To the best of our knowledge, this is the first work for classifying ACA images using deep learning tech-niques with three sub-modules. The main contributions of our paper include:
• We propose a weakly-supervised metric learning framework for glaucoma image classification. We augment glaucoma ACA images with pixel-level annotations for four structures (SL, TM, SS, and CBB) and utilize these annota-tions to enhance image classification.
• We propose a cross-module communication strategy to fuse features from multiple granularity levels as shown in
Figure 2. The proposed network, CMANet, is able to cap-ture semantic information in picture levels as well as pixel levels. This method can also be extended to other types of
Glaucoma clinical images such as the REFUGE dataset [32] including both image-level and pixel-level annotations.
• We collect and label an ACA evaluation image dataset.
The dataset includes 999 ACA images which are labeled by several senior ophthalmologists. In addition, 100 ACA im-ages are labeled with SL, TM, SS, and CBB at pixel levels.
We conduct extensive experiments on three real-world datasets to demonstrate the effectiveness of the proposed framework in classification compared with several deep learning baselines. 2.