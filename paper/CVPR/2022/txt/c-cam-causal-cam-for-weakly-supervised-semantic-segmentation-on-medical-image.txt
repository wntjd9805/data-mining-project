Abstract
Recently, many excellent weakly supervised semantic segmentation (WSSS) works are proposed based on class activation mapping (CAM). However, there are few works that consider the characteristics of medical images. In this paper, we find that there are mainly two challenges of medi-cal images in WSSS: i) the boundary of object foreground and background is not clear; ii) the co-occurrence phe-nomenon is very severe in training stage. We thus propose a Causal CAM (C-CAM) method to overcome the above challenges. Our method is motivated by two cause-effect chains including category-causality chain and anatomy-causality chain. The category-causality chain represents the image content (cause) affects the category (effect). The anatomy-causality chain represents the anatomical struc-ture (cause) affects the organ segmentation (effect). Exten-sive experiments were conducted on three public medical image data sets. Our C-CAM generates the best pseudo masks with the DSC of 77.26%, 80.34% and 78.15% on
ProMRI, ACDC and CHAOS compared with other CAM-like methods. The pseudo masks of C-CAM are further used to improve the segmentation performance for organ seg-mentation tasks. Our C-CAM achieves DSC of 83.83% on
ProMRI and DSC of 87.54% on ACDC, which outperform-s state-of-the-art WSSS methods. Our code is available at https://github.com/Tian-lab/C-CAM . 1.

Introduction
Recently, semantic segmentation [22] is widely studied due to the development of deep learning. Existing paradig-*Corresponding Author
Figure 1. Main challenges of medical images. Challenge1: The object boundary for medical image is more ambiguous than natu-ral image. Challenge2: Different organs often occur in the same medical image in training stage. m of semantic segmentation is training a model to clas-sify the category of every pixel with abundant pixel-level labeled data. However, the acquirement of pixel-level la-bels is time-consuming and expensive. Therefore, a new paradigm called weakly supervised semantic segmentation (WSSS) comes out. Different from fully supervised seman-tic segmentation (FSSS), WSSS utilizes weak annotation-s, e.g., image-level label, point, scribble and bounding box.
Among these weak annotations, image-level label is the eas-iest way to be obtained. Meanwhile, it is the most challeng-ing one to be used for segmentation. In this paper, we focus on image-level labels for medical image segmentation.
The main problem for WSSS with image-level labels is the lack of location information. Class activation mapping (CAM) methods [7, 14, 24, 30, 33, 44] creatively give con-volutional neural network (CNN) locating ability with on-ly image-level labels. However, the CAM could only lo-cate discriminative part of object, which leads awful seg-mentation performance. Many CAM-based WSSS method-s [2, 8, 13, 18, 34, 39] are successively proposed to narrow the gap between WSSS and FSSS. The main idea of these
methods is to solve the problem that CAM could not com-pletely cover object. Some methods [2, 8, 13, 18] use CAM to generate seeds and refine the seeds to cover the whole ob-ject. Some methods [19, 34, 39, 40] directly generate more accurate saliency maps.
However, most of these CAM-based methods are de-signed for natural images, which may not work well on medical images. Compared with natural images, medical images have mainly the following two challenges of WSSS based on image-level labels. We intuitively demonstrate the challenges in Fig. 1. i) The boundary of foreground and background is not clear, which makes CAM model hard to classify the category border of foreground and background. ii) The co-occurrence is very severe in medical images in training stage, e.g., different organs always appears togeth-er in an abdominal magnetic resonance imaging (MRI) im-age. However, the co-occurrence is not so severe in natural images. For example, the “people” would not always ap-pear together with “horse”, and vice versa. Therefore, CAM model could know which part of an image is “people” with abundant image-level labels. Unfortunately, it is hard for
CAM model to activate correct co-occurring organs in one image only according with image-level labels.
Therefore, a causal CAM (C-CAM) method is proposed to overcome the above-mentioned challenges. The C-CAM starts from two causality chains. The first chain is category causality X → Y , which indicates that the image content
X (cause) affects the classified category Y (effect). The second chain is anatomy causality Z → S, which indi-cates that the anatomical structure Z (cause) affects the or-gan segmentation S (effect). In the category-causality chain, we use causal intervention [28] to make C-CAM model fo-cus on the real cause of predicted category. In the anatomy-causality chain, anatomical constraint is integrated to make
C-CAM focus on the real cause of object segmentation, which can well solve the co-occurrence problem.
In summary, the main contributions of this paper are three folds:
• We propose C-CAM for WSSS on medical images.
The C-CAM generates pseudo segmentation masks with clearer boundaries and more accurate shapes. To the best of our knowledge, C-CAM is the first method to introduce causality into medical image WSSS.
• We integrate two causality chains to cope with the challenges of WSSS for medical images. Category-causality chain is designed to alleviate the problem of ambiguous boundary. Anatomy-causality chain is de-signed to solve the co-occurrence problem.
• We demonstrate the effectiveness of our method with extensive experiments on three public medical image data sets. Our C-CAM generates pseudo masks with
Figure 2. Motivation of causality in medical image WSSS. Cat-egory causality (first row): information of biased category cause model activate wrong category of object. Anatomy category (sec-ond row): information of biased shape cause model activate inac-curate shape of object. The heatmaps represent saliency maps of
CAM. The red color means high value and blue color means low value. The yellow curve represents ground-truth. the DSC of 77.26%, 80.34%, and 78.15% respectively on ProMRI, ACDC, and CHAOS data sets. The seg-mentation performance achieves the DSC of 83.83%
± 5.14% on ProMRI and 87.54% ± 7.77% on ACDC, which outperforms state-of-the-art methods. 2.