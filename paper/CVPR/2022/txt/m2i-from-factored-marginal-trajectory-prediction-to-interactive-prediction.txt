Abstract
Predicting future motions of road participants is an im-portant task for driving autonomously in urban scenes. Ex-isting models excel at predicting marginal trajectories for single agents, yet it remains an open question to jointly predict scene compliant trajectories over multiple agents.
The challenge is due to exponentially increasing predic-tion space as a function of the number of agents. In this work, we exploit the underlying relations between interact-ing agents and decouple the joint prediction problem into marginal prediction problems. Our proposed approach M2I first classifies interacting agents as pairs of influencers and reactors, and then leverages a marginal prediction model and a conditional prediction model to predict trajectories for the influencers and reactors, respectively. The predic-tions from interacting agents are combined and selected ac-cording to their joint likelihoods. Experiments show that our simple but effective approach achieves state-of-the-art performance on the Waymo Open Motion Dataset interac-tive prediction benchmark. 1.

Introduction
Trajectory prediction is widely used by intelligent driv-ing systems to infer future motions of nearby agents and identify risky scenarios to enable safe driving. Recent ad-vances have shown great success in predicting accurate trajectories by learning from real-world driving examples.
Many existing trajectory prediction works [5, 12, 15, 26, 28, 38] focus on generating marginal prediction samples of fu-ture trajectories over individual agents, failing to reason about their interactions in the future. As a result, the pre-diction samples over multiple agents may overlap with each other and result in sub-optimal performance.
We present a motivating example in Fig. 1, in which a marginal predictor produces a set of prediction samples sep-arately for two interacting agents, as visualized in the top left figure. While the predictions for each agent are rea-*Denotes equal contribution. Code and demo available at paper website: https://tsinghua- mars- lab.github.io/M2I/ alan.qiao.sun@gmail.com, xhuang@csail.mit.edu.
†X. Huang was supported in part by Qualcomm Innovation Fellowship.
‡Corresponding at: hangzhao@mail.tsinghua.edu.cn.
Figure 1. A motivating example of M2I. Top: Traditional marginal predictor often produces scene inconsistent trajectory predictions that collide with each other. Even for non-colliding predictions, it ignores the potential interaction between agent futures and may predict unrealistic behaviors. Bottom: Our proposed approach
M2I predicts scene compliant trajectories by first identifying an influencer reactor pair in the scene. It then predicts marginal tra-jectories for the influencer and reactive trajectories for the reactor. sonable without considering the presence of the other, some trajectory pairs will collide when considering them jointly.
For instance, it is unlikely that the red agent turns left while the blue agent goes forward, as indicated in the top middle example in Fig. 1. Therefore, it is necessary to predict scene compliant trajectories with the existence of multiple agents to support better prediction accuracy.
To generate scene compliant trajectories, one can learn a joint predictor to predict trajectories in a joint space over multiple agents; however, it suffers from an exponentially increasing prediction space as the number of agents in-creases. As investigated by [15], while it is feasible to pre-dict a set of goals for a single agent, the goal space increases exponentially with the number of agents and becomes un-manageable for even two agents with a few hundred goal candidates for each agent. A more computationally effi-cient alternative to producing scene compliant trajectories is to post-process marginal prediction samples by pruning colliding ones; however, such an ad-hoc approach fails to take into account potential agent interactions in the future and may ignore other conflicts which are hard to prune by heuristics. For instance, although the prediction sample in the top right figure in Fig. 1 is collision-free, the red agent may slow down when turning left to keep a safe distance from the blue agent. Such an interactive behavior is hard to
be captured by a marginal predictor as it is unaware of the future behavior of the other agents in the scene.
In this paper, we propose M2I that leverages marginal and conditional trajectory predictors to efficiently predict scene compliant multi-agent trajectories, by approximating the joint distribution as a product of a marginal distribution and a conditional distribution. The factorization assumes two types of agents: the influencer that behaves indepen-dently without considering the other agents, and the reactor that reacts to the behavior of the influencer. This assump-tion is inspired by the recent study on the underlying cor-relations between interactive agent trajectories [39]. Under the assumption, we leverage a standard marginal predictor to generate prediction samples for the influencer, and a con-ditional predictor to roll out future trajectories for the re-actor conditioned on the future trajectory of the influencer.
The advantage of our proposed approach M2I is illustrated in the bottom figures in Fig. 1, in which we first predict the relations of the interactive agents. Given the relations, we predict the future trajectories of the influencer and then pre-dict reactive behaviors of the reactor conditioned on each influencer prediction. As causality in driving interaction re-mains an open problem [39], we pre-label the influencer-reactor relation based on a heuristic, and propose a relation predictor to classify interactive relations at inference time.
Our contributions are three-fold. First, we propose a sim-ple but effective framework M2I that leverages marginal and conditional predictors to generate accurate and scene compliant multi-agent trajectories. The framework does not assume a specific predictor structure, allowing it to be adopted by a wide range of backbone prediction models.
Second, we propose a relation predictor that infers high-level relations among interactive agents to decouple the pre-diction space. Third, we demonstrate our framework using a goal-conditioned prediction model. Experiments show that
M2I achieves state-of-the-art performance on the Waymo
Open Motion Dataset interactive prediction benchmark. 2.