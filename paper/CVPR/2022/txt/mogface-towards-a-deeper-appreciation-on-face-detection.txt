Abstract
Benefiting from the pioneering design of generic ob-ject detectors, significant achievements have been made in the field of face detection. Typically, the architectures of the backbone, feature pyramid layer, and detection head module within the face detector all assimilate the excel-lent experience from general object detectors. However, several effective methods, including label assignment and scale-level data augmentation strategy, fail to maintain con-sistent superiority when applying on the face detector di-rectly. Concretely, the former strategy involves a vast body of hyper-parameters and the latter one suffers from the challenge of scale distribution bias between different detec-tion tasks, which both limit their generalization abilities.
Furthermore, in order to provide accurate face bounding boxes for facial down-stream tasks, the face detector im-peratively requires the elimination of false alarms. As a result, practical solutions on label assignment, scale-level data augmentation, and reducing false alarms are neces-sary for advancing face detectors.
In this paper, we fo-cus on resolving three aforementioned challenges that ex-iting methods are difficult to finish off and present a novel face detector, termed MogFace. In our Mogface, three key components, Adaptive Online Incremental Anchor Mining
Strategy, Selective Scale Enhancement Strategy and Hier-archical Context-Aware Module, are separately proposed to boost the performance of face detectors. Finally, to the best of our knowledge, our MogFace is the best face detector on the Wider Face leader-board, achieving all champions across different testing scenarios. The code is available at https://github.com/damo-cv/MogFace. 1.

Introduction
Face detector, predicting location coordinates of face boxes, serves as the fundamental step for many facial down-stream tasks, including face alignment [1], face recogni-* Corresponding Author.
Email: ly261666@alibaba-inc.com tion [5] [28] and face attribute analysis [24].
In the past few years, we have witnessed the quick development on the general object detectors, deriving from the Fast-RCNN [8] and SSD [18] to Retinanet [16] and DERT [3]. Motivated by this, state-of-the-art face detectors adopt the great architec-ture designs from general object detectors, such as Feature
Pyramid Network [15] and One-stage Single-Shot frame-work [16].
However, label assignment and scale-level data augmen-tation strategy 1, achieving great superiority on the task of generic object detection, bring rare gains on face detec-tors . On the one hand , the designation of former strat-egy involves a vast body of hyper-parameters (e.g. K in
ATSS [34], α in OTA [7] ) , which limits its generalization ability. On the other hand, as shown in Fig. 1(b), com-pared with generic object detector, face detector confronts more severe scale variance challenge. Uniform sampling based scale-level data augmentation strategies (e.g. multi-scale training and random square crop [18]), serving as the main scale enhancement methods on generic object detec-tors [16, 23, 34], fail to provide effective scale information for face detector (more analysis can be seen in the supple-mentary material). Furthermore, the face detector is a real-world application that emphasizes reducing the number of false alarms urgently. Therefore, how to distinguish false alarms away from true positive faces is an another distinc-tive challenge on the task of face detection.
Based on the above analysis, we discover that label as-signment strategy, scale-level data augmentation strategy and eliminating false alarms have a huge potential for con-structing a high-performance face detector. Then we per-form a systematically quantitative and qualitative analysis on 3 aforementioned perspectives to provide some intrinsic insights.
Label Assignment. Label assignment strategies adopt pre-defined rules to match ground-truth (gt) or background for each anchor. As shown in the Fig. 1(a), the designation of predefined rules highly depends on offline and online in-formation. Offline information contains Intersection-over-Union (IoU) and Center Point Distance (CPD) between gt 1enriches the scale distribution of the training data to resolve scale vari-ance challenge.
(a) (b) (c) (a) Online and offline information both can be adopted as criterion to determine the
Figure 1: Motivation illustration. boundary between positive and negative anchors. But how to effectively and adaptively combine them remains a huge challenge. (b) Cumulative density curve of face or object scale relative to the fixed scale (640). In the Wider face and COCO dataset, almost 55% and 18% ground-truth scale is less than 20, demonstrating that compared to generic object detector, a more severe scale variance challenge is occurred on the task of face detection. (c) For the same detector, we discover the top-left calendar is a false alarm in the left image, while the top-left calendar in the other two images are not. and anchor, which can be computed during the process of data preparation. Online information consists of the pre-dicted classification scores (PCS) and the predicted location coordinates (PLC), which can be extracted at the end of for-ward propagation. Traditional label assignment strategies adopt offline information as threshold criterion for pos/neg anchors division, e.g. IoU in retinanet [16], faster-rcnn [23],
IoU and CPD in ATSS [34]. Recently, Hambox [21] further points out the effectiveness of online information and put forwards an online high-quality anchor mining strategy to utilize the PLC. OTA [7] formulates the assigning proce-dure as an optimal transport problem, where the cost func-tion is designed by the weighed combination of CPD, PCS and PLC.
However, there exist two drawbacks lying behind current label assignment strategies: 1) Online information cannot provide high-confidence matching information as well as offline one. Thus, it will result in the emergence of sub-optimal label assignment strategy when encouraging on-line rules to serve as main metric on distinguishing posi-tive and negative anchors like OTA and Hambox. 2) The selection of hyper-parameter in the recent label assignment strategies frequently goes through constant trials and errors, making it difficult for transferring different detection tasks, e.g.
In from general object detection to face detection. this paper, we address the aforementioned issues by propos-ing an adaptive online incremental anchor mining strategy (Ali-AMS), which is based on the standard anchor matching strategy adopted in retinanet [16] and further compensates outlier ground-truths with incremental anchors at the end of forward propagation. In our Ali-AMS, two key compo-nents, quality assessment based anchor mining strategy and pyramid-level consistency principle, are proposed to mine and assign the high-quality anchor adaptively. Concretely, the former strategy regards the PCS as the quality assess-ment criterion to re-sort the anchor mined with the CPD and
IoU information; then, the latter principle guarantees that ground-truths located at the same pyramid layer can match the same number of anchors. The motivation and more de-tails of our Ali-AMS can be seen in section 3.1.
Scale-level Data Augmentation.
Generic object de-tector frequently introduces scale-level data augmentation strategy to resolve extreme scale variance on the COCO dataset. However, the most authoritative face detection dataset Wider Face [31] contains more severe scale variance than COCO [17]. As shown in Fig. 1(b), we display the scale distribution of ground-truths on the COCO and Wider
Face benchmark, respectively. Comparing with COCO dataset which is famous with extreme scale variance, Wider
Face has more rigorous scale distribution, where contains almost 55% small scale faces 2.
To resolve extreme scale variance challenge, there ex-ist 3 widely-adopted data augmentation strategies, in-cluding Multi-scale-training (MST), Random Square Crop (RSP) and Data-anchor-sampling (DAS). Multi-scale-training strategy, resizing each image into a random scale selected from fixed scale range, frequently serves as the optimal solution on handling with scale variance problem, which has demonstrated its significance in many technology reports on the COCO detection challenge. Random Square
Crop strategy, cropping the square area from a given image randomly, is a main-stream scale-level data augmentation strategy on the task of face detection [6], [35]. Data-anchor-sampling strategy [26] aims to introduce more small scale faces by resizing each image into a smaller scale.
MST and RSP are both designed from uniform sampling perspective while DAS focuses on generating many small faces. Meanwhile, in the Wider Face training set, almost 55% face scale is less than 20, making uniform sampling based augmentation strategies generate a large number of small faces. As a result, MST and RSP both have great detection ability on small faces. This raises a worth solv-ing problem: How to increase the detection ability on the 2the scale of ground-truth is less than 20
middle and large scale faces since the training set only con-tains a small proportion large faces (10%) ? In this paper, we investigate this question by analyzing the relationship between the performance of each pyramid layer and the number of ground-truths it matches. Based on comprehen-sive quantitative and qualitative analysis in supplementary material, we unexpected discover that it is not the more ground-truths that is matched in a single pyramid layer, the greater performance of this pyramid layer. As a result, this phenomenon releases an amazing conclusion that in or-der to improve the representation of certain pyramid layer, the number of ground-truths matched in this layer should be appropriate instead of ’the more, the better’. Under the guidance of this meaningful conclusion, we propose a simplex selective scale enhancement strategy for detecting large scale face accurately on the basis of prior statistical result, which controls the ground-truths distribution to im-prove the deep pyramid layer representation, achieving the best detection performance on large and middle scale faces.
To the best of our knowledge, our selective scale enhance-ment strategy is the first novel work to consider the relation-ship between the performance of each pyramid layer and the number of ground-truths it matches, which provides a solid knowledge on how to mine the learning capacity of certain pyramid layer.
Eliminating False Alarms. Reducing the number of false alarms is vitally important for the real-world face detec-tor. The common solution is to introduce additional train-ing data with false alarms, which helps the detector acquire more knowledge on the property of false alarms. How-ever, collecting extra training data is labor-intensive such that the solution without extra data is deserved exploring.
In this paper, we present a Hierarchical Context-Aware
Module (HCAM) to help false alarms away from ground-truths, which explicitly encodes neighbour context infor-mation into high-confidence anchors 3. The effectiveness of neighbour context information can be seen in Fig. 1(c), we send the left image into the Hambox [21] face detec-tor and find a top-left false alarm. However, when we crop this false alarm with expanding context area (middle im-age) and less expanding context area (right image), we un-expectedly discover that the same detector believes there is no false positives in these two images. Moreover, we uti-lize Hambox face detector to find all false alarms in the
Wider Face validation dataset, almost 95% false alarms are disappeared when adopting similar operations like above.
This phenomenon demonstrates that the appropriate neigh-bour context information is conducive to eliminating false alarms.
In summary, our contribution can be summarized as:
• Presenting 3 worthy of in-depth research topics on the 3high-confidence anchors contains correct predicted positive anchors and false predicted negative anchors task of face detection, including Label Assignment,
Scale-level Data Augmentation and Eliminating False
Alarms.
• Proposing Adaptive Online Incremental Anchor Min-ing Strategy, Selective Scale Enhancement Strategy,
Hierarchical Context-Aware module respectively to construct a promising face detector, termed as Mog-Face.
• Achieving state-of-the-art results in all popular face detection benchmarks, including Wider Face, AFW,
FDDB and Pascal Face. 2.