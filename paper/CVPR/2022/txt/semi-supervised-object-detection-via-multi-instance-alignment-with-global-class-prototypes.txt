Abstract
Semi-Supervised object detection (SSOD) aims to im-prove the generalization ability of object detectors with large-scale unlabeled images. Current pseudo-labeling-based SSOD methods individually learn from labeled data and unlabeled data, without considering the relation be-tween them. To make full use of labeled data, we pro-pose a Multi-instance Alignment model which enhances the prediction consistency based on Global Class Proto-types (MA-GCP). Specifically, we impose the consistency between pseudo ground-truths and their high-IoU candi-dates by minimizing the cross-entropy loss of their class distributions computed based on global class prototypes.
These global class prototypes are estimated with the whole labeled dataset via the exponential moving average algo-rithm. To evaluate the proposed MA-GCP model, we inte-grate it into the state-of-the-art SSOD framework and ex-periments on two benchmark datasets demonstrate the ef-fectiveness of our MA-GCP approach. 1.

Introduction
With a large amount of labeled data available, deep learning has shown superior performance when solving ob-ject detection task. However, it is very costly to collect suf-ficient labeled data for each object category. Fortunately, there are large amount of unlabeled data available which can be collected from social media and websites. Semi-supervised object detection (SSOD) is proposed to improve the generalization ability of object detectors with large-scale unlabeled images [8, 18, 23, 28, 31]. In SSOD, we are given a labeled dataset and an unlabeled dataset. SSOD aims to learn a object detector with good generalization ability by using these labeled and unlabeled images.
To achieve this goal, existing SSOD approaches usu-ally adopt two strategies: consistency-based SSOD [12, 13, 30] and pseudo-labeling-based SSOD [18, 22, 26–29, 31]. Consistency-based approaches train the target detec-tor by minimizing inconsistency between prediction results of unlabeled data with different perturbations. Their per-formance highly depends on the design of perturbations and the measurement of consistency. Recently, pseudo-labeling-based approaches become popular. As shown in the yellow box of Figure 1, they adopt a teacher-student learning framework. Specifically, the pseudo labels of un-labeled images are first estimated by using a teacher de-tector followed by a label refinement module. Then, they jointly train a student detector with both labeled and unla-beled images. The detection losses of labeled and unlabeled images are used to optimize the parameters of student de-tector. Teacher detector’s parameters are updated with the parameters of student detector via Exponential Moving Av-erage (EMA) algorithm or pretrained with all labeled im-ages. However, these models individually train the student detector with labeled data and unlabeled data. That is, their detection losses of labeled and unlabeled data update the student detector individually, without considering the rela-tion between them.
This work fully leverages the labeled images to improve
SSOD by developing a Multi-instance Alignment model with Global Class Prototypes (MA-GCP). Our key insight is to better estimate prediction consistency of unlabeled im-ages by using the reliable information learned from all la-beled images. By enforcing the consistency regularization in the pseudo-labeling-based framework, our approach can improve its detection performance.
Specifically, we assume each class is represented by a prototype in the feature space. As shown in the green box of Figure 1, each prototype is progressed with region fea-tures of the corresponding category via EMA algorithm.
Since each prototype is updated with all labeled instances during the whole training process, we call it global class prototype. Then, we compute the class distributions of un-labeled images’ proposals based on its visual similarity with each global class prototype. After that, we impose consis-tency between each pseudo ground-truth proposal and its candidate proposals with high Intersection-of-Union (IoU) scores by minimizing the cross-entropy loss of their class
Figure 1. Illustration of the proposed approach. Our approach is implemented based on a pseudo-labeling-based SSOD framework, as shown in the yellow box. It estimates the pseudo labels for unlabeled images using a teacher detector followed by a label refinement module and then jointly trains a student detector with both labeled and unlabeled images. As shown in the green box, to make full use of labeled images, we propose a multi-instance alignment model based on global class prototypes which are learned with all labeled images via EMA algorithm. The detection loss of labeled images Ls aln are used to train the student detector, and teacher detector’s parameters are updated with student detector’s parameters via EMA algorithm. det and multi-instance alignment loss Lu det and unlabeled images Lu distributions. Different from previous consistency-based
SSOD [2, 12, 13] which use batch-wise prototypes as ref-erences or directly compute prediction results without ref-erences, our model leverages these global class prototypes to produce more reliable consistency regularization and thus improves the detection accuracy of SSOD.
To evaluate the performance of our MA-GCP approach, we integrate it into the state-of-the-art pseudo-labeling-based framework. Experimental results on the PASCAL
VOC and MSCOCO datasets demonstrate that our approach outperforms the competing models, and thus obtains the state-of-the-art results.
In summary, our main contributions are as follows:
• We propose a multi-instance alignment model with global class prototypes to enhance prediction consis-tency of pseudo-labeling-based SSOD approaches.
• We propose to learn global class prototypes with all la-beled images via the EMA algorithm and then employ them to estimate prediction consistency of unlabeled images. These global class prototypes help to estimate more reliable prediction consistency and thus benefit
SSOD.
• Extensive experiments demonstrate that our MA-GCP approach has achieved a consistent improvement on two benchmark datasets and obtains the state-of-the-art results. 2.