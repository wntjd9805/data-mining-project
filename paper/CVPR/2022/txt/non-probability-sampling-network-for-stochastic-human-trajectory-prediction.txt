Abstract
Capturing multimodal natures is essential for stochastic pedestrian trajectory prediction, to infer a finite set of future trajectories. The inferred trajectories are based on obser-vation paths and the latent vectors of potential decisions of pedestrians in the inference step. However, stochastic approaches provide varying results for the same data and parameter settings, due to the random sampling of the latent
In this paper, we analyze the problem by recon-vector. structing and comparing probabilistic distributions from pre-diction samples and socially-acceptable paths, respectively.
Through this analysis, we observe that the inferences of all stochastic models are biased toward the random sampling, and fail to generate a set of realistic paths from finite samples.
The problem cannot be resolved unless an infinite number of samples is available, which is infeasible in practice. We intro-duce that the Quasi-Monte Carlo (QMC) method, ensuring uniform coverage on the sampling space, as an alternative to the conventional random sampling. With the same finite number of samples, the QMC improves all the multimodal prediction results. We take an additional step ahead by in-corporating a learnable sampling network into the existing networks for trajectory prediction. For this purpose, we pro-pose the Non-Probability Sampling Network (NPSN), a very small network (∼5K parameters) that generates purposive sample sequences using the past paths of pedestrians and their social interactions. Extensive experiments confirm that
NPSN can significantly improve both the prediction accuracy (up to 60%) and reliability of the public pedestrian trajec-tory prediction benchmark. Code is publicly available at https://github.com/inhwanbae/NPSN . 1.

Introduction
The goal of predicting pedestrian trajectories is to infer socially-acceptable paths based on previous steps while con-sidering the social norms of other moving agents. Many earlier works [15, 39, 44, 59] on human trajectory predic-tion are based on deterministic approaches which yield the
*Corresponding author
Figure 1. An illustration of a probability distribution of stochastic trajectory prediction and selected paths from each sampling method.
While the trajectories from the random sampling are biased in that they do not consider space of all possible distributions, our NPSN purposively generates the accurate route, turning to SHOP, even with its low probability. most likely single path. One of the earliest works in [15] models a social force using attractive and repulsive forces between pedestrians. Since then, motion time-series and agent interactions have been applied to trajectory forecast-ing. With the development of recurrent neural networks (RNNs), pioneering works such as, Social-LSTM [1] and
Social-Attention [56], have adopted a social pooling and attention mechanisms between spatial neighbors. These ap-proaches have become baseline models in areas such as spa-tial relation aggregation [13, 17, 40, 48, 50, 53] and temporal future prediction [23, 35, 36, 52, 63, 64].
Recently, generative models, which infer the distribution of potential future trajectories, are likely to inspire a major paradigm shift away from the single best prediction meth-ods [6,10,13,17,18,22,23,26,27,30–32,35,40,47–54,61,65].
The generative models represent all possible paths, such that pedestrians may go straight, turn left/right at an intersection or take a roundabout way to avoid obstacles. To efficiently establish this multi-modality, a stochastic process is intro-duced to the trajectory prediction [13], which models the inferred uncertainty of pedestrians’ movements in every time frame. Stochastic trajectory prediction models start by gen-erating a random hypothesis. Due to the non-deterministic nature of random sampling, the quality of the hypotheses depends on the number of samples. Ideally, an infinite num-ber of hypotheses would be able to characterize all possible movements of pedestrians, but this is infeasible. In prac-when inferring single paths, since it only selects the best one sample from the distribution in inference time. Follow-up works [40, 50, 51, 56] predict multiple paths by sampling multiple next coordinates based on predicted distributions.
As another methodology, a generative model is introduced to predict realistic future paths. Social-GAN [13] firstly uses a generative framework that recursively infers future trajec-tory. The benefit of GAN is that it generates various out-puts according to latent vectors. As a result, inter-personal, socially acceptable and multimodal human behaviors are accounted for in the pedestrian trajectory prediction. Such a research stream encourages to define a variety loss which calculates for the best prediction among multiple samples for diverse sample generation. [6, 10, 17, 22, 47, 52].
Similarly, there have been attempts to predict diverse fu-ture generations using CVAE frameworks. DESIRE [23] uses a latent variable to account for the ambiguity of fu-ture paths and learns a sampling model to produce multiple hypotheses of future trajectories from given observations.
This approach provides a diverse set of plausible predictions without the variety loss, and shares inspiration to objectives in many CVAE-based models [18, 32, 35, 48, 61].
All of these methods include a random sampling pro-cess and are sensitive to bias, due to the fixed number of samples, as above mentioned. In addition, current state-of-the-art models with CVAE frameworks outperform Gaussian distribution-based methods [40, 50]. In this study, we ana-lyze these phenomena with respect to the bias of stochastic trajectory prediction, and show that the Gaussian distribution-based approaches achieve noticeable performance improve-ments by minimizing the bias, even better than the CVAE-based methods. Lastly, we mention a recent deterministic approach [64] that predicts multiple trajectories, which is beyond the scope of this paper. 2.2. Learning latent variables
Some works account for the transformation of latent spaces by using prior trajectory information. PECNet [35] for example uses a truncation trick in latent space to ad-just the trade-off between the fidelity and the variety of samples. In their learning approach, both IDL [28] and Tra-jectron++ [48] predict the mean and standard deviation of a latent distribution in an inference step. Rather than directly predicting the distribution parameters, AgentFormer [62] uses a linear transform of Gaussian noise to produce the latent vector. These methodologies still run the risk of bias because of the random sampling of the latent vectors. In the present work, we aim to reduce the bias using a discrepancy loss of a set of sampled latent vectors. 2.3. Graph-based approaches
Pioneering works have introduced the concepts of social-pooling [1, 13, 52] and social-attention mechanisms [27, 56, 63] to capture the social interactions among pedestrians in
Figure 2. Illustrations of stochastic human trajectory prediction and our NPSN method. The red box indicates the latent vector. tice, a fixed number of multiple trajectories are randomly sampled using the Monte Carlo (MC) method, and all exist-ing stochastic models follow this random sampling strategy.
However, the number of samples is typically too small to represent socially-acceptable pedestrian trajectories because they are biased toward the random sampling, as illustrated in Fig. 1.
In this paper, we revisit the state-of-the-art works which employ the stochastic process for multimodal prediction (Fig. 2-(a)∼(c)). We prove that all of the expected values in the generated trajectory distributions with Generative Ad-versarial Networks (GANs) [6, 13, 17], Conditional Varia-tional Auto-Encoders (CVAEs) [32, 35, 48], and Gaussian methods [40, 50] are biased. Afterward, we introduce a
Quasi-Monte Carlo (QMC) sampling method that effectively alleviates this problem using a low-discrepancy sequence, instead of random sampling. Lastly, we push the random sampling forward with a learnable method: Non-Probability
Sampling Network (NPSN), a very small network that gen-erates purposive sample sequences using observations and agent interactions in Fig. 2-(d). Without structurally modify-ing the existing models in any way, we achieve significant improvements in the performance of pedestrian trajectory prediction. This is accomplished by replacing one line of code on random sampling with our NPSN. Interestingly, one of the existing models using our NPSN as an auxiliary mod-ule achieves the best performance in all evaluation metrics.
Unlike previous methods, the proposed approach focuses on the sampling method to generate a set of random latent vectors. To the best of our knowledge, our work is the first attempt to adopt QMC sampling and to propose a learn-able method for purposive sampling in trajectory forecasting in Fig. 1. 2.