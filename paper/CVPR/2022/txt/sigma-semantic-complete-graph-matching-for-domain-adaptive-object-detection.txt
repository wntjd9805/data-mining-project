Abstract
Domain Adaptive Object Detection (DAOD) leverages a labeled domain to learn an object detector generalizing to a novel domain free of annotations. Recent advances align class-conditional distributions by narrowing down cross-domain prototypes (class centers). Though great success, they ignore the significant within-class variance and the domain-mismatched semantics within the training batch, leading to a sub-optimal adaptation. To overcome these challenges, we propose a novel SemantIc-complete Graph
MAtching (SIGMA) framework for DAOD, which completes mismatched semantics and reformulates the adaptation with graph matching. Specifically, we design a Graph-embedded
Semantic Completion module (GSC) that completes mis-matched semantics through generating hallucination graph nodes in missing categories. Then, we establish cross-image graphs to model class-conditional distributions and learn a graph-guided memory bank for better semantic completion in turn. After representing the source and target data as graphs, we reformulate the adaptation as a graph matching problem, i.e., finding well-matched node pairs across graphs to reduce the domain gap, which is solved with a novel Bipartite Graph Matching adaptor (BGM). In a nutshell, we utilize graph nodes to establish semantic-aware node affinity and leverage graph edges as quadratic constraints in a structure-aware matching loss, achieving fine-grained adaptation with a node-to-node graph match-ing. Extensive experiments verify that SIGMA outper-forms existing works significantly. Our code is available at https://github.com/CityU-AIM-Group/SIGMA. 1.

Introduction
Well-trained object detectors [23, 24, 33] have been proven to achieve promising performance with a consistent
*Yixuan Yuan is the corresponding author.
This work was supported by Hong Kong Research Grants Council (RGC)
General Research Fund 11211221 (CityU 9043152).
Figure 1. Illustration of the proposed SemantIc-complete Graph
MAtching (SIGMA) framework for DAOD. distribution of training and test data. However, deploying these methods in a novel domain leads to the catastrophic performance degradation due to the domain gap [3], which significantly limits the generalization and transferability of object detectors. Furthermore, this challenge also restricts the application of object detection in real-world scenarios, such as self-driving under distinctive weather conditions and video analysis containing novel scenes.
To overcome this limitation, Unsupervised Domain
Adaptation (UDA) methods have been explored to adapt the unlabeled target domain and the annotated source do-main, and one of the main streams of UDA works is to align feature distributions between source and target domains.
Early works [3, 12, 27] adopt a pixel-to-pixel adaptation in terms of hierarchical features, yielding a global align-ment of the whole image with per-pixel adaptation. Some works [3, 37, 41] focus on foreground objects and conduct more precise adaptation on those regions of interest. Re-cently, some works [32,37,41,42] aim to align cross-domain class-conditional distributions in the implicit feature space and achieve adaptation in a category-to-category manner.
These works model category centers with prototypes and minimize the distance of cross-domain prototypes to bridge the domain gap at the category level.
Though satisfactory performance, there are still two challenges in existing category-level adaptation works [32, 37, 41, 42]. Firstly, these works neglect the significant within-class variance and directly align handcraft category
centers, which inevitably bring about a sub-optimal adap-tation. Due to the diverse size and appearance of object instances, the within-class variance covers essential infor-mation to represent class-conditional distributions, e.g., the scale and shape, which should also be aligned for domain adaptation. Overlooking the within-class variance could lead to lots of non-adapted object instances and the poten-tial overlapping of different class-conditional distributions with false-positive classification errors. Although some works have introduced explicit variance [2] to relieve the problem of existing center-based measurements, they fol-low the Gaussian assumption to model feature distributions, which is not optimal in the non-convex deep feature space.
These observations motivate us to design a new paradigm to align cross-domain pixel-pairs in the non-euclidean graph-ical space [39], which models and adapts class-conditional distributions without handcraft center-based alignment.
The second challenge lies in the domain-mismatched se-mantics within the training batch. Some existing works [32, 37, 42] only perform adaptation on the co-occurred cate-gories in two domains, ignoring mismatched categories ap-pearing in a single domain. Neglecting missing categories leads to a non-effective adaptation due to the loss of seman-tic knowledge. As shown in Figure 1, the train only appears in the source batch, while these bicycles are available in the target domain, yielding inconsistent semantics across do-mains. These mismatched semantics bring about the dif-ficulty of explicitly estimating class centers, limiting the adaptation of class-conditional distributions. Furthermore, the missing semantics in the target domain even result in the potential risk towards source-specific direction since the su-pervised source classification could generate a biased class-conditional distribution [35]. Hence, we are committed to designing a semantic completion strategy through generat-ing novel hallucination samples [40] in the missing cate-gories, which relieves the negative impact of mismatched semantics and achieves more effective adaptation.
To overcome the aforementioned challenges, we propose a SemantIc-complete Graph MAtching (SIGMA) frame-work for DAOD, which completes domain-mismatched se-mantics and reformulates the adaptation as a graph match-ing problem, i.e., finding the suitable matching between graph nodes to bridge the domain gap. As shown in Fig-ure 1, we design a Graph-embedded Semantic Comple-tion module (GSC) to complete the mismatched semantics, which utilizes domain-level statistics to generate hallucina-tion nodes in the missing categories. Then, we establish graphs to model class-conditional distributions for both do-mains and learn a graph-guided memory bank to improve the capacity of semantic completion in turn. Based on our reformulation of domain adaptation, we propose a Bipartite
Graph Matching adaptor (BGM) to solve the graph match-ing problem between the source and target graph, achieving a fine-grained domain alignment. We utilize graph nodes to learn semantic-aware node affinity and introduce graph edges in a structure-aware matching loss for the Quadratic
Assignment Problem (QAP). This graph-matching-based domain alignment enables a fine-grained adaptation with well-matched semantics and relieves the biased and non-effective adaptation in existing prototype-based methods.
To be summarized, our contributions are as follows.
• We propose a SemantIc-complete Graph MAtching (SIGMA) framework for DAOD, which aligns the class-conditional distribution with graph matching. To the best of our knowledge, this work represents the first attempt to leverage graph matching theory to bridge the domain gap in the detection community.
• We propose a Graph-embedded Semantic Completion module (GSC) to complete mismatched semantics by generating hallucination nodes and a Bipartite Graph
Matching adaptor (BGM) that reformulates DAOD as a graph matching problem to bridge the domain gap.
• Extensive experiments on three benchmarks demon-strate that SIGMA achieves state-of-the-art results and outperforms DAOD counterparts significantly. 2.