Abstract
JPEG is a popular image compression method widely used by individuals, data center, cloud storage and network filesystems. However, most recent progress on image com-pression mainly focuses on uncompressed images while ig-noring trillions of already-existing JPEG images. To com-press these JPEG images adequately and restore them back to JPEG format losslessly when needed, we propose a deep learning based JPEG recompression method that operates on DCT domain and propose a Multi-Level Cross-Channel
Entropy Model to compress the most informative Y com-ponent. Experiments show that our method achieves state-of-the-art performance compared with traditional JPEG recompression methods including Lepton, JPEG XL and
CMIX. To the best of our knowledge, this is the first learned compression method that losslessly transcodes JPEG im-ages to more storage-saving bitstreams. 1.

Introduction
JPEG [44], a popular image compression algorithm, is used by billions of people daily and JPEG images spread widely in data center, cloud storage and network filesys-tems. According to a survey, in operating network filesys-tems like Dropbox, JPEG images make up roughly 35% of bytes stored [21]. However, most of these images are not sufficiently compressed due to the limitation of JPEG algo-rithm: relying on hand-crafted module design and hard to eliminate data redundancy adequately. Actually, JPEG al-gorithm has been developed for many years so that it has al-ready been outperformed by other more recent image com-pression methods, such as JPEG2000 [34], BPG [10], intra coding of VVC/H.266 [31] and deep-learning based meth-ods [8, 9, 29]. However, these subsequent image compres-*Equal contribution.
†Corresponding author. This work is done when Lina Guo, Xinjie Shi, and Rui Ma are interns at SenseTime Research. sion methods devote to process original images in lossless format like PNG while ignoring the need of further com-pressing trillions of existing JPEG images losslessly.
Considering the recompression needs of storage service, there exist several methods on further compression of JPEG images, e.g. Lepton [21], JPEG XL [6, 7], and CMIX [1].
However, they rely on hand-crafted features and indepen-dently optimized modules, limiting compression efficiency.
Along with the quick proliferation of mobile devices sav-ing and uploading JPEG images, these storage systems have become gargantuan and existing JPEG recompression algo-rithms are not expected to be optimal and general solutions to storage challenges faced by service providers.
We propose an efficient JPEG image lossless recompres-sion neural network using quantized DCT [5] coefficients as input, which is stored in the JPEG file. To the best of our knowledge, this is the first work proposing a deep learn-ing based model dedicated for lossless recompression of
JPEG images and outperforms existing traditional methods including Lepton, JPEG XL, and CMIX by a large margin.
In our method, JPEG in YCbCr 4:2:0 format is consid-ered because of its popularity. As shown in Fig. 1, we first construct a color-space entropy model for YCbCr 4:2:0 for-mat which extracts side information z as prior to build con-ditional distribution of the three components. Then we fur-ther exploit the correlation of Y, Cb, and Cr components se-quentially (i.e. Cb component conditioned on Cr, Y compo-nent conditioned on both Cb and Cr). Additionally, since Y component is much more informative than Cb and Cr com-ponents, we propose a Multi-Level Cross-Channel (MLCC) entropy enhancement model for Y component to reduce the mismatch between estimated and true data distribution.
In conclusion, our main contributions include:
• We propose an end-to-end lossless compression model for images already encoded with JPEG format. To the best of our knowledge, this is the first approach investi-gating learning-based JPEG recompression, which fur-ther benefits the widely adopted JPEG format based on
powerful data-driven techniques.
• Experiments show that our proposed JPEG recompres-sion method achieves state-of-the-art performance, outperforming Lepton, JPEG XL and CMIX. Also, our model has reasonable running speed and is a promising candidate for practical JPEG recompression. 2.