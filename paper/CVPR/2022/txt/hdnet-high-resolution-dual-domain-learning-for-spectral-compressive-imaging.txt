Abstract
The rapid development of deep learning provides a bet-ter solution for the end-to-end reconstruction of hyperspec-tral image (HSI). However, existing learning-based meth-ods have two major defects. Firstly, networks with self-attention usually sacrifice internal resolution to balance model performance against complexity, losing fine-grained high-resolution (HR) features. Secondly, even if the op-timization focusing on spatial-spectral domain learning (SDL) converges to the ideal solution, there is still a signif-icant visual difference between the reconstructed HSI and the truth. So we propose a high-resolution dual-domain learning network (HDNet) for HSI reconstruction. On the one hand, the proposed HR spatial-spectral attention mod-ule with its efficient feature fusion provides continuous and fine pixel-level features. On the other hand, frequency do-main learning (FDL) is introduced for HSI reconstruction to narrow the frequency domain discrepancy. Dynamic FDL supervision forces the model to reconstruct fine-grained fre-quencies and compensate for excessive smoothing and dis-tortion caused by pixel-level losses. The HR pixel-level at-tention and frequency-level refinement in our HDNet mutu-ally promote HSI perceptual quality. Extensive quantitative and qualitative experiments show that our method achieves
SOTA performance on simulated and real HSI datasets. https://github.com/Huxiaowan/HDNet 1.

Introduction
Hyperspectral images (HSIs) with more spectral bands can capture richer scene information and fixed wavelength imaging characteristics, which are used in image classifica-tion [32], object detection [50], and tracking [17,30] widely.
Imaging systems with single 1D or 2D sensors take a long time to scan a scene for HSIs. They are not suitable for capturing dynamic scenes. Recently, the coded aperture snapshot spectral imaging (CASSI) system [24, 39, 40] can capture 3D HSI cubes at a real-time rate. CASSI exploits a
*Equal Contribution. † Corresponding Author.
Figure 1. Frequency spectra visualization of different methods. coded aperture to modulate the HSI signal and compress it into a 2D measurement. Nonetheless, a core problem of the
CASSI system is to recover the reliable and fine underlying 3D HSI signal from the 2D compressed images.
Traditional methods mainly regularize the reconstruction based on hand-crafted priors that delineate the structure of
HSI. But manually adjusted parameters result in poor gener-alization. Researchers began using convolutional neural net-works (CNN) for HSI reconstruction [41, 45]. Some meth-ods [23, 27, 28, 43] focus on self-attention learning in the spatial domain, but they usually sacrifice feature resolution to cut down the computational complexity of non-local at-tention maps [27, 28]. These operations inevitably damage the spectral auto-correlation and information continuity. In-spired by the extensive exploration of pixel-level attention in high-level visual tasks [5, 22], we find that it is critical to elaborate high-resolution (HR) and fine-grained spectral-spatial attention for HSIs. However, although finer atten-tion is undoubtedly beneficial for reconstructing HSI with rich spectral bands, capturing pixel-level perception for HSI with 28 spectral channels is far more challenging than 3-channel RGB images. It requires an optimal trade-off be-tween model performance and resource costs.
Besides, existing learning-based methods [3, 14, 27, 28, 42] for HSI reconstruction mainly focus on spatial-spectral
domain learning (SDL), where the spectral representations are sparsely presented in the frequency domain. The equal treatment of each frequency may result in sub-optimal mode efficiency. Some works show that due to the inherent biases of CNNs [29, 33, 34, 37], models tend to preferentially fit low-frequency components that are easy to synthesize while losing high-frequency components. We visualize the spec-tra of reconstructed HSIs in Fig. 1. We can see that even if previous methods based on SDL converge to the ideal solu-tion, there is still an obvious frequency domain discrepancy between reconstructed HSIs and truth. TSA-Net [27] loses high-frequency information and has observable checker-board artifacts. DGSMP [14] deviates to a limited frequency area. The focal frequency loss [16] is proven to be effective in synthesizing fine frequency components, but its potential to narrow the frequency domain gap in HSI reconstruction still remains under-explored. We find that each frequency in the spectra is the statistical sum across all pixels in the
HSI, so the frequency-level supervision can offer a new so-lution for global optimization. Experiments show that fre-quency domain learning (FDL) can compensate for exces-sive smoothing and distortion caused by pixel-level SDL.
Motivated by these meaningful findings, we propose a high-resolution dual-domain learning network, dubbed HD-Net. Dual-domain supervision exhausts the model represen-tation capacity within its spatial-spectral domain and fre-quency domain. On the one hand, in the spatial-spectral domain, we split the feature as HR spectral attention and
HR spatial attention, and connect them in an efficient fea-ture fusion (EFF) manner. The proposed fine-grained pixel-level attention avoids dimensionality collapse for high in-ternal resolution. On the other hand, we use the Discrete
Fourier Transform (DFT) to supervise the frequency dis-tance between truth and reconstructed HSIs adaptively. Dy-namic weighting mechanism makes the model concentrate high frequencies that are difficult to synthesize. Frequency spectra reconstructed by HDNet are the closest to the truth in Fig. 1, which shows our superiority in narrowing the fre-quency difference between HSIs. The HR pixel-level atten-tion in SDL and frequency-level refinement in FDL mu-tually promote common prosperity and ameliorate image quality further. Specific contributions of this paper are:
• Dynamic frequency-level supervision that can narrow the frequency domain discrepancy is first used to improve the perceptual quality of HSIs. The proposed FDL forces the model to restore high and hard frequencies adaptively.
• We design the HR pixel-level attention in SDL for higher internal feature resolution, which further assists fre-quency alignment in FDL. Complementary dual-domain learning mechanism ameliorate HSI quality mutually.
• Our method achieves state-of-the-art (SOTA) perfor-mance in quantitative evaluation and visual comparison.
Extensive experiments prove the superiority of HDNet. 2.