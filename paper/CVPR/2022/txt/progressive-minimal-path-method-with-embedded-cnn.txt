Abstract
We propose Path-CNN, a method for the segmentation of centerlines of tubular structures by embedding convolu-tional neural networks (CNNs) into the progressive minimal path method. Minimal path methods are widely used for topology-aware centerline segmentation, but usually these methods rely on weak, hand-tuned image features. In con-trast, CNNs use strong image features which are learned automatically from images. But CNNs usually do not take the topology of the results into account, and often require a large amount of annotations for training. We integrate
CNNs into the minimal path method, so that both techniques beneﬁt from each other: CNNs employ learned image fea-tures to improve the determination of minimal paths, while the minimal path method ensures the correct topology of the segmented centerlines, provides strong geometric priors to increase the performance of CNNs, and reduces the amount of annotations for the training of CNNs signiﬁcantly. Our method has lower hardware requirements than many re-cent methods. Qualitative and quantitative comparison with other methods shows that Path-CNN achieves better perfor-mance, especially when dealing with tubular structures with complex shapes in challenging environments. 1.

Introduction
Topology-aware centerline segmentation for tubular structures plays a crucial role in computer vision. One of its most important application areas is the quantitative anal-ysis of roads and rivers in satellite images for measurement, planning, or navigation. These are challenging tasks due to the complex shape of roads and rivers, and the high vari-ability of their environment.
When using common methods for object segmentation for this task, usually a binary mask of the tubular structure is computed in the ﬁrst step. After that, post-processing, of-ten based on heuristics, is necessary, in order to determine the centerline and to deal with small gaps on the tubular
In contrast, min-structure due to noise or image clutter. imal path methods based on Dijkstra’s algorithms [7] or (a) Input image (b) Segmented centerlines
Figure 1. Short cuts due to complex centerline geometry. (a) The input is a satellite image of roads. (b) Start point (magenta box) and end point (cyan circle) of a road are given. Results of a pre-vious method using only hand-tuned tubularity measure (yellow line) and two methods using CNNs (blue and green lines) contain short cuts. Our approach achieves the correct centerline (red line), although it is much longer than the results with short cuts. the fast marching method [5] provide a more elegant solu-tion. As in most minimal path methods, we assume that the start point xs and end point xe of the centerline are given, and focus on the determination of the path itself. Often, the start and end points are automatically obtained using application speciﬁc methods, such as [19]. Minimal path methods allow ﬁnding the best path as the global optimum of a cost function, while inherently enforcing strict line-topology, i.e., the result is always a sequence of coordinates of points on the centerline. Also, small gaps on the path can be completed automatically. However, minimal path methods usually utilize hand-tuned image features, such as differential measures [8, 13], to distinguish between tubular structures and the background. Such features are efﬁcient to compute, but they are relatively weak and may lead to short cuts for images containing challenging environments. With convolutional neural networks (CNNs), stronger image fea-tures can be extracted automatically from images. Although these features alone cannot ensure the topology of the cen-terlines, they can be used to better classifying the pixels and thus improve the results of minimal path methods. How-ever, CNNs often require large amounts of annotated train-ing data, which can be expensive to obtain. If only limited annotations are available, often CNN-based methods can-not be fully trained, and thus they also result in short cuts.
Examples of short cuts are shown in Fig. 1.
In this work, we propose a novel method, Path-CNN, to embed CNNs into the progressive minimal path method
[15], so that these two techniques operate alternately and beneﬁt from each other: On the one hand, we use CNNs to learn image features automatically so that a wider variety of short cuts can be detected, and therefore minimal paths can be better determined. Instead of learning features for isolated pixels as in most previous approaches, our CNNs learn features for rectiﬁed patches along paths. On the other hand, the progressive minimal path method not only ensures the line-topology of the results, but also provides strong ge-ometric priors, which are used in turn to reduce the num-ber of training samples for CNNs signiﬁcantly. Although we only use centerlines as training data, our method not only determines centerlines, but also produces binary seg-mentation masks for tubular structures. To the best of our knowledge, this is the ﬁrst approach to employ such geo-metric priors for CNNs to segment centerlines of tubular structures. Compared with most other approaches based on deep learning, our method has lower requirements not only for the amount of annotations and but also for hardware. 2.