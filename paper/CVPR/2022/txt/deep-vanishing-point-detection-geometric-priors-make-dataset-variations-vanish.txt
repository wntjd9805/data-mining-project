Abstract
Deep learning has improved vanishing point detection in images. Yet, deep networks require expensive annotated datasets trained on costly hardware and do not generalize to even slightly different domains, and minor problem vari-ants. Here, we address these issues by injecting deep van-ishing point detection networks with prior knowledge. This prior knowledge no longer needs to be learned from data, saving valuable annotation efforts and compute, unlocking realistic few-sample scenarios, and reducing the impact of domain changes. Moreover, the interpretability of the priors allows to adapt deep networks to minor problem variations such as switching between Manhattan and non-Manhattan worlds. We seamlessly incorporate two geometric priors: (i) Hough Transform – mapping image pixels to straight lines, and (ii) Gaussian sphere – mapping lines to great circles whose intersections denote vanishing points. Ex-perimentally, we ablate our choices and show comparable accuracy to existing models in the large-data setting. We validate our model’s improved data efficiency, robustness to domain changes, adaptability to non-Manhattan settings. 1.

Introduction
Vanishing point detection in images has non-vanishing real-world returns: camera calibration [1, 9, 21], scene understanding [18], visual SLAM [13, 33], or even au-tonomous driving [28]. Deep learning is an excellent ap-proach to vanishing point detection [7, 8, 67, 69], where all geometric knowledge is learned from large annotated data sets. Yet, in the real-world, there are several factors that complicate deep learning solutions: (1) Manually annotat-ing large training sets is expensive and error prone; (2)
Training models on large data sets require costly compu-tational resources; (3) Practical changes to data collection cause domain shifts, hampering deep network generaliza-tion; (4) Slight changes in the problem setting require a complete change in deep network architectures. Thus, there is a need to make deep learning less reliant on data, and its architectures more robust to variants of the same problem.
In this paper, we add geometric priors to deep vanishing
Figure 1. We add two geometric priors: (i) Hough Transform and (ii) Gaussian sphere mapping, for vanishing points detection.
We transform learned image features to the Hough domain, where lines are mapped to individual bins. We further project the Hough bins to the Gaussian sphere, where lines become great circles and vanishing points are at the intersection of great circles. Each color represents a set of image lines related to a vanishing point. Adding geometric prior knowledge makes our model data-efficient, less dependent on domain-specifics, and easily adaptable to problem variations such as detecting a variable number of vanishing points. point detection. Using geometric priors is data-efficient as this knowledge no longer needs to be learned from data.
Thus, fewer annotations and compute resources are needed.
Moreover, by relying on priors, the model is less sensitive to particular idiosyncrasies in the training data and generalizes better to domains with slightly different data distributions.
Another advantage of a knowledge-based approach is that it is interpretable, and thus the architecture is easy to adapt to a slightly different problem formulation.
We add two geometric priors, see Fig. 1: (i) the Hough
Transform and (ii) a Gaussian sphere mapping. Our train-able Hough Transform module represents each line as an (offset, angle) pair in line polar coordinates, allowing us to identify individual lines in Hough space [15]. We sub-sequently map these lines from Hough space to the Gaus-sian sphere, where lines become great circles, and vanishing points are located at the intersection of great circles [4]. The benefit of using great circles is that lines are mapped from the unbounded image plane to a bounded unit sphere, fa-cilitating vanishing point detection outside the image view.
Both the Hough Transform and the Gaussian sphere map-ping are end-to-end trainable, taking advantage of learned representations, while adding knowledge priors.
This paper makes the following contributions: (1) we add two geometric priors for vanishing point detection by mapping CNN features to the Hough Transform, and map-ping Hough bins to the Gaussian sphere; (2) we validate our choices and demonstrate similar accuracy as existing mod-els on the large ScanNet [12] and SceneCity Urban 3D [70]; (3) we show that adding prior knowledge increases data-efficiency, improving accuracy for smaller datasets; (4) we demonstrate our ability to tackle a different problem vari-ant: detecting a varying numbers of vanishing points on the NYU Depth [45] dataset, where the number of van-ishing points varies drastically from 1 to 8; (5) we show that adding prior knowledge reduces domain shift sensitiv-ity, which we validate by cross-dataset testing. 2.