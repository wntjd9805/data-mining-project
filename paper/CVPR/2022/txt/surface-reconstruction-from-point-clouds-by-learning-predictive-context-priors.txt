Abstract
Surface reconstruction from point clouds is vital for 3D computer vision. State-of-the-art methods leverage large datasets to ﬁrst learn local context priors that are repre-sented as neural network-based signed distance functions (SDFs) with some parameters encoding the local contexts.
To reconstruct a surface at a speciﬁc query location at in-ference time, these methods then match the local recon-struction target by searching for the best match in the lo-cal prior space (by optimizing the parameters encoding the local context) at the given query location. However, this re-quires the local context prior to generalize to a wide variety of unseen target regions, which is hard to achieve. To re-solve this issue, we introduce Predictive Context Priors by learning Predictive Queries for each speciﬁc point cloud at inference time. Speciﬁcally, we ﬁrst train a local context prior using a large point cloud dataset similar to previous techniques. For surface reconstruction at inference time, however, we specialize the local context prior into our Pre-dictive Context Prior by learning Predictive Queries, which predict adjusted spatial query locations as displacements of the original locations. This leads to a global SDF that
ﬁts the speciﬁc point cloud the best. Intuitively, the query prediction enables us to ﬂexibly search the learned local context prior over the entire prior space, rather than being restricted to the ﬁxed query locations, and this improves the generalizability. Our method does not require ground truth signed distances, normals, or any additional procedure of signed distance fusion across overlapping regions. Our experimental results in surface reconstruction for single shapes or complex scenes show signiﬁcant improvements over the state-of-the-art under widely used benchmark-∗The corresponding author is Yu-Shen Liu. This work was sup-ported by National Key R&D Program of China (2018YFB0505400, 2020YFF0304100), the National Natural Science Foundation of China (62072268), the National Natural Science Foundation (1813583) and in part by Tsinghua-Kuaishou Institute of Future Media Data. s. Code and data are available at https://github. com/mabaorui/PredictableContextPrior. 1.

Introduction
Surface reconstruction from 3D point clouds estimates continuous surfaces from 3D point clouds that can be cap-tured by various 3D sensors. This is still a challenge even with the help of state-of-the-art deep learning models. A s-tandard strategy [1,14,19] is to ﬁrst learn a Signed Distance
Function (SDF) from a point cloud [1, 19] or from ground truth signed distances [14] using a neural network, and then reconstruct a surface based on the learned SDF via march-ing cubes [47].
If the SDF is trained to capture a global shape prior from a global 3D shape, however, it is hard to capture local geometry details.
As a remedy, state-of-the-art methods learn local SDFs from local regions [7, 37, 73]. The global shape is usually split into overlapping [37, 73] or non-overlapping [7] part-s, and the local region prior is learned as a local SDF that is represented by a neural network with some parameters encoding the geometry of local regions. The intuition be-hind this idea is that the local region prior will generalize to various unseen local reconstruction targets, and for sur-face reconstruction at inference time, its parameters can be optimized to match the reconstruction target at speciﬁc lo-cations. However, the matching requires the learned local region prior to cover as many speciﬁc locations on target regions as possible, which dramatically limits the general-ization ability of the learned local prior.
To resolve this issue, we propose to learn SDFs as a Pre-dictive Context Prior for highly accurate surface reconstruc-tion from point clouds, as shown in Fig. 1. Speciﬁcally, we
ﬁrst train a neural network to represent local SDFs of local regions across a large dataset of point clouds. This aims to capture a local context prior in a local coordinate sys-tem, similar as in previous work. Our main contribution is that during surface reconstruction at inference time, we spe-cialize the pre-trained local context prior into a Predictive
to capture local shape priors as SDFs [7, 37, 46]. This re-quires to split the point cloud into different voxels, and then represent the points in each voxel as a latent code that is either extracted by a neural network [37, 46] or learned in an auto-decoding manner [7, 37]. These methods need nor-mals for each point to produce signed distances as super-vision in the optimization. Given the ground truth signed distances, Points2Surf [14] encodes points sampled in a lo-cal patch and on the whole point cloud as a shape prior, while DeepMLS [44] learns to produce oriented points to approximate SDFs. Similarly, PatchNet [73] learns local
SDFs to represent patches with explicit control over posi-tions, orientations, and scales. Neural-pull [49] introduced a new way of learning SDFs by pulling nearby space onto the surface, which is achieved by predicting the SDFs and its gradient using the network. This removes the require-ment of ground truth normals or signed distances. A similar idea is introduced to learn unsigned distances [11], but re-quires to move dense sampling with additional directions to form the surface. Moreover, other novel ways for surface reconstruction have been proposed, such as a differentiable formulation of Poisson solver [59], point convolution [6] and part retrieval [66].
Other information is also leveraged to learn implicit functions [52, 68, 83]. Occupancy is used to capture a prior at a global level [36,68] or a local level [52]. Iso-points [83] tried to impose geometry-aware sampling and regulariza-tion in the learning. Moreover, implicit functions can al-so be learned from point clouds with additional constraints, such as geometric regularization [19], sign agnostic learn-ing with a specially designed loss function [1], sign agnos-tic learning with local surface self-similarities and post sign processing [71, 85], constraints on gradients [2] or a diver-gence penalty [4].
From a meshing perspective, surfaces can also be re-constructed by generating local connectivity with intrinsic-extrinsic metrics [43], Delaunay triangulation of point clouds [48] or inheriting connectivity from an initial mesh [30]. With local chart parameterizations in neural net-works, a local point cloud is reconstructed via ﬁtting us-ing the Wasserstein distance as a measure of approxima-tion [79].
Deep Shape Prior. Beside the priors reviewed above, shape priors can also be captured by parameters in neural network-s in shape reconstruction [3, 16, 20, 21, 25, 28, 34, 65, 74, 82], segmentation [45,60,61], and completion [32,33,76,80,84].
Deep manifold prior [17] was introduced to reconstruct 3D shapes starting from random initializations. 3. Method
Overview. We provide an overview of our method in Fig. 2.
We aim to reconstruct a surface mesh for a 3D point cloud
G. Our method consists of the following three stages.
Figure 1. We reconstruct highly accurate surfaces from 300K points. Front views of each shape are shown with normal map-s. The comparison with Poisson is in supplemental materials.
Context Prior for a speciﬁc point cloud by learning Predic-tive Queries. More concretely, Predictive Queries learn to predict query locations for the pre-trained local SDF from queries given in the global coordinate system of the speciﬁc point cloud. This is achieved by sampling a set of queries in the global coordinate system, and learning to predict queries for the local SDF to minimize surface reconstruction error.
Intuitively, learning to predict query locations for the lo-cal SDF allows us to more ﬂexibly match the learned local context prior to best ﬁt the given point cloud during surface reconstruction. This further leads to a global SDF for the speciﬁc point cloud. Our method does not require ground truth signed distances, normals in the training, or any addi-tional post processing. Our contributions are as follows: i) We introduce a neural network architecture using Pre-dictive Context Priors to learn SDFs for surface recon-struction from point clouds. Predictive Context Priors are implemented by learning Predictive Queries. ii) We demonstrate that Predictive Queries allow us to im-prove generalizability of a pre-trained local context pri-or, which improves reconstruction accuracy. iii) We report state-of-the-art results in surface reconstruc-tion for single shapes or complex scenes under widely used benchmarks. 2.