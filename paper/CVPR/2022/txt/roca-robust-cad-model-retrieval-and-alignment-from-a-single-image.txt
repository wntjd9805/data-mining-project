Abstract
We present ROCA 1, a novel end-to-end approach that re-trieves and aligns 3D CAD models from a shape database to a single input image. This enables 3D perception of an ob-served scene from a 2D RGB observation, characterized as a lightweight, compact, clean CAD representation. Core to our approach is our differentiable alignment optimization based on dense 2D-3D object correspondences and Pro-crustes alignment. ROCA can thus provide a robust CAD alignment while simultaneously informing CAD retrieval by leveraging the 2D-3D correspondences to learn geometri-cally similar CAD models. Experiments on challenging, real-world imagery from ScanNet show that ROCA signif-icantly improves on state of the art, from 9.5% to 17.6% in retrieval-aware CAD alignment accuracy. 1The code is made available at https : / / github . com / cangumeli/ROCA. 1.

Introduction 2D perception systems have seen remarkable advances in object recognition from 2D images in recent years, en-abling widespread adoption of systems that can perform ac-curate 2D object localization, classiﬁcation, and segmen-tation from an image [20, 31, 42]. Such advances have spurred forward developments in many ﬁelds, from classi-cal image understanding to robotics and autonomous driv-ing. However, unlike the human perception of 2D images, these systems tend to perform object recognition purely in 2D, whereas from a single RGB image, a human can per-ceive geometric shape, structure, and pose of the objects in the scene. In fact, such 3D understanding is crucial for many applications, enabling possible exploration and inter-action with an observed environment.
At the same time, there has been notable progress in es-timating 3D object geometry from visual data [9, 16, 19,
In particular, Mesh R-CNN [18] introduced 36, 44, 45]. a formative approach to 3D object estimation from real-world images, bridging state-of-the-art 2D object detec-tion with voxel-to-mesh estimation of the shape of each detected object in an image.
In contrast to this genera-tive approach, Mask2CAD proposed to retrieve and align
CAD models from a database to produce a lightweight ob-ject reconstruction with high ﬁdelity given by the CAD database [27, 35]. With signiﬁcant availability of synthetic
CAD models [5,17,47], such CAD model reconstruction of an observed scene shows strong promise in perceiving 3D from an image, as it enables geometric estimation in a clean, compact fashion more akin to artist-crafted 3D models, and easily consumed for downstream applications.
However, current approaches to estimate 3D object structure from an RGB image have largely focused on shape representation and generation, either without any explicit pose estimation [18], or simply regressing the object pose directly from the 2D features of the object [15,27,28,35,37].
Thus, we propose a new CAD retrieval and alignment ap-proach to estimate 3D perception from an image by for-mulating a differentiable 9-DoF pose optimization directly coupled to the object retrieval; this enables a more robust, geometry-aware, end-to-end CAD alignment to the image.
In this work, we propose ROCA, a new method that jointly detects object regions in a given input image while simultaneously estimating depth and dense corre-spondences between each 2D object region and its location in its canonical object space. From the dense depth and cor-respondence estimates, we then formulate a differentiable
Procrustes optimization and produce a ﬁnal set of retrieved
CAD models and their 9-DoF alignments. This geometry-aware differentiable optimization for the CAD alignment of each object enables more robust and accurate CAD align-ment. In addition, our method learns geometry-aware em-beddings for CAD retrieval. Our retrieval embedding mod-ule utilizes the canonical coordinates used in pose opti-mization and an auxiliary shape completion objective. We show learning geometry-aware embeddings improves both retrieval and alignment accuracy. Overall, our method sig-niﬁcantly outperforms state of the art, improving by 8.1% and 9.5% in retrieval-aware alignment accuracy and align-ment accuracy from a single RGB image.
In summary, we propose an end-to-end architecture for
CAD model alignment to an RGB image with:
• a new differentiable pose optimization enabling geometry-aware 2D-to-3D CAD alignment to an RGB image,
• improved CAD retrieval by leveraging the dense object pose correspondences and proxy CAD completion ob-jective to inform the construction of a joint embedding space between detected objects and CAD models,
• an interactive runtime of 53 milliseconds per image, facilitating its use in real-time applications. 2.