Abstract
We present a scalable combinatorial algorithm for glob-ally optimizing over the space of geometrically consistent mappings between 3D shapes. We use the mathemati-cally elegant formalism proposed by Windheuser et al. [66] where 3D shape matching was formulated as an integer lin-ear program over the space of orientation-preserving dif-feomorphisms. Until now, the resulting formulation had limited practical applicability due to its complicated con-straint structure and its large size. We propose a novel pri-mal heuristic coupled with a Lagrange dual problem that is several orders of magnitudes faster compared to previ-ous solvers. This allows us to handle shapes with substan-tially more triangles than previously solvable. We demon-strate compelling results on diverse datasets, and, even showcase that we can address the challenging setting of matching two partial shapes without availability of com-plete shapes. Our code is publicly available at http:
//github.com/paul0noah/sm-comb. 1.

Introduction
The shape matching problem is widely studied in graph-ics and vision due to its high relevance in numerous appli-cations, including 3D reconstruction, tracking, shape mod-eling, shape retrieval, interpolation, texture transfer, or the canonicalization of geometric data for deep learning. Shape matching refers to finding correspondences between parts of shapes – for example, the shapes may be represented as triangular surface meshes, and correspondences may be ob-tained between vertices or triangles of individual shapes.
While identifying such correspondences is a relatively easy task for humans, from a computational perspective shape matching is much more challenging. This is because many formulations lead to high-dimensional combinatorial opti-mization problems. While some of them are efficiently solvable, e.g. based on the linear assignment problem [47], such simple approaches do not take geometric relations be-tween the shape parts into account and thus typically lead to poor matchings. In contrast, most practically relevant for-mulations account for geometric consistency in some form, which in turn lead to significantly more difficult optimiza-tion problems (e.g. the NP-hard quadratic assignment prob-lem [51], or mixed-integer programming formulations [3]).
A decade ago Windheuser et al. [66, 67] proposed an el-egant formalism for the deformable matching of 3D shapes.
Most notably, their approach is able to account for geomet-ric consistency based on an orientation-preserving discrete diffeomorphism. While this formulation is conceptually ap-pealing, it requires to solve a difficult integer linear pro-gramming (ILP) problem. The authors proposed to relax the binary variables to continuous variables, so that a linear programming (LP) problem is obtained. Although this LP formulation is convex and can thus be solved to global op-timality, the resulting optimization problem is prohibitively large, and in turn only shapes with low resolution (at most 250 triangles) can be matched with existing solvers.
In this work we close this gap and propose a scal-able combinatorial solver for geometrically consistent de-formable 3D shape matching. Our main contributions are:
• We propose a novel primal heuristic, which, together with a Lagrange dual problem, gives rise to a combi-natorial solver for orientation-preserving deformable 3D shape matching based on the formalism by Windheuser et al. [66, 67].
• We show that in the special case of consistent triangula-tions between both shapes our primal heuristic can read-ily be used to solve the ILP formulation to global opti-mally in polynomial time.
• Our solver is orders of magnitude faster than previous solvers, which allows us to handle shapes with a substan-tially higher resolution.
• Experimentally we demonstrate state-of-the-art results on a range of different shape matching problems, and we showcase the applicability to the difficult case of partial-to-partial shape matching. 2.