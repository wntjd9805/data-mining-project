Abstract
While researches on model-based blind single image super-resolution (SISR) have achieved tremendous suc-cesses recently, most of them do not consider the image degradation sufficiently. Firstly, they always assume im-age noise obeys an independent and identically distributed (i.i.d.) Gaussian or Laplacian distribution, which largely underestimates the complexity of real noise. Secondly, pre-vious commonly-used kernel priors (e.g., normalization, sparsity) are not effective enough to guarantee a rational kernel solution, and thus degenerates the performance of subsequent SISR task. To address the above issues, this paper proposes a model-based blind SISR method under the probabilistic framework, which elaborately models im-age degradation from the perspectives of noise and blur kernel. Specifically, instead of the traditional i.i.d. noise assumption, a patch-based non-i.i.d. noise model is pro-posed to tackle the complicated real noise, expecting to increase the degrees of freedom of the model for noise representation. As for the blur kernel, we novelly con-struct a concise yet effective kernel generator, and plug it into the proposed blind SISR method as an explicit ker-nel prior (EKP). To solve the proposed model, a theoreti-cally grounded Monte Carlo EM algorithm is specifically designed. Comprehensive experiments demonstrate the su-periority of our method over current state-of-the-arts on synthetic and real datasets. The source code is available at https://github.com/zsyOAOA/BSRDM . 1.

Introduction
Single image super-resolution (SISR) is a fundamental problem in computer vision. It aims to recover the sharp detailed high-resolution (HR) counterpart from an observed low-resolution (LR) image. Image degradation, the func-tional opposite of image super-resolution, is the process of generating a LR image from the HR one. Unfortunately, the degradation model is always unknown while compli-cated, making the blind SISR problem extremely challeng-ing. How to rationally and practically model the degrada-tion is therefore of great significance in blind SISR.
Early methods [14, 24, 44, 45] simply regard SISR as an interpolation problem. They have fast processing speed but always blur high frequency details. Later methods be-gin to consider the image degradation, and can be roughly divided into two categories, namely model-based methods and learning-based methods. From the Bayesian perspec-tive, model-based methods [11,20,25,36,40,42] firstly build a generative model based on the image degradation and then estimate the blur kernel and the HR image under the maxi-mum a posteriori (MAP) framework. Such MAP estimation is implemented for each LR image individually, and thus tends to achieve better generalization for unknown degrada-tions. Learning-based methods [10, 25, 56, 65], on the other hand, aim to learn a unified super-resolver based on a large amount of LR/HR image pairs synthesized according to the pre-assumed degradation model. Recently, to improve their generalization, some works [8,16,28,51,54] attempt to learn the degradation model from unpaired real image data. How-ever, these learning-based methods rely heavily on the col-lected training data, and may suffer from a severe perfor-mance drop when unseen degradations show up in testing.
In this paper, we follow the model-based methodology for its better generalization capability.
Most of the model-based blind SISR methods can be generally formulated as the following MAP problem: max x,k log p(y|x, k) + log p(k) + log p(x), (1) where y, x, and k denote the observed LR image, the un-derlying HR image, and the blur kernel, respectively. The last term represents the image prior, while the first and sec-ond terms deliver our knowledges on the degradation model (i.e., noise distribution and kernel prior). Most of the exist-ing methods focus on designing more rational image priors,
Figure 1. An overview of the proposed SISR method and the corresponding EM algorithm. A probabilistic model is constructed to depict the generation process of the observed LR image, which mainly involves two groups of parameters, including the latent variable z and the model parameters {α, L, λ}.
A Monte Carlo EM algorithm is designed to alternately update them in the E-Step and M-Step, respectively. such as gradient profile [42], sparsity [7, 20], DIP [46] and so on [9, 11, 22, 32, 34, 38]. However, they often do not suf-ficiently consider the degradation model:
• As for noise modeling, most of current method adopt the independent and identically distributed (i.i.d.) Gaus-sian or Laplacian distribution to model the noise. Such a simple noise assumption, however, usually underes-timates the complexity of real image noise and shows limited robustness in practical applications. For exam-ple, the most common camera sensor noise affected by the in-camera pipeline is signal-depedent, and thus ex-hibits evident non-i.i.d. property in statistics.
• As for kernel modeling, traditional methods often ig-nore it or adopt some heuristic priors, e.g., normaliza-tion (i.e., the kernel elements sum to 1) [17] and spar-sity [3], which usually cannot guarantee a rational kernel solution. Recently, Liang et al. [25] trained an implicit mapping parameterized as a convolutional neural net-work (CNN) from the latent noises to anisotropic Gaus-sian kernels, and then embedded it into the blind SISR as a kernel prior. Albeit achieving evident performance im-provement, this method depends on a time-consuming and labor-cubersome pre-training phase. Moreover, the fitting error, which is inevitable during training, may be enlarged in the alternate iterations between the kernel estimation and super-resolution tasks. The performance of blind SISR can be therefore further improved by de-signing an explicit yet effective kernel prior.
To address the above issues, this paper proposes a prob-abilistic blind SISR method that elaborately considers the noise and kernel modeling (see Fig. 1). To better model the complicated real noise, a patch-based non-i.i.d. Gaus-sian noise assumption is adopted instead of the conventional i.i.d. one. Under such setting, each p×p image patch has its own noise parameter, which complies better with the config-urations of real noise. As for blur kernel, we observe that it can be formulated as an explicit and differentiable function in terms of the covariance matrix. This inspire us to con-struct an explicit kernel prior (EKP) for the generally used anisotropic Gaussian kernel, which can be easily embedded into current deep learning (DL)-based blind SISR methods.
In summary, the contributions of this work is three-fold: 1. Different from the commonly-used i.i.d. Gaussian or
Laplacian distribution, a patch-based non-i.i.d. noise distribution is employed in the proposed method, mak-ing it able to handle complicated real noise. 2. A generative kernel prior named EKP is novelly con-structed for the blind SISR task. It is with explicit and concise form, and substantiated to be able to attain a more stable kernel estimation for SISR. 3. A theoretically grounded Monte Carlo EM algorithm (see Fig. 1) is designed to solve our proposed model. 2.