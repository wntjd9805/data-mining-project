Abstract 1.

Introduction
With the advent of convolutional neural networks, stereo matching algorithms have recently gained tremendous progress. However, it remains a great challenge to accu-rately extract disparities from real-world image pairs taken by consumer-level devices like smartphones, due to practi-cal complicating factors such as thin structures, non-ideal rectification, camera module inconsistencies and various hard-case scenes.
In this paper, we propose a set of in-novative designs to tackle the problem of practical stereo matching: 1) to better recover fine depth details, we design a hierarchical network with recurrent refinement to update disparities in a coarse-to-fine manner, as well as a stacked cascaded architecture for inference; 2) we propose an adap-tive group correlation layer to mitigate the impact of erro-neous rectification; 3) we introduce a new synthetic dataset with special attention to difficult cases for better generaliz-ing to real-world scenes. Our results not only rank 1st on both Middlebury and ETH3D benchmarks, outperforming existing state-of-the-art methods by a notable margin, but also exhibit high-quality details for real-life photos, which clearly demonstrates the efficacy of our contributions.
*Equal contribution. † Corresponding author.
Stereo matching is a classical research topic of computer vision, the goal of which, given a pair of rectified images, is to compute the displacement between two corresponding pixels, namely “disparity” [34]. It plays an important role in many applications, including autonomous driving, aug-mented reality, simulated bokeh rendering and so forth.
Recently, with the support of large synthetic datasets
[5, 27, 46], convolutional neural network (CNN) based stereo matching methods have taken the accuracy of dis-parity estimation to a new height [8, 23, 44]. However, to make the algorithm truly practical in the scenario of every-day consumer photography, we are still faced with three ma-jor obstacles.
Firstly, it remains a complicated issue for most existing algorithms to precisely recover the disparity of fine image details, or thin structures such as nets and wire frames. The fact that consumer photos are being produced in higher res-olutions only serves to worsen the problem. In computa-tional bokeh, for instance, disparity error around fine details would result in degraded rendering results that are unpleas-ing to human perception [32]. Secondly, perfect rectifica-tion [24, 56] is hard to obtain for real-world stereo image pairs, as they are often produced by camera modules with
different traits. For example, most current smartphones cap-ture the stereo pair with a wide-angle and a telephoto lens, which have distinct characteristics like focal length and dis-tortion parameters, inevitably resulting in non-ideal recti-fications. Therefore existing methods assuming that the stereo pair is perfectly rectified are likely to fail under such adversarial conditions. In addition, the image pair produced by inconsistent cameras modules may vary in illumination, white balancing, image quality, etc., making the estimation task even harder. Finally, though it has been shown that models trained from large enough synthetic datasets can generalize well to real-world scenes [10, 27], disparity esti-mation in typical hard cases, like non-texture or repetitive-texture regions, continues to be difficult, which requires special attention be paid in covering relevant scenes in the training dataset.
In this paper, we propose CREStereo, namely Cascaded
REcurrent Stereo matching network, which comprises a set of novel designs, to tackle the problem of practical stereo matching. To better recover intricate image details, we de-sign a hierarchical network to update disparities recurrently in a coarse-to-fine manner; in addition, we adopt a stacked cascaded architecture for high-resolution inference. To alle-viate the negative influence of rectification error, we design an adaptive group local correlation layer for feature match-ing. Furthermore, we introduce a new synthetic dataset with richer variations in lighting, texture and shapes, in order to better generalize to real-world scenes.
So far, CREStereo ranks 1st on both ETH3D two-view stereo [36] and Middlebury [35] benchmarks, and achieves competitive performance on KITTI 2012/2015 [11] among published methods. Additionally, our network demonstrates superior performance for arbitrary real-world scenes, well proving the effectiveness of our designs.
Our main contributions can thus be summarized as fol-lows: 1) we propose a cascaded recurrent network for prac-tical stereo matching and a stacked cascaded architecture for high-resolution inference; 2) we design an adaptive group correlation layer to handle non-ideal rectification; 3) we create a new synthetic dataset to better generalize to real-world scenes; 4) our method outperforms existing methods on public benchmarks such as Middlebury and ETH3D by a significant margin, and considerably increases the accuracy of recovered disparities for real-world stereo images. 2.