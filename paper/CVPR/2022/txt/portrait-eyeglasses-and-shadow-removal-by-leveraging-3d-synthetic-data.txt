Abstract
In portraits, eyeglasses may occlude facial regions and generate cast shadows on faces, which degrades the per-formance of many techniques like face veriﬁcation and ex-pression recognition. Portrait eyeglasses removal is criti-cal in handling these problems. However, completely re-moving the eyeglasses is challenging because the lighting effects (e.g., cast shadows) caused by them are often com-plex. In this paper, we propose a novel framework to re-move eyeglasses as well as their cast shadows from face images. The method works in a detect-then-remove manner, in which eyeglasses and cast shadows are both detected and then removed from images. Due to the lack of paired data for supervised training, we present a new synthetic por-trait dataset with both intermediate and ﬁnal supervisions for both the detection and removal tasks. Furthermore, we apply a cross-domain technique to ﬁll the gap between the synthetic and real data. To the best of our knowledge, the proposed technique is the ﬁrst to remove eyeglasses and their cast shadows simultaneously. The code and syn-thetic dataset are available at https://github.com/
StoryMY/take-off-eyeglasses. 1.

Introduction
A large portion of people wears eyeglasses in their daily lives.
In their face photos, eyeglasses usually bring un-wanted occlusions and cast shadows on faces, which lead to inaccuracy in many useful techniques like image-based face veriﬁcation [42, 46], expression recognition [47], fa-tigue detection [13, 17, 40], etc. Besides, in photography, removing eyeglasses from portraits could be needed for aes-thetic reasons, giving users a choice to edit their portraits.
Therefore, it is beneﬁcial to develop an automatic technique for portrait eyeglasses removal.
However, completely removing eyeglasses suffers some key challenges. First, to recover the occluded facial re-gion and keep it consistent with the remaining regions is a difﬁcult task as facial skin has rich details and complex reﬂectance. Second, only recovering the occluded region cannot ensure visually convincing results as eyeglasses also
Figure 1. Our method allows to remove eyeglasses and their shad-ows simultaneously. It produces photo-realistic results under vari-ous illuminations, head poses and eyeglasses with different shapes and textures. bring various lighting effects (e.g., cast shadows, reﬂections and distortions) on face regions. Explicitly modeling these effects is extremely difﬁcult as the physical rules to gener-ate these effects are complicated. And it requires a delicate perception of the eyeglasses geometry, face geometry and lighting conditions, which are also difﬁcult to obtain from a single portrait.
Recently, deep learning [30, 44] has shown its great po-tential in handling tasks related to face editing [14, 33], and has been successfully applied to portrait eyeglasses re-moval [22] with the help of the face datasets [27, 35] con-taining eyeglasses labels. However, these techniques only focus on the eyeglasses but not the corresponding lighting effects. ByeGlassesGAN [32] constructs paired data con-taining some lighting effects for training. However, as it uses 2D methods to synthesize the data, the quality and re-alism are quite limited. Also, it does not take cast shadows into consideration.
In this paper, we propose a novel eyeglasses removal technique using a synthetic dataset which considers 3D shadows and uses a cross-domain training strategy to ﬁll the gap between synthetic and real data. This method jointly re-moves eyeglasses and their cast shadows, generating more visually plausible results compared to the previous state-of-the-art methods. In order to facilitate learning the rela-tion between eyeglasses and cast shadows, we introduce a novel mask-guided multi-step network architecture for eye-glasses removal. The proposed network ﬁrst detects two masks for both eyeglasses and their cast shadows. Then, the estimated masks are used as guidance in the multi-step eyeglasses removal. We observe that the shadows to be re-moved are caused by the eyeglasses, and we use this fact to carefully construct our network where the eyeglasses and shadows are handled in well-designed orders in both the de-tection and removal tasks. In this way, the network can well take eyeglasses as an important prior when dealing with the shadows.
For training this network, we build a photo-realistic syn-thetic dataset using high-quality face scans collected by [52] and 3D eyeglasses models made by artists, with principled
BSDF [37] to achieve high rendering quality. This dataset contains a large amount of data for supervised training, cov-ering various identities, expressions, eyeglasses, and illumi-nations. Another beneﬁt of using the synthetic dataset is that we can synthesize images that cannot be captured in real world, i.e., images with eyeglasses but no shadows and images with shadows but no eyeglasses. These images can be used as intermediate supervisions to train the proposed network.
Although the accurate 3D information and the high-end rendering technique improve the photo-realism of our syn-thetic data, the network still cannot generalize well to real images due to the gap between the synthetic and real do-main. Inspired by [23] and [49], we develop a cross-domain segmentation module that leverages a real image dataset to build a uniform domain for both the real and synthetic images. This helps to prevent the proposed network from using domain-speciﬁc information to detect eyeglasses and their cast shadows.
In summary, our main contributions are listed as follows:
• We design a novel mask-guided multi-step network ar-chitecture which is the ﬁrst attempt in the literature to remove both eyeglasses and their cast shadows from portraits and achieves high realism.
• We present a high-quality synthetic portrait dataset which provides both intermediate and ﬁnal supervi-sions for training eyeglasses/shadows detection and re-moval networks.
• We introduce a cross-domain segmentation module to enhance the generalization capability on real face im-ages. 2.