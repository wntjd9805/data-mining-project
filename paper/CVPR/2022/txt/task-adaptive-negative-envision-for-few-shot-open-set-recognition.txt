Abstract
We study the problem of few-shot open-set recognition (FSOR), which learns a recognition system capable of both fast adaptation to new classes with limited labeled exam-ples and rejection of unknown negative samples. Tradi-tional large-scale open-set methods have been shown in-effective for FSOR problem due to data limitation. Current
FSOR methods typically calibrate few-shot closed-set clas-sifiers to be sensitive to negative samples so that they can be rejected via thresholding. However, threshold tuning is a challenging process as different FSOR tasks may require different rejection powers. In this paper, we instead propose task-adaptive negative class envision for FSOR to integrate threshold tuning into the learning process. Specifically, we augment the few-shot closed-set classifier with additional negative prototypes generated from few-shot examples. By incorporating few-shot class correlations in the negative generation process, we are able to learn dynamic rejec-tion boundaries for FSOR tasks. Besides, we extend our method to generalized few-shot open-set recognition (GF-SOR), which requires classification on both many-shot and few-shot classes as well as rejection of negative samples.
Extensive experiments on public benchmarks validate our methods on both problems. 1 1.

Introduction
With the emergence of large-scale image datasets [4, 5, 23], deep learning has achieved great success in various vi-sion tasks [3, 15â€“17, 31, 34]. Current recognition systems usually assume a predefined set of classes with sufficient number of labeled data. Each testing sample is supposed to belong to these predefined classes so that the systems only need to perform closed-set classification.
In real-world applications, we face more challenging recognition scenarios. First, sufficient labeled training data are hardly guaranteed due to high cost of data collection and possibly limited access to sensitive or rare data. Few-shot 1Code available at https://github.com/shiyuanh/TANE
Figure 1. (Up): For each few-shot class in few-shot open-set recognition (FSOR) task T1 and T2, we calculate the detection scores (similarity) of both negative and positive queries and find their mean and standard deviation. (We use the same negative queries for both tasks.) However, a negative query may have simi-lar detection score to the positive queries (highlighted by red box). (Down): In addition, to reject a negative query, existing FSOR method relies on a manually selected threshold. However, a rejec-tion threshold working properly for T1 may fail in T2. Instead, we propose to learn a negative prototype that automatically estimates a task-adaptive threshold for negative detection. learning [6, 37, 40, 43] (FSL) typically tackles data insuffi-ciency scenario by fast adaptation of recognition system to new classes with access to very few (e.g., only one) labeled instances. But FSL still holds a closed-set assumption.
On the other hand, there are efforts that endow a recog-nition system with the ability to handle out-of-distribution testing samples. Open-set recognition (OR) [1,11,25,35,36] considers the case where testing samples could come from other unknown source under a large-scale training setting.
Without loss of capability of classifying closed-set queries (i.e., positive queries), it also needs to detect queries from unknown classes (i.e., negative queries). Current OR meth-ods typically learns an open-set classifier by either calibrat-ing prediction scores or synthesizing negative queries. They rely on large amount of data to avoid overfitting and esti-mate distribution properly. But with only a few labeled in-stances, it becomes hard to do so. Hence direct application
of OR methods under few-shot setting degrades the perfor-mance significantly [20, 24].
We aim to develop a model solving for both challenges, i.e., few-shot open-set recognition (FSOR). The goal of
FSOR is to both 1) accept & recognize positive queries from few-shot classes with very few labeled samples and 2) de-tect negative queries from undisclosed (negative) classes.
Previous FSOR methods [20, 24] provide meta-learning-based solutions for learning threshold-based negative detec-tor. They calibrate few-shot close-set classifier and output a rejection score for each testing sample. A sample is rejected if the rejection score is above a certain rejection threshold, which has to be manually defined. However, as shown in
Fig. 1, a good recognition performance relies heavily on a good choice of threshold: (a) a few-shot classifier may have similar detection score for a negative query and a positive query, where different thresholds need to be set separately; (b) to reject a negative query, a threshold works properly for one task may fail in other tasks. In summary, threshold tun-ing could be a challenging process as different FSOR tasks contain different few-shot classes that may need very differ-ent rejection powers to determine outliers.
In this paper, we instead propose to integrate threshold tuning into the learning process for FSOR. We extend the few-shot classifier with additional prototypes that represent the negative class. Specifically, a negative generator is ap-plied on few-shot class prototypes and learns negative pro-totypes across tasks via meta-learning, so that negative pro-totypes can serve as task-adaptive rejection boundaries for different FSOR tasks. A testing query is then rejected if the prediction scores on all few-shot classes are lower than that on the negative prototype. We study the design of negative generator and experimentally demonstrate an optimal solu-tion that involves task-level information into the negative prototype envision. We also introduce the concept of con-jugate task of FSOR where two FSOR tasks are considered conjugate if the few-shot class in one task can be used to simulate unknown sources in the other. To this end, we pro-pose a conjugate training strategy to facilitate the learning process. Moreover, we consider a new but more challenging problem, generalized FSOR (GFSOR), where the recogni-tion system needs to classify on both many-shot and few-shot classes as well as reject negative samples. In this case, negative prototypes are generated from both many-shot and few-shot classes. We name our method of learning negative prototypes as task-adaptive negative class envision.
Our method is validated by extensive experiments on public benchmarks for both FSOR and GFSOR problems.
In summary, our contributions are as follows: 1. We provide a threshold-free solution for few-shot open-set recognition (FSOR), where we extend clas-sifier with negative prototypes that compute task-adaptive rejection boundaries. 2. We provide a study of the negative prototype generator design and experimentally demonstrate an optimal so-lution involving task-level knowledge for negative en-vision. In addition, we propose an efficient and novel training strategy, conjugate training, to facilitate the learning process. 3. Extensively evaluated on public benchmarks, our ap-proach is able to achieve SOTA performance. We further formulate the problem of generalized FSOR where our method is also shown to be effective.
In the following sections, we will discuss related liter-ature in FSL, OR and FSOR (Sec. 2); In Sec. 3 we for-mally define FSOR and GFSOR tasks and go over exist-ing threshold-based meta-learning solutions. In Sec. 4 we present our approach of task-adaptive negative envision. Fi-nally in Sec. 5 we demonstrate the experimental analysis and results of our approach. 2.