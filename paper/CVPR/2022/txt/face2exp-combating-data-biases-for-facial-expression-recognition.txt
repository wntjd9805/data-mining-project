Abstract
Facial expression recognition (FER) is challenging due to the class imbalance caused by data collection. Exist-ing studies tackle the data bias problem using only la-beled facial expression dataset. Orthogonal to existing
FER methods, we propose to utilize large unlabeled face recognition (FR) datasets to enhance FER. However, this raises another data bias problem—the distribution mis-match between FR and FER data. To combat the mis-match, we propose the Meta-Face2Exp framework, which consists of a base network and an adaptation network. The base network learns prior expression knowledge on class-balanced FER data while the adaptation network is trained to fit the pseudo labels of FR data generated by the base model. To combat the mismatch between FR and FER data, Meta-Face2Exp uses a circuit feedback mechanism, which improves the base network with the feedback from the adaptation network. Experiments show that our Meta-Face2Exp achieves comparable accuracy to state-of-the-art
FER methods with 10% of the labeled FER data utilized by the baselines. We also demonstrate that the circuit feedback mechanism successfully eliminates data bias 1. 1.

Introduction
Facial expression recognition (FER) has many applica-tions in human-computer interaction and affective comput-ing [1, 2, 7]. However, as shown in Figure 1 (a), exist-ing FER training datasets are biased towards some major-ity classes, which leads to poor test accuracy for the mi-nority classes. The bias is because some facial expres-sions (e.g., contempt, disgust) are rare in daily life and it is expensive collect many samples for them. Deep neu-ral networks (DNNs) trained with biased data tend to favor majority classes and perform poorly on minority classes. 1Code is available at link:https://github.com/danzeng1990/Face2Exp.
* Corresponding author.
Figure 1. (a) The class distribution of FER training data is biased, resulting in different test accuracy among the classes. (b) The class distributions of FER and FR data mismatches. We use ResNet50 trained with the entire AffectNet to test FER and FR data.
Early FER methods, such as [9] and [19], train deep neural network with biased FER data to classify expressions and observe sharp accuracy drop for minority expression cate-gories. To tackle the class bias, later methods [32], [10] use human facial movements (i.e., facial action unit, facial landmarks) as side information for expression recognition.
However, these methods require datasets with labels besides expression, which are even more expensive to collect. Some
FER methods [26, 29] improve performance by removing ambiguous samples from the training set.
To summarize, existing FER methods work on biased
FER datasets with focuses such as model design, side in-formation and difficult samples. However, it is well-known that high quality training data is crucial to the performance of DNN models. Methods [6, 21, 24] enhance FER with small-scale controlled unlabeled data to improve perfor-mance. As large-scale class-balanced FER dataset is ex-pensive to acquire, we propose to use large face recog-nition (FR) datasets without expression labels to improve
FER. For example, Webface260M [42], MS-Celeb-1M [13] and VGGFace2 [3] are all million-level FR datasets, which contain face images with good comprehensive variety (i.e., varied pose, identities, varying illumination, and different expressions).
In contrast, the largest public FER dataset contains only 440K images. However, this inevitably raises another data bias problem because FER data and FR data have mismatched distributions as illustrated in Figure 1(b).
To combat the forgoing data biases, we propose the
Meta-Face2Exp framework, which utilizes unlabeled face data to enhance expression recognition through the meta optimization framework. The meta-learning objective is to minimize the loss function of the model predictions on the challenging facial expressions, conditioned on the bal-anced FER data. Meta-Face2Exp consists of two networks, namely a base network and an adaptation network, which are connected via a circuit feedback paradigm that uses the feedback from an adaptation network to improve a base network for de-biased knowledge extraction. We refer to each full-trained base and adaptation model as a genera-tion. At each generation, the adaptation network is trained on large-scale FR data using pseudo labels generated by the base network in order to distill rich facial expression knowledge (in meta-train phase). The base network learns prior facial expression knowledge on de-biased FER data, which are sampled to ensure class balance. To tackle the mismatch between FR and FER data, our circuit feedback paradigm informs the base network how good the pseudo labels are by using the cognitive difference of the adapta-tion network on biased FR data and de-biased FER data in meta-test phase. If their cognitive difference is large, the base network is punished to use the adverse direction of cur-rent gradients. Thus, the base network is continuously im-proved, more convincing pseudo expression labels are gen-erated for training the adaptation network, and finally the adaptation network learns de-biased expression knowledge.
To sum up, this paper makes the following contributions:
• We explain two data biases, i.e., class imbalance in
FER data and class distribution mismatch between FR and FER data, which inspired Meta-Face2Exp, the first work to utilize large-scale unlabeled FR data to en-hance FER. We think Meta-Face2Exp provides a gen-eral framework to utilize large-scale unlabeled FR data for other face related tasks (e.g., gender/race classifica-tion, age estimation) that lack high quality data.
• We propose the Meta-Face2Exp framework to extract de-biased knowledge from auxiliary FR data through the meta optimization framework. Meta-Face2Exp provides an cost-effective paradigm for facial expres-sion recognition.
• We conduct extensive experiments on widely-used
FER benchmarks including AffectNet [22] and RAF-DB [19] to demonstrates the effectiveness of our Meta-Face2Exp framework. Specifically, Meta-Face2Exp obtains comparable results to state-of-the-art FER methods using the only 10% of labeled FER data. 2.