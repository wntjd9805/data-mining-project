Abstract
This paper presents a novel attention-based neural net-work for structured reconstruction, which takes a 2D raster image as an input and reconstructs a planar graph depicting an underlying geometric structure. The approach detects corners and classifies edge candidates between corners in an end-to-end manner. Our contribution is a holistic edge clas-sification architecture, which 1) initializes the feature of an edge candidate by a trigonometric positional encoding of its end-points; 2) fuses image feature to each edge candidate by deformable attention; 3) employs two weight-sharing Trans-former decoders to learn holistic structural patterns over the graph edge candidates; and 4) is trained with a masked learning strategy. The corner detector is a variant of the edge classification architecture, adapted to operate on pixels as corner candidates. We conduct experiments on two struc-tured reconstruction tasks: outdoor building architecture and indoor floorplan planar graph reconstruction. Exten-sive qualitative and quantitative evaluations demonstrate the superiority of our approach over the state of the art. Code and pre-trained models are available at https://heat-structured-reconstruction.github.io/ 1.

Introduction
Human vision has a remarkable capability in holistic structure reasoning. Looking at the building in Figure 1, we can effortlessly identify the structural primitives (e.g., building corners and edges) and their relationships. A funda-mental challenge in computer vision research is to acquire such human-level perceptual capability and ultimately recon-struct holistic geometric structures from an image, which would have tremendous impacts on broader domains such as visual effects, construction, manufacturing, and robotics.
Ever since the emergence of deep neural networks (DNNs), geometry reconstruction has seen a breakthrough in low-level primitive detection tasks (e.g., corners and edges) by training DNNs on large annotated datasets [24, 25, 29, 31].
However, holistic structure reasoning (e.g., graph inference from corner candidates) is still a challenge for end-to-end neural architectures. The performance is far below that of human-vision [26] and inferior to classical optimization or search methods [4, 17, 22].
This paper seeks to push the frontier of end-to-end neural architecture for structured reconstruction, in particular, we focus on inferring an outdoor building architecture or an indoor floorplan as a 2D planar graph from raster sensor data.
Our approach resembles state-of-the-art Transformer based architectures DETR/LETR for object/edge detection [3, 24].
They extract image information by a ConvNet and pass to the
“dummy query nodes” in a Transformer decoder by cross-attention. Our experiments reveal that they do not effectively learn structural regularities of target objects/edges.
Our idea is similar and simple, yet yields much more powerful holistic structural reasoning. For edge detection, instead of creating “dummy query nodes” as placeholders for regressing answers, we 1) create a node for every edge can-didate and initialize the feature by a trigonometric positional
encoding of its end-points [23]; 2) fuse multi-scale image features from ConvNet backbone to each edge candidate by an adapted deformable attention mechanism [32] and filter out edge candidates; 3) learn structural patterns of edges by two weight-sharing Transformer decoders, one of which only sees the positional encoding (w/o image features) to en-hance geometry learning; and 4) employ a masked learning strategy [6] for end-to-end training and iterative inference.
A simple adaptation of the edge classification architecture is our corner detector, which further improves performance.
We have evaluated the proposed approach on two struc-tured reconstruction benchmarks: outdoor building recon-struction from a satellite image and indoor floorplan recon-struction from a point-cloud density image. The qualitative and quantitative evaluations demonstrate that our approach outperforms all the competing methods for the outdoor re-construction task. For the indoor reconstruction task, our approach outperforms all fully-neural methods and is on par with domain specific solutions [4, 22], which are more than 1000 times slower with the use of optimization and search. 2.