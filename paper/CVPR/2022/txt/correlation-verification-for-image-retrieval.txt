Abstract
Geometric verification is considered a de facto solution for the re-ranking task in image retrieval.
In this study, we propose a novel image retrieval re-ranking network named Correlation Verification Networks (CVNet). Our proposed network, comprising deeply stacked 4D convolu-tional layers, gradually compresses dense feature correla-tion into image similarity while learning diverse geomet-ric matching patterns from various image pairs. To en-able cross-scale matching, it builds feature pyramids and constructs cross-scale feature correlations within a single inference, replacing costly multi-scale inferences.
In ad-dition, we use curriculum learning with the hard negative mining and Hide-and-Seek strategy to handle hard sam-ples without losing generality. Our proposed re-ranking network shows state-of-the-art performance on several re-trieval benchmarks with a significant margin (+12.6% in mAP on ROxford-Hard+1M set) over state-of-the-art meth-ods. The source code and models are available online: https://github.com/sungonce/CVNet. 1.

Introduction
Image retrieval is a long-standing problem in computer vision. This task aims to sort a database of images based on their similarities to the given query image. For this task, global retrieval through global descriptor matching and ge-ometric verification after local feature matching are mainly employed. These approaches typically comprise two pri-mary components of the image retrieval framework that mu-tually complement one another. The global retrieval quickly performs a coarse retrieval across the database, and geo-metric verification re-ranks the coarse results by performing precise evaluation only on the potential candidates. Along with deep learning, image retrieval has also advanced sig-nificantly. In particular, several studies [8, 30, 41, 45, 46, 53] have been focused on extracting representative and distinc-tive features for global and local representations with deep learning. However, geometric verification after local fea-ture matching still plays an essential role in the re-ranking
*Corresponding author.
Figure 1. Novel image retrieval re-ranking method named correla-tion verification that directly predicts image similarity by leverag-ing dense feature correlation in a convolutional manner. task in image retrieval, despite its drawbacks. Owing to its verify-after-matching structure, geometric verification is performed based on only sparse and thresholded feature correspondence. Moreover, it is neither learnable nor dif-ferentiable and requires iterative optimization even during testing. In addition, geometric verification does not include a component that can handle multi-scale operation. Thus, several studies [8, 30, 32, 45] have attempted to solve the scale problem by repeating inference with the image pyra-mid to extract multi-scale local features. However, this is an extremely expensive process.
In this study, we propose an end-to-end learnable re-ranking network called Correlation Verification Networks (CVNet) to replace the role of geometric verification in a better way. The proposed network directly evaluates se-mantic and geometric relations by leveraging dense feature correlations in a convolutional manner. Following the suc-cessful architectural design of representative 2D convolu-tional neural networks (CNN), we design a 4D CNN with a pyramid structure of deeply stacked 4D convolution layers.
It compresses the correlation between semantic cues into image similarity while learning diverse geometric match-ing patterns from a large number of image pairs. To en-sure robustness even for large scale difference problems, it
expands the single-scale feature to a feature pyramid for each image, forming cross-scale correlations between fea-ture pyramids. This structure enables cross-scale matching with a single inference while replacing the multi-scale in-ference conventionally used in image retrieval. Our model does not require additional inference to extract local infor-mation; therefore the feature extraction latency, which sig-nificantly affects online retrieval time, is considerably re-duced compared with other re-ranking methods. Similar to several computer vision problems, image retrieval suf-fers from the problem of hard samples. We address these challenges through curriculum learning using the hard neg-ative mining and Hide-and-Seek [43] strategy in the training phase. This improves the overall performance by focusing on hard samples without losing generality in the case of nor-mal ones. Our proposed re-ranking network shows state-of-the-art performance on several image retrieval benchmarks with a significant margin over several state-of-the-art meth-ods. Our main contributions are as follows:
• We present Correlation Verification Networks (CVNet), which is a powerful re-ranking model that directly pre-dicts the similarity of an image pair based on dense fea-ture correlation.
• To replace expensive multi-scale inference, we construct cross-scale correlations within the model and perform cross-scale matching using a single inference.
• We propose curriculum learning using the hard negative mining and Hide-and-Seek strategy to handle hard sam-ples without losing generality.
• The proposed model achieves new state-of-the-art performance on several image retrieval benchmarks:
ROxford (+1M), RParis (+1M), and GLDv2-retrieval. 2.