Abstract
This paper concerns the problem of multi-object track-ing based on the min-cost ﬂow (MCF) formulation, which is conventionally studied as an instance of linear program.
Given its computationally tractable inference, the success of MCF tracking largely relies on the learned cost func-tion of underlying linear program. Most previous studies focus on learning the cost function by only taking into ac-count two frames during training, therefore the learned cost function is sub-optimal for MCF where a multi-frame data association must be considered during inference. In order to address this problem, in this paper we propose a novel differentiable framework that ties training and inference to-gether during learning by solving a bi-level optimization problem, where the lower-level solves a linear program and the upper-level contains a loss function that incorpo-rates global tracking result. By back-propagating the loss through differentiable layers via gradient descent, the glob-ally parameterized cost function is explicitly learned and regularized. With this approach, we are able to learn a better objective for global MCF tracking. As a result, we achieve competitive performances compared to the current state-of-the-art methods on the popular multi-object track-ing benchmarks such as MOT16, MOT17 and MOT20. 1.

Introduction
While being a classical problem, multi-object tracking (MOT) [37,52] has been yet one of the most active research areas in computer vision, as being a fundamental basic-level perception task for many real-world problems, e.g., in vi-sual surveillance, and autonomous driving [20]. Thanks to the great progress in object detection [18, 42] techniques,
“tracking-by-detection” paradigm has dominated the track-ing community recently. Given an input video, a set of detection hypotheses is ﬁrst generated for each frame and the goal of tracking is to associate these detection responses across time, locally or globally, to form all the trajectories.
Among various previous works, minimum-cost network-ﬂow [4, 41, 60] based methods have gained increasingly at-tention due to its fast inference property. In this work, we speciﬁcally focus on the network-ﬂow based tracking.
The min-cost network ﬂow formulation for multi-object tracking problem is, indeed, an instance of constrained in-teger linear program (ILP) with uni-modular constraint ma-trices [60]. Therefore, the solution to such an ILP problem can be optimally obtained by solving its relaxed version, i.e. a constrained linear program (LP), which has an identical optimal integer solution to its ILP counterpart [2]. Given its computationally tractable inference, the success of a network-ﬂow based multi-object tracking approach largely depends on designing a proper cost function. Many pre-vious works have focused on learning a robust objective function, e.g. the matching cost, between detections in two frames utilizing a neural network trained using a, e.g. binary cross-entropy [53], triplet [11] or contrastive [34] loss. The major drawback of these approaches is that they only con-sider a limited temporal context during training, e.g., two or three frames. As such, the learned objective function can be sub-optimal as it ignores long-term temporal contexts and associations. Several recent works adopt graph neural networks [8, 14, 39] in order to learn a better feature rep-resentation for a spatio-temporal graph formulating multi-object tracking problem. However, their training objectives are still constrained locally, e.g., a binary cross-entropy as a local edge loss is employed during the training stage and thus, knowledge about the global tracking result is not yet properly incorporated.
Recently, there have been few attempts to learn a proper objective function for an LP problem representing a global data association in MOT [19, 50]. Seminal work of [50] adds a log-barrier term into the objective function and adopts a change of basis technique to deal with equality constraints in the linear program, as a result, heuristics are involved in choosing the optimal temperature parameters during the interior method’s optimization process, and the tracking results are inferior compared to many top-ranked methods in tracking benchmarks [20, 37]. The work of [19] performs 3D tracking on video and LiDAR data, followed by a re-projection step to perform 2D tracking, which is computationally demanding. In contrast to their works, we
propose a general framework which adopts Bi-level opti-mization technique embraced with implicit function theo-rem [22] to perform end-to-end learning of a global cost function for LP based tracking. At the lower-level of our optimization, our framework solves a linear program and the upper-level contains a general loss function that regu-larizes the tracking solution. By approximating the original linear program as a continuous quadratic program during the forward pass, it is possible to differentiate through the optimal KKT conditions of the relaxed convex quadratic problem. In this way, the cost for data association can be trained end-to-end by back-propagating the gradient of the loss through differentiable layers. In addition, we integrate a stronger observation model [5] compared to [50], together with the learned optimal cost function for data association.
Our framework achieves competitive results compared to current state-of-the-art approaches on MOT16, MOT17 and
MOT20 benchmarks.
In summary, our main contributions are as follows:
• We adopt the classical min-cost network ﬂow formula-tion to address multi-object tracking problem and pro-pose a novel bi-level optimization technique which is able to learn a global cost for tracking directly from multi-frame data association results.
• In order to address the non-differentiable prob-lem of the constrained linear program, we propose to approximate the original integer linear program as a continuous quadratic program and to back-propagate quadratic program solution’s gradients w.r.t. the model’s parameters.
• The proposed tracking method achieves results compa-rable to current state-of-the-art trackers on the popular
MOT16, MOT17 and MOT20 benchmark, demonstrat-ing its effectiveness. 2.