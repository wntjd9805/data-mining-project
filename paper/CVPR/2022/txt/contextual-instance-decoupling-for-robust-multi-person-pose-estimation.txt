Abstract
Crowded scenes make it challenging to differentiate per-sons and locate their pose keypoints. This paper proposes the Contextual Instance Decoupling (CID), which presents a new pipeline for multi-person pose estimation. Instead of relying on person bounding boxes to spatially differentiate persons, CID decouples persons in an image into multiple instance-aware feature maps. Each of those feature maps is hence adopted to infer keypoints for a specific person. Com-pared with bounding box detection, CID is differentiable and robust to detection errors. Decoupling persons into dif-ferent feature maps allows to isolate distractions from other persons, and explore context cues at scales larger than the bounding box size. Experiments show that CID outperforms previous multi-person pose estimation pipelines on crowded scenes pose estimation benchmarks in both accuracy and ef-ficiency. For instance, it achieves 71.3% AP on CrowdPose, outperforming the recent single-stage DEKR by 5.6%, the bottom-up CenterAttention by 3.7%, and the top-down JC-SPPE by 5.3%. This advantage sustains on the commonly used COCO benchmark†. 1.

Introduction
Multi-Person Pose Estimation (MPPE) detects all per-sons in an image, and locates keypoints for each of them.
As an important step for human activity understanding, human-object interaction, human parsing, etc., MPPE has attracted increasing attention. Current MPPE methods can be summarized into three categories according to their fol-lowed pipelines, i.e. i) top-down methods [7, 21, 26, 33], which detect person bounding boxes and perform pose ii) bottom-up meth-estimation for each bounding box, ods [2,9,11,17, 20,23] that first detect body keypoints, then group them into corresponding persons, and iii) single-stage regression methods, which regress pose keypoints coordi-nates [6, 19, 28, 30, 35] based on person features. Fig. 1 (a), (b), and (c) illustrate those three pipelines, respectively.
Figure 1. Illustration of different MPPE pipelines for differenti-ating persons. (a) Top-down methods use bounding box to crop person; (b) Bottom-up methods first detect all keypoints then group them into different persons; (c) Single-stage methods di-rectly regress keypoint coordinates based on sampled feature vec-tor. (d) The proposed Contextual Instance Decoupling (CID) first generates instance-aware feature maps, then infers heatmaps from each person. It has potential to enjoy better robustness to detection errors in (a), keypoint localization errors in (b), and alleviate the difficulty of long distance regression in (c).
The above pipelines show different properties and de-fects for MPPE in crowded scenes. Regression paradigm enjoys better efficiency, but suffers from the difficulty of long distance regression. Top-down and bottom-up pipelines rely on heatmaps to locate keypoints, e.g., a like-lihood heatmap can be generated for each keypoint, where the keypoint is located with argmax or soft-argmax [27] op-erations. Heatmap based methods need extra computations to differentiate persons. As shown in Fig. 1 (a) and (b), top-down methods adopt bounding box cropping to differentiate persons, while bottom-up methods utilize keypoint group-ing. Bounding box cropping, e.g., RoIAlign [7] is sensitive to detection errors, and cannot explore contexts outside the box. Keypoint grouping is complex and not capable of re-cover keypoint location errors because it discards contextual cues. Sec. 2 presents a more detailed review.
†Code is available at https://github.com/kennethwdk/CID
This work aims at studying a new MPPE pipeline to ef-fectively separate instances while preserving rich context cues to estimate keypoint locations. As shown in Fig. 1 (d), given an image with multiple persons, we first decou-ple each person into a specific instance-aware feature map.
Each instance-aware feature map contains all the necessary cues required for single-person keypoint localization. It is hence used to infer keypoints for a specific person. Com-pared with top-down and bottom-up piplelines, this new pipeline is robust to spatial detection errors, and is able to explore contextual cues at larger scale. Compared with the regression baseline, it encodes more spatial cues in feature maps, and alleviates the difficulty of long-range location re-gression.
This pipeline is implemented in our Contextual Instance
Decoupling (CID) module. Given an image with multiple persons, CID first extracts the location and feature for each person via Instance Information Abstraction (IIA) module, which are hence used to decouple different persons in the
Global Feature Decoupling (GFD) module. GFD computes spatial and channel attention with location and feature cues of each person to isolate the corresponding person. To im-prove the discriminative power of those instance features, we introduce a contrastive loss to ensure different persons present different features. The generated instance-aware feature maps are used to estimate the final heatmap for key-point estimation.
We test CID on different multi-person pose estimation benchmarks, i.e., COCO Keypoint [14], CrowdPose [13] and OCHuman [34]. Experiment results show that, our CID achieves superior performance compared with recent works following different pipelines. For instance, CID achieves 71.3% AP on CrowdPose with high efficiency, outperform-ing the recent single-stage DEKR [6] by 5.6%, the bottom-up CenterAttention [1] by 3.7%, and the top-down JC-SPPE [13] by 5.3%. It also shows competitive performance on the commonly used COCO benchmark, e.g., achieves 68.9% AP, outperforming the DEKR [6] by 1.6%.
To the best of our knowledge, this is an original effort on contextual instance decoupling pipeline for MPPE. Com-pared with previous MPPE pipelines, CID shows better ro-bustness to detection errors, and alleviates the complexity of keypoint grouping and long distance regression. Being able to encode more contextual and spatial cues at larger scales, it is also capable of isolating distractions from other per-sons. Those advantages make CID a more effective pipline for MPPE. 2.