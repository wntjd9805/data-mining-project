Abstract
Baseline DeepSDF [32]
We introduce a novel approach for generative 3D mod-eling that explicitly encourages the physical and thus func-tional consistency of the generated shapes. To this end, we advocate the use of online physical simulation as part of learning a generative model. Unlike previous related meth-ods, our approach is trained end-to-end with a fully differ-entiable physical simulator in the training loop. We accom-plish this by leveraging recent advances in differentiable programming, and introducing a fully differentiable point-based physical simulation layer, which accurately evaluates the shape’s stability when subjected to gravity. We then incorporate this layer in a signed distance function (SDF) shape decoder. By augmenting a conventional SDF decoder with our simulation layer, we demonstrate through exten-sive experiments that online physical simulation improves the accuracy, visual plausibility and physical validity of the resulting shapes, while requiring no additional data or an-notation effort. 1.

Introduction
Over the past several years, there has been a steady stream of works aimed at developing deep neural networks for 3D shape generation. A key challenge is to accommo-date plausible and diverse content while preserving geomet-ric and structural validity [1, 27, 42]. Though remarkable progress has been made in this direction, state-of-the-art ap-proaches focus primarily on geometric or visual plausibility, while discarding a key purpose of 3D design: functional-ity [23]. Indeed, a designed 3D shape is often meant to serve a particular function in the real world. For instance, a chair is expected to be stable when subjected to gravity. Ignoring this crucial constraint leads the generated content to suffer from severe functional artifacts such as lack of connectiv-ity and physical instability [30], which severely hinders its utility in real-world downstream tasks.
One way to address this challenge is by leveraging phys-Ofﬂine simulation
Online simulation (ours)
Figure 1. Qualitative comparison of online simulation with the
SotA ofﬂine simulation [30] for the task of shape optimization.
From top to bottom: physically invalid shapes sampled from base-line DeepSDF [32], results using [30] and our results. The opti-mized shapes reﬂect the accuracy and efﬁciency of online simu-lation compared to the ofﬂine setting in terms of physical quality and geometric consistency. ical simulation to guide generative models to produce func-tionally valid shapes. Indeed, physical simulation is a com-mon mechanism for verifying whether a candidate 3D shape fulﬁlls certain functionality [4, 22, 41]. Although physi-cal simulation is a powerful tool that is applicable with-out additional data annotation, incorporating it into genera-tive modeling can be challenging, since it is typically non-differentiable and can be both complex and costly to be used at training time. Thus, existing approaches that attempt to combine generative networks with physical simulation are typically limited to ofﬂine simulation, which requires to ei-ther iteratively ﬁlter and update the training data [36] or to train a surrogate model that imitates the simulator while be-ing suitable for learning [30]. While these works sidestep the aforementioned challenges, they achieve this by sacriﬁc-ing the major beneﬁts of end-to-end training. In particular, using ofﬂine simulation and surrogate models can hurt the generalization power of the trained networks and introduce data biases, implicitly promoting the seen valid geometric
patterns instead of tackling generic physical failures.
At the same time, recent advances in building differen-tiable physical simulators [11,24,25] have opened the possi-bility of learning neural networks with online physical sim-ulation. So far, these approaches have not been leveraged in 3D generative networks, in part due to the difﬁculty of in-tegrating physical simulation, while ensuring efﬁciency and geometric accuracy in a single coherent framework.
In this paper, we make a ﬁrst step towards this goal.
Speciﬁcally, we show how to endow a deep generative network based on the DeepSDF decoder [32] with online simulation-based physical supervision. We focus on the generative modeling of man-made shapes that should nat-urally be stable when subjected to gravity, and we set phys-ical stability as our target functional constraint.
To achieve this, we ﬁrst design a simulation layer (SimL) based on a differentiable rigid body simulator that we implement using the recent efﬁcient DiffTaichi frame-work [24]. The simulator computes rigid body dynamics of 3D shapes subjected to gravity in the presence of the ground plane. This allows to both accurately evaluate the physical behavior of the shapes in the forward stage, and to back-propagate simulation gradients for physical supervi-sion during the backward stage. Then, we integrate SimL into the implicit shape decoder DeepSDF [32] and show how SDF-based generative modeling can be combined with physical simulation in a single coherent end-to-end train-able manner to create plausible and physically valid shapes.
Combining these contributions, we introduce a new model Phys-DeepSDF, which is the ﬁrst end-to-end deep generative model endowed with online physical simulation.
We illustrate the utility of our model on a range of challeng-ing cases and demonstrate that it has signiﬁcantly higher generalization power compared to methods trained with of-ﬂine simulation, enabling several applications such as accu-rate shape generation and optimization.
Contributions. Our main contributions are three-fold: (1) We build a point based simulation layer SimL based on a differentiable rigid-body simulator that can be incor-porated into a 3D shape decoder. (2) We show how our layer can be incorporated in a SDF-based generative model with a novel stability loss and accurate gradient back-propagation. (3) We demonstrate the efﬁciency of 3D modeling with online physical simulation, by improving the general-ization power and quality of the produced content. 2.