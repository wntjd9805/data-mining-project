Abstract
Person re-identification is a hot topic in computer vision, and the loss function plays a vital role in improving the dis-crimination of the learned features. However, most exist-ing models utilize the hand-crafted loss functions, which are usually sub-optimal and challenging to be designed.
In this paper, we propose a novel method, AutoLoss-GMS, to search the better loss function in the space of gener-alized margin-based softmax loss function for person re-identification automatically. Specifically, the generalized margin-based softmax loss function is first decomposed into two computational graphs and a constant. Then a gen-eral searching framework built upon the evolutionary al-gorithm is proposed to search for the loss function effi-ciently. The computational graph is constructed with a for-ward method, which can construct much richer loss function forms than the backward method used in existing works.
In addition to the basic in-graph mutation operations, the cross-graph mutation operation is designed to further im-prove the offspring’s diversity. The loss-rejection proto-col, equivalence-check strategy and the predictor-based promising-loss chooser are developed to improve the search efficiency. Finally, experimental results demonstrate that the searched loss functions can achieve state-of-the-art per-formance and be transferable across different models and datasets in person re-identification. 1.

Introduction
Person re-identification (ReID) [1–3] aims at retriev-ing an interested person across multiple, non-overlapping cameras. With the advancement of deep neural networks
*Corresponding author. (DNNs) and the increasing demand for intelligent video surveillance, ReID attracts more and more attention from the computer vision community. Although DNN-based models have made a significant breakthrough in ReID, learning discriminative features to identify the person from the large-scale gallery set is still challenging due to signif-icant intra-class variance caused by pose variations, occlu-sions, or cluttered backgrounds.
Recently, most works [2, 4–7] have been based on the network design to obtain the discriminative features and ig-nore the importance of the loss function. As we all know, a high-performance DNN model is inseparable from the well-designed network architecture and the appropriate loss function. However, most existing works still adopt the paradigm of cross-entropy loss and triplet loss, and there are very few works exploring other forms of loss function on the ReID problem. Inspired by NormFace [8] in face recog-nition (FR), Fan et al. [3] proposed SphereReID to learn a hypersphere manifold embedding, which is better at extract-ing the discriminative features than the cross-entropy loss function. But according to recent researches in FR, Norm-Face is not the best choice among the margin-based softmax (MS) loss functions [9–11]. Sun et al. [12] proposed a more flexible loss function named CircleLoss, which is superior to the other MS loss functions in FR and ReID tasks. The loss functions mentioned above are all special cases in the generalized margin-based softmax (GMS) loss function and just the tip of the iceberg. Likely, they are not optimal in this space. Therefore, we aim to explore whether there is a better loss function than these classical loss functions in the
GMS loss function space.
With the development of AutoML, more and more auto-mated methods are proposed. Especially in the fields of data augmentation [13–16] and networks architecture [17–19], automated methods have surpassed hand-crafted methods.
In the field of the loss function, the AutoML-based meth-ods have also emerged recently. Existing works mainly use two methods to search the loss function: 1) The first method does not directly search for the specific form of the loss function [20, 21], but, like PBT [22], only cares about the final trained neural network. Therefore, once the dataset or network changes, the expensive search procedure will be implemented again. 2) The second method can search for the loss function composed of some predefined primi-tive operations [23,24] or the metric-surrogate loss with pa-rameterized function [25]. What’s more, the searched loss in the second method can be directly transferred to other similar tasks without searching again. However, the sec-ond searching method often requires a lot of search cost like other AutoML methods, so it is critical to improve the search efficiency. Although many methods [23, 24] have been proposed to speed up the search, the improvement of search efficiency is still limited.
In this paper, a novel method named AutoLoss-GMS is proposed to automatically search the loss functions in the GMS loss function space for person re-identification based on the second searching method. Specifically, we first represent the GMS loss function with two computational graphs and a constant. Then a general searching frame-work built upon the evolutionary algorithm is proposed to efficiently search for the loss function. The computational graph is constructed with a forward method, which can construct much richer loss function forms than the back-ward method used in [23, 24]. In addition to the basic in-graph mutation operations, the cross-graph mutation opera-tion is designed to further improve the offspring’s diversity.
The loss-rejection protocol, equivalence-check strategy and the predictor-based promising-loss chooser are developed to improve the search efficiency. To the best of our knowl-edge, AutoLoss-GMS is the first work to use predictor in loss function search (LFS). We summarize the contributions of this work as follows:
• AutoLoss-GMS is the first work to search the GMS loss function for person re-identification.
• A general searching framework with the performance predictor is proposed to efficiently search the GMS loss function.
• The searched loss functions are transferable across dif-ferent models and datasets with competitive perfor-mance and can achieve state-of-the-art performance in person re-identification. 2.