Abstract
In this paper, an ill-posed problem of multiple adverse weather removal is investigated. Our goal is to train a model with a ’unified’ architecture and only one set of pre-trained weights that can tackle multiple types of adverse weathers such as haze, snow, and rain simultaneously. To this end, a two-stage knowledge learning mechanism in-cluding knowledge collation (KC) and knowledge examina-tion (KE) based on a multi-teacher and student architecture is proposed. At the KC, the student network aims to learn the comprehensive bad weather removal problem from mul-tiple well-trained teacher networks where each of them is specialized in a specific bad weather removal problem. To accomplish this process, a novel collaborative knowledge transfer is proposed. At the KE, the student model is trained without the teacher networks and examined by challenging pixel loss derived by the ground truth. Moreover, to improve the performance of our training framework, a novel loss function called multi-contrastive knowledge regularization (MCR) loss is proposed. Experiments on several datasets show that our student model can achieve promising results on different bad weather removal tasks simultaneously. The code is available in our project page. 1.

Introduction
Adverse weather such as haze, rain, snow, and adherent raindrop is a common phenomenon in our daily life. It may usually degrade the visibility of images and deteriorate the performance of high-level vision applications (e.g., object detection and semantic segmentation). To tackle this prob-lem, several adverse weather restoration algorithms such as deraining [1–10], desnowing [11–13], dehazing [14–20], and all in one bad weather removal [21] have been widely
*Indicates equal contribution.
Figure 1. Overview of the existing bad weather removal al-gorithms. Our proposed method can achieve promising perfor-mance in comprehensive bad weather removal problems without additional cost at the inference stage. explored in past decades. Although these methods achieve a promising performance, there still exists a limitation for de-ploying adverse weather removal in real-world applications such as surveillance systems, autonomous vehicle systems, or edge devices due to the high extension cost. Specifically, existing approaches cannot address several weather types in a unified architecture or a set of pre-trained weights simul-taneously. In real-world scenarios, it is unavoidable to han-dle various weather types. As shown in Fig. 1, the existing methods may have several limitations and we summarize them as follows. (i) Single Weather Removal Algorithms: For most sin-gle weather removal algorithms [15, 22, 23], although they can achieve promising results in the specific weather, they
may have limited performance on other types of weather because the features of them are not considered. Thus, in real-world applications, the systems need to determine the weather type first and then select a corresponding adverse weather restoration approach. (ii) Multi-degradation Removal Algorithms: Some re-cent studies aim to tackle multiple degradation prob-lems [18,24–26] via a single framework. Nevertheless, they generally require several sets of pre-trained weights for var-ious degradations. It requires the network to adopt differ-ent pre-trained weights according to weather types, which is troublesome and inefficient. (iii) All-in-one Bad Weather Removal methods: In re-cent years, the all-in-one bad weather removal model [21] has attracted considerable attention because it can handle several types of weather in a set of pre-trained weights by using the neural architecture search (NAS) technique. Al-though this method can achieve encouraging performance on various types of bad weather, it has the model ineffi-ciency problem. Specifically, the model size of this method may increase dramatically if the model needs to solve more types of weather since more feature extractors are required.
For a real-world outdoor system, the restoration model should be able to be extended to other weather types with-out additional cost while can achieve decent reconstruc-tion performance. To achieve this goal, inspired by knowl-edge distillation [27], we proposed a novel method for the adverse weather removal based on a two-stage knowledge learning process including knowledge collation (KC) and knowledge examination (KE). For the former stage, sev-eral well-trained teacher models guide the ’immature’ stu-dent model to integrate and learn the knowledge of vari-ous weather types by the proposed collaborative knowledge transfer (CKT) technique. The CKT consists of progres-sive feature projector and bi-directional feature matching to tackle the knowledge transfer for multiple adverse weather removal networks. These two mechanisms can constrain and improve the feature learning process in the common feature space. For the latter stage, the goal is to improve the robustness of the ’mature’ student network for compre-hensive weather removal by examining it with challenging constraints. Moreover, to enhance the robustness, multi-contrastive regularization (MCR) is developed to optimize the student network by improving its discriminative ability for different weather types.
The contributions of this paper are summarized as:
• A novel method for the comprehensive bad weather re-moval based on two-stage knowledge learning is pro-posed. During the test stage, the network can tackle different weather removal problems with a unified ar-chitecture and one set of pre-trained parameters.
• To boost the performance of the proposed training scheme, the CKT and MCR are designed.
• Extensive experiments are conducted to verify that the proposed training scheme can achieve promising re-sults on several adverse weather types simultaneously. 2.