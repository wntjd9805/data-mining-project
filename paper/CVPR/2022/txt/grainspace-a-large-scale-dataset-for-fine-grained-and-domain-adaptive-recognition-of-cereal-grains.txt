Abstract
Cereal grains are a vital part of human diets and are important commodities for people’s livelihood and interna-tional trade. Grain Appearance Inspection (GAI) serves as one of the crucial steps for the determination of grain qual-ity and grain stratiﬁcation for proper circulation, storage and food processing, etc. GAI is routinely performed manu-ally by qualiﬁed inspectors with the aid of some hand tools.
Automated GAI has the beneﬁt of greatly assisting inspec-tors with their jobs but has been limited due to the lack of datasets and clear deﬁnitions of the tasks.
In this paper we formulate GAI as three ubiquitous com-puter vision tasks: ﬁne-grained recognition, domain adap-tation and out-of-distribution recognition. We present a large-scale and publicly available cereal grains dataset called GrainSpace. Speciﬁcally, we construct three types of device prototypes for data acquisition, and a total of 5.25 million images determined by professional inspectors.
The grain samples including wheat, maize and rice are collected from ﬁve countries and more than 30 regions.
We also develop a comprehensive benchmark based on semi-supervised learning and self-supervised learning tech-niques. To the best of our knowledge, GrainSpace is the
ﬁrst publicly released dataset for cereal grain inspection, https://github.com/hellodfan/GrainSpace. 1.

Introduction
Cereal grains are the foundation of human civilization and are inextricably linked to our daily life. According to the data from the Food and Agriculture Organization of the
United Nations in 2020 [1], the three types of cereal grains: wheat, maize and rice (see Figure 1), represent nearly 90% of the worldwide produce of cereal grains.
Grain determination is a crucial part in quality inspection
∗Equal contribution.
†Work done when interning at Gaozhe technology.
Figure 1. Examples of wheat, maize and rice grain kernels. and grade stratiﬁcation, which provides guides and mea-sures for grain circulation, storage, process and interna-tional trade. The majority of work for grain determination consists of chemical analysis and Grain Appearance Inspec-tion (GAI). Chemical analysis is usually conducted by using various apparatus, but GAI still requires manual inspection with the aid of some hand tools ranging from sieves, di-viders, to balances. In GAI, a batch of test samples are su-perﬁcially inspected by professional inspectors in a kernel-by-kernel way. GAI can determine multiple metrics, such as impurities, damaged grains and cultivated varieties [21].
Taking GAI of wheat grains as an example, 60 grams (about 1600 grain kernels) are inspected and then divided into pre-deﬁned groups manually, which requires 25 to 30 minutes for an inspector with 3 to 5 years’ experience.
It is thus highly desirable to develop an automated GAI.
Over the past few years, deep learning techniques have achieved remarkable success in many computer vision ap-plications, such as recognition (ImageNet [37]), detec-tion (MS-COCO [26]), segmentation (Cityscapes [9]) and video understanding (YouTube-8M [2]). There are how-ever two main challenges to apply deep learning models to GAI. First, in-depth domain knowledge of GAI is re-quired in order to formulate the grain determination prob-lem into proper computer vision tasks. Second, develop-ing deep learning-based methods for GAI requires high-quality datasets covering a comprehensive representation of
the large variety of cereal grains.
In our work, we perform in-depth analysis of the char-acteristics of cereal grain and consider the real-world re-quirements of GAI. We formulate GAI into three fundamen-tal computer vision tasks: ﬁne-grained recognition, domain adaptation and out-of-distribution recognition. We built three kinds of device prototypes that can capture images of cereal grains efﬁciently. Then, we construct a large-scale dataset containing 5.25 million images concerning three types of cereal grains (wheat, maize and rice) collected from
ﬁve countries and more than 30 regions. The raw grain samples were processed manually by nine inspectors over more than 4 years. Furthermore, we develop a benchmark on our proposed dataset by employing advanced techniques like semi-supervised learning and self-supervised learning to address the challenges in ﬁne-grained recognition, do-main adaptation and out-of-distribution recognition. Our experimental results show that the developed approaches can obtain substantial improvements and make automated
GAI feasible. Our contributions are summarized as follows:
• A large-scale and publicly available cereal grain dataset called GrainSpace, containing 5.25 million im-ages of wheat, maize and rice grains, is constructed.
• Based on our in-depth analysis of GAI, we formu-late GAI-related work into three computer vision tasks, including ﬁne-grained recognition, domain adaptation and out-of-distribution recognition.
• An initial benchmark is developed to address the above tasks and we demonstrate promising performance on the GrainSpace. 2.