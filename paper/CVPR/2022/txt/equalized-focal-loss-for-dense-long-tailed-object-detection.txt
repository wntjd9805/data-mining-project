Abstract
Despite the recent success of long-tailed object detec-tion, almost all long-tailed object detectors are developed based on the two-stage paradigm.
In practice, one-stage detectors are more prevalent in the industry because they have a simple and fast pipeline that is easy to deploy. How-ever, in the long-tailed scenario, this line of work has not been explored so far. In this paper, we investigate whether one-stage detectors can perform well in this case. We dis-cover the primary obstacle that prevents one-stage detec-tors from achieving excellent performance is: categories suffer from different degrees of positive-negative imbalance problems under the long-tailed data distribution. The con-ventional focal loss balances the training process with the same modulating factor for all categories, thus failing to handle the long-tailed problem. To address this issue, we propose the Equalized Focal Loss (EFL) that rebalances the loss contribution of positive and negative samples of different categories independently according to their imbal-ance degrees. Specifically, EFL adopts a category-relevant modulating factor which can be adjusted dynamically by the training status of different categories. Extensive exper-iments conducted on the challenging LVIS v1 benchmark demonstrate the effectiveness of our proposed method. With an end-to-end training pipeline, EFL achieves 29.2% in terms of overall AP and obtains significant performance improvements on rare categories, surpassing all existing state-of-the-art methods. The code is available at https:
//github.com/ModelTC/EOD. 1.

Introduction
Long-tailed object detection is a challenging task receiv-ing increasing attention today. In the long-tailed scenario, data usually comes with a Zipfian distribution (e.g. LVIS
∗Equal Contribution.
†Corresponding Author.
Figure 1. Visualization of the training pipeline in one-stage detec-tors and two-stage detectors. Different shapes indicate different categories, and their corresponding colors indicate the labels of the classifier at different stages.
[11]) in which a few head classes contain plenty of instances
In contrast, a signifi-and dominate the training process. cant number of tail classes are instance-scarce thus perform poorly. Common solutions to long-tailed object detection are data resampling [6, 11, 35, 45, 47], decoupled training
[17, 25, 45], and loss reweighting [39, 40, 44]. Despite those successes in alleviating the problem, almost all those detec-tors are developed based on two-stage approaches popular-ized by R-CNN [12, 36]. In practice, one-stage detectors are more appropriate for a realistic scenario than two-stage ones because they are computationally efficient and easy to deploy. However, there is no relevant work in this area.
In contrast to two-stage methods that incorporate a re-gion proposal network (RPN [36]) to filter out most back-ground samples before feeding proposals to the final classi-fier, one-stage detectors directly detect objects over a regu-lar, dense set of candidate locations. As shown in Fig. 1, the extreme foreground-background imbalance is introduced in one-stage detectors due to the dense schema. Combined with the foreground categories (i.e. foreground samples of categories) imbalance in the long-tailed scenario, it severely degrades the performance of one-stage detectors.
Focal loss [27] is a conventional solution to the foreground-background imbalance problem. It focuses on the learning of hard foreground samples and reduces the im-pact of easy background samples with a specialized modu-lating factor. This loss redistribution technique works well under the category-balanced distribution but is inadequate to handle the imbalance problem among foreground cat-egories in the long-tailed situation. To solve this issue, we start from the existing solutions (e.g. EQLv2 [39]) in the two-stage pipeline and adapt them to work with fo-cal loss together in one-stage detectors. Unfortunately, we find that these solutions only bring marginal improvements compared with their applications to two-stage detectors (see
Tab. 1). Then we argue that simply combining existing solu-tions with focal loss can not address the two types of imbal-ance problems simultaneously. By comparing the ratio of positive samples to negative samples in different data dis-tributions (see Fig. 2), we further realize that the essence of these imbalance problems is that the positive-negative im-balance degrees are inconsistent among categories. Rare categories suffer from more severe positive-negative imbal-ance than frequent ones, thus requiring more emphasis.
In this paper, we propose Equalized Focal Loss (EFL) by introducing a category-relevant modulating factor into focal loss. The modulating factor with two decoupled dy-namic factors (i.e. the focusing factor and the weighting fac-tor) deals with the positive-negative imbalance of different categories independently. The focusing factor determines the concentration of learning on hard positive samples ac-cording to the imbalance degree of its corresponding cate-gory. The weighting factor increases the impact of rare cat-egories, ensuring that the loss contribution of rare samples will not be overwhelmed by frequent ones. The synergy of these two factors enables EFL to overcome the foreground-background imbalance and the foreground categories im-balance uniformly in one-stage long-tailed detectors.
We conduct extensive experiments on the challenging
LVIS v1 [11] benchmark. With a simple and effective one-stage training pipeline, EFL achieves 29.2% AP, surpassing all existing long-tailed object detection methods. Exper-imental results on OpenImages [20] also demonstrate the generalization ability of our method.
To sum up, our key contributions can be summarized as follows: (1) We are the first to study one-stage long-tailed object detection. We hope it will inspire the community to rethink the power and the value of one-stage detectors in the long-tailed scenario. (2) We propose a novel Equalized
Focal Loss (EFL) that extends the original focal loss with a category-relevant modulating factor. It is a generalized form of focal loss that can address the foreground-background imbalance and foreground categories imbalance simultane-ously. (3) We conduct extensive experiments on LVIS v1 benchmark, and the results demonstrate the effectiveness of our approach. It establishes a new state-of-the-art and can be well applied to any one-stage detector. 2.