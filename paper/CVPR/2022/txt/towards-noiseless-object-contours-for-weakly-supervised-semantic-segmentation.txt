Abstract
Image-level label based weakly supervised semantic seg-mentation has attracted much attention since image la-bels are very easy to obtain. Existing methods usually generate pseudo labels from class activation map (CAM) and then train a segmentation model. CAM usually high-lights partial objects and produce incomplete pseudo la-bels. Some methods explore object contour by training a contour model with CAM seed label supervision and then propagate CAM score from discriminative regions to non-discriminative regions with contour guidance. The prop-agation process suffers from the noisy intra-object con-tours, and inadequate propagation results produce incom-plete pseudo labels. This is because the coarse CAM seed label lacks sufficient precise semantic information to sup-press contour noise. In this paper, we train a SANCE model which utilizes an auxiliary segmentation module to sup-plement high-level semantic information for contour train-ing by backbone feature sharing and online label super-vision. The auxiliary segmentation module also provides more accurate localization map than CAM for pseudo la-bel generation. We evaluate our approach on Pascal VOC 2012 and MS COCO 2014 benchmarks and achieve state-of-the-art performance, demonstrating the effectiveness of our method. The source code can be found at https:
//github.com/BraveGroup/SANCE 1.

Introduction
Semantic segmentation has made great progress in re-cent years thanks to the rapid development of deep neu-ral networks [7, 8, 31, 34, 50]. However, per-pixel anno-∗ Corresponding author
Figure 1. Pseudo label generation of IRNet and ours. (a) IR-Net’s contour map contains many intra-object edges and misses some true contours, CAM score can not propagate from discrim-inative region to non-discriminative region. (b) Our SANCE pre-dicts noiseless contour and more complete segmentation map, thus generates better pseudo labels. tation for training semantic segmentation network requires huge economic investment and is a time-consuming task.
To reduce the heavy burden of precise pixel-level anno-tation, weakly supervised semantic segmentation (WSSS) is adopted, which uses weak annotations to supervise se-mantic segmentation network, including but not limited to bounding boxes [9, 22, 35, 40], scribbles [30, 43], point-level [3] and image-level labels [2, 23, 36, 37, 38, 49, 53].
Among all the annotations, image-level label is the most widely used as it is much easier to obtain than other for-mats, it is available in almost all the datasets. In this paper, we focus on studying image-level label based WSSS prob-lem.
Image class label doesn’t provide localization, scale or shape information of ground truth objects. Existing ap-proaches usually adopt CAM [55] to estimate localization maps for target objects, the localization maps are then pro-cessed to generate pseudo labels for standard segmentation model training. To be specific, these works first train a
classification model with image class labels and then ob-tain CAM by apply the last linear classification layer to each feature vector of the feature map before the global average pooling layer. However, CAM usually highlights only a portion of an object and gives sparse and incomplete object estimates, because the classifier only needs to ”see” the most discriminative regions to optimize the classifica-tion loss function.
To alleviate the incomplete estimation problem of CAM, some approaches try to expand object estimates during the classification model training process through accumulating activation maps [21], iterative erasing strategy [18], region growing algorithms [19], auxiliary classification task [4], splitting vs. merging strategy [54], etc. Localization maps of these methods cover more complete object regions, but may not give sharp estimates of object shape because the expanding process is controlled implicitly by empirical con-straints. Some approaches [1, 6] control the expanding process explicitly with object contour information and thus give sharp object estimates. These methods first train a con-tour detection network with CAM seeds, then refine CAM by propagating foreground scores from highlighted regions to the missing object parts according to inter-pixel seman-tic affinity [2] generated from object contour prediction, we call this process as score propagation, finally a standard seg-mentation network is trained with pseudo labels generated from propagation results. The refined CAM gives sharp ob-ject estimates but may still produce inaccurate pseudo la-bels. As shown in (a) of Fig. 1, the noisy edges at neck re-gion hinder the object score from head region to body region and the pseudo label only covers the head area. This is be-cause the contour supervision signal, CAM seed label, lacks enough high-level semantic information. The CAM is a coarse localization map and we can only get sparse seed la-bels containing many unsure pixel labels, meanwhile, CAM usually highlights background areas around foreground ob-jects and thus leads to false positive object areas in CAM seed labels.
To make the contour model explore object contours with less noisy intra-object edges, besides CAM seed label su-pervision, we also adopt an auxiliary segmentation mod-ule to provide sufficient high-level semantic information for contour model training. Firstly, the segmentation branch shares semantic knowledge to the contour branch though the shared backbone feature. Secondly, we refine the seg-mentation map to generate online label to offer sufficient high-level semantic supervision to the contour branch. To make the segmentation branch predict accurate results, we adopt the CAM seed label and online label as training sig-nal. On the whole, our model contains a contour branch and a segmentation branch, we call it segmentation-assisted noiseless contour exploration model (SANCE), these two branches share the same backbone and are supervised with
CAM seed label and online label. The online label is gener-ated by refining segmentation map through score propaga-tion under contour constraints. For the contour map with intra-object edges, segmentation map covers more object parts than CAM map, thus an object’s neighboring regions devided by noisy edges get high foreground scores in re-fined segmentation maps, which gives complete object es-timates in online label and suppress the noisy intra-object edges. On the other hand, the online label gives more ac-curate object shapes thanks to the contour information, so it forces the segmentation branch to predict complete and pre-cise object localization maps. After training, our SANCE model predicts noiseless object contour and high quality segmentation map, as show in (b) of Fig. 1, we generate more complete pseudo labels based on them. The main con-tributions of the paper are summarized as follows:
• We identify the intra-object edge problem in recent contour assisted CAM refining methods for WSSS problem. The intra-object edge may hinder the object score propagation and results in incomplete pseudo la-bels.
• We introduce SANCE framework to explore noiseless object contours by leveraging high-level semantic in-formation of auxiliary segmentation branch.
• On Pascal VOC 2012 benchmark, we train DeepLab-v2 with generated pseudo labels and achieve the new state-of-the-art performance with 72.0% and 72.9% mIoU on val and test sets, respectively. On MS COCO 2014, we also achieve the new state-of-the-art perfor-mance with 44.7% mIoU on val set. 2.