Abstract
Scene graph generation (SGG) aims to detect objects and predict their pairwise relationships within an image.
Current SGG methods typically utilize graph neural net-works (GNNs) to acquire context information between ob-jects/relationships. Despite their effectiveness, however, current SGG methods only assume scene graph homophily while ignoring heterophily. Accordingly, in this paper, we propose a novel Heterophily Learning Network (HL-Net) to comprehensively explore the homophily and heterophily be-tween objects/relationships in scene graphs. More specif-ically, HL-Net comprises the following 1) an adaptive reweighting transformer module, which adaptively inte-grates the information from different layers to exploit both the heterophily and homophily in objects; 2) a relation-ship feature propagation module that efﬁciently explores the connections between relationships by considering het-erophily in order to reﬁne the relationship representation; 3) a heterophily-aware message-passing scheme to fur-ther distinguish the heterophily and homophily between ob-jects/relationships, thereby facilitating improved message passing in graphs. We conducted extensive experiments on two public datasets: Visual Genome (VG) and Open Images (OI). The experimental results demonstrate the superiority of our proposed HL-Net over existing state-of-the-art ap-proaches. In more detail, HL-Net outperforms the second-best competitors by 2.1% on the VG dataset for scene graph classiﬁcation and 1.2% on the IO dataset for the ﬁnal score.
Code is available at https://github.com/siml3/HL-Net. 1.

Introduction
Scene graph generation (SGG) has recently attracted in-creasing attention from the research community. As illus-trated in Figure 1, a visual scene could be depicted in the
*Work done during ﬁrst author’s internship at JD Explore Academy
†Corresponding author. 2 1 9 8 7 3 5 fridge (cid:3) wrench (cid:4) cabinet (cid:8)
SGG (cid:5) behind beside woman has hold under fix (cid:2) (cid:6) boy has sink near 4 6 (cid:1) hand (cid:7) hand (cid:9) window
Figure 1. An image and its ground-truth scene graph. Objects and their pairwise relationships are represented as nodes and edges, respectively. Best viewed in color. form of a graph structure, where objects and their pairwise relationships are represented by the nodes and edges, re-spectively. A triplet constructed by two objects and their corresponding relationship then takes the form Subject-Predicate-Object. Intuitively, the key to SGG methods is to model and explore the connections between objects, as well as those between relationships. Due to their remark-able ability to model the connections between graph com-ponents, graph neural networks (GNNs) have been widely adopted in SGG tasks [2, 12, 14, 30, 31].
Despite their effectiveness, existing GNN-based SGG methods only assume homophily [17] between ob-jects/relationships; in other words, these methods calcu-late the correlations between objects/relationships by im-plicitly treating all objects/relationships as belonging to the same categories. However, as Figure 1 demonstrates, scene graphs fall naturally into the category of heterophilic graphs. We, therefore, argue that heterophily, i.e., the in-teraction between objects/relationships from different cate-gories, should be modeled directly. In this paper, we focus on the heterophily in class labels, following the deﬁnition provided in [29, 41].
Exploring heterophily in the SGG is non-trivial. There are at least two problems that must be considered. First, het-erophily in both objects and relationships should be taken into account; however, no prior SGG works have explic-itly considered heterophily, and no heterophilic GNNs have
exploited heterophily in visual relationships. Second, two objects/relationships characterized by signiﬁcant occlusion usually have similar visual appearances, despite being from different classes, which increases the difﬁculty of distin-guishing heterophily from homophily.
In the light of the above scene graph analysis, in this paper, we propose a
Heterophily Learning Network (HL-Net) for SGG to com-prehensively and efﬁciently explore the heterophily in ob-jects/relationships. To the best of our knowledge, HL-Net is the ﬁrst work to consider heterophily for the SGG. The main contributions of HL-Net are summarized below.
We ﬁrst propose an Adaptive Reweighting Trans-former (ART), which reﬁnes object representation with het-erophily considered.
In more detail, we arrange the pre-layer normalization [28], residual connection, and feedfor-ward network to deepen the layers and enhance the object feature with contextual information. Furthermore, the re-ﬁned object representations of different ART layers are ag-gregated with learnable weights. These weights depend on the contributions of different ART layers and can be both positive and negative. This aggregation procedure is similar to general polynomial graph ﬁltering [20], which is natu-rally able to deal with both the high-frequency context (i.e., heterophily) and low-frequency context (i.e., homophily) between objects [3].
We then develop a Relationship Feature Propagation (RFP) module that explores the connections between het-erophilic relationships. Two challenges emerge in the de-sign of RFP: the effectiveness of feature propagation and heterophily modeling. To reduce computational complex-ity, we only require each relationship to contact neighboring relationships that share the subject or object. Moreover, the contextual coefﬁcients obtained from ART are adopted to represent the correlations between relationships. To propa-gate heterophilic features between relationships, we extend the PageRank-based GNN [8] to a high-pass graph ﬁlter.
This approach enables the RFP module to learn the rela-tionship correlation of disparate classes by passing relevant high-frequency graph signals (i.e., heterophily).
Finally, we devise a Heterophily-aware Message Pass-ing (HMP) scheme to identify the heterophily and ho-mophily between objects or relationships in complicated vi-sual scenes (e.g., overlapping objects that belong to differ-ent classes). More speciﬁcally, HMP utilizes the spatial and visual information of object/relationships to produce signed messages, which can subsequently be applied to adjust the contextual coefﬁcients and guide the learning processes in both ART and RFP.
We conduct extensive experiments on two public datasets: Visual Genome (VG) [9] and Open Images (OI)
[10]. Experimental results demonstrate that the proposed
HL-Net consistently achieves top-level performance. Abla-tion studies further verify both the necessity and effective-ness of considering heterophily for SGG. 2.