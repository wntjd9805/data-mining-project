Abstract
Deep Implicit Functions (DIFs) represent 3D geometry with continuous signed distance functions learned through deep neural nets. Recently DIFs-based methods have been proposed to handle shape reconstruction and dense point correspondences simultaneously, capturing semantic relationships across shapes of the same class by learn-ing a DIFs-modeled shape template. These methods pro-vide great ﬂexibility and accuracy in reconstructing 3D shapes and inferring correspondences. However, the point correspondences built from these methods do not intrin-sically preserve the topology of the shapes, unlike mesh-based template matching methods. This limits their ap-plications on 3D geometries where underlying topologi-cal structures exist and matter, such as anatomical struc-In this paper, we propose a tures in medical images. new model called Neural Diffeomorphic Flow (NDF) to learn deep implicit shape templates, representing shapes as conditional diffeomorphic deformations of templates, in-trinsically preserving shape topologies. The diffeomor-phic deformation is realized by an auto-decoder consist-ing of Neural Ordinary Differential Equation (NODE) blocks that progressively map shapes to implicit tem-plates. We conduct extensive experiments on several medical image organ segmentation datasets to evaluate the effectiveness of NDF on reconstructing and aligning shapes. NDF achieves consistently state-of-the-art organ shape reconstruction and registration results in both ac-curacy and quality. The source code is publicly available at https : / / github . com / Siwensun / Neural _
Diffeomorphic_Flow--NDF. 1.

Introduction 3D geometry representation is fundamental to many downstream tasks in computer vision such as 3D model understanding, reconstruction, and matching.
In particu-lar, shape representation is of vital importance to many
Figure 1. Our model deforms back and forth between shape in-stances and learned templates through neural diffeomorphic ﬂow, in a invertible and progressive manner. Colors on the shape surface show the correspondences and edges show the topologies. medical image applications such as organ segmentation
[10, 44, 45, 51, 53, 56, 57], medical image reconstruction
[52, 54, 55], shape abnormality detection and surgical navi-gation [31, 43].
Recently deep implicit functions (DIFs) have emerged as an effective and efﬁcient tool for modeling 3D objects
[12, 36, 40, 42, 50]. Compared to traditional representa-tions such as voxel grids, point clouds, and polygon meshes,
DIF-based 3D representations have the advantages of being compact while at the same time enjoying strong represen-tation power, making it more suitable for modeling com-plex shapes with ﬁne geometric details. However, DIFs do come with a strong drawback - it is difﬁcult to establish correspondences between two shapes, unlike the traditional method such as meshes. This drawback limits the applica-tion of DIFs for shape analysis, especially in many medical image applications, where being able to map and compare 1
shapes is often a necessity.
A number of methods have been proposed to address the limitation of DIFs. The DIT (Deep Implicit Templates)
[59] and DIF-Net (Deformed Implicit Field), build upon
DeepSDF [40], formulates DIFs as conditional deforma-tions of a template deep implicit function, and uses a spa-tial warping module to explicitly model the conditional de-formations and infer point-wise transformations. [32] learns dense 3D shape correspondence from semantic part embed-ding by introducing an inverse implicit function to BAE-Net [11].
However, a common drawback of the above methods is that the conditional deformation modeled by these meth-ods (e.g., LSTM in DIT) is agnostic of the topology of the shapes. This will be problematic in situations where two shapes share the same topology and we want the topology to be preserved after deformation. Applications falling into this category include modelling 3D shapes of human body, anatomical structures in medical images, and other objects with ﬁxed topologies. What’s more, considering the small number of anatomical shapes available for training, it is challenging to generalize the learned deformations to un-seen data if no shape prior is utilized.
In this work, we propose a new formulation of DIFs called Neural Diffeomorphic Flow (NDF) for representing 3D shapes. Similar to DIT and DIF-Net, NDF models shapes as conditional deformations of a template DIF. But different from DIT, the conditional deformation is intrin-sically diffeomorphic, thereby ensuring that the resulting deformation is topology preserving. NDF is also different from AtlasNet [23], which can preserve topology but re-quires predeﬁned ﬁxed topology as its shapes are modeled by meshes.
Our main contributions are summarized as follows:
• We introduce invertible NDF to match a shape to its implicit template. It can align point clouds or meshes without sacriﬁcing accuracy while guaranteeing topol-ogy preservation.
• We design a quasi time-varying velocity ﬁeld to learn diffeomorphic ﬂows based on neural ODEs, allowing us to model shape deformation in a progressive and time-invertible manner.
• We tested NDF on multiple organ datasets and demon-strated that it leads to state-of-the-art shape reconstruc-tion and registration results on both existing and new shapes. On shape registration, NDF generates one or several order of magnitude fewer unpleasant faces . 2.