Abstract
Image copy detection is an important task for content moderation. We introduce SSCD, a model that builds on a recent self-supervised contrastive training objective. We adapt this method to the copy detection task by changing the architecture and training objective, including a pooling op-erator from the instance matching literature, and adapting contrastive learning to augmentations that combine images.
Our approach relies on an entropy regularization term, promoting consistent separation between descriptor vec-tors, and we demonstrate that this signiﬁcantly improves copy detection accuracy. Our method produces a compact descriptor vector, suitable for real-world web scale appli-cations. Statistical information from a background image distribution can be incorporated into the descriptor.
On the recent DISC2021 benchmark, SSCD is shown to outperform both baseline copy detection models and self-supervised architectures designed for image classiﬁcation by huge margins, in all settings. For example, SSCD out-performs SimCLR descriptors by 48% absolute.
Code is available at https : / / github . com / facebookresearch/sscd-copy-detection. 1.

Introduction
All online photo sharing platforms use content moder-ation to block or limit the propagation of images that are considered harmuful: terrorist propaganda, misinformation, harassment, pornography, etc. Some content moderation can be performed automatically, for unambiguous data like pornographic pictures, but this is much harder for complex data like memes [31] or misinformation [2]. In these cases, content is moderated manually. For of viral images, where copies of same image may be uploaded thousands of times, manual moderation of each copy is tedious and unneces-sary. Instead, each image for which a manual moderation decision is taken can be recorded in a database, so that it can be re-identiﬁed later and handled automatically.
This paper is concerned with this basic task of re-identifcation. This is non trivial because copied images are
It
Figure 1. The SSCD architecture for image copy detection. is based on SimCLR, with the following additions: the entropy regulatization, cutmix/mixup-aware InfoNCE, and inference-time score normalization. often altered, for technical reasons (e.g. a user shares a mo-bile phone screenshot that captures additional content), or users may make adversarial edits to evade moderation.
Image re-identiﬁcation is an image matching problem, with two additional challenges. The ﬁrst is the enormous scale at which copy detection systems are deployed. At this scale, the only feasible approach is to represent im-ages as short descriptor vectors, that can be searched ef-ﬁciently with approximate nearest neighbor search meth-ods [23, 30]. Copy detection systems typically proceed in 2 stages: a retrieval stage that produces a shortlist of candi-date matches and a veriﬁcation stage, often based on local descriptor matching that operates on the candidates. In this work, we are concerned with the ﬁrst stage. Figure 1 shows the overall architecture of our Self Supervised Copy Detec-tion (SSCD) approach.
The second challenge is that there is a hard match/non-match decision to take, and positive image pairs are rare.
We wish to limit veriﬁcation candidates using a threshold, which is a harder constraint than the typical image retrieval setting, where only the order of results matter.
SSCD uses differential entropy regularization [42] to
promote a uniform embedding distribution, which has three effects: (1) it makes distances from different embedding re-gions more comparable; (2) it avoids the embedding col-lapse described in [29], making full use of the embedding space; (3) it also improves ranking metrics that do not re-quire consistent thresholds across queries.
Score normalization is important for ranking systems.
An advanced score normalization relies on matching the query images with a set of background images. In this work, we show how this normalization can be incorporated in the image descriptor itself. We anticipate that this work will set a strong single-model baseline for image copy detection.
We plan to release code and models for our method.
Section 2 discusses works related to this paper. Sec-tion 3 motivates the use of an entropy loss term in a sim-pliﬁed setting. Section 4 carefully describes SSCD. Sec-tion 5 presents results and ablations of our method. Sec-tion 6 points out a few observations about the copy detec-tion task. 2.