Abstract
Occluded person re-identification (ReID) aims at match-ing occluded person images to holistic ones across dif-ferent camera views. Target Pedestrians (TP) are often disturbed by Non-Pedestrian Occlusions (NPO) and Non-Target Pedestrians (NTP). Previous methods mainly focus on increasing the model’s robustness against NPO while ig-noring feature contamination from NTP. In this paper, we propose a novel Feature Erasing and Diffusion Network (FED) to simultaneously handle challenges from NPO and
NTP. Specifically, aided by the NPO augmentation strategy that simulates NPO on holistic pedestrian images and gen-erates precise occlusion masks, NPO features are explic-itly eliminated by our proposed Occlusion Erasing Mod-ule (OEM). Subsequently, we diffuse the pedestrian repre-sentations with other memorized features to synthesize the
NTP characteristics in the feature space through the novel
Feature Diffusion Module (FDM). With the guidance of the occlusion scores from OEM, the feature diffusion process is conducted on visible body parts, thereby improving the quality of the synthesized NTP characteristics. We can greatly improve the model’s perception ability towards TP and alleviate the influence of NPO and NTP by jointly op-timizing OEM and FDM. Furthermore, the proposed FDM works as an auxiliary module for training and will not be engaged in the inference phase, thus with high flexibility.
Experiments on occluded and holistic person ReID bench-marks demonstrate the superiority of FED over state-of-the-art methods. 1.

Introduction
Person Re-Identification (ReID) aims at retrieving the same pedestrians captured by different cameras with differ-*Zhikang Wang did this work as an intern in SenseTime Research.
†Corresponding author.
‡This research was supported partially by the National Natural Science
Foundation of China (Grant Nos. 61876146).
Illustration of pose estimation and human parsing on
Figure 1. pedestrian images. Both models perform well on holistic and object occluded pedestrians but fail on multi-pedestrian images.
Meanwhile, human parsing models have difficulty in identifying personal belongings, e.g., backpacks, and umbrellas. ent viewpoints, lighting conditions, and locations. With the rapid development of deep learning area and publication of large-scale image and video ReID datasets, ReID methods based on deep neural networks have achieved remarkable performance [14, 19, 27, 29]. Most of these approaches as-sume that a holistic body of each pedestrian is available for feature extraction. However, in real-world scenarios, e.g., railway stations, schools, hospitals, and shopping malls, pedestrians are inevitably disturbed by non-pedestrian oc-clusions (NPO) and non-target pedestrians (NTP). There-fore, designing a powerful network for the occluded person
ReID is essential.
Methods assisted by human key points [5, 21] and hu-man parsing information [15] dominate the state-of-the-art performance of the occluded ReID task. Generally, an aux-iliary model extracts the body information first, and then the extracted information will assist the training of models.
The strategy can greatly avoid mistakenly treating NPO as human parts. However, such methods have many caveats.
Firstly, due to the domain gap between the training and test-ing data, the performance of the auxiliary models can not be consistent. In Fig.1, we adopt official pose estimation
model [22] and retrained human parsing model [37] to ex-tract body information. It is clear that both models perform well on holistic and object occluded pedestrian images but fail on multi-pedestrian ones, which means that noise from
NTP will contaminate the final representations. Compared with object occlusion, the characteristics of NTP will result in a higher mismatching probability because of the semantic guidance. Secondly, the human parsing model can not rec-ognize some person belonging, e.g., backpacks, umbrellas, which may lead to the deficiency of valuable information.
At last, the enormous computation brought by the auxiliary models makes it unacceptable for real-time video surveil-lance.
To tackle the challenges above, we propose the feature erasing and diffusion network (FED) to simulate NPO on images and NTP in the feature space for increasing the model’s perception ability towards TP. Specifically, we aim at the NPO feature erasing by proposing the NPO aug-mentation strategy along with an occlusion erasing module (OEM). The augmentation strategy will generate object oc-cluded data of pedestrians by pasting cropped patches with a specific strategy. At the same time, by analyzing the pixel-level value differences, we can get precise part labels, in-dicating whether object occlusion or not. We refer to the part labels as occlusion masks. Sequentially, the occlusion masks will guide the OEM to analyze the semantic informa-tion and generate the final occlusion scores for part features.
For alleviating the distractions from NTP, a straightforward way is pasting other pedestrians onto the image for data augmentation. However, pedestrian images with diversi-fied background information can destroy the globality of the original images by simple pasting. Besides, the resize oper-ation needs designing carefully for maintaining aspect ratio.
Therefore, image-level augmentation for NTP is challeng-ing and complex. Here, we propose a learnable structure named feature diffusion module (FDM), which will simu-late multi-pedestrian images by diffusing characteristics of
NTP to the original features. With the guidance of occlu-sion scores from OEM, the feature diffusion operation will be conducted only on body parts, guaranteeing the simu-lated features are more realistic. By optimizing the model through diffused features, we can indirectly improve the model’s perception ability towards TP and robustness to-wards NTP.
In summary, we propose the feature erasing and diffu-sion network (FED) to tackle the distractions from NPO and NTP for occluded person ReID. FED consists of three innovative components: NPO augmentation strategy, oc-clusion erasing module (OEM), and feature diffusion mod-ule (FDM). These components enable the network to pre-cisely perceive the TP regardless of the NPO and NTP.
At the same time, extensive experiments on both occluded datasets (Occluded-DukeMTMC [21], Partial-REID [33], and Occluded-REID [43]) and holistic datasets (Market-1501 [38] and DukeMTMC-reID [40]) demonstrate the ef-fectiveness of our proposed method. Especially on the
Occluded-DukeMTMC and Occluded-REID dataset, our
Rank-1 and mAP accuracy surpass other state-of-the-art methods by a large margin. 2.