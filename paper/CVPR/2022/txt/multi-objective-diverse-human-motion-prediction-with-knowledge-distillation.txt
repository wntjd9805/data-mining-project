Abstract
Obtaining accurate and diverse human motion predic-tion is essential to many industrial applications, especially robotics and autonomous driving. Recent research has ex-plored several techniques to enhance diversity and maintain the accuracy of human motion prediction at the same time.
However, most of them need to deﬁne a combined loss, such as the weighted sum of accuracy loss and diversity loss, and then decide their weights as hyperparameters before training. In this work, we aim to design a prediction frame-work that can balance the accuracy sampling and diversity sampling during the testing phase. In order to achieve this target, we propose a multi-objective conditional variational inference prediction model. We also propose a short-term oracle to encourage the prediction framework to explore more diverse future motions. We evaluate the performance of our proposed approach on two standard human motion datasets. The experiment results show that our approach is effective and on a par with state-of-the-art performance in terms of accuracy and diversity. 1.

Introduction
Human motion prediction plays a signiﬁcant role in sev-eral applications such as human-robot interaction [3, 4], au-tonomous driving [13, 14, 33, 39], and animation [45]. For instance, an autonomous driving system can make a safe planning strategy given an accurate motion prediction of pedestrians. Moreover, robots can cooperate reasonably with people when they have a good understanding of human beings’ future plans. However, since diversity and uncer-tainty are human future motion’s intrinsic properties, it be-comes a challenging problem in the computer science com-munity. Unlike the vehicle trajectory prediction scenarios where we can get prior knowledge such as the trafﬁc rules and routing information [40, 41] to constrain the different
†Work done during Hengbo and Ramtin’s internship at Honda Research
Institute.
Figure 1. Illustration of obtaining multi-modal pseudo future mo-tions in a dataset. We can cluster the similar initial poses (purple dashed circle) and share their future poses as the common ground truth. The solid poses are the ground truth and the transparent ones are the augmented poses. We argue that such an approach can be applied recursively (orange dashed circle), which will lead to dis-covering more different and realistic modes of motion in the data. modes of trajectories, we can hardly get any prior knowl-edge about what humans will do in the future. Thus, we can only leverage the information from the given dataset, which increases the difﬁculty of diverse human motion prediction.
There are two lines of research in this area. First, sev-eral works attempt to get an accurate human motion predic-tion without considering the diversity, such as [36] based on graph neural network and [56] based on recurrent neu-ral network. On the other line, some research investigates how to increase the diversity of human motion prediction based on deep generative models [2, 47, 60, 63] or diverse sampling techniques [61]. Deep generative models such as variational autoencoder and generative adversarial network naturally capture the stochastic behaviors, while they may suffer from mode collapse problems. Otherwise, even if we assume that the generative models can capture the actual
data distribution, the data distribution can still be very im-balanced and skewed, which makes that sampling the minor modes is challenging within a limited number of samples.
Several works [42, 61, 62] propose new losses to increase diversity while keeping the prediction natural and accurate.
In [62], a multiple sampling function is designed to explic-itly capture the different modes of the distribution based on a pre-trained conditional variational autoencoder. By using this pre-trained variational autoencoder, such methods can control the likelihood of predicted motion with a training hyperparameter.
In [5, 32, 42], they proposed generative models to learn the distribution implicitly. However, these works still have to choose hyperparameters before training to balance the likelihood and diversity sampling. It implies that such approaches cannot be adjusted and controlled dur-ing the testing phase. Considering the real-world applica-tion such as pedestrian motion prediction in autonomous driving, we not only need to know most of the different pos-sible modes of motion but also need to know which modes will most likely happen. It will be more practical if we can decide the balance of accuracy sampling and diversity sam-pling during the testing phase for the purpose of designing the risk-averse or risk-seeking planner of autonomous vehi-cles. Hence, we introduce a multi-objective variational in-ference framework with two different priors. The proposed structure makes it possible to adjust the ratio between accu-racy and diversity sampling during the testing time.
Meanwhile, since there is only one ground-truth future motion poses given a historical observation, several works
[49, 59] propose to use a similarity cluster-based technique to get the multi-modal pseudo-ground-truth future motions.
Similar initial poses are grouped, and their corresponding future poses can be viewed as the pseudo possible future motions for each initial pose in the group. We argue that such logic can also be applied recursively. We can group similar poses again at certain steps and get the shared fu-tures. A demonstration is shown in Figure 1. This strat-egy can boost the diversity of future motions. However, the sampling number will exponentially increase due to the re-cursive queries during training and make such direct imple-mentation intractable. In order to solve this issue, we intro-duce an oracle that provides several possible future motions with a short-term horizon to instruct the predictor repeat-edly. To summarize, our contributions are three folds:
• We propose a uniﬁed multi-objective conditional varia-tional autoencoder based human motion prediction frame-work, which can adjust the ratio of sample numbers of ac-curacy and diversity sampling during testing.
• We propose to learn a short-term oracle system and dis-till the oracle’s knowledge into the prediction framework to increase the diversity of human future motions. In order to achieve this goal, we propose a novel sample-based loss to supervise the predictor during the training phase.
• We evaluate the performance of our proposed approach on two human motion datasets. The experiments results show that our methods can achieve state-of-the-art performance. 2.