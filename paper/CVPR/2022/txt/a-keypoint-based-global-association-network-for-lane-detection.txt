Abstract
Lane detection is a challenging task that requires pre-dicting complex topology shapes of lane lines and distin-guishing different types of lanes simultaneously. Earlier works follow a top-down roadmap to regress predefined an-chors into various shapes of lane lines, which lacks enough flexibility to fit complex shapes of lanes due to the fixed an-chor shapes. Lately, some works propose to formulate lane detection as a keypoint estimation problem to describe the shapes of lane lines more flexibly and gradually group ad-jacent keypoints belonging to the same lane line in a point-by-point manner, which is inefficient and time-consuming during postprocessing. In this paper, we propose a Global
Association Network (GANet) to formulate the lane detec-tion problem from a new perspective, where each keypoint is directly regressed to the starting point of the lane line in-stead of point-by-point extension. Concretely, the associa-tion of keypoints to their belonged lane line is conducted by predicting their offsets to the corresponding starting points of lanes globally without dependence on each other, which could be done in parallel to greatly improve efficiency. In addition, we further propose a Lane-aware Feature Ag-gregator (LFA), which adaptively captures the local cor-relations between adjacent keypoints to supplement local information to the global association. Extensive experi-ments on two popular lane detection benchmarks show that our method outperforms previous methods with F1 score of 79.63% on CULane and 97.71% on Tusimple dataset with high FPS. 1.

Introduction
Autonomous driving [10] has drawn remarkable atten-tion of researchers from both academia and industry.
In order to ensure the safety of the car during driving, the au-*Equal contribution
†Corresponding author (tzzhang@ustc.edu.cn) (a) (c) (b) (d)
Figure 1. (a) Anchor-based methods, which regress the prede-fined anchors into the shape of lanes. (b) Keypoint-based meth-ods, which predict offsets between keypoint to its neighbourhood to group them one-by-one. (c) Illustration of our GANet, which directly regresses each keypoint to its belonged lane by predicting offset between each keypoint and the starting point of its corre-sponding lane line. (d) Illustration of our LFA module, which cor-relates each keypoint with its adjacent points for local information supplement. tonomous system needs to keep the car moving along the lane lines on the road, requiring accurate perception of the lane lines. Thus, lane detection plays an important role in the autonomous driving system, especially in Advanced
Driver Assistance System (ADAS).
Given a front-viewed image taken by a camera mounted on the vehicle, lane detection aims to produce the accu-rate shape of each lane line on the road. Due to the slen-der shapes of lane lines and the need for instance-level dis-crimination, it is crucial to formulate lane detection task ap-propriately. Inspired by the anchor-based object detection methods [22], some works [10, 25] follow a top-down de-sign as illustrated in Figure 1a. Similar to object detection, a group of straight lines with various orientations are defined as anchors. Points on anchors are regressed to lane lines by predicting the offsets between anchor points and lane
points. Afterward, Non-Maximum Suppression (NMS) is applied to select lane lines with the highest confidence. Al-though this kind of method is efficient in lane discrimina-tion, it is inflexible because of the predefined anchor shapes.
The strong shape prior limits the ability of describing var-ious lane shapes, resulting in sub-optimal performances of these methods.
To describe complex shapes of lane lines flexibly, Qu et al. [21] propose to formulate lane detection as a keypoint es-timation and association problem, which takes a bottom-up design as illustrated in Figure 1b. Concretely, lanes are rep-resented with a group of ordered key points evenly sampled in a sparse manner. Each key point is associated with its neighbours by estimating the spatial offsets between them.
In this way, key points belonging to the same lane are inte-grated into a continuous curve iteratively. Though keypoint-based methods are flexible on the shape of lane lines, it is inefficient and time-consuming to associate only one key-point to its belonged lane line at each step. Besides, the point-by-point extension of keypoints is easy to cause error accumulation due to the lack of global view. Once a partic-ular keypoint is wrongly associated, estimation of the rest part of the lane line will fail.
To overcome the above limitations, we formulate the lane detection problem from a new keypoint-based perspec-tive where each keypoint is directly regressed to its be-longed lane, based on which a novel pipeline named Global
Association Network (GANet) is proposed. As illustrated in Figure 1c, each lane line is represented uniquely with its starting point, which is easy to determine without ambigu-ity. To associate a keypoint properly, we estimate the offset from the keypoint to its corresponding starting point. Key-points whose approximated starting points fall into the same neighborhood area will be assigned to the same lane line instance, thus separating keypoints into different groups.
Different from previous keypoint-based method [21], our assignment of keypoints to their belonged lanes is inde-pendent of each other and makes the parallel implementa-tion feasible, which greatly improves the efficiency of post-processing. Besides, the keypoint association is more robust to the accumulated single-point errors since each keypoint owns a global view.
Although keypoints belonging to the same lane line are integrated during post-processing, it is important to ensure the correlations between adjacent points in order to obtain a continuous curve. To this end, we develop a local in-formation aggregation module named Lane-aware Feature
Aggregator (LFA) to enhance the correlations between ad-jacent keypoints. To adapt to the slender and long shapes of lanes, we modify the sampling positions of the standard 2D deformable convolution [3] by predicting offsets to ad-jacent points to sample within a local area on the lane each time. In this way, features of each keypoint are aggregated with other adjacent points, thus acquiring more represen-tative features. We further add an auxiliary loss to facili-tate estimating the offset predicted on each key point. Our
LFA module complements the global association process to enable both local and global views, which is essential for dense labeling tasks like lane detection.
Our contributions are summarized as follows:
• We propose a novel Global Association Network (GANet) to formulate lane detection from a new keypoint-based perspective which directly regress each keypoint to its belonged lane. To the best of our knowl-edge, we are the first to regress keypoints in a global manner, which is more efficient than local regression.
• We develop a local information aggregation module named as Lane-aware Feature Aggregator (LFA) to en-hance correlations among adjacent keypoints to sup-plement local information.
• Our proposed GANet achieves state-of-the-art per-formances on two popular benchmarks of lane de-tection with faster speed, which shows a superior performance-efficiency trade-off and great potential of our global association formulation. 2.