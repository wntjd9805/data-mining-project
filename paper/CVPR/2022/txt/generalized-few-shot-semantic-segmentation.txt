Abstract
Training semantic segmentation models requires a large amount of finely annotated data, making it hard to quickly adapt to novel classes not satisfying this condition. Few-Shot Segmentation (FS-Seg) tackles this problem with many constraints. In this paper, we introduce a new benchmark, called Generalized Few-Shot Semantic Segmentation (GFS-Seg), to analyze the generalization ability of simultane-ously segmenting the novel categories with very few ex-amples and the base categories with sufficient examples.
It is the first study showing that previous representative state-of-the-art FS-Seg methods fall short in GFS-Seg and the performance discrepancy mainly comes from the con-strained setting of FS-Seg. To make GFS-Seg tractable, we set up a GFS-Seg baseline that achieves decent per-formance without structural change on the original model.
Then, since context is essential for semantic segmentation, we propose the Context-Aware Prototype Learning (CAPL) that significantly improves performance by 1) leveraging the co-occurrence prior knowledge from support samples, and 2) dynamically enriching contextual information to the classifier, conditioned on the content of each query image.
Both two contributions are experimentally manifested for their substantial practical merit. Extensive experiments on Pascal-VOC and COCO also show that CAPL general-izes well to FS-Seg by achieving competitive performance.
Code is available at https://github.com/dvlab-research/GFS-Seg. 1.

Introduction
Development of deep learning has yielded significant performance gain to semantic segmentation tasks. Repre-sentative semantic segmentation methods [5, 64] benefit a wide range of applications for robotics, automatic driving, medical imaging, etc. However, once these frameworks are trained, without sufficient fully-labeled data, they are un-able to deal with unseen classes in new applications. Even if the required data of novel classes are ready, fine-tuning costs additional time and resources.
In order to quickly adapt to novel classes with only lim-Figure 1. Pipeline illustrations of GFS-Seg and FS-Seg. (a) GFS-Seg has an additional novel class registration phase that registers the novel information to the new classifier, therefore, in the last evaluation phase, GFS-Seg methods are able to make predictions on all possible base and novel classes as testing normal segmen-tation models without forwarding additional support samples that provide the prior knowledge of target classes. Contrarily, (b) FS-Seg models in the evaluation phase require support images/labels to provide the information of target classes exactly contained in each query image. ited labeled data, few-shot segmentation (denoted as FS-Seg) [31] models are trained on well-labeled base classes and are tested on previously unseen novel classes. Dur-ing training, FS-Seg divides data into the support and query sets. Samples of support set aim to provide FS-Seg models with target categorical information to identify target regions in query samples, with the purpose to mimic the situation where only a few labeled data of novel classes are available.
After training, both support and query samples are sent to
FS-Seg models to yield query predictions on previously un-seen classes based on the support information.
Limitations of FS-Seg. However, FS-Seg requires sup-port samples to contain classes that exist in query samples.
It may be overly strong in many situations to have this prior knowledge because providing support samples in the same classes requires cumbersome manual selection. Besides,
FS-Seg only evaluates the novel classes, while test samples in normal semantic segmentation may also contain the base classes. Experiments show that exemplar FS-Seg models cannot well tackle the practical situation of evaluation on both base and novel classes due to these constraints.
New benchmark and our solution. With these facts, we set up a new task, named Generalized Few-Shot Semantic
Segmentation (GFS-Seg). As shown in Figure 1, a typical
GFS-Seg method has three phases: 1) Base class learning phase, 2) novel class registration phase with few support samples containing novel classes, and 3) evaluation phase on both base and novel classes. The difference between
GFS-Seg and FS-Seg is that, during evaluation, GFS-Seg does not require forwarding support samples that contain the same target classes in the test (query) samples to make predictions, because GFS-Seg should have obtained the in-formation of base and novel classes during the base class learning phase and novel class registration phase respec-tively. GFS-Seg performs well on novel classes without sac-rificing the accuracy of base classes when making predic-tions on them simultaneously without knowing what classes are contained in the query images in advance, achieving the essential step towards practical use of semantic segmenta-tion in more challenging situations.
Inspired by [12, 26], we design a baseline for GFS-Seg with decent performance. Considering that the contextual relation is essential for semantic segmentation, we propose the Context-Aware Prototype Learning (CAPL) that pro-vides significant performance gain to the baseline by updat-ing the weights of base prototypes with adapted features.
CAPL not only exploits essential co-occurrence informa-tion from support samples, but also adapts the model to various contexts of query images. The baseline method and the proposed CAPL can be applied to normal seman-tic segmentation models, e.g., FCN [32], PSPNet [64] and
DeepLab [5]. Also, CAPL demonstrates its effectiveness in the setting of FS-Seg by improving the baseline by a large margin, reaching state-of-the-art performance. Our overall contributions are as follows.
• We extend the classic Few-Shot Segmentation (FS-Seg) and propose a more practical setting – General-ized Few-Shot Semantic Segmentation (GFS-Seg).
• Based on our experimental results, we analyze existing performance gap between FS-Seg and GFS-Seg, and situations that recent popular FS-Seg models cannot well handle.
• We propose the Context-Aware Prototype Learning (CAPL) that yields significant performance gains to the baseline models in both settings of GFS-Seg and
It is applied to various normal semantic
FS-Seg. segmentation models without specific structural con-straints. 2.