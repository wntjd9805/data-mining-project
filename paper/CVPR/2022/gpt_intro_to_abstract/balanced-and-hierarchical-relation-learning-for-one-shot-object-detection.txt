In this paper, we address the challenge of few-shot object detection, where limited annotated data is available for detecting novel-class objects. We propose a novel Instance-level Hierarchical Relation (IHR) module that infers multi-level semantic relations between query and target images. The IHR module decomposes feature matching into three hierarchical levels to capture global differences, local salient regions, and local discriminative parts. We integrate these relation features to enhance the discriminative and localization ability of the detector. Furthermore, we introduce a Ratio-Preserving Loss (RPL) to reweight samples in the training process and achieve a balanced learning of the IHR module. This approach allows for the identification of rare positive-pair relations, leading to more accurate detection of novel classes with complex semantic similarities and differences. Our experimental results on the PASCAL VOC and MS COCO datasets demonstrate that our proposed detector outperforms state-of-the-art methods, achieving improvements of 1.6% and 1.3% respectively. This confirms the effectiveness of our approach in addressing the challenges of few-shot object detection.