Deep neural network models have achieved remarkable success in various computer vision tasks. However, recent studies have shown that these models are highly vulnerable to adversarial examples, which are crafted to fool the target models with imperceptible perturbations. This has prompted researchers to focus on developing attack and defense strategies to enhance the robustness of these models.Adversarial attacks can be categorized into white-box and black-box attacks, depending on whether attackers have access to the target model's parameters and structure. In practical scenarios, attackers may not have detailed knowledge of the target model, including its structure and training data. This paper aims to address the challenge of data-free black-box attacks, where the attacker has no access to any information about the target model except for its output probabilities or labels.Existing methods for data-free black-box attacks often suffer from two limitations. First, a static substitute model structure is used for different target models, which limits the attack effectiveness. Second, these methods assume knowledge of the number of categories in the target model, which is unrealistic for a total data-free black-box attack.To overcome these limitations, this paper proposes a novel approach called Dynamic Substitute Training (DST) for data-free black-box attacks. DST generates training data using a generator with noise and employs knowledge distillation to ensure that the substitute model mimics the target model's outputs. To address the static substitute model structure problem, a learnable dynamic gate is introduced to determine which blocks in the deep architecture can be skipped. To tackle the issue of not knowing the number of training data classes, a graph-based structural information learning strategy is implemented to improve the generator's performance.The main contributions of this work include the proposal of a dynamic substitute training attack method that adapts to different target models, the introduction of a dynamic substitute structure learning strategy, and the utilization of a graph-based structural information learning strategy to enhance the quality of generated training data. Experimental results demonstrate that DST achieves state-of-the-art attack performance and reduces query times during substitute training.