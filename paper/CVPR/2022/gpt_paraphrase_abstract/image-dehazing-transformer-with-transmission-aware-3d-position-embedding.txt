Despite advances in single image dehazing using Convolutional Neural Networks (CNNs), the limitations of convolution in terms of equivariance and locality still hinder dehazing performance. Applying Transformer directly to image dehazing poses challenges, as it often leads to ambiguous and coarse details that are undesirable for image reconstruction. Additionally, previous position embedding methods for Transformer neglect the variational haze densities, resulting in sub-optimal dehazing performance.   This study aims to combine CNN and Transformer for image dehazing. To address the feature inconsistency between the two, the proposed approach modulates CNN features using learned modulation matrices conditioned on Transformer features. This modulation approach combines the global context modeling capability of Transformer with the local representation capability of CNN.   To incorporate haze density information, a novel transmission-aware 3D position embedding module is introduced into Transformer. This module not only provides relative position information but also suggests the haze density of different spatial regions.   Extensive experiments demonstrate that the proposed method, named DeHamer, achieves state-of-the-art performance on various image dehazing benchmarks.