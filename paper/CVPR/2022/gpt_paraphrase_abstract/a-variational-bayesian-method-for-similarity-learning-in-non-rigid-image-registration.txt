We propose a new approach to non-rigid registration of medical images using variational Bayesian formulation. This method learns a specific similarity metric in an unsupervised manner, making it adaptable to various image registration models. We tested our framework on brain MRI scans from the UK Biobank and found that using the learned similarity metric, which is represented as a neural network, resulted in more accurate results compared to traditional functions like SSD and LCC that we initially used to initialize the model. Importantly, this improvement in accuracy did not compromise the speed or smoothness of the image registration process. Additionally, our method is able to estimate the uncertainty associated with the transformation. For those interested, the code and trained models can be accessed in a public repository at https://github.com/dgrzech/learnsim.