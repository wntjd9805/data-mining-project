This paper presents a novel approach to recovering the shape of a scene with unknown, non-Lambertian, and potentially spatially-varying surface materials. The task becomes particularly challenging when the object's shape is complex and shadows are present on the surface. To address these challenges, the authors propose a coordinate-based deep multilayer perceptron (MLP) network that can parameterize both the unknown 3D shape and the unknown reflectance at each surface point. This network takes advantage of the observed photometric variance and shadows on the surface to accurately recover the surface shape and non-Lambertian reflectance. Additionally, the authors explicitly predict cast shadows to reduce artifacts in these shadowed regions, resulting in higher estimation accuracy. Importantly, their framework is entirely self-supervised, meaning it does not require ground truth shape or BRDF (bidirectional reflectance distribution function) information. Experimental results on real-world images demonstrate that their method outperforms existing approaches by a significant margin. Moreover, due to the small size of the MLP network, their method is ten times faster than previous convolutional neural network (CNN)-based methods.