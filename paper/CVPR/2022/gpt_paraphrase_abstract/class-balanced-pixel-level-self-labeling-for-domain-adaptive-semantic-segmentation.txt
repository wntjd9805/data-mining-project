The goal of domain adaptive semantic segmentation is to develop a model that can accurately predict the labels of unlabeled data from a different domain, using labeled data from a source domain. One commonly used approach is self-training, where high-scoring predictions on the target data are used as labels for training. However, these pseudo labels often contain a lot of noise because the model is biased towards the source domain and majority categories. To address this issue, we propose a method that directly analyzes the pixel distributions of the target data instead of relying heavily on the source domain. We simultaneously cluster pixels and adjust the pseudo labels based on the cluster assignments. This process is done in real-time so that the pseudo labels can evolve with the segmentation model without requiring additional training rounds. To overcome the problem of class imbalance, especially for categories with fewer samples, we use a technique called distribution alignment to ensure that the marginal class distribution of the cluster assignments is similar to that of the pseudo labels. Our proposed method, called Class-balanced Pixel-level Self-Labeling (CPSL), significantly improves the segmentation performance on the target domain, particularly for categories with imbalanced data. The source code for CPSL is available at https://github.com/lslrh/CPSL.