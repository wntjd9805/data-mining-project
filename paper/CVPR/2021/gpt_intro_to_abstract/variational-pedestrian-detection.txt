This paper explores the problem of pedestrian detection in crowds, which has gained significant attention in recent years due to its various applications. However, the presence of heavy occlusion and high overlap among human instances poses challenges for pedestrian detectors in accurately extracting object bounding boxes. The field of deep learning-based object detection has proposed two types of detectors: two-stage and single-stage detectors. Single-stage detectors have shown great efficiency and performance for general-purpose object detection. These detectors use a fully convolutional network to generate dense proposals, which are then processed using non-maximum suppression and a score threshold to obtain final detection results. However, the learning process of single-stage detectors can be sub-optimal in crowded scenes due to the ambiguity of assigning ground truth to multiple overlapping anchor boxes.To address this issue, the paper introduces a new approach called "random learning-to-match" via variational inference. In this approach, the dense proposals are considered as auxiliary latent variables that relate to the final detection results. Unlike traditional online and offline methods, which fix the dense proposals, the proposed approach predicts the distribution of dense proposals using a variational inference-based algorithm. This enables adaptive adjustment of the exploration strategy in matching space, making it more robust to heavy occlusion. Additionally, the proposed method can be integrated into both anchor-based and anchor-free detection pipelines, making it highly versatile.The contributions of this paper are three-fold. Firstly, it proposes a new perspective of formulating single-stage detectors as a variational inference problem, which opens up possibilities for further extensions of detection schemes in this direction. Secondly, it introduces a detection-customized Auto-Encoding Variational Bayes algorithm to optimize general object detectors specifically for pedestrian detection. Finally, experimental results on the CrowdHuman and CityPersons datasets demonstrate the effectiveness of the proposed approach for both single-stage and two-stage detectors.