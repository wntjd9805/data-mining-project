Localization and identification of spine vertebrae in 3-D medical images are essential for computer-aided diagnosis of spine disorders. Despite significant progress in addressing this problem, accurately identifying vertebrae with similar appearances remains a challenging task. Existing methods rely on anatomical prior knowledge to improve performance, but they still have limitations in fully utilizing this knowledge. Additionally, current approaches depend on information exchange mechanisms to capture spatial relationships between vertebrae, without explicitly imposing anatomical constraints during classification. In this paper, we propose a method that utilizes anatomical constraints to jointly label all vertebrae, improving the utilization of anatomical knowledge. Our approach involves training a key point localization U-Net to predict activation maps for vertebra centers. These activation maps are then warped and aggregated to form 1-D vertebra activation signals. We formulate vertebra localization and identification as an optimization problem on these signals, ensuring the spatial order of the vertebrae with a hard constraint. We also integrate the distance between vertebrae as a soft constraint in the objective function. By searching for labels jointly in the constrained search space, our method allows global message passing among the vertebrae, resulting in anatomically plausible results. We evaluate our approach on a public benchmark dataset and achieve a state-of-the-art identification rate of 97.4%, significantly outperforming previous methods. Our contributions include a simplified approach for reducing complexity, the incorporation of anatomical constraints, and improved identification accuracy.