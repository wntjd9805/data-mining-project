Modern deep neural networks have shown great efficacy in various tasks, but they often come with high network complexity. This poses challenges for real-world applications with limited resources, such as mobile applications or autonomous driving. To address this issue, many approaches have been proposed to reduce network redundancy, with quantization being a popular and simple approach. Quantization involves simplifying weight assignments in the network by mapping high-precision weights to a smaller set of points specified by a codebook, thereby reducing the computational requirements. However, while there have been significant insights into this problem, theoretical analysis has lagged behind, leaving no guarantees of optimality in the substeps of the quantization process. In this paper, we focus on the generalized scaled codebook quantization problem, where we aim to find the optimal rescaling of a codebook and corresponding assignments of data points to minimize the â„“2 quantization error. This problem arises in various signal processing settings and has gained attention in neural network compression. We present an optimal algorithm that guarantees finding the solution to this problem in O(N K log K) time using O(N) memory. While previous approaches used heuristic search or alternating optimization without guarantees, our algorithm can handle any codebook C. Our approach is based on studying the properties of the optimal quantizer and leveraging possible shortcuts. We provide numerical experiments to support our findings. This paper presents a significant contribution to the field by introducing a generic algorithm for the scaled codebook quantization problem. While optimal algorithms existed for specific types of codebooks, our approach is the first to handle any codebook. The algorithm's efficiency makes it suitable for real-world applications with computational constraints. Overall, our work provides insights into the optimization of quantization in deep neural networks and offers a robust solution to the scaled codebook quantization problem.