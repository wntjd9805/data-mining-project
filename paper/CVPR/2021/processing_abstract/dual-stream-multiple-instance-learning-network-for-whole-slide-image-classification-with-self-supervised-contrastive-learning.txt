We address the challenging problem of whole slide image (WSI) classiﬁcation. WSIs have very high resolutions and usually lack localized annotations. WSI classiﬁcation can be cast as a multiple instance learning (MIL) problem when only slide-level labels are available. We propose a MIL-based method for WSI classiﬁcation and tumor detection that does not require localized annotations. Our method has three major components. First, we introduce a novelMIL aggregator that models the relations of the instances in a dual-stream architecture with trainable distance measure-ment. Second, since WSIs can produce large or unbalanced bags that hinder the training of MIL models, we propose to use self-supervised contrastive learning to extract good rep-resentations for MIL and alleviate the issue of prohibitive memory cost for large bags. Third, we adopt a pyramidal fusion mechanism for multiscale WSI features, and further improve the accuracy of classiﬁcation and localization. Our model is evaluated on two representative WSI datasets. The classiﬁcation accuracy of our model compares favorably to fully-supervised methods, with less than 2% accuracy gap across datasets. Our results also outperform all previousMIL-based methods. Additional benchmark results on stan-dard MIL datasets further demonstrate the superior perfor-mance of our MIL aggregator on general MIL problems. 