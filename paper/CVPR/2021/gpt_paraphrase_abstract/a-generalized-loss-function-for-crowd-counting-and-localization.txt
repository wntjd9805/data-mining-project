This study explores the use of a density map representation to improve crowd counting performance. The authors introduce a generalized loss function for learning density maps, which is based on an unbalanced optimal transport problem. They demonstrate that existing pixel-wise L2 loss and Bayesian loss are suboptimal solutions to their proposed loss function. To handle perspective transformation in crowd images, a perspective-guided transport cost function is introduced. The authors also highlight that the sparsity of the predicted density map allows for natural localization. Experimental results on four large-scale datasets demonstrate that the proposed loss function outperforms others for counting, and achieves the best localization performance on NWPU-Crowd and UCF-QNRF datasets.