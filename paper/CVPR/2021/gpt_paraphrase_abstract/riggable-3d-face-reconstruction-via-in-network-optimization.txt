This paper introduces a technique for creating a customizable 3D face model from single images, which simultaneously estimates a personalized face rig and various image-specific parameters such as expressions, poses, and lighting conditions. To accomplish this, the authors propose an end-to-end trainable network that incorporates a differentiable in-network optimization. Initially, the network represents the face rig as a concise latent code using a neural decoder, and then learns to estimate both the latent code and the image-specific parameters through optimization. By considering a personalized face rig, this method surpasses static reconstructions and enables applications like video retargeting. The in-network optimization enforces constraints derived from fundamental principles, providing additional priors compared to regression-based approaches. Additionally, data-driven priors obtained from deep learning are employed to handle the ill-posed nature of monocular settings and alleviate optimization challenges. Experimental results demonstrate that the proposed method achieves state-of-the-art accuracy in reconstruction, exhibits reasonable robustness and generalization capabilities, and supports typical face rig applications.