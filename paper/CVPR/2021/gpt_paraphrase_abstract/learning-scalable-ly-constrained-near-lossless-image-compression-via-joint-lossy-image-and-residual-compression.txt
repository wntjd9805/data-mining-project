We propose a new method for compressing images while maintaining near-lossless quality. Our framework involves reconstructing the image using lossy compression and quantizing the residual to meet a specified error bound. We address both lossless and near-lossless compression by optimizing the compression of the image and the original residual using variational auto-encoders. For scalable compression with a non-zero error bound, we derive the probability model of the quantized residual from the learned model of the original residual. We also correct the bias in the derived probability model caused by differences between training and inference. Finally, the quantized residual is encoded using the corrected probability model and combined with the compressed lossy image. Experimental results show that our approach achieves high performance for lossless and near-lossless compression, with competitive PSNR and smaller ℓ∞ error compared to other lossy image codecs at high bit rates.