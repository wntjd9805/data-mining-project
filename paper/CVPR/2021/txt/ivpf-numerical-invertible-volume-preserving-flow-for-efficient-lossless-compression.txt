Abstract
It is nontrivial to store rapidly growing big data nowa-days, which demands high-performance lossless compres-sion techniques. Likelihood-based generative models have witnessed their success on lossless compression, where ﬂow based models are desirable in allowing exact data likeli-hood optimisation with bijective mappings. However, com-mon continuous ﬂows are in contradiction with the discrete-ness of coding schemes, which requires either 1) impos-ing strict constraints on ﬂow models that degrades the per-formance or 2) coding numerous bijective mapping errors which reduces the efﬁciency. In this paper, we investigate volume preserving ﬂows for lossless compression and show that a bijective mapping without error is possible. We pro-pose Numerical Invertible Volume Preserving Flow (iVPF) which is derived from the general volume preserving ﬂows.
By introducing novel computation algorithms on ﬂow mod-els, an exact bijective mapping is achieved without any nu-merical error. We also propose a lossless compression al-gorithm based on iVPF. Experiments on various datasets show that the algorithm based on iVPF achieves state-of-the-art compression ratio over lightweight compression al-gorithms. 1.

Introduction
Lossless compression is widely applied to efﬁciently store a growing amount of data in the big data era. It is indi-cated by Shannon’s source coding theorem that the optimal codeword length is lower bounded by the entropy of the data distribution [25]. Many coding methods [18, 39, 9] succeed in reaching the theoretical codelength, and are widely ap-plied in various compression algorithms [10, 6, 30, 31].
Probabilistic modelling techniques can be adopted for lossless compression with coding algorithms, in which the minimum possible codelength would be essentially bounded by the negative log-likelihood of the probabilis-tic model. Recent advances of deep generative models
Figure 1. Illustration of IDF(++), LBB and the proposed iVPF model. VPF denotes volume preserving ﬂow. Flow layers with darker colour denotes higher expressive power. The compression codelength and coding time are listed below (lower is better). have shown great success in maximising the likelihood of various types of data including images [22, 21, 32, 8], videos [24, 19] and audios [29, 28]. Various lossless com-pression algorithms have been discovered based on different types of generative models [26, 35, 15, 3, 13, 36, 23, 27, 5].
They witnessed better compression ratio compared to those without machine learning techniques.
In this paper, we focus on coding with ﬂow-based gener-ative models [8, 21, 8, 29, 24]. Although variational auto-encoders (VAEs) [22, 11] and auto-regressive [32, 37] mod-els are both probabilistic models, they either suffer from in-ferior likelihood estimation (VAEs), or involve huge com-putational overhead (auto-regressive). Normalising ﬂow models admit bijective mappings between input data and latent variables, and the latter is adopted for likelihood computation given the prior. However, common ﬂows are continuous and numerical errors always occur for forward and inverse computation [2], while lossless compression in-volves discrete data and any numerical error is unaccept-620
able. To solve the above issue, IDF [15] and IDF++ [3] introduce discrete ﬂows by adding discrete constraints on the model, but the theoretical likelihood is inferior to that of general continuous ﬂows. LBB [13] succeeds in cod-ing with general ﬂows and the codelength is close to the theoretical lower bound of negative log-likelihood, but it is extraordinarily time-consuming.
To circumvent the above issues, we introduce iVPF, a
Numerical Invertible Volume Preserving Flow model with high expressivity and efﬁcient coding. We point out that general ﬂows are almost not bijective in practice, because the real-world data are discrete in nature, resulting the difﬁ-culty for lossless compression. The proposed iVPF is con-structed from volume preserving ﬂow [7, 34] to achieve the bijective mapping on discrete space, and an efﬁcient loss-less compression algorithm based on iVPF is developed. 1
The main contributions of this work are summarised as fol-lows: 1. We investigate the importance of volume preserving
ﬂow in the lossless compression context, and pro-pose the novel computation algorithm Modular Afﬁne
Transformation (MAT) which achieves exact bijective mapping without any numerical error for coupling lay-ers of volume preserving ﬂows. 2. Based on MAT, we propose the Numerical Invertible
Volume Preserving Flow (iVPF) model and an efﬁcient lossless compression algorithm for iVPF. 3. Experiments show the effectiveness of the proposed lossless compression algorithm, where the compres-sion performance is superior over the state-of-the-art lightweight methods. 2.