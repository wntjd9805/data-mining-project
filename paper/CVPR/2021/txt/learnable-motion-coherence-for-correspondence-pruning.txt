Abstract
Motion coherence is an important clue for distinguish-ing true correspondences from false ones. Modeling mo-tion coherence on sparse putative correspondences is chal-lenging due to their sparsity and uneven distributions. Ex-isting works on motion coherence are sensitive to parame-ter settings and have difﬁculty in dealing with complex mo-tion patterns. In this paper, we introduce a network called
Laplacian Motion Coherence Network (LMCNet) to learn motion coherence property for correspondence pruning. We propose a novel formulation of ﬁtting coherent motions with a smooth function on a graph of correspondences and show that this formulation allows a closed-form solution by graph
Laplacian. This closed-form solution enables us to design a differentiable layer in a learning framework to capture global motion coherence from putative correspondences.
The global motion coherence is further combined with local coherence extracted by another local layer to robustly de-tect inlier correspondences. Experiments demonstrate that
LMCNet has superior performances to the state of the art in relative camera pose estimation and correspondences prun-ing of dynamic scenes1. 1.

Introduction
Estimating correspondences between two images is a fundamental problem in computer vision tasks such as
Structure-from-Motion (SfM) [19], visual localization [45], image stitching [10] and visual SLAM [32]. A standard pipeline of correspondence estimation relies on local fea-ture matching to establish a set of putative correspondences, which contains numerous false correspondences (i.e., out-liers). To prevent outliers from affecting downstream tasks, a correspondence pruning algorithm is usually applied to select a reliable subset consisting of true correspondences (i.e., inliers). The most prevalent correspondence pruning methods are RANSAC [18] and its variants [52, 14, 2, 12],
∗Corresponding author 1Code and supplementary material can be found in the project page: https://liuyuan-pal.github.io/LMCNet/
Figure 1. Given a set of putative correspondences (a), multiple plausible epipolar geometries exist, e.g. (b) and (c). However, true correspondences (c) are usually motion coherent while false ones (b) are not. In this paper, we design a network called LMCNet to explicitly utilize the motion coherence of correspondences via a global coherence ﬁtting (d) and a local consistency extraction (e).
Hence, LMCNet is able to robustly predict their inlier probabilities (f), where brighter color means higher inlier probability. which detect true correspondences by ﬁnding the largest subset conforming to a task-speciﬁc geometric model such as epipolar geometry or homography. However, due to large outlier ratios of putative correspondences, multiple plausi-ble geometric models may exist, which makes it difﬁcult for
RANSAC and its variants to identify the correct geometric model.
Besides the task-speciﬁc geometric model, true corre-spondences also conform to a more general motion model called motion coherence, which means that neighboring pixels share similar motions, while false correspondences are usually randomly scattered, as illustrated in Fig. 1 (a-c).
Motion coherence supplements the task-speciﬁc geometric model and is key to determining true correspondences when multiple plausible geometric models exist.
To model motion coherence, existing works propose lo-cal [5, 29] or global handcrafted rules [23, 22] to ﬁnd coher-ent correspondences. However, modeling motion coherence on sparse correspondences generated by local descriptors is challenging. First, unlike in tasks of dense correspondence 3237
estimation such as optical ﬂow estimation [26, 6, 7], pu-tative correspondences generated by local descriptors are discrete and sparse, which makes it much more difﬁcult to estimate the underlying smooth motion ﬁeld. Second, putative correspondences are usually distributed unevenly over an image because there are often many detected key-points in textured regions and few keypoints in textureless regions. This uneven distribution makes it hard to ﬁnd a uni-form coherence constraint on the correspondences. Third, an observed scene may have a complex structure, such as an abrupt change of depth, so that the underlying motion ﬁelds are only piece-wise smooth, which brings about difﬁculty in ﬁnding motion boundaries [22]. Due to these challenges, existing works either need careful parameter tuning for dif-ferent datasets [22, 23] or may fail when motion patterns are complex [29, 5].
We address these problems by proposing a neural net-work to learn the motion coherence property for correspon-dence pruning. Compared to handcrafted rules of motion coherence, neural networks have more powerful and ﬂexi-ble representational ability to learn more complex motion patterns from data and reliably detect motion boundaries.
Designing differentiable layers to capture the motion co-herence property is the key to adopting a learning-based ap-proach. Traditional global motion coherence models [22, 23] usually involve a non-differentiable iterative convex op-timization solver, which cannot be used for training a net-work end-to-end. To address this issue, we propose a novel formulation of the motion coherence property via smooth function ﬁtting on a graph of correspondences. We call this formulation Laplacian Motion Fitting (LMF) and further show that the proposed LMF has a simple closed-form so-lution by decomposition of graph Laplacian, which enables us to design a differentiable Coherence Residual Layer, called CR-Layer for abbreviation, to capture global motion coherence from putative correspondences.
Besides the global coherence model, true correspon-dences also have motion-consistent supporting correspon-dences in their local neighborhoods [5]. Based on this ob-servation, we design a Local Coherence Layer, called LC-Layer for abbreviation, to extract local motion coherence from these neighboring supporting correspondences. By in-tegrating both the global and local motion coherence layers, we design a network called Laplacian Motion Coherence
Network (LMCNet), which takes coordinates or other op-tional features of correspondences as inputs and outputs the probability of each correspondence being an inlier.
We conducted extensive experiments to demonstrate the effectiveness of the proposed neural network in two tasks: relative camera pose estimation, and correspondence prun-ing of dynamic scenes. On both tasks, LMCNet achieves superior performance than other baseline methods, demon-strating its ability to robustly select inliers and potential to enhance object tracking or video object recognition.
Our contributions are as follows. 1. We proposed a novel formulation of motion coherence on sparse correspondences which has a simple closed-form solution by decomposition of graph Laplacian. 2. We proposed differentiable layers, which work to-gether to robustly capture motion coherence of sparse putative correspondences. 3. We designed a neural network for correspondence pruning and demonstrate its effectiveness on the rel-ative pose estimation problem and correspondence pruning of dynamic scenes. 2.