Abstract
Before Adaptation
After Adaptation
Domain adaptation (DA) aims at transferring knowl-edge from a labeled source domain to an unlabeled target domain. Though many DA theories and algorithms have been proposed, most of them are tailored into classiﬁca-tion settings and may fail in regression tasks, especially in the practical keypoint detection task. To tackle this difﬁ-cult but signiﬁcant task, we present a method of regressive domain adaptation (RegDA) for unsupervised keypoint de-tection. Inspired by the latest theoretical work, we ﬁrst uti-lize an adversarial regressor to maximize the disparity on the target domain and train a feature generator to minimize this disparity. However, due to the high dimension of the output space, this regressor fails to detect samples that de-viate from the support of the source. To overcome this prob-lem, we propose two important ideas. First, based on our observation that the probability density of the output space is sparse, we introduce a spatial probability distribution to describe this sparsity and then use it to guide the learning of the adversarial regressor. Second, to alleviate the opti-mization difﬁculty in the high-dimensional space, we inno-vatively convert the minimax game in the adversarial train-ing to the minimization of two opposite goals. Extensive ex-periments show that our method brings large improvement by 8% to 11% in terms of PCK on different datasets. 1.

Introduction
Many computer vision tasks have achieved great success with the advent of deep neural networks in recent years.
However, the success of deep networks relies on a large amount of labeled data [14], which is often expensive and time-consuming to collect. Domain adaptation (DA) [21], which aims at transferring knowledge from a labeled source domain to an unlabeled target domain, is a more econom-ical and practical option than annotating sufﬁcient target samples, especially in the keypoint detection tasks. The fast development of computer vision applications leads to huge increases in demand for keypoint detection but the an-Figure 1. Visualization before and after adaptation on the unla-beled target domain. (Left) The wrong predictions before adapta-tion are usually located at other keypoints. (Right) The predictions of the adapted model look more like hands or bodies. notations of this task are more complex than classiﬁcation tasks, requiring much more labor work especially when the objects are partially occluded. On the contrary, accurately labeled synthetic images can be obtained in abundance by computer graphics processing at a low cost [27, 23]. Hence, enabling domain adaptation in regression settings for unsu-pervised keypoint detection has a promising future.
There are many effective DA methods for classiﬁcation
[17, 6, 22, 30], but we empirically found that few methods work on regression. One possible reason is that there ex-ist explicit task-speciﬁc boundaries between classes in clas-siﬁcation. By applying domain alignment, the margins of boundaries between different classes on the target domain are enlarged, thereby helping the model generalize to the unlabeled target domain. However, the regression space is usually continuous on the contrary, i.e., there is no clear de-cision boundary. Meanwhile, although images have limited pixels, the keypoint is still in a large discrete space due to a combination of different axes, posing another huge chal-lenge for most DA methods.
To solve the issues caused by the large output space, we delved into the predictions of a source-only keypoint de-tection model. We observed that when the predictions on the unlabeled domain are wrong, they are not equally dis-tributed on the image. For example, if the position of a right ankle is mistaken (Figure 1), the wrong prediction is most likely at the position of the left ankle or other keypoints, instead of somewhere in the background as we expected.
This unexpected observation reveals that the output space is sparse in the sense of probability. Consider an extremely 6780
sparse case where the predicted position is always located at a keypoint, then a speciﬁc ankle detection problem be-comes a K-way classiﬁcation problem, and we can reduce the domain gap by enlarging the decision boundary between keypoints. This extreme case gives us a strong hint that if we can constrain the output space from a whole image space into a smaller one with only K keypoints, it may be possible to bridge the gap between regression and classiﬁcation.
This paper aims to enable regressive domain adaptation (RegDA). Inspired by the latest domain adaptation theory— disparity discrepancy (DD) [30], we ﬁrst use an adversar-ial regressor to maximize the disparity on the target do-main and train a feature generator to minimize this disparity.
Based on the aforementioned observations and analyses, we introduce a spatial probability distribution to describe the sparsity and use it to guide the optimization of the adversar-ial regressor. It can somewhat avoid the problems caused by the large output space and reduce the gap between keypoint detection and classiﬁcation in domain adaptation. Besides, we also found that maximizing the disparity of two regres-sors is unbelievably difﬁcult (see Section 5.2.4). To this end, we convert the minimax game in DD [30] into minimization of two opposite goals. This conversion has effectively over-came the optimization difﬁculty of adversarial training in
RegDA. Our contributions are summarized as follows:
• We discovered the sparsity of regression output space in the sense of probability, which provides a hint to bridge the gap between regression and classiﬁcation.
• We proposed RegDA, an effective regression method, which converts the minimax game between two regres-sors into the minimization of two opposite goals.
• We conducted rich experiments on various keypoint detection tasks and validate that our method can bring performance gains by 8% to 11% in terms of PCK. 2.