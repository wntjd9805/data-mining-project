Abstract
Localization of anatomical landmarks to perform two-dimensional measurements in echocardiography is part of routine clinical workﬂow in cardiac disease diagnosis. Au-tomatic localization of those landmarks is highly desirable to improve workﬂow and reduce interobserver variability.
Training a machine learning framework to perform such lo-calization is hindered given the sparse nature of gold stan-dard labels; only few percent of cardiac cine series frames are normally manually labeled for clinical use. In this pa-per, we propose a new end-to-end reciprocal detection and tracking model that is speciﬁcally designed to handle the sparse nature of echocardiography labels. The model is trained using few annotated frames across the entire car-diac cine sequence to generate consistent detection and tracking of landmarks, and an adversarial training for the model is proposed to take advantage of these annotated frames. The superiority of the proposed reciprocal model is demonstrated using a series of experiments. 1.

Introduction
Data scarcity and lack of annotation is a general prob-lem for developing machine learning models in medical imaging. Among various medical imaging modalities, ul-trasound (US) is the most frequently used modality given its widespread availability, lower cost, and safety since it does not involve ionizing radiation. Speciﬁcally, US imag-ing, in the form of echocardiography (echo), is the standard-of-care in cardiac imaging for the detection of heart dis-ease. Echo examinations are performed across up to 14 standard views from several acoustic windows on the chest.
In this paper, we speciﬁcally focus on the parasternal long axis (PLAX), which is one of the most common view ac-quired in the point-of-care US for rapid examination of car-diac function (Fig. 1). Several measurements from PLAX require the localization of anatomical landmarks across dis-crete points in the cardiac cycle. Our work speciﬁcally in-vestigates automatic localization of the left ventricle (LV) internal dimension (LVID), which is routinely used to esti-mate the ejection fraction (EF), a strong indicator of cardiac function abnormality. In clinics, LVID landmarks are deter-mined in two frames of the cardiac cycle, i.e. end-diastolic and end-systolic. However, such annotation is challenging, specially for general physicians at point-of-care who do not have the experience of cardiologists. As such, the automa-tion of landmark localization is highly desirable. However, developing a machine learning model for such automation has been hindered by the availability of only sparse set of la-beled frames in cardiac cines. Manually labeling all cardiac frames for a large set of cardiac cines is virtually impracti-cal, given limited expert time.
Instead of manually labeling, we propose a new Recipro-cal landmark Detection and Tracking (RDT) model that en-ables automation in measurements across the entire cardiac cycle. The model only uses prior knowledge from sparsely labeled key frames that are temporally distant in a cardiac cycle. Meanwhile, we take advantage of temporal coher-ence of cardiac cine series to impose cycle consistency in tracking landmarks across unannotated frames that are be-tween these two annotated frames. To impose consistent detection and tracking of the landmarks, we propose a re-ciprocal training as a self-supervision process.
In summary, we propose a RDT model, which is weakly supervised by only two annotated keyframes in an image se-quence for model training. For testing, the model is an end-to-end model that detects the landmark in the ﬁrst frame, 15170
[21]. This amount of observer variability may easily lead to errors in reporting an abnormal patient as normal, or vice versa for borderline cases. This fact has raised the signiﬁ-cance of automated measurement systems by reducing the variability and increasing the reliability of cardiac reports among US operators. Furthermore, automation saves a con-siderable amount of time by improving clinical workﬂow.
The problem of automated prediction of clinical mea-surements, such as segmentation and keypoint localization of anatomical structures, has been approached from differ-ent angles, especially within the deep learning literature, where leveraging large size training datasets has led to sig-niﬁcant improvements in the accuracy of predicted mea-surements. Most of the recent methods have used fully convolutional neural networks (FCN) as their main build-ing block to predict pixel-level labels [18, 12, 1, 14, 13, 2, 3, 24]. Similar to numerous works in pose detection liter-ature [16, 22], in many FCN-based methods, the structure localization problem has been approached by predicting heatmaps corresponding to the regions of interest at some point in the network [15]. In [15], a convolutional neural network (CNN) architecture was explored to combine the local appearance of one landmark with the spatial conﬁg-uration of other landmarks for multiple landmark localiza-tion. However, these methods are introduced for problems where data consists of individual frames, rather than tempo-ral sequences. On the contrary, time plays an important role in the calculation of measurements such as EF in cardiac cycles. Therefore, the sole use of these methods may not be sufﬁcient for our problem of interest and other temporally constrained or real-time applications.
Recent studies have made use of spatio-temporal mod-els to overcome limitations of previous models in problems dealing with sequential data, and particularly, echo cine loops [19, 5].
In [20], while a center of the mass layer was introduced and placed on top of an FCN architecture to regress keypoints out of the predicted heatmaps directly, a convolutional long short-term memory (CLSTM) network was also utilized for improving temporal consistency. In the cardiac segmentation domain, many works such as [6] have applied recurrent neural networks to their pipeline. In [9], multi-scale features are ﬁrst extracted with pyramid Con-vBlocks, and these features are aggregated using hierarchi-cal ConvLSTMs. Other types of studies have fed motion in-formation to their network based on estimating the motion vector between consecutive frames [23, 8, 4]. Another case of this method is presented by [17], in which similar to our weakly-supervised problem, motion estimation is obtained from an optical ﬂow branch to enforce spatio-temporal smoothness over a weakly supervised segmentation task with sparse labels in the temporal dimension. However, op-tical ﬂow estimation might contain drastic errors in consec-utive frames with large variability, especially in US images 15171
Figure 1: Example of PLAX images, as one of the most common standard views acquired in point-of-care echocardiography. Land-marks identiﬁed on the left ventricle are used to measure the EF, a strong indicator of cardiac disease. Two landmarks on inferolat-eral and anteroseptal walls (IW, AW) are yellow color while the
LVID is the red line. LVID can be localized with IW and AW. followed by a tracking process. Our contributions are:
• A novel Reciprocal landmark Detection and Tracking (RDT) model is proposed.
In the model, the spatial constraint for detection and temporal coherence for tracking of cardiac cine series work reciprocally, to generate accurate localization of landmarks;
• The sparse nature of echocardiography labels is han-dled by the proposed model. The model is only weakly supervised by two annotated image frames that are temporally distant from each other. The annotation sparsity is also analyzed in the experimental part;
• A novel adversarial training approach (Ad-T) for opti-mization of the proposed RDT. Such training is made possible by introducing four complementary losses as in Fig. 2, i.e. reciprocal loss, motion loss, focal loss, and cycle loss. Compared with conventional training approaches, Ad-T indirectly achieves feature augmen-tation, which is extremely important for model training given the extremely few annotations. the advantage of such Ad-T is highlighted in our ablation study. 2.