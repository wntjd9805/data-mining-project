Abstract
Humans have a strong class-agnostic object segmenta-tion ability and can outline boundaries of unknown objects precisely, which motivates us to propose a box-supervised class-agnostic object segmentation (BoxCaseg) based so-lution for weakly-supervised instance segmentation. The
BoxCaseg model is jointly trained using box-supervised im-ages and salient images in a multi-task learning manner.
The ﬁne-annotated salient images provide class-agnostic and precise object localization guidance for box-supervised images. The object masks predicted by a pretrained Box-Caseg model are reﬁned via a novel merged and dropped strategy as proxy ground truth to train a Mask R-CNN for weakly-supervised instance segmentation. Only using 7991 salient images, the weakly-supervised Mask R-CNN is on par with fully-supervised Mask R-CNN on PASCAL VOC and signiﬁcantly outperforms previous state-of-the-art box-supervised instance segmentation methods on COCO. The source code, pretrained models and datasets are available at https://github.com/hustvl/BoxCaseg. 1.

Introduction
Weakly-supervised instance segmentation (WSIS) is im-portant in computer vision for at least two reasons: First, it reduces human annotation efforts so that it is useful in building label-efﬁcient visual recognition systems. Second, humans can learn to segment objects without perfect/exact labels, and building a visual learning system similar to hu-man perception is a long-term goal of computer vision; thus the research weakly-supervised instance segmentation is a way to approach human perception. In this paper, we inves-tigate the problem of weakly-supervised instance segmenta-tion using bounding box annotations rather than the precise mask annotations.
As reported in [3], labeling a mask takes about 79 sec-onds while labeling a bounding box takes only about 10 seconds on average. Thus, if a WSIS method can obtain
⋆Wenyu Liu is the corresponding author.
Figure 1. The top row shows a salient training image (a) and two box-supervised training images (b). Our model is jointly trained using both salient images and box-supervised images and obtains high quality instance segmentation results (c). the segmentation precision on par with the state-of-the-art fully supervised instance segmentation methods (e.g., Mask
R-CNN [13]), it is extremely useful and has great poten-tial to be applied in real world applications. To solve this problem, previous methods have applied unsupervised im-age segmentation methods based on hand-crafted features
[40, 38], pseudo labeling [7, 42, 2], multi-instance learning
[16] and attention networks [23] in various WSIS frame-works.
We think the key problem in WSIS is box-supervised class-agnostic object segmentation (BoxCaseg), i.e., given the object bounding box, we need to infer pixel-level ob-ject mask. Humans have strong ability on the task of Box-Caseg and can perceive object boundaries even the ob-jects are from unknown semantic categories. To mimic this class-agnostic human learning process, we propose a joint training scheme, in which a salient object segmen-tation (also known as salient object detection) dataset that contains class-agnostic pixel-level object location informa-tion is applied to simulate humans’ historical memory. The salient images are trained with box-annotated images (as shown in Fig. 1) in a single deep multi-task network and are mixed in the same mini-batches. The tasks include pixel-level labeling salient images and multi-instance classiﬁca-tion [16] of both box-supervised images and salient images.
During training, salient images can provide salient knowl-10225
Figure 2. The pipeline of our approach. Our training process is divided into three steps. First, we obtain a class-agnostic segmentation model (BoxCaseg) through the joint training of box-supervised dataset and salient object segmentation dataset (Sec. 3.2). Then, we use the class-agnostic segmentation model to produce high quality predictions for training instances. Those segmentation predictions are merged to generate proxy instance masks for training images. Finally, we re-train a Mask R-CNN with proxy masks (Sec. 3.4). edge to guide the segmentation of box-supervised images.
Besides, inspired by Mask⋆ R-CNN [17], weight transfer is performed from the multi-instance learning task to the pixel-labeling task to enhance the joint learning.
The learned BoxCaseg model is applied to generate ob-ject masks for box-supervised training images. The masks are reﬁned by our proposed merging and dropping strategies for training a Mask R-CNN model for WSIS. Experiments are carried out on the PASCAL VOC and COCO datasets.
At last, our main contributions are highlighted as follows. 1. We propose a novel weakly-supervised instance seg-mentation method based on box-supervised class-agnostic object segmentation, in which class-agnostic precise salient object localization information is utilized as auxiliary memory to promote weakly-supervised instance segmentation during training. 2. We propose new mask merging and dropping strategies to obtain high-quality proxy masks for pseudo-training
Mask R-CNN. 3. The class-agnostic segmentation model has great gen-eralization ability. Only using 7991 salient images which are disjointed with PASCAL and COCO, for the ﬁrst time, a box-supervised instance segmentation obtains similar performance with its fully-supervised counterpart. On COCO, our result is signiﬁcantly bet-ter than previous state-of-the-art WSIS methods. 2.