Abstract (a) (b) (c)
Weakly supervised semantic segmentation produces a pixel-level localization from a classiﬁer, but it is likely to restrict its focus to a small discriminative region of the target object. AdvCAM is an attribution map of an image that is ma-nipulated to increase the classiﬁcation score. This manipula-tion is realized in an anti-adversarial manner, which perturbs the images along pixel gradients in the opposite direction from those used in an adversarial attack. It forces regions ini-tially considered not to be discriminative to become involved in subsequent classiﬁcations, and produces attribution maps that successively identify more regions of the target object.
In addition, we introduce a new regularization procedure that inhibits the incorrect attribution of regions unrelated to the target object and limits the attributions of the regions that already have high scores. On PASCAL VOC 2012 test images, we achieve mIoUs of 68.0 and 76.9 for weakly and semi-supervised semantic segmentation respectively, which represent a new state-of-the-art. The code is available at: https://github.com/jbeomlee93/AdvCAM . 1.

Introduction
Semantic segmentation involves the allocation of a se-mantic label to each pixel of an image. It is an essential task in image recognition and scene understanding. Deep neu-ral networks (DNNs) have facilitated tremendous progress in semantic segmentation [8, 22]; but they require a large number of training images annotated with pixel-level la-bels. Preparing such a training dataset is very expensive: pixel-level annotation of images containing an average of 2.8 objects takes about 4 minutes [4] per image, and a single large (2048×1024) image depicting a complicated scene requires more than 90 minutes for pixel-level annotation [9].
The need for pixel-level annotation is addressed by weakly supervised learning, in which a segmentation net-work is trained on images with less comprehensive anno-∗Correspondence to: Sungroh Yoon <sryoon@snu.ac.kr>.
: Original image
: Manipulated image
: Decision boundary
: Manipulation (d)
Image
Iter 0 (CAM)
Iter 15
Iter 30
Figure 1: Conceptual description of image manipulation methods for weakly supervised semantic segmentation: (a) erasure [21, 57, 63]; (b) FickleNet [29]; and (c) AdvCAM. (d) Examples of successive attribution maps obtained from iteratively manipulated images. tations that are cheaper to obtain than pixel-level labels.
Weakly supervised methods can use scribbles [54], points [4], bounding boxes [26, 51], and class labels [2, 6, 29, 48] as annotations. Labeling an image with class labels takes about 20 seconds [4], making class labels the cheapest option. In addition, many public datasets are already annotated with class labels [10, 12], and automated web searches can also provide images with class labels [20, 30, 47] although the ac-curacy of such labels may be low. These considerations make class labels the most popular form of weak supervision.
Most weakly supervised segmentation methods that use class labels depend on attribution maps obtained from a trained classiﬁer [46, 64]. Such a map identiﬁes the image regions on which the classiﬁer concentrated. However, these important, or discriminative, regions are relatively small, and most attribution maps do not represent the whole re-gion occupied by a target object, which makes those attribu-tion maps unsuitable for training a semantic segmentation network. Therefore, many researchers have tried to extend 4071
regions to cover more of a target object, by manipulating images [33, 50, 57] or feature maps [21, 29, 63].
One popular method for manipulation is erasure: the clas-siﬁer is forced to ﬁnd new regions of the target object from which discriminative regions previously located have been removed. Erasure is effective, but it requires modiﬁcation of the network, often by adding additional layers [21, 63], or additional training steps [57]. Another difﬁculty is the provision of a reliable termination condition for the iterative erasure; the erasure of discriminative region of an image can cause the DNN to misclassify that image. If the image from which the discriminative region has been erased crosses the decision boundary as shown in Figure 1(a), an erroneous attribution map may be generated. An alternative method for manipulation is a stochastic perturbation shown in Fig-ure 1(b). FickleNet [29] diversiﬁes attribution maps from an image by applying random dropout to the feature maps of a
DNN and aggregates them into a uniﬁed map.
We propose a new manipulation method for extending the discriminative regions of a target object. Our method is based on adversarial attack [16, 28], but with a benign purpose. Adversarial attack ﬁnds a small perturbation of an image that pushes it across the decision boundary to change the classiﬁcation result. By contrast, our method operates in an anti-adversarial manner , which is the reversal of ad-versarial attack. It aims to ﬁnd a perturbation that pushes the manipulated image away from the decision boundary, as shown in Figure 1(c). This manipulation is realized by adversarial climbing, in which an image is perturbed along pixel gradients which increase the classiﬁcation score of the target class. The result is that non-discriminative regions, which are nevertheless relevant to that class, gradually be-come involved in the classiﬁcation, so that the CAM of the manipulated image identiﬁes more regions of the object. Fig-ure 1(d) shows examples of CAMs obtained by applying this manipulation technique iteratively.
Ascending the gradient ensures that classiﬁcation score increases, but the repetitive ascending may cause irrelevant areas, such as parts of the backgrounds or regions of other objects, to be activated together or the attribution scores of some part of the target object to be increased dramatically.
We can address these problems by introducing regularization terms that suppress the scores of other classes and limit the attribution scores of the regions that already have high scores.
The attribution maps obtained from images that have been iteratively manipulated in this way can be used as pseudo ground-truth masks to train a semantic segmentation network in a weakly and semi-supervised manner.
Our method is a post-hoc analysis of the trained classiﬁer, and can be used to improve the performance of existing methods without modiﬁcation, resulting in new state-of-the-art performance on the PASCAL VOC 2012 benchmark in both weakly and semi-supervised semantic segmentation.
The main contributions of this paper are three-fold:
• We propose AdvCAM, an attribution map of an image that is manipulated to increase the classiﬁcation score, allowing it to identify more regions of an object.
• We empirically demonstrate that our method improves the performance of several methods of weakly super-vised semantic segmentation without modiﬁcation or re-training of their networks.
• Our technique produces signiﬁcantly better perfor-mance on the Pascal VOC 2012 benchmark than ex-isting methods, in both weakly and semi-supervised semantic segmentation. 2.