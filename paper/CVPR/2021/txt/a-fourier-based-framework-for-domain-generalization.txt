Abstract
Modern deep neural networks suffer from performance degradation when evaluated on testing data under differ-ent distributions from training data. Domain generaliza-tion aims at tackling this problem by learning transferable knowledge from multiple source domains in order to gen-eralize to unseen target domains. This paper introduces a novel Fourier-based perspective for domain generaliza-tion. The main assumption is that the Fourier phase in-formation contains high-level semantics and is not easily affected by domain shifts. To force the model to capture phase information, we develop a novel Fourier-based data augmentation strategy called amplitude mix which linearly interpolates between the amplitude spectrums of two im-ages. A dual-formed consistency loss called co-teacher reg-ularization is further introduced between the predictions in-duced from original and augmented images. Extensive ex-periments on three benchmarks have demonstrated that the proposed method is able to achieve state-of-the-arts perfor-mance for domain generalization. 1.

Introduction
Over the past few years, deep learning have made tremendous progress on various tasks. Under the assump-tion that training and testing data share the same distri-bution, deep neural networks (DNNs) have shown great promise for a wide spectrum of applications [18, 10, 12].
However, DNNs have demonstrated quite poor generaliz-ability for out-of-distribution data. Such performance de-generation caused by distributional shift (a.k.a. domain shift) impairs the applications of DNNs, as in reality train-ing and testing data often come from different distributions.
In order to address the problem of domain shift, domain adaptation (DA) bridges the gap between source domain(s) and a speciﬁc target domain with the help of some labelled or unlabeled target data. However, DA methods fail to gen-eralize to unknown target domains that have not been seen (a) (b) (c)
Figure 1. Examples of the amplitude-only and phase-only recon-struction: (a) original image; (b) reconstructed image with ampli-tude information only by setting the phase component to a con-stant; (c) reconstructed image with phase information only by set-ting the amplitude component to a constant. during training. Collecting data from every possible target domain and training DA models with every source-target pair are expensive and impractical. As a result, a more chal-lenging yet practical problem setting, i.e., domain general-ization (DG) [29, 20] is proposed. Unlike DA, DG aims to train model with multiple source domains that can gener-alize to arbitrary unseen target domains. To tackle the DG problem, many existing methods utilize adversarial train-ing [24, 23, 38], meta learning [21, 1, 25, 4], self-supervised learning [2] or domain augmentation [44, 37, 50, 51] tech-niques and have shown promising results.
In this paper, we introduce a novel Fourier-based per-spective for DG. Our motivation comes from a well-known property of the Fourier transformation: the phase compo-nent of Fourier spectrum preserves high-level semantics of the original signal, while the amplitude component contains low-level statistics [32, 33, 35, 11]. For better understand-ing, we present an example of the images reconstructed from only amplitude information and only phase informa-tion, as well as the corresponding original image in Fig. 1.
As shown in Fig. 1(c), the phase-only reconstruction reveals the important visual structures, from which one can eas-ily recognize the “house” conveyed in the original image.
On the other hand, it is hard to tell the exact object from the amplitude-only reconstruction in Fig. 1(b). Based on 14383
these observations, Yang et al. [48] have recently developed a Fourier-based method for DA. They propose a simple im-age translation strategy by replacing the amplitude spectrum of a source image with that of a random target image. By simply training on the amplitude-transferred source images, their method achieves a remarkable performance.
Inspired by the above work, we further explore Fourier-based methods for domain generalization and introduce a
Fourier Augmented Co-Teacher (FACT) framework, which consists of an implicit constraint induced by Fourier-based data augmentation and an explicit constraint in terms of co-teacher regularization, as shown in Fig. 2. 1) Fourier-based data augmentation. Since the phase information is known for carrying the essential features to deﬁne an object, it is reasonable to assume that by learning more from the phase information, the model can better extract the semantic con-cepts of different objects that are robust to domain shifts.
However, when dealing with DG, we have no access to the target domain, thus the amplitude transfer strategy as [48] is not applicable. To overcome this, we propose to augment the training data by distorting the amplitude information while keeping the phase information unchanged. Speciﬁ-cally, a linear interpolation strategy similar to MixUp [49] is adopted to generate augmented images. But instead of the whole images, only the amplitude of the images are mixed. Through this Fourier-based data augmentation, our model can avoid overﬁtting to low-level statistics carried in the amplitude information, thus pay more attention on the phase information when making decisions. 2) Co-teacher regularization. In addition to the above implicit constraint induced by Fourier-based data augmentation, we further in-troduce an explicit constraint to force the model to maintain the predicted class relationships between the original im-age and its amplitude-perturbed counterpart. This explicit constraint is designed in a form of dual consistency regular-ization equipped with a momentum-updated teacher [41].
Through the co-teacher regularization, the model is further constrained to focus on the invariant phase information in order to minimize the prediction discrepancy between orig-inal and augmented images.
We validate the effectiveness of FACT on three do-main generalization benchmarks, namely Digits-DG [50],
PACS [20], and OfﬁceHome [42]. Extensive experimental results have shown that FACT outperforms several state-of-the-arts DG methods with regards to its capability to gen-eralize to unseen domains, indicating that learning more from the phase information does help model generalize bet-ter across domains. We further carry out detailed ablation studies to show the superiority of our framework design. We also conduct an in-depth analysis about the rationales be-hind our hypothesis and method, which demonstrates that the visual structures in phase information contain rich se-mantics and our model can learn efﬁciently from them. 2.