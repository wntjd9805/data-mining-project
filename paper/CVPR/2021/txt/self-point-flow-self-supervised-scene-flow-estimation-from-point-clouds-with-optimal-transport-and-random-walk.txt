Abstract
Due to the scarcity of annotated scene ﬂow data, self-supervised scene ﬂow learning in point clouds has attracted increasing attention. In the self-supervised manner, estab-lishing correspondences between two point clouds to ap-proximate scene ﬂow is an effective approach. Previous methods often obtain correspondences by applying point-wise matching that only takes the distance on 3D point co-ordinates into account, introducing two critical issues: (1) it overlooks other discriminative measures, such as color and surface normal, which often bring fruitful clues for ac-curate matching; and (2) it often generates sub-par perfor-mance, as the matching is operated in an unconstrained situation, where multiple points can be ended up with the same corresponding point. To address the issues, we for-mulate this matching task as an optimal transport problem.
The output optimal assignment matrix can be utilized to guide the generation of pseudo ground truth. In this opti-mal transport, we design the transport cost by considering multiple descriptors and encourage one-to-one matching by mass equality constraints. Also, constructing a graph on the points, a random walk module is introduced to encourage the local consistency of the pseudo labels. Comprehensive experiments on FlyingThings3D and KITTI show that our method achieves state-of-the-art performance among self-supervised learning methods. Our self-supervised method even performs on par with some supervised learning ap-proaches, although we do not need any ground truth ﬂow for training. 1.

Introduction
Scene ﬂow estimation aims to obtain a 3D vector ﬁeld of points in dynamic scenes, and describes the motion state of each point. Recently, with the popularity of 3D sensors
∗Corresponding author: G. Lin. (e-mail: gslin@ntu.edu.sg )
Figure 1.
Pseudo ground truth between two point clouds pro-duced by different methods. The green line represents the correct pseudo ground truth whose relative error is less than 10%. The red line represents the wrong pseudo ground truth. (a) pseudo ground truth produced by nearest neighbor search with only 3D point coordinate as measure; (b) pseudo ground truth produced by our optimal transport module; (c) pseudo ground truth produced by our optimal transport module and then reﬁned by our random walk module; (d) ground truth. and the great success of deep learning in 3D point cloud tasks, directly estimating the scene ﬂow from point clouds by deep neural networks (DNNs) is an active research topic.
DNNs are data-driven, and the supervised training of DNNs requires a large amount of training data with ground truth labels. However, for the scene ﬂow estimation task, no sen-sor can capture optical ﬂow ground truth in complex envi-ronments [19], which makes real-world scene ﬂow ground truth hard to obtain. Due to the scarcity of the ground truth data, recent deep learning based point cloud scene ﬂow es-timation methods [14, 7, 38, 23] turn to synthetic data, e.g. the FlyingThings3D dataset [18], for supervised training.
However, the domain gap between synthetic data and real-istic data is much likely to make the trained models perform poorly in real-world scenes. 15577
To circumvent the dependence on expensive ground truth data, we target self-supervised scene ﬂow estimation from point clouds. Mittal et al. [21] and Wu et al. [38] make the
ﬁrst attempt. These methods search for the closest point in the other point cloud as the corresponding point and use the coordinate difference between each correspondence to ap-proximate the ground truth scene ﬂow. Although achieving promising performance, two issues exist in these methods: (1) searching for correspondences relies only on 3D point coordinates but ignores other measures, such as color and surface normal, which often bring fruitful clues for accu-rate matching; and (2) the unconstrained search may lead to a degenerated solution, where multiple points match with the same point in the other point cloud, i.e. a many-to-one problem. An example of nearest neighbor search is shown in Fig. 1(a).
In this paper, we assume that an object’s geometric struc-ture and appearance remain unchanged as it moves and the correct corresponding points could be found in its neigh-borhood. Thus, when searching for point correspondences, we adopt 3D point coordinate, surface normal, and color as measures and encourage each point to be matched with a unique one in the next frame, i.e. one-to-one matching.
Naturally, the searching problem can be formulated as an optimal transportation [22], where the transport cost is de-ﬁned on the three measures, the mass equality constraints are built to encourage one-to-one matching, and the pro-duced optimal assignment matrix indicates the optimal cor-respondences between the two point clouds. Removing some invalid correspondences with far distance, the coor-dinate differences between valid correspondences can be treated as the pseudo ground truth ﬂow vectors for training.
Neighboring points in an object often share a similar movement pattern. However, the optimal transport mod-ule generates pseudo labels by point-wise matching without considering the local relations among neighboring points, resulting in conﬂicting pseudo labels in each local region, as shown in Fig. 1(b). To address this issue, we introduce a random walk module to reﬁne the pseudo labels by encour-aging local consistency. Viewing each point as a node, we build a graph on the point cloud to propagate and smooth pseudo labels. Speciﬁcally, we apply the random walk al-gorithm [16] in the graph. Using distance on 3D point coor-dinates as a measure, we build an afﬁnity matrix to describe the similarity between two nodes.
In the afﬁnity matrix, closer nodes will be assigned a higher score to ensure local consistency. Normalizing the afﬁnity matrix, we acquire the random walk transition matrix to guide the propagation among the nodes. Through the propagation on the graph, we obtain locally consistent pseudo scene ﬂow labels for scene ﬂow learning.
Our main contributions can be summarized as follows:
• We propose a novel self-supervised scene ﬂow learn-ing method in point clouds (Self-Point-Flow) to gen-erate pseudo labels by point matching and perform pseudo label reﬁnement by encouraging the local con-sistency of the pseudo labels;
• Converting the pseudo label generation problem into a point matching task, we propose an optimal trans-port module for pseudo label generation by consid-ering multiple clues (3D coordinates, colors and sur-face normals) and explicitly encouraging one-to-one matching;
• Neighboring points in an object often share a simi-lar movement pattern. Building a graph on the point cloud, we propose a random walk module to reﬁne the pseudo labels by encouraging local consistency.
• Our proposed Self-Point-Flow achieves state-of-the-art performance among self-supervised learning meth-ods. Our self-supervised method even performs on par with some supervised learning approaches, although we do not need any ground truth ﬂow for training. 2.