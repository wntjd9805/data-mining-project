Abstract
Anomaly detection in video is a challenging computer vi-sion problem. Due to the lack of anomalous events at train-ing time, anomaly detection requires the design of learn-In this paper, we ing methods without full supervision. approach anomalous event detection in video through self-supervised and multi-task learning at the object level. We
ﬁrst utilize a pre-trained detector to detect objects. Then, we train a 3D convolutional neural network to produce dis-criminative anomaly-speciﬁc information by jointly learn-ing multiple proxy tasks: three self-supervised and one based on knowledge distillation. The self-supervised tasks are: (i) discrimination of forward/backward moving ob-jects (arrow of time), (ii) discrimination of objects in con-secutive/intermittent frames (motion irregularity) and (iii) reconstruction of object-speciﬁc appearance information.
The knowledge distillation task takes into account both classiﬁcation and detection information, generating large prediction discrepancies between teacher and student mod-els when anomalies occur. To the best of our knowledge, we are the ﬁrst to approach anomalous event detection in video as a multi-task learning problem, integrating multi-ple self-supervised and knowledge distillation proxy tasks in a single architecture. Our lightweight architecture out-performs the state-of-the-art methods on three benchmarks:
Avenue, ShanghaiTech and UCSD Ped2. Additionally, we perform an ablation study demonstrating the importance of integrating self-supervised learning and normality-speciﬁc distillation in a multi-task learning setting. 1.

Introduction
In recent years, a growing interest has been dedicated to the task of detecting anomalous events in video [8, 9, 10, 13, 17, 19, 20, 24, 30, 34, 35, 36, 37, 38, 39, 49, 51, 55, 57, 61, 62, 63]. An anomalous event is commonly deﬁned as an unfamiliar or unexpected event in a given context. For ex-ample, a person crossing the road can be viewed as anoma-lous if the event does not happen on the crosswalk. This example shows that context plays a key role in the deﬁni-tion of anomalous events and, consequently, in the problem formulation. Indeed, the reliance on context, coupled with the large variety of unexpected events, makes it extremely difﬁcult to collect anomalous events for training. Hence, the anomaly detection problem is typically regarded as an outlier detection task. Then, a normality model is ﬁt on normal training data, labeling events that deviate from the model as anomalous. Without being able to employ stan-dard supervision, researchers have proposed alternative ap-proaches ranging from distance-based [17, 19, 37, 38, 40, 44, 45, 46, 47, 50, 52, 59] and reconstruction-based strate-gies [5, 13, 14, 27, 29, 31, 34, 36, 41, 51, 53] to probabilistic
[1, 2, 4, 12, 16, 21, 32, 33, 58] and change detection meth-ods [7, 18, 28, 35].
In lieu of learning to discriminate directly between nor-mal and anomalous events, related methods approach a dif-ferent yet connected task. For example, in the pioneering work of Liu et al. [27], a neural network learns to predict future video frames. During inference, an event is labeled as anomalous if the predicted future frame exhibits a high reconstruction error. Although the state-of-the-art meth-ods attain impressive results, addressing anomaly detection through a single proxy task is suboptimal, since the proxy task is not well aligned with anomaly detection. For in-stance, a car stopped in a pedestrian area should be labeled as an anomaly, yet the car is trivial to reconstruct in a future frame (since it is standing still). We therefore propose to perform anomaly detection by training a model jointly on multiple proxy tasks. Following a series of recent methods
[9, 10, 17, 61], we also employ an object detector, subse-quently performing anomaly detection at the object level.
However, these recent methods take into account a single proxy task. Different from [9, 10, 17, 61], we propose a novel anomaly detection approach that jointly learns a set of multiple proxy tasks through a single object-centric ar-chitecture.
As discussed above, we devise an object-centric ap-proach comprising a 3D convolutional neural network (CNN) that jointly learns the following proxy tasks: (i) predicting the arrow of time (discriminating between for-ward and backward moving objects), (ii) predicting the ir-regularity of motion (discriminating between objects cap-12742
Figure 1. Our anomaly detection framework based on self-supervised and multi-task learning. First, we detect the objects in video with the help of an object detector (YOLOv3). For each object, we devise three self-supervised tasks (learning the arrow of time, predicting motion irregularity and predicting the object appearance in the middle box) and a knowledge distillation task (using YOLOv3 and ResNet-50 as teachers). A 3D convolutional neural network is trained jointly on the four tasks. Models represented with dashed lines are pre-trained.
Best viewed in color. tured in consecutive frames versus objects captured in inter-mittent frames), (iii) reconstructing the appearance of ob-jects (given their appearance in preceding and succeeding frames), (iv) estimating normality-speciﬁc class probabili-ties by distilling pre-trained classiﬁcation (ImageNet [43]) and detection (MS COCO [26]) teachers. To jointly address these self-supervised and knowledge distillation tasks, we integrate a prediction head for each corresponding task, as illustrated in Figure 1. To our knowledge, we are the ﬁrst to propose a multi-task learning approach that integrates a set of novel self-supervised and knowledge distillation proxy tasks in a single object-centric architecture for anomaly de-tection in video.
We perform comprehensive experiments on three bench-marks, namely Avenue [29], ShanghaiTech [31] and UCSD
Ped2 [32]. Our approach outperforms the state-of-the-art methods [7, 8, 9, 10, 13, 14, 16, 17, 18, 19, 20, 21, 23, 24, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38, 40, 41, 47, 48, 49, 51, 53, 55, 57, 59, 60, 61, 62, 64] on all three data sets, achieving frame-level AUC scores of 92.8% on Av-enue, 90.2% on ShanghaiTech and 99.8% on UCSD Ped2.
Additionally, we present empirical evidence conﬁrming that a jointly optimized model on the proposed proxy tasks out-performs single models optimized on individual tasks, thus indicating that modeling anomaly detection through a single proxy task is suboptimal.
In summary, our contribution is multifold:
• We introduce learning the arrow of time as a proxy task for anomaly detection.
• We introduce motion irregularity prediction as a proxy task for anomaly detection.
• We introduce model distillation as a proxy task for anomaly detection in video.
• We pose anomaly detection in video as a multi-task learning problem, integrating multiple self-supervised and knowledge distillation tasks into a single model.
• We conduct experiments showing that our approach at-tains superior results compared to the state-of-the-art methods on three benchmarks. 12743
2.