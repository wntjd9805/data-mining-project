Abstract
Domain generalizable (DG) person re-identiﬁcation (ReID) is a challenging problem because we cannot ac-cess any unseen target domain data during training. Almost all the existing DG ReID methods follow the same pipeline where they use a hybrid dataset from multiple source do-mains for training, and then directly apply the trained model to the unseen target domains for testing. These meth-ods often neglect individual source domains’ discriminative characteristics and their relevances w.r.t. the unseen target domains, though both of which can be leveraged to help the model’s generalization. To handle the above two issues, we propose a novel method called the relevance-aware mixture of experts (RaMoE), using an effective voting-based mix-ture mechanism to dynamically leverage source domains’ diverse characteristics to improve the model’s generaliza-tion. Speciﬁcally, we propose a decorrelation loss to make the source domain networks (experts) keep the diversity and discriminability of individual domains’ characteristics. Be-sides, we design a voting network to adaptively integrate all the experts’ features into the more generalizable ag-gregated features with domain relevance. Considering the target domains’ invisibility during training, we propose a novel learning-to-learn algorithm combined with our rela-tion alignment loss to update the voting network. Extensive experiments demonstrate that our proposed RaMoE outper-forms the state-of-the-art methods. 1.

Introduction
In recent years, the research on person re-identiﬁcation (ReID) has been appealing to academia and industry. The goal of ReID is to identify a person across different camera views. Many works on fully supervised ReID [48, 27, 8] have achieved quite promising performances when train-*Corresponding Author.
Figure 1. Differences between our method and the conventional
DG ReID pipeline. (a) Conventional DG ReID methods gener-ally train a single model on the hybrid dataset from multi-source domains and then apply the trained model to the unseen target domain for testing, which neglects individual domains’ discrim-inative characteristics and target domain’s relevance w.r.t. source domains. (b) Our method leverages the complementary informa-tion provided by all the source domain networks (also termed as
“domain experts”). In testing, we integrate features obtained by source domain experts into an adaptive voting process based on the unseen target domain’s relevance w.r.t. source domains. ing and testing under the same domain (dataset). However, when applying these well-trained ReID models to other do-mains, the performance often drops signiﬁcantly because of the domain biases [52]. To tackle this problem, some researchers have studied unsupervised domain adaptation (UDA) methods [65, 15, 57, 16, 6, 10], which utilize the un-labeled target data to ﬁnetune and adapt the source-trained model to the target domain. However, existing UDA ReID methods are often not powerful enough to deal with prac-tical application scenarios, because it is sometimes hard to collect target domain training data and time-consuming to
ﬁnetune the model on these unlabeled samples. As a result, domain generalizable (DG) ReID [45, 29, 30] has been ap-pealing to researchers recently. Generally, DG ReID meth-ods utilize labeled data from multiple source domains to learn a generalizable model for new unseen target domains, 16145
without using any target domain data for training. To obtain more generalizable models for unseen target domains, we are devoted to the problem of DG ReID in this paper.
Almost all the existing DG ReID methods [45, 29, 30] follow the same pipeline, where they collect all source do-main data into a hybrid dataset and train a single model on it, as shown in Fig. 1 (a). During testing, they usually use the same well-trained model to extract features for any un-seen target domain. However, there can be two potential problems in such a pipeline: (1) They learn a common fea-ture space for different domains, which may neglect individ-ual domains’ discriminative characteristics. Such diverse domain-speciﬁc characteristics have been shown to be able to provide complementary information for better general-ization on target domains, as mentioned in [13, 21, 67]. (2)
Conventional DG ReID methods often ignore the speciﬁc target domain’s inherent relevance w.r.t. different source domains. They are difﬁcult to generalize the model to the unseen target domain because the model trained on the more relevant source domains can provide more discriminative and meaningful information than those less relevant do-mains. However, such relevance is often not explicitly con-sidered by existing works [45, 29, 30].
Recently, works [44, 21] on the mixture of experts [28] (MoE) show that MoE can improve the overall model’s ca-pability by mixing multiple networks (i.e., leveraging ex-pterts’ complementary information) with a voting proce-dure. Inspired by this, we propose a novel approach called
Relevance-aware Mixture of Experts (RaMoE), as shown in Fig. 1 (b), to handle the above two issues (i.e., comple-mentary information and domain relevance). We argue that, instead of learning a single model on the hybrid domains, we can train a domain-speciﬁc network (domain expert) for each source domain to exploit individual domains’ discrimi-native and powerful characteristics. Thus, these domain ex-perts’ mixture can keep source domains’ diversity and pro-vide rich complementary information, improving the gener-alization on target domains. Subsequently, we propose an adaptive voting network to calculate the unseen target do-main’s relevance w.r.t. all source domains. Based on the domain relevance, we can adaptively integrate those source experts’ features into the aggregated features by voting. The voting network will assign the more relevant domain experts with higher weights. Thus, those more relevant experts will provide more complementary information to improve the aggregated features’ generalizability on the target domain.
Speciﬁcally, in our RaMoE method, we propose a decor-relation loss to encourage source domain experts to keep their domains’ diverse characteristics, and thus they can provide complementary and discriminative information.
Such a decorrelation loss is implemented by minimizing the correlation among the source domain experts because the lower correlation among experts will bring about more com-plementary information, as mentioned in [2, 41]. Because the target domain is totally unseen during training in DG
ReID, it is challenging for the adaptive voting network to well learn the target domain’s correct relevance w.r.t. source domains. Inspired by meta-learning (learning-to-learn) that can improve the model’s generalization [32, 12, 23] for the unseen target domains in an episodic training paradigm, we propose a novel learning-to-learn algorithm to learn our adaptive voting network. At the beginning of each episodic training iteration, we randomly split source domains into the meta-train (simulated “source domains”) and the meta-test (simulated “unseen target domains”) to simulate the adaptive voting procedure for the unseen target domain.
During each episodic training iteration, the meta-test ﬁrst obtains the relevance w.r.t. the meta-train using the adap-tive voting network. The meta-test can then get two kinds of features: one is the features extracted by the meta-test domain expert, and the other is the aggregated features inte-grated from multiple meta-train domain experts with the rel-evance. We propose the relation alignment loss to push the aggregated features to be as discriminative as the features extracted by the meta-test expert. As a result, our RaMoE method can generate very discriminative and generalizable aggregated features for the unseen target domains by adap-tively integrating diverse domain experts with the domain relevance.
Our major contributions can be summarized as follows: (1) We propose a novel RaMoE method to tackle the prob-lem of DG ReID by exploiting source domains’ comple-the unseen mentary information and their relevance w.r.t. target domain. (2) We propose the decorrelation loss to keep source domains’ diversity and encourage source domain ex-perts to provide more complementary and discriminative in-formation. (3) To make the model more generalizable to target domains, we propose a voting network to adaptively integrate source domain experts’ features into the aggre-gated features. Specially, the adaptive voting network is up-dated with the relation alignment loss in a novel learning-to-learn way. (4) Extensive experiments demonstrate that our method outperforms state-of-the-art DG ReID approaches by a large margin.
To the best of our knowledge, this is the ﬁrst work that treats DG ReID as a novel mixture-of-experts paradigm via an effective voting-based mixture mechanism. 2.