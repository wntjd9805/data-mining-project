Abstract
Few-shot object detection is an imperative and long-lasting problem due to the inherent long-tail distribution of real-world data. Its performance is largely affected by the data scarcity of novel classes. But the semantic rela-tion between the novel classes and the base classes is con-stant regardless of the data availability. In this work, we investigate utilizing this semantic relation together with the visual information and introduce explicit relation reason-ing into the learning of novel object detection. Speciﬁcally, we represent each class concept by a semantic embedding learned from a large corpus of text. The detector is trained to project the image representations of objects into this em-bedding space. We also identify the problems of trivially us-ing the raw embeddings with a heuristic knowledge graph and propose to augment the embeddings with a dynamic relation graph. As a result, our few-shot detector, termed
SRR-FSD, is robust and stable to the variation of shots of novel objects. Experiments show that SRR-FSD can achieve competitive results at higher shots, and more importantly, a signiﬁcantly better performance given both lower explicit and implicit shots. The benchmark protocol with implicit shots removed from the pretrained classiﬁcation dataset can serve as a more realistic setting for future research. 1.

Introduction
Deep learning algorithms usually require a large amount of annotated data to achieve superior performance. To ac-quire enough annotated data, one common way is by col-lecting abundant samples from the real world and paying annotators to generate ground-truth labels. However, even if all the data samples are well annotated based on our re-quirements, we still face the problem of few-shot learning.
Because long-tail distribution is an inherent characteristic of the real world, there always exist some rare cases that have just a few samples available, such as rare animals, un-In other words, we are unable common road conditions. to alleviate the situation of scarce cases by simply spend-ing more money on annotation even big data is accessible.
Figure 1. FSOD performance (mAP50) on VOC [13] Novel Set 1 at different shot numbers. Solid line (original) means the pre-trained model used for initializing the detector backbone is trained on the original ImageNet [10]. Dashed line (rm-nov) means classes in Novel Set 1 are removed from the ImageNet for the pretrained backbone model. Our SRR-FSD is more stable to the variation of explicit shots (x-axis) and implicit shots (original vs. rm-nov).
Therefore, the study of few-shot learning is an imperative and long-lasting task.
Recently, efforts have been put into the study of few-shot object detection (FSOD) [5, 20, 11, 19, 44, 41, 14, 46, 39, 42, 43].
In FSOD, there are base classes in which sufﬁ-cient objects are annotated with bounding boxes and novel classes in which very few labeled objects are available. The novel class set does not share common classes with the base class set. The few-shot detectors are expected to learn from limited data in novel classes with the aid of abundant data in base classes and to be able to detect all novel objects in a held-out testing set. To achieve this, most recent few-shot detection methods adopt the ideas from meta-learning and metric learning for few-shot recognition and apply them to conventional detection frameworks, e.g. Faster R-CNN
[35], YOLO [34].
Although recent FSOD methods have improved the base-8782
Few-Shot Detection
Motivation
Base Classes (many)
Carnegie Mellon
Novel Classes (few) bicycle person mbike bottle
Semantic Relations: 
Bicycle looks similar to mbike.
Person can interact with bicycle.
Bicycle can carry a bottle.
Figure 2. Key insight: the semantic relation between base and novel classes is constant regardless of the data availability of novel classes, which can aid the learning together with visual informa-tion. line considerably, data scarcity is still a bottleneck that hurts the detector’s generalization from a few samples. In other words, the performance is very sensitive to the number of both explicit and implicit shots and drops drastically as data becomes limited. The explicit shots refer to the available labeled objects from the novel classes. For example, the 1-shot performance of some FSOD methods is less than half of the 5-shot or 10-shot performance, as shown in Figure 1. In terms of implicit shots, initializing the backbone net-work with a model pretrained on a large-scale image clas-siﬁcation dataset is a common practice for training an ob-ject detector. However, the classiﬁcation dataset contains many implicit shots of object classes overlapped with the novel classes. So the detector can have early access to novel classes and encode their knowledge in the parame-ters of the backbone. Removing those implicit shots from the pretrained dataset also has a negative impact on the per-formance as shown in Figure 1. The variation of explicit and implicit shots could potentially lead to system failure when dealing with extreme cases in the real world.
We believe the reason for shot sensitivity is due to exclu-sive dependence on the visual information. Novel objects are learned through images only and the learning is inde-pendent between classes. As a result, visual information becomes limited as image data becomes scarce. However, one thing remains constant regardless of the availability of visual information, i.e. the semantic relation between base and novel classes. For example in Figure 2, if we have the prior knowledge that the novel class “bicycle” looks similar to “motorbike”, can have interaction with “person”, and can carry a “bottle”, it would be easier to learn the concept “bi-cycle” than solely using a few images. Such explicit relation reasoning is even more crucial when visual information is hard to access [40].
So how can we introduce semantic relation to few-shot detection? In natural language processing, semantic con-cepts are represented by word embeddings [27, 31] from language models, which have been used in zero-shot learn-ing methods [40, 1]. And explicit relationships are repre-sented by knowledge graphs [28, 4], which are adopted by some zero-shot or few-shot recognition algorithms [40, 30].
However, these techniques are rarely explored in the FSOD task. Also, directly applying them to few-shot detectors leads to non-trivial practical problems, i.e. the domain gap between vision and language, and the heuristic deﬁnition of knowledge graph for classes in FSOD datasets (see Section 3.2 and 3.3 for details).
In this work, we explore the semantic relation for FSOD.
We propose a Semantic Relation Reasoning Few-Shot De-tector (SRR-FSD), which learns novel objects from both the visual information and the semantic relation in an end-to-end style. Speciﬁcally, we construct a semantic space us-ing the word embeddings. Guided by the word embeddings of the classes, the detector is trained to project the objects from the visual space to the semantic space and to align their image representations with the corresponding class embed-dings. To address the aforementioned problems, we pro-pose to learn a dynamic relation graph driven by the image data instead of pre-deﬁning one based on heuristics. Then the learned graph is used to perform relation reasoning and augment the raw embeddings for reduced domain gap.
With the help of the semantic relation reasoning, our
SRR-FSD demonstrates the shot-stable property in two as-pects, see the red solid and dashed lines in Figure 1. In the common few-shot settings (solid lines), SRR-FSD achieves competitive performance at higher shots and signiﬁcantly better performance at lower shots compared to state-of-the-art few-shot detectors. In a more realistic setting (dashed lines) where implicit shots of novel concepts are removed from the classiﬁcation dataset for the pretrained model,
SRR-FSD steadily maintains the performance while some previous methods have results degraded by a large margin due to the loss of implicit shots. We hope the suggested realistic setting can serve as a new benchmark protocol for future research.
We summarize our contributions as follows:
• To our knowledge, our work is the ﬁrst to investigate semantic relation reasoning for the few-shot detection task and show its potential to improve a strong base-line.
• Our SRR-FSD achieves stable performance w.r.t the shot variation, outperforming state-of-the-art FSOD methods under several existing settings especially when the novel class data is extremely limited.
• We suggest a more realistic FSOD setting in which im-plicit shots of novel classes are removed from the clas-siﬁcation dataset for the pretrained model, and show 8783
that our SRR-FSD can maintain a more steady perfor-mance compared to previous methods if using the new pretrained model. 2.