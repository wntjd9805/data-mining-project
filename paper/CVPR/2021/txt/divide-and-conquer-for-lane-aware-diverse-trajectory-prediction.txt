Abstract
Trajectory prediction is a safety-critical tool for au-tonomous vehicles to plan and execute actions. Our work addresses two key challenges in trajectory prediction, learn-ing multimodal outputs, and better predictions by imposing constraints using driving knowledge. Recent methods have achieved strong performances using Multi-Choice Learning objectives like winner-takes-all (WTA) or best-of-many. But the impact of those methods in learning diverse hypotheses is under-studied as such objectives highly depend on their ini-tialization for diversity. As our ﬁrst contribution, we propose a novel Divide-And-Conquer (DAC) approach that acts as a better initialization technique to WTA objective, resulting in diverse outputs without any spurious modes. Our sec-ond contribution is a novel trajectory prediction framework called ALAN that uses existing lane centerlines as anchors to provide trajectories constrained to the input lanes. Our framework provides multi-agent trajectory outputs in a for-ward pass by capturing interactions through hypercolumn descriptors and incorporating scene information in the form of rasterized images and per-agent lane anchors. Experi-ments on synthetic and real data show that the proposed
DAC captures the data distribution better compare to other
WTA family of objectives. Further, we show that our ALAN approach provides on par or better performance with SOTA methods evaluated on Nuscenes urban driving benchmark. 1.

Introduction
Prediction of diverse multimodal behaviors is a critical need to proactively make safe decisions for autonomous ve-hicles. A major challenge lies in predicting not only the most dominant modes but also accounting for the less dom-inant ones that might arise sporadically. Hence, there is need for models that can disentangle the plausible output space and provide diverse futures for any given number of samples. Further, a vast majority of actors execute socially acceptable maneuvers that adhere with the underlying scene structure. Predicting socially non-viable outputs can lead to
Figure 1: Depicts trajectory prediction problem in an inter-section scenario with possible lane anchors for agents shown as coloured dashed lines. unsafe planning decisions with some more dangerous than the others [7]. For example, a method that provides close enough predictions that does not follow road semantics is more dangerous compared to similar performing method that adheres to the scene structure.
Traditionally, generative models have been widely adapted to capture the uncertainties related to trajectory pre-diction problems [25, 22, 37, 21, 39]. However, generative methods may suffer from mode collapse issues, which re-duces their applicability for safety critical applications such as self-driving cars. Recent methods [32, 28] use Multi-Choice Learning objectives [26] like winner-takes-all (WTA) but suffer from instability associated with network initializa-tion [30, 34]. As a ﬁrst contribution, we propose a Divide and Conquer (DAC) approach that provides a better initial-ization to the WTA objective. Our method solves issues related to spurious modes where some hypotheses are either untrained in the training process, or reach equilibrium po-sitions that do not represent any part of the data. We show that the proposed DAC captures the data distribution better on both real and synthetic scenes with multi-modal ground truth, compared to baseline WTA objectives [30, 34]. 115799
Further, trajectory prediction methods incorporate driving knowledge using scene context either in the form of raster-ized images [25, 37, 39, 32, 33, 8] or by exploiting HD map data structure [28, 15] as inputs. Usually, this information is represented as a feature given as input to the network and does not guarantee strong semantic coupling. Our second contribution addresses this by proposing ALAN, a novel trajectory prediction framework that uses lane centerlines as anchors to predict trajectories (Figure 1). Our outputs provide accurate predictions with strong semantic alignment demonstrated by FDE and OffRoadRate values and validated using our qualitative visualizations.
Speciﬁcally, we use a single representational model [39] for multi-agent inputs and encode interactions through novel use of hypercolumn descriptors [2] that extracts information from features at multiple scales. Moreover, we transform the prediction problem to normal-tangential (nt) coordinates with respect to input lanes. This is critical in order to use lane centerlines as anchors. Further, we regularize anchor outputs through auxiliary xy predictions to make them less susceptible to bad anchors and rely on agent dynamics. Fi-nally, we rank our predictions through an Inverse Optimal
Control based ranking module [25].
In summary, our contributions are the following:
• A novel Divide and Conquer approach as a better initial-ization to WTA objective that captures data distribution without any spurious modes.
• A new anchor based trajectory prediction framework called ALAN that uses existing centerlines as anchors to provide context-aware outputs with strong semantic coupling.
• Strong empirical performance on the Nuscenes urban driving benchmark. 2.