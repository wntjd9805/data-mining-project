Abstract
Despite stereo matching accuracy has greatly improved by deep learning in the last few years, recovering sharp boundaries and high-resolution outputs efﬁciently remains challenging. In this paper, we propose Stereo Mixture Den-sity Networks (SMD-Nets), a simple yet effective learning framework compatible with a wide class of 2D and 3D architectures which ameliorates both issues. Speciﬁcally, we exploit bimodal mixture densities as output representa-tion and show that this allows for sharp and precise dis-parity estimates near discontinuities while explicitly mod-eling the aleatoric uncertainty inherent in the observations.
Moreover, we formulate disparity estimation as a continu-ous problem in the image domain, allowing our model to query disparities at arbitrary spatial precision. We carry out comprehensive experiments on a new high-resolution and highly realistic synthetic stereo dataset, consisting of stereo pairs at 8Mpx resolution, as well as on real-world stereo datasets. Our experiments demonstrate increased depth accuracy near object boundaries and prediction of ul-tra high-resolution disparity maps on standard GPUs. We demonstrate the ﬂexibility of our technique by improving the performance of a variety of stereo backbones. 1.

Introduction
Stereo matching is a long standing and active research topic in computer vision. It aims at recovering dense corre-spondences between image pairs by estimating the dispar-ity between matching pixels, required to infer depth through triangulation. It also plays a crucial role in many areas like 3D mapping, scene understanding and robotics.
Traditional stereo matching algorithms apply hand-crafted matching costs and engineered regularization strate-gies. More recently, learning methods based on Convolu-tional Neural Networks (CNNs) have proven to be supe-rior, given the increasing availability of large stereo datasets
∗Work done as intern at MPI-IS. (a) PSM [4] (b) PSM [4] + Ours
Figure 1: Point Cloud Comparison between the stereo net-work PSM [4] and our Stereo Mixture Density Network (SMD-Net) on the UnrealStereo4K dataset. Notice how
SMD-Net notably alleviates bleeding artifacts near object boundaries, resulting in more accurate 3D reconstructions.
[11, 10, 52]. Although such methods produce compelling results, two major issues remain unsolved: predicting accu-rate depth boundaries and generating high-resolution out-puts with limited memory and computation.
The ﬁrst issue is shown in Fig. 1a: As neural networks are smooth function approximators, they often poorly re-construct object boundaries, causing “bleeding” artifacts (i.e., ﬂying pixels) when converted to point clouds. These artifacts can be detrimental to subsequent applications such as 3D reconstruction or 3D object detection. Thus, while being ignored by most commonly employed disparity met-rics, accurate 3D reconstruction of contours is a desirable property for any stereo matching algorithm. 8942
Furthermore, existing methods are limited to discrete predictions at pixel locations of a ﬁxed resolution image grid, while geometry is a piecewise continuous quantity where object boundaries may not align with pixel centers.
Increasing the output resolution by adding extra upsampling layers partially addresses this problem as this leads to a sig-niﬁcant increase in memory and computation.
In this work, we address both issues. Our key contri-bution is to learn a representation that is precise at object boundaries and scales to high output resolutions. In partic-ular, we formulate the task as a continuous estimation prob-lem and exploit bimodal mixture densities [2] as output rep-resentation. Our simple formulation lets us (1) avoid bleed-ing artifacts at depth discontinuities, (2) regress disparity values at arbitrary spatial resolution with constant memory and (3) provides a measure for aleatoric uncertainty.
We illustrate the boundary bleeding problem and our so-lution to it in Fig. 2. While classical deep networks for stereo regression suffer from smoothness bias and are in-capable of representing sharp disparity discontinuities, the proposed Stereo Mixture Density Networks (SMD-Nets) ef-fectively address this issue. The key idea is to alter the output representation adopting a mixture distribution such that sharp discontinuities can be regressed despite the fact that the underlying neural networks are only able to make smooth predictions (note that all curves in Fig. 2b are indeed smooth while the predicted disparity is discontinuous).
Furthermore, the proposed model is capable of regress-ing disparity values at arbitrary continuous locations in the image, effectively solving a stereo super-resolution task. In combination with the proposed representation, this allows for regressing sharp discontinuities at sub-pixel resolution while keeping memory requirements constant.
In summary, we present: (i) A novel learning framework for stereo matching that exploits compactly parameterized bimodal mixture densities as output representation and can be trained using a simple likelihood-based loss function. (ii)
A continuous function formulation aimed at estimating dis-parities at arbitrary spatial resolution with constant mem-ory footprint. (iii) A new large-scale synthetic binocular stereo dataset with ground truth disparities at 3840 × 2160 resolution, comprising photo-realistic renderings of indoor and outdoor environments. (iv) Extensive experiments on several datasets demonstrating improved accuracy at depth discontinuities for various backbones on binocular stereo, monocular and active depth estimation tasks.
Our source code and dataset are available at https:
//github.com/fabiotosi92/SMD-Nets. 2.