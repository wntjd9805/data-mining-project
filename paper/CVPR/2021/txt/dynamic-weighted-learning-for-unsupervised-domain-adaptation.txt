Abstract
Unsupervised domain adaptation (UDA) aims to im-prove the classiﬁcation performance on an unlabeled tar-get domain by leveraging information from a fully la-beled source domain. Recent approaches explore domain-invariant and class-discriminant representations to tack-le this task. These methods, however, ignore the inter-action between domain alignment learning and class dis-crimination learning. As a result, the missing or inade-quate tradeoff between domain alignment and class dis-crimination are prone to the problem of negative trans-fer.
In this paper, we propose Dynamic Weighted Learn-ing (DWL) to avoid the discriminability vanishing problem caused by excessive alignment learning and domain mis-alignment problem caused by excessive discriminant learn-ing. Technically, DWL dynamically weights the learning losses of alignment and discriminability by introducing the degree of alignment and discriminability. Besides, the prob-lem of sample imbalance across domains is ﬁrst consid-ered in our work, and we solve the problem by weighing the samples to guarantee information balance across do-mains. Extensive experiments demonstrate that DWL has an excellent performance in several benchmark datasets.
Code is available at https://github.com/NiXiao-cqu/TransferLearning-dwl-cvpr2021. 1.

Introduction
Collecting a large number of labeled samples is a time-consuming and laborious task. To tackle these problem-s, many domain adaptation algorithms have been proposed
[18, 42, 28, 30, 17, 36]. Unsupervised/semi-supervised do-main adaptation applies the model learned in the labeled source domain to the unlabeled/partially labeled target do-main by alleviating the domain divergence.
In recent years, many domain adaptation methods com-bined with deep neural networks have achieved remark-able performance [23, 8, 2, 26, 19, 37], which explore deep models to reduce the domain shift between the training set (source domain) and the testing set (target domain). The mainstream approaches tend to learn domain-invariant rep-resentations. While class discriminability is also critical to domain adaptation. Many domain adaptation methods that explore the feature discriminability have been proposed re-cently [5, 16, 3, 43, 28]. Speciﬁcally, Li et al. [16] inves-tigates the discriminability by using a discriminability cri-terion based on Linear Discriminant Analysis (LDA). Deng et al. [5] forces the target structure to be discriminative by
[3] guaranteed introducing a clustering loss. Chen et al. the discriminability by restricting the value of the eigenval-ue. These methods are helpful to explore the discriminabil-ity of feature representations. However, they independent-ly consider the domain alignment and class discriminabil-ity of feature representations. In fact, excessive alignment will easily lead to the loss of discriminability, while the ex-cessive pursuit of discriminability will lead to the domain misalignment. Moreover, for different cross-domain data scenarios, the degree of alignment and discriminability is different. For data scenarios with a small distribution dis-crepancy between domains, the model should pay more at-tention to the learning of discriminability, while for tasks with a large distribution discrepancy, the model should pay more attention to the alignment of distributions. Further-more, the previous methods did not consider the problem of the imbalanced sample size of the two domains. On the whole, the domain with a large sample size is equivalen-t to having larger weight in the process of optimizing the model. Such imbalance easily leads to model bias during training and leads to poor alignment and discrimination. As a result, it is easy to cause negative transfer.
To address the above challenges, on the one hand, we propose dynamically weighted learning between domain alignment and class discriminability. This dynamic learning idea is scalable to most previous DA models. On the oth-er hand, we weight the samples according to the imbalance degree of the sample number of the two domains. Since the degree of alignment and discriminability will change with the iterative learning process, the degree of discriminability and alignment are monitored in real-time and fed back to the 15242
model during training. Before that, to avoid the model bias during training, we ﬁrst measure the degree of imbalance of the sample size of two domains universally and weight the samples according to the measurement results. The contri-butions are summarized as follows:
•
•
•
In this paper, we propose a dynamic weighted learning method (DWL) for unsupervised domain adaptation.
By monitoring the degree of alignment and discrim-inability in real-time, our method dynamically adjusts the weight of alignment learning and discriminability learning, so as to avoid excessive alignment or exces-sive pursuit of discriminability.
We put forward a sample weighting method to avoid the model bias during training caused by the imbal-anced sample size of the two domains.
Through the dynamic weighting mechanism, our method can be more universal and applicable to cross-domain data scenarios with various feature types and sample sizes. 2.