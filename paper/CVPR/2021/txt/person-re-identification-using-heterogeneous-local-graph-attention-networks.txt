Abstract
Recently, some methods have focused on learning local relation among parts of pedestrian images for person re-identiﬁcation (Re-ID), as it offers powerful representation capabilities. However, they only provide the intra-local re-lation among parts within single pedestrian image and ig-nore the inter-local relation among parts from different im-ages, which results in incomplete local relation information.
In this paper, we propose a novel deep graph model named
Heterogeneous Local Graph Attention Networks (HLGAT) to model the inter-local relation and the intra-local rela-tion in the completed local graph, simultaneously. Specif-ically, we ﬁrst construct the completed local graph using local features, and we resort to the attention mechanism to aggregate the local features in the learning process of inter-local relation and intra-local relation so as to empha-size the importance of different local features. As for the inter-local relation, we propose the attention regularization loss to constrain the attention weights based on the iden-tities of local features in order to describe the inter-local relation accurately. As for the intra-local relation, we pro-pose to inject the contextual information into the attention weights to consider structure information. Extensive exper-iments on Market-1501, CUHK03, DukeMTMC-reID and
MSMT17 demonstrate that the proposed HLGAT outper-forms the state-of-the-art methods. 1.

Introduction
Person re-identiﬁcation (Re-ID) [5, 22, 43, 51] aims to match the given person of interest in different scenarios. It is a challenging task due to various complex factors, such as illumination, body poses and viewpoints.
Learning discriminative and robust features is the main issue for person Re-ID. With the prosperity of Convolu-tional Neural Network (CNN), researchers learn deep fea-tures to improve the performance of person Re-ID. Some
∗Corresponding author. (a) (b)
Figure 1. (a) The existing methods focus on learning the intra-local relation among parts within single pedestrian image. (b) The proposed HLGAT constructs the completed local graph to model the inter-local relation and the intra-local relation, simultaneously.
The solid line indicates the inter-local edge, and the dotted line denotes the intra-local edge. methods [2, 4, 7, 53] design various deep models to ex-tract global features from entire pedestrian images. In or-der to mine local information from different body parts, some part-based methods [13, 27, 34, 42] are proposed to extract local features. Among them, direct partition strat-egy [1, 6, 21, 36, 44] is usually adopted to split feature maps or pedestrian images into several horizontal grids.
To locate accurate and meaningful body parts, some re-searchers [10,16,29,31,48] resort to human pose estimation or human paring techniques to process pedestrian images.
Recently, local relation information is exploited in sev-eral studies [12, 14, 26], where they compute relation maps based on the local similarity among feature maps, or aggre-gate local features to learn relation information from dif-ferent body parts. However, they only focus on the intra-local relation among parts within single pedestrian image as shown in Fig. 1(a), and ignore the inter-local relation among parts from different pedestrian images. This results in a lack of local relation information from these parts and weakens the representation capabilities of local features. Hence, it is important to take the inter-local relation into considera-tion, and properly integrate with the intra-local relation for person Re-ID.
In this paper, we propose a novel deep graph model 12136
named Heterogeneous Local Graph Attention Networks (HLGAT) for person Re-ID, where we construct a com-pleted local graph to model the inter-local relation and the intra-local relation, simultaneously. To this end, we re-gard the local features extracted from pedestrian images as the nodes of completed local graph, and design two types of edges to link the nodes, i.e., inter-local edge and intra-local edge as shown in Fig. 1(b). Concretely, we link the nodes belonging to different pedestrian images using the inter-local edges, and link the nodes belonging to the same pedestrian image using the intra-local edges.
In order to jointly learn the inter-local relation and the intra-local re-lation, we utilize the attention mechanism to aggregate the local features linked by the inter-local edges and the intra-local edges in the completed local graph simultaneously so as to enhance the representation capabilities of local fea-tures.
As for the inter-local relation, if the local features belong to the same identity, they possess high correlation and there-fore the attention weights should be large, otherwise small.
Correspondingly, we propose the attention regularization loss to constrain the attention weights in order to describe the inter-local relation accurately. Furthermore, we link the local features from the corresponding and adjacent parts of different pedestrian images using the inter-local edges, and differentiate them via the attention weights in the aggrega-tion process. As for the intra-local relation, we observe that the relation strength between two local features from the same pedestrian image enhances with the decrease of their spatial distance. Hence, we propose to inject the contextual information into the attention weights to consider structure information. Finally, we extract the aggregated local fea-tures from the completed local graph. In the test stage, we concatenate the aggregated local features to obtain discrim-inative features for person Re-ID.
Our contributions are summarized as follows: (1) We propose HLGAT to model the inter-local relation and the intra-local relation by constructing the completed local graph. (2) We propose the attention regularization loss to constrain the attention weights of inter-local edges to de-scribe the inter-local relation accurately, and meanwhile we inject the contextual information into the attention weights of intra-local edges to provide structure information of pedestrian. (3) Experimental results on four large-scale person Re-ID datasets including Market-1501, CUHK03,
DukeMTMC-reID and MSMT17 prove that the proposed
HLGAT exceeds state-of-the-art methods. 2.