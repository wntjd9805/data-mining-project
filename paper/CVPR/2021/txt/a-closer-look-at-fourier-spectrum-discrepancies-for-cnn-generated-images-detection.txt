Abstract
CNN-based generative modelling has evolved to produce synthetic images indistinguishable from real images in the
RGB pixel space. Recent works have observed that CNN-generated images share a systematic shortcoming in repli-cating high frequency Fourier spectrum decay attributes.
Furthermore, these works have successfully exploited this systematic shortcoming to detect CNN-generated images reporting up to 99% accuracy across multiple state-of-the-art GAN models.
In this work, we investigate the validity of assertions claiming that CNN-generated images are unable to achieve high frequency spectral decay consistency. We meticu-lously construct a counterexample space of high frequency spectral decay consistent CNN-generated images emerging from our handcrafted experiments using DCGAN, LSGAN,
WGAN-GP and StarGAN, where we empirically show that this frequency discrepancy can be avoided by a minor ar-chitecture change in the last upsampling operation. We subsequently use images from this counterexample space to successfully bypass the recently proposed forensics detector which leverages on high frequency Fourier spectrum decay attributes for CNN-generated image detection.
Through this study, we show that high frequency Fourier spectrum decay discrepancies are not inherent character-istics for existing CNN-based generative models—contrary to the belief of some existing work—, and such fea-to perform synthetic image de-tures are not robust tection. Our results prompt re-thinking of using high frequency Fourier spectrum decay attributes for CNN-generated image detection. Code and models are avail-able at https://keshik6.github.io/Fourier-Discrepancies-CNN-Detection/ 1.

Introduction
With serious concerns over Deepfakes being widely used for malicious purposes [18, 19, 30, 37, 2, 36, 9, 32], detec-tion of deepfake multimedia content has become an impor-tant research ﬁeld. With substantial improvement of CNN-based generative modelling in the recent years [22, 45, 23, 24, 21, 35, 8, 3, 46, 33, 27, 1, 4, 16, 38, 39], it is becom-ing more and more difﬁcult to assess the “fakeness” of such synthetic content in the RGB pixel space. 1.1. Fourier spectrum discrepancies in CNN  generated images
Recent research suggests that CNN-based generation methods are unable to reproduce high frequency distribu-tion of real images. Existing work tends to conclude that this incompetency is an intrinsic property of CNN-based generative models [12, 10, 25]. While Zhang et al. [44] and
Wang et al. [42] report that CNN generated images have frequency artifacts, Dzanic et al. [12] and Durall et al. [10] suggest spectrum discrepancies in high frequency: CNN-generated images at the highest frequencies do not decay as usually observed in real images (Figure 1). In particular,
• Dzanic et al. [12] analyze high frequency of real and deep network generated images, and conclude that
“deep network generated images share an observable, systematic shortcoming in replicating the attributes of these high-frequency modes”.
• Durall et al. [10] observe that “CNN based generative deep neural networks are failing to reproduce spectral distributions”, and “this effect is independent of the underlying architecture”.
• Dzanic et al. [12] take a step further and propose to exploit this frequency discrepancies for detection of deep network generated images, claiming an accuracy of up to 99.2% across multiple state-of-the-art GAN and VAE models.
Some works also propose different techniques to disguise these high frequency discrepancies via post-processing the deep network generated images [12, 25], or modifying the GAN training objective to avoid these dis-crepancies [10]. 7200
worked reasonably with RGB inputs [42, 5], with spec-tral discrepancies being observed, several works have pro-posed to use the corresponding Fourier representation to train these detectors [44, 13]. In particular, Frank et al. [13] showed that detectors using frequency domain yielded bet-ter results compared to using the RGB counterpart.
Though observations corresponding to distinguishable frequency footprints being left by CNN-generated images remained mostly qualitative, Dzanic et al. [12] and Durall et al. [10, 11] studied the spectral decay attributes and quan-tiﬁed this behaviour via averaging the power spectrum over frequencies radially to represent them as 1D information.
Through this, they observed high frequency spectral decay inconsistencies in CNN-generated images. Furthermore,
Dzanic et al. [12] proposed to use a simple KNN classi-ﬁer using high frequency spectral attributes (3 features ex-tracted per image) that surprisingly obtained very high ac-curacy in identifying synthetic images only with very small amount of training data. Similarly, Durall et al. [11] used the entire 1d-power spectrum (contains all frequency infor-mation) as features to perform detection using Logistic re-gression, SVM and K-means clustering algorithms. These detectors [12, 11] rely on the belief that high frequency de-cay discrepancies are intrinsic in CNN-generated images. 1.3. Our contributions
In this work, we take a closer look at the high frequency decay discrepancies in CNN-generated images. Analysis of CNN-generated images is a daunting task: a large num-ber of different architectures, algorithms and objective func-tions have been proposed to train generators. Instead, our study focuses on the last layer of the generators. Our jus-tiﬁcation is as follows. Based on Sampling Theorem [20], the frequency contents of the outputs of individual layers are limited by the sampling resolution of the corresponding outputs. As previous work has reported the discrepancies between real and CNN-generated images at the highest fre-quencies, we hypothesize that inner generator layers (which produce lower resolution outputs) are not directly responsi-ble for the high frequency discrepancies. Therefore, we fo-cus on the last upsampling layer of generative CNN models.
Due to our focus being localized at the last layer, we are able to pinpoint the component that is related to this discrepancy across multiple GAN loss functions, architec-tures, datasets and resolutions. Our candidate GANs are similar to Durall et al. [10]: DCGAN [34], LSGAN [31],
WGAN-GP [17] and we also extend to StarGAN [7]. Our experiments suggest that the frequency discrepancies can be largely avoided by simply modifying the feature map scal-ing of the last layer. Importantly, using the same training algorithms, objective functions and network architectures (except using a different scaling in the last layer) as in stan-dard GAN models, we are able to avoid the spectral dis-7201
Figure 1. The curves show the average azimuthal integration over the power spectrum. (See section 3). Top row shows the evalua-tion on DCGAN [34], LSGAN [31], WGAN-GP [17]. Note the discrepancies at the highest frequencies, the same as reported in recent works. Note also that these models use transpose convolu-tions. The bottom row shows the evaluation after replacing the last feature map scaling operation with nearest and bilinear interpola-tion methods. Refer to table 1 for experiment codes. All evaluation are done using CelebA [29] (128x128). We observe that spectral consistent GANs are obtained when using nearest and bilinear in-terpolation methods for the last feature map scaling operation.
It should be noted that the cause of this discrepancy1 has not been agreed upon. Zhang et al. [44] and Durall et al. [10] suggest that this discrepancy could be caused by transposed convolution. As transposed convolution is used throughout the generator architectures, it is difﬁcult to re-place them. Therefore, Durall et al. [10] propose spectral regularization to counteract this throughout the GAN train-ing. Meanwhile, Dzanic et al. [12] attribute this discrepancy to the linear dependencies in the spectrum of convolutional
ﬁlters [25], which hinder learning of high frequencies. 1.2. CNN generated Image Detectors
Many works have addressed the possibilities of creat-ing detectors to identify synthetic images apart from real images. Though synthetic image detectors (CNN-based) 1The terms spectral discrepancies and spectral inconsistency are used invariably where we refer to high frequency spectral decay discrepancies.
We also use the terms CNN-generated and synthetic invariably.
crepancies. Therefore, our work provides counterexamples to argue that high frequency discrepancies are not intrinsic for CNN-generated images. Furthermore, we are able to successfully bypass the synthetic image detector proposed by Dzanic et al. [12] with only such change in the last scal-ing step, showing that such approach may not be reliable for detection of deep network generated images. The key takeaway from our work is:
• High frequency spectral decay discrepancies are not intrinsic for CNN-generated images. Therefore, we urge re-thinking in using such features for CNN-generated image detection. 2.