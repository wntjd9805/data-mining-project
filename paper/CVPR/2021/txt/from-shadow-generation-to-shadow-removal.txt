Abstract
Shadow removal is a computer-vision task that aims to restore the image content in shadow regions. While al-most all recent shadow-removal methods require shadow-free images for training, in ECCV 2020 Le and Samaras introduces an innovative approach without this requirement by cropping patches with and without shadows from shadow images as training samples. However, it is still laborious and time-consuming to construct a large amount of such unpaired patches. In this paper, we propose a new G2R-ShadowNet which leverages shadow generation for weakly-supervised shadow removal by only using a set of shadow images and their corresponding shadow masks for train-ing. The proposed G2R-ShadowNet consists of three sub-networks for shadow generation, shadow removal and re-ﬁnement, respectively and they are jointly trained in an end-to-end fashion. In particular, the shadow generation sub-net stylises non-shadow regions to be shadow ones, lead-ing to paired data for training the shadow-removal sub-net.
Extensive experiments on the ISTD dataset and the Video
Shadow Removal dataset show that the proposed G2R-ShadowNet achieves competitive performances against the current state of the arts and outperforms Le and Samaras’ patch-based shadow-removal method. 1.

Introduction
Shadows are areas of darkness in a scene where the light is fully or partially occluded. Shadows are very common in natural images and might bring challenges to many exist-ing computer vision tasks [24, 12, 18, 14]. Shadow removal by restoring the image information in shadow regions have been a long studied research problem [2, 15, 27, 19, 40, 23] and has been shown to be beneﬁcial to improve the perfor-mance in various tasks.
Recently, with the use of the convolutional neural net-works (CNNs), many learning based shadow removal ap-proaches [25, 32, 9, 10, 16, 22, 20, 17] have been proposed,
*Co-corresponding authors. Code is available at https://github. com/hhqweasd/G2R-ShadowNet.
SR
Figure 1. An illustration of our basic idea of incorporating shadow generation for learning shadow removal by using only shadow im-ages. The pixels located in the pink and green boundaries of the input shadow image form the shadow and random non-shadow re-gions, respectively. The pink and green arrows stand for the mask-ing operation that only preserves the region with the value of 1 on the mask, while the orange and blue arrows represent the process of shadow generation and shadow removal, respectively. resulting in signiﬁcantly better performance than the tradi-tional ones [4, 8, 13, 38]. For most of them [25, 32, 9, 16] a set of paired shadow images and their corresponding shadow-free version are used to train the network in a fully-supervised manner. However, it is difﬁcult to capture and collect such paired image data in uncontrolled natural envi-ronment due to the illumination change from time to time. If we capture such data pairs in a controlled lab environment, limited scenarios might also weaken the generalisation abil-ity of the trained model.
To address these problems, recent researches [10, 22] start to explore unsupervised methods for shadow removal by using unpaired shadow and shadow-free images. How-ever, these unsupervised methods might introduce huge do-main gap between the shadow and shadow-free images in the training set. In addition, in practice, it is still difﬁcult to capture a large set of shadow-free images with good va-riety. To handle this problem, in their ECCV20 paper [17],
Le and Samaras introduces a novel unsupervised shadow removal method using only shadow images. More specif-ically, they leverage the fact that a shadow image usually contains both shadow and non-shadow regions. This way, a set of shadow and shadow-free patches can be cropped to 4927
construct unpaired data for network training. By cropping unpaired patches from the same images, their domain gap can also be well controlled.
Although the patch cropping in [17] only requires the shadow masks that can be obtained by using an exist-ing shadow detection method [43, 18, 41, 9, 33], it in-volves a careful design of cropping-window size, a set of strict physics-based constraints, and heavy computational load [17]. In this paper, we propose a new approach to ad-dress these problems by incorporating a shadow generation module, while keeping the desirable property of using only shadow images, as illustrated in Fig.1.
Speciﬁcally, we propose a new G2R-ShadowNet that consists of three sub-networks for shadow generation, shadow removal and reﬁnement, respectively. Given an input shadow image, the shadow-generation sub-net gen-erates pseudo shadows for each shadow-free region and such pseudo shadows are then paired with the correspond-ing original shadow-free region to form the training data.
After that, these constructed pair data are used to train the shadow removal sub-net to remove the generated shadows.
Finally, the shadow-removal results are reﬁned by leverag-ing the context information such that their colour and illu-mination are consistent with their surrounding areas. We conduct extensive experiments on the ISTD dataset and the
Video Shadow Removal dataset to demonstrate the effec-tiveness of our proposed method.
The main contributions of this work are as follows:
• We tackle the shadow removal task from a novel perspective of constructing paired shadow and non-shadow data using only the shadow images and the corresponding shadow masks.
• We develop G2R-ShadowNet, shadow-removal network, which consists of three sub-nets for shadow generation, shadow removal, and reﬁnement, respectively. G2R-ShadowNet is weakly-supervisedly trained in an end-to-end fashion. a novel
• We conduct extensive experiments on two public datasets and show that the proposed G2R-ShadowNet achieves competitive performances against the current state of the arts and outperforms Le and Samaras’ patch-based shadow-removal method. 2.