Abstract
The pancreatic disease taxonomy includes ten types of masses (tumors or cysts) [20, 8]. Previous work focuses on developing segmentation or classiﬁcation methods only for certain mass types. Differential diagnosis of all mass types is clinically highly desirable [20] but has not been investi-gated using an automated image understanding approach.
We exploit the feasibility to distinguish pancreatic duc-tal adenocarcinoma (PDAC) from the nine other nonPDAC masses using multi-phase CT imaging. Both image ap-pearance and the 3D organ-mass geometry relationship are critical. We propose a holistic segmentation-mesh-classiﬁcation network (SMCN) to provide patient-level di-agnosis, by fully utilizing the geometry and location infor-mation, which is accomplished by combining the anatom-ical structure and the semantic detection-by-segmentation network. SMCN learns the pancreas and mass segmentation task and builds an anatomical correspondence-aware organ mesh model by progressively deforming a pancreas proto-type on the raw segmentation mask (i.e., mask-to-mesh). A new graph-based residual convolutional network (Graph-ResNet), whose nodes fuse the information of the mesh model and feature vectors extracted from the segmentation network, is developed to produce the patient-level differen-tial classiﬁcation results. Extensive experiments on 661 pa-tients’ CT scans (ﬁve phases per patient) show that SMCN can improve the mass segmentation and detection accuracy compared to the strong baseline method nnUNet (e.g., for nonPDAC, Dice: 0.611 vs. 0.478; detection rate: 89% vs. 70%), achieve similar sensitivity and speciﬁcity in differ-entiating PDAC and nonPDAC as expert radiologists (i.e., 94% and 90%), and obtain results comparable to a mul-timodality test [20] that combines clinical, imaging, and molecular testing for clinical management of patients. 1.

Introduction
Pancreatic cancer is the third leading cause of cancer-related deaths in the United States [7]. Furthermore, it
∗equal contribution
Figure 1. Disease taxonomy of the ten types of pancreatic masses (tumors, cysts). Mass type diagnosis determines the clinical ma-lignancy indications that lead to the proper patient risk stratiﬁca-tion and management. The purple histogram bars represent their relative frequencies. All images are in the arterial-late CT phase. has the poorest prognosis among all solid malignancies, with a 5-year survival rate ∼ 10% [7, 2]. Early diagno-sis is crucial, as it can potentially increase the ﬁve-year survival rate to ∼ 50% [5]. The clinical management of patients with pancreatic disease is based on the potential of the mass to become an invasive cancer. Unlike masses in other organs, pancreatic masses often cannot be reached precisely via needle biopsy due to the pancreas’s deep loca-tion in the abdomen and the complex network of surround-ing organs and vessels. Therefore, reliable imaging-based diagnosis is critical to identifying patients who truly re-quire cancer treatment (e.g., surgery) in a timely fashion, while avoiding unnecessary iatrogenic morbidity. Develop-ing deep learning methods to detect masses, identify ma-113743
lignancies, provide diagnoses and predict cancer prognosis has the potential to revolutionize pancreatic cancer imaging
[4, 2, 8, 36, 27, 32, 30].
Multi-phase computed tomography (CT) is the ﬁrst-line imaging modality for the diagnosis of pancreatic diseases.
Differential diagnosis of pancreatic masses is challenging for several reasons. (1) The same type of mass may ap-pear in different textures, shapes, contrasts, and different (2) Pancreatic enhancement patterns across CT phases. ductal adenocarcinoma (PDAC) accounts for most cases in pancreatic cancer specialized hospitals, causing a long-tail problem. (3) Masses, at times, are surrounded by inﬂamed tissues and thus cannot be easily identiﬁed. The pancre-atic diseases in our database encompass ten types of masses (Fig. 1): PDAC, ampullary cancer (AC), bile duct cancer (DC), pancreatic neuroendocrine tumor (PNET), rare neo-plasm (RARE), solid pseudopapillary tumor (SPT), chronic pancreatitis (CP), intraductal papillary mucinous neoplasm (IPMN), mucinous cystic neoplasm (MCN), and serous cys-tic neoplasm (SCN). To this end, we develop anatomy-aware 3D deep graph networks to automatically segment, detect, and perform differential diagnosis of the underlying diseases.
We tackle two main problems with strong clinical in-dications: 1) PDAC versus nonPDAC differentiation and 2) clinical management of patients. PDAC is a unique group with the most dismal prognosis. Distinguishing
PDAC from nonPDACs is always the primary question to answer. Patient management includes three recommenda-tions: surgery, monitoring, and discharge (lower pannel in
Fig. 1) [20]. Patients with malignant masses require cancer treatment (e.g., surgery). Those with potentially malignant masses require surgery if they are invasive or high-grade dysplasias, or monitoring otherwise. Those with nonmalig-nant masses could be safely discharged. Fine-grained clas-siﬁcation of ten classes of masses using multi-phase CT is a very difﬁcult long-tail problem.
Existing automatic pancreatic mass image analysis
[34, 36, 33, 35, 27, 32] focus on segmentation methods of certain types of tumors or cysts and thus cannot exploit the full-spectrum taxonomy of pancreatic mass/disease di-agnoses. For pancreatic disease diagnosis, both texture and geometry cues are clinically useful. For instance, some types of masses appear at speciﬁc locations of the pan-creas: AC and DC appear only at the pancreas head while
MCN rarely appears at the head. Others spread over the entire pancreas, such as CP and IPMN. Additionally, some secondary signs of diseases are informative for diagnosis.
Parenchymal atrophy and pseudocyst are observed in CP, causing a signiﬁcant change in the shape of the pancreas.
Most pancreatic cancers lead to dilatation of the pancreatic duct, with IPMN in particular abruptly modifying its cal-iber.
To integrate such prior knowledge/correspondence into the model, (1) we propose a segmentation based detec-tion network which can segment and identify pancreatic disease regions simultaneously. Our segmentation network takes multi-phase CT scans as input and outputs segmenta-tion masks of the pancreas (as the studied organ) and mass.
We also develop a weak-supervised segmentation method for cases when we have all pixel-level PDAC annotations but only nonPDAC labels. (2) A mask-to-mesh algorithm is used to build a 3D correspondence-aware mesh from the pancreas segmentation output. The geometry of the pan-creas, as well as the location, shape, and distributions of the detected mass can all be captured/encoded by the mesh model. We present a mesh-based feature pooling method that extracts features from the segmentation network and preserve the anatomic structure (each vertex of the mesh has its anatomic meaning). Based on a ﬁxed vertex index list, the pancreas can be automatically divided or parsed into four major sections: head, ventral body, dorsal body, and tail. (3) A geometry-integrated graph classiﬁcation net-work utilizes the 3D anatomy correspondence-aware mesh based deep feature pooling to predict the pancreatic mass type. The network consists of graph-based residual convo-lutional blocks and an anatomy-based graph pooling layer.
All the networks can be trained end-to-end via gradient-based optimization based on a loss function combining the segmentation loss, mesh vertex classiﬁcation loss, and global graph classiﬁcation loss.
Our main contributions are three-fold. (1) To the best of our knowledge, this is the ﬁrst work to propose a multi-phase CT imaging analysis method for the full-spectrum taxonomy of pancreatic mass/disease diagnosis. (2) We are the ﬁrst to integrate the 3D geometry-aware mesh model for effective pancreatic mass (tumor or cyst) imaging analysis (Sec. 3.2, Sec. 3.3), explicitly capturing the anatomy-mass integrated geometry and texture cues. (3) We have exten-sively evaluated our models on 661 patients (ﬁve-phase CT scans per patient). We achieve a new state-of-the-art PDAC segmentation accuracy (Dice: 0.738) and a substantially better nonPDAC segmentation (Dice: 0.611 vs. 0.478) and detection accuracy (detection rate: 89% vs. 70%) compared to the strong baseline method nnUNet. Our imaging-only automated approach demonstrates comparable performance levels with (a) expert radiologists in the differentiation of
PDAC versus nonPDAC who combine the analysis on clin-ical factors, imaging, and blood tests, and (b) a state-of-the-art machine learning-based clinical patient management system (i.e., surgery, monitoring, discharge) using the mul-timodality tests [20]. 2.