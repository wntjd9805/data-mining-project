Abstract
By the one-to-many nature of the super-resolution (SR) problem, a single low-resolution (LR) image can be mapped to many high-resolution (HR) images. However, learning based SR algorithms are trained to map an LR image to the corresponding ground truth (GT) HR image in the training dataset. The training loss will increase and penalize the algorithm when the output does not exactly match the GT target, even when the outputs are mathematically valid can-didates according to the SR framework. This becomes more problematic for the blind SR, as diverse unknown blur ker-nels exacerbate the ill-posedness of the problem. To this end, we propose a fundamentally different approach for the
SR by introducing the concept of the adaptive target. The adaptive target is generated from the original GT target by a transformation to match the output of the SR network. The adaptive target provides an effective way for the SR algo-rithm to deal with the ill-posed nature of the SR, by provid-ing the algorithm with the ﬂexibility of accepting a variety of valid solutions. Experimental results show the effectiveness of our algorithm, especially for improving the perceptual quality of HR outputs. 1.

Introduction
The goal of image super-resolution (SR) is to generate a high-resolution (HR) image from its corresponding low-resolution (LR) counterpart. To solve this problem, pre-vious state-of-the-art SR methods have focused on ﬁnd-ing the underlying relationship between LR and HR patch pairs in natural images. Some methods exploited internally found LR-HR patch pairs across scales within a given image
[6, 12], and other methods learned the mapping functions with the patch pairs from large external images as external example-based approaches [5, 41, 38].
For most learning-based approaches, training example pairs are simulated from a large collection of HR images in a self-supervised manner. Speciﬁcally, a LR image ILR is simulated from a ground truth (GT) HR image IGT as
Figure 1. In (blind) SR, many HR patches can result in the same LR patch. Restricting the solution of an SR network to just one from the given ground truth can penalize a to-tally acceptable output. To tackle this issue, we propose an adaptive target strategy that generates new targets in order to relax the restriction on the possible solutions. follows:
ILR = (IGT ∗ k) ↓s, (1) where k is a blur kernel, ∗ is the convolution operator, and
↓s is the downsampling operator with the scale factor s. The training set D = {(xi, yi)} consists of the LR input patch xi from ILR and the HR target patch yi from IGT for the i-th example. Generally, an SR network f is trained to generate
HR output f (xi) close to the given target yi by minimizing a loss function as follows:
ℓ(yi, f (xi)),
X i (2) where ℓ is a pixel reconstruction loss.
The SR problem is under-determined as different HR im-ages can be mapped to the same LR image (Fig. 1). In other words, the given target yi is not the only solution for the input xi, as one input LR image can be originated from a variety of HR images. This becomes more signiﬁcant when it comes to the blind SR task where the blur kernel k is un-known and diverse. A variety of unknown kernels makes the 16236
relationship between inputs and targets inconsistent, such as differences in blurriness and pixel shift. As a result, the ill-posedness of the problem becomes exacerbated, and it is hardly solvable with conventional SR approaches without additional constraints. To cope with this, previous blind SR methods proposed specialized networks that ﬁrst estimate the blur kernel and then take advantage of the estimated kernel information as an additional input for the SR net-work [8, 49, 2]. As expected, they are inherently sensitive to inaccurate kernel predictions [44].
In this paper, we propose a fundamentally different way to evaluate the output of an SR network by allowing more
ﬂexibility on the outputs of the algorithm. As can be seen in Fig. 1, many HR patches can be mapped to the same LR patch when downsampled with different kernels. Even if an
SR network has generated an output that is close to one of the possible HR targets (green boxes), the conventional loss (Eq. (2)) will increase and penalize the SR network when only considering the corresponding HR target in the training data as the GT (blue box). This contrasts with the one-to-many mapping nature of the SR task.
To this end, we introduce a simple and effective way to encourage sharp output generation by accepting solutions other than the one from the training pair. Instead of directly comparing to the original target yi, our method computes the loss for a new adaptive target ˜yi (red box). Conceptu-ally, using our alternative target relaxes the typical pixel re-construction loss by allowing various HR predictions given an LR input. The adaptive target is made from the orig-inal target to give the lowest penalty for the current net-work prediction f (xi) while keeping the original contents and perceptual impression unchanged. Speciﬁcally, we ﬁnd an afﬁne transform matrix for every small non-overlapping piece of yi to those of f (xi) within the range of acceptable transforms. Then, each of the pieces is transformed to con-struct the adaptive target (Fig. 2). This process is conducted during the training on-the-ﬂy with little computational over-head. For each training iteration, the SR network is trained using the loss computed with the adapted target.
Different from the previous blind SR methods that use additional kernel information, we present a novel way to learn blind SR by allowing diverse network outputs rather than constraining the solution space with the additional in-formation. The proposed adaptive loss fully embraces the inconsistent nature of the blind SR by design, without the kernel estimation.
In a way, we are taking advantage of the ill-posedness to generate sharper images, and there have been few investigations on whether the one-to-one paired training sample is adequate for the SR task [9, 23]. Our approach outperforms previous blind SR models by a good margin in terms of peak signal-to-noise ratio (PSNR) and visual quality. In addition, we found that our loss is also effective for non-blind SR especially when combined with adversarial training (GAN) [7] for realistic SR.
In summary, the contributions of this paper are:
• We introduce a simple and effective way to encourage sharp output generation using proposed adaptive target as a solution for the one-to-many problem of SR. For blind
SR, our method is fundamentally different from previous works as our algorithm works in a single-shot manner without the blur kernel estimation.
• The adaptive target is created on-the-ﬂy during the train-ing stage with little computational overhead, therefore, it is applicable to any training dataset without preprocess-ing. In addition, our framework can be attached to any deep SR models as a loss function.
• Our method outperforms previous state-of-the-art blind
SR methods in terms of PSNR and visual quality. In non-blind scenario, our method generates consistent details when combined with GANs for perceptual SR, achieving both higher PSNR and LPIPS metrics at the same time. 2.