Abstract
Frame reconstruction (current or future frame) based on
Auto-Encoder (AE) is a popular method for video anomaly detection. With models trained on the normal data, the re-construction errors of anomalous scenes are usually much larger than those of normal ones. Previous methods in-troduced the memory bank into AE, for encoding diverse normal patterns across the training videos. However, they are memory-consuming and cannot cope with unseen new scenarios in the testing data. In this work, we propose a dy-namic prototype unit (DPU) to encode the normal dynamics as prototypes in real time, free from extra memory cost. In addition, we introduce meta-learning to our DPU to form a novel few-shot normalcy learner, namely Meta-Prototype
Unit (MPU). It enables the fast adaption capability on new scenes by only consuming a few iterations of update. Ex-tensive experiments are conducted on various benchmarks.
The superior performance over the state-of-the-art demon-strates the effectiveness of our method. Our code is avail-able at https://github.com/ktr-hubrt/MPN/. 1.

Introduction
Video anomaly detection (VAD) refers to the identiﬁca-tion of behaviors or appearance patterns that do not conform to the expectation [2, 3, 5, 28]. Recently, there is a growing interest in this research topic because its key role in surveil-lance for public safety, e.g. the task of monitoring video in airports, at border crossings, or at government facilities becomes increasingly critical. However, the ‘anomaly’ is conceptually unbounded and often ambiguous, making it infeasible to gather data of all kinds of possible anomalies.
Anomaly detection is thus typically formulated as an unsu-pervised learning problem, aiming at learning a model to exploit the regular patterns only with the normal data. Dur-ing inference, patterns that do not agree with the encoded regular ones are considered as anomalies.
*Corresponding authors
Figure 1: An overview of our approach. (1) We design a Dynamic Prototype Unit (DPU) to learn a pool of pro-totypes for encoding normal dynamics; (2) Meta-learning methodology is introduced to formulate the DPU as a few-shot normalcy learner – Meta Prototype Unit (MPU). It im-proves the scene adaption capacity by learning an initializa-tion of the target model and adjusting it to new scenes with parameters update during inference. Better viewed in color.
Deep Auto-Encoder (AE) [38] is a popular approach for video anomaly detection. Researchers usually adopt AEs to model the normal patterns with historical frames and to re-construct the current frame [11, 31, 39, 4, 40, 1] or predict the upcoming frame [22, 34, 24, 26, 10]. For simplicity, we refer to the two cases as frame prediction. Since the mod-els are trained with only normal data, higher prediction er-rors are expected for abnormal (unseen patterns) inputs than those of the normal counterparts. Previously, many methods are based on this assumption for anomaly detection. How-ever, this assumption does not always hold true.
On the one hand, the existing methods rely on large volumes of normal training data to model the shared nor-mal patterns. These models are prone to face the ‘over-generalizing’ dilemma, where all video frames can be pre-dicted well, no matter they are normal or abnormal, ow-ing to the powerful representation capacity of convolutional neural networks (CNNs) [37, 10]. Previous approaches
[37, 10] proposed to explicitly model the shared normal pat-terns across normal training videos with a memory bank, for 15425
the propose of boosting the prediction of normal regions in frames while suppressing the abnormal ones. However, it is extremely memory-consuming for storing the normal pat-terns as memory items across the whole training set.
To tackle this limitation, we propose to encode the nor-mal dynamics in an attention manner, which is proven to be effective in representation learning and enhancement
[46, 20, 13]. A normalcy learner, named as Dynamic Pro-totype Unit (DPU), is developed to be easily incorporated into the AE backbone. It takes the encoding of consecutive normal frames as input, then learns to mine diverse normal dynamics as compact prototypes. More speciﬁcally, we ap-ply a novel attention operation on the AE encoding map, which assigns a normalcy weight to each pixel location to form a normalcy map. Then, prototypes are obtained as an ensemble of the local encoding vectors under the guidance of normalcy weights. Multiple parallel attention operations are applied to generate a pool of prototypes. With the pro-posed compactness and diverseness feature reconstruction loss function, the prototype items are trained to represent di-verse and compact dynamics of the shared normal patterns in an end-to-end fashion. Finally, the AE encoding map is aggregated with the normalcy encoding reconstructed by prototypes for latter frame prediction.
On the other hand, the normal patterns appearing in var-ious scenes differ from each other. For instance, a person running in a walking zone is regarded as an anomaly, while this activity is normal in the playground. Previous meth-ods [22, 10] assume the normal patterns in training videos are consistent with those of test scenes in the unsupervised setting of VAD. However, this assumption is unreliable, es-pecially in real-world applications where surveillance cam-eras are installed in various places with signiﬁcantly differ-ent scenarios. Therefore, there is a pressing need to develop an anomaly detector with adaption capability. To this end,
[37] deﬁnes a rule for updating items in the memory bank based on a threshold to record normal patterns and ignore abnormal ones. However, it is impossible to ﬁnd a uniform and optimal threshold for distinguishing the normal and ab-normal frames under various scenarios.
In this work, we approach this problem from a new per-spective, motivated by [25], which is the few-shot setting for video anomaly detection. In the few-shot setting, videos from multiple scenes are accessible during training, and a few video frames from target scene are available during inference. A solution to this problem is using the meta-learning technique. In this meta-training phase, a few-shot target model is trained to adapt to a new scene with a few frames and parameters update iterations. The procedure is repeated using video data from different scenes for obtain-ing a model initialization that serves as a good starting point for fast adaption to new scenes. Therefore, we formulate our DPU module as a few-shot normalcy learner, namely
Meta Prototype Unit (MPU), for the goal of learning to learn the normalcy in target scenes. Rather than roughly shift-ing to the new scene by adjusting the whole network [25], which may lead to the ‘over-generalizing’ problem, we pro-pose to freeze the pre-trained AE and only update the pa-rameters of our MPU. Consuming only a few parameters and update iterations, our meta-learning model is endued with the power of fast and effective adaption to the nor-malcy of unseen scenarios. An overview of our approach is presented in Fig. 1.
We summarize our contributions as follows: i) We de-velop a Dynamic Prototype Unit (DPU) for learning to rep-resent diverse and dynamic patterns of the normal data as prototypes. An attention operation is thus designed for ag-gregating the normal dynamics to form prototype items.
The whole process is differentiable and trained end-to-end. ii) We introduce meta-learning into our DPU and improve it as a few-shot normalcy learner – Meta Prototype Unit (MPU). It effectively endows the model with the fast adap-tion capability by consuming only a few parameters and update iterations. iii) Our DPU-based AE achieves new state-of-the-art (SOTA) performance on various unsuper-vised anomaly detection benchmarks. In addition, experi-mental results validate the adaption capability of our MPU in the few-shot setting. 2.