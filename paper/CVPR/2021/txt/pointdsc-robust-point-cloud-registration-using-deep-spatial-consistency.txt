Abstract
Removing outlier correspondences is one of the critical steps for successful feature-based point cloud registration.
Despite the increasing popularity of introducing deep learn-ing techniques in this ﬁeld, spatial consistency, which is essentially established by a Euclidean transformation be-tween point clouds, has received almost no individual at-tention in existing learning frameworks. In this paper, we present PointDSC, a novel deep neural network that ex-plicitly incorporates spatial consistency for pruning out-lier correspondences. First, we propose a nonlocal fea-ture aggregation module, weighted by both feature and spa-tial coherence, for feature embedding of the input corre-spondences. Second, we formulate a differentiable spectral matching module, supervised by pairwise spatial compati-bility, to estimate the inlier conﬁdence of each correspon-dence from the embedded features. With modest computa-tion cost, our method outperforms the state-of-the-art hand-crafted and learning-based outlier rejection approaches on several real-world datasets by a signiﬁcant margin. We also show its wide applicability by combining PointDSC with different 3D local descriptors. [code release] 1.

Introduction
The state-of-the-art feature-based point cloud registra-tion pipelines commonly start from local feature extraction and matching, followed by an outlier rejection for robust alignment. Although 3D local features [4, 39, 18, 27, 32] have evolved rapidly, correspondences produced by feature matching are still prone to outliers, especially when the overlap of scene fragments is small. In this paper, we focus on developing a robust outlier rejection method to mitigate this issue.
Traditional outlier ﬁltering strategies can be broadly classiﬁed into two categories, namely the individual-based and group-based [67]. The individual-based approaches, such as ratio test [40] and reciprocal check [10], identify inlier correspondences solely based on the descriptor simi-larity, without considering their spatial coherence. In con-Figure 1: Taking advantage of both the superiority of tradi-tional (e.g. SM [36]) and learning methods (e.g. DGR [16]), our approach integrates important geometric cues into deep neural networks and efﬁciently identiﬁes inlier correspon-dences even under high outlier ratios. trast, the group-based methods usually leverage the under-lying 2D or 3D scene geometry and identify inlier cor-respondences through the analysis of spatial consistency.
Speciﬁcally, in a 2D domain, the spatial consistency only provides a weak relation between points and epipolar lines
[13, 9, 73]. Instead, in a 3D domain, the spatial consistency is rigorously deﬁned between every pair of points by rigid transformations, serving as one of the most important geo-metric properties that inlier correspondences should follow.
In this paper, we focus on leveraging the spatial consistency in outlier rejection for robust 3D point cloud registration.
Spectral matching (SM) [36] is a well-known traditional algorithm that heavily relies on 3D spatial consistency for
ﬁnding inlier correspondences. It starts with constructing a compatibility graph using the length consistency, i.e., pre-serving the distance between point pairs under rigid trans-formations, then obtains an inlier set by ﬁnding the main cluster of the graph through eigen analysis. However, this algorithm has two main drawbacks. First, solely relying on length consistency is intuitive but inadequate because it suf-fers from the ambiguity problem [54] (Fig. 4a). Second, as explained in [68, 67], spectral matching cannot effectively handle the case of high outlier ratio (Fig. 1, left), where the main inlier clusters become less dominant and thus are dif-ﬁcult to be identiﬁed through spectral analysis.
Recently, learning-based 3D outlier rejection methods, 15859
such as DGR [16] and 3DRegNet [48], formulate outlier rejection as an inlier/outlier classiﬁcation problem, where the networks embed deep features from correspondence in-put, and predict inlier probability of each correspondence for outlier removal. For feature embedding, those meth-ods solely rely on generic operators such as sparse con-volution [17] and pointwise MLP [53] to capture the con-textual information, while the essential 3D spatial relations are omitted. Additionally, during outlier pruning, the ex-isting methods classify each correspondence only individ-ually, again overlooking the spatial compatibility between inliers and may hinder the classiﬁcation accuracy.
All the aforementioned outlier rejection methods are either hand-crafted with spatial consistency adopted, or learning-based without spatial consistency integrated.
In this paper, we aim to take the best from both line of meth-ods, and propose PointDSC, a powerful two-stage deep neu-ral network that explicitly leverages the spatial consistency constraints during both feature embedding and outlier prun-ing.
Speciﬁcally, given the point coordinates of input corre-spondences, we ﬁrst propose a spatial-consistency guided nonlocal module for geometric feature embedding, which captures the relations among different correspondences by combining the length consistency with feature similarity to obtain more representative features. Second, we formulate a differentiable spectral matching module, and feed it with not only the point coordinates, but also the embedded fea-tures to alleviate the ambiguity problem. Finally, to bet-ter handle the small overlap cases, we propose a seeding mechanism, which ﬁrst identiﬁes a set of reliable corre-spondences, then forms several different subsets to perform the neural spectral matching multiple times. The best rigid transformation is ﬁnally determined such that the geometric consensus is maximized. To summarize, our main contribu-tions are threefold: 1. We propose a spatial-consistency guided nonlocal (SC-Nonlocal) module for feature embedding, which ex-plicitly leverages the spatial consistency to weigh the feature correlation and guide the neighborhood search. 2. We propose a differentiable neural spectral match-ing (NSM) module based on traditional SM for outlier removal, which goes beyond the simple length consis-tency metric through deep geometric features. 3. Besides showing the superior performance over the state-of-the-arts, our model also demonstrates strong generalization ability from indoor to outdoor scenar-ios, and wide applicability with different descriptors. 2.