Abstract
We propose a simple yet effective reﬂection-free cue for robust reﬂection removal from a pair of ﬂash and ambi-ent (no-ﬂash) images. The reﬂection-free cue exploits a
ﬂash-only image obtained by subtracting the ambient im-age from the corresponding ﬂash image in raw data space.
The ﬂash-only image is equivalent to an image taken in a dark environment with only a ﬂash on. We observe that this ﬂash-only image is visually reﬂection-free, and thus it can provide robust cues to infer the reﬂection in the am-bient image. Since the ﬂash-only image usually has arti-facts, we further propose a dedicated model that not only utilizes the reﬂection-free cue but also avoids introducing artifacts, which helps accurately estimate reﬂection and transmission. Our experiments on real-world images with various types of reﬂection demonstrate the effectiveness of our model with reﬂection-free ﬂash-only cues: our model outperforms state-of-the-art reﬂection removal approaches by more than 5.23dB in PSNR, 0.04 in SSIM, and 0.068 in
LPIPS. Our source code and dataset are publicly available at github.com/ChenyangLEI/ﬂash-reﬂection-removal. 1.

Introduction
An image taken by a camera in front of a glass often contains undesirable reﬂection. In the process of image for-mation with reﬂection, the irradiance received by a camera can be approximately modeled as the sum of transmission and reﬂection. In this paper, we are interested in recovering a clear transmission image by removing reﬂection from the ambient image (captured image). Reﬂection removal is an important application in computational photography, which can highly improve image quality and pleasantness. Fur-thermore, computer vision algorithms can be more robust to images with reﬂection, as the reﬂection can be largely erased by a reﬂection removal method.
Reﬂection removal is challenging because the reﬂection component is usually unknown. Since both reﬂection and transmission are natural images, it is hard to distinguish between reﬂection and transmission from an input image.
Therefore, many methods adopt various assumptions on the
Ambient image
Flash image
Flash-only image
Our transmission
Our reﬂection
Figure 1. A reﬂection-free ﬂash-only image is computed from a pair of ambient/ﬂash images to help remove reﬂection. Our trans-mission image does not absorb the artifacts in the ﬂash-only im-age. appearance of reﬂection for reﬂection removal. For ex-ample, some single image-based methods [3, 42] assume that the reﬂection is not in-focus and blurry. The ghosting cue [32] is another assumption that holds when the glass is thick. However, reﬂection in real-world images is diverse, and these assumptions do not necessarily hold [19, 35]. As a result, existing methods cannot perfectly remove reﬂection with diverse appearance from real-world images [19].
We propose a novel reﬂection-free ﬂash-only cue that fa-cilitates inferring the reﬂection in an ambient image. This cue is robust since it is independent of the appearance and strength of reﬂection, unlike assumptions adopted in pre-vious single image reﬂection removal methods [32, 42] or
ﬂash-based methods [5]. The reﬂection-free cue is based on a physics-based phenomenon of an image obtained by subtracting an ambient image from the corresponding ﬂash image (in raw data space). This ﬂash-only image is equiva-lent to an image captured under the ﬂash-only illumination: the environment is completely dark, and a single ﬂash is the sole light source. A key observation is that the reﬂection is 14811
invisible in the ﬂash-only image.
While ﬂash-only images provide reﬂection-free cues to distinguish reﬂection, they also have weaknesses. For in-stance, in Fig. 1, we can observe artifacts (e.g., color dis-tortion, illuminated dust) due to uneven ﬂash illumination, occlusions, and other reasons. These artifacts prevent us from obtaining a high-quality transmission easily.
To utilize the reﬂection-free cue and avoid introducing the ﬂash-only image artifacts, we design a dedicated ar-chitecture for obtaining high-quality transmission. Speciﬁ-cally, we ﬁrst estimate a reﬂection image instead of a trans-mission image. Then, to further avoid introducing artifacts in the ﬂash-only image, only the input ambient image and the estimated reﬂection are given to the second network that estimates the transmission. our dedicated
Combining architecture with the reﬂection-free cue, we can robustly and accurately re-move various kinds of reﬂection to recover the underlying transmission image. Although we need an extra ﬂash image compared with single image methods, a ﬂash/no-ﬂash image pair can be captured with a single shutter-press using customized software, as shown in Fig. 6. Hence, general users can easily apply our method for robust reﬂection removal. In summary, our contributions are as follows:
• We propose a novel cue - the reﬂection-free ﬂash-only cue that makes distinguishing reﬂections simpler for reﬂection removal. This cue is robust since it is inde-pendent of the appearance and strength of reﬂection.
• We propose a dedicated framework that can avoid in-troducing artifacts of ﬂash-only images while utilizing reﬂection-free cues. We improve more than 5.23dB in
PSNR, 0.04 in SSIM, and 0.068 in LPIPS on a real-world dataset compared with state-of-the-art methods.
• We construct the ﬁrst dataset that contains both raw data and RGB data for ﬂash-based reﬂection removal. 2.