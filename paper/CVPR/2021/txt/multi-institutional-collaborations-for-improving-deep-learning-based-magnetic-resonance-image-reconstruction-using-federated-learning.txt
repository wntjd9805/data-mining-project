Abstract
Fast and accurate reconstruction of magnetic resonance (MR) images from under-sampled data is important in many clinical applications. In recent years, deep learning-based methods have been shown to produce superior performance on MR image reconstruction. However, these methods re-quire large amounts of data which is difﬁcult to collect and share due to the high cost of acquisition and medical data privacy regulations. In order to overcome this challenge, we propose a federated learning (FL) based solution in which we take advantage of the MR data available at different institutions while preserving patients’ privacy. However, the generalizability of models trained with the FL setting can still be suboptimal due to domain shift, which results from the data collected at multiple institutions with differ-ent sensors, disease types, and acquisition protocols, etc.
With the motivation of circumventing this challenge, we pro-pose a cross-site modeling for MR image reconstruction in which the learned intermediate latent features among dif-ferent source sites are aligned with the distribution of the latent features at the target site. Extensive experiments are conducted to provide various insights about FL for MR im-age reconstruction. Experimental results demonstrate that the proposed framework is a promising direction to uti-lize multi-institutional data without compromising patients’ privacy for achieving improved MR image reconstruction.
Our code is available at https://github.com/guopengf/FL-MRCM.
Figure 1. Top row: (a) ground truth, (b) zero-ﬁlled images, and (c) reconstructed images from the fastMRI [13], HPKS [10], IXI [3], and BraTS [26] datasets from left to right, respectively. Bottom row: t-SNE plots. The distribution of (d) latent features without cross-site modeling, and (e) latent features corresponding to the proposed cross-site modeling. In each plot, green, blue, yellow, and red dots represent data from fastMRI [13], HPKS [10], IXI [3], and BraTS [26] datasets, respectively. 1.

Introduction
Magnetic resonance imaging (MRI) is one of the most widely used imaging techniques in clinical applications. It is non-invasive and can be customized with different pulse sequences to capture different kinds of tissues. For instance, fat tissues are bright in T1-weighted images, which can clearly show gray and white matter tissues in the brain. The radiofrequency pulse sequences used to make T2-weighted images can delineate ﬂuid from cortical tissue [11]. How-ever, to increase the signal-to-noise ratio (SNR), clinical scanning usually involves the usage of multiple saturation frequencies and repeating acquisitions, which results in rel-atively long scan time. Various compressed sensing (CS) based methods have been proposed in the literature for ac-celerating the MRI sampling process by undersampling in the k-space during acquisition [4, 21, 22]. In recent years, data driven deep learning-based methods have been shown 2423
to produce superior performance on MR image reconstruc-tion from partial k-space observations [20, 38, 39].
However, deep networks usually require large amounts of diversity-rich paired data which can be labor-intensive and prohibitively expensive to collect. In addition, one has to deal with patient privacy issues when storing them, mak-ing it difﬁcult to share data with other institutions. Although deidentiﬁcation [33] might provide a solution, building a large scale centralized dataset at a particular institution is still a challenging task.
The recently introduced federated learning (FL) frame-work [25, 36, 15] addresses this issue by allowing collab-orative and decentralized training of deep learning-based methods.
In particular, there is a server that periodically communicates with each institution to aggregate a global model and then shares it with all institutions. Each insti-tution utilizes and stores its own private data. It is worth noting that instead of directly transferring data for training, the communication in FL algorithms only involves model parameters or update gradients, which resolves the privacy concerns. Hence, FL methods intrinsically facilitate multi-institutional collaborations between data centers (e.g., hos-pitals in the context of medical images).
However, the generalizability of models trained with the FL setting can still be suboptimal due to domain shift, which results from the data collected at multiple institutions with different sensors, disease types, and ac-quisition protocols, etc. This can be clearly seen from
Fig. 1 where we show fully-sampled (Fig. 1(a)) and under-sampled (Fig. 1(b)) images from four different datasets.
In Fig. 1(d), we visualize latent features corresponding to images from these datasets using t-Distributed Stochas-tic Neighbor Embedding (t-SNE) plot [23]. As can be seen from Fig. 1(d), features from a particular dataset are grouped together in a cluster indicating that each dataset has its own bias. As a result, we can see four different clus-ters of latent features. In order to make use of these datasets in the FL framework, one needs to align these features and remove the domain shift among the datasets. To circumvent this challenge, we propose a cross-site model for MR im-age reconstruction in which the learned intermediate latent features among different source sites are aligned with the distribution of the latent features at the target site. Speciﬁ-cally, the proposed method involves two optimization steps.
In the ﬁrst step, local reconstruction networks are trained on private data. In the second step, the intermediate latent features of the target domain data are transferred to other local source entities. An adversarial domain identiﬁer is then trained to align the latent space distribution between the source domain and the target domain. Hence, minimiz-ing the loss of adversarial domain identiﬁer results in the re-construction network weights being automatically adapted to the target domain. Fig. 1(e) and (c) show the distribu-tion of aligned features and the corresponding reconstructed images in four datasets. The proposed cross-site modeling allows us to leverage datasets from various institutions for obtaining improved reconstructions.
To summarize, this paper makes the following contribu-tions:
• A method called Federated Learning-based Magnetic
Resonance Imaging Reconstruction (FL-MR) is pro-posed which enables multi-institutional collaborations for MRI reconstruction in a privacy-preserving man-ner.
• To address the domain shift issue among different sites, FL-MR with Cross-site Modeling (FL-MRCM) is proposed to align the latent space distribution be-tween the source domain and the target domain.
• Extensive experiments are conducted to provide vari-ous insights about FL for MR image reconstruction. 2.