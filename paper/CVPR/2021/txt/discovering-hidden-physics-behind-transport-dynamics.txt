Abstract
Transport processes are ubiquitous. They are, for exam-ple, at the heart of optical ﬂow approaches; or of perfu-sion imaging, where blood transport is assessed, most com-monly by injecting a tracer. An advection-diffusion equa-tion is widely used to describe these transport phenomena.
Our goal is estimating the underlying physics of advection-diffusion equations, expressed as velocity and diffusion ten-sor ﬁelds. We propose a learning framework (YETI) build-ing on an auto-encoder structure between 2D and 3D im-age time-series, which incorporates the advection-diffusion model. To help with identiﬁability, we develop an advection-diffusion simulator which allows pre-training of our model by supervised learning using the velocity and diffusion ten-sor ﬁelds.
Instead of directly learning these velocity and diffusion tensor ﬁelds, we introduce representations that assure incompressible ﬂow and symmetric positive semi-deﬁnite diffusion ﬁelds and demonstrate the additional ben-eﬁts of these representations on improving estimation ac-curacy. We further use transfer learning to apply YETI on a public brain magnetic resonance (MR) perfusion dataset of stroke patients and show its ability to successfully dis-tinguish stroke lesions from normal brain regions via the estimated velocity and diffusion tensor ﬁelds. 1.

Introduction
Many transport phenomena can be formalized by par-tial differential equations (PDEs). However, numerically solving PDEs is expensive for high spatial dimensions and across timescales [4]. Signiﬁcant developments in deep learning have recently led to an explosive growth of data-driven solutions for PDEs via deep neural networks (DNNs). This work either directly models the solution via
This work was supported by the National Institutes of Health (NIH) under award number NIH 2R42NS086295.
DNNs [14, 41, 45] or learns mesh-free, inﬁnite-dimensional operators with DNNs [31, 6, 39, 44, 28].
Despite of the signiﬁcant progress achieved by the afore-mentioned methods for solving PDEs forward, inverse PDE problems, i.e., parameter estimation, remains challeng-ing [29, 47]. Such problems have been extensively explored in the context of optical ﬂow and for general image reg-istration, where the underlying PDE model is typically an advection equation and the sought-for parameter is a dis-placement or velocity vector ﬁeld [22, 7, 37, 5, 21]. DNN solutions have also been studied [12, 49, 3, 43].
In contrast, we are interested in estimating the spatially-varying velocity and diffusion tensor ﬁelds (termed physics parameter ﬁelds in what follows) for more general advection-diffusion equations. Challenges arise from iden-tiﬁability (i.e., if observed transport is due to advection or diffusion), physical plausibility (e.g., for ﬂuid ﬂow, vector
ﬁelds should be divergence-free) and diffusion tensor struc-ture (i.e., predominant direction and anisotropy). Further, while optical ﬂow and registration approaches typically deal with image pairs, the parameter estimation for advection-diffusion equations is generally based on time-series data.
Limited work to estimate the parameter ﬁelds of advection-diffusion equations exist. Tartakovsky et al. [47] do not consider advection or diffusion tensors, but instead proposed a DNN to learn 2D diffusion ﬁelds only from dif-fusion PDEs. B´ezenac et al. [10] learn 2D velocity and dif-fusion ﬁelds of advection-diffusion PDEs by DNNs. Liu et al. [30] proposed an optimization approach to estimate ve-locity and diffusion ﬁelds of an advection-diffusion equa-tion in 3D. Though promising, the numerical optimization approach is time-consuming, especially when dealing with large datasets. Koundal et al. [24] use optimal mass trans-port combined with a spatially constant diffusion. Note that all aforementioned methods assume isotropic diffusion (i.e., not general diffusion tensors), which is insufﬁcient to ac-curately model complex materials (e.g., anisotropic porous media, brain tissue) where diffusion is mostly anisotropic. 10082
Further, both the approaches by B´ezenac et al. [10] and Liu et al. [30] suffer from potential identiﬁability issues as they are both only based on ﬁtting the observed time-series data without explicitly controlling how to allocate between the velocity and diffusion ﬁelds; though an inductive bias is in-troduced by considering divergence-free vector ﬁelds only, via a loss term in [10] and a special parameterization in [30].
We therefore introduce a novel learning framework, termed YETI, which works in 2D and 3D, to discover the un-derlying velocity and diffusion tensor ﬁelds from observed advection-diffusion time-series. Our contributions are:
• A novel advection-diffusion learning model. Given an advection-diffusion process, YETI not only predicts the transport dynamics, but also reconstructs the un-derlying velocity and diffusion tensor ﬁelds.
• Representation theorems for divergence-free vectors and symmetric PSD tensors.
Our estimates are grounded in theorems ensuring realistic constraints on the learned physics parameter ﬁelds by construc-tion. This also helps to signiﬁcantly improve the dif-fusion reconstruction by providing supervision on its anisotropic structure during training.
• Advection-diffusion simulator. We develop a simulator for quasi-realistic advection-diffusion that can be used for physics-parameter-supervised model training.
• A two-phase learning strategy. (1) We initially train our model on a simulated dataset with ground truth physics to improve identiﬁability when estimating ve-locity and diffusion from advection-diffusion; (2) We apply PDE-based transfer learning for transport dy-namics via a time-series auto-encoder, which allows us to discover unknown velocity and diffusion ﬁelds of advection-diffusion processes for real world data. 2.