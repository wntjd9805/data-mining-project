Abstract
Deep learning-based methods have achieved remarkable performance for image dehazing. However, previous studies are mostly focused on training models with synthetic hazy images, which incurs performance drop when the models are used for real-world hazy images. We propose a Prin-cipled Synthetic-to-real Dehazing (PSD) framework to im-prove the generalization performance of dehazing. Starting from a dehazing model backbone that is pre-trained on syn-thetic data, PSD exploits real hazy images to ﬁne-tune the model in an unsupervised fashion. For the ﬁne-tuning, we leverage several well-grounded physical priors and com-bine them into a prior loss committee. PSD allows for most of the existing dehazing models as its backbone, and the combination of multiple physical priors boosts dehazing signiﬁcantly. Through extensive experiments, we demon-strate that our PSD framework establishes the new state-of-the-art performance for real-world dehazing, in terms of visual quality assessed by no-reference quality metrics as well as subjective evaluation and downstream task perfor-mance indicator. 1.

Introduction
Due to the existence of haze, outdoor images often suf-fer from low contrast and limited visibility, which adversely affects the performance of subsequent high-level computer vision tasks, such as object detection and recognition. Thus, more and more attention is drawn to image dehazing, that aims to recover the clean image from a hazy input.
According to the physical scattering model [24, 27], the hazing process is usually formulated as
I(x) = J(x)t(x) + A(1 − t(x)) (1)
*This work was supported by the Natural Science Foundation of China under Grants 62022075 and 61931014. Our code and models are available at https://github.com/zychen- ustc/PSD- Principled-Synthetic - to - Real - Dehazing - Guided - by - Physical -Priors. (Corresponding author: Dong Liu.) (a) Hazy image (b) DAD [34] (c) MSBDN [6] (d) Ours
Figure 1. Dehazing results on a real hazy image. where I(x) is the observed hazy image, J(x) is the scene radiance to be recovered. A and t(x) are the global atmo-spheric light and the transmission map, respectively.
Estimating the clean image from a single hazy input is an ill-posed problem. Early methods [1, 8, 9, 11, 37] try to es-timate transmission map by physical priors and then restore image via the scattering model. However, these physical priors are not always reliable, leading to inaccurate trans-mission estimates and unsatisﬁed dehazing results.
With the advances in deep learning, many methods based on convolutional neural networks (CNNs) [3,4,7,14,22,31, 32] have been proposed to overcome the drawbacks of us-ing physical priors. They are more efﬁcient and outperform traditional prior-based algorithms. In common cases, large quantities of paired hazy/clean images are necessary for the training of CNN-based dehazing models. However, it is al-most impossible to obtain these image pairs from the real world, and most learning-based methods resort to training on synthetic data. Unfortunately, due to the domain gap between synthetic and real data, dehazing models trained on synthetic images usually generalize poorly to real-world hazy images.
Recently, this issue has been picked up by a handful of 7180
studies. Li et al. [17] proposed a semi-supervised dehaz-ing model trained on both synthetic data and real-world images. Shao et al. [34] suggested a domain adaptation framework to reduce the gap between synthetic and real do-mains. These methods demonstrate the great potential of domain adaptation in improving the performance for real-world dehazing tasks. However, there is still room for fur-ther improvement, and principled frameworks dedicated for the problem of dehazing generalization remain a lack.
In this paper, we propose a Principled Synthetic-to-real
Dehazing (PSD) framework, which is applicable to general-ize most of the existing dehazing models to the real domain.
PSD includes two phases: supervised pre-training and unsu-pervised ﬁne-tuning. For pre-training, we modify a chosen dehazing model backbone into a physics-based network and train this network with synthetic data. Taking advantage of the well-designed backbone, we could obtain a pre-trained model with solid dehazing performance on the synthetic domain. For ﬁne-tuning, we exploit real hazy images to train the model in an unsupervised manner. We investigate the strong physics background of dehazing tasks and elab-orately select three physical priors to constitute a loss com-mittee that guides the unsupervised training. The key idea of this ﬁne-tuning process is the intuition that good dehaz-ing results shall share some common properties/statistical priors. We leverage this intuition, treating the loss commit-tee as a task-speciﬁc proxy guidance to help generalize our model to the real domain. As shown in Fig. 1, PSD produces a better dehazing result when compared with the backbone model. PSD also outperforms the state-of-art domain adap-tation dehazing (DAD) [34].
We summarize the contributions of our work as follows.
• We re-formulate the real-world dehazing task as a synthetic-to-real generalization framework: starting from a dehazing model backbone pre-trained on syn-thetic paired data, real hazy images will be subse-quently exploited to ﬁne-tune the model in an unsu-pervised fashion. PSD is principled, easy-to-use, and can take most deep dehazing models as its backbone1.
• Due to the absence of clean ground-truth image as su-pervision, we leverage several popular, well-grounded physical priors to guide the ﬁne-tuning. We combine them into a prior loss committee as the task-speciﬁc proxy guidance, which constitutes the core of PSD.
We show that these priors are complementary and their combination boosts PSD dehazing the most.
• Our framework is compared with a number of com-petitive methods via comprehensive experiments. Re-sults are evaluated in terms of visual quality assessed by both no-reference quality metrics and subjective 1Some models are subject to light modiﬁcations, see Section 3.2. evaluation, and downstream task performance indica-tor. Consistently and substantially, PSD establishes the new state-of-the-art real-world dehazing performance. 2.