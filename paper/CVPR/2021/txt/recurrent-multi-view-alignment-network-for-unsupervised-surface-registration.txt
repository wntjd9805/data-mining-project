Abstract
Learning non-rigid registration in an end-to-end man-ner is challenging due to the inherent high degrees of free-In this pa-dom and the lack of labeled training data. per, we resolve these two challenges simultaneously. First, we propose to represent the non-rigid transformation with a point-wise combination of several rigid transformations.
This representation not only makes the solution space well-constrained but also enables our method to be solved iter-atively with a recurrent framework, which greatly reduces the difﬁculty of learning. Second, we introduce a differen-tiable loss function that measures the 3D shape similarity on the projected multi-view 2D depth images so that our full framework can be trained end-to-end without ground truth supervision. Extensive experiments on several differ-ent datasets demonstrate that our proposed method outper-forms the previous state-of-the-art by a large margin. 1.

Introduction
Surface registration, which aims to ﬁnd the spatial trans-formation and correspondences between two surfaces, is a fundamental problem in computer vision and graphics. It has wide applications in many ﬁelds such as 3D recon-struction [32, 31], tracking [33, 48] and medical imag-*Corresponding author ing [63, 39]. According to the type of transformation that deforms the source surface to the target, registration algo-rithms can be categorized as rigid [3, 2, 53, 28, 61, 12, 21] and non-rigid [30, 51, 50, 20, 27] methods. Rigid registra-tion estimates a global rotation and translation that aligns two surfaces, while non-rigid registration has much more freedoms, and thus is more complex and challenging.
Traditional optimization based methods [3, 30] usually handle this problem by iteratively alternating a correspon-dence step and an alignment step. The correspondence step is to ﬁnd corresponding points between the source and tar-get surfaces, while the alignment step estimates the trans-formation based on the current correspondences. However, it is not easy to construct reliable correspondences solely based on heuristics (e.g., nearest neighbor search) or hand-crafted features like SHOT [45] and FPFH [36].
Recently, learning based methods have demonstrated promising results by leveraging the strong representation learning abilities of neural networks, but most of them are limited to rigid registration [2, 53, 28, 61, 12, 21]. Only a few learning based non-rigid registration methods [50, 51] exists and they are only applicable to small-scale non-rigid deformations that are synthesized by the thin plate spline (TPS) [5] transformation. It is not straightforward to design a learning based non-rigid registration framework that can produce very accurate results.
The challenges of learning non-rigid registration lie in two aspects. First, unlike a single global rigid transforma-10297
tion, the much greater freedoms in non-rigid registration in-crease the difﬁculty of network training. For example, tra-ditional methods [1, 30] estimate a local transformation for every points on the surface. To alleviate this issue, one pos-sible direction is to adopt the deformation graph [41] repre-sentation, which reduces the complexity from each surface point to each graph node. However, it is not convenient to pass the shape-dependent deformation graphs to neural network due to their different number of graph nodes and topologies. Second, the lack of labeled data restricts the training of non-rigid registration networks. It is non-trivial to obtain dense non-rigid correspondences from real large-scale data to serve as direct supervision. An alternative is to train the network in an unsupervised fashion. However, ex-isting metrics (e.g., chamfer distance and earth-mover dis-tance) for shape similarity measurement are not effective enough to drive the network to learn the correct solution.
To tackle these problems, we ﬁrst propose a new non-rigid representation that is suitable for network learning.
Speciﬁcally, we represent the non-rigid transformation as a point-wise combination of K rigid transformations, where
K is much smaller than the number of surface points.
This is because the non-rigid deformation of the surface can be well approximated by the combination of several rigid transformations. Such a representation not only en-ables our method to be able to approximate arbitrary non-rigid transformation but also makes the solution space well-constrained. To learn such a representation, we design a recurrent neural network architecture to estimate the combi-nation weights and each rigid transformation iteratively. At each iteration, the network only needs to estimate a single rigid transformation and the skinning weight for each point which represents how important the rigid transformation in-ﬂuences this point. Although the iterative strategy has been adopted in neural networks for registration [2, 37], they are mainly used for rigid registration, while our proposed itera-tive method is well-designed for non-rigid registration.
We further propose a multi-view loss function to train the model in a self-supervised manner. Concretely, we project the 3D surface to multi-view 2D depth images and measure the visual similarity of source and target by their depths and masks. The intuitive idea is that their projected depth maps and masks should be identical if two surfaces are fully reg-istered. Moreover, we adopt a soft rasterization method to render the point clouds to depths map and masks, which makes our loss term to be differentiable. The proposed shape similarity loss is adopted in our self-supervised learn-ing method, and it outperforms the commonly used Cham-fer Distance and Earth Mover’s distance.
We conduct extensive experiments on different object types (body, face, cats, dogs, and ModelNet40 dataset). Our proposed RMA-Net not only outperforms previous state-of-the-art methods by a large margin but also works well for large-scale non-rigid registration tasks. Extensive ablation studies also validate the effectiveness of each component in our proposed method. 2.