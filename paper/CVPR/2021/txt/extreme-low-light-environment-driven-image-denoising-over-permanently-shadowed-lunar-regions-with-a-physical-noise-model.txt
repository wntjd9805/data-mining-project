Abstract
Recently, learning-based approaches have achieved im-pressive results in the ﬁeld of low-light image denoising.
Some state of the art approaches employ a rich physical model to generate realistic training data. However, the per-formance of these approaches ultimately depends on the re-alism of the physical model, and many works only concen-trate on everyday photography. In this work we present a denoising approach for extremely low-light images of per-manently shadowed regions (PSRs) on the lunar surface, taken by the Narrow Angle Camera on board the Lunar
Reconnaissance Orbiter satellite. Our approach extends existing learning-based approaches by combining a phys-ical noise model of the camera with real noise samples and training image scene selection based on 3D ray tracing to generate realistic training data. We also condition our de-noising model on the camera’s environmental metadata at the time of image capture (such as the camera’s tempera-ture and age), showing that this improves performance. Our quantitative and qualitative results show that our method strongly outperforms the existing calibration routine for the camera and other baselines. Our results could signiﬁcantly impact lunar science and exploration, for example by aiding the identiﬁcation of surface water-ice and reducing uncer-tainty in rover and human traverse planning into PSRs. 1.

Introduction
Low-light image denoising is an important ﬁeld of com-puter vision. Low-light environments occur in many dif-ferent applications, such as night-time photography, astron-omy and microscopy [4, 7, 50], and the images captured usually have very poor quality. Fundamentally, this is due to the very limited number of photons arriving at the cam-era, meaning that noise sources such as photon noise and sensor-related noise strongly dominate [7, 22].
Direct approaches for removing these noise sources in-clude increasing the exposure time or by using burst pho-tography and aligning and combining the images during post-processing. However, these approaches have signif-icant downsides; for example longer exposure times can cause blurring and burst photography can still be sensitive to dynamic scenes [18, 20]. Instead, image denoising can be applied, for which there exists a rich literature [3, 13, 11].
An emerging approach is to use learning-based denois-ing methods on short exposure images [4, 46, 48]. Whilst promising, a disadvantage is that large amounts of labelled training data are often required to prevent overﬁtting, which can be expensive to collect, or unavailable [4, 50, 1]. Some recent methods alleviate this problem by using physical models to generate synthetic training data [46], but ulti-mately the generalisation performance depends on the re-alism of the physical model.
Furthermore, many recent works focus on denoising low-light images of everyday scenes [4, 20, 46, 35].
In this work we present a denoising approach for a specialised set of extremely low-light images; namely those of the Per-manently Shadowed Regions (PSRs) on the lunar surface, taken by the Narrow Angle Camera (NAC) on board the
Lunar Reconnaissance Orbiter (LRO) satellite [6, 38]. Im-proving the quality of these images could have signiﬁcant scientiﬁc impact, for example by enabling the detection of science targets and obstacles in PSRs, reducing the uncer-tainty in rover and human traverse planning and aiding the identiﬁcation of surface-exposed water-ice [26]. 6317
Whilst the NAC is a scientiﬁc camera operating in a re-mote environment, many of its underlying noise sources are the same as those found in other applications. In this work we extend existing learning-based methods in several re-spects. Firstly, in order to avoid overﬁtting and improve generalisation performance, we combine a realistic physi-cal noise model of the camera with real noise samples from dark frames to generate realistic training data. We also use 3D ray tracing to select training image scenes which best match the illumination conditions expected in PSRs. Sec-ondly, instead of using the noisy image as the only input to the learned model as is typically done [4, 46, 48], we con-dition our model on the camera’s environmental metadata available at the time of image capture, allowing us to ac-count for the effect of external factors such as camera tem-perature on the noise. Finally, many recent works focus on images from CMOS sensors, whilst we formulate a physical noise model for a CCD sensor [4, 46, 48, 28, 44].
Our main contributions are summarised as follows:
• We present a novel application of learning-based low-light image denoising for images of PSRs on the lunar surface.
• We extend existing approaches by combining a physi-cal noise model with real noise samples and scene se-lection based on 3D ray tracing to generate training data; and by conditioning our model on the camera’s environmental metadata at the time of image capture.
• Our quantitative and qualitative results show that our method strongly outperforms the existing NAC cali-bration routine and other baselines.
We name our approach Hyper-Effective Noise Removal
U-Net Software, or HORUS1. 2.