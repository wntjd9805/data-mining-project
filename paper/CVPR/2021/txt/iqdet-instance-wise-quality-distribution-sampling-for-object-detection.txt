Abstract
Static
Dynamic
We propose a dense object detector with an instance-wise sampling strategy, named IQDet. Instead of using hu-man prior sampling strategies, we ﬁrst extract the regional feature of each ground-truth to estimate the instance-wise quality distribution. According to a mixture model in spa-tial dimensions, the distribution is more noise-robust and adapted to the semantic pattern of each instance. Based on the distribution, we propose a quality sampling strategy, which automatically selects training samples in a proba-bilistic manner and trains with more high-quality samples.
Extensive experiments on MS COCO show that our method steadily improves baseline by nearly 2.4 AP without bells and whistles. Moreover, our best model achieves 51.6 AP, outperforming all existing state-of-the-art one-stage detec-tors and it is completely cost-free in inference time. 1.

Introduction
Recent object detection methods have proposed various sampling strategies, assigning the predicted boxes to the ground truth according to their quality. These sampling and assignment strategies have led to great progress in modern object detection task.
As shown in Fig. 1, the improvements in sampling strate-(1) From Static gies can be divided into two tendencies. to Dynamic: Static rules like RetinaNet [8] assign anchor boxes to the ground truth according to the predeﬁned qual-ity of anchors (i.e., IoU), while Dynamic rules (e.g., loss-based sampling in PAA [6]) further boost the performance of the dense object detection, because they are prediction-aware and directly determined by the prediction quality. (2) From Sample-wise to Instance-wise: Assigned by the
Sample-wise rule like RetinaNet[8], a predeﬁned anchor is assigned as a positive sample when its IoU is higher than the threshold. Meanwhile, based on Instance-wise distribu-tion, [14, 15] propose a center-based distribution according to the ground-truth(GT)’s location, where the samples lo-cated inside the central region are assigned as positive sam-ples. These two tendencies achieve better performance and 0.93 0.93 0.92 0.93 0.94
Sample-wise rule  (a) RetinaNet  (b) PAA
GT
Image
Instance-wise distribution  (c) FCOS  (d) Ours
Figure 1. Different sampling strategy of dense object detection.
The green squares are GT and the red circles represent the positive samples. (a) Static sampling strategies mainly base on the anchors’ locations, while the Dynamic sampling strategies are prediction-aware. (b) The IoUs of the predicted boxes are quite similar, but the predicted box with IoU=0.92 is compulsively assigned as a negative sample due to the slightly lower IoU, bringing inconsis-tent noisy samples for the training process. (c) FCOS uses a static center distribution for sampling. (d) IQDet samples training set according to an instance-wise dynamic distribution. gradually become the de-facto standard in object detection.
However, these sampling strategies might have a few limitations: (1) Static rules are not learnable and prediction-aware (e.g. center region and anchor-based), which may be not always the best choice for some eccentric object. (2) Some Dynamic rules like PAA might suffer from the noisy samples and per-sample quality rules, without jointly formulating a quality distribution in spatial dimensions, as shown in Fig. 1(b). (3) They sample uniformly over regu-lar grids of image owing to the dense prediction paradigm, which is difﬁcult to assemble enough high-quality and diverse samples. These methods might either Static or
Sample-wise, failing to completely solve these limitations.
In this paper, we propose an instance-wise(GT-wise) quality distribution for sampling to address these issues: in-stead of assigning each sample independently, the instance-wise sampling strategy selects training samples based on the quality distribution. To achieve dynamic sampling, we 1717
jointly model an instance-wise distribution from the net-work prediction, making it learnable and prediction-aware.
Specially, we optimize the quality distribution encoding function via a variational encoder, approximating the se-mantic pattern and appearance of the instance. This dy-namic quality distribution ﬁlters out noisy samples(shown in Fig. 1(b)) and is easier to be learned than previous sam-pling strategies. Owing to the previous per-pixel assign-ment depends on IoUs of each predicted boxes, the assign-ment of PAA [6] is unstable. Our assignment strategy is more robust and extracts the overall instance-wise feature to generate the assignment. And it can sample more high-quality samples, especially the location in the center of the
Gaussian.
Further, we use this distribution to guide sample se-lection in both spatial and scale dimensions, as shown in
Fig. 1(d). Proper samples are resampled with higher prob-abilities and assigned by higher conﬁdences. Meanwhile, different from the traditional per-grid sampling strategy, we sample more positives from high-quality and diverse predic-tions with a ﬂoating-number coordinate, which may avoid the overﬁtting problem and improve the performance efﬁ-ciency. The entire process of instance-wise quality assign-ment and sampling are learnable and thus can be easily op-timized by back-propagation.
The contributions of this work are summarized as: 1 Our main contribution is to propose an instance-wise quality distribution, which is extracted from the regional feature of the ground-truth to approximate each predic-tion’s quality. It guides noise-robustly sampling and it is a prediction-aware strategy. 2 Besides, we formulate an assignment and resampling strategy according to the distribution. It is adapted to the semantic pattern and scale of each instance and simulta-neously training with sufﬁcient and high-quality samples. 3 We achieve state-of-the-art results on COCO dataset without bells and whistles. Our method leads to 2.8 AP improvements from 38.7 AP to 41.1 AP on single-stage method FCOS. ResNext-101-DCN based IQDet yields 51.6 AP, achieving state-of-the-art performance without introducing any additional overhead. 2.