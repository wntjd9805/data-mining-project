Abstract
Face restoration is important in face image processing, and has been widely studied in recent years. However, pre-vious works often fail to generate plausible high quality (HQ) results for real-world low quality (LQ) face images.
In this paper, we propose a new progressive semantic-aware style transformation framework, named PSFR-GAN, for face restoration. Speciﬁcally, instead of using an encoder-decoder framework as previous methods, we formulate the restoration of LQ face images as a multi-scale progressive restoration procedure through semantic-aware style trans-formation. Given a pair of LQ face image and its corre-sponding parsing map, we ﬁrst generate a multi-scale pyra-mid of the inputs, and then progressively modulate different scale features from coarse-to-ﬁne in a semantic-aware style transfer way. Compared with previous networks, the pro-posed PSFR-GAN makes full use of the semantic (parsing maps) and pixel (LQ images) space information from differ-ent scales of input pairs. In addition, we further introduce a semantic aware style loss which calculates the feature style loss for each semantic region individually to improve the details of face textures. Finally, we pretrain a face pars-ing network which can generate decent parsing maps from
∗ This work was done when he was an intern at Alibaba. real-world LQ face images. Experiment results show that our model trained with synthetic data can not only produce more realistic high-resolution results for synthetic LQ in-puts but also generalize better to natural LQ face images compared with state-of-the-art methods. 1.

Introduction
Blind face restoration refers to recovering the HQ images from the LQ inputs which suffer from unknown degradation such as low resolution, noise, blur and lossy compression.
It has drawn more and more interest due to its wide applica-tions. However, most current restoration methods still focus on a speciﬁc type of restoration, especially super resolution, and few of them can generalize well to real LQ images.
Unlike general image restoration, face restoration can exploit strong prior knowledge of the face to recover details of the face components even when the images are severely degraded. Therefore, many recent works about face su-per resolution incorporate face prior knowledge to improve the performance, such as parsing maps [4], face landmarks
[1, 5, 37] and identity prior [42]. Most of these works are based on an encoder-decoder like structure, which follow the practice of general image restoration and aim to learn a direct black-box mapping from LQ to HQ images. Al-11896
though they managed to get better results with extra face prior knowledge as inputs or supervision, few of them re-ports satisfactory results for real LQ images. Other methods
[22, 21] try to utilize high quality references to facilitate the restoration of LQ images. However, their practical applica-tions are limited when there are no high quality references.
In this work, we propose a new progressive framework, named PSFR-GAN, which formulates face restoration as multi-scale semantic-aware style transformation procedure.
Inspired by recent success of style based GAN, i.e., Style-GAN [15], we use a semantic-aware style transfer approach to modulate the features of different scales progressively. To be speciﬁc, the proposed PSFR-GAN starts with a learned constant latent code and then generates features of different scales through several upsample layers. We modulate the
“styles” of different scale features by generating the cor-responding style transformation parameters from different scale inputs. The LQ input provides color information and the parsing map provides shape and semantic information.
In this way, more details are added to the ﬁnal features in a coarse-to-ﬁne manner. In addition, we proposed a seman-tic aware style loss which calculates the gram matrix loss for each semantic region separately. Gram matrix loss is usually applied in neural style transfer [7], recent works [8] found it also effective in recovering textures. In this work, we show that the semantic aware style loss can help to im-prove the restoration of textures and alleviate the occurrence of artifacts in different face regions.
Finally, to make our framework more practical, we pre-train a face parsing network (FPN) for LQ face images. In-tuitively, predicting face parsing maps is easier than face restoration because we do not need to care the texture de-tails. Experiments demonstrate that the FPN is pretty robust on parsing real-world LQ face images. During test time, we
ﬁrst generate parsing maps for LQ inputs with FPN, and then produce the HQ outputs with PSFR-GAN.
Our contributions are summarized as follows: 1. We propose a novel multi-scale progressive framework for practical blind face restoration, i.e. PSFR-GAN.
Our model can recover high quality face details pro-gressively through semantic aware style transforma-tion with multi-scale LQ images and parsing maps as inputs. Compared with previous works, the proposed
PSFR-GAN can make better use of multi-scale inputs in both pixel domain and semantic domain. 2. We introduce the semantic aware style loss which helps to improve the texture restoration of different se-mantic regions and reduce the occurrence of artifacts. 3. Extensive experiments demonstrate that our model trained with synthetic dataset generalizes better to nat-ural LQ images than current state-of-the-arts. 4. By introducing a pretrained LQ face parsing network, our model can generate HQ images given only LQ in-puts, making it highly practical and applicable. 2.