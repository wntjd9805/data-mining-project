Abstract
The key to a successful cascade architecture for precise instance segmentation is to fully leverage the relationship between bounding box detection and mask segmentation across multiple stages. Although modern instance seg-mentation cascades achieve leading performance, they mainly make use of a unidirectional relationship, i.e., mask segmentation can beneﬁt from iteratively reﬁned bounding box detection. In this paper, we investigate an alternative direction, i.e., how to take the advantage of precise mask segmentation for bounding box detection in a cascade architecture. We propose a Deeply Shape-guided Cascade (DSC) for instance segmentation, which iteratively imposes the shape guidances extracted from mask prediction at previous stage on bounding box detection at current stage. forms a bi-directional relationship between the two
It (1) Initial tasks by introducing three key components: shape guidance: A mask-supervised Region Proposal
Network (mPRN) with the ability to generate class-agnostic masks; (2) Explicit shape guidance: A mask-guided region-of-interest (RoI) feature extractor, which employs mask segmentation at previous stage to focus feature extraction at current stage within a region aligned well with the shape of the instance-of-interest rather than a rectangular RoI; (3) Implicit shape guidance: A feature fusion operation which feeds intermediate mask features at previous stage to the bounding box head at current stage. Experimental results show that DSC outperforms the state-of-the-art instance segmentation cascade, Hybrid Task Cascade (HTC), by a large margin and achieves 51.8 box AP and 45.5 mask AP on COCO test-dev. The code is released at: https://github.com/hding2455/DSC. 1.

Introduction
Instance segmentation [1, 43, 44, 21, 14], an increasingly active research topic in recent years, is a combination of the elements from two classical computer vision tasks - object detection [19, 20, 46, 35, 45, 17, 31, 60] and semantic seg-(cid:0) Corresponding Author.
Figure 1: Instance segmentation on huddled instances. mentation [37, 12, 61, 59, 38, 22]. It is challenging since it requires not only classifying and localizing all the object instances correctly in an image, but also providing a precise segmentation mask for each instance at the same time.
To achieve precise instance segmentation, building a cascaded architecture [5] with multi-stage reﬁnement is a promising strategy. As pointed out in [9], the key to a suc-cessful cascade architecture for precise instance segmen-tation is to fully leverage the relationship between bound-ing box detection and mask segmentation across multiple stages. Surprisingly, we ﬁnd that leading instance segmen-tation cascades [6, 9], although achieving state-of-the-art performances, mainly make use of a unidirectional relation-ship, i.e., mask segmentation can beneﬁt from iteratively reﬁned bounding box detection. In this paper, we investi-gate the opposite direction, i.e., how to take the advantage of precise mask segmentation for bounding box detection.
Our aim is to establish a bi-directional relationship between bounding box detection and mask segmentation in a cas-cade architecture to boost the instance segmentation perfor-mance.
Towards this end, we propose a Deeply Shape-guided
Cascade (DSC) for instance segmentation, which iteratively imposes the shape guidances extracted from mask predic-tion at previous stage on bounding box detection at cur-rent stage. DSC plugs the intuitions of Deeply Supervised
Nets (DSN) [26, 54], i.e., 1) enforcing early supervision for intermediate stages and 2) fusing features across multi-ple stages beneﬁts representation learning, into an instance segmentation cascade. This leads to three key components for shape guidance learning: (1) Initial shape guidance: A mask-supervised Region Proposal Network (mPRN) with 8278
the ability to generate class-agnostic masks; (2) Explicit shape guidance: A mask-guided region-of-interest (RoI) feature extractor, based upon the segmented mask at pre-vious stage, focuses on extracting features within a region aligned with the shape of the instance-of-interest rather than a rectangular RoI at current stage; (3) Implicit shape guid-ance: A feature fusion operation which feeds intermedi-ate mask features at previous stage to the bounding box head at current stage. The shape guidances, either explic-itly or implicitly learned from mask-level supervision, are more informative than box-level supervision, and thus are able to help generate more precise bounding boxes. Then, these bounding boxes can lead to more accurate segmented masks. This forms a positive feedback loop between bound-ing box detection and mask segmentation across multiple stages in the cascade, facilitating achieving precise instance segmentation.
DSC is easy to implement and can be trained end-to end. Without bells and whistles, on average, it consistently outperforms the state-of-the-art instance segmentation cas-cade, HTC [9], with different backbones by 2.1 box AP and 1.5 mask AP on COCO 2017 val and 1.9 box AP and 1.4 mask AP on COCO 2017 test-dev, thanks to the positive feedback loop between mask prediction and bounding box detection. It is worth mentioning that DSC is good at segmenting huddled instances, i.e., instances that are crowded together as shown in Fig.1, beneﬁted from the shape guidances. We carefully select a subset of COCO 2017 val which contains a high portion of huddle in-stances. DSC achieves signiﬁcant improvements compared with other methods on this subset.
To sum up, our main contribution is the proposal of a new cascade architecture for precise instance segmentation.
It explores a different direction to leverage the relationship between bounding box detection and mask segmentation, forming a positive feedback loop between the two tasks by introducing shape guidances into bounding box detection. It achieves consistent and substantial improvements over the state-of-the-art instance segmentation cascade, Hybrid Task
Cascade (HTC) [9], on the COCO dataset. 2.