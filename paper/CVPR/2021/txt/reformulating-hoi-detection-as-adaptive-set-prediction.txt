Abstract
Determining which image regions to concentrate is crit-ical for Human-Object Interaction (HOI) detection. Con-ventional HOI detectors focus on either detected human and object pairs or pre-deﬁned interaction locations, which lim-its learning of the effective features. In this paper, we refor-mulate HOI detection as an adaptive set prediction prob-lem, with this novel formulation, we propose an Adaptive
Set-based one-stage framework (AS-Net) with parallel in-stance and interaction branches. To attain this, we map a trainable interaction query set to an interaction prediction set with transformer. Each query adaptively aggregates the interaction-relevant features from global contexts through multi-head co-attention. Besides, the training process is supervised adaptively by matching each ground-truth with the interaction prediction. Furthermore, we design an ef-fective instance-aware attention module to introduce in-structive features from the instance branch into the inter-action branch. Our method outperforms previous state-of-the-art methods without any extra human pose and lan-guage features on three challenging HOI detection datasets.
Especially, we achieve over 31% relative improvement on a large scale HICO-DET dataset. Code is available at https://github.com/yoyomimi/AS-Net. 1.

Introduction
Human-Object Interaction (HOI) detection aims to iden-tify HOI triplets <human, verb, object> from a given im-age, it is an important step toward the high-level semantic understanding [8, 26, 46, 18, 17, 19, 6, 7, 44]. Conven-tional HOI methods can be divided into two-stage meth-ods [38, 3, 10, 25, 24, 14, 9, 35] and one-stage meth-ods [20, 27]. Most two-stage methods detect instances (hu-mans and objects), and match the detected humans and ob-jects one by one to form pair-wise proposals in the ﬁrst stage. Next, in the second stage, such methods infer the interactions based on the features of cropped human-object
*Equal contribution
†Corresponding author (liusi@buaa.edu.cn) (a) Union boxes: verb "direct" in yellow, "drive"  in purple, matched anchor in red. (b) Interaction midpoints: verb "direct" in yellow, 
"drive" in purple, matched point in red.
Aggregated Features
Ground-truth
Interaction 
Query Set
…
Interaction 
Prediction Set
… drive direct
Adaptive Feature Aggregation
Adaptive Set-based Ground-truth Matching (c) Our adaptive set prediction method: verb "drive" in purple, "direct" in yellow. Interaction vectors  point from human centers to object centers. The features aggregated by queries are visualized at left.
Figure 1. Both the anchor-based (a) and point-based (b) one-stage methods infer two different interactions “drive” and “direct” are at similar location and concentrate on the similar features. Our set prediction method (c) maps an interaction query set to an inter-action prediction set by an interaction decoder. Then, interaction predictions are adaptively matched with ground-truth. To attain this, we ﬁrst train a set of learnable embeddings as an interaction query set. Next, each interaction query adaptively aggregates the interaction-relevant features by co-attention. Finally, we match each ground-truth with prediction for adaptive supervision. This mechanism empowers our method to accurately predict two inter-actions for “drive” and “direct”. Best viewed in color. pair-wise proposals. Two-stage methods have made great progress in HOI detection, however, their efﬁciency and ef-fectiveness are limited by their serial architectures. With the development of one-stage object detectors, one-stage HOI detectors [20, 27] have raised a new fashion. Existing one-stage HOI detectors formulate HOI detection as a parallel detection problem, which detects the HOI triplets from an image directly. One-stage methods have delivered great im-provements in both efﬁciency and effectiveness.
Determining which regions to concentrate on is criti-cal and challenging for HOI detectors. To obtain essen-tial features for interaction prediction, conventional two-9004
stage methods usually involve extra features, e.g., human pose [38, 5, 24, 14] and language [43, 9, 30, 21]. However, even with extra features, two-stage methods still focus on the detected instances that might be inaccurate, which are less adaptive and limited by the detected instances. One-stage methods partially alleviate these issues by inferring interactions directly from the whole image. Such meth-ods intuitively deﬁne a location-relative medium to predict interactions, and can be mainly divided into anchor-based methods and point-based methods. Anchor-based meth-ods [20] predict the interactions based on the union box of each pair-wise human and object instances. While point-based methods [27] infer the interaction midpoint of each corresponding human-object pair. However, we argue that it is sub-optimal to predict the interaction through a pre-deﬁned interaction location. Figure 1 illustrates an example.
The interaction “direct” (in yellow) and “drive” (in purple) are quite different and thus require different visual features for interaction prediction. However, their union boxes are considerably overlapped (Figure 1 (a)), and their interaction midpoints are very close (Figure 1 (b)). Therefore, these one-stage methods concentrate on similar visual features for the two different interactions.
To further address the limitation of interaction location in one-stage methods, we reformulate interaction detection as a set-based prediction problem. We deﬁne an interac-tion query set with several learnable embeddings, and an interaction prediction set. Each embedding in the query set is mapped by a transformer based interaction decoder to an interaction prediction set. By feeding the interac-tion query set into a multi-head co-attention module, we are able to adaptively aggregate features from global contexts.
Our proposed method matches each ground-truth with the resembling interaction prediction for adaptive supervision.
Therefore, our proposed method adaptively concentrates on the most suitable features for each prediction, free from the location limitation of conventional one-stage methods. As demonstrated in Figure 1 (c), our method aggregates arm features of the left person and pose features of the right per-son to make two different interaction predictions. The pre-dictions are then matched with the ground-truth interaction
“direct” and “drive” respectively.
To this end, we propose a novel Adaptive Set-based one-stage framework, namely AS-Net. Our AS-Net consists of two parallel branches: an instance branch and an interac-tion branch. Both branches leverage a transformer encoder-decoder structure, which utilize global features to perform set predictions. The instance branch predicts location and category for each instance, while the interaction branch pre-dicts interaction vectors and their corresponding categories.
The interaction vectors point from the centers of the human instances to the centers of the object instances. We obtain the predicted interaction triplets by matching each interac-tion vector from the interaction branch with the detected instances from the instance branch. Besides, we exploit an instance-aware attention module in a co-attention manner to perform branch aggregation. Speciﬁcally, this module aggregates information in the instance branch and intro-duces the aggregated features into the interaction branch.
We also utilize semantic embeddings to perform more ac-curate human-object matching.
We test our proposed AS-Net on three datasets, i.e.,
HICO-Det [34], V-COCO [13], and HOI-A [27]. Our pro-posed AS-Net outperforms all the other algorithms among all datasets. In speciﬁc, our proposed AS-Net has gained 31% relative improvement comparing to the previous state-of-the-art one-stage method [27] on HICO-DET.
Our contributions can be concluded in the following three aspects:
• We formulate HOI detection as a set prediction prob-lem, which breaks the instance-centric limitation and location limitation of the existing methods. Thereby, our method can adaptively concentrate on the most suitable features to improve the predicting accuracy.
• We propose a novel one-stage transformer-based HOI detection framework, namely AS-Net. We also design an instance-aware attention module to introduce the in-formation in the instance branch into the interaction branch.
• Without introducing any extra features, our method outperforms all the previous state-of-the-art methods, achieving 31% relative improvement over the second best one-stage method on the HICO-DET dataset. 2.