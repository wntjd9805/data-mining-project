Abstract
Softmax loss
SCL
Face forgery detection is raising ever-increasing interest in computer vision since facial manipulation technologies cause serious worries. Though recent works have reached sound achievements, there are still unignorable problems: a) learned features supervised by softmax loss are separa-ble but not discriminative enough, since softmax loss does not explicitly encourage intra-class compactness and inter-class separability; and b) ﬁxed ﬁlter banks and hand-crafted features are insufﬁcient to capture forgery patterns of fre-quency from diverse inputs. To compensate for such limita-tions, a novel frequency-aware discriminative feature learn-ing framework is proposed in this paper. Speciﬁcally, we de-sign a novel single-center loss (SCL) that only compresses intra-class variations of natural faces while boosting inter-class differences in the embedding space. In such a case, the network can learn more discriminative features with less optimization difﬁculty. Besides, an adaptive frequency feature generation module is developed to mine frequency clues in a completely data-driven fashion. With the above two modules, the whole framework can learn more discrim-inative features in an end-to-end manner. Extensive experi-ments demonstrate the effectiveness and superiority of our framework on three versions of the FF++ dataset. 1.

Introduction
Beneﬁting from the great progress made in deep learn-ing, the Variational AutoEncoders [21, 35] and Generative
Adversarial Networks based [15] face manipulation tech-nology [38, 23, 44] enables ordinary people without profes-sional skills and equipment to generate high-quality forged faces. Derived from that, certain free apps [2] and open-source projects [1, 3] quickly arise and gain popularity ex-plosively. Unluckily, the technology may be abused for ma-licious purposes, causing severe trust issues in our soci-ety. Although digital forensics experts can analyze some in-∗Corresponding author
Manipulated face
Natural face
Center point
Decision boundary
Figure 1. The feature distribution of samples in the embed-ding space. Left: learned features supervised by softmax loss are broadly separable but not discriminative enough, since the intra-class compactness and inter-class separability are not explicitly constrained. Right: our SCL only encourages the intra-class com-pactness of natural faces when constraining inter-class separabil-ity.
ﬂuential videos for evidence of manipulation, they will be helpless in reviewing countless videos uploaded to the In-ternet every day. Thus, it is of high signiﬁcance to develop efﬁcient automatic detection algorithms.
Towards such a concern, many methods have been pro-posed successively. Early research is keen on utilizing hand-crafted features or modifying the structure of existing neural networks[47, 5, 4, 34]. However, with remarkable progress made in facial synthesis technology [20, 46, 12], such meth-ods have been unable to reliably detect face forgery. After that, the research mainstream is gradually turning to meth-ods that introduce different information and prior knowl-edge into backbone networks [10, 33, 29]. For example,
DeepRhythm [33] utilizes the minuscule periodic changes of skin color due to blood pumping through the face.
In essence, all current popular detection methods are us-ing the powerful data ﬁtting capability of neural networks to extract discriminative features for face forgery detec-tion. And detection methods based on deep learning usu-ally pose face forgery detection as a binary classiﬁcation 6458
problem and use softmax loss1 to supervise the training of
CNN networks. However, learned features supervised by softmax loss are not discriminative enough, since softmax loss does not explicitly encourage intra-class compactness and inter-class separability, as illustrated in the left of Fig-ure 1. Recent work [22] has noticed this problem and at-tempted to utilize triplet loss [37] to extract discriminative features. However, regular metric learning methods usually indiscriminately encourage the intra-class compactness of natural and manipulated faces in the embedding space. Ad-ditionally, feature distributions of manipulated faces vary from one manipulation method to another considering var-ious GAN ﬁngerprints [48] and some unique operations, as shown in the left of Figure 1, making it nontrivial to aggregate all the manipulated faces. Therefore, constrain-ing intra-class compactness of samples generated by varied manipulation methods usually leads to a sub-optimal solu-tion because of optimization difﬁculty and even damages the performance owing to overﬁtting.
In addition, frequency-related cues are increasingly im-portant for forgery detection since it’s hard to ﬁnd visual forgery clues. Although some studies [29, 9, 41, 13] have introduced frequency information and achieved remarkable results, their abilities to extract discriminative features are limited because of employing ﬁxed ﬁlter banks and hand-crafted features. These methods based on incomprehensive prior knowledge are insufﬁcient to capture subtle forgery patterns from the frequency domain due to the diversity of background, gender, age, manipulation methods, etc.
With the above thoughts in mind, we propose a novel
Frequency-aware Discriminative Feature Learning frame-work(FDFL). Explicitly, our framework mainly addresses two problems: a) how to adopt metric learning to learn more discriminative features for face forgery detection; and b) how to adaptively extract frequency-related features. Cor-responding to the two problems, two sub-modules are de-veloped: single-center loss (SCL) and adaptive frequency feature generation module (AFFGM), as shown in Figure 2.
In speciﬁc, our single-center loss aims at only reducing intra-class variations of natural faces while increasing inter-class differences in the embedding space, as shown in the right of Figure 1. To this end, SCL minimizes the distance from representations of natural faces to the center point.
Meanwhile, SCL encourages the distance from manipulated faces to the center point greater than from natural faces by at least a margin. Unlike regular metric learning methods,
SCL does not restrict the intra-class compactness of ma-nipulated faces, which agrees better with the characteristics of feature distribution of manipulated faces. Therefore, the network supervised by SCL can learn more discriminative features with less optimization difﬁculty. As for frequency-1Following [27], we deﬁne the softmax loss as the combination of the last fully connected layer, softmax function, and cross-entropy loss. related features, we develop an AFFGM consisting of a special data preprocessing and adaptive frequency informa-tion mining block (AFIMB). The data preprocessing keeps the position relationship of image blocks in the spatial do-main consistent with their position relationship in the fre-quency domain. In such a case, the preprocessed data is able to directly employ the existing convolution network. The
AFIMB adaptively mines frequency clues in a data-driven fashion, which avoids utilizing too much incomprehensive prior knowledge. Compared to ﬁxed ﬁlter banks and hand-crafted features, AFFGM can capture forgery clues more
ﬂexibly in the frequency domain.
Extensive experiments demonstrate the effectiveness and superiority of our framework and we achieve state-of-the-art results on three versions of the FF++ dataset [36]. Our contributions can be summarized as follows:
•
•
•
We propose a novel Frequency-aware discriminative feature learning framework which adopts metric learn-ing and adaptive frequency features learning for face forgery detection.
A single-center loss is designed to only compress intra-class variations of natural faces while boosting inter-class differences in the embedding space.
An adaptive frequency feature generation module is developed to mine subtle artifacts from the frequency domain in a data-driven fashion. 2.