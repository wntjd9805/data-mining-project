Abstract
Weakly supervised object localization (WSOL) remains an open problem given the deﬁciency of ﬁnding object extent information using a classiﬁcation network. Although prior works struggled to localize objects through various spatial regularization strategies, we argue that how to extract object structural information from the trained classiﬁcation network is neglected. In this paper, we propose a two-stage approach, termed structure-preserving activation (SPA), to-ward fully leveraging the structure information incorporated in convolutional features for WSOL. First, a restricted acti-vation module (RAM) is designed to alleviate the structure-missing issue caused by the classiﬁcation network on the ba-sis of the observation that the unbounded classiﬁcation map and global average pooling layer drive the network to focus only on object parts. Second, we designed a post-process approach, termed self-correlation map generating (SCG) module to obtain structure-preserving localization maps on the basis of the activation maps acquired from the ﬁrst stage. Speciﬁcally, we utilize the high-order self-correlation (HSC) to extract the inherent structural information retained in the learned model and then aggregate HSC of multiple points for precise object localization. Extensive experiments on two publicly available benchmarks including CUB-200-2011 and ILSVRC show that the proposed SPA achieves substantial and consistent performance gains compared with baseline approaches. Code and models are available at github.com/Panxjia/SPA CVPR2021. 1.

Introduction
Weakly supervised object localization (WSOL) requires the image-level annotations indicating the presence or
*Equal contribution
†Corresponding author
Figure 1. Self-correlation maps corresponding to the image positions masked by red crosses. The 2nd and 3rd rows are the
ﬁrst- and second-order self-correlation maps, respectively. absence of a class of objects in images to learn localization models [17, 18, 19, 35, 29, 28]. In recent years, WSOL has attracted increasing attention because it can leverage rich
Web images with tags to learn object-level models.
As a work for WSOL, Class Activation Mapping (CAM) [43] uses the intermediate classiﬁer activation to discover discriminative image regions for target object localization [4]. Afterward, divergent activation methods [23, 35, 37] design multiple parallel branches or introduce attention modules to drive networks learning complete object extent. Adversarial erasing methods [5, 15, 33, 39] pursue learning full object extent in a hide-and-seek fashion.
Existing methods [15, 33, 39] largely depend on CAM and spatial regularization to localize objects, e.g., expanding activated regions to full object extent; however, preserving the structure of object is unfortunately neglected.
Through experiments, we observed that the head structure of the classiﬁcation network causes the CAM missing object structure information contained in convolutional features.
Speciﬁcally, the network driven by sole classiﬁcation loss tends to activate a small proportion of features with largest discriminative capability while depressing the majority of 111642
object extent. Furthermore, many CAM-based methods employ a global average pooling (GAP) [13] layer atop the feature maps to retain the localization information. The GAP layer treats each pixel within the feature map equally, which hinders distinguishing true objects from noisy background.
The inherent spatial correlation in CNNs has been widely used in image classiﬁcation and object detection areas [2, 31, 32], but remains unexploited for WSOL. Following the self-attention mechanism, recent works [32, 41, 42] adopted the ﬁrst-order pixel-wise correlation to improve object localization. However, pixels of one object usually have dissimilar features for the large appearance variation, which limits the capability of the ﬁrst-order self-correlation to preserve object structural information, Fig. 1 (2nd row).
In this study, we propose a two-stage WSOL approach, termed structure-preserving activation (SPA), for accurate object localization using sole image-level category labels as supervision. First, a restricted activation module (RAM) is designed to avoid the misleading by local extremely high response for classiﬁcation by suppressing the response value range of CAM and differentiate objects from background under the guidance of estimated pseudo-masks. Second, a self-correlation map generating (SCG) module is proposed to reﬁne the localization map under the guidance of the structural information extracted from trained features. In
SCG, to guide the activation of objects, we propose to use the high-order self-correlation (HSC) which facilities capturing precise spatial layouts of objects by long-range spatial correlations, Fig. 1 (3rd row). We conduct extensive experiments on the CUB-200-2011 [27] and ILSVRC [20].
Our method obtains signiﬁcant gains compared with baseline methods and achieve comparable results with the SOTAs on bounding box and mask localization.
The contributions of this study include:
• We unveil that spatial structure preserving is crucial to discover the localization information contained in convolutional features for WSOL.
• We propose a simple-yet-effective SPA approach to distill the structure-preserving ability of features for accurate object localization.
• With negligible computational complexity and cost overheads, our proposed approach shows consistent and substantial gains across CUB-200-2011 and ILSVRC datasets for bounding box and mask localization. 2.