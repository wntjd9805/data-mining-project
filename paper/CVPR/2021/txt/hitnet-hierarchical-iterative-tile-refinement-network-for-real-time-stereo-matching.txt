Abstract
This paper presents HITNet, a novel neural network ar-chitecture for real-time stereo matching. Contrary to many recent neural network approaches that operate on a full cost volume and rely on 3D convolutions, our approach does not explicitly build a volume and instead relies on a fast multi-resolution initialization step, differentiable 2D geometric propagation and warping mechanisms to infer disparity hy-potheses. To achieve a high level of accuracy, our net-work not only geometrically reasons about disparities but also infers slanted plane hypotheses allowing to more accu-rately perform geometric warping and upsampling opera-tions. Our architecture is inherently multi-resolution allow-ing the propagation of information across different levels.
Multiple experiments prove the effectiveness of the proposed approach at a fraction of the computation required by state-of-the-art methods. At the time of writing, HITNet ranks 1st-3rd on all the metrics published on the ETH3D website for two view stereo, ranks 1st on most of the metrics amongst all the end-to-end learning approaches on Middlebury-v3, ranks 1st on the popular KITTI 2012 and 2015 benchmarks among the published methods faster than 100 ms. 14362
1.

Introduction
Recent research on depth from stereo matching has largely focused on developing accurate but computationally expensive deep learning approaches. Large convolutional neural networks (CNNs) can often use up to a second or even more to process an image pair and infer a disparity map. For active agents such as mobile robots or self driving cars such a high latency is undesirable and methods which are able to process an image pair in a matter of millisec-onds are required instead. Despite this, only 4 out of the top 100 methods on the KITTI 2012 leaderboard are published approaches that take less than 100ms1.
A common pattern in end-to-end learning based ap-proaches to computational stereo is utilizing a CNN which is largely unaware of the geometric properties of the stereo matching problem. In fact, initial end-to-end networks were based on a generic U-Net architecture [37]. Subsequent works have pointed out that incorporating explicit match-ing cost volumes encoding the cost of assigning a disparity to a pixel, in conjunction with 3D convolutions provides a notable improvement in terms of accuracy but at the cost of signiﬁcantly increasing the amount of computation [24].
Follow up work [25] showed that a downsampled cost vol-ume could provide a reasonable trade-off between speed and accuracy. However, the downsampling of the cost vol-ume comes at the price of sacriﬁcing accuracy.
Multiple recent stereo matching methods [51, 12, 28] have increased the efﬁciency of disparity estimation for active stereo while maintaining a high level of accuracy.
These methods are mainly built on three intuitions: Firstly, the use of compact/sparse features for fast high resolution matching cost computation; Secondly, very efﬁcient dispar-ity optimization schemes that do not rely on the full cost volume; Thirdly, iterative image warps using slanted planes to achieve high accuracy by minimizing image dissimilarity.
All these design choices are used without explicitly operat-ing on a full 3D cost volume. By doing so these approaches achieve very fast and accurate results for active stereo but they do not directly generalize to passive stereo due to the lack of using a powerful machine learning system. This therefore raises the question if such mechanisms can be in-tegrated into neural network based stereo-matching systems to achieve efﬁcient and accurate results opening up the pos-sibility of using passive stereo based depth sensing in la-tency critical applications.
We propose HITNet, a framework for neural network based depth estimation which overcomes the computational disadvantages of operating on a 3D volume by integrating image warping, spatial propagation and a fast high resolu-tion initialization step into the network architecture, while 1Additional approaches faster than 100ms are on the leaderboard but the algorithms are unpublished and hence it is unknown how the results were achieved. keeping the ﬂexibility of a learned representation by allow-ing features to ﬂow through the network. The main idea of our approach is to represent image tiles as planar patches which have a learned compact feature descriptor attached to them. The basic principle of our approach is to fuse information from the high resolution initialization and the current hypotheses using spatial propagation. The propa-gation is implemented via a convolutional neural network module that updates the estimate of the planar patches and
In order for the network to itera-their attached features. tively increase the accuracy of the disparity predictions, we provide the network a local cost volume in a narrow band (±1 disparity) around the planar patch using in-network im-age warping allowing the network to minimize image dis-similarity. To reconstruct ﬁne details while also capturing large texture-less areas we start at low resolution and hi-erarchically upsample predictions to higher resolution. A critical feature of our architecture is that at each resolution, matches from the initialization module are provided to facil-itate recovery of thin structures that cannot be represented at low resolution. An example output of our method shows how our network recovers very accurate boundaries, ﬁne detail and thin structures in Fig. 1.
To summarize, our main contributions are:
• A fast multi-resolution initialization step that com-putes high resolution matches using learned features.
• An efﬁcient 2D disparity propagation that makes use of slanted support windows with learned descriptors.
• State-of-art results in popular benchmarks using a frac-tion of the computation compared to other methods. 2.