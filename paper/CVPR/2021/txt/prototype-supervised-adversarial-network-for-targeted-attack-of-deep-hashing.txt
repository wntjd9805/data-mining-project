Abstract
Due to its powerful capability of representation learning and high-efﬁciency computation, deep hashing has made signiﬁcant progress in large-scale image retrieval. How-ever, deep hashing networks are vulnerable to adversarial examples, which is a practical secure problem but seldom studied in hashing-based retrieval ﬁeld. In this paper, we propose a novel prototype-supervised adversarial network (ProS-GAN), which formulates a ﬂexible generative archi-tecture for efﬁcient and effective targeted hashing attack.
To the best of our knowledge, this is the ﬁrst generation-based method to attack deep hashing networks. Generally, our proposed framework consists of three parts, i.e., a Pro-totypeNet, a generator and a discriminator. Speciﬁcally, the designed PrototypeNet embeds the target label into the semantic representation and learns the prototype code as the category-level representative of the target label. More-over, the semantic representation and the original image are jointly fed into the generator for ﬂexible targeted attack.
Particularly, the prototype code is adopted to supervise the generator to construct the targeted adversarial example by minimizing the Hamming distance between the hash code of the adversarial example and the prototype code. Further-more, the generator is against the discriminator to simul-taneously encourage the adversarial examples visually re-alistic and the semantic representation informative. Exten-sive experiments verify that the proposed framework can ef-ﬁciently produce adversarial examples with better targeted attack performance and transferability over state-of-the-art targeted attack methods of deep hashing. 1.

Introduction
With the explosive growth of high-dimensional and large-scale multimedia data, approximate nearest neighbor
*Equal contribution
†Corresponding author (ANN) search [1] has attracted much attention in informa-tion retrieval due to its efﬁciency and effectiveness. As a solution of ANN, hashing [40] maps high-dimension data to compact binary codes meanwhile preserving the seman-tic similarities, yielding signiﬁcant advantages in storage cost and retrieval speed. Beneﬁting from the strong rep-resentation ability of deep learning, deep hashing that em-ploys deep neural networks (DNNs) to automatically ex-tract features has achieved great success in learning to hash
[42, 21, 47, 26, 28, 5], and also has been demonstrated its superior performance than the shallow hashing methods.
Notably, recent studies [38, 12, 20, 29, 6] have recog-nized that DNNs are usually vulnerable to adversarial ex-amples, which are intentionally perturbed by adding imper-ceptible noises to original images but can fool the networks to make incorrect predictions. Deep hashing methods have achieved encouraging performance on many benchmarks, while, at the same time, they inevitably inherit the funda-mental fragility of DNNs on handling adversarial examples
[44, 2]. This imperceptible malicious attack poses a serious security threat to the deep hashing-based image retrieval.
For example, when querying with an intentionally perturbed dog image, a hashing based retrieval system may return vio-lent images. Accordingly, it is necessary to study the adver-sarial attacks on deep hashing models in order to recognize their ﬂaws and help solve their security risks.
Currently, many works about adversarial examples have been studied in image classiﬁcation, but very few researches focus on the security of deep hashing based retrieval. Dif-ferent from the typical classiﬁcation, hashing aims to learn the semantic similarity between images, and its ﬁnal out-puts are discrete binary codes instead of categories. Thus, these attack methods in image classiﬁcation cannot be di-rectly used or transferred to the deep hashing tasks. Ex-isting adversarial attack methods of deep hashing only in-clude an non-targeted attack method called HAG [44] and two targeted attack methods called P2P [2] and DHTA [2], respectively. Notwithstanding, they are veriﬁed to be ef-16357
Figure 1. The framework of our Prototype-supervised Adversarial Network (ProS-GAN). fective in attack, there are still some signiﬁcant limitations hindering the current adversarial attacks in deep hashing.
On one hand, these methods are inefﬁcient because they are optimization-based methods that rely on a very time-consuming iterative gradient. For example, to make the attacked hashing model bias signiﬁcantly, DHTA requires around 2000 iterations to optimize adversarial perturba-tions. On the other hand, these methods heuristically select a hash code as representative of the target label to guide the generation of the targeted adversarial example. However, this code can not represent the discriminative category-level semantics of the target label due to lack of preserving simi-larity with relevant labels and dissimilarity with irrelevant labels. Therefore, how to construct more representative semantic-preserving hash code of the target label becomes crucially important to achieve satisfactory performance in adversarial attack of deep hashing.
To overcome the above deﬁciencies and inspired by generation-based adversarial attacks [3, 43, 13] in classiﬁ-cation, this paper proposes a prototype-supervised adversar-ial network (ProS-GAN) for efﬁcient and effective targeted attack in deep hashing based retrieval. By feeding an origi-nal image and a target label into ProS-GAN, it can generate the targeted adversarial example, which would mislead the attacked hashing network to retrieve the images semanti-cally related to the target label. Speciﬁcally, ProS-GAN is composed of three sub-networks: a prototype network (Pro-totypeNet), an adversarial generator network and a discrim-inator network, as shown in Figure 1. The designed Pro-totypeNet encodes the input target label into the semantic representation and learns the prototype code as the repre-sentative of the target label. Then, the adversarial genera-tor incorporates the original image and the semantic repre-sentation into a self-reconstruction network for generating the adversarial example. Moreover, the prototype code is adopted to supervise the generator to construct the targeted adversarial example by minimizing the Hamming distance between the hash code of the adversarial example and the
In addition, the discriminator is used to prototype code. distinguish real/fake images and categorize them into the original and target categories, respectively. The generator and discriminator are trained in an adversarial manner to encourage the generated images visually realistic and the semantic representation informative for further improving the targeted attack performance. In summary, the main con-tributions are outlined as follows:
• We propose a novel prototype-supervised adversarial network* (ProS-GAN) for ﬂexible targeted hashing at-tack. To the best of our knowledge, this is the very
ﬁrst work of formulating a generative architecture for arbitrary-target attack in deep hashing based retrieval.
Importantly, different from the existing attack meth-ods, our work could efﬁciently and effectively gener-ate preferable adversarial examples with robust trans-ferability under one-forward pass.
*Code: https://github.com/xunguangwang/ProS-GAN 16358
• Instead of heuristically selecting a hash code as rep-resentative of the target label, we leverage the invari-ant side of semantics to generate the ﬂexible prototype code in our ProtypeNet as the expected mainstay of the target label from the optimization view.
• Extensive experiments validate the superior efﬁciency and transferability of the produced adversarial exam-ples than state-of-the-art targeted attack methods in deep hashing based retrieval. 2.