Abstract
Open compound domain adaptation (OCDA) is a do-main adaptation setting, where target domain is modeled as a compound of multiple unknown homogeneous domains, which brings the advantage of improved generalization to unseen domains.
In this work, we propose a principled meta-learning based approach to OCDA for semantic seg-mentation, MOCDA, by modeling the unlabeled target do-main continuously. Our approach consists of four key steps.
First, we cluster target domain into multiple sub-target do-mains by image styles, extracted in an unsupervised man-ner. Then, different sub-target domains are split into inde-pendent branches, for which batch normalization parame-ters are learnt to treat them independently. A meta-learner is thereafter deployed to learn to fuse sub-target domain-speciﬁc predictions, conditioned upon the style code. Mean-while, we learn to online update the model by model-agnostic meta-learning (MAML) algorithm, thus to further improve generalization. We validate the beneﬁts of our ap-proach by extensive experiments on synthetic-to-real knowl-edge transfer benchmark, where we achieve the state-of-the-art performance in both compound and open domains. 1.

Introduction
Semantic segmentation with minimal supervision is one of the most sought-after goals of image understanding [23, 56]. Unfortunately, the learned understanding in one do-main does not generalize to the images from other do-mains [4]. In such cases, domain adaptation aims at trans-ferring the shared knowledge across different but related domains [41], i.e., source and target, using the unlabeled images from the target. When the target domain images are collected in mixed, continually varying, and even un-seen conditions, understanding images invites the problem of open compound domain adaptation [35]. (a) Traditional Domain Adaptation (b) Cluster/Split (c) Fuse (d) Update
Figure 1: (a) The traditional unsupervised domain adapta-tion (UDA) vs. (b,c,d) the proposed meta-based open com-pound domain adaptation (MOCDA). Unlike the traditional
UDA, MOCDA treats target as a compound of multiple un-known sub-domains. These sub-domains are discovered and processed using the cluster and the split module (b).
The fuse module (c) then combines the sub-domain splits as basis (dash lines). On open domains, MOCDA adapts through online update during inference (blue arrow) in (d).
Meta-learning serves in the fuse and the update module.
The Open Compound Domain Adaptation (OCDA) treats the target as a compound of multiple unknown sub-domains. Such assumption has been shown to be very promising by Liu et al. [35] for many practical settings of image classiﬁcations. However, the method developed in
[35] does not fully exploit the same assumption for the task of image segmentation. 1 In this work, we show that the 1OCDA [35] does not fully exploit the domain information for seg-8344
homogeneous sub-domain assumption can be exploited ef-fectively also for image segmentation. We propose a novel meta-learning based approach to OCDA (abbreviated as
MOCDA) that consists of four modules: cluster; split; fuse; and update, as illustrated in Fig. 1.
Similar to OCDA, the proposed MOCDA utilizes two image sets for training from: a single labeled source do-main; and a diverse unlabeled target domain, which is assumed to be a compound of multiple unknown sub-domains. Such an assumption is suitable for real challeng-ing situations, where the target domain is a combination of many factors including diverse weather, cities, and acqui-sition time [45, 13, 40]. The considered learning setup not only performs domain adaptation to the compound target domain, but also has generalization potential to unseen open domains.
In this context, the process of domain adapta-tion happens to exhibit a meta-behaviour [29, 3, 12], which learned dynamically makes the open world semantic seg-mentation possible. In this work, we show that the meta-behaviour of OCDA can be learned using (a) a hypernet-work for dynamic fusion of knowledge, and (b) the online update. On the one hand, the update process – which is carried out using the model-agnostic meta-learning strategy – creates an opportunity for better open set generalization with only one gradient step. On the other hand, the learned dynamic fusion allows images to appear from the continu-ous manifold of the compound target domain.
In essence, the proposed framework serves in following four steps. (i) From target images, style codes are extracted (ii) For each cluster, and grouped into multiple clusters. a set of batch normalization (BN) parameters are learned. (iii) Corresponding to each cluster, each image can have different domain-speciﬁc predictions. The hypernetwork, then, learns to fuse these predictions. (iv) Model-agnostic meta-learning (MAML) [15] is exploited during hypertrain-ing process, endowing the online update ability of the model on open domain during inference stage. The key contribu-tions of this paper can be summarized as follows:
• We propose a novel framework for semantic segmen-tation in the OCDA setting. We use meta-learning in the dynamic fusion and MAML strategy based online update, to address the limitations of [35].
• We propose to model the compound target domain continuously, taking the sub-target domain as the ba-sis, which offers the advantage of adapting to target domain and generalizing to unseen open domains.
• We demonstrate the adequacy of image style features, learned in an unsupervised manner, for our meta-based method MOCDA. mentation task due to the inaccessibility of the domain encoder. Refer the original paper [35] for details.
• The proposed method provides the state-of-the-art re-sults in synthetic-to-real knowledge transfer bench-mark datasets, for both compound and open domains. 2.