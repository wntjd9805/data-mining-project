Abstract
Mainstream lane marker detection methods are imple-mented by predicting the overall structure and deriving parametric curves through post-processing. Complex lane line shapes require high-dimensional output of CNNs to model global structures, which further increases the de-In contrast, mand for model capacity and training data. the locality of a lane marker has ﬁnite geometric variations and spatial coverage. We propose a novel lane marker de-tection solution, FOLOLane, that focuses on modeling lo-cal patterns and achieving prediction of global structures in a bottom-up manner. Speciﬁcally, the CNN models low-complexity local patterns with two separate heads, the ﬁrst one predicts the existence of key points, and the second re-ﬁnes the location of key points in the local range and cor-relates key points of the same lane line. The locality of the task is consistent with the limited FOV of the feature in
CNN, which in turn leads to more stable training and better generalization. In addition, an efﬁciency-oriented decod-ing algorithm was proposed as well as a greedy one, which achieving 36% runtime gains at the cost of negligible per-formance degradation. Both of the two decoders integrated local information into the global geometry of lane markers.
In the absence of a complex network architecture design, the proposed method greatly outperforms all existing methods on public datasets while achieving the best state-of-the-art results and real-time processing simultaneously. 1.

Introduction
In autonomous driving system (ADS), lane detection plays an important role. On the one hand, the location of host and other trafﬁc participants in the lane forms the ba-sis of autonomous driving decisions. On the other hand, the geometry of a lane marker can be viewed as an impor-tant landmark of the environment and aligned with a high-resolution or vector map for high-precision positioning. At the same time, lane detection has been widely used in Ad-∗Z. Qu is the corresponding author. vanced Driver Assistance Systems (ADAS) and is the basis for some common features such as Lane Keep Assist (LKA) and Adaptive Cruise Control (ACC).
Recent advances in lane detection can be attributed to the development of convolutional neural networks (CNN).
Most existing methods adopt well-studied frameworks such as semantic segmentation and object detection to parse lane markers and transform the network output into parametric curves through post-processing. However, the mostly used frameworks can not be seamlessly generalized to curved-shaped lane lines because lane detection task requires pre-cise representation of local positions and global shapes si-multaneously, showing their own limitations.
The semantic segmentation-based approach predicts bi-nary masks of lane marker regions, inserts clustering mod-els into training and inference, groups masked pixels into individual instances, and ﬁnally uses curve ﬁtting to para-metric results. However, the clustering procedure compli-cates the training and inference pipeline. In addition, pixel-level inputs to curve ﬁtting are often redundant and noisy, all of which bring negative impact to the accuracy of the ﬁnal results. Fig.1(a) shows several cases where the prediction errors may increase. Object detection approaches are orig-inally designed for compact target and produce bounding box as output, which is insensitive to pixel-level error when faced with large-scale object. As for lane markers, they typically span half or more of the image, and pixel-level lo-calization errors signiﬁcantly impair detection performance, which can be attributed to the limited ﬁeld of view (FOV) of features learned through CNN being insufﬁcient to model content that is too far apart. Fig.1(b) illustrates the effect of
FOV in complex scenario. Moreover, most of these solu-tions model global geometry directly, and the network must produce high-dimensional outputs to describe the curves.
Theoretically, however, uncompact outputs increase the de-mand for data and model capacity, ultimately masking the generalization ability of the resulting model.
Although the global structure of lane markers has some complexity, we note that local lane markers are extremely simple and that global lane markers can be approximated by a combination of local line segments. Moreover, spa-14122
(a) Segmentation based method and intermediate results. (b) Object detection based method.
Figure 1. Pipeline of existing methods and illustration of common error prediction. (a). the enlarged window in the middle of the pipeline shows the incorrect clustering of the segmentation mask, and the other two orange windows in the curve ﬁtting output show the position deviation of the prediction curve due to redundant and noisy pixels, note the solid line is ground truth, dotted line is pre-diction. (b). shows the inﬂuence of FOV in detection based meth-ods, the brightness of the right image reﬂects the practical FOV of anchor. tial locality is more suitable for modeling with CNN. Fol-lowing this intuition, a novel lane marker detection method,
FOLOLane, is proposed that focuses on modeling local ge-ometry and integrating them into the global results in a bottom-up manner. Speciﬁcally, the geometry of the lane marker is predicted by estimating adjacent keypoints on the it. In the bottom stage, a fully convolutional network is used to capture keypoints in the local scope through two sepa-rate heads. The ﬁrst one gives the probability that keypoints appear in pixel space, and the second one gives the offset between keypoints and the most spatially correlated local lane marker, which is used to reﬁne the positions of key-points generated by the ﬁrst head and construct associations between keypoints on the same lane markers. Based on the local information, two decoding algorithms with different preferences are proposed to predict global geometry of lane markers. The bottom-up pipeline of the proposed method is shown in Fig.2.
Compared with existing works [2, 19, 16, 10, 12], the proposed approach concentrates the capabilities of CNN on a local scale, which is suitable for CNN’s limited FOV, and signiﬁcantly reduces the complexity of the task and the di-mension of the output. As a result, the compact output leads to stable and efﬁcient training without additional effort in network architecture design and data collection. Consider-ing the continuity of lane markers, the proposed decoder is able to associate keypoints of the same instance and opti-mize the geometry of network predictions without affect-ing performance and efﬁciency. Furthermore, during net-work training and instance decoding, we model and predict keypoints using features with the highest spatial correlation guided by coarse-to-ﬁne strategies. The proposed bottom-up solution achieves the best state-of-the-art level, Acc: 96.92% on TuSimple and F1 score: 78.8% on CULane, and excellent generalization in the two public datasets. Together with the compatibility with network architectures, our ap-proach shows a promising application future.
We emphasize that our method is the ﬁrst to formulate lane detection into multi-key-points estimation and associ-ation problem, which is inspired by the bottom-up human pose estimation framework [15, 1, 3]. The proposed local scope based method avoids the inaccurate prediction where far from the anchor, which occurs in detection-based meth-ods. And the sparsity of key points prevents the noisy and redundant output occurred in segmentation-based methods, which decrease the precision and increase the delay of curve
ﬁtting. With extensive experiments, our solution proves the potential of applying pose estimation approaches on lane detection, which opens up a new direction to solve this im-portant application problem. Our solution does not depend on CNN architecture, is readily compatible to newly devel-oped architecture and shows scalable potential on accuracy and efﬁciency.
Our contributions can be summarized as follows:
• Lane detection is ﬁrstly decompose into subtasks of modelling local geometry, which is achieved by es-timating keypoints on local curve. Simpliﬁed targets and focus on spatially limited scope helps the network to provide precise estimation of local curve.
• Two decoding algorithms with different preferences are designed to integrate local information into global prediction, which enable the system to achieve high accuracy in ultra real time.
• Experimental results showed that our approach out-performs all existing methods by a substantial margin.
Besides, our model shows the best generalization abil-ity in comparison, which further proves the potential for productization. 2.