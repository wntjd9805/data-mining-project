Abstract
The facial expression analysis requires a compact and
In this paper, identity-ignored expression representation. we model the expression as the deviation from the iden-tity by a subtraction operation, extracting a continuous and identity-invariant expression embedding. We propose a De-viation Learning Network (DLN) with a pseudo-siamese structure to extract the deviation feature vector. To reduce the optimization difﬁculty caused by additional fully con-nection layers, DLN directly provides high-order polyno-mial to nonlinearly project the high-dimensional feature to a low-dimensional manifold. Taking label noise into ac-count, we add a crowd layer to DLN for robust embedding extraction. Also, to achieve a more compact representa-tion, we use hierarchical annotation for data augmenta-tion. We evaluate our facial expression embedding on the
FEC validation set. The quantitative results prove that we achieve the state-of-the-art, both in terms of ﬁne-grained and identity-invariant property. We further conduct exten-sive experiments to show that our expression embedding is of high quality for expression recognition, image retrieval, and face manipulation. 1.

Introduction
Facial expression plays a vital role in human social com-munication. Humans are very skilled at perceiving expres-sions, which is non-trivial for computers. The develop-ment of human-computer interaction requires reasonable facial expression representation. Studies on resolving this problem have been conducted for decades in the expression analysis area. The previous methods, such as Facial Ac-tion Coding System (FACS) [11] and categorical expression model [7] [28], try to build discrete expression represen-tation with semantic deﬁnitions. However, these methods ignore the big variance within the emotional classes and
∗Equal contribution. Yu Ding is the corresponding author. (a) Expression manifold (b) Deviation module
Figure 1: Description of expression manifold and our Deviation model. few of them can handle well the identity-entangled prob-lem. Therefore, most of the existing expression represen-tations are still lack of enough capacity for extracting ﬁne-grained and identity-invariant expression information from given faces and somehow block the downstream tasks such as expression recognition [28], image retrieval [36] and face manipulation [39].
In this paper, we develop a novel expression embed-ding framework being capable of learning a continuous and smooth space for expressions from face images. To repre-sent the complicated and subtle expression, we follow the idea [36] of using contrastive comparison to learn the ex-pression distribution. The optimization goal is to map two similar expressions within a triplet close to each other while away from the third one. Besides, based on the perspective that expressions should be lying on a manifold closing to the identity [15] (See Fig. 1a), we model the facial expres-sion as a deviation from the facial identity representation like Fig. 1b.
In this way, we disentangle the facial iden-tity attribute from the source face in an explicit manner. To the best of our knowledge, this is the ﬁrst work that tries to resolve the expression embedding problem by intentionally disentangling the face identity attribute.
Our expression embedding learning framework called
Deviation Learning Network (DLN) is composed of three modules (See Fig. 2): a deviation module for extract-6759
ing identity-invariant deviation features, a high-order mod-ule for mapping the high-dimensional features to a low-dimensional manifold, and a crowd layer for eliminating the label noise. Speciﬁcally, the deviation model has a pseudo-siamese structure, one branch for the original face represen-tation and the other for the identity. The expression devia-tion feature is calculated by subtracting the identity attribute from face representation. Moreover, instead of using addi-tional neural network layers that cause optimization difﬁ-culty due to the gradient shatter [1], we use the high-order polynomial of the deviation for nonlinear mapping in the high-order module. The high-order idea proposed in [3] aims to model inter-layer interactions while ours is for en-hancing the ﬁtting performance. Then the crowd layer is used to alleviate different annotators’ label bias, ensuring a more robust expression embedding.
The main contribution of this paper lies in three as-pects. First, we tackle the challenge of learning an identity-invariant facial expression embedding through an innova-tive deviation learning network. Secondly, we propose the high-order module to improve the ﬁtting performance from the high-dimensional expression space to a low-dimensional manifold. Third, we enhance the expression embedding, in terms of robustness with the crowd layer and also in terms of ﬁne-grained property with the hierarchical-annotated triplets. Extensive experiments demonstrate the great potential of our method in emotion recognition, im-age retrieval, and face manipulation tasks. 2.