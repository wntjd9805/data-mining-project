Abstract
Most object detection methods require huge amounts of annotated data and can detect only the categories that ap-pear in the training set. However, in reality acquiring mas-sive annotated training data is both expensive and time-consuming.
In this paper, we propose a novel two-stage detector for accurate few-shot object detection. In the ﬁrst stage, we employ a support-query mutual guidance mech-anism to generate more support-relevant proposals. Con-cretely, on the one hand, a query-guided support weighting module is developed for aggregating different supports to generate the support feature. On the other hand, a support-guided query enhancement module is designed by dynamic kernels. In the second stage, we score and ﬁlter proposals via multi-level feature comparison between each proposal and the aggregated support feature based on a distance met-ric learnt by an effective hybrid loss, which makes the em-bedding space of distance metric more discriminative. Ex-tensive experiments on benchmark datasets show that our method substantially outperforms the existing methods and lifts the SOTA of FSOD task to a higher level. 1.

Introduction
Object detection is one of the most fundamental prob-lems in computer vision. Most existing object detection methods [23] require huge amounts of annotated training data, and it is hard to generalize a well-trained model to de-tect unseen classes. On the contrary, human beings have strong capability to recognize and locate an object that they have never seen before, but only if they have a few exam-ples of such an object. In other words, the visual system of humans can learn novel concepts and features from a few
*correspondence author examples quickly and then recognizes objects of the same kind in other images, even when the objects are under large variance of view, illumination, and shape, etc.
In real-world scenarios, the number of training samples could be small, and the cost to label high-quality samples can be very high. Thus, it is important to study the problem of few-shot object detection (FSOD) [2, 10]. Speciﬁcally, given a few support images with annotations of some tar-get classes, FSOD aims to recognize and localize objects of these classes in some query images. Similar to few-shot learning, the class space is divided into base (seen) classes and novel (unseen) classes. During training, only base classes are used. The inference is conducted on novel classes, which are different from the base classes.
FSOD is a challenging problem that has not yet been extensively studied. Among the existing works, some are based on one-stage detectors, which usually have relatively low accuracy [10, 28]. In contrast, two-stage detector can achieve relatively high accuracy [30, 11, 5, 27]. However, existing two-stage methods still have some obvious draw-backs: 1) Support information is not fully exploited to guide bounding boxes generation from the query. 2) In k-shot scenario, they treat different supports equally and aggregate their features by simple averaging, which will also seriously impact detection accuracy. 3) Generally, their detection ac-curacy is still too low to be applicable in real applications.
To address the problems above, in this paper, we pro-pose a novel method for accurate few-shot object detection.
Our method is a two-stage detector with multi-level archi-tecture. In the ﬁrst stage, we employ a support-query mu-tual guidance mechanism to generate more support-relevant proposals. To this end, on the one hand, considering that the similarities between different supports and the query image may be quite different, it is natural to think that the sup-ports contribute differently to detect objects from the query image. Thus, we design a query-guided support weighting 14424
module to aggregate different supports. On the other hand, we develop a support-guided query enhancement module.
In particular, we design a kernel generator to dynamically generate support-speciﬁc kernels, which are used to con-volve the query feature, making the query feature more at-tentive to the support class.
In the second stage, we ﬁlter the proposals with a multi-level proposal scoring module. Speciﬁcally, we perform dense comparison level-by-level between the feature of each proposal candidate and the support feature, and ag-gregate level-wise similarities to get proposal scores. The feature comparison is done with a learnt distance metric.
To learn a better embedding space for the distance metric, we design a hybrid loss that skillfully combines the merits of contrastive loss, adaptive margin loss and focal loss to ef-fectively discriminate different novel classes and the back-ground. Our extensive experiments show that the proposed method outperforms the existing methods.
In summary, our contributions are as follows: 1) We propose a new few-shot object detection method whose novelty is twofold: a) A support-query mutual guid-ance mechanism for generating more support-relevant pro-posals, which is implemented by a support-guided query enhancement module and a query-guided support weight-ing module. b) A hybrid loss that combines the merits of contrastive loss, adaptive margin loss and focal loss to learn the distance metric for accurately discriminating proposals of different unseen classes and the background. 2) We conduct extensive experiments on benchmark datasets. Results show that our method substantially out-performs the existing methods, and advances the SOTA of
FSOD to a higher level.
For better understanding the difference between our method and the latest existing FSOD models, in Table 1 we present a qualitative comparison from three perspec-tives: support fusion method, support-query mutual guid-ance mechanism and loss function. We can see that 1) only our method adopts weighted averaging over different supports with their similarities to the query, while existing methods all use simple averaging, i.e., they treat all supports equally. 2) Our method is the only one that uses support-query mutual guidance, i.e., using query to weight supports (Q → S) meanwhile using support feature to enhance query (S → Q). 3) Our method employs a powerful hybrid loss that is different from that of the existing models. 2.