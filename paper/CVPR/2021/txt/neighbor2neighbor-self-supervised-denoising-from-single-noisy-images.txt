Abstract
In the last few years, image denoising has beneﬁted a lot from the fast development of neural networks. How-ever, the requirement of large amounts of noisy-clean image pairs for supervision limits the wide use of these models.
Although there have been a few attempts in training an im-age denoising model with only single noisy images, existing self-supervised denoising approaches suffer from inefﬁcient network training, loss of useful information, or dependence on noise modeling. In this paper, we present a very sim-ple yet effective method named Neighbor2Neighbor to train an effective image denoising model with only noisy images.
Firstly, a random neighbor sub-sampler is proposed for the generation of training image pairs. In detail, input and tar-get used to train a network are images sub-sampled from the same noisy image, satisfying the requirement that paired pixels of paired images are neighbors and have very similar appearance with each other. Secondly, a denoising network is trained on sub-sampled training pairs generated in the
ﬁrst stage, with a proposed regularizer as additional loss for better performance. The proposed Neighbor2Neighbor framework is able to enjoy the progress of state-of-the-art supervised denoising networks in network architecture de-sign. Moreover, it avoids heavy dependence on the assump-tion of the noise distribution. We explain our approach from a theoretical perspective and further validate it through ex-tensive experiments, including synthetic experiments with different noise distributions in sRGB space and real-world experiments on a denoising benchmark dataset in raw-RGB space. 1.

Introduction
Image denoising is a low-level vision task that is funda-mental in computer vision, since noise contamination de-grades the visual quality of collected images and may ad-versely affect subsequent image analysis and processing tasks, such as classiﬁcation and semantic segmentation [18].
*The work was done in Noah’s Ark Lab, Huawei Technologies.
†Corresponding author
Traditional image denoising methods such as BM3D [7],
NLM [4], and WNNM [11], use local or non-local struc-tures of an input noisy image. These methods are non-learning-based without the need for ground-truth images.
Recently, convolutional neural networks (CNNs) provide us with powerful tools for image denoising. Numerous CNN-based image denoisers, e.g., DnCNN [34], U-Net [26], RED
[20], MemNet [28], and SGN [10], have superior perfor-mance over traditional denoisers. However, CNN-based de-noisers depend heavily on a large number of noisy-clean image pairs for training. Unfortunately, collecting large amounts of aligned pairwise noisy-clean training data is extremely challenging and expensive in real-world photog-raphy. Additionally, models trained with synthetic noisy-clean image pairs degrade greatly due to the domain gap between synthetic and real noise.
To mitigate this problem, a series of unsupervised and self-supervised methods that do not require any clean im-ages for training are proposed. These methods require 1) training the network with multiple independent noisy ob-servations per scene [17], 2) designing speciﬁc blind-spot network structures to learn self-supervised models on only single noisy images [13, 15, 30], and making further im-provements by using noise models, e.g., Gaussian-Poisson models [15, 30], or 3) training the network with noisier-noisy pairs, where the noisier image is derived from the noisy one with synthetic noise added [31, 22]. However, these requirements are not practical in real-world denois-ing scenarios. Firstly, capturing multiple noisy observa-tions per scene remains very challenging, especially for motion scenarios or medical imaging. Secondly, the rel-atively low accuracy and heavy computational burden of blind-spot networks greatly limit the application. Moreover, self-supervised methods with noise model assumptions may work well in synthetic experiments when the noise distribu-tion is known as a prior. However, these methods degrade sharply when dealing with real-world noisy images where the noise distribution remains unknown.
In this work, we propose Neighbor2Neighbor, a novel self-supervised image denoising framework that overcomes 14781
the limitations above. Our approach consists of a train-ing image pairs generation strategy based on sub-sampling and a self-supervised training scheme with a regulariza-tion term. Speciﬁcally, training input and target are gen-erated by random neighbor sub-samplers, where two sub-sampled paired images are extracted from a single noisy image with each element on the same position of the two images being neighbors in the original noisy image. In this way, if we assume that noise with each pixel is indepen-dent conditioned on its pixel value and there is no corre-lation between noise in different positions, then these two sub-sampled paired noisy images are independent given the ground-truth of the original noisy image. Accordingly, in-spired by Noise2Noise [17], we use the above training pairs to train a denoising network. Besides, we develop a reg-ularization term to address the essential difference of pixel ground-truth values between neighbors on the original noisy image. The proposed self-supervised framework aims at training denoising networks with only single images avail-able, without any modiﬁcations to the network structure.
Any network that performs well in supervised image de-noising tasks can be used in our framework. Moreover, our method does not depend on any noise models either.
To evaluate the proposed Neighbor2Neighbor, a series of experiments on both synthetic and real-world noisy images are conducted. The extensive experiments show that our
Neighbor2Neighbor outperforms traditional denoisers and existing self-supervised denoising methods learned from only single noisy images. The results demonstrate the ef-fectiveness and superiority of the proposed method.
The main contributions of our paper are as follows: 1. We propose a novel self-supervised framework for im-age denoising, in which any existing denoising net-works can be trained without any clean targets, net-work modiﬁcations, or noise model assumptions. 2. From the theoretical perspective, we provide a sound motivation for the proposed framework. 3. Our method performs very favorably against state-of-the-art self-supervised denoising methods especially on real-world datasets, which shows its potential ap-plications in real-world scenarios. 2.