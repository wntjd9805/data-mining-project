Abstract
Mammographic mass detection is an integral part of a computer-aided diagnosis system. Annotating a large number of mammograms at pixel-level in order to train a mass detection model in a fully supervised fashion is costly and time-consuming. This paper presents a novel self-training framework for semi-supervised mass detection with soft image-level labels generated from diagnosis re-ports by Mammo-RoBERTa, a RoBERTa-based natural lan-guage processing model ﬁne-tuned on the fully labeled data and associated mammography reports. Starting with a fully supervised model trained on the data with pixel-level masks, the proposed framework iteratively reﬁnes the model itself using the entire weakly labeled data (image-level soft label) in a self-training fashion. A novel sample selection strat-egy is proposed to identify those most informative samples for each iteration, based on the current model output and the soft labels of the weakly labeled data. A soft cross-entropy loss and a soft focal loss are also designed to serve as the image-level and pixel-level classiﬁcation loss respec-tively. Our experiment results show that the proposed semi-supervised framework can improve the mass detection accu-racy on top of the supervised baseline, and outperforms the previous state-of-the-art semi-supervised approaches with weakly labeled data, in some cases by a large margin. 1.

Introduction
Mammography is widely used for the early detection of breast cancer, the most common cancer in women. With about 48 million mammograms performed annually in the
US, a Computer-Aided Diagnosis (CAD) system for mam-mogram screening is of great interest. This paper focuses on detecting mass lesions from mammograms, an impor-tant indication of potential malignancy. Despite the re-cent progress of Deep Neural Networks (DNN)-based ap-proaches, mass detection with high accuracy still remains a
Figure 1. Our semi-supervised breast mass detection system uses fully labeled data (with mass masks) as well as large-scale weakly labeled data (with probabilistic NLP labels). challenging problem.
Many previous DNN-based mass detection models are trained with fully supervised fashion [26, 36, 22], and in turn require a large amount of fully labeled data (with pixel-level masks or rectangular bounding-boxes), which must be manually annotated by medical experts [33]. In many cases, the amount of high-quality annotation data has become the bottleneck for further performance improvement. Semi-supervised approaches can minimize the effort required to prepare the labeled data by training the model with a lim-ited number of fully labeled examples and an additional, ar-bitrary amount of unlabeled or weakly labeled (e.g., image-level class labels) examples [28, 30].
For this study, we collected a large-scale dataset contain-ing 134,520 images with diagnostic reports from 30,495 patients, among which 2,634 images have pixel-level mass masks labeled by our collaborative radiologists. To fully leverage the diagnostic reports, we further adopt a
RoBERTa [21]-based natural language processing (NLP) 3855
model Mammo-RoBERTa, and it can take a diagnostic re-port as input and generate the probability of mass pres-ence for the corresponding image, which is subsequently assigned as the image-level soft label.
To fully exploit the large-scale weakly labeled data (with image-level soft labels), and small amount fully la-beled data (with pixel-level mass masks), we present a novel high-resolution, multi-stage semi-supervised learn-ing framework, inspired by the previous self-training-based semi-supervised approaches [11, 24] and Multiple Instance
Learning (MIL)-based weakly supervised learning meth-ods [18, 1, 4, 29]. Starting from a high-resolution bilat-eral dual-view-based mass detection model ﬁrst trained on the fully labeled data, the proposed framework iteratively updates the detection model in a self-training fashion, by carefully designing a novel batch sample mining strategy to identify the most informative samples for the next itera-tion. Compared to previous MIL-based approaches, a soft cross-entropy loss and a soft focal loss are deployed for the image-level classiﬁcation task and the pixel-level classiﬁ-cation task respectively, which are shown to outperform the hard label-based counterpart by our experiment results.
Meaningful performance improvement of the mass de-tection model has been achieved by applying the proposed framework to our large-scale weakly labeled dataset, in comparison with the same model trained with only fully labeled data. The proposed framework also outperforms various state-of-the-art semi-supervised 2D medical image detection and segmentation approaches, when the entire dataset is used. It is also worth noting that the model per-formance is monotonically increasing with respect to the amount of the weakly labeled data available in the training set (Section 4.4 Figure 4), while some previous work [18] may observe degraded model performance once the weakly labeled data exceeds a certain amount.
The main thrusts of this paper are summarized as fol-lows. 1. We propose a novel self-training-based semi-supervised learning framework, by leveraging probabilistic soft class labels generated from the diagnostic report by an
NLP model (Mammo-RoBERTa). 2. We propose a novel sample mining strategy to select the most informative weakly labeled data for each iteration of self-training, along with the soft label-based image-level and pixel-level classiﬁcation loss functions. 3. We show meaningful improvement of the semi-supervised approach when compared with the previous fully supervised approaches, in terms of mass detec-tion accuracy.
In addition, the proposed framework can outperform several previously reported state-of-the-art semi-supervised approaches on our entire large-scale dataset. 2.