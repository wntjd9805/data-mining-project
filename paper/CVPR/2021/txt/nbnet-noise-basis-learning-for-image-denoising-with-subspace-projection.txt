Abstract
In this paper, we introduce NBNet, a novel framework for image denoising. Unlike previous works, we propose to tackle this challenging problem from a new perspective: noise reduction by image-adaptive projection. Speciﬁcally, we propose to train a network that can separate signal and noise by learning a set of reconstruction basis in the fea-ture space. Subsequently, image denosing can be achieved by selecting corresponding basis of the signal subspace and projecting the input into such space. Our key insight is that projection can naturally maintain the local structure of in-put signal, especially for areas with low light or weak tex-tures. Towards this end, we propose SSA, a non-local at-tention module we design to explicitly learn the basis gen-eration as well as subspace projection. We further incorpo-rate SSA with NBNet, a UNet structured network designed for end-to-end image denosing based. We conduct evalua-tions on benchmarks, including SIDD and DND, and NBNet achieves state-of-the-art performance on PSNR and SSIM with signiﬁcantly less computational cost. 1.

Introduction
Image denoising is a fundamental and long lasting task in image processing and computer vision. The main challeng-ing is to recover a clean signal x from the noisy observation y, with the additive noise n, namely: y = x + n (1)
This problem is ill-posed as both the image term x and the noise term n are unknown and can hardly be separated. To-wards this end, many denoising methods utilize image prior and a noise model to estimate either image or noise from the noisy observation. For example, traditional methods such as
NLM [9] and BM3D [14] use the local similarity of image
*Corresponding author
)
R
N
S
P ( e c n a m r o f r e
P g n i s i o n e
D 40 38 36 34 32 30
DANet 39.47 dB 9.1 M 3.71 Gflops
VDN 39.28 dB 7.8 M 12.37 Gflops
NBNet 39.75 dB 13.3 M 22.2 Gflops
RIDNet 38.71 dB 1.5 M 24.5 Gflops
MIRNet 39.72 dB 31.8 M 196.76 Gflops
CBDNet 30.78 dB 4.34 M 10.8 Gflops 2 4 8 64  Computational Cost (GFlops) 32 16 128 256
Figure 1: PSNRs at different computational cost and param-eter amount of our method and previous methods in SIDD
[1]. The proposed NBNet achieves SOTA performance with a balanced computational requirement. and the independence of noise, and wavelet denoising [34] utilizes the sparsity of image in transformed domain.
Recent deep neural networks (DNN) based denoising methods [40, 12, 53, 21, 44, 30, 42] usually implicitly uti-lize image prior and noise distribution learned from a large set of paired training data.
Although previous CNN-based methods have achieved tremendous success, it is still challenging to recover high quality images in hard scenes such as weak textures or high-frequency details. Our key observation is that convolutional networks usually depend on local ﬁlter response to separate noise and signal. While in hard scenes with low signal-noise-ratio (SNR), local response can easily get confused without additional global structure information.
In this paper, we utilize non-local image information by projection. The basic concept of image projection is illus-trated in Fig. 2, where a set of image basis vectors are gen-erated from the input image, then we reconstruct the image inside the subspace spanned by these basis vectors. As nat-ural images usually lie in a low-rank signal subspace, by properly learning and generating the basis vectors, the re-constructed image can keep most original information and 4896    
Early works usually rely on image priors, including non-local means (NLM) [9], sparse coding [17, 29, 2], 3D transform-domain ﬁltering (BM3D) [14], and others [19, 34]. Although these classical approaches like BM3D, can generate reasonable desnoising results with certain accu-racy and robustness, their algorithmic complexity is usually high and with limited generalization. With the recent devel-opment of convolutional neural networks (CNNs), end-to-end trained denoising CNNs has gained considerable atten-tion with great success in this ﬁeld. 2.2. Network architecture
One main stream of CNNs based desnoising is to de-sign novel network architecture to tackle this problem.
Earlier work [10] proposed to apply multi-layer percep-tron (MLP) to denoising task and achieved comparable re-sults with BM3D. Since then more advanced network archi-tectures are introduced. Chen et al. [12] proposed a train-able nonlinear reaction diffusion (TNRD) model for Gaus-sian noise removal at different level. DnCNN [50] demon-strated the effectiveness of residual learning and batch nor-malization for denoising network using deep CNNs. Later on, More network structures were proposed to either enlarge the receptive ﬁeld or balance the efﬁciency, like dilated convolution [51], autoencoder with skip connection [30],
ResNet [35], recursively branched deconvolutional net-work (RBDN) [38]. Recently some interests are put into involving high-level vision semantics like classiﬁcation and segmentation with image denoising. Works [26, 32] applied segmentation to enhance the denoising performance on dif-ferent regions. [52] recently proposed FFDNet, a non-blind denoising by concatenating the noise level as a map to the noisy image and demonstrated a spatial-invariant denoising on realistic noises with over-smoothed detail. MIRNet [49] proposed a general network architecture for image enhance-ment such as denoising and super-resolution with many no-val build blocks which can extract, exchange and utilize multi-scale feature information.
In this work, we adapt a UNet style architecture with a novel subspace attention module. Unlike [4, 5, 41] use attention module for region or feature selection, SSA is de-signed to learn the subspace basis and image projection. 2.3. Noise distribution
To train the deep networks mentioned above, it requires high quality real datasets with a huge amount of clean and noisy image pairs, which is hard and tedious to construct in practice. Hence, the problem of synthesizing realistic image noise has also been extensively studied. To approx-imate real noise, multiple types of synthetic noise are ex-plored in previous work, such as Gaussian-Poisson [18, 27], in-camera process simulation [25, 39], Gaussian Mixture
Model (GMM) [54] and GAN-generated noises [11] and so 4897
Figure 2: Denoising via subspace projection: Our NBNet learns to generate a set of basis for the signal subspace and by projecting the input into this space, signal can be en-hanced after reconstruction for easy separation from noise. suppress noise which is irrelevant to the generated basis set. Based on this idea, we propose NBNet, depicted in
Fig. 3. The overall architecture of NBNet is a commonly-used UNet [36], except for the crucial ingredient subspace attention (SSA) module which learns the subspace basis and image projection in an end-to-end fashion. Our ex-periments on popular benchmark datasets such as SIDD [1] and DnD [33] demonstrate that the proposed SSA module brings a signiﬁcant performance boost in both PSNR and
SSIM with much smaller computational cost than adding convolutional blocks. As depicted in Fig. 1, the whole architecture of NBNet achieves the state-of-the-art perfor-mance while only a smaller additional computational cost is added. To summarize, our contributions include:
• We analyze the image denoising problem from a new perspective of subspace projection. We further design a simple and efﬁcient SSA module to learn subspace projection which can be plugged into normal CNNs.
• We propose NBNet, a UNet with SSA module for pro-jection based image denoising.
• NBNet acheives state-of-the-art performance in PSNR and SSIM on many popular benchmarks
• We provide in-depth analysis of projection based im-age denoising, demonstrating it is a promising direc-tion to explore. 2.