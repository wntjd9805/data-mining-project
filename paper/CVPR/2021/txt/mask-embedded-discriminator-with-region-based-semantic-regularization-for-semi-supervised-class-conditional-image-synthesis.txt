Abstract
Semi-supervised generative learning (SSGL) makes use of unlabeled data to achieve a trade-off between the da-ta collection/annotation effort and generation performance, when adequate labeled data are not available. Learning precise class semantics is crucial for class-conditional im-age synthesis with limited supervision. Toward this end, we propose a semi-supervised Generative Adversarial Network with a Mask-Embedded Discriminator, which is referred to as MED-GAN. By incorporating a mask embedding mod-ule, the discriminator features are associated with spatial information, such that the focus of the discriminator can be limited in the speciﬁed regions when distinguishing between real and synthesized images. A generator is enforced to syn-thesize the instances holding more precise class semantics in order to deceive the enhanced discriminator. Also ben-eﬁting from mask embedding, region-based semantic reg-ularization is imposed on the discriminator feature space, and the degree of separation between real and fake class-es and among object categories can thus be increased. This eventually improves class-conditional distribution matching between real and synthesized data. In the experiments, the superior performance of MED-GAN demonstrates the effec-tiveness of mask embedding and associated regularizers in facilitating SSGL. 1.

Introduction
Generative adversarial networks (GANs) [11] have made great progress in high-ﬁdelity image synthesis [4] [14] [15]
[16]. To better capture class semantics, class-conditional
GANs are developed to synthesize diverse instances to match the underlying class-conditional distribution of real data [26] [30] [27] [10]. For many scenarios of real-world
∗Corresponding author.
Figure 1. Visually compare the activation maps of a generic dis-criminator (middle row) and a mask-embedded discriminator (bot-tom row) used in MED-GAN on CUB-200. The top row shows a real image and the images constructed via random regional re-placement between the real image and a number of fake images. applications, accurate and sufﬁcient labeled data are expen-sive to obtain, since the collection process typically needs expertise. The difﬁculty of acquiring labeled data has moti-vated the research on semi-supervised generative learning, which addresses a challenging task: how to train a reli-able generative model for the case where there are a lim-ited amount of labeled data together with a large amount of unlabeled data.
To improve class-conditional image synthesis in the semi-supervised setting, a number of techniques have been explored for enhancement on generators/discriminators.
Wu et al. [43] performed class-wise mean feature match-ing between synthesized and real data in a classiﬁer feature space. In [24], real and fake images of each class were ran-domly mixed through regional replacement. The resulting images were used to regularize a discriminator. However, a class-conditional discriminator always tends to learn the most discriminative features. As shown in Figure 1, it fo-cuses on the regions which are not necessarily important, especially for the case of limited supervision. This may de-5506
Figure 2. An overview of the proposed MED-GAN model, which consists of three constituent networks: a generator G, a discriminator
D, and a classiﬁer C. C learns to produce pseudo labels ˜yu of the unlabeled data xu, such that they can be used as well as the labeled data x. To enforce G to focus more on the synthesis of class semantics-based content, a mask embedding model Amask is incorporated to induce D to discover the local differences between real and synthesized images. Also based on mask embedding, the images ˆxz,λ constructed via random regional replacement between x and synthesized images xz can be used to increase the degree of class separation in the discriminator feature space, which beneﬁts class-conditional distribution matching between real and synthesized data. grade the generation performance of the class-conditional generator. In this work, we will explore how to induce a discriminator to distinguish between real and synthesized data from a local point of view. By reducing the depen-dence of the discriminator on the background, the generator may focus more on the synthesis of class semantics-related content.
More speciﬁcally, we propose a semi-supervised Gen-erative Adversarial Network with a Mask-Embedded Dis-criminator (MED-GAN) for facilitating class-conditional image synthesis. Figure 2 illustrates the structure of MED-GAN. Considering the effectiveness of random regional re-placement in constructing complex images, we adopt this strategy to combine real and synthesized data. As for train-ing the discriminator, there is a lack of guideline on how to assign source (real/fake) labels to the resulting instances. To bypass this issue, we incorporate a mask embedding mod-ule in the discriminator, such that the mask of regional re-placement can be embedded into the discriminator feature space. This module aims to associate spatial information with the corresponding features, and the discriminator thus applies more attention on the speciﬁed region. Further, we adopt a region-based consistent and contrastive regulariza-tion approach to regularize the discriminator feature space.
By imposing separation between real and fake classes and among object categories, the generator needs to improve synthesis quality, while at the same time learn more pre-cise class semantics in order to deceive the enhanced dis-criminator. Extensive validation experiments verify that the adopted techniques are effective for signiﬁcantly improv-ing synthesis quality in terms of Fr´echet Inception Distance (FID) [13]. Moreover, MED-GAN is able to consistent-ly outperform the previous state-of-the-art semi-supervised
GANs on multiple standard benchmarks.
Main contributions. We summarize the main contri-butions of this work as follows: (1) To induce a genera-tor to focus more on synthesizing class semantics-related content, we ﬁrst enhance a discriminator by incorporating a mask embedding module, which learns to associate spatial information with the corresponding discriminator features. (2) Also based on mask embedding, we construct region-based regularizers to impose class separation on the dis-criminator feature space, which facilitates class-conditional distribution matching. (3) We judiciously design the opti-mization formulation of the constituent networks. A clas-siﬁer is jointly trained with the generator and discrimina-tor, such that they can mutually reinforce each other for capturing more precise class semantics. (4) In addition to semi-supervised generative learning, we apply the devel-oped techniques to the fully-supervised case where the gen-eration performance of a BigGAN can also be signiﬁcant-ly improved, which indicates the applicability of our tech-niques to generic class-conditional GANs. 2.