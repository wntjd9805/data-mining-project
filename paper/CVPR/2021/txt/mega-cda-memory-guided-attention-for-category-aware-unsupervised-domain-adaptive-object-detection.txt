Abstract
Existing approaches for unsupervised domain adap-tive object detection perform feature alignment via ad-versarial training. While these methods achieve reason-able improvements in performance, they typically perform category-agnostic domain alignment, thereby resulting in negative transfer of features. To overcome this issue, in this work, we attempt to incorporate category information into the domain adaptation process by proposing Memory
Guided Attention for Category-Aware Domain Adaptation (MeGA-CDA). The proposed method consists of employing category-wise discriminators to ensure category-aware fea-ture alignment for learning domain-invariant discrimina-tive features. However, since the category information is not available for the target samples, we propose to gener-ate memory-guided category-speciﬁc attention maps which are then used to route the features appropriately to the cor-responding category discriminator. The proposed method is evaluated on several benchmark datasets and is shown to outperform existing approaches. 1.

Introduction
Object detectors [49, 11, 15, 14, 28, 38] are a critical part in the inference pipeline of several applications like autonomous navigation, video surveillance, image analysis etc. Due to this, object detection has received signiﬁcant interest from the research community. Recent works like
[15, 28, 38] have achieved exceedingly good performance on several benchmark datasets [9, 8, 13, 27]. However, these approaches suffer from severe degradation of perfor-mance when evaluated on images that are sampled from a different distribution as compared to that of training images.
Such scenarios are encountered frequently in the real world.
*Equal contribution
†Work performed during internship at Mercedes-Benz Research and
Development India
Figure 1. Performing global domain adaptation alone results in po-tential negative transfer of features. To mitigate this issue, we em-ploy additional category-aware adaptation.
For example, consider the case of self-driving cars where the detectors are typically trained on datasets obtained from one particular city or environmental condition (belonging to source domain) and are expected to be deployed in differ-ent city or environment (belonging to target domain). Due to this, it is crucial to develop approaches that enable better generalization of detectors.
One approach to address this issue is through unsuper-vised domain adaptation [6, 44, 40], where the goal is to utilize labeled source domain data and unlabeled target do-main data to adapt object detector and improve the perfor-mance on the unlabeled target domain data. To address this issue, typically these methods attempt to learn domain-invariant features by performing feature alignment between the source and target images. Based on the theoretical in-sights that minimizing the divergence between the domains reduces the upper-bound error on the target domain [4], they achieve the feature alignment through adversarial training.
Although these approaches result in considerable improve-ments, they perform the domain alignment in a category-agnostic way. That is, they match the global marginal dis-tributions of the two domains without considering the cat-egory information. This may lead to cases where the tar-get domain samples are incorrectly aligned with the source-4516
domain samples of a different class (see Fig. 1), thereby resulting in sub-optimal adaptation performance. The task of adapting object detectors is especially prone to this prob-lem due to the presence of multiple categories of objects.
Considering this issue, we focus on incorporating cat-egory information into the domain adaptation process by matching the local joint distribution of features in addition to the global alignment. In particular, we perform category-wise alignment of features by employing category-speciﬁc discriminators in the training process. Note that this re-quires pixel-wise category labels so that the features can be explicitly routed to the respective category-speciﬁc discrim-inator. However, in the case of unsupervised domain adap-tation, annotations are not available in any form (bound-ing boxes/category labels/pixel-wise labels) for the target dataset. This lack of annotations makes it difﬁcult to use category-speciﬁc discriminators.
In order to overcome this challenge, we propose memory-guided attention maps for enabling the category-aware feature alignment. The objective of these attention maps is to focus on objects of speciﬁc categories, and hence can be used to route the backbone features into the appropri-ate category-speciﬁc discriminators. For generating these attention maps, we propose the use of memory networks
[51, 47, 26, 23, 10, 34, 16]. During the training process, these memory banks are used to store prototypes of the ob-jects of different categories, where individual items in the memory correspond to prototypical features of a particular object category. The use of memory network is inspired by their ability to store patterns over longer periods of time.
Additionally, the ability to update the patterns using explicit write operations makes them especially useful in domain adversarial training since the features change over the train-ing process. For determining the attention at a particular location, we use the feature at this location as a query to retrieve relevant items from the different category-speciﬁc memory networks. The retrieved items are then compared with the query item and based on the similarity, we com-pute the category-speciﬁc attention map. Furthermore, in order to improve the effectiveness of the memory mod-ule and the attention map generation process, we propose a metric-learning based approach that involves learning an appropriate similarity metric based on the available weak-supervision in the source domain. In order to demonstrate the effectiveness of the proposed method, we evaluate it on several benchmark datasets and adaptation protocols. Fur-thermore, we show that the memory-guided attention maps play an important role in achieving category-wise distribu-tion matching, thereby mitigating the issue of incorrect fea-ture alignment.
To summarize, following are the main contributions of our work:
• We propose memory-guided attention maps for enabling category-wise distribution matching for domain adaptive object detection.
• In addition, we improve the effectiveness of the memory modules by employing metric learning-based approach for computing the category-speciﬁc attention maps.
• The proposed method is evaluated on several benchmark datasets and is shown to outperform recent domain adap-tive detection approaches by a considerable margin. Ad-ditionally, we conduct detailed ablation studies to clearly disambiguate the role of memory-guided attention for achieving category-wise alignment. 2.