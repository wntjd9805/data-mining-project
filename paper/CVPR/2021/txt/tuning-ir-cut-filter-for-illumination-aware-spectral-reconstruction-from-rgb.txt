Abstract
To reconstruct spectral signals from multi-channel ob-servations, in particular trichromatic RGBs, has recently emerged as a promising alternative to traditional scanning-based spectral imager. It has been proven that the recon-struction accuracy relies heavily on the spectral response of the RGB camera in use. To improve accuracy, data-driven algorithms have been proposed to retrieve the best response curves of existing RGB cameras, or even to de-sign brand new three-channel response curves. Instead, this paper explores the ﬁlter-array based color imaging mecha-nism of existing RGB cameras, and proposes to design the
IR-cut ﬁlter properly for improved spectral recovery, which stands out as an in-between solution with better trade-off between reconstruction accuracy and implementation com-plexity. We further propose a deep learning based spec-tral reconstruction method, which allows to recover the il-lumination spectrum as well. Experiment results with both synthetic and real images under daylight illumination have shown the beneﬁts of our IR-cut ﬁlter tuning method and our illumination-aware spectral reconstruction method. 1.

Introduction
Hyperspectral imaging (HSI) records detailed spectral in-formation of scene surfaces.
It has become an emerging scientiﬁc tool in a variety of ﬁelds, e.g. seed viability esti-mation [1], wound healing analysis [2], non-contact foren-sic science [3] and thin-ﬁlm imaging [4]. However, hyper-spectral acquisition systems are usually scanning based, and remain slow in capture speed [5, 6], computational algo-rithms are therefore in demand to conquer the limitations of conventional hyperspectral imagers.
Recently, methods recovering spectra from a single RGB image have been trend-setting and promising [7, 8], dic-tionary based approaches and deep convolutional neural
∗Corresponding author (yqzheng@ai.u-tokyo.ac.jp).
Figure 1. Infrared (IR) blocking mechanism of commodity digital color cameras. An IR-cut ﬁlter (b) is usually placed in front of the color sensor (a), which can be easily removed. After removing the
IR-cut ﬁlter, the silicon based sensor can perceive infrared light (c). By measuring the transmittance of the IR-cut ﬁlters from dif-ferent camera makers (d), it is found that the cut-off wavelength can vary a lot, which might affect spectral reconstruction from
RGB. Inspired by this mechanism, we propose to design the IR-cut
ﬁlter in the ﬁrst place for better and stable spectral upsampling. networks (CNN) have shown their efﬁcacy in hurdling the non-linear mapping from RGB values to the spectra
[9, 10, 11, 12]. It has been proven that the spectral recon-struction accuracy relies heavily on the spectral response of the RGB camera in use [8]. Inspired by this key observa-tion, data-driven algorithms have been proposed to retrieve the best camera spectral sensitivity (CSS) curves of exist-ing RGB cameras [13], or even to design brand new three-channel response curves [14].
However, ﬁlter set selection methods [8, 13] can only select from existing CSS databases, and we question the appro-priateness of selecting from CSS of commercial cameras designed for human color perception for spectral upsam-pling. As shown in Fig.1 (d), some IR-cut ﬁlters embed-ded in commercial RGB cameras tend to cut off a lot of energy beyond 650nm, which will deﬁnitely undermine the efforts in [9, 13, 8] to reconstruct spectra in the 420∼720nm visible range from RGB. In particular, the algorithms have to guess the spectral distribution in the 650∼720nm range on the basis of the observations in the 420∼650nm range, 84
[14] extends the search which is obviously error prone. space for CSS curves to the inﬁnite non-negative function space by designing three-channel response from scratch, but it’s hardware realization requires a complex co-axis opti-cal system and multiple expensive customized ﬁlters in the multi-sensor setup.
In this paper, we propose to implement a deeply tuned ﬁl-ter to replace the built-in IR-cut ﬁlter for better spectral re-construction. As shown in Fig. 1 (a,b), the IR-cut ﬁlter is detached from the color sensor and can be easily removed.
As will be conducted in Fig. 9, with our method, one can augment a compatible RGB camera to render spectral sig-nals by simply switching on the customized IR-cut ﬁlter, without changing the ﬁlter array in front of the silicon sen-sor. The spectra blocking effect of our designed ﬁlter is optimized with end-to-end training, and the invasion to a camera device is minimized. Our solution stands out as a better trade-off between reconstruction accuracy and real-ization complexity.
Another largely untouched aspect of existing RGB-to-spectrum upsampling researches is the physical interaction of illumination and reﬂectance. By following a simple illu-mination and reﬂectance spectral separation model, known as IRSS [15], we manage to come up with an end-to-end
RGB-to-spectrum reconstruction with the ability to estimate incident illumination spectra at the same time. Our de-sign achieves state-of-the-art spectral reconstruction perfor-mance and can predict illumination spectra accurately. The overview of our proposed method is shown in Fig. 2.
We have conducted extensive experiments on simulated and real spectral images under daylight illumination with dif-ferent color temperatures, which verify the effectiveness of our IR-cut ﬁlter design method, as well as the accuracy and generalization capability of our illumination-aware spectral reconstruction network. To sum up, the major contributions of this work are: 1. This work is the ﬁrst to explore the IR-cut ﬁlter re-sponse as a tunable factor for spectral upsampling. We also verify the intuition that the optimal cut-off range of the IR-cut ﬁlter may not match the objective spectral range. 2. We propose a way of addressing the illumination and reﬂectance separation in the CNN framework, and use it to predict illumination of real outdoor images suc-cessfully. 3. We realize the designed IR-cut ﬁlter and verify the effectiveness and plausibility of our proposition with real-life experiments. 2.