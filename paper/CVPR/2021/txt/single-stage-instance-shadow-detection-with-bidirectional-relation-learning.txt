Abstract
Instance shadow detection aims to ﬁnd shadow instances paired with the objects that cast the shadows. The previous work adopts a two-stage framework to ﬁrst predict shadow instances, object instances, and shadow-object associations from the region proposals, then leverage a post-processing to match the predictions to form the ﬁnal shadow-object pairs. In this paper, we present a new single-stage fully-convolutional network architecture with a bidirectional re-lation learning module to directly learn the relations of shadow and object instances in an end-to-end manner.
Compared with the prior work, our method actively ex-plores the internal relationship between shadows and ob-jects to learn a better pairing between them, thus improving the overall performance for instance shadow detection. We evaluate our method on the benchmark dataset for instance shadow detection, both quantitatively and visually. The ex-perimental results demonstrate that our method clearly out-performs the state-of-the-art method. (a) Input image (b) LISA [54] (c) Our learned paired locations (d) Ours
Figure 1: Instance shadow detection results produced by (b)
LISA [54] and (d) our method, where LISA mismatches the large shadow with another horse. Our method learns the paired locations (c) for a better shadow-object pairing. 1.

Introduction
Research on shadows has been a fundamental prob-lem in computer vision. Prior works focus mainly on the shadow detection and shadow removal tasks, while a recent work [54] proposes a new task called instance shadow de-tection, which aims to detect shadow instances paired with the associated objects that cast the shadows. Overall, in-stance shadow detection beneﬁts many vision applications, such as light direction estimation and photo editing.
To approach instance shadow detection, Wang and Hu et al. [54] built a dataset called SOBA, each with labeled masks for shadow instances, object instances, and shadow-object associations. To detect the shadow instances to-gether with their associated objects, they designed a two-∗Joint ﬁrst authors
†Corresponding author (xwhu@cse.cuhk.edu.hk) stage framework to ﬁrst generate region proposals that have high probabilities of containing shadow instances, object in-stances, and shadow-object associations. Then, in the sec-ond stage, for each proposal, regions-of-interest (ROIs) are cropped from the feature maps, and the two-stage frame-work makes predictions of the masks and boxes of the shadow instances, object instances, and shadow-object as-sociations from each ROI. Lastly, they formulate a strategy to pair up the shadow and object instances with the shadow-object associations predicted from a deep network.
After revisiting the task, we identiﬁed various limitations in [54]. First, it considers the shadow-object association as a single category and predicts a bounding box for each shadow-object association. However, the appearance of shadow and object instances are very different, so shadow-object associations could easily be missed; see Figure 1 (b) for an example. Second, this method generates region 1
proposals for shadow/object instances and shadow-object associations using two separate branches, and leverages a post-processing to produce the ﬁnal shadow-object associa-tions. Errors could accumulate through the two-stage deep network and the post-processing, thus leading to large per-formance degradation. Third, the ROIs employed in [54] represent feature regions using rectangular shapes, but the shapes of the shadow instances and shadow-object associa-tions are usually irregular, and the cropped ROIs of rectan-gular shapes could include many irrelevant image contents, such as other object and shadow instances.
In this paper, we present a single-stage deep network for instance shadow detection by directly learning to ﬁnd the relation between shadow instances and object instances in an end-to-end manner. Our new approach includes only fully convolutional operations and is able to handle shadow/object instances and shadow-object associations of arbitrary shape. Speciﬁcally, we jointly optimize our net-work model to ﬁnd shadow instances, object instances, and shadow-object associations, thereby enabling us to ef-ﬁciently explore the internal relationship between shadows and objects. Importantly, we design the bidirectional rela-tion learning module to explore the shadow-object associa-tion pairs, in which we learn an offset vector from the center of each shadow instance to the center of its associated ob-ject instance, as well as the other way around; see Figure 1 (c) for the learned locations of paired shadow and object instances. To facilitate the learning process, we adopt class vectors to indicate the learning directions (shadow → object or object → shadow) and use the segmentation loss and off-set loss to optimize the network. These new techniques help the network to learn a better pairing between shadow and object instances, thus improving the overall performance of instance shadow detection; see Figures 1 (b) & (d) for the visual comparison results. Below, we summarize the major contributions of this work.
• First, we design a single-stage instance shadow de-tection network with only fully convolutional opera-tions to predict shadow instances, object instances, and shadow-object associations in an end-to-end manner.
• Second, we formulate the bidirectional relation learn-ing module in a deep network to learn the relation be-tween shadow instances and object instances.
• Third, we compare our method with the previous state-of-the-art method on the benchmark dataset for instance shadow detection. Results show that our method outperforms the state-of-the-art with an im-provement of over 29% in accuracy. 2.