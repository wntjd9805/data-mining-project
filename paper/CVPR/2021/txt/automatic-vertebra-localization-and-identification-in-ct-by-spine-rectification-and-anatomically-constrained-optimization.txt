Abstract
Accurate vertebra localization and identiﬁcation are re-quired in many clinical applications of spine disorder di-agnosis and surgery planning. However, signiﬁcant chal-lenges are posed in this task by highly varying patholo-gies (such as vertebral compression fracture, scoliosis, and vertebral ﬁxation) and imaging conditions (such as limited
ﬁeld of view and metal streak artifacts). This paper pro-poses a robust and accurate method that effectively exploits the anatomical knowledge of the spine to facilitate verte-bra localization and identiﬁcation. A key point localization model is trained to produce activation maps of vertebra cen-ters. They are then re-sampled along the spine centerline to produce spine-rectiﬁed activation maps, which are fur-ther aggregated into 1-D activation signals. Following this, an anatomically-constrained optimization module is intro-duced to jointly search for the optimal vertebra centers un-der a soft constraint that regulates the distance between ver-tebrae and a hard constraint on the consecutive vertebra in-dices. When being evaluated on a major public benchmark of 302 highly pathological CT images, the proposed method reports the state of the art identiﬁcation (id.) rate of 97.4%, and outperforms the best competing method of 94.7% id. rate by reducing the relative id. error rate by half. 1.

Introduction
Localization and identiﬁcation of spine vertebrae in 3-D medical images are key enabling components for computer-aided diagnosis of spine disorders [13]. As a prerequisite step of downstream applications, high accuracies of verte-bra localization and identiﬁcation are frequently demanded.
In recent years, many studies have been reported to address this problem, with substantial progress on public bench-marks (e.g., the SpineWeb [1]. However, due to the simi-lar appearances of the spine vertebrae, it remains a daunt-∗This work was done when Fakai Wang interned at PAII Inc.
Figure 1. Example spine CT images from the SpineWeb bench-mark dataset demonstrating the challenges. (a) small ﬁeld of ﬁew, (b) low image quality, (c,d) metal implants and severe compression fracture. ing task to identify vertebrae with a very high accuracy that meets the requirements of clinical applications.
The challenges in distinguishing vertebrae with simi-lar shapes/appearances are well recognized by the research community [9, 24, 3]. Multiple methods have been pro-posed to address them by exploiting the anatomical prior knowledge: 1) the spatial order of vertebrae, and 2) the distance between neighboring vertebrae. Spine anatom-ical knowledge is incorporated into neural networks im-plicitly using Bi-RNN [9], or explicitly using an informa-tion aggregation layer considering the spatial distribution prior of the vertebrae [24]. The anatomical prior has also been used to post-process the neural network output [3].
While steady performance improvements are observed in these works, the anatomical knowledge is still not fully uti-lized. In particular, anatomy-inspired network architectures like Bi-RNN [9] rely on the network to learn the anatomical prior without the guaranteed respect to the prior. Building the anatomical knowledge into a network layer [24] or the optimization target [3] makes a compromise that turns the hard constraint (which should be strictly enforced, e.g., the spatial order) into soft constraints that can be violated. As a result, previous methods may produce physically implau-5280
sible predictions (e.g., vertebrae in reversed order, multiple occurrences of the same vertebra).
Furthermore, while previous methods employ the infor-mation exchange mechanisms (e.g., Bi-RNN [9] and mes-sage passing [24]) to incorporate the global context, the vertebra label is still classiﬁed individually at the output stage for each vertebra without imposing the anatomical constraints. Therefore, these methods completely depend on the information exchange mechanisms to capture and regulate the spatial relationships between vertebrae. Ex-isting fusion mechanisms include 1) recurrent neural net-work [9], which encourages the message passing between vertebrae in a softly learned way instead of enforcing it in an anatomy coherent manner; 2) aggregation of the neigh-boring vertebrae’s activation maps [24] following the ver-tebra distance prior, which is only reliable for short-range relationships, leaving the global anatomical knowledge in-sufﬁciently exploited. A speciﬁc optimization formulation is used in [3] to jointly label the vertebrae by formulating a global objective function. However, the Markov modeling of vertebra labels employed in [3] is still limited to capture the short-range relationships and the error accumulates with the Markov steps.
In this work, we propose a vertebra localization and identiﬁcation method that jointly labels all vertebrae with anatomical constraints to effectively utilize the anatomi-cal knowledge.
In particular, a key point localization U-Net [15] is trained to predict activation maps for the 26 vertebra centers. Along the automatically calculated spine centerline, the activation maps are warped to rectify the spine and aggregated to form novel 1-D vertebra activa-tion signals. Vertebra localization and identiﬁcation tasks are then formulated as an optimization problem on the 1-D signals. The spatial order of the vertebrae is guaranteed us-ing a hard constraint to limit the optimization search space.
The prior knowledge of the distance between vertebrae is integrated via a soft constraint, i.e., a regularization term in the objective function. The labels for all vertebrae are searched jointly in the constrained search space, which al-lows global message passing among the vertebrae and en-sures the anatomical plausibility of the results. We evaluate our method on a main public benchmark from SpineWeb with a training set of 242 CTs and a testing test of 60 CTs.
Our method reports the new state-of-the-art identiﬁcation rate of 97.4%, signiﬁcantly outperforming the previously best competing method [3] that achieves a rate of 94.7%.
In summary, our contributions are four-fold. 1) We pro-pose a simple yet effective approach to aggregate 3-D verte-bra activation maps into 1-D signals so that the complexity of the task is signiﬁcantly reduced. 2) We exploit the spa-tial order of the vertebrae as a hard constraint of the opti-mization search space, which anatomically ensures plausi-ble outputs. 3) We introduce the vertebra distance prior as a soft constraint in optimization of the objective function,
ﬂexibly leveraging the relation between vertebrae. 4) Our method achieves the new state-of-the-art performance by improving the identiﬁcation accuracy from 94.7% to 97.4% and equivalently cutting the error rate by half. 2.