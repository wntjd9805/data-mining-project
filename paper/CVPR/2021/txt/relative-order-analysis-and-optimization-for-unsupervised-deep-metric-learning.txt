Abstract
In unsupervised learning of image features without la-bels, especially on datasets with ﬁne-grained object classes, it is often very difﬁcult to tell if a given image belongs to one speciﬁc object class or another, even for human eyes.
However, we can reliably tell if image C is more similar to image A than image B. In this work, we propose to explore how this relative order can be used to learn discriminative features with an unsupervised metric learning method. In-stead of resorting to clustering or self-supervision to create pseudo labels for an absolute decision, which often suffers from high label error rates, we construct reliable relative orders for groups of image samples and learn a deep neu-ral network to predict these relative orders. During train-ing, this relative order prediction network and the feature embedding network are tightly coupled, providing mutual constraints to each other to improve overall metric learn-ing performance in a cooperative manner. During test-ing, the predicted relative orders are used as constraints to optimize the generated features and reﬁne their feature distance-based image retrieval results using a constrained optimization procedure. Our experimental results demon-strate that the proposed relative orders for unsupervised learning (ROUL) method is able to signiﬁcantly improve the performance of unsupervised deep metric learning. 1.

Introduction
Learning discriminative features to represent images is an important task in computer vision and machine learning.
Images with the same semantic labels should have similar features being aggregated into compact clusters in the high-* corresponding authors
If
Figure 1. Illustration of the proposed idea of relative orders. we only look at images A and B, it is hard to determine if they are from the same classes or not. But, with image C as reference, we can reliably tell that images (A, B) are deﬁnitely more similar than images (A, C). dimensional feature space. Meanwhile, images from differ-ent classes should be well separated from each other. Re-cently, methods based on deep neural networks have made remarkable progress in learning discriminative features for images [9]. In this work, we consider the unsupervised deep metric learning where the image class labels are not avail-able. Furthermore, the test image classes are totally differ-ent from the training classes.
Existing methods for unsupervised feature or represen-tation learning attempt to construct pseudo labels using clustering methods or self-supervision labels based on self augmentation or pretext tasks [1, 4, 29].
It has been ob-served that the pseudo labels suffer from high error rates, especially for datasets with ﬁne-grained object classes. It has also been recognized that features learned from self-supervision tasks cannot generalize well to other tasks or new classes [33]. The key challenge is how to effectively handle the large intra-class variation and inter-class ambi-guity. Without labels, how do we tell whether two images 13999
are from the same class or not. For example, Figure 1 shows two pairs of images (A, B) from the ﬁne-grain CUB dataset. It is really hard to tell if images A and B are from the same class (bird species) or not, since we do not have any reference. Given a set of images without labels, when determining if two images are from the same class or not, our human visual system often performs a series of relative comparisons between images (A, B) and other images. For example, when a third image C is provided, as illustrated in Figure 1, we can deﬁnitely tell that image B is closer to A than image C to A. We denote this relative order by
A : B < C. Here, image A is referred to as the anchor image. We can further extend this relative ordering to a set of images {Fn|1 ≤ n ≤ N } with anchor image A. If image
Fn is visually closer or more similar to the anchor image A than Fm, we denote this as A : Fn < Fm.
It should be noted that this relative order analysis is dif-ferent from the triplet loss or other contrastive loss devel-oped in the metric learning literature [22, 27] since they re-quire using the image labels or pseudo labels to construct positive and negative image pairs for contrastive analysis.
However, our proposed relative order analysis does not need
Instead, it only needs reference-absolute image labels. based relative comparison and ordering.
In unsupervised learning, it might be very challenging and ambiguous to tell if two images are from the same classes or not. For example, many existing methods use k-mean clustering to generate pseudo labels [27], which are then used to identify positive and negative pairs for contrastive metric learning.
In our experiments, we have observed that the average accu-racy for positive and negative pairs during training is about 40-60%, which is quite low. However, it is often much less challenging, even with high conﬁdence, to tell if an image is closer to one speciﬁc image than others. This motivates us to explore this relative order analysis for more effective unsupervised feature learning.
In this work, we propose to explore how these relative orders can be used to learn discriminative features with an unsupervised metric learning method. We analyze the un-certainty involved in relative order analysis and introduce a ternary relative ordering function. We construct reliable relative orders for groups of image samples and learn a deep neural network to predict these relative orders. Dur-ing training, this relative order prediction network and the feature embedding network are tightly coupled, providing mutual constraints to each other to improve overall metric learning performance. During testing, the predicted rela-tive orders are used as constraints to optimize the generated features and reﬁne their feature distance-based image re-trieval results using a constrained optimization procedure.
Our experimental results demonstrate that the proposed rel-ative orders for unsupervised learning (ROUL) method out-performs existing methods by a large margin. 2.