Abstract
Data association across frames is at the core of Mul-tiple Object Tracking (MOT) task. This problem is usu-ally solved by a traditional graph-based optimization or di-rectly learned via deep learning. Despite their popularity, we ﬁnd some points worth studying in current paradigm: 1) Existing methods mostly ignore the context information among tracklets and intra-frame detections, which makes the tracker hard to survive in challenging cases like severe occlusion. 2) The end-to-end association methods solely rely on the data ﬁtting power of deep neural networks, while they hardly utilize the advantage of optimization-based as-signment methods. 3) The graph-based optimization meth-ods mostly utilize a separate neural network to extract fea-tures, which brings the inconsistency between training and inference. Therefore, in this paper we propose a novel learnable graph matching method to address these issues.
Brieﬂy speaking, we model the relationships between track-lets and the intra-frame detections as a general undirected graph. Then the association problem turns into a gen-eral graph matching between tracklet graph and detection graph. Furthermore, to make the optimization end-to-end differentiable, we relax the original graph matching into continuous quadratic programming and then incorporate the training of it into a deep graph network with the help of the implicit function theorem. Lastly, our method GM-Tracker, achieves state-of-the-art performance on several standard MOT datasets. Our code is available at https:
//github.com/jiaweihe1996/GMTracker. 1.

Introduction
Multiple Object Tracking (MOT) is a fundamental task that aims at associating the same object across successive frames in a video clip. A robust and accurate MOT algo-rithm is indispensable in broad applications, such as au-tonomous driving and video surveillance. The tracking-by-Figure 1: An illustration of intra-graph relationship used in our graph matching formulation. We utilize the second-order edge-to-edge similarity to model the group activity, which is more robust under heavy occlusion. Note that not all vertices in tracklet graph can be matched to the detection graph because they disappear in the current frame. detection is currently the dominant paradigm in MOT. This paradigm consists of two steps: (1) obtaining the bounding boxes of objects by detection frame by frame; (2) gener-ating trajectories by associating the same objects between frames. With the rapid development of deep learning based object detectors, the ﬁrst step is largely solved by the power-ful detectors such as [37, 38]. As for the second one, recent
MOT works focus on improving the performance of data association mainly from the following two aspects: (1) for-mulating the association problem as a combinatorial graph partitioning problem and solve it by advanced optimization techniques [5, 7, 62, 8, 65, 18]; (2) improving the appear-ance models by the power of deep learning[28, 67, 31, 64].
Although very recently, there are works [77, 53, 8, 65] try-ing to unify feature learning and data association into an end-to-end trained neural network, these two directions are almost isolated so that these recent attempts hardly utilize 5299
the progress from the combinatorial graph partitioning.
In the graph view of MOT, each vertex represents a de-tection bounding box or a tracklet, while the edges are con-structed between the vertices across different frames to rep-resent the similarities between them. Then the association problem can be formulated as a min-cost ﬂow problem [72].
The most popular used method is to construct a bipartite graph between two frames and adopt Hungarian algorithm
[27] to solve it. This online strategy is widely used in prac-tice because of its simplicity [7, 64]. Nevertheless, these methods are not robust to occlusions due to the lack of history trajectories and long term memory. This problem is traditionally solved by constructing graph from multiple frames, and then deriving the best association based on the optimal solution of this min-cost ﬂow problem [72].
All these existing works focus on ﬁnding the best match-ing across frames, but ignoring the context within the frame.
In this paper, we argue that the relationship between the ver-tices within the same frame is also crucial for some chal-lenging cases in MOT. For example, we can match an oc-cluded object to the correct tracklet solely by the past re-lationships with neighborhood objects. Fig. 1 just shows such an example. Interestingly, these pairwise relationships within the same frame can be represented as edges in a general graph. To this end, the popular bipartite match-ing across frames can be updated to general graph matching between them. To further integrate this novel assignment formulation with powerful feature learning, we ﬁrst relax the original formulation of graph matching [30, 26] to a quadratic programming, and then derive a differentiable QP layer based on the KKT conditions and the implicit function theorem for the graph matching problem, inspired by the
OptNet [2]. Finally, the assignment problem can be learned in synergy with the features.
Overall, our work has the following contributions:
• Instead of only focusing on the association across frames, we emphasize the importance of intra-frame relationships. Particularly, we propose to represent the relationships as a general graph, and formulate the as-sociation problem as general graph matching.
• To solve this challenging assignment problem, and further incorporate it with deep feature learning, we derive a differentiable quadratic programming layer based on the continuous relaxation of the problem, and utilize implicit function theorem and KKT conditions to derive the gradient w.r.t the input features during back-propagation.
• We evaluate our proposed GMTracker on the large scale open benchmark. Our method could remarkably advance the state-of-the-art performance in terms of association metric such as IDF1. 2.