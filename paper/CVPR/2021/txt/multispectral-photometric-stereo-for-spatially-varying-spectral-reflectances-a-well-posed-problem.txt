Abstract 1.

Introduction
Multispectral photometric stereo (MPS) aims at recover-ing the surface normal of a scene from a single-shot multi-spectral image, which is known as an ill-posed problem. To make the problem well-posed, existing MPS methods rely on restrictive assumptions, such as shape prior, surfaces having a monochromatic with uniform albedo. This pa-per alleviates the restrictive assumptions in existing meth-ods. We show that the problem becomes well-posed for a surface with a uniform chromaticity but spatially-varying albedos based on our new formulation. Speciﬁcally, if at least three (or two) scene points share the same chromatic-ity, the proposed method uniquely recovers their surface normals and spectral reﬂectance with the illumination of more than or equal to four (or ﬁve) spectral lights. Be-sides, our method can be made robust by having many (i.e., 4 or more) spectral bands using robust estimation techniques for conventional photometric stereo. Exper-iments on both synthetic and real-world scenes demon-strate the effectiveness of our method. Our data and result can be found at https://github.com/GH-HOME/
MultispectralPS.git.
Photometric stereo is effective for the detailed recovery of three-dimensional (3D) surfaces. Classical photometric stereo methods, originally proposed by Woodham [24] and
Silver [22], use images captured from a ﬁxed camera un-der varying lighting directions, which are commonly ob-tained at different timestamps. Since conventional photo-metric stereo methods stack images with time-multiplexing, the target surface has to be static during the multiple shots.
With spectral-multiplexing, multispectral photometric stereo (MPS) [13] recovers surface normals from a one-shot multispectral image. An input image for MPS encodes observations under different lighting directions in differ-ent spectral bands, conveying the information about surface normals and spectral reﬂectances. Figure 1 shows our MPS setup, which contains a ﬁxed camera and 12 narrow-band spectral light sources located at different positions.
Unlike time-multiplexing photometric stereo, shape re-covery in MPS with Lambertian surfaces is an ill-posed problem. Under the illumination of f spectral lights, there are f + 2 unknowns (f for the reﬂectance for each spec-963
Spectral Reﬂectance Type (SRT) rj = ρjvj, (1, p) j
∈
Input lighting condition f = 3 f > 3
SRT I
Gray-chromaticity: vj = vk = 1
√f
SV-albedo: ρj, ρk
R+
∈ e c n a t c e l f e r l a r t c e p
S
…
…
Ω1
Ω3
Spectral band 
Ω2
Ω4
Classical photometric stereo
𝜆𝜆
[22] N
Ω𝑓𝑓
Ω 1 𝟏𝟏 𝟏𝟏
SRT II
Mono-chromaticity: vj = vk = ˜v
Uniform albedo: ρj = ρk = ˜ρ
SRT III
Mono-chromaticity: vj = vk = ˜v
SV-albedo: ρj, ρk
R+
∈
SRT IV
SV-chromaticity: vj, vk
R+
SV-albedo: ρj, ρk
∈
Rf
+
∈ e c n a t c e l f e r l a r t c e p
S e c n a t c e l f e r l a r t c e p
S
=
=
𝐫𝐫𝑗𝑗
𝐫𝐫k
�𝜌𝜌 �𝐯𝐯
�𝜌𝜌 �𝐯𝐯
…
…
…
…
Spectral band 
Ω𝑓𝑓
Ω1
Ω2
Ω4
[5, 16] N [7, 13] Y
Ω3
Ω
𝜆𝜆
Ours, N
Ω1
Ω3
Spectral band 
Ω4
Ω2
[23] Y
Ω𝑓𝑓
Ω e c n a t c e l f e r l a r t c e p
S
=
𝐫𝐫𝑗𝑗 𝜌𝜌𝑗𝑗 �𝐯𝐯
=
𝐫𝐫𝑘𝑘 𝜌𝜌𝑘𝑘 �𝐯𝐯
𝜆𝜆
…
…
=
=
𝐫𝐫𝑗𝑗
𝜌𝜌𝑗𝑗𝐯𝐯𝑗𝑗
𝐫𝐫𝑘𝑘 𝜌𝜌𝑘𝑘𝐯𝐯𝑘𝑘
Ω𝑓𝑓
Ω3
Spectral band 
Ω1
Ω4
Ω2
[1–3, 5, 10–12, 16] Y
[8, 15] Y
Ω
𝜆𝜆
=
𝜌𝜌𝑗𝑗
𝐫𝐫𝑗𝑗
=
𝑓𝑓
𝐫𝐫𝑘𝑘 𝜌𝜌𝑘𝑘
𝑓𝑓
N: Require no additional priors
Figure 2: Visualization of four spectral reﬂectance types (SRT) categorized via the spatial distribution of the chromaticity v and the albedo ρ. Blue and red dots show the spectral reﬂectance of two scene points at f spectral bands.
Y: Require additional priors tral band and 2 for the surface normal) but only f observa-tions for each scene point are given. To make the problem tractable, existing methods use additional priors, e.g., ini-tial shape [1, 2], trained neural networks [10–12], or local smoothness regularization [15]. However, these priors are rather restrictive and may not always comply with the actual scene. Without these priors, existing methods [5, 16, 22] provide a unique solution for MPS by assuming the sur-face spectral reﬂectance types (SRT) to be gray chromatic or monochromatic with uniform albedo (SRT I and II in
Fig. 2). However, these spectral reﬂectance assumptions are also restrictive for real-world scenes. As shown in [5, 16], incorrect surface normal estimates from the real captured data occur in regions with roughly constant chromaticity but continuously changing albedos. Besides, the solution meth-ods [5, 16] for SRT II surfaces limit the input to be an RGB 3-channel image, making the methods less robust against outliers such as shadows and specular highlights.
In this paper, we make MPS to work well under a more general spectral reﬂectance type: Uniform chromaticity but spatially-varying (SV) albedos (SRT III in Fig. 2). To this end, we treat the estimation of spectral reﬂectance and sur-face normal as a bilinear optimization problem and show that they can be jointly estimated by solving a linear sys-tem of equations. Different from existing MPS works, our method provides a closed-form solution without relying on any additional priors. In addition, we allow the use of arbi-trarily many spectral channels as input, which enables us to bring robust photometric stereo methods [4, 20, 25] to MPS to deal with outliers such as shadows and specular high-lights. Experiments show that our method can also be used for surfaces with SV-chromaticities (SRT IV), by combin-ing with existing clustering methods [14, 17] that predict image regions sharing the same chromaticity.
Contributions We show that MPS for monochromatic surfaces with SV-albedos can be solved in a closed-form without introducing any external priors. We also give the minimal conditions based on the number of spectral lights and scene points for the problem to have a unique solu-Table 1: Comparison of MPS methods. Our method pro-vides a unique solution for SRT III. It adapts to 4+ spectral bands and requires no additional priors.
SRT Method
I
II
II
II
II
III
IV
[22]
[13]
[7]
[9]
[5, 16]
[23]
[5, 16]
≥
Input # Lights Additional priors
MSI1 3 None
RGB
RGB
RGB
RGB f f = 3 Surface integrability f = 3 Surface integrability f = 3 f = 3 None
Irradiance-normal mapping2
RGB
Initial coarse shape
Pixels with uniform albedo f = 3 f = 3 Reﬂectance quantization f = 3 Fixed lighting direction
RGBD3 f = 3 Piece-wise constant chromaticity
Piece-wise constant reﬂectance
RGB
IV [3, 10–12] RGB
IV
[1, 2]
IV
[15]
MSI
[8]
IV
MSI
III
Ours
MSI 1 Multispectral image f 3 Reﬂectance smoothness
≥ f f
Surface normal smoothness 5 Spectral reﬂectance basis1 4 None 2 Require calibration 3 RGB + depth
≥
≥ tion. Our method can handle 4+ spectral observations, which allows the combination with off-the-shelf four or more source photometric stereo methods to improve the ro-bustness against shadows and specular highlights. 2.