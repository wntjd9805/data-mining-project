Abstract
Despite the great success of GANs in images translation with different conditioned inputs such as semantic segmen-tation and edge maps, generating high-ﬁdelity realistic im-ages with reference styles remains a grand challenge in con-ditional image-to-image translation. This paper presents a general image translation framework that incorporates op-timal transport for feature alignment between conditional inputs and style exemplars in image translation. The in-troduction of optimal transport mitigates the constraint of many-to-one feature matching signiﬁcantly while building up accurate semantic correspondences between conditional inputs and exemplars. We design a novel unbalanced op-timal transport to address the transport between features with deviational distributions which exists widely between conditional inputs and exemplars. In addition, we design a semantic-activation normalization scheme that injects style features of exemplars into the image translation process successfully. Extensive experiments over multiple image translation tasks show that our method achieves superior image translation qualitatively and quantitatively as com-pared with the state-of-the-art. 1.

Introduction
Conditional image-to-image translation aims to generate images from certain given conditional inputs such as se-mantic segmentation [30, 40], layout [20], and key points
[36]. With the advance of Generative Adversarial Networks (GANs), it has made rapid progress and achieved quite promising translation performance in recent years. How-ever, most existing methods have very loose control over the translation process which often affects the translation quality greatly and so the wide application of image trans-lation in various tasks. Optimal style control is still an open challenge in high-ﬁdelity realistic image translation.
Several prior works attempted to tackle the style control challenge by using a latent code that is encoded by either
Variational Auto-Encoder (VAE) [30] or style encoder [3].
However, latent codes often impair style control accuracy as
Figure 1. Different feature matching in image translation: Cosine
Similarity tends to match each feature separately which often leads to many-to-one matching. Classical optimal transport (Classical
OT) suppresses the many-to-one matching problem but it matches all feature points including undesired outliers (existing between deviational feature distributions). Our designed unbalanced opti-mal transport (Unbalanced OT) mitigates many-to-one matching and avoid outlier matching effectively. they do not have sufﬁcient capacity to capture detailed style information. A different approach is to inject speciﬁc style codes for different semantic regions [63], but it is specif-ically designed for conditional input of semantic segmen-tation and cannot well generalize to other conditional in-puts. Recently, Zhang et al. [58] explore to establish dense semantic correspondence between conditioned input and a given style exemplar so as to offer dense style guidance in translation. However, it constructs the semantic correspon-dence based on cosine similarity that often leads to many-to-one matching (i.e. multiple conditional input features match to the same exemplar feature as illustrated in Fig. 1) and missing of details in image translation.
We designed UNITE, UNbalanced optImal feature
Transport for Exemplar-based image translation that achieves high-ﬁdelity image generation with faithful style to given exemplars. UNITE consists of a feature transport network and a translation network that are inter-connected and can be jointly optimized in training. The feature transport network introduces optimal transport [31] which matches two sets of features as a whole and effectively over-comes many-to-one matching as in the widely adopted co-sine similarity [58] that matches individual features sepa-rately. To tackle the distribution deviations between condi-tional inputs and exemplars, we design an unbalanced op-15028
timal transport technique that adaptively learns the mass (or weight) of each individual feature for effective trans-port between distributions of different masses. In the trans-lation network, we design a semantic-activation normaliza-tion scheme that injects the aligned features into the transla-tion process, where the exemplar features are transported in a multi-stage manner for preserving rich and complicated textural details. Extensive experiments show that UNITE translates images with superior realism and ﬁdelity.
The contributions of this work can be summarized in three aspects. First, we propose a conditional image transla-tion framework that introduces optimal transport for proper feature alignment and faithful style control in image trans-lation. Second, we design an unbalanced optimal trans-port technique with adaptive mass learning scheme that is capable of aligning features with deviational distributions, and a multi-stage transport strategy that can preserve com-plex textures at different scales. Third, we design a novel semantic-activation normalization that is capable of inject-ing the aligned style features into the image translation pro-cess effectively. 2.