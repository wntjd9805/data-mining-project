Abstract
Recently, how to exploit unlabeled data for training face recognition models has been attracting increasing atten-tion. However, few works consider the unlabeled shallow data1 in real-world scenarios. The existing semi-supervised face recognition methods that focus on generating pseudo labels or minimizing softmax classiﬁcation probabilities of the unlabeled data do not work very well on the unlabeled shallow data. It is still a challenge on how to effectively uti-lize the unlabeled shallow face data to improve the perfor-mance of face recognition. In this paper, we propose a novel face recognition method, named VirFace, to effectively ex-ploit the unlabeled shallow data for face recognition. Vir-Face consists of VirClass and VirInstance. Speciﬁcally, Vir-Class enlarges the inter-class distance by injecting the unla-beled data as new identities, while VirInstance produces vir-tual instances sampled from the learned distribution of each identity to further enlarge the inter-class distance. To the best of our knowledge, we are the ﬁrst to tackle the problem of unlabeled shallow face data. Extensive experiments have been conducted on both the small- and large-scale datasets, e.g. LFW and IJB-C, etc, demonstrating the superiority of the proposed method. 1.

Introduction
Deep face recognition has beneﬁt much from loss func-tion [17, 30, 29, 6] and large-scale labeled datasets [28, 2, 10, 1]. Meanwhile, considering the fact that it is easy to obtain large amount of unlabeled face data while annotat-ing these unlabeled data is time-consuming, several works
[35, 34, 33, 36] has been proposed trying to enhance face recognition performance via the unlabeled face data. How-ever, in real-world scenarios, the unlabeled face data prefers containing large amount of identities but only very few im-*Equal contribution. 1Shallow data means there are only few images per identity [8].
Figure 1. The dilemma of the existing semi-supervised face recog-nition methods on shallow data. (a) shows the clustering results of shallow data. In this ﬁgure, the error clusters are marked with red and purple circles. It is obvious that shallow data is hard to be well clustered. (b) presents the optimal problem of UIR loss.
During training, the goal of optimizing these unlabeled data is to move them towards the centroid point of the labeled data. This is hard to optimize and may converge into a trivial solution. ages per identity, namely shallow face data [8]. For bet-ter quantitative analysis, we deﬁne the shallow data as the data with no more than 5 images per identity in this paper.
In such situation, we ﬁnd that the existing semi-supervised learning methods [35, 34, 33, 36] do not work well.
Speciﬁcally, the clustering based methods [34, 33, 36] intend to assign the unlabeled data with pseudo-labels, and then combining with the labeled data together to train a new model. However, it is hard to cluster the shallow data as shown in Figure 1(a). In this ﬁgure, the red circles denote the error clusters that the samples from different identities are clustered into a same category, while the purple circles represent another kind of the clustering error that the sam-ples from the same identity are clustered into different cate-gories. Another work [35] proposed Unknown Identity Re-jection(UIR) loss to make the unlabeled data be rejected by all the identities. However, as shown in Figure 1(b), it is easy to optimize the model to converge into a trivial solu-14729
tion, i.e. optimizing all the unlabeled data to the centroid of the labeled data. Moreover, Yu Liu et al. [19] indicates that
UIR loss may learn an identity-irrelevant feature represen-tation.
Additionally, self-learning is also a candidate solution for utilizing the unlabeled shallow data. Methods such as
MOCO [12], SimCLR [4], and BYOL [9] have shown their superiority on representation learning in object classiﬁca-tion as well as several downstream tasks e.g. object detec-tion and segmentation. The core ingredient of above works is data augmentation which is utilized to obtain the pos-itive samples and plays an important role in performance improvement. However, data used in face recognition is al-ways aligned such that some data augmentation methods such as random cropping and rotation which are widely used in self-learning cannot be utilized.
In this paper, we propose VirFace, which consists of
VirClass and VirInstance, to improve the supervised face recognition through the unlabeled shallow data. VirClass enlarge the inter-class distance by injecting the unlabeled data as new identities into the labeled space, while VirIn-stance produces virtual instances sampled from the learned distribution of each identity to further enlarge the inter-class distance.
In summary, our proposed VirFace method can effectively utilize the unlabeled shallow data to learn a dis-criminative feature representation and to improve the per-formance over the supervised baselines.
The main contribution of this paper can be summarized as follows: 1. We propose a novel face recognition approach named
VirFace which is the ﬁrst to work on the unlabeled shallow data situation. 2. Our proposed VirFace contains VirClass and VirIn-stance which intend to enlarge inter-class distance and learn a discriminative feature representation. 3. The extensive experiments present signiﬁcant perfor-mance improvement over supervised baselines in unlabeled shallow situation compared to other unlabeled approaches. 2.