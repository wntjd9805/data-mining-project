Abstract
In this paper, we present a regression-based pose recog-nition method using cascade Transformers. One way to cat-egorize the existing approaches in this domain is to sep-arate them into 1). heatmap-based and 2). regression-based. In general, heatmap-based methods achieve higher accuracy but are subject to various heuristic designs (not end-to-end mostly), whereas regression-based approaches attain relatively lower accuracy but they have less interme-diate non-differentiable steps. Here we utilize the encoder-decoder structure in Transformers to perform regression-based person and keypoint detection that is general-purpose and requires less heuristic design compared with the ex-isting approaches. We demonstrate the keypoint hypothe-sis (query) reﬁnement process across different self-attention layers to reveal the recursive self-attention mechanism in
Transformers. In the experiments, we report competitive re-sults for pose recognition when compared with the compet-ing regression-based methods. 1.

Introduction
We tackle the 2D human pose recognition problem
[19, 1, 32, 22] where keypoints (e.g. head, shoulders, knees, etc.) for multiple people in an RGB image are to be detected and localized. This is an important problem in computer vi-sion that can be adopted in a variety of downstream tasks in-cluding tracking, security, animation, human-computer in-teraction, computer games, and robotics.
There has been a steady progress in 2D human pose recognition [1, 32, 36, 22, 17, 2, 25, 29, 24, 6, 5, 28, 41, 23] with systems becoming increasingly practical without a strong constraint (e.g. present multiple people of varying size). However, pose recognition is a challenging problem
* indicates equal contribution.
Code: https://github.com/mlpc-ucsd/PRTR.
Work performed during internships of K. Li, S.Wang, and X. Zhang with UC San Diego.
Figure 1:
Illustration of the gradual reﬁnement for the keypoints across different Transformer decoder layers.
Through the decoding process, PRTR predicts keypoints with increasing conﬁdence and decreasing spatial deviation to ground truth, transforming image-ignorant queries to ﬁ-nal predictions. that remains unsolved. The difﬁculty lies in various aspects such as large pose/shape variation, inter-person and self oc-clusion, large appearance variation, and background clutter.
For multiple people in an input image [19], the task of pose recognition is to localize the human keypoints (17 in the experiments) for the individual persons. This can be achieved by a two-stage process in which individual per-sons are detected ﬁrst, followed by keypoint detection from the detected image region/patch; this is called a top-down process [28]. An alternative strategy is called a bottom-up process where human keypoints are detected directly from the image without an explicit object detection stage [6]. A discussion about the top-down and bottom-up approaches can be found in [6].
Another way to divide the existing literature in pose recognition is based on the choice of using heatmap or regression. Heatmap-based approaches [37, 28] perform dense keypoint detection followed by subsequent processes 1944
they deliver strong perfor-for clustering and grouping; mance but are also subject to many heuristic designs that are mostly not end-to-end learnable. Regression based methods
[29, 41, 35] perform regression for the keypoints directly which have less intermediate stages and speciﬁcations.
Regression-based methods typically perform worse than heatmap-based ones, but can be made end-to-end and read-ily integrated with the other downstream tasks. Reasons for the existence of both heatmap-based and regression-based methods are present. Heatmap-based methods are adopted when the accuracy is the priority whereas regression-based approaches can be considered as a convenient plug-and-play module.
Generally, heatmap-based methods adopt handcrafted or heuristic pre/post-processing to encode ground truth to heatmaps and decode heatmaps to predict keypoints. These methods introduce design challenges and biases, making them sub-optimal. They are hard to update and adapt as well. In detail, SimpleBaseline [37] and HRNet [28] adopt the standard coordinate decoding method designed empiri-cally according to model performance in [22], reﬁning the coordinates 0.25 time from the maximum activation to the second maximum empirically in the heatmap. DARK [40] presents Taylor-expansion based coordinate decoding and unbiased sub-pixel centered coordinate encoding. UDP [15] even discovered a considerable accuracy decrease when us-ing one-pixel ﬂip shift in heatmap-based paradigms. For general-purpose regression methods, we aim at removing unnecessary designs by making the training objective and target output direct and transparent. Coordinates should be output directly and the loss be calculated with predictions and ground truth coordinates straightforward.
Bearing this in mind, we present a top-down regression-based 2D human pose recognition method using cascade
Transformers consisting of a person detection Transformer and a keypoint detection Transformer. Two alternatives have been developed, one being a two-stage process (shown in Figure 2) with the two Transformers learned sequen-tially and the other being a sequential process (shown in
Figure 3) with the two transfomers learned jointly in an end-to-end fashion. We name our method Pose Regression
TRansformers (PRTR). We apply multi-scale features in the keypoint detection Transformer. Visualization for the key-point queries across different attention layers in the decoder is given to illustrate the internal detection process. PRTR is a general-purpose approach for keypoint regression and we show competitive results in pose recognition when com-pared with the existing regression-based methods in the lit-erature. The contributions of our work include:
• We propose a regression-based human pose recognition method by building cascade Transformers, based on a general-purpose object detector, end-to-end object de-tection Transformer (DETR) [3]. Our method, named pose recognition Transformer (PRTR), enjoys the tok-enized representation in Transformers with layers of self-attention to capture the joint spatial and appearance mod-eling for the keypoints.
• Two types of cascade Transformers have been developed: 1). a two-stage one with the second Transformer tak-ing image patches detected from the ﬁrst Transformer, as shown in Figure 2; and 2). a sequential one using spatial
Transformer network (STN) [16] to create an end-to-end framework, shown in Figure 3.
• We visualize the distribution of keypoint queries in var-ious aspects to unfold the internal process of the Trans-former for the gradual reﬁnement of the detection.
On the COCO 2D human pose recognition dataset [19], competitive results have been observed when compared with the regression-based methods. 2.