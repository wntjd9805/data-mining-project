Abstract
Specular highlight detection and removal are fundamen-tal and challenging tasks. Although recent methods have achieved promising results on the two tasks by training on synthetic training data in a supervised manner, they are typ-ically solely designed for highlight detection or removal, and their performance usually deteriorates signiﬁcantly on real-world images. In this paper, we present a novel net-work that aims to detect and remove highlights from natu-ral images. To remove the domain gap between synthetic training samples and real test images, and support the in-vestigation of learning-based approaches, we ﬁrst introduce a dataset with about 16K real images, each of which has the corresponding ground truths of highlight detection and re-moval. Using the presented dataset, we develop a multi-task network for joint highlight detection and removal, based on a new specular highlight image formation model. Ex-periments on the benchmark datasets and our new dataset show that our approach clearly outperforms state-of-the-art methods for both highlight detection and removal. 1.

Introduction
Specular highlight, as a common physical phenomenon in the real world, often presents as bright spot on shiny ma-terial surfaces when illuminated. Highlight detection and removal have long been fundamental problems in computer vision. The reason is twofold. First, detecting where the highlight is allows us to infer the light direction, scene ge-ometry [19] and camera location. Second, removing the effect from highlight can help improve the performance of many vision tasks, such as object detection [14], intrinsic image decomposition [2], and tracking [9]. Note that, for simplicity, we refer highlight to specular highlight in this paper, except stated deﬁnitely.
Early works detect highlight by treating the brightest
∗Corresponding author.
Figure 1. Visual comparison of highlight detection and removal on an example image from our dataset. We compare our method with the state-of-the-art removal methods including Shi et al. [28],
Guo et al. [10], and Yang et al. [37], and with the state-of-the-art detection methods including Zhang et al. [41], Li et al. [18], and
Fu et al. [6]. pixels in an image as highlights [41, 18], which has low accuracy since it may mistake pixels with high intensities as highlight. As for highlight removal, traditional meth-ods are often based on optimization [13, 20, 7], clustering
[29] and ﬁltering [37, 38] etc, and may fail to handle large-scale highlight removal due to lack of image semantics.
More recent methods on highlight detection and removal are mostly deep learning-based. Although learning-based highlight detection and removal methods have achieved re-markable progress [28, 39, 6], they basically have two lim-itations. First, these methods are typically trained on syn-thetic data or a very small number of real data, so that may 7752
not work well for real images due to the domain gap be-tween training and test images. Second, they are either de-signed for highlight detection or removal, and are not able to be employed for joint highlight detection and removal.
To enable effective training and comprehensive evalu-ation for highlight detection and removal, we in this pa-per introduce a large-scale dataset for highlight detection and removal. It contains about 16K real images that cover a wide range of scenes, subjects, and lighting conditions.
Each image in the dataset has the corresponding highlight detection, removal, and highlight intensity images. Based on the presented dataset and a new region-aware highlight image formation model, we develop a deep learning frame-work for joint highlight detection and removal. Particularly, a multi-task network with multiple Dilated Spatial Contex-tual Feature Aggregation (DSCFA) modules is designed to harvest contextual features of different scales, for accurately detecting and removing highlights of varying sizes.
To sum up, our contributions are as follows:
• We present the ﬁrst large-scale highlight detection and removal dataset with about 16K real images.
• We develop a multi-task network for jointly detecting and removing highlights from natural images.
• Experimental results on benchmark datasets and our new dataset show that our network performs favorably against the previous methods for both highlight detec-tion and removal. 2.