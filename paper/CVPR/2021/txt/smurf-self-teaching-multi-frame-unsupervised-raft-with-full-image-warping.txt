Abstract
We present SMURF, a method for unsupervised learning of optical ﬂow that improves state of the art on all bench-marks by 36% to 40% (over the prior best method UFlow) and even outperforms several supervised approaches such as PWC-Net and FlowNet2. Our method integrates ar-chitecture improvements from supervised optical ﬂow, i.e. the RAFT model, with new ideas for unsupervised learning that include a sequence-aware self-supervision loss, a tech-nique for handling out-of-frame motion, and an approach for learning effectively from multi-frame video data while still only requiring two frames for inference. 1.

Introduction
Optical ﬂow describes a dense pixel-wise correspon-dence between two images, specifying for each pixel in the
ﬁrst image, where that pixel is in the second image. The resulting vector ﬁeld of relative pixel locations represents apparent motion or “ﬂow” between the two images. Es-timating this ﬂow ﬁeld is a fundamental problem in com-puter vision and any advances in ﬂow estimation beneﬁt many downstream tasks such as visual odometry, multi-view depth estimation, and video object tracking.
Classical methods formulate optical ﬂow estimation as an optimization problem [2, 8]. They infer, for a given im-age pair, a ﬂow ﬁeld that maximizes smoothness and the similarity of matched pixels. Recent supervised learning approaches instead train deep neural networks to estimate optical ﬂow from examples of ground-truth annotated im-age pairs [9, 28, 29, 37]. Since obtaining ground truth ﬂow is extremely difﬁcult for real images, supervised learning is generally limited to synthetic data [5, 20]. While these methods have produced excellent results in the training do-main, generalization is challenging when the gap between the target domain ant the synthetic training data is too wide.
∗Authors contributed equally.
Unsupervised learning is a promising direction to ad-dress this issue as it allows training optical ﬂow models from unlabeled videos of any domain. The unsupervised approach works by combining ideas from classical meth-ods and supervised-learning – training the same neural net-works as in supervised approaches but optimizing them with objectives such as smoothness and photometric similarity from classical methods. Unlike those classical methods, un-supervised approaches perform optimization not per image pair but jointly for the entire training set.
Since unsupervised optical ﬂow takes inspiration from classical and supervised learning methods, we can make substantial progress by properly combining novel ideas with insights from these two directions. In this paper, we do ex-actly that and make the following three contributions: 1. We integrate the current best supervised model,
RAFT [29] with unsupervised learning and perform key changes to the loss functions and data augmentation to properly regularize this model for unsupervised learning. 2. We perform unsupervised learning on image crops while using the full image to compute unsupervised losses.
This technique, which we refer to as full-image warp-ing, improves ﬂow quality near image boundaries.
[19] 3. We leverage a classical method for multi-frame ﬂow labels for self-to generate better reﬁnement supervision from multi-frame input. This technique im-proves performance especially in occluded regions with-out requiring more than two frames for inference.
Our method Self-Teaching Multi-frame Unsupervised
RAFT with Full-Image Warping (SMURF) combines these three contributions and improves the state of the art (SOTA) in unsupervised optical ﬂow in all major benchmarks, i.e. it reduces errors by 40 / 36 / 39 % in the Sintel Clean / Sintel
Final / KITTI 2015 benchmarks relative to the prior SOTA set by UFlow [12]. These improvements also reduce the gap to supervised approaches, as SMURF is the ﬁrst unsu-pervised optical ﬂow method that outperforms supervised
FlowNet2 [9] and PWC-Net [28] on all benchmarks. 3887
2.