Abstract
Few-shot learning (FSL), which aims to recognise new classes by adapting the learned knowledge with extremely limited few-shot (support) examples, remains an important open problem in computer vision. Most of the existing meth-ods for feature alignment in few-shot learning only con-sider image-level or spatial-level alignment while omitting the channel disparity. Our insight is that these methods would lead to poor adaptation with redundant matching, and leveraging channel-wise adjustment is the key to well adapting the learned knowledge to new classes. There-fore, in this paper, we propose to learn a dynamic align-ment, which can effectively highlight both query regions and channels according to different local support infor-mation. Speciﬁcally, this is achieved by ﬁrst dynamically sampling the neighbourhood of the feature position condi-tioned on the input few shot, based on which we further predict a both position-dependent and channel-dependent
Dynamic Meta-ﬁlter. The ﬁlter is used to align the query feature with position-speciﬁc and channel-speciﬁc knowl-edge. Moreover, we adopt Neural Ordinary Differential
Equation (ODE) to enable a more accurate control of the alignment.
In such a sense our model is able to better capture ﬁne-grained semantic context of the few-shot exam-ple and thus facilitates dynamical knowledge adaptation for few-shot learning. The resulting framework establishes the new state-of-the-arts on major few-shot visual recognition benchmarks, including miniImageNet and tieredImageNet. 1.

Introduction
Deep learning models have excelled in many computer vision tasks such as image recognition [15, 39, 19] and ob-∗ indicates equal contributions. Li Zhang is the corresponding author.
Chengming Xu, Yanwei Fu, Chen Liu, Li Zhang and Xiangyang
Xue are with School of Data Science, MOE Frontiers Center for Brain
Science, and Shanghai Key Lab of Intelligent Information Processing,
Fudan University. Email: {cmxu18, yanweifu, chenliu18, lizhangfd, xyxue}@fudan.edu.cn
Chengjie Wang, Jilin Li and Feiyue Huang are with Youtu Lab, Ten-cent. Email: {jasoncjwang, jerolinli, garyhuang}@tencent.com
Figure 1. While position-speciﬁc alignment cannot eliminate the negative inﬂuence of badly-learned channels, channel-speciﬁc one can. CAN denotes Cross Attention Network [16] which is one of the position-speciﬁc alignment models in FSL. ject detection [14, 46]. However, they highly rely on an avalanche of labeled training data and have difﬁculty trans-ferring the learned knowledge to unseen categories. For example, an object detector trained on 80 categories of
MSCOCO [23] would fail to detect a new class of mouse.
This severely limits their scalability to open-ended learning of long tail categories in real-world. In contrast, learning from extremely constrained (e.g., one or few) examples is an important ability for humans. For example, children have no problem forming the concept of “giraffe” by only taking a glance from a picture, or hearing its description as looking like a deer with a long neck.
Motivated by above observations, there has been a re-cent resurgence of research interest in few-shot learning (FSL) [18, 11, 43, 40, 42]. It aims to recognise new classes by adapting the learned knowledge with extremely limited few-shot (support) examples. The most naive baseline for few-shot classiﬁcation is to learn a discriminative feature representation by deep convolution neural network. Query features are then assigned with the class label of the nearest support feature. As an alternative to that, learnable metric 5182
like RelationNet [42] is proposed, where a binary classiﬁer consisting of multiple layers of neural networks is utilised to calculate the similarity between two images. In such a framework, there is no exploration of more valuable infor-mation for speciﬁc query image when being classiﬁed with different support images, which leads to bad generalization ability. Although there are some recent works targeting fea-ture alignment for FSL, such as CAN [16] and FEAT [48], which aggregates support knowledge to formalize an align-ment function for query samples, we claim that these meth-ods mainly have the following drawbacks. (1) Roughness.
Due to limited knowledge in FSL, every channel would con-tribute to the prediction when comparing support feature to the query feature. Moreover, since the extracted features only have low spatial resolution, the information discrep-ancy among spatial positions is far smaller than that among channels for each query features. However, methods like
CAN and FEAT do not focus on channel-level informa-tion. For example as shown in Fig. 1, while the spatial-speciﬁc alignment can set a large weight to the red box inside the target object, such a large weight is assigned to both well-learned and badly-learned channels. This would result in low signal in this region in the overall feature after alignment. In contrast, channel-speciﬁc alignment depends on the quality of each channel, thus being able to set low weight to channel 2, resulting in a better overall feature. (2) Redundant matching. There exists lots of redundancy in the support knowledge. For example, when classifying one position containing the target object, if there are several regions that also have this object, then comparing to one of them is enough for classiﬁcation. Nonetheless, the exist-ing methods utilize the whole support feature when align-ing each query position, which is inefﬁcient. (3) Inﬂexible alignment. The alignment strategy in these works only runs one time for all tasks. Thus, for those difﬁcult ones, the alignment may be insufﬁcient to appropriately embed the support knowledge into query feature.
Therefore to solve these problems, in this paper we pro-pose a novel dynamic feature alignment strategy. In detail, we turn to dynamic ﬁlters [17, 52] for tackling this problem.
We ﬁrst predict a dynamic meta-ﬁlter with both position-speciﬁc and channel-speciﬁc ﬁlter weights based on small neighbourhood of each position. This ﬁlter can contain ad-equate information to inform the model of the most im-portant regions and channels that need to be highlighted.
Hence, applying this ﬁlter to align the query features will culminate in more effective representations for recognition.
Meanwhile, using the neighborhood rather than the whole support feature directly decreases the number of knowledge source and the redundancy. To alleviate the problem re-sulted from ﬁxed neighbor, we adopt a dynamic sampling strategy that all of the feature positions can be selected via learning an offset conditioned on the input few shot pairs.
Intuitively, this learned sampling allows the network to bet-ter capture position based semantic context of the few-shot example. To further make the alignment more adaptive to harder tasks, a direct way is to recursively apply the sup-port knowledge to query feature through repetitive align-ment. However, it is hard to control the extent of alignment by ﬁxed hyper-parameter for various tasks. Consequently we modify the direct intuition of recursive alignment into an adaptive manner by using Neural Ordinary Differen-tial Equation (ODE) which makes continuous the residual alignment procedure and takes an adaptive step size to get the ﬁnal solution for the corresponding ODE. After achiev-ing the aligned query feature, we utilize a meta-classiﬁer to get the ﬁnal prediction where the support knowledge is aggregated by unlearnable operations to form a classiﬁer, which can avoid the adaptation problem that learnable clas-siﬁers are fully dependent on meta-train set and cannot ad-just well for data in novel categories.
The contributions of this work are as follows: 1. We propose to learn a novel dynamic meta-ﬁlter for more effective and efﬁcient feature alignment in FSL. 2. We introduce dynamic sampling and grouping strategy to further improve the ﬂexibility and efﬁciency of basic dynamic meta-ﬁlter. 3. Neural ODE is, for the ﬁrst time, leveraged to help model get better representation for FSL. 2.