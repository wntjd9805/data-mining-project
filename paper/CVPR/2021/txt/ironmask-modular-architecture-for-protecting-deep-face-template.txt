Abstract
Convolutional neural networks have made remarkable progress in the face recognition ﬁeld. The more the technol-ogy of face recognition advances, the greater discriminative features into a face template. However, this increases the threat to user privacy in case the template is exposed.
In this paper, we present a modular architecture for face template protection, called IronMask, that can be combined with any face recognition system using angular distance metric. We circumvent the need for binarization, which is the main cause of performance degradation in most existing face template protections, by proposing a new real-valued error-correcting-code that is compatible with real-valued templates and can therefore, minimize performance degra-dation. We evaluate the efﬁcacy of IronMask by extensive experiments on two face recognitions, ArcFace and Cos-Face with three datasets, CMU-Multi-PIE, FEI, and Color-FERET. According to our experimental results, IronMask achieves a true accept rate (TAR) of 99.79% at a false ac-cept rate (FAR) of 0.0005% when combined with ArcFace, and 95.78% TAR at 0% FAR with CosFace, while providing at least 115-bit security against known attacks. 1.

Introduction
Biometric-based authentication has long been the sub-ject of intensive research, and deep convolutional neural networks (CNNs) have allowed signiﬁcant recent advances in recognition. The success of the CNN architecture comes from its ability to extract discriminative features from user biometric traits, such as facial images. Within face recog-nition systems, user face images are well-compressed into deep face templates. Therefore, the exposure of user face templates constitutes a severe threat to user privacy as well as to system security. For instance, face images can be re-constructed from the corresponding templates [20] and this
*Corresponding author: J. H. Seo (e-mail: jaehongseo@hanyang.ac.kr) is a direct threat to user privacy. In addition, the recon-structed face image can be used to gain unauthorized access to the system. A high number of attacks have already been reported, which shows how risky the leakage of templates is [20, 4, 10, 9, 3].
The goal of face template protection is to satisfy irre-versibility, revocability, and unlinkability properties with-out signiﬁcant degradation in face recognition performance.
In terms of security, in the event a protected face template is leaked to an adversary, reconstructing the original face template from the compromised template should be compu-tationally infeasible. Thus, the compromised template must be revoked and generation of a new protected face template should be feasible. In addition, two or more protected tem-plates created from the same user biometric traits should hide relations between them. Furthermore, the template pro-tection scheme is expected to maintain high matching per-formance with high intra-user compactness and inter-user discrepancy. Achieving both high template security and high match performance at the same time is a fundamental challenge in the design of face template protection schemes.
Most of recent research on CNN-based face template protection can be categorized into two groups, training-in-enrollment and training-before-enrollment. The former ap-proach [23, 12, 13] requires face images of the target user to train the CNN, which maps from face images into binary code during enrollment; at this stage, the resulting binary codes are randomly generated and so have no correlation with the original face images. The hashed value of the re-sulting binary code is stored as a protected template of the target user. This approach is incompatible with dynamic en-rollment systems because, once the initial enrollment has been completed, the CNN would need to be retrained from scratch whenever a new user is added to the system. The latter approach [31, 21] was proposed to mitigate the effect of the above problem. In this case, the CNN can be pre-trained before enrollment, and performance degradation is minimized using additional methods, e.g., neural network 16125
Figure 1: IronMask is a template protecting modular architecture, which can be combined with any face recognition systems using angular distance metric. based error-correction [31] and signiﬁcant feature extrac-tion [21]. However, compared to the training-in-enrollment approach, these algorithms suffer from low matching ac-curacy. The common feature of both approaches is the use of a binary code either as an intermediate step or as the
ﬁnal protected template. This artiﬁcial binarization makes template-protected face recognition systems quite different from state-of-the-art (non-protected) face recognition sys-tems in terms of both architecture and/or matching perfor-mances. 1.1. Our Contributions
We present a novel design architecture that maintains the advantages of state-of-the-art (non-protected) biometric recognition as much as possible, while adding high tem-plate security. To this end, we propose a modular archi-tecture, called IronMask, that provides template protection to any (non-protected) face recognition system using angu-lar distance metric. A pictorial explanation of the approach is provided in Fig. 1. By combining IronMask with well-known face recognition systems, we achieve the best match-ing performance in the training-before-enrollment category.
Our performance results are even comparable with existing results in the training-in-enrollment category.
In this paper, we consider an arbitrary biometric recogni-tion system, which measures the closeness of two templates by angular distance metric (or cosine similarity). Two bio-metric templates t1, t2 are considered as vectors on the unit 1, and the distance between them is deﬁned n-sphere Sn 1(ht1, t2i) between them, where ht1, t2i as the angle cos− denotes the standard inner product of t1 and t2. It is worth noting that the angular distance [11, 18, 19, 25, 36, 17, 35, 37, 5, 39] has been widely used along with the Euclidean distance in many recent successful face recognition systems
− to measure closeness between two templates.
In developing IronMask, we devise a new real-valued error-correcting-code (ECC) that is compatible with the an-gular distance metric and enables to use real-valued codes instead of binary codes, unlike prior works. Hence, given 1, IronMask generates a real-an original template t ∈ Sn
− valued codeword c and a linear transformation P mapping from t to c, which has the form of an n-by-n matrix. The hashed value H(c) of the codeword and P are stored as the protected template, where H is a collision resistant hash function. If we set P to be an orthogonal matrix, then it becomes an isometry that preserves the inner product, so that any noisy template with distance d from t can be trans-formed via P into the one with the same distance from c. Thus, no additional performance degradation is imposed by this transformation. Finally, with the help of the error-correcting capability of our ECC, we can recover the origi-nal codeword and check its originality with H(c).
If the protected template is leaked, the adversary gains only P and H(c). We inject sufﬁcient randomness into P to hide information on the original template via the mathemat-ical tool of choosing a uniform orthogonal matrix. Then, we show that the protected template satisﬁes the three required properties, irreversibility, revocability, and unlinkability un-der appropriate parameter sizes.
IronMask can be combined with arbitrary face recog-nition systems using angular distance metrics. To demon-strate the efﬁcacy of IronMask, we apply IronMask to two well-known face recognition systems, ArcFace [5] and Cos-Face [37], with three widely used datasets, CMU Multi-PIE [28], FEI [33], and Color-FERET [24]. Here, ArcFace and CosFace are one of the state-of-the-art face recognition systems. Our experiments show that IronMask with Arc-Face achieves 98.76% true accept rate (TAR) at 0% false ac-16126
cept rate (FAR), and with CosFace achieves 81.13% TAR at 0% FAR. Through additional processes involving multiple face images as input of IronMask, we improve the match-ing performance up to 99.79% TAR at 0.0005% FAR for
ArcFace and 95.78% TAR at 0% FAR for CosFace. 1.2.