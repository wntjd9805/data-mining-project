Abstract
Existing rain image editing methods focus on either re-moving rain from rain images or rendering rain on rain-free images. This paper proposes to realize continuous con-trol of rain intensity bidirectionally, from clear rain-free to downpour image with a single rain image as input, with-out changing the scene-speciﬁc characteristics, e.g. the di-rection, appearance and distribution of rain. Speciﬁcally, we introduce a Rain Intensity Controlling Network (RIC-Net) that contains three sub-networks of background extrac-tion network, high-frequency rain-streak elimination net-work and main controlling network, which allows to con-trol rain image of different intensities continuously by in-terpolation in the deep feature space. The HOG loss and autocorrelation loss are proposed to enhance consistency in orientation and suppress repetitive rain streaks. Further-more, a decremental learning strategy that trains the net-work from downpour to drizzle images sequentially is pro-posed to further improve the performance and speedup the convergence. Extensive experiments on both rain dataset and real rain images demonstrate the effectiveness of the proposed method. 1.

Introduction
Transforming the weather condition of images realisti-cally is a knotty but attractive problem. Speciﬁcally, trans-forming images between the rain and rain-free weather con-ditions, i.e., deraining [9,38,39] and rain rendering [10,12], enables us to remove rain from rain images or produce rain effect on rain-free images. However, all these methods fo-cus on directly transforming from a certain weather con-dition to the other, without considering the bidirectional-controlling capability, leaving an innovative problem, i.e., continuously tuning the rain intensities bidirectionally (de-creasing or increasing), ranging from rain-free scene to downpour with a single rain image as input.
In practice, the rains with different intensities exhibit much different characteristics in the density of rain streaks, the size of raindrops, and the thickness of fog. Meanwhile, other scene-speciﬁc characters are supposed to be preserved removal input rendering direction appearance distribution l o r t n o
C y t i s n e t n
I
) a ( d e v r e s e r
P s c i t s i r e t c a r a h
C
) b (
Figure 1. The effect of bi-directional rain controlling. (a) Contin-uous rain intensity control of the single rain image input (marked with red rectangle). (b) The preserved rain characteristics. with the changing of rain intensity, including the direc-tion of rain in local area, the appearance of raindrops, and the distribution, which mostly depend on the wind direc-tion, illumination directions and camera parameters (e.g., focal length, point-of-focus and exposure time), as shown in
Fig. 1. Different from the simple and naive method that re-moves the rain and renders new rain effect to form rain im-ages with different rain intensities, our method can control the intensity-dependent characters changing with the rain-fall, while preserving the scene-speciﬁc features of the input rain image, so that the generated rain images with different intensities look consistent with the input rain image.
In this paper, a Rain Intensity Controlling Network (RICNet) is proposed, which allows continuous and bi-directional control of the rain from removal to rendering with different intensities and similar scene-speciﬁc char-acteristics from a given rain image. RICNet is composed of three sub-networks, i.e,