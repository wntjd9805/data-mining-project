Abstract
Weakly supervised object localization (WSOL) aims to localize objects by only utilizing image-level labels. Class activation maps (CAMs) are the commonly used features to achieve WSOL. However, previous CAM-based meth-ods did not take full advantage of the shallow features, despite their importance for WSOL. Because shallow fea-tures are easily buried in background noise through con-ventional fusion.
In this paper, we propose a simple but effective Shallow feature-aware Pseudo supervised Object
Localization (SPOL) model for accurate WSOL, which makes the utmost of low-level features embedded in shal-low layers. In practice, our SPOL model ﬁrst generates the
CAMs through a novel element-wise multiplication of shal-low and deep feature maps, which ﬁlters the background noise and generates sharper boundaries robustly. Besides, we further propose a general class-agnostic segmentation model to achieve the accurate object mask, by only using the initial CAMs as the pseudo label without any extra an-notation. Eventually, a bounding box extractor is applied to the object mask to locate the target. Experiments verify that our SPOL outperforms the state-of-the-art on both CUB-200 and ImageNet-1K benchmarks, achieving 93.44% and 67.15% (i.e., 3.93% and 2.13% improvement) Top-5 local-ization accuracy, respectively. 1.

Introduction
Weakly supervised object localization (WSOL) aims to locate objects by using only image-level labels. Since no expensive bounding box annotations are required, WSOL has attracted lots of attentions in various applications, e.g. lesion localization for medical image diagnosis, image-label guided retrieval, etc [28, 25, 2, 18, 1, 24, 22, 11, 14, 26, 20, 10, 23].
Existing WSOL methods are mainly based on the class
∗Corresponding author. † Equal contribution.
Figure 1. (a) CAM-based pipeline for Weakly Supervised Ob-ject Localization (WSOL). F represents different fusion strategies.
Here multiplication and addition based fusion methods for CAMs are compared. (b) GT-known Loc comparison using fused CAMs through different fusion strategies from different layers. In prac-tice, Fusex means the last X stage features of ResNet50 are ag-gregated, e.g. Fuse1 represents the original CAMs. activation maps (CAMs) [28]. However, CAM-based mod-els are initially trained for classiﬁcation, where the network objective is inconsistent with localization. Speciﬁcally, classiﬁcation prefers features with semantic meanings, usu-ally derived from deep layers of convolutional neural net-works (CNNs). In contrast, shallow features, derived from the shallow layers of CNNs, have less semantics but are rich in details, which have clearer edges and less distortion. Un-fortunately, direct fusion of shallow and deep features is in-valid for WSOL due to the following two defects: 1) The meaningful information embedded in the shallow features cannot be well captured through weak supervision, due to the large interference of background noise. To better elab-orate this statement, we illustrate the CAM-based WSOL pipeline in Fig. 1 (a). Within this pipeline, features of differ-ent layers from ResNet50 [3] are ﬁrstly aggregated to form the fused CAMs. As the fused CAMs obtained through ad-dition operation shown in Fig. 1 (a), the shallow features are buried and not fully utilized, leading to inferior CAMs. To make it general, as shown in Fig. 1 (b), we further test other 5993
conventional CAM fusion strategies (e.g. concatenation) for different layers, which are evaluated by GT-known Loc on
CUB-200 [15] dataset. Regarding the quantitative and qual-itative results, neither the obtained CAMs nor the overall lo-calization accuracy has been improved when more shallow features are involved through conventional fusion strategies, i.e. addition or concatenation. 2) Another issue is that only the most discriminative regions are activated in the original
CAMs [25, 18, 14, 22, 10, 2]. As shown in Fig. 1 (a) and
Fig. 2 (b), most areas have low response except for the head region, even though the low response areas occupy most of the image and reﬂect the object shape.
To address above concerns, we propose a simple but effective Shallow feature-aware Pseudo supervised Object
Localization (named SPOL) model for accurate WSOL, which makes the utmost of the low-level features embed-ded in shallow layers. Our SPOL model mainly consists of two stages, i.e. CAM generation and class-agnostic seg-mentation. For the CAM generation, the multiplicative fea-ture fusion network (MFF-Net) is designed to aggregate both shallow and deep features. Different from previous fusion methods, features in MFF-Net are treated in a syn-ergistic way. Namely, deep features with clear background help suppress the noise of the shallow ones while shallow features with rich local structures make object boundaries sharper, just as the multiplicative fusion CAMs shown in
Fig. 1 (a) and performance gains shown in Fig. 1 (b). For the class-agnostic segmentation stage, initial CAMs will be reﬁned with the Gaussian prior pseudo label (GPPL) mod-ule, which is then regarded as the pseudo label for class-agnostic segmentation module training. Speciﬁcally, tak-ing full advantage of the initial entire CAM as the weight-ing coefﬁcients, the mean and variance for all coordinates are calculated to obtain the object gravity. Then, a Gaus-sian distribution can be generated with achieved mean and variance, called Gaussian prior pseudo label (GPPL). As shown in Fig. 2 (c), GPPL approximates the gravity cen-ter of the bird, and enhances the responses of areas inside the body. Combining GPPL and original CAM, a better
CAM can be obtained, just as Fig. 2 (d) shows. To further reﬁne these regions, we design a class-agnostic segmenta-tion model by using combined GPPL and CAMs as pseudo labels through another MFF-Net. Note that during the train-ing phase, areas with large and small CAMs responses will be binarized into foreground and background, respectively using two pre-deﬁned thresholds, and other parts will be ig-nored to avoid label conﬂict during training. After training, the obtained object mask will become more complete com-pared with initial CAMs, as shown in Fig. 2 (e). Finally, a bounding box extractor is applied to the object mask to obtain the ﬁnal object localization. In summary, our contri-butions are three-fold:
• We propose a SPOL model to fully utilize the vital (b) CAM (a) Image (d) CAM+Gaussian (e) Predicted Mask (c) Gaussian
Figure 2. Variants of activated regions. (a) Input image. (b) Orig-inal CAM [28]. (c) Gaussian prior pseudo labels using original
CAM as the weighting coefﬁcients. (d) Gaussian prior pseudo la-bels combined with original CAM. (e) Object mask predicted by the proposed class-agnostic segmentation model. shallow features for WSOL, owing to the proposed multiplicative feature fusion strategy that makes the ut-most of shallow features.
• We further propose the Gaussian prior pseudo la-bel (GPPL) and class-agnostic segmentation model to achieve a better object mask for WSOL.
• SPOL outperforms previous methods by a large margin on both CUB-200 and ImageNet-1K benchmarks. 2.