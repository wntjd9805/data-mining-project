Abstract
Person search aims to simultaneously localize and iden-tify a query person from realistic, uncropped images, which can be regarded as the uniﬁed task of pedestrian detection and person re-identiﬁcation (re-id). Most existing works employ two-stage detectors like Faster-RCNN, yielding en-couraging accuracy but with high computational overhead.
In this work, we present the Feature-Aligned Person Search
Network (AlignPS), the ﬁrst anchor-free framework to ef-ﬁciently tackle this challenging task. AlignPS explicitly ad-dresses the major challenges, which we summarize as the misalignment issues in different levels (i.e., scale, region, and task), when accommodating an anchor-free detector for this task. More speciﬁcally, we propose an aligned feature aggregation module to generate more discriminative and robust feature embeddings by following a “re-id ﬁrst” prin-ciple. Such a simple design directly improves the baseline anchor-free model on CUHK-SYSU by more than 20% in mAP. Moreover, AlignPS outperforms state-of-the-art two-stage methods, with a higher speed. The code is available at https://github.com/daodaofr/AlignPS. 1.

Introduction
Person search [55, 48], which aims to localize and iden-tify a target person from a gallery of realistic, uncropped scene images, has recently emerged as a practical task with real-world applications. To tackle this task, we need to ad-dress two fundamental tasks in computer vision, i.e., pedes-trian detection [34, 52] and person re-identiﬁcation (re-id) [15, 1]. Both detection and re-id are very challenging tasks and have received tremendous attention in the past decade. In person search, we need to not only address the challenges (e.g., occlusions, pose/viewpoint variations, and background clutter) of the two individual tasks, but also pur-sue a uniﬁed and optimized framework to simultaneously perform detection and re-id.
Previous efforts devoted to this research topic can be
*indicates equal contributions; †indicates corresponding authors.
Detection
CNN
Re-id
CNN crop re-id features (a) Two-step person search framework
RPN conv
ROI
Align conv
&
GAP re-id feature
FC (b) One-step two-stage person search framework conv
AFA re-id loss re-id features regression loss fg/bg cls loss re-id loss regression loss fg/bg cls loss (c) The proposed one-step one-stage anchor-free framework
Figure 1: Comparison of three person search frameworks. (a) The two-step framework addresses detection and re-id as two separate tasks. (b) The one-step model enables end-to-end training of detection and re-id with an ROI-Align opera-tion based on a two-stage detector; however, re-id is consid-ered as a secondary task after detection. (c) The proposed framework enables single-stage inference for both detection and re-id, while making re-id the primary task. generally divided into two categories. The ﬁrst line of works [55, 5, 22], which we refer to as two-step approaches, attempt to deal with detection and re-id separately. As shown in Fig. 1a, multiple persons are ﬁrst localized with off-the-shelf detection models, and then cropped out and fed to re-id networks to extract discriminative embeddings.
Although two-step models can obtain satisfactory results, the disentangled treatment of the two tasks is time- and
In contrast, the second line of ap-resource-consuming. proaches [48, 27, 3, 33, 6] provide a one-step solution that 7690
uniﬁes detection and re-id in an end-to-end manner. As shown in Fig. 1b, one-step models ﬁrst apply an ROI-Align layer to aggregate features in the detected bounding boxes.
The features are then shared by detection and re-id; with an additional re-id loss, the simultaneous optimization of the two tasks becomes feasible. Since these models adopt two-stage detectors like Faster-RCNN [39], we refer to them as one-step two-stage models. However, these methods in-evitably inherit the limitations of two-stage detectors, e.g., high computational complexity caused by dense anchors, and high sensitivity to the hyperparameters including the size, aspect ratio and number of anchor boxes, etc.
In contrast to two-stage detectors, anchor-free mod-els exhibit unique advantages (e.g., simpler structure and higher speed), and have been actively studied in recent years
[37, 23, 30, 14]. Inspired by this, an open question is natu-rally thrown at us - Is it possible to develop an anchor-free framework for person search? The answer is yes. How-ever, this is a non-trivial task due to the following three mis-alignment issues. 1) Many anchor-free models learn multi-scale features using feature pyramid networks (FPNs) [25] to achieve scale invariance for object detection. However, this introduces the misalignment issue for re-id (i.e., scale misalignment), as a query person needs to be compared with all the people of various scales in the gallery set. 2) In the absence of operations like ROI-Align, anchor-free models cannot align the features for re-id and detection according to a speciﬁc region. Therefore, re-id embeddings must be directly learned from feature maps without explicit region alignment. 3) Person search can be intuitively formulated as a multi-task learning framework with detection and re-id as its sub-tasks. Hence, we need to ﬁnd a better trade-off/alignment between the two tasks.
In this work, we present the ﬁrst anchor-free framework for efﬁcient person search, which we name the Feature-Aligned Person Search Network (AlignPS). Our model em-ploys the typical architecture of anchor-free detection mod-els, but with a carefully designed aligned feature aggrega-tion (AFA) module. We follow a “re-id ﬁrst” principle to explicitly address the above-mentioned challenges. More speciﬁcally, AFA reshapes some building blocks of FPN by exploiting the deformable convolution and feature fusion to overcome the issues of region and scale misalignment in re-id feature learning. We also optimize the training pro-cedures of re-id and detection to place more emphasis on generating robust re-id embeddings (as shown in Fig. 1c).
These simple yet effective designs successfully transform a classic anchor-free detector into a powerful and efﬁcient person search framework, and allow the proposed model to outperform its anchor-based competitors.
In summary, our main contributions include:
• We propose the ﬁrst one-step one-stage framework for efﬁcient person search. The anchor-free solution will signiﬁcantly foster future research in this direction.
• We design an AFA module that simultaneously ad-dresses the issues of scale, region, and task misalign-ment to successfully accommodate an anchor-free de-tector for the task of person search.
• As an anchor-free one-stage framework, our model surprisingly outperforms state-of-the-art one-step two-stage models on two challenging person search bench-marks, while running at a higher speed. 2.