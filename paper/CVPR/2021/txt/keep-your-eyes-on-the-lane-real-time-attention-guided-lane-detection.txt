Abstract
Modern lane detection methods have achieved remark-able performances in complex real-world scenarios, but many have issues maintaining real-time efﬁciency, which is important for autonomous vehicles. In this work, we pro-pose LaneATT: an anchor-based deep lane detection model, which, akin to other generic deep object detectors, uses the anchors for the feature pooling step. Since lanes follow a regular pattern and are highly correlated, we hypothesize that in some cases global information may be crucial to infer their positions, especially in conditions such as oc-clusion, missing lane markers, and others. Thus, this work proposes a novel anchor-based attention mechanism that aggregates global information. The model was evaluated ex-tensively on three of the most widely used datasets in the liter-ature. The results show that our method outperforms the cur-rent state-of-the-art methods showing both higher efﬁcacy and efﬁciency. Moreover, an ablation study is performed along with a discussion on efﬁciency trade-off options that are useful in practice. Code and models are available at https://github.com/lucastabelini/LaneATT. 1.

Introduction
Deep learning has been essential for recent advances in numerous areas, especially in autonomous driving [2]. Many of the deep learning applications in self-driving cars are in their perception systems. To be safe around humans, autonomous vehicles should perceive their surroundings, including the position of other vehicles and themselves. In the end, the more predictable a car’s movement is, the safer it will be for its passengers and pedestrians. Thus, it is important for autonomous vehicles to know each lane’s exact position, which is the goal of lane detection systems.
Lane detection models have to overcome various chal-lenges. In a real-world scenario, models should be robust to several adverse conditions, such as extreme light and weather.
Moreover, lane markings can be occluded by other objects (e.g., cars), which is extremely common for self-driving cars.
Some approaches, such as polynomial regression models, may also suffer from a data imbalance problem caused by the long-tail effect since cases with sharper curves are less common. Besides, the model not only has to be robust but also efﬁcient. In several applications, lane detection must perform in real-time, or faster to save processing power for other systems, a requirement that many models struggle to cope with.
There are numerous works in the literature that tackle this problem. Before the advent of deep learning, several meth-ods used more traditional computer vision techniques, such as Hough lines [4, 1]. More recently, focus has shifted to deep learning approaches with the advance of convolutional neural networks (CNNs) [17, 11, 18]. In this context, the lane detection problem is usually formulated as a segmentation task, where, given an input image, the output is a segmen-tation map with per-pixel predictions [17]. Although recent advances in deep learning have enabled the use of segmenta-tion networks in real-time [22], various models struggle to to achieve real-time performance. Consequently, the number of backbone options for segmentation-based methods is rather limited. Hence, some recent works have proposed solutions in other directions [13, 23]. Apart from that, many other issues are common in works on lane detection, such as the need for a post-processing step (usually a heuristic), long training times, and a lack of publicly available source code, which hinders comparisons and reproducibility.
In this work, we present a method for real-time lane detection that is both faster and more accurate than most state-of-the-art methods. We propose an anchor-based single-stage lane detection model called LaneATT. It uses a novel anchor-based feature pooling method that enables the use of a lightweight backbone CNN while maintaining high accuracy, contrary to an existing method [13]. A novel anchor-based attention mechanism to aggregate global infor-mation is also proposed. Extensive experimental results are shown on three benchmarks (TuSimple [24], CULane [17] and LLAMAS [3]), along with a comparison with state-of-the-art methods, a discussion on efﬁciency trade-offs, and an ablation study of our design choices. In summary, our main contributions are: 294
• A lane detection method that is more accurate than existing state-of-the-art real-time methods on a large and complex dataset;
• A model that enables faster training and inference times than most other models (reaching 250 FPS and almost an order of magnitude less multiply-accumulate opera-tions (MACs) than the previous state-of-the-art);
• A novel anchor-based attention mechanism for lane detection which is potentially useful in other domains where the objects being detected are correlated. 2.