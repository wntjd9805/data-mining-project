Abstract
In this paper, we consider the absorption effect for the problem of single image reﬂection removal. We show that the absorption effect can be numerically approximated by the average of refractive amplitude coefﬁcient map. We then reformulate the image formation model and propose a two-step solution that explicitly takes the absorption effect into account. The ﬁrst step estimates the absorption ef-fect from a reﬂection-contaminated image, while the second step recovers the transmission image by taking a reﬂection-contaminated image and the estimated absorption effect as the input. Experimental results on four public datasets show that our two-step solution not only successfully removes reﬂection artifact, but also faithfully restores the intensity distortion caused by the absorption effect. Our ablation stud-ies further demonstrate that our method achieves superior performance on the recovery of overall intensity and has good model generalization capacity. The code is available at https://github.com/q-zh/absorption. 1.

Introduction
When light interacts with a plate glass surface, it can be partly absorbed, reﬂected, and transmitted. A widely used formation model of a reﬂection-contaminated image I is formulated as1
I = ΩT + ΦR, (1) where Ω and Φ represent refractive and reﬂective amplitude coefﬁcient maps, T and R represent transmission and re-ﬂection images. Recovering transmission image T from a single reﬂection-contaminated image I is challenging due to its ill-posedness [1]. As can be observed from Equation (1), such ill-posedness is not only caused by unknown content of T and R, but also by unknown content-free variables of
Ω and Φ. Most existing methods rely on image content for single image reﬂection removal, i.e., explicit priors from image gradients (e.g., [2]) and dictionaries (e.g., [3]), or
∗Corresponding authors. 1As there is no matrix multiplication in this paper, we redeﬁne the matrix implicit priors from training data (e.g., [4]). The nature of content-free variables is widely studied to solve the problem of multi-images reﬂection removal (e.g., [5, 6]) while they are seldom considered in the context of single image reﬂec-tion removal. Besides, most existing solutions (e.g., single image [7], multi-images [8]) are based on an ideal image formation model that does not take the absorption effect (de-ﬁned in Section 3) into account, i.e., assuming the glass to be thin enough. A recent work solves for ΩT instead of T as the absorption effect can signiﬁcantly darken the transmis-sion [9].2 Since the absorption effect is independent from image content while varying with different colors, thick-nesses, or orientations of glass in the real-world, considering the absorption effect can help mitigate the ill-posedness of single image reﬂection removal.
In this paper, we revisit the formation model of the reﬂection-contaminated image by taking the absorption ef-fect into account (Section 3). According to the results of
Monte Carlo simulation [10], we observe that the absorp-tion effect can be numerically represented by the average of refractive amplitude coefﬁcient map, deﬁned as avg(Ω) (Section 5.1). As the content-free variable avg(Ω) ﬂuctuates in the simulation, we argue that an accurate estimation of avg(Ω) can beneﬁt in solving the problem of single image re-ﬂection removal. To this end, we propose a two-step solution to ﬁrst estimate avg(Ω) and then recover the transmission image T through two neural networks. To obtain an accurate estimation of avg(Ω) in the ﬁrst step, we adopt a two-branch training strategy by taking I and T as inputs. The core idea is to reduce the inﬂuence from image content of transmission and reﬂection while propagating discriminative features of content-free variable avg(Ω) across the layers of our neural network (Section 4.1). We also constrain the second step with the Lipschitz condition [11] to increase the generaliza-tion capacity regarding diverse avg(Ω) (Section 4.2). Our method achieves a superior performance advantage on public datasets. In summary, our contributions are as follows,
• We propose the ﬁrst formulation to consider the absorp-tion effect in the context of reﬂection removal. We fur-ther show that the absorption effect can be numerically 2Please ﬁnd our experiments of ﬁtting the absorption effect for real data multiplication as the element-wise multiplication for simplicity. in the supplementary material. 113395
approximated by the average of refractive amplitude coefﬁcient map.
• We propose a two-step solution, with a two-branch train-ing strategy and the constraint of Lipschitz condition, to solve the problem of single image reﬂection removal with the consideration of absorption effect. We further analyze how the proposed method facilitates estimating the absorption effect and recovering the transmission image from a single reﬂection-contaminated image.
• We show by experiments that our method not only suc-cessfully removes reﬂection artifact, but also faithfully restores the intensity distortion caused by the absorption effect. We further demonstrate that our method achieves a superior performance advantage on the recovery of overall intensity and has good model generalization capacity. 2.