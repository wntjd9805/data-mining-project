Abstract
High-deﬁnition maps (HD maps) are a key component of most modern self-driving systems due to their valuable se-mantic and geometric information. Unfortunately, building
HD maps has proven hard to scale due to their cost as well as the requirements they impose in the localization system that has to work everywhere with centimeter-level accuracy.
Being able to drive without an HD map would be very bene-ﬁcial to scale self-driving solutions as well as to increase the failure tolerance of existing ones (e.g., if localization fails or the map is not up-to-date). Towards this goal, we propose
MP3, an end-to-end approach to mapless1 driving where the input is raw sensor data and a high-level command (e.g., turn left at the intersection). MP3 predicts intermediate representations in the form of an online map and the current and future state of dynamic agents, and exploits them in a novel neural motion planner to make interpretable decisions taking into account uncertainty. We show that our approach is signiﬁcantly safer, more comfortable, and can follow com-mands better than the baselines in challenging long-term closed-loop simulations, as well as when compared to an expert driver in a large-scale real-world dataset. 1.

Introduction
Most modern self-driving stacks require up-to-date high-deﬁnition (HD) maps that contain rich semantic information necessary for driving such as the topology and location of the lanes, crosswalks, trafﬁc lights, intersections as well as the trafﬁc rules for each lane (e.g., unprotected left, right turn on red, maximum speed). These maps are a great source of knowledge that simplify the perception and motion forecast-ing tasks, as the online inference process has to mainly focus on dynamic objects (e.g., vehicles, pedestrians, cyclists).
Furthermore, the use of HD maps signiﬁcantly increases the safety of motion planning as knowing the lane topology and geometry eases the generation of potential trajectories for
*Denotes equal contribution 1We note that by mapless we mean without HD maps. A coarse road network like the ones available in off-the-shelf services such as Google
Maps or OpenStreetMap is assumed available for routing towards the goal.
Figure 1: Left: a localization error makes the SDV follow a wrong route when using an HD map, driving into trafﬁc.
Right: mapless driving can interpret the scene from sensors and achieve a safe plan that follows a high-level command. the ego-vehicle that adhere to the trafﬁc rules. In addition, progressing towards a speciﬁc goal is much simpler when the desired route is deﬁned as a sequence of lanes to traverse.
Unfortunately, building HD maps has proven hard to scale due to the complexity and cost of generating the maps and maintaining them. Furthermore, the heavy reliance on
HD maps introduces very demanding requirements for the localization system, which needs to work at all times with centimeter-level accuracy or else unsafe situations like Fig. 1 (left) might arise. This motivates the development of mapless technology, which can serve as the fail-safe in the case of localization failures or outdated maps, and potentially unlock self-driving at scale at a much lower cost.
Self-driving without HD maps is a very challenging task.
Perception can no longer rely on the prior that is more likely to ﬁnd vehicles on the road and pedestrians on the sidewalk.
Motion forecasting of dynamic objects becomes even more challenging without having access to the lanes that vehicles typically follow or the location of crosswalks for pedestrians.
Most importantly, the search space to plan a safe maneuver for the SDV goes from narrow envelopes around the lane cen-ter lines [1, 45, 46, 50] to the full set of dynamically feasible trajectories as depicted in Fig. 1 (right). Moreover, without a well-deﬁned route as a series of lanes to follow, the goal that the SDV is trying to reach needs to be abstracted into high-level behaviors such as going straight at an intersec-tion, turning left or turning right [11], which require taking 14403
different actions depending of the context of the scene.
Most mapless approaches [5, 11, 19, 37, 39], focus on im-itating the controls of an expert driver (e.g., steering and acceleration), without providing intermediate interpretable representations that can help explain the self-driving vehicle decisions. Interpretability is of key importance in a safety-critical system particularly if a bad event was to happen.
Moreover, the absence of a mechanism to inject structure and prior knowledge makes these methods very brittle to distributional shift [44]. While methods that perform online mapping to obtain lane boundaries or lane center lines have been proposed [2, 16, 18, 21, 37], they either are overly sim-plistic (e.g., assume lanes are close to parallel to the direction of travel), have only been demonstrated in highway scenar-ios which are much simpler than city driving, have not been shown to work when coupled with any existing planner, or involve information loss through discrete decisions such as conﬁdence thresholding to output the candidate lanes. The latter is safety-critical as a lane can be completely missed in the worst case, and it makes it difﬁcult to incorporate uncertainty about the static environment in motion planning, which is important to reduce risk.
To address these challenges, we propose an end-to-end approach to mapless driving that is interpretable, does not incur any information loss, and reasons about uncertainty in the intermediate representations. In particular, we propose a set of probabilistic spatial layers to model the static and dynamic parts of the environment. The static environment is subsumed in a planning-centric online map which captures information about which areas are drivable and which ones are reachable given trafﬁc rules. The dynamic actors are cap-tured in a novel occupancy ﬂow that provides occupancy and velocity estimates over time. The motion planning module then leverages these representations without any postpro-cessing. It utilizes observational data to retrieve dynamically feasible trajectories, predicts a spatial mask over the map to estimate the route given an abstract goal, and leverages the online map and occupancy ﬂow directly as cost functions for explainable, safe plans. We showcase that our approach is signiﬁcantly safer, more comfortable, and can follow com-mands better than a wide variety of baselines in challenging closed-loop simulations, as well as when compared to an expert driver in a large-scale real-world dataset. 2.